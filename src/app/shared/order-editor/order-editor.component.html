<div class="order-container">
  <div class="order-head">
    <h3 class="business">{{ orderDetails.group.name | titlecase }}</h3>
    <div class="order-number">Orden #{{ orderDetails.id }}</div>
  </div>

  <form action="#">
    <div class="batch-actions">
      <mat-checkbox
        type="checkbox"
        name="select-all"
        class="check"
        (change)="selectAllOrder()"
        [checked]="isAllChecked()"
      ></mat-checkbox>

      <button
        class="btn-area"
        class="option label-reset delete-btn"
        (click)="deleteOrdersSelected()"
        mat-button
      >
        Eliminar
      </button>

      <button
        class="option label-reset delivery-btn"
        (click)="setHasDeliveryToOrders()"
        mat-button
      >
        Con delivery
      </button>

      <button
        class="option label-reset takeout-btn"
        (click)="setHasDeliveryToOrders(false)"
        mat-button
      >
        Retiro en tienda
      </button>
    </div>

    <div class="order-list-container">
      <ul class="nav nav-tabs">
        <li class="nav-item">
          <a
            [ngClass]="{ active: hasDelivery }"
            (click)="setHasDelivery(true)"
            class="nav-link"
            >Con delivery</a
          >
        </li>
        <li class="nav-item">
          <a
            [ngClass]="{ active: !hasDelivery }"
            (click)="setHasDelivery(false)"
            class="nav-link"
            >Retiro en tienda</a
          >
        </li>
      </ul>

      <div class="order-list">
        <ng-container
          *ngFor="
            let order of orders
              | filter: hasDelivery:'hasDelivery':'No hay productos agregados';
            index as inx
          "
        >
          <ng-container *ngIf="!order.error; else noProducts">
            <article class="order-item fadeIn animated">
              <div class="checkbox">
                <mat-checkbox
                  type="checkbox"
                  name="select-all"
                  class="checkbox-default"
                  (change)="selectOrder(order)"
                  [checked]="isChecked(order)"
                ></mat-checkbox>
              </div>

              <div class="content-flex">
                <div class="info-product">
                  <figure class="img-principal">
                    <img
                      [src]="order.images[0] | imgFallback: 'box'"
                      [alt]="order.name"
                    />
                  </figure>

                  <div class="title_quantity-container">
                    <div class="title-container">
                      <h4 class="title">{{ order.name }}</h4>
                    </div>
                  </div>

                  <div class="amount">
                    <app-quantity-counter
                      (currentValue)="currentValue($event, order)"
                      [isSmall]="true"
                      [initValue]="order.quantity"
                      [maxValue]="order.stock"
                    >
                    </app-quantity-counter>
                  </div>
                </div>

                <label class="unit-price-lbl">Unitario</label>
                <label class="total-price-lbl">Total</label>

                <div class="price unit-price">
                  ${{ extractIVA(order.price) | number }}
                </div>

                <div class="price total-price">
                  ${{ totalProductValue(order.price, order.quantity) | number }}
                </div>
              </div>
            </article>
          </ng-container>

          <ng-template #noProducts>
            <article class="order-item">
              <p>{{ order.error }}</p>
            </article>

            <article class="order-item">
              <div class="checkbox">
                <div class="fill--gray"></div>
              </div>

              <div class="content-flex">
                <div class="info-product">
                  <figure class="img-principal">
                    <div class="fill--gray"></div>
                  </figure>

                  <div class="title_quantity-container">
                    <div class="title-container">
                      <h4 class="title">
                        <div class="fill--gray"></div>
                      </h4>
                    </div>

                    <div class="quantity-fill--gray"></div>
                  </div>
                </div>

                <div class="price">
                  <div class="fill--gray"></div>
                </div>

                <div class="price">
                  <div class="fill--gray"></div>
                </div>
              </div>
            </article>
          </ng-template>
        </ng-container>
      </div>
    </div>

    <div class="resume">
      <table>
        <tr>
          <td>Impuesto (19%)</td>
          <td>{{ totalsCounts('tax') | currency }}</td>
        </tr>

        <tr>
          <td>Delivery</td>
          <td>{{ totalsCounts('delivery') | currency }}</td>
        </tr>

        <tr>
          <td><strong>Total a pagar</strong></td>
          <td>
            <strong>{{ totalsCounts() | currency }}</strong>
          </td>
        </tr>
      </table>

      <div class="label-area">
        <mat-checkbox
          id="termsAndConditions"
          name="termsAndConditions"
          type="checkbox"
          class="checkbox-default"
          [(ngModel)]="acceptTermsAndConditions"
        >
        </mat-checkbox>

        <p class="label">Acepto los t√©rminos y condiciones</p>
      </div>

      <div class="actions">
        <button class="button gray" (click)="cancelOrder()">
          Cancelar orden
        </button>

        <button
          [disabled]="!acceptTermsAndConditions"
          [ngClass]="{ disabled: !acceptTermsAndConditions }"
          class="button"
          (click)="processPayment()"
        >
          Pagar
        </button>
      </div>
    </div>
  </form>
</div>
