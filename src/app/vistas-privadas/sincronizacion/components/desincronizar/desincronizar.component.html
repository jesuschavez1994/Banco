<section class="display-flex mb-5 pt-4">
    <div class="container-fluid">
        <div class="row">

            <form   [formGroup]="forma"
                    (ngSubmit)="addProducts()" 
                    novalidate="novalidate"
                    class="row width-100 pl-3"
                    >

                    <!-- ======  SUBIDA DE PRODUCTO =====-->
                    <!-- ===================================-->
                    <section class="col-12 col-sm-12 col-md-4">

                        <app-image-preview-gallery *ngIf="myFlag" [imgs]="IMG" [sync]="this.sync"></app-image-preview-gallery>

                    </section>

                    <section class="col-12 col-sm-12 col-md-7">

                        <div class="form-group row">
                            <div class="col-12 col-sm-12 col-md-12 col-lg-12 col-xl-12">
                                <label class="family-500 size-16">Nombre</label>
                                <textarea  class="form-control"
                                        type="text"
                                        placeholder="Ingresar nombre del producto"
                                        formControlName="name"
                                        [ngClass]="{'is-invalid':  (!forma.controls['name'].valid || forma.controls['name'].errors?.minlength)&& forma.controls['name'].touched, 'is-valid': forma.controls['name'].valid }"     
                                ></textarea>

                                <mat-error  *ngIf="forma.get('name').errors?.required"  
                                            class="invalid-feedback">
                                            Ingresa un nombre del producto
                                </mat-error>

                                <mat-error  *ngIf="forma.get('name').errors?.minlength"  
                                            class="invalid-feedback">
                                            Por lo menos 5 caracteres
                                </mat-error>

                            </div>
                        </div>


                        
                        <div class="form-group row">
                            <div class="col-12 col-sm-10 col-md-12 col-lg-12 col-xl-12">
                                <label class="family-500 size-16">Descripción</label>
                                <textarea   class="form-control text-area" 
                                            type="text"
                                            placeholder="Ingresar descripción del producto" 
                                            formControlName="description"
                                            [ngClass]="{'is-invalid':  (!forma.controls['description'].valid || forma.controls['description'].errors?.minlength)&& forma.controls['description'].touched, 'is-valid': forma.controls['description'].valid }"     
                                            ></textarea>

                                <mat-error  *ngIf="forma.get('description').errors?.required"  
                                            class="invalid-feedback">
                                            Debe indicar una descripción del producto
                                </mat-error>

                                <mat-error  *ngIf="forma.get('description').errors?.minlength"  
                                            class="invalid-feedback">
                                            Por lo menos 5 caracteres
                                </mat-error>

                            </div>
                        </div>


                        <div class="row">

                            <div class="form-group col-md-4">
                                <label for="Marca" class="family-500 size-14">Marca</label>
                                <select id="Marca" 
                                        class="form-control"
                                        formControlName="mark">
                                        <option class="family-300">
                                            Seleccionar
                                        </option>
                                        <option [value]="item.name" *ngFor="let item of marks">
                                            {{item.name}}
                                        </option>
                                </select>
                            </div>
    
                            <div class="form-group col-md-4">
                                <label for="Fabricante" class="family-500 size-14">Fabricante</label>
                                <select id="Fabricante"
                                        class="form-control"
                                        formControlName="factory">
                                        <option class="family-300">Seleccionar</option>
                                        <option [value]="item.name" *ngFor="let item of factories">
                                                {{item.name}}
                                        </option>
                                </select>
                            </div>
    
    
                            <div class="form-group col-md-4">
                                <label for="Categoria" class="family-500 size-14 display-flex align-items-center">
                                    Categoria
                                    <!-- <i  class="material-icons add cursor-poniter plus"
                                        title="agregar nueva categoria"
                                        (click)="openDialog()">add
                                    </i> -->
                                </label>
                                <select id="Categoria" 
                                        class="form-control"
                                        formControlName="category"
                                        [ngModel]="this.categoriaBanco"
                                        name="category" 
                                        (change)="onChange($event.target.value)"
                                        >
                                    <option class="family-300">Seleccionar</option>
                                    <option *ngFor="let item of category; let i = index"
                                            [value]="item.name"
                                            >
                                            {{item.name}}
                                    </option>
                                </select>
                            </div>
                        </div>


                        <div class="row">

                            <div class="form-group col-md-4">
                                <label for="Subcategoria" class="family-500 size-14 display-flex align-items-center">
                                    Subcategoria
                                    <!-- <i class="material-icons add cursor-poniter plus"
                                        (click)="openDialog()"
                                        title="agregar nueva subcategoria">
                                        add
                                    </i> -->
                                </label>
                                <select id="Subcategoria" 
                                        class="form-control"
                                        formControlName="subcategory_id"
                                        [ngModel]="subcategory_estado[0].subcategoria"
                                        (change)="Subcategory($event.target.value)">
                                        <option selected class="family-300">Seleccionar</option>
                                        <option selected *ngFor="let item of subcategory_estado" 
                                                [value]="item.subcategoria">
                                                {{ item.subcategoria_nombre }}
                                        </option>
                                </select>
                            </div>
    
                            <div class="form-group col-md-4">
                                <label class="family-500 size-16">Precio</label>
                                <input  class="form-control"
                                        type="number"
                                        placeholder="Precio"
                                        formControlName="price"
                                        [ngClass]="{'is-invalid':  (!forma.controls['stock'].valid || forma.controls['stock'].errors?.minlength)&& forma.controls['stock'].touched, 'is-valid': forma.controls['stock'].valid }"
                                >
    
                                <mat-error  *ngIf="forma.get('price').errors?.required"  
                                            class="invalid-feedback">
                                            Debe indicar precio del producto.
                                </mat-error>
    
                            </div>
    
                            <div class="form-group col-md-4">
                                <label class="family-500 size-16">Cantidad</label>
                                <input  class="form-control"
                                        formControlName="stock"
                                        type="number"
                                        placeholder="Cantidad"
                                        [ngClass]="{'is-invalid':  (!forma.controls['stock'].valid || forma.controls['stock'].errors?.minlength)&& forma.controls['stock'].touched, 'is-valid': forma.controls['stock'].valid }" 
                                >
                                <mat-error  *ngIf="forma.get('stock').errors?.required"  
                                            class="invalid-feedback">
                                            Debe indicar la cantidad del producto.
                                </mat-error>
    
                            </div>
    
                            <div class="form-group col-md-4">
                                <label for="Receta" class="family-500 size-14">Recetas Médicas</label>
                                <select id="Receta" 
                                        class="form-control" 
                                        formControlName="recipe">
                                <option selected class="family-300">Seleccionar</option>
                                <option *ngFor="let item of recipes" [value]="item.name">{{ item.name }}</option>
                                </select>
                            </div>
    
                            <div class="form-group col-md-4">
                                <label for="Delivery" class="family-500 size-14">Delivery</label>
                                <select id="Delivery" 
                                        class="form-control"
                                        formControlName="delivery"
                                        >
                                        <option selected class="family-300">Seleccionar</option>
                                        <option *ngFor="let item of delivery_estado" selected [value]="item.delivery">{{item.delivery_nombre}}</option>
                                </select>
                            </div>
    
                            <div class="form-group col-md-4">
                                <label for="Disponible" class="family-500 size-14">Disponible</label>
                                <select id="Disponible" 
                                        class="form-control"
                                        formControlName="aviable"
                                        >
                                <option selected class="family-300">Seleccionar</option>
                                <option *ngFor="let item of disponibilidad_estado" [value]="item.disponibilidad">{{item.disponibilidad_nombre}}</option>
                                </select>
                            </div>
                        </div>

                    </section>

                    <div class="col-md-11 display-flex justify-content-flex-end">
                        <hr size=1 width="70%">
                        <button class="btn btn-primary button fredoka" 
                                type="submit"
                                (click)="Send()"
                                >
                                Desincronizar
                        </button>
                    </div>

            </form>

        </div>
    </div>
</section>

