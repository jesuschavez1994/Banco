function init_plugins(){$((function(){"use strict";$((function(){$(".preloader").fadeOut()})),jQuery(document).on("click",".mega-dropdown",(function(t){t.stopPropagation()}));var t=function(){(window.innerWidth>0?window.innerWidth:this.screen.width)<1170?($("body").addClass("mini-sidebar"),$(".navbar-brand span").hide(),$(".sidebartoggler i").addClass("ti-menu")):($("body").removeClass("mini-sidebar"),$(".navbar-brand span").show());var t=(window.innerHeight>0?window.innerHeight:this.screen.height)-1;(t-=0)<1&&(t=1),t>0&&$(".page-wrapper").css("min-height",t+"px")};$(window).ready(t),$(window).on("resize",t),$(".sidebartoggler").on("click",(function(){$("body").hasClass("mini-sidebar")?($("body").trigger("resize"),$("body").removeClass("mini-sidebar"),$(".navbar-brand span").show()):($("body").trigger("resize"),$("body").addClass("mini-sidebar"),$(".navbar-brand span").hide())})),$(".nav-toggler").click((function(){$("body").toggleClass("show-sidebar"),$(".nav-toggler i").toggleClass("ti-menu"),$(".nav-toggler i").addClass("ti-close")})),$(".search-box a, .search-box .app-search .srh-btn").on("click",(function(){$(".app-search").toggle(200)})),$(".right-side-toggle").click((function(){$(".right-sidebar").slideDown(50),$(".right-sidebar").toggleClass("shw-rside")})),$(".floating-labels .form-control").on("focus blur",(function(t){$(this).parents(".form-group").toggleClass("focused","focus"===t.type||this.value.length>0)})).trigger("blur"),$((function(){for(var t=window.location,e=$("ul#sidebarnav a").filter((function(){return this.href==t})).addClass("active").parent().addClass("active");e.is("li");)e=e.parent().addClass("in").parent().addClass("active")})),$((function(){$('[data-toggle="tooltip"]').tooltip()})),$((function(){$('[data-toggle="popover"]').popover()})),$((function(){$("#sidebarnav").AdminMenu()})),$(".scroll-sidebar, .right-side-panel, .message-center, .right-sidebar").perfectScrollbar(),$("body").trigger("resize"),$(".list-task li label").click((function(){$(this).toggleClass("task-done")})),$('a[data-action="collapse"]').on("click",(function(t){t.preventDefault(),$(this).closest(".card").find('[data-action="collapse"] i').toggleClass("ti-minus ti-plus"),$(this).closest(".card").children(".card-body").collapse("toggle")})),$('a[data-action="expand"]').on("click",(function(t){t.preventDefault(),$(this).closest(".card").find('[data-action="expand"] i').toggleClass("mdi-arrow-expand mdi-arrow-compress"),$(this).closest(".card").toggleClass("card-fullscreen")})),$('a[data-action="close"]').on("click",(function(){$(this).closest(".card").removeClass().slideUp("fast")}))}))}!function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){"use strict";var n=[],o=t.document,r=Object.getPrototypeOf,i=n.slice,a=n.concat,s=n.push,l=n.indexOf,u={},c=u.toString,f=u.hasOwnProperty,h=f.toString,p=h.call(Object),d={};function g(t,e){var n=(e=e||o).createElement("script");n.text=t,e.head.appendChild(n).parentNode.removeChild(n)}var m="3.2.0",y=function(t,e){return new y.fn.init(t,e)},v=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,C=/^-ms-/,b=/-([a-z])/g,w=function(t,e){return e.toUpperCase()};function T(t){var e=!!t&&"length"in t&&t.length,n=y.type(t);return"function"!==n&&!y.isWindow(t)&&("array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t)}y.fn=y.prototype={jquery:m,constructor:y,length:0,toArray:function(){return i.call(this)},get:function(t){return null==t?i.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=y.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return y.each(this,t)},map:function(t){return this.pushStack(y.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(i.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(n>=0&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:n.sort,splice:n.splice},y.extend=y.fn.extend=function(){var t,e,n,o,r,i,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||y.isFunction(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(t=arguments[s]))for(e in t)n=a[e],a!==(o=t[e])&&(u&&o&&(y.isPlainObject(o)||(r=Array.isArray(o)))?(r?(r=!1,i=n&&Array.isArray(n)?n:[]):i=n&&y.isPlainObject(n)?n:{},a[e]=y.extend(u,i,o)):void 0!==o&&(a[e]=o));return a},y.extend({expando:"jQuery"+(m+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===y.type(t)},isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){var e=y.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==c.call(t)||(e=r(t))&&(n=f.call(e,"constructor")&&e.constructor,"function"!=typeof n||h.call(n)!==p))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?u[c.call(t)]||"object":typeof t},globalEval:function(t){g(t)},camelCase:function(t){return t.replace(C,"ms-").replace(b,w)},each:function(t,e){var n,o=0;if(T(t))for(n=t.length;o<n&&!1!==e.call(t[o],o,t[o]);o++);else for(o in t)if(!1===e.call(t[o],o,t[o]))break;return t},trim:function(t){return null==t?"":(t+"").replace(v,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?y.merge(n,"string"==typeof t?[t]:t):s.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:l.call(e,t,n)},merge:function(t,e){for(var n=+e.length,o=0,r=t.length;o<n;o++)t[r++]=e[o];return t.length=r,t},grep:function(t,e,n){for(var o=[],r=0,i=t.length,a=!n;r<i;r++)!e(t[r],r)!==a&&o.push(t[r]);return o},map:function(t,e,n){var o,r,i=0,s=[];if(T(t))for(o=t.length;i<o;i++)null!=(r=e(t[i],i,n))&&s.push(r);else for(i in t)null!=(r=e(t[i],i,n))&&s.push(r);return a.apply([],s)},guid:1,proxy:function(t,e){var n,o,r;if("string"==typeof e&&(n=t[e],e=t,t=n),y.isFunction(t))return o=i.call(arguments,2),(r=function(){return t.apply(e||this,o.concat(i.call(arguments)))}).guid=t.guid=t.guid||y.guid++,r},now:Date.now,support:d}),"function"==typeof Symbol&&(y.fn[Symbol.iterator]=n[Symbol.iterator]),y.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){u["[object "+e+"]"]=e.toLowerCase()}));var x=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b="sizzle"+1*new Date,w=t.document,T=0,x=0,S=st(),A=st(),I=st(),R=function(t,e){return t===e&&(f=!0),0},k={}.hasOwnProperty,M=[],N=M.pop,E=M.push,D=M.push,O=M.slice,j=function(t,e){for(var n=0,o=t.length;n<o;n++)if(t[n]===e)return n;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",_="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",L="\\["+P+"*("+_+")(?:"+P+"*([*^$|!~]?=)"+P+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+_+"))|)"+P+"*\\]",B=":("+_+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+L+")*)|.*)\\)|)",G=new RegExp(P+"+","g"),H=new RegExp("^"+P+"+|((?:^|[^\\\\])(?:\\\\.)*)"+P+"+$","g"),V=new RegExp("^"+P+"*,"+P+"*"),z=new RegExp("^"+P+"*([>+~]|"+P+")"+P+"*"),W=new RegExp("="+P+"*([^\\]'\"]*?)"+P+"*\\]","g"),U=new RegExp(B),q=new RegExp("^"+_+"$"),Y={ID:new RegExp("^#("+_+")"),CLASS:new RegExp("^\\.("+_+")"),TAG:new RegExp("^("+_+"|[*])"),ATTR:new RegExp("^"+L),PSEUDO:new RegExp("^"+B),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+P+"*(even|odd|(([+-]|)(\\d*)n|)"+P+"*(?:([+-]|)"+P+"*(\\d+)|))"+P+"*\\)|)","i"),bool:new RegExp("^(?:"+F+")$","i"),needsContext:new RegExp("^"+P+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+P+"*((?:-\\d)?\\d*)"+P+"*\\)|)(?=[^-]|$)","i")},X=/^(?:input|select|textarea|button)$/i,Z=/^h\d$/i,Q=/^[^{]+\{\s*\[native \w/,J=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,$=/[+~]/,K=new RegExp("\\\\([\\da-f]{1,6}"+P+"?|("+P+")|.)","ig"),tt=function(t,e,n){var o="0x"+e-65536;return o!=o||n?e:o<0?String.fromCharCode(o+65536):String.fromCharCode(o>>10|55296,1023&o|56320)},et=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ot=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},rt=function(){h()},it=Ct((function(t){return!0===t.disabled&&("form"in t||"label"in t)}),{dir:"parentNode",next:"legend"});try{D.apply(M=O.call(w.childNodes),w.childNodes),M[w.childNodes.length].nodeType}catch(nt){D={apply:M.length?function(t,e){E.apply(t,O.call(e))}:function(t,e){for(var n=t.length,o=0;t[n++]=e[o++];);t.length=n-1}}}function at(t,e,o,r){var i,s,u,c,f,d,y,v=e&&e.ownerDocument,T=e?e.nodeType:9;if(o=o||[],"string"!=typeof t||!t||1!==T&&9!==T&&11!==T)return o;if(!r&&((e?e.ownerDocument||e:w)!==p&&h(e),e=e||p,g)){if(11!==T&&(f=J.exec(t)))if(i=f[1]){if(9===T){if(!(u=e.getElementById(i)))return o;if(u.id===i)return o.push(u),o}else if(v&&(u=v.getElementById(i))&&C(e,u)&&u.id===i)return o.push(u),o}else{if(f[2])return D.apply(o,e.getElementsByTagName(t)),o;if((i=f[3])&&n.getElementsByClassName&&e.getElementsByClassName)return D.apply(o,e.getElementsByClassName(i)),o}if(n.qsa&&!I[t+" "]&&(!m||!m.test(t))){if(1!==T)v=e,y=t;else if("object"!==e.nodeName.toLowerCase()){for((c=e.getAttribute("id"))?c=c.replace(et,ot):e.setAttribute("id",c=b),s=(d=a(t)).length;s--;)d[s]="#"+c+" "+vt(d[s]);y=d.join(","),v=$.test(t)&&mt(e.parentNode)||e}if(y)try{return D.apply(o,v.querySelectorAll(y)),o}catch(x){}finally{c===b&&e.removeAttribute("id")}}}return l(t.replace(H,"$1"),e,o,r)}function st(){var t=[];return function e(n,r){return t.push(n+" ")>o.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function lt(t){return t[b]=!0,t}function ut(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ct(t,e){for(var n=t.split("|"),r=n.length;r--;)o.attrHandle[n[r]]=e}function ft(t,e){var n=e&&t,o=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(o)return o;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function ht(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function pt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function dt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&it(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function gt(t){return lt((function(e){return e=+e,lt((function(n,o){for(var r,i=t([],n.length,e),a=i.length;a--;)n[r=i[a]]&&(n[r]=!(o[r]=n[r]))}))}))}function mt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=at.support={},i=at.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return!!e&&"HTML"!==e.nodeName},h=at.setDocument=function(t){var e,r,a=t?t.ownerDocument||t:w;return a!==p&&9===a.nodeType&&a.documentElement?(d=(p=a).documentElement,g=!i(p),w!==p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",rt,!1):r.attachEvent&&r.attachEvent("onunload",rt)),n.attributes=ut((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ut((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=Q.test(p.getElementsByClassName),n.getById=ut((function(t){return d.appendChild(t).id=b,!p.getElementsByName||!p.getElementsByName(b).length})),n.getById?(o.filter.ID=function(t){var e=t.replace(K,tt);return function(t){return t.getAttribute("id")===e}},o.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(o.filter.ID=function(t){var e=t.replace(K,tt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},o.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,o,r,i=e.getElementById(t);if(i){if((n=i.getAttributeNode("id"))&&n.value===t)return[i];for(r=e.getElementsByName(t),o=0;i=r[o++];)if((n=i.getAttributeNode("id"))&&n.value===t)return[i]}return[]}}),o.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,o=[],r=0,i=e.getElementsByTagName(t);if("*"===t){for(;n=i[r++];)1===n.nodeType&&o.push(n);return o}return i},o.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},y=[],m=[],(n.qsa=Q.test(p.querySelectorAll))&&(ut((function(t){d.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+P+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+P+"*(?:value|"+F+")"),t.querySelectorAll("[id~="+b+"-]").length||m.push("~="),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||m.push(".#.+[+~]")})),ut((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+P+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),d.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=Q.test(v=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ut((function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),y.push("!=",B)})),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),e=Q.test(d.compareDocumentPosition),C=e||Q.test(d.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,o=e&&e.parentNode;return t===o||!(!o||1!==o.nodeType||!(n.contains?n.contains(o):t.compareDocumentPosition&&16&t.compareDocumentPosition(o)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},R=e?function(t,e){if(t===e)return f=!0,0;var o=!t.compareDocumentPosition-!e.compareDocumentPosition;return o||(1&(o=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===o?t===p||t.ownerDocument===w&&C(w,t)?-1:e===p||e.ownerDocument===w&&C(w,e)?1:c?j(c,t)-j(c,e):0:4&o?-1:1)}:function(t,e){if(t===e)return f=!0,0;var n,o=0,r=t.parentNode,i=e.parentNode,a=[t],s=[e];if(!r||!i)return t===p?-1:e===p?1:r?-1:i?1:c?j(c,t)-j(c,e):0;if(r===i)return ft(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[o]===s[o];)o++;return o?ft(a[o],s[o]):a[o]===w?-1:s[o]===w?1:0},p):p},at.matches=function(t,e){return at(t,null,null,e)},at.matchesSelector=function(t,e){if((t.ownerDocument||t)!==p&&h(t),e=e.replace(W,"='$1']"),n.matchesSelector&&g&&!I[e+" "]&&(!y||!y.test(e))&&(!m||!m.test(e)))try{var o=v.call(t,e);if(o||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return o}catch(r){}return at(e,p,null,[t]).length>0},at.contains=function(t,e){return(t.ownerDocument||t)!==p&&h(t),C(t,e)},at.attr=function(t,e){(t.ownerDocument||t)!==p&&h(t);var r=o.attrHandle[e.toLowerCase()],i=r&&k.call(o.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==i?i:n.attributes||!g?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},at.escape=function(t){return(t+"").replace(et,ot)},at.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},at.uniqueSort=function(t){var e,o=[],r=0,i=0;if(f=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(R),f){for(;e=t[i++];)e===t[i]&&(r=o.push(i));for(;r--;)t.splice(o[r],1)}return c=null,t},r=at.getText=function(t){var e,n="",o=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[o++];)n+=r(e);return n},(o=at.selectors={cacheLength:50,createPseudo:lt,match:Y,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(K,tt),t[3]=(t[3]||t[4]||t[5]||"").replace(K,tt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||at.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&at.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return Y.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&U.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(K,tt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+P+")"+t+"("+P+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(o){var r=at.attr(o,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r.replace(G," ")+" ").indexOf(n)>-1:"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,o,r){var i="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===o&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var u,c,f,h,p,d,g=i!==a?"nextSibling":"previousSibling",m=e.parentNode,y=s&&e.nodeName.toLowerCase(),v=!l&&!s,C=!1;if(m){if(i){for(;g;){for(h=e;h=h[g];)if(s?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;d=g="only"===t&&!d&&"nextSibling"}return!0}if(d=[a?m.firstChild:m.lastChild],a&&v){for(C=(p=(u=(c=(f=(h=m)[b]||(h[b]={}))[h.uniqueID]||(f[h.uniqueID]={}))[t]||[])[0]===T&&u[1])&&u[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(C=p=0)||d.pop();)if(1===h.nodeType&&++C&&h===e){c[t]=[T,p,C];break}}else if(v&&(C=p=(u=(c=(f=(h=e)[b]||(h[b]={}))[h.uniqueID]||(f[h.uniqueID]={}))[t]||[])[0]===T&&u[1]),!1===C)for(;(h=++p&&h&&h[g]||(C=p=0)||d.pop())&&((s?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++C||(v&&((c=(f=h[b]||(h[b]={}))[h.uniqueID]||(f[h.uniqueID]={}))[t]=[T,C]),h!==e)););return(C-=r)===o||C%o==0&&C/o>=0}}},PSEUDO:function(t,e){var n,r=o.pseudos[t]||o.setFilters[t.toLowerCase()]||at.error("unsupported pseudo: "+t);return r[b]?r(e):r.length>1?(n=[t,t,"",e],o.setFilters.hasOwnProperty(t.toLowerCase())?lt((function(t,n){for(var o,i=r(t,e),a=i.length;a--;)t[o=j(t,i[a])]=!(n[o]=i[a])})):function(t){return r(t,0,n)}):r}},pseudos:{not:lt((function(t){var e=[],n=[],o=s(t.replace(H,"$1"));return o[b]?lt((function(t,e,n,r){for(var i,a=o(t,null,r,[]),s=t.length;s--;)(i=a[s])&&(t[s]=!(e[s]=i))})):function(t,r,i){return e[0]=t,o(e,null,i,n),e[0]=null,!n.pop()}})),has:lt((function(t){return function(e){return at(t,e).length>0}})),contains:lt((function(t){return t=t.replace(K,tt),function(e){return(e.textContent||e.innerText||r(e)).indexOf(t)>-1}})),lang:lt((function(t){return q.test(t||"")||at.error("unsupported lang: "+t),t=t.replace(K,tt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===d},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:dt(!1),disabled:dt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!o.pseudos.empty(t)},header:function(t){return Z.test(t.nodeName)},input:function(t){return X.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:gt((function(){return[0]})),last:gt((function(t,e){return[e-1]})),eq:gt((function(t,e,n){return[n<0?n+e:n]})),even:gt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:gt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:gt((function(t,e,n){for(var o=n<0?n+e:n;--o>=0;)t.push(o);return t})),gt:gt((function(t,e,n){for(var o=n<0?n+e:n;++o<e;)t.push(o);return t}))}}).pseudos.nth=o.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[e]=ht(e);for(e in{submit:!0,reset:!0})o.pseudos[e]=pt(e);function yt(){}function vt(t){for(var e=0,n=t.length,o="";e<n;e++)o+=t[e].value;return o}function Ct(t,e,n){var o=e.dir,r=e.next,i=r||o,a=n&&"parentNode"===i,s=x++;return e.first?function(e,n,r){for(;e=e[o];)if(1===e.nodeType||a)return t(e,n,r);return!1}:function(e,n,l){var u,c,f,h=[T,s];if(l){for(;e=e[o];)if((1===e.nodeType||a)&&t(e,n,l))return!0}else for(;e=e[o];)if(1===e.nodeType||a)if(c=(f=e[b]||(e[b]={}))[e.uniqueID]||(f[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[o]||e;else{if((u=c[i])&&u[0]===T&&u[1]===s)return h[2]=u[2];if(c[i]=h,h[2]=t(e,n,l))return!0}return!1}}function bt(t){return t.length>1?function(e,n,o){for(var r=t.length;r--;)if(!t[r](e,n,o))return!1;return!0}:t[0]}function wt(t,e,n,o,r){for(var i,a=[],s=0,l=t.length,u=null!=e;s<l;s++)(i=t[s])&&(n&&!n(i,o,r)||(a.push(i),u&&e.push(s)));return a}function Tt(t,e,n,o,r,i){return o&&!o[b]&&(o=Tt(o)),r&&!r[b]&&(r=Tt(r,i)),lt((function(i,a,s,l){var u,c,f,h=[],p=[],d=a.length,g=i||function(t,e,n){for(var o=0,r=e.length;o<r;o++)at(t,e[o],n);return n}(e||"*",s.nodeType?[s]:s,[]),m=!t||!i&&e?g:wt(g,h,t,s,l),y=n?r||(i?t:d||o)?[]:a:m;if(n&&n(m,y,s,l),o)for(u=wt(y,p),o(u,[],s,l),c=u.length;c--;)(f=u[c])&&(y[p[c]]=!(m[p[c]]=f));if(i){if(r||t){if(r){for(u=[],c=y.length;c--;)(f=y[c])&&u.push(m[c]=f);r(null,y=[],u,l)}for(c=y.length;c--;)(f=y[c])&&(u=r?j(i,f):h[c])>-1&&(i[u]=!(a[u]=f))}}else y=wt(y===a?y.splice(d,y.length):y),r?r(null,a,y,l):D.apply(a,y)}))}function xt(t){for(var e,n,r,i=t.length,a=o.relative[t[0].type],s=a||o.relative[" "],l=a?1:0,c=Ct((function(t){return t===e}),s,!0),f=Ct((function(t){return j(e,t)>-1}),s,!0),h=[function(t,n,o){var r=!a&&(o||n!==u)||((e=n).nodeType?c(t,n,o):f(t,n,o));return e=null,r}];l<i;l++)if(n=o.relative[t[l].type])h=[Ct(bt(h),n)];else{if((n=o.filter[t[l].type].apply(null,t[l].matches))[b]){for(r=++l;r<i&&!o.relative[t[r].type];r++);return Tt(l>1&&bt(h),l>1&&vt(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(H,"$1"),n,l<r&&xt(t.slice(l,r)),r<i&&xt(t=t.slice(r)),r<i&&vt(t))}h.push(n)}return bt(h)}function St(t,e){var n=e.length>0,r=t.length>0,i=function(i,a,s,l,c){var f,d,m,y=0,v="0",C=i&&[],b=[],w=u,x=i||r&&o.find.TAG("*",c),S=T+=null==w?1:Math.random()||.1,A=x.length;for(c&&(u=a===p||a||c);v!==A&&null!=(f=x[v]);v++){if(r&&f){for(d=0,a||f.ownerDocument===p||(h(f),s=!g);m=t[d++];)if(m(f,a||p,s)){l.push(f);break}c&&(T=S)}n&&((f=!m&&f)&&y--,i&&C.push(f))}if(y+=v,n&&v!==y){for(d=0;m=e[d++];)m(C,b,a,s);if(i){if(y>0)for(;v--;)C[v]||b[v]||(b[v]=N.call(l));b=wt(b)}D.apply(l,b),c&&!i&&b.length>0&&y+e.length>1&&at.uniqueSort(l)}return c&&(T=S,u=w),C};return n?lt(i):i}return yt.prototype=o.filters=o.pseudos,o.setFilters=new yt,a=at.tokenize=function(t,e){var n,r,i,a,s,l,u,c=A[t+" "];if(c)return e?0:c.slice(0);for(s=t,l=[],u=o.preFilter;s;){for(a in n&&!(r=V.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=z.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(H," ")}),s=s.slice(n.length)),o.filter)!(r=Y[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?at.error(t):A(t,l).slice(0)},s=at.compile=function(t,e){var n,o=[],r=[],i=I[t+" "];if(!i){for(e||(e=a(t)),n=e.length;n--;)(i=xt(e[n]))[b]?o.push(i):r.push(i);(i=I(t,St(r,o))).selector=t}return i},l=at.select=function(t,e,n,r){var i,l,u,c,f,h="function"==typeof t&&t,p=!r&&a(t=h.selector||t);if(n=n||[],1===p.length){if((l=p[0]=p[0].slice(0)).length>2&&"ID"===(u=l[0]).type&&9===e.nodeType&&g&&o.relative[l[1].type]){if(!(e=(o.find.ID(u.matches[0].replace(K,tt),e)||[])[0]))return n;h&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(i=Y.needsContext.test(t)?0:l.length;i--&&(u=l[i],!o.relative[c=u.type]);)if((f=o.find[c])&&(r=f(u.matches[0].replace(K,tt),$.test(l[0].type)&&mt(e.parentNode)||e))){if(l.splice(i,1),!(t=r.length&&vt(l)))return D.apply(n,r),n;break}}return(h||s(t,p))(r,e,!g,n,!e||$.test(t)&&mt(e.parentNode)||e),n},n.sortStable=b.split("").sort(R).join("")===b,n.detectDuplicates=!!f,h(),n.sortDetached=ut((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ut((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ct("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ut((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ct("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ut((function(t){return null==t.getAttribute("disabled")}))||ct(F,(function(t,e,n){var o;if(!n)return!0===t[e]?e.toLowerCase():(o=t.getAttributeNode(e))&&o.specified?o.value:null})),at}(t);y.find=x,y.expr=x.selectors,y.expr[":"]=y.expr.pseudos,y.uniqueSort=y.unique=x.uniqueSort,y.text=x.getText,y.isXMLDoc=x.isXML,y.contains=x.contains,y.escapeSelector=x.escape;var S=function(t,e,n){for(var o=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&y(t).is(n))break;o.push(t)}return o},A=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},I=y.expr.match.needsContext;function R(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var k=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i,M=/^.[^:#\[\.,]*$/;function N(t,e,n){return y.isFunction(e)?y.grep(t,(function(t,o){return!!e.call(t,o,t)!==n})):e.nodeType?y.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?y.grep(t,(function(t){return l.call(e,t)>-1!==n})):M.test(e)?y.filter(e,t,n):(e=y.filter(e,t),y.grep(t,(function(t){return l.call(e,t)>-1!==n&&1===t.nodeType})))}y.filter=function(t,e,n){var o=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===o.nodeType?y.find.matchesSelector(o,t)?[o]:[]:y.find.matches(t,y.grep(e,(function(t){return 1===t.nodeType})))},y.fn.extend({find:function(t){var e,n,o=this.length,r=this;if("string"!=typeof t)return this.pushStack(y(t).filter((function(){for(e=0;e<o;e++)if(y.contains(r[e],this))return!0})));for(n=this.pushStack([]),e=0;e<o;e++)y.find(t,r[e],n);return o>1?y.uniqueSort(n):n},filter:function(t){return this.pushStack(N(this,t||[],!1))},not:function(t){return this.pushStack(N(this,t||[],!0))},is:function(t){return!!N(this,"string"==typeof t&&I.test(t)?y(t):t||[],!1).length}});var E,D=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(y.fn.init=function(t,e,n){var r,i;if(!t)return this;if(n=n||E,"string"==typeof t){if(!(r="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:D.exec(t))||!r[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(r[1]){if(e=e instanceof y?e[0]:e,y.merge(this,y.parseHTML(r[1],e&&e.nodeType?e.ownerDocument||e:o,!0)),k.test(r[1])&&y.isPlainObject(e))for(r in e)y.isFunction(this[r])?this[r](e[r]):this.attr(r,e[r]);return this}return(i=o.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):y.isFunction(t)?void 0!==n.ready?n.ready(t):t(y):y.makeArray(t,this)}).prototype=y.fn,E=y(o);var O=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};function F(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}y.fn.extend({has:function(t){var e=y(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(y.contains(this,e[t]))return!0}))},closest:function(t,e){var n,o=0,r=this.length,i=[],a="string"!=typeof t&&y(t);if(!I.test(t))for(;o<r;o++)for(n=this[o];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&y.find.matchesSelector(n,t))){i.push(n);break}return this.pushStack(i.length>1?y.uniqueSort(i):i)},index:function(t){return t?"string"==typeof t?l.call(y(t),this[0]):l.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(y.uniqueSort(y.merge(this.get(),y(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),y.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return S(t,"parentNode")},parentsUntil:function(t,e,n){return S(t,"parentNode",n)},next:function(t){return F(t,"nextSibling")},prev:function(t){return F(t,"previousSibling")},nextAll:function(t){return S(t,"nextSibling")},prevAll:function(t){return S(t,"previousSibling")},nextUntil:function(t,e,n){return S(t,"nextSibling",n)},prevUntil:function(t,e,n){return S(t,"previousSibling",n)},siblings:function(t){return A((t.parentNode||{}).firstChild,t)},children:function(t){return A(t.firstChild)},contents:function(t){return R(t,"iframe")?t.contentDocument:(R(t,"template")&&(t=t.content||t),y.merge([],t.childNodes))}},(function(t,e){y.fn[t]=function(n,o){var r=y.map(this,e,n);return"Until"!==t.slice(-5)&&(o=n),o&&"string"==typeof o&&(r=y.filter(o,r)),this.length>1&&(j[t]||y.uniqueSort(r),O.test(t)&&r.reverse()),this.pushStack(r)}}));var P=/[^\x20\t\r\n\f]+/g;function _(t){return t}function L(t){throw t}function B(t,e,n,o){var r;try{t&&y.isFunction(r=t.promise)?r.call(t).done(e).fail(n):t&&y.isFunction(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(o))}catch(t){n.apply(void 0,[t])}}y.Callbacks=function(t){t="string"==typeof t?function(t){var e={};return y.each(t.match(P)||[],(function(t,n){e[n]=!0})),e}(t):y.extend({},t);var e,n,o,r,i=[],a=[],s=-1,l=function(){for(r=r||t.once,o=e=!0;a.length;s=-1)for(n=a.shift();++s<i.length;)!1===i[s].apply(n[0],n[1])&&t.stopOnFalse&&(s=i.length,n=!1);t.memory||(n=!1),e=!1,r&&(i=n?[]:"")},u={add:function(){return i&&(n&&!e&&(s=i.length-1,a.push(n)),function e(n){y.each(n,(function(n,o){y.isFunction(o)?t.unique&&u.has(o)||i.push(o):o&&o.length&&"string"!==y.type(o)&&e(o)}))}(arguments),n&&!e&&l()),this},remove:function(){return y.each(arguments,(function(t,e){for(var n;(n=y.inArray(e,i,n))>-1;)i.splice(n,1),n<=s&&s--})),this},has:function(t){return t?y.inArray(t,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return r=a=[],i=n="",this},disabled:function(){return!i},lock:function(){return r=a=[],n||e||(i=n=""),this},locked:function(){return!!r},fireWith:function(t,n){return r||(n=[t,(n=n||[]).slice?n.slice():n],a.push(n),e||l()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!o}};return u},y.extend({Deferred:function(e){var n=[["notify","progress",y.Callbacks("memory"),y.Callbacks("memory"),2],["resolve","done",y.Callbacks("once memory"),y.Callbacks("once memory"),0,"resolved"],["reject","fail",y.Callbacks("once memory"),y.Callbacks("once memory"),1,"rejected"]],o="pending",r={state:function(){return o},always:function(){return i.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return y.Deferred((function(e){y.each(n,(function(n,o){var r=y.isFunction(t[o[4]])&&t[o[4]];i[o[1]]((function(){var t=r&&r.apply(this,arguments);t&&y.isFunction(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[o[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(e,o,r){var i=0;function a(e,n,o,r){return function(){var s=this,l=arguments,u=function(){var t,u;if(!(e<i)){if((t=o.apply(s,l))===n.promise())throw new TypeError("Thenable self-resolution");u=t&&("object"==typeof t||"function"==typeof t)&&t.then,y.isFunction(u)?r?u.call(t,a(i,n,_,r),a(i,n,L,r)):(i++,u.call(t,a(i,n,_,r),a(i,n,L,r),a(i,n,_,n.notifyWith))):(o!==_&&(s=void 0,l=[t]),(r||n.resolveWith)(s,l))}},c=r?u:function(){try{u()}catch(t){y.Deferred.exceptionHook&&y.Deferred.exceptionHook(t,c.stackTrace),e+1>=i&&(o!==L&&(s=void 0,l=[t]),n.rejectWith(s,l))}};e?c():(y.Deferred.getStackHook&&(c.stackTrace=y.Deferred.getStackHook()),t.setTimeout(c))}}return y.Deferred((function(t){n[0][3].add(a(0,t,y.isFunction(r)?r:_,t.notifyWith)),n[1][3].add(a(0,t,y.isFunction(e)?e:_)),n[2][3].add(a(0,t,y.isFunction(o)?o:L))})).promise()},promise:function(t){return null!=t?y.extend(t,r):r}},i={};return y.each(n,(function(t,e){var a=e[2],s=e[5];r[e[1]]=a.add,s&&a.add((function(){o=s}),n[3-t][2].disable,n[0][2].lock),a.add(e[3].fire),i[e[0]]=function(){return i[e[0]+"With"](this===i?void 0:this,arguments),this},i[e[0]+"With"]=a.fireWith})),r.promise(i),e&&e.call(i,i),i},when:function(t){var e=arguments.length,n=e,o=Array(n),r=i.call(arguments),a=y.Deferred(),s=function(t){return function(n){o[t]=this,r[t]=arguments.length>1?i.call(arguments):n,--e||a.resolveWith(o,r)}};if(e<=1&&(B(t,a.done(s(n)).resolve,a.reject,!e),"pending"===a.state()||y.isFunction(r[n]&&r[n].then)))return a.then();for(;n--;)B(r[n],s(n),a.reject);return a.promise()}});var G=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;y.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&G.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},y.readyException=function(e){t.setTimeout((function(){throw e}))};var H=y.Deferred();function V(){o.removeEventListener("DOMContentLoaded",V),t.removeEventListener("load",V),y.ready()}y.fn.ready=function(t){return H.then(t).catch((function(t){y.readyException(t)})),this},y.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--y.readyWait:y.isReady)||(y.isReady=!0,!0!==t&&--y.readyWait>0||H.resolveWith(o,[y]))}}),y.ready.then=H.then,"complete"===o.readyState||"loading"!==o.readyState&&!o.documentElement.doScroll?t.setTimeout(y.ready):(o.addEventListener("DOMContentLoaded",V),t.addEventListener("load",V));var z=function(t,e,n,o,r,i,a){var s=0,l=t.length,u=null==n;if("object"===y.type(n))for(s in r=!0,n)z(t,e,s,n[s],!0,i,a);else if(void 0!==o&&(r=!0,y.isFunction(o)||(a=!0),u&&(a?(e.call(t,o),e=null):(u=e,e=function(t,e,n){return u.call(y(t),n)})),e))for(;s<l;s++)e(t[s],n,a?o:o.call(t[s],s,e(t[s],n)));return r?t:u?e.call(t):l?e(t[0],n):i},W=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function U(){this.expando=y.expando+U.uid++}U.uid=1,U.prototype={cache:function(t){var e=t[this.expando];return e||(e={},W(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var o,r=this.cache(t);if("string"==typeof e)r[y.camelCase(e)]=n;else for(o in e)r[y.camelCase(o)]=e[o];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][y.camelCase(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,o=t[this.expando];if(void 0!==o){if(void 0!==e){Array.isArray(e)?e=e.map(y.camelCase):e=(e=y.camelCase(e))in o?[e]:e.match(P)||[],n=e.length;for(;n--;)delete o[e[n]]}(void 0===e||y.isEmptyObject(o))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!y.isEmptyObject(e)}};var q=new U,Y=new U,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z=/[A-Z]/g;function Q(t,e,n){var o;if(void 0===n&&1===t.nodeType)if(o="data-"+e.replace(Z,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(o))){try{n=function(t){return"true"===t||"false"!==t&&("null"===t?null:t===+t+""?+t:X.test(t)?JSON.parse(t):t)}(n)}catch(r){}Y.set(t,e,n)}else n=void 0;return n}y.extend({hasData:function(t){return Y.hasData(t)||q.hasData(t)},data:function(t,e,n){return Y.access(t,e,n)},removeData:function(t,e){Y.remove(t,e)},_data:function(t,e,n){return q.access(t,e,n)},_removeData:function(t,e){q.remove(t,e)}}),y.fn.extend({data:function(t,e){var n,o,r,i=this[0],a=i&&i.attributes;if(void 0===t){if(this.length&&(r=Y.get(i),1===i.nodeType&&!q.get(i,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(0===(o=a[n].name).indexOf("data-")&&(o=y.camelCase(o.slice(5)),Q(i,o,r[o])));q.set(i,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){Y.set(this,t)})):z(this,(function(e){var n;if(i&&void 0===e){if(void 0!==(n=Y.get(i,t)))return n;if(void 0!==(n=Q(i,t)))return n}else this.each((function(){Y.set(this,t,e)}))}),null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each((function(){Y.remove(this,t)}))}}),y.extend({queue:function(t,e,n){var o;if(t)return e=(e||"fx")+"queue",o=q.get(t,e),n&&(!o||Array.isArray(n)?o=q.access(t,e,y.makeArray(n)):o.push(n)),o||[]},dequeue:function(t,e){e=e||"fx";var n=y.queue(t,e),o=n.length,r=n.shift(),i=y._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),o--),r&&("fx"===e&&n.unshift("inprogress"),delete i.stop,r.call(t,(function(){y.dequeue(t,e)}),i)),!o&&i&&i.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return q.get(t,n)||q.access(t,n,{empty:y.Callbacks("once memory").add((function(){q.remove(t,[e+"queue",n])}))})}}),y.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?y.queue(this[0],t):void 0===e?this:this.each((function(){var n=y.queue(this,t,e);y._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&y.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){y.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,o=1,r=y.Deferred(),i=this,a=this.length,s=function(){--o||r.resolveWith(i,[i])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=q.get(i[a],t+"queueHooks"))&&n.empty&&(o++,n.empty.add(s));return s(),r.promise(e)}});var J=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,$=new RegExp("^(?:([+-])=|)("+J+")([a-z%]*)$","i"),K=["Top","Right","Bottom","Left"],tt=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&y.contains(t.ownerDocument,t)&&"none"===y.css(t,"display")},et=function(t,e,n,o){var r,i,a={};for(i in e)a[i]=t.style[i],t.style[i]=e[i];for(i in r=n.apply(t,o||[]),e)t.style[i]=a[i];return r};function nt(t,e,n,o){var r,i=1,a=20,s=o?function(){return o.cur()}:function(){return y.css(t,e,"")},l=s(),u=n&&n[3]||(y.cssNumber[e]?"":"px"),c=(y.cssNumber[e]||"px"!==u&&+l)&&$.exec(y.css(t,e));if(c&&c[3]!==u){u=u||c[3],n=n||[],c=+l||1;do{c/=i=i||".5",y.style(t,e,c+u)}while(i!==(i=s()/l)&&1!==i&&--a)}return n&&(c=+c||+l||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2],o&&(o.unit=u,o.start=c,o.end=r)),r}var ot={};function rt(t){var e,n=t.ownerDocument,o=t.nodeName,r=ot[o];return r||(e=n.body.appendChild(n.createElement(o)),r=y.css(e,"display"),e.parentNode.removeChild(e),"none"===r&&(r="block"),ot[o]=r,r)}function it(t,e){for(var n,o,r=[],i=0,a=t.length;i<a;i++)(o=t[i]).style&&(n=o.style.display,e?("none"===n&&(r[i]=q.get(o,"display")||null,r[i]||(o.style.display="")),""===o.style.display&&tt(o)&&(r[i]=rt(o))):"none"!==n&&(r[i]="none",q.set(o,"display",n)));for(i=0;i<a;i++)null!=r[i]&&(t[i].style.display=r[i]);return t}y.fn.extend({show:function(){return it(this,!0)},hide:function(){return it(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){tt(this)?y(this).show():y(this).hide()}))}});var at=/^(?:checkbox|radio)$/i,st=/<([a-z][^\/\0>\x20\t\r\n\f]+)/i,lt=/^$|\/(?:java|ecma)script/i,ut={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function ct(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&R(t,e)?y.merge([t],n):n}function ft(t,e){for(var n=0,o=t.length;n<o;n++)q.set(t[n],"globalEval",!e||q.get(e[n],"globalEval"))}ut.optgroup=ut.option,ut.tbody=ut.tfoot=ut.colgroup=ut.caption=ut.thead,ut.th=ut.td;var ht=/<|&#?\w+;/;function pt(t,e,n,o,r){for(var i,a,s,l,u,c,f=e.createDocumentFragment(),h=[],p=0,d=t.length;p<d;p++)if((i=t[p])||0===i)if("object"===y.type(i))y.merge(h,i.nodeType?[i]:i);else if(ht.test(i)){for(a=a||f.appendChild(e.createElement("div")),s=(st.exec(i)||["",""])[1].toLowerCase(),l=ut[s]||ut._default,a.innerHTML=l[1]+y.htmlPrefilter(i)+l[2],c=l[0];c--;)a=a.lastChild;y.merge(h,a.childNodes),(a=f.firstChild).textContent=""}else h.push(e.createTextNode(i));for(f.textContent="",p=0;i=h[p++];)if(o&&y.inArray(i,o)>-1)r&&r.push(i);else if(u=y.contains(i.ownerDocument,i),a=ct(f.appendChild(i),"script"),u&&ft(a),n)for(c=0;i=a[c++];)lt.test(i.type||"")&&n.push(i);return f}!function(){var t=o.createDocumentFragment().appendChild(o.createElement("div")),e=o.createElement("input");e.setAttribute("type","radio"),e.setAttribute("checked","checked"),e.setAttribute("name","t"),t.appendChild(e),d.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,t.innerHTML="<textarea>x</textarea>",d.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue}();var dt=o.documentElement,gt=/^key/,mt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,yt=/^([^.]*)(?:\.(.+)|)/;function vt(){return!0}function Ct(){return!1}function bt(){try{return o.activeElement}catch(t){}}function wt(t,e,n,o,r,i){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(o=o||n,n=void 0),e)wt(t,s,n,o,e[s],i);return t}if(null==o&&null==r?(r=n,o=n=void 0):null==r&&("string"==typeof n?(r=o,o=void 0):(r=o,o=n,n=void 0)),!1===r)r=Ct;else if(!r)return t;return 1===i&&(a=r,(r=function(t){return y().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=y.guid++)),t.each((function(){y.event.add(this,e,r,o,n)}))}y.event={global:{},add:function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=q.get(t);if(m)for(n.handler&&(n=(i=n).handler,r=i.selector),r&&y.find.matchesSelector(dt,r),n.guid||(n.guid=y.guid++),(l=m.events)||(l=m.events={}),(a=m.handle)||(a=m.handle=function(e){return void 0!==y&&y.event.triggered!==e.type?y.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(P)||[""]).length;u--;)p=g=(s=yt.exec(e[u])||[])[1],d=(s[2]||"").split(".").sort(),p&&(f=y.event.special[p]||{},p=(r?f.delegateType:f.bindType)||p,f=y.event.special[p]||{},c=y.extend({type:p,origType:g,data:o,handler:n,guid:n.guid,selector:r,needsContext:r&&y.expr.match.needsContext.test(r),namespace:d.join(".")},i),(h=l[p])||((h=l[p]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,o,d,a)||t.addEventListener&&t.addEventListener(p,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,c):h.push(c),y.event.global[p]=!0)},remove:function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=q.hasData(t)&&q.get(t);if(m&&(l=m.events)){for(u=(e=(e||"").match(P)||[""]).length;u--;)if(p=g=(s=yt.exec(e[u])||[])[1],d=(s[2]||"").split(".").sort(),p){for(f=y.event.special[p]||{},h=l[p=(o?f.delegateType:f.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=i=h.length;i--;)c=h[i],!r&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||o&&o!==c.selector&&("**"!==o||!c.selector)||(h.splice(i,1),c.selector&&h.delegateCount--,f.remove&&f.remove.call(t,c));a&&!h.length&&(f.teardown&&!1!==f.teardown.call(t,d,m.handle)||y.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)y.event.remove(t,p+e[u],n,o,!0);y.isEmptyObject(l)&&q.remove(t,"handle events")}},dispatch:function(t){var e,n,o,r,i,a,s=y.event.fix(t),l=new Array(arguments.length),u=(q.get(this,"events")||{})[s.type]||[],c=y.event.special[s.type]||{};for(l[0]=s,e=1;e<arguments.length;e++)l[e]=arguments[e];if(s.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,s)){for(a=y.event.handlers.call(this,s,u),e=0;(r=a[e++])&&!s.isPropagationStopped();)for(s.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!s.isImmediatePropagationStopped();)s.rnamespace&&!s.rnamespace.test(i.namespace)||(s.handleObj=i,s.data=i.data,void 0!==(o=((y.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,l))&&!1===(s.result=o)&&(s.preventDefault(),s.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,s),s.result}},handlers:function(t,e){var n,o,r,i,a,s=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&!("click"===t.type&&t.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(i=[],a={},n=0;n<l;n++)void 0===a[r=(o=e[n]).selector+" "]&&(a[r]=o.needsContext?y(r,this).index(u)>-1:y.find(r,this,null,[u]).length),a[r]&&i.push(o);i.length&&s.push({elem:u,handlers:i})}return u=this,l<e.length&&s.push({elem:u,handlers:e.slice(l)}),s},addProp:function(t,e){Object.defineProperty(y.Event.prototype,t,{enumerable:!0,configurable:!0,get:y.isFunction(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[y.expando]?t:new y.Event(t)},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==bt()&&this.focus)return this.focus(),!1},delegateType:"focusin"},blur:{trigger:function(){if(this===bt()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(at.test(this.type)&&this.click&&R(this,"input"))return this.click(),!1},_default:function(t){return R(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},y.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},y.Event=function(t,e){return this instanceof y.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?vt:Ct,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&y.extend(this,e),this.timeStamp=t&&t.timeStamp||y.now(),void(this[y.expando]=!0)):new y.Event(t,e)},y.Event.prototype={constructor:y.Event,isDefaultPrevented:Ct,isPropagationStopped:Ct,isImmediatePropagationStopped:Ct,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=vt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=vt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=vt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},y.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&gt.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&mt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},y.event.addProp),y.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){y.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,o=this,r=t.relatedTarget,i=t.handleObj;return r&&(r===o||y.contains(o,r))||(t.type=i.origType,n=i.handler.apply(this,arguments),t.type=e),n}}})),y.fn.extend({on:function(t,e,n,o){return wt(this,t,e,n,o)},one:function(t,e,n,o){return wt(this,t,e,n,o,1)},off:function(t,e,n){var o,r;if(t&&t.preventDefault&&t.handleObj)return o=t.handleObj,y(t.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=Ct),this.each((function(){y.event.remove(this,t,n,e)}))}});var Tt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([a-z][^\/\0>\x20\t\r\n\f]*)[^>]*)\/>/gi,xt=/<script|<style|<link/i,St=/checked\s*(?:[^=]|=\s*.checked.)/i,At=/^true\/(.*)/,It=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Rt(t,e){return R(t,"table")&&R(11!==e.nodeType?e:e.firstChild,"tr")&&y(">tbody",t)[0]||t}function kt(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Mt(t){var e=At.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function Nt(t,e){var n,o,r,i,a,s,l,u;if(1===e.nodeType){if(q.hasData(t)&&(i=q.access(t),a=q.set(e,i),u=i.events))for(r in delete a.handle,a.events={},u)for(n=0,o=u[r].length;n<o;n++)y.event.add(e,r,u[r][n]);Y.hasData(t)&&(s=Y.access(t),l=y.extend({},s),Y.set(e,l))}}function Et(t,e){var n=e.nodeName.toLowerCase();"input"===n&&at.test(t.type)?e.checked=t.checked:"input"!==n&&"textarea"!==n||(e.defaultValue=t.defaultValue)}function Dt(t,e,n,o){e=a.apply([],e);var r,i,s,l,u,c,f=0,h=t.length,p=h-1,m=e[0],v=y.isFunction(m);if(v||h>1&&"string"==typeof m&&!d.checkClone&&St.test(m))return t.each((function(r){var i=t.eq(r);v&&(e[0]=m.call(this,r,i.html())),Dt(i,e,n,o)}));if(h&&(i=(r=pt(e,t[0].ownerDocument,!1,t,o)).firstChild,1===r.childNodes.length&&(r=i),i||o)){for(l=(s=y.map(ct(r,"script"),kt)).length;f<h;f++)u=r,f!==p&&(u=y.clone(u,!0,!0),l&&y.merge(s,ct(u,"script"))),n.call(t[f],u,f);if(l)for(c=s[s.length-1].ownerDocument,y.map(s,Mt),f=0;f<l;f++)u=s[f],lt.test(u.type||"")&&!q.access(u,"globalEval")&&y.contains(c,u)&&(u.src?y._evalUrl&&y._evalUrl(u.src):g(u.textContent.replace(It,""),c))}return t}function Ot(t,e,n){for(var o,r=e?y.filter(e,t):t,i=0;null!=(o=r[i]);i++)n||1!==o.nodeType||y.cleanData(ct(o)),o.parentNode&&(n&&y.contains(o.ownerDocument,o)&&ft(ct(o,"script")),o.parentNode.removeChild(o));return t}y.extend({htmlPrefilter:function(t){return t.replace(Tt,"<$1></$2>")},clone:function(t,e,n){var o,r,i,a,s=t.cloneNode(!0),l=y.contains(t.ownerDocument,t);if(!(d.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||y.isXMLDoc(t)))for(a=ct(s),o=0,r=(i=ct(t)).length;o<r;o++)Et(i[o],a[o]);if(e)if(n)for(i=i||ct(t),a=a||ct(s),o=0,r=i.length;o<r;o++)Nt(i[o],a[o]);else Nt(t,s);return(a=ct(s,"script")).length>0&&ft(a,!l&&ct(t,"script")),s},cleanData:function(t){for(var e,n,o,r=y.event.special,i=0;void 0!==(n=t[i]);i++)if(W(n)){if(e=n[q.expando]){if(e.events)for(o in e.events)r[o]?y.event.remove(n,o):y.removeEvent(n,o,e.handle);n[q.expando]=void 0}n[Y.expando]&&(n[Y.expando]=void 0)}}}),y.fn.extend({detach:function(t){return Ot(this,t,!0)},remove:function(t){return Ot(this,t)},text:function(t){return z(this,(function(t){return void 0===t?y.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return Dt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Rt(this,t).appendChild(t)}))},prepend:function(){return Dt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Rt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return Dt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return Dt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(y.cleanData(ct(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return y.clone(this,t,e)}))},html:function(t){return z(this,(function(t){var e=this[0]||{},n=0,o=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!xt.test(t)&&!ut[(st.exec(t)||["",""])[1].toLowerCase()]){t=y.htmlPrefilter(t);try{for(;n<o;n++)1===(e=this[n]||{}).nodeType&&(y.cleanData(ct(e,!1)),e.innerHTML=t);e=0}catch(r){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return Dt(this,arguments,(function(e){var n=this.parentNode;y.inArray(this,t)<0&&(y.cleanData(ct(this)),n&&n.replaceChild(e,this))}),t)}}),y.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){y.fn[t]=function(t){for(var n,o=[],r=y(t),i=r.length-1,a=0;a<=i;a++)n=a===i?this:this.clone(!0),y(r[a])[e](n),s.apply(o,n.get());return this.pushStack(o)}}));var jt=/^margin/,Ft=new RegExp("^("+J+")(?!px)[a-z%]+$","i"),Pt=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)};function _t(t,e,n){var o,r,i,a,s=t.style;return(n=n||Pt(t))&&(""!==(a=n.getPropertyValue(e)||n[e])||y.contains(t.ownerDocument,t)||(a=y.style(t,e)),!d.pixelMarginRight()&&Ft.test(a)&&jt.test(e)&&(o=s.width,r=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=o,s.minWidth=r,s.maxWidth=i)),void 0!==a?a+"":a}function Lt(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}!function(){function e(){if(l){l.style.cssText="box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%",l.innerHTML="",dt.appendChild(s);var e=t.getComputedStyle(l);n="1%"!==e.top,a="2px"===e.marginLeft,r="4px"===e.width,l.style.marginRight="50%",i="4px"===e.marginRight,dt.removeChild(s),l=null}}var n,r,i,a,s=o.createElement("div"),l=o.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===l.style.backgroundClip,s.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute",s.appendChild(l),y.extend(d,{pixelPosition:function(){return e(),n},boxSizingReliable:function(){return e(),r},pixelMarginRight:function(){return e(),i},reliableMarginLeft:function(){return e(),a}}))}();var Bt=/^(none|table(?!-c[ea]).+)/,Gt=/^--/,Ht={position:"absolute",visibility:"hidden",display:"block"},Vt={letterSpacing:"0",fontWeight:"400"},zt=["Webkit","Moz","ms"],Wt=o.createElement("div").style;function Ut(t){var e=y.cssProps[t];return e||(e=y.cssProps[t]=function(t){if(t in Wt)return t;for(var e=t[0].toUpperCase()+t.slice(1),n=zt.length;n--;)if((t=zt[n]+e)in Wt)return t}(t)||t),e}function qt(t,e,n){var o=$.exec(e);return o?Math.max(0,o[2]-(n||0))+(o[3]||"px"):e}function Yt(t,e,n,o,r){var i,a=0;for(i=n===(o?"border":"content")?4:"width"===e?1:0;i<4;i+=2)"margin"===n&&(a+=y.css(t,n+K[i],!0,r)),o?("content"===n&&(a-=y.css(t,"padding"+K[i],!0,r)),"margin"!==n&&(a-=y.css(t,"border"+K[i]+"Width",!0,r))):(a+=y.css(t,"padding"+K[i],!0,r),"padding"!==n&&(a+=y.css(t,"border"+K[i]+"Width",!0,r)));return a}function Xt(t,e,n){var o,r=Pt(t),i=_t(t,e,r),a="border-box"===y.css(t,"boxSizing",!1,r);return Ft.test(i)?i:(o=a&&(d.boxSizingReliable()||i===t.style[e]),(i=parseFloat(i)||0)+Yt(t,e,n||(a?"border":"content"),o,r)+"px")}function Zt(t,e,n,o,r){return new Zt.prototype.init(t,e,n,o,r)}y.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=_t(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(t,e,n,o){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,i,a,s=y.camelCase(e),l=Gt.test(e),u=t.style;return l||(e=Ut(s)),a=y.cssHooks[e]||y.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(r=a.get(t,!1,o))?r:u[e]:("string"===(i=typeof n)&&(r=$.exec(n))&&r[1]&&(n=nt(t,e,r),i="number"),void(null!=n&&n==n&&("number"===i&&(n+=r&&r[3]||(y.cssNumber[s]?"":"px")),d.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,o))||(l?u.setProperty(e,n):u[e]=n))))}},css:function(t,e,n,o){var r,i,a,s=y.camelCase(e);return Gt.test(e)||(e=Ut(s)),(a=y.cssHooks[e]||y.cssHooks[s])&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=_t(t,e,o)),"normal"===r&&e in Vt&&(r=Vt[e]),""===n||n?(i=parseFloat(r),!0===n||isFinite(i)?i||0:r):r}}),y.each(["height","width"],(function(t,e){y.cssHooks[e]={get:function(t,n,o){if(n)return!Bt.test(y.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?Xt(t,e,o):et(t,Ht,(function(){return Xt(t,e,o)}))},set:function(t,n,o){var r,i=o&&Pt(t),a=o&&Yt(t,e,o,"border-box"===y.css(t,"boxSizing",!1,i),i);return a&&(r=$.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=y.css(t,e)),qt(0,n,a)}}})),y.cssHooks.marginLeft=Lt(d.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(_t(t,"marginLeft"))||t.getBoundingClientRect().left-et(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),y.each({margin:"",padding:"",border:"Width"},(function(t,e){y.cssHooks[t+e]={expand:function(n){for(var o=0,r={},i="string"==typeof n?n.split(" "):[n];o<4;o++)r[t+K[o]+e]=i[o]||i[o-2]||i[0];return r}},jt.test(t)||(y.cssHooks[t+e].set=qt)})),y.fn.extend({css:function(t,e){return z(this,(function(t,e,n){var o,r,i={},a=0;if(Array.isArray(e)){for(o=Pt(t),r=e.length;a<r;a++)i[e[a]]=y.css(t,e[a],!1,o);return i}return void 0!==n?y.style(t,e,n):y.css(t,e)}),t,e,arguments.length>1)}}),y.Tween=Zt,Zt.prototype={constructor:Zt,init:function(t,e,n,o,r,i){this.elem=t,this.prop=n,this.easing=r||y.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=o,this.unit=i||(y.cssNumber[n]?"":"px")},cur:function(){var t=Zt.propHooks[this.prop];return t&&t.get?t.get(this):Zt.propHooks._default.get(this)},run:function(t){var e,n=Zt.propHooks[this.prop];return this.options.duration?this.pos=e=y.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):Zt.propHooks._default.set(this),this}},Zt.prototype.init.prototype=Zt.prototype,Zt.propHooks={_default:{get:function(t){var e;return 1!==t.elem.nodeType||null!=t.elem[t.prop]&&null==t.elem.style[t.prop]?t.elem[t.prop]:(e=y.css(t.elem,t.prop,""))&&"auto"!==e?e:0},set:function(t){y.fx.step[t.prop]?y.fx.step[t.prop](t):1!==t.elem.nodeType||null==t.elem.style[y.cssProps[t.prop]]&&!y.cssHooks[t.prop]?t.elem[t.prop]=t.now:y.style(t.elem,t.prop,t.now+t.unit)}}},Zt.propHooks.scrollTop=Zt.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},y.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2},_default:"swing"},y.fx=Zt.prototype.init,y.fx.step={};var Qt,Jt,$t=/^(?:toggle|show|hide)$/,Kt=/queueHooks$/;function te(){Jt&&(!1===o.hidden&&t.requestAnimationFrame?t.requestAnimationFrame(te):t.setTimeout(te,y.fx.interval),y.fx.tick())}function ee(){return t.setTimeout((function(){Qt=void 0})),Qt=y.now()}function ne(t,e){var n,o=0,r={height:t};for(e=e?1:0;o<4;o+=2-e)r["margin"+(n=K[o])]=r["padding"+n]=t;return e&&(r.opacity=r.width=t),r}function oe(t,e,n){for(var o,r=(re.tweeners[e]||[]).concat(re.tweeners["*"]),i=0,a=r.length;i<a;i++)if(o=r[i].call(n,e,t))return o}function re(t,e,n){var o,r,i=0,a=re.prefilters.length,s=y.Deferred().always((function(){delete l.elem})),l=function(){if(r)return!1;for(var e=Qt||ee(),n=Math.max(0,u.startTime+u.duration-e),o=1-(n/u.duration||0),i=0,a=u.tweens.length;i<a;i++)u.tweens[i].run(o);return s.notifyWith(t,[u,o,n]),o<1&&a?n:(a||s.notifyWith(t,[u,1,0]),s.resolveWith(t,[u]),!1)},u=s.promise({elem:t,props:y.extend({},e),opts:y.extend(!0,{specialEasing:{},easing:y.easing._default},n),originalProperties:e,originalOptions:n,startTime:Qt||ee(),duration:n.duration,tweens:[],createTween:function(e,n){var o=y.Tween(t,u.opts,e,n,u.opts.specialEasing[e]||u.opts.easing);return u.tweens.push(o),o},stop:function(e){var n=0,o=e?u.tweens.length:0;if(r)return this;for(r=!0;n<o;n++)u.tweens[n].run(1);return e?(s.notifyWith(t,[u,1,0]),s.resolveWith(t,[u,e])):s.rejectWith(t,[u,e]),this}}),c=u.props;for(function(t,e){var n,o,r,i,a;for(n in t)if(r=e[o=y.camelCase(n)],i=t[n],Array.isArray(i)&&(r=i[1],i=t[n]=i[0]),n!==o&&(t[o]=i,delete t[n]),(a=y.cssHooks[o])&&"expand"in a)for(n in i=a.expand(i),delete t[o],i)n in t||(t[n]=i[n],e[n]=r);else e[o]=r}(c,u.opts.specialEasing);i<a;i++)if(o=re.prefilters[i].call(u,t,c,u.opts))return y.isFunction(o.stop)&&(y._queueHooks(u.elem,u.opts.queue).stop=y.proxy(o.stop,o)),o;return y.map(c,oe,u),y.isFunction(u.opts.start)&&u.opts.start.call(t,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),y.fx.timer(y.extend(l,{elem:t,anim:u,queue:u.opts.queue})),u}y.Animation=y.extend(re,{tweeners:{"*":[function(t,e){var n=this.createTween(t,e);return nt(n.elem,t,$.exec(e),n),n}]},tweener:function(t,e){y.isFunction(t)?(e=t,t=["*"]):t=t.match(P);for(var n,o=0,r=t.length;o<r;o++)n=t[o],re.tweeners[n]=re.tweeners[n]||[],re.tweeners[n].unshift(e)},prefilters:[function(t,e,n){var o,r,i,a,s,l,u,c,f="width"in e||"height"in e,h=this,p={},d=t.style,g=t.nodeType&&tt(t),m=q.get(t,"fxshow");for(o in n.queue||(null==(a=y._queueHooks(t,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,h.always((function(){h.always((function(){a.unqueued--,y.queue(t,"fx").length||a.empty.fire()}))}))),e)if(r=e[o],$t.test(r)){if(delete e[o],i=i||"toggle"===r,r===(g?"hide":"show")){if("show"!==r||!m||void 0===m[o])continue;g=!0}p[o]=m&&m[o]||y.style(t,o)}if((l=!y.isEmptyObject(e))||!y.isEmptyObject(p))for(o in f&&1===t.nodeType&&(n.overflow=[d.overflow,d.overflowX,d.overflowY],null==(u=m&&m.display)&&(u=q.get(t,"display")),"none"===(c=y.css(t,"display"))&&(u?c=u:(it([t],!0),u=t.style.display||u,c=y.css(t,"display"),it([t]))),("inline"===c||"inline-block"===c&&null!=u)&&"none"===y.css(t,"float")&&(l||(h.done((function(){d.display=u})),null==u&&(c=d.display,u="none"===c?"":c)),d.display="inline-block")),n.overflow&&(d.overflow="hidden",h.always((function(){d.overflow=n.overflow[0],d.overflowX=n.overflow[1],d.overflowY=n.overflow[2]}))),l=!1,p)l||(m?"hidden"in m&&(g=m.hidden):m=q.access(t,"fxshow",{display:u}),i&&(m.hidden=!g),g&&it([t],!0),h.done((function(){for(o in g||it([t]),q.remove(t,"fxshow"),p)y.style(t,o,p[o])}))),l=oe(g?m[o]:0,o,h),o in m||(m[o]=l.start,g&&(l.end=l.start,l.start=0))}],prefilter:function(t,e){e?re.prefilters.unshift(t):re.prefilters.push(t)}}),y.speed=function(t,e,n){var o=t&&"object"==typeof t?y.extend({},t):{complete:n||!n&&e||y.isFunction(t)&&t,duration:t,easing:n&&e||e&&!y.isFunction(e)&&e};return y.fx.off?o.duration=0:"number"!=typeof o.duration&&(o.duration in y.fx.speeds?o.duration=y.fx.speeds[o.duration]:o.duration=y.fx.speeds._default),null!=o.queue&&!0!==o.queue||(o.queue="fx"),o.old=o.complete,o.complete=function(){y.isFunction(o.old)&&o.old.call(this),o.queue&&y.dequeue(this,o.queue)},o},y.fn.extend({fadeTo:function(t,e,n,o){return this.filter(tt).css("opacity",0).show().end().animate({opacity:e},t,n,o)},animate:function(t,e,n,o){var r=y.isEmptyObject(t),i=y.speed(e,n,o),a=function(){var e=re(this,y.extend({},t),i);(r||q.get(this,"finish"))&&e.stop(!0)};return a.finish=a,r||!1===i.queue?this.each(a):this.queue(i.queue,a)},stop:function(t,e,n){var o=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&!1!==t&&this.queue(t||"fx",[]),this.each((function(){var e=!0,r=null!=t&&t+"queueHooks",i=y.timers,a=q.get(this);if(r)a[r]&&a[r].stop&&o(a[r]);else for(r in a)a[r]&&a[r].stop&&Kt.test(r)&&o(a[r]);for(r=i.length;r--;)i[r].elem!==this||null!=t&&i[r].queue!==t||(i[r].anim.stop(n),e=!1,i.splice(r,1));!e&&n||y.dequeue(this,t)}))},finish:function(t){return!1!==t&&(t=t||"fx"),this.each((function(){var e,n=q.get(this),o=n[t+"queue"],r=n[t+"queueHooks"],i=y.timers,a=o?o.length:0;for(n.finish=!0,y.queue(this,t,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===t&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<a;e++)o[e]&&o[e].finish&&o[e].finish.call(this);delete n.finish}))}}),y.each(["toggle","show","hide"],(function(t,e){var n=y.fn[e];y.fn[e]=function(t,o,r){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(ne(e,!0),t,o,r)}})),y.each({slideDown:ne("show"),slideUp:ne("hide"),slideToggle:ne("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(t,e){y.fn[t]=function(t,n,o){return this.animate(e,t,n,o)}})),y.timers=[],y.fx.tick=function(){var t,e=0,n=y.timers;for(Qt=y.now();e<n.length;e++)(t=n[e])()||n[e]!==t||n.splice(e--,1);n.length||y.fx.stop(),Qt=void 0},y.fx.timer=function(t){y.timers.push(t),y.fx.start()},y.fx.interval=13,y.fx.start=function(){Jt||(Jt=!0,te())},y.fx.stop=function(){Jt=null},y.fx.speeds={slow:600,fast:200,_default:400},y.fn.delay=function(e,n){return e=y.fx&&y.fx.speeds[e]||e,n=n||"fx",this.queue(n,(function(n,o){var r=t.setTimeout(n,e);o.stop=function(){t.clearTimeout(r)}}))},function(){var t=o.createElement("input"),e=o.createElement("select").appendChild(o.createElement("option"));t.type="checkbox",d.checkOn=""!==t.value,d.optSelected=e.selected,(t=o.createElement("input")).value="t",t.type="radio",d.radioValue="t"===t.value}();var ie,ae=y.expr.attrHandle;y.fn.extend({attr:function(t,e){return z(this,y.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each((function(){y.removeAttr(this,t)}))}}),y.extend({attr:function(t,e,n){var o,r,i=t.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===t.getAttribute?y.prop(t,e,n):(1===i&&y.isXMLDoc(t)||(r=y.attrHooks[e.toLowerCase()]||(y.expr.match.bool.test(e)?ie:void 0)),void 0!==n?null===n?void y.removeAttr(t,e):r&&"set"in r&&void 0!==(o=r.set(t,n,e))?o:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(o=r.get(t,e))?o:null==(o=y.find.attr(t,e))?void 0:o)},attrHooks:{type:{set:function(t,e){if(!d.radioValue&&"radio"===e&&R(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,o=0,r=e&&e.match(P);if(r&&1===t.nodeType)for(;n=r[o++];)t.removeAttribute(n)}}),ie={set:function(t,e,n){return!1===e?y.removeAttr(t,n):t.setAttribute(n,n),n}},y.each(y.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=ae[e]||y.find.attr;ae[e]=function(t,e,o){var r,i,a=e.toLowerCase();return o||(i=ae[a],ae[a]=r,r=null!=n(t,e,o)?a:null,ae[a]=i),r}}));var se=/^(?:input|select|textarea|button)$/i,le=/^(?:a|area)$/i;function ue(t){return(t.match(P)||[]).join(" ")}function ce(t){return t.getAttribute&&t.getAttribute("class")||""}y.fn.extend({prop:function(t,e){return z(this,y.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each((function(){delete this[y.propFix[t]||t]}))}}),y.extend({prop:function(t,e,n){var o,r,i=t.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&y.isXMLDoc(t)||(e=y.propFix[e]||e,r=y.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(o=r.set(t,n,e))?o:t[e]=n:r&&"get"in r&&null!==(o=r.get(t,e))?o:t[e]},propHooks:{tabIndex:{get:function(t){var e=y.find.attr(t,"tabindex");return e?parseInt(e,10):se.test(t.nodeName)||le.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),d.optSelected||(y.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),y.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){y.propFix[this.toLowerCase()]=this})),y.fn.extend({addClass:function(t){var e,n,o,r,i,a,s,l=0;if(y.isFunction(t))return this.each((function(e){y(this).addClass(t.call(this,e,ce(this)))}));if("string"==typeof t&&t)for(e=t.match(P)||[];n=this[l++];)if(r=ce(n),o=1===n.nodeType&&" "+ue(r)+" "){for(a=0;i=e[a++];)o.indexOf(" "+i+" ")<0&&(o+=i+" ");r!==(s=ue(o))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,o,r,i,a,s,l=0;if(y.isFunction(t))return this.each((function(e){y(this).removeClass(t.call(this,e,ce(this)))}));if(!arguments.length)return this.attr("class","");if("string"==typeof t&&t)for(e=t.match(P)||[];n=this[l++];)if(r=ce(n),o=1===n.nodeType&&" "+ue(r)+" "){for(a=0;i=e[a++];)for(;o.indexOf(" "+i+" ")>-1;)o=o.replace(" "+i+" "," ");r!==(s=ue(o))&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):y.isFunction(t)?this.each((function(n){y(this).toggleClass(t.call(this,n,ce(this),e),e)})):this.each((function(){var e,o,r,i;if("string"===n)for(o=0,r=y(this),i=t.match(P)||[];e=i[o++];)r.hasClass(e)?r.removeClass(e):r.addClass(e);else void 0!==t&&"boolean"!==n||((e=ce(this))&&q.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":q.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,o=0;for(e=" "+t+" ";n=this[o++];)if(1===n.nodeType&&(" "+ue(ce(n))+" ").indexOf(e)>-1)return!0;return!1}});var fe=/\r/g;y.fn.extend({val:function(t){var e,n,o,r=this[0];return arguments.length?(o=y.isFunction(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=o?t.call(this,n,y(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=y.map(r,(function(t){return null==t?"":t+""}))),(e=y.valHooks[this.type]||y.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=y.valHooks[r.type]||y.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(fe,""):null==n?"":n:void 0}}),y.extend({valHooks:{option:{get:function(t){var e=y.find.attr(t,"value");return null!=e?e:ue(y.text(t))}},select:{get:function(t){var e,n,o,r=t.options,i=t.selectedIndex,a="select-one"===t.type,s=a?null:[],l=a?i+1:r.length;for(o=i<0?l:a?i:0;o<l;o++)if(((n=r[o]).selected||o===i)&&!n.disabled&&(!n.parentNode.disabled||!R(n.parentNode,"optgroup"))){if(e=y(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,o,r=t.options,i=y.makeArray(e),a=r.length;a--;)((o=r[a]).selected=y.inArray(y.valHooks.option.get(o),i)>-1)&&(n=!0);return n||(t.selectedIndex=-1),i}}}}),y.each(["radio","checkbox"],(function(){y.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=y.inArray(y(t).val(),e)>-1}},d.checkOn||(y.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}));var he=/^(?:focusinfocus|focusoutblur)$/;y.extend(y.event,{trigger:function(e,n,r,i){var a,s,l,u,c,h,p,d=[r||o],g=f.call(e,"type")?e.type:e,m=f.call(e,"namespace")?e.namespace.split("."):[];if(s=l=r=r||o,3!==r.nodeType&&8!==r.nodeType&&!he.test(g+y.event.triggered)&&(g.indexOf(".")>-1&&(m=g.split("."),g=m.shift(),m.sort()),c=g.indexOf(":")<0&&"on"+g,(e=e[y.expando]?e:new y.Event(g,"object"==typeof e&&e)).isTrigger=i?2:3,e.namespace=m.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),n=null==n?[e]:y.makeArray(n,[e]),p=y.event.special[g]||{},i||!p.trigger||!1!==p.trigger.apply(r,n))){if(!i&&!p.noBubble&&!y.isWindow(r)){for(u=p.delegateType||g,he.test(u+g)||(s=s.parentNode);s;s=s.parentNode)d.push(s),l=s;l===(r.ownerDocument||o)&&d.push(l.defaultView||l.parentWindow||t)}for(a=0;(s=d[a++])&&!e.isPropagationStopped();)e.type=a>1?u:p.bindType||g,(h=(q.get(s,"events")||{})[e.type]&&q.get(s,"handle"))&&h.apply(s,n),(h=c&&s[c])&&h.apply&&W(s)&&(e.result=h.apply(s,n),!1===e.result&&e.preventDefault());return e.type=g,i||e.isDefaultPrevented()||p._default&&!1!==p._default.apply(d.pop(),n)||!W(r)||c&&y.isFunction(r[g])&&!y.isWindow(r)&&((l=r[c])&&(r[c]=null),y.event.triggered=g,r[g](),y.event.triggered=void 0,l&&(r[c]=l)),e.result}},simulate:function(t,e,n){var o=y.extend(new y.Event,n,{type:t,isSimulated:!0});y.event.trigger(o,null,e)}}),y.fn.extend({trigger:function(t,e){return this.each((function(){y.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return y.event.trigger(t,e,n,!0)}}),y.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){y.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}})),y.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),d.focusin="onfocusin"in t,d.focusin||y.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){y.event.simulate(e,t.target,y.event.fix(t))};y.event.special[e]={setup:function(){var o=this.ownerDocument||this,r=q.access(o,e);r||o.addEventListener(t,n,!0),q.access(o,e,(r||0)+1)},teardown:function(){var o=this.ownerDocument||this,r=q.access(o,e)-1;r?q.access(o,e,r):(o.removeEventListener(t,n,!0),q.remove(o,e))}}}));var pe=t.location,de=y.now(),ge=/\?/;y.parseXML=function(e){var n;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(o){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||y.error("Invalid XML: "+e),n};var me=/\[\]$/,ye=/\r?\n/g,ve=/^(?:submit|button|image|reset|file)$/i,Ce=/^(?:input|select|textarea|keygen)/i;function be(t,e,n,o){var r;if(Array.isArray(e))y.each(e,(function(e,r){n||me.test(t)?o(t,r):be(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,o)}));else if(n||"object"!==y.type(e))o(t,e);else for(r in e)be(t+"["+r+"]",e[r],n,o)}y.param=function(t,e){var n,o=[],r=function(t,e){var n=y.isFunction(e)?e():e;o[o.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(Array.isArray(t)||t.jquery&&!y.isPlainObject(t))y.each(t,(function(){r(this.name,this.value)}));else for(n in t)be(n,t[n],e,r);return o.join("&")},y.fn.extend({serialize:function(){return y.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=y.prop(this,"elements");return t?y.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!y(this).is(":disabled")&&Ce.test(this.nodeName)&&!ve.test(t)&&(this.checked||!at.test(t))})).map((function(t,e){var n=y(this).val();return null==n?null:Array.isArray(n)?y.map(n,(function(t){return{name:e.name,value:t.replace(ye,"\r\n")}})):{name:e.name,value:n.replace(ye,"\r\n")}})).get()}});var we=/%20/g,Te=/#.*$/,xe=/([?&])_=[^&]*/,Se=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ae=/^(?:GET|HEAD)$/,Ie=/^\/\//,Re={},ke={},Me="*/".concat("*"),Ne=o.createElement("a");function Ee(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var o,r=0,i=e.toLowerCase().match(P)||[];if(y.isFunction(n))for(;o=i[r++];)"+"===o[0]?(o=o.slice(1)||"*",(t[o]=t[o]||[]).unshift(n)):(t[o]=t[o]||[]).push(n)}}function De(t,e,n,o){var r={},i=t===ke;function a(s){var l;return r[s]=!0,y.each(t[s]||[],(function(t,s){var u=s(e,n,o);return"string"!=typeof u||i||r[u]?i?!(l=u):void 0:(e.dataTypes.unshift(u),a(u),!1)})),l}return a(e.dataTypes[0])||!r["*"]&&a("*")}function Oe(t,e){var n,o,r=y.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((r[n]?t:o||(o={}))[n]=e[n]);return o&&y.extend(!0,t,o),t}Ne.href=pe.href,y.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:pe.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(pe.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Me,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":y.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?Oe(Oe(t,y.ajaxSettings),e):Oe(y.ajaxSettings,t)},ajaxPrefilter:Ee(Re),ajaxTransport:Ee(ke),ajax:function(e,n){"object"==typeof e&&(n=e,e=void 0),n=n||{};var r,i,a,s,l,u,c,f,h,p,d=y.ajaxSetup({},n),g=d.context||d,m=d.context&&(g.nodeType||g.jquery)?y(g):y.event,v=y.Deferred(),C=y.Callbacks("once memory"),b=d.statusCode||{},w={},T={},x="canceled",S={readyState:0,getResponseHeader:function(t){var e;if(c){if(!s)for(s={};e=Se.exec(a);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return c?a:null},setRequestHeader:function(t,e){return null==c&&(t=T[t.toLowerCase()]=T[t.toLowerCase()]||t,w[t]=e),this},overrideMimeType:function(t){return null==c&&(d.mimeType=t),this},statusCode:function(t){var e;if(t)if(c)S.always(t[S.status]);else for(e in t)b[e]=[b[e],t[e]];return this},abort:function(t){var e=t||x;return r&&r.abort(e),I(0,e),this}};if(v.promise(S),d.url=((e||d.url||pe.href)+"").replace(Ie,pe.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(P)||[""],null==d.crossDomain){u=o.createElement("a");try{u.href=d.url,u.href=u.href,d.crossDomain=Ne.protocol+"//"+Ne.host!=u.protocol+"//"+u.host}catch(A){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=y.param(d.data,d.traditional)),De(Re,d,n,S),c)return S;for(h in(f=y.event&&d.global)&&0==y.active++&&y.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Ae.test(d.type),i=d.url.replace(Te,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(we,"+")):(p=d.url.slice(i.length),d.data&&(i+=(ge.test(i)?"&":"?")+d.data,delete d.data),!1===d.cache&&(i=i.replace(xe,"$1"),p=(ge.test(i)?"&":"?")+"_="+de+++p),d.url=i+p),d.ifModified&&(y.lastModified[i]&&S.setRequestHeader("If-Modified-Since",y.lastModified[i]),y.etag[i]&&S.setRequestHeader("If-None-Match",y.etag[i])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&S.setRequestHeader("Content-Type",d.contentType),S.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Me+"; q=0.01":""):d.accepts["*"]),d.headers)S.setRequestHeader(h,d.headers[h]);if(d.beforeSend&&(!1===d.beforeSend.call(g,S,d)||c))return S.abort();if(x="abort",C.add(d.complete),S.done(d.success),S.fail(d.error),r=De(ke,d,n,S)){if(S.readyState=1,f&&m.trigger("ajaxSend",[S,d]),c)return S;d.async&&d.timeout>0&&(l=t.setTimeout((function(){S.abort("timeout")}),d.timeout));try{c=!1,r.send(w,I)}catch(A){if(c)throw A;I(-1,A)}}else I(-1,"No Transport");function I(e,n,o,s){var u,h,p,w,T,x=n;c||(c=!0,l&&t.clearTimeout(l),r=void 0,a=s||"",S.readyState=e>0?4:0,u=e>=200&&e<300||304===e,o&&(w=function(t,e,n){for(var o,r,i,a,s=t.contents,l=t.dataTypes;"*"===l[0];)l.shift(),void 0===o&&(o=t.mimeType||e.getResponseHeader("Content-Type"));if(o)for(r in s)if(s[r]&&s[r].test(o)){l.unshift(r);break}if(l[0]in n)i=l[0];else{for(r in n){if(!l[0]||t.converters[r+" "+l[0]]){i=r;break}a||(a=r)}i=i||a}if(i)return i!==l[0]&&l.unshift(i),n[i]}(d,S,o)),w=function(t,e,n,o){var r,i,a,s,l,u={},c=t.dataTypes.slice();if(c[1])for(a in t.converters)u[a.toLowerCase()]=t.converters[a];for(i=c.shift();i;)if(t.responseFields[i]&&(n[t.responseFields[i]]=e),!l&&o&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=i,i=c.shift())if("*"===i)i=l;else if("*"!==l&&l!==i){if(!(a=u[l+" "+i]||u["* "+i]))for(r in u)if((s=r.split(" "))[1]===i&&(a=u[l+" "+s[0]]||u["* "+s[0]])){!0===a?a=u[r]:!0!==u[r]&&(i=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&t.throws)e=a(e);else try{e=a(e)}catch(f){return{state:"parsererror",error:a?f:"No conversion from "+l+" to "+i}}}return{state:"success",data:e}}(d,w,S,u),u?(d.ifModified&&((T=S.getResponseHeader("Last-Modified"))&&(y.lastModified[i]=T),(T=S.getResponseHeader("etag"))&&(y.etag[i]=T)),204===e||"HEAD"===d.type?x="nocontent":304===e?x="notmodified":(x=w.state,h=w.data,u=!(p=w.error))):(p=x,!e&&x||(x="error",e<0&&(e=0))),S.status=e,S.statusText=(n||x)+"",u?v.resolveWith(g,[h,x,S]):v.rejectWith(g,[S,x,p]),S.statusCode(b),b=void 0,f&&m.trigger(u?"ajaxSuccess":"ajaxError",[S,d,u?h:p]),C.fireWith(g,[S,x]),f&&(m.trigger("ajaxComplete",[S,d]),--y.active||y.event.trigger("ajaxStop")))}return S},getJSON:function(t,e,n){return y.get(t,e,n,"json")},getScript:function(t,e){return y.get(t,void 0,e,"script")}}),y.each(["get","post"],(function(t,e){y[e]=function(t,n,o,r){return y.isFunction(n)&&(r=r||o,o=n,n=void 0),y.ajax(y.extend({url:t,type:e,dataType:r,data:n,success:o},y.isPlainObject(t)&&t))}})),y._evalUrl=function(t){return y.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,throws:!0})},y.fn.extend({wrapAll:function(t){var e;return this[0]&&(y.isFunction(t)&&(t=t.call(this[0])),e=y(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return y.isFunction(t)?this.each((function(e){y(this).wrapInner(t.call(this,e))})):this.each((function(){var e=y(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=y.isFunction(t);return this.each((function(n){y(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){y(this).replaceWith(this.childNodes)})),this}}),y.expr.pseudos.hidden=function(t){return!y.expr.pseudos.visible(t)},y.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},y.ajaxSettings.xhr=function(){try{return new t.XMLHttpRequest}catch(e){}};var je={0:200,1223:204},Fe=y.ajaxSettings.xhr();d.cors=!!Fe&&"withCredentials"in Fe,d.ajax=Fe=!!Fe,y.ajaxTransport((function(e){var n,o;if(d.cors||Fe&&!e.crossDomain)return{send:function(r,i){var a,s=e.xhr();if(s.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(a in e.xhrFields)s[a]=e.xhrFields[a];for(a in e.mimeType&&s.overrideMimeType&&s.overrideMimeType(e.mimeType),e.crossDomain||r["X-Requested-With"]||(r["X-Requested-With"]="XMLHttpRequest"),r)s.setRequestHeader(a,r[a]);n=function(t){return function(){n&&(n=o=s.onload=s.onerror=s.onabort=s.onreadystatechange=null,"abort"===t?s.abort():"error"===t?"number"!=typeof s.status?i(0,"error"):i(s.status,s.statusText):i(je[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),o=s.onerror=n("error"),void 0!==s.onabort?s.onabort=o:s.onreadystatechange=function(){4===s.readyState&&t.setTimeout((function(){n&&o()}))},n=n("abort");try{s.send(e.hasContent&&e.data||null)}catch(l){if(n)throw l}},abort:function(){n&&n()}}})),y.ajaxPrefilter((function(t){t.crossDomain&&(t.contents.script=!1)})),y.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return y.globalEval(t),t}}}),y.ajaxPrefilter("script",(function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")})),y.ajaxTransport("script",(function(t){var e,n;if(t.crossDomain)return{send:function(r,i){e=y("<script>").prop({charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&i("error"===t.type?404:200,t.type)}),o.head.appendChild(e[0])},abort:function(){n&&n()}}}));var Pe=[],_e=/(=)\?(?=&|$)|\?\?/;y.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Pe.pop()||y.expando+"_"+de++;return this[t]=!0,t}}),y.ajaxPrefilter("json jsonp",(function(e,n,o){var r,i,a,s=!1!==e.jsonp&&(_e.test(e.url)?"url":"string"==typeof e.data&&0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&_e.test(e.data)&&"data");if(s||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=y.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,s?e[s]=e[s].replace(_e,"$1"+r):!1!==e.jsonp&&(e.url+=(ge.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return a||y.error(r+" was not called"),a[0]},e.dataTypes[0]="json",i=t[r],t[r]=function(){a=arguments},o.always((function(){void 0===i?y(t).removeProp(r):t[r]=i,e[r]&&(e.jsonpCallback=n.jsonpCallback,Pe.push(r)),a&&y.isFunction(i)&&i(a[0]),a=i=void 0})),"script"})),d.createHTMLDocument=function(){var t=o.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",2===t.childNodes.length}(),y.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(d.createHTMLDocument?((r=(e=o.implementation.createHTMLDocument("")).createElement("base")).href=o.location.href,e.head.appendChild(r)):e=o),a=!n&&[],(i=k.exec(t))?[e.createElement(i[1])]:(i=pt([t],e,a),a&&a.length&&y(a).remove(),y.merge([],i.childNodes)));var r,i,a},y.fn.load=function(t,e,n){var o,r,i,a=this,s=t.indexOf(" ");return s>-1&&(o=ue(t.slice(s)),t=t.slice(0,s)),y.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(r="POST"),a.length>0&&y.ajax({url:t,type:r||"GET",dataType:"html",data:e}).done((function(t){i=arguments,a.html(o?y("<div>").append(y.parseHTML(t)).find(o):t)})).always(n&&function(t,e){a.each((function(){n.apply(this,i||[t.responseText,e,t])}))}),this},y.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(t,e){y.fn[e]=function(t){return this.on(e,t)}})),y.expr.pseudos.animated=function(t){return y.grep(y.timers,(function(e){return t===e.elem})).length},y.offset={setOffset:function(t,e,n){var o,r,i,a,s,l,u=y.css(t,"position"),c=y(t),f={};"static"===u&&(t.style.position="relative"),s=c.offset(),i=y.css(t,"top"),l=y.css(t,"left"),("absolute"===u||"fixed"===u)&&(i+l).indexOf("auto")>-1?(a=(o=c.position()).top,r=o.left):(a=parseFloat(i)||0,r=parseFloat(l)||0),y.isFunction(e)&&(e=e.call(t,n,y.extend({},s))),null!=e.top&&(f.top=e.top-s.top+a),null!=e.left&&(f.left=e.left-s.left+r),"using"in e?e.using.call(t,f):c.css(f)}},y.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){y.offset.setOffset(this,t,e)}));var e,n,o,r,i=this[0];return i?i.getClientRects().length?(o=i.getBoundingClientRect(),n=(e=i.ownerDocument).documentElement,r=e.defaultView,{top:o.top+r.pageYOffset-n.clientTop,left:o.left+r.pageXOffset-n.clientLeft}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n=this[0],o={top:0,left:0};return"fixed"===y.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),R(t[0],"html")||(o=t.offset()),o={top:o.top+y.css(t[0],"borderTopWidth",!0),left:o.left+y.css(t[0],"borderLeftWidth",!0)}),{top:e.top-o.top-y.css(n,"marginTop",!0),left:e.left-o.left-y.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===y.css(t,"position");)t=t.offsetParent;return t||dt}))}}),y.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;y.fn[t]=function(o){return z(this,(function(t,o,r){var i;return y.isWindow(t)?i=t:9===t.nodeType&&(i=t.defaultView),void 0===r?i?i[e]:t[o]:void(i?i.scrollTo(n?i.pageXOffset:r,n?r:i.pageYOffset):t[o]=r)}),t,o,arguments.length)}})),y.each(["top","left"],(function(t,e){y.cssHooks[e]=Lt(d.pixelPosition,(function(t,n){if(n)return n=_t(t,e),Ft.test(n)?y(t).position()[e]+"px":n}))})),y.each({Height:"height",Width:"width"},(function(t,e){y.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,o){y.fn[o]=function(r,i){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===i?"margin":"border");return z(this,(function(e,n,r){var i;return y.isWindow(e)?0===o.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+t],i["scroll"+t],e.body["offset"+t],i["offset"+t],i["client"+t])):void 0===r?y.css(e,n,s):y.style(e,n,r,s)}),e,a?r:void 0,a)}}))})),y.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,o){return this.on(e,t,n,o)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},holdReady:function(t){t?y.readyWait++:y.ready(!0)}}),y.isArray=Array.isArray,y.parseJSON=JSON.parse,y.nodeName=R,"function"==typeof define&&define.amd&&define("jquery",[],(function(){return y}));var Le=t.jQuery,Be=t.$;return y.noConflict=function(e){return t.$===y&&(t.$=Be),e&&t.jQuery===y&&(t.jQuery=Le),y},e||(t.jQuery=t.$=y),y})),function(t,e){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?e(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return e(t)}:e(t)}("undefined"!=typeof window?window:this,(function(t,e){"use strict";var n=[],o=Object.getPrototypeOf,r=n.slice,i=n.flat?function(t){return n.flat.call(t)}:function(t){return n.concat.apply([],t)},a=n.push,s=n.indexOf,l={},u=l.toString,c=l.hasOwnProperty,f=c.toString,h=f.call(Object),p={},d=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},g=function(t){return null!=t&&t===t.window},m=t.document,y={type:!0,src:!0,nonce:!0,noModule:!0};function v(t,e,n){var o,r,i=(n=n||m).createElement("script");if(i.text=t,e)for(o in y)(r=e[o]||e.getAttribute&&e.getAttribute(o))&&i.setAttribute(o,r);n.head.appendChild(i).parentNode.removeChild(i)}function C(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?l[u.call(t)]||"object":typeof t}var b="3.5.1 -ajax,-ajax/jsonp,-ajax/load,-ajax/script,-ajax/var/location,-ajax/var/nonce,-ajax/var/rquery,-ajax/xhr,-manipulation/_evalUrl,-deprecated/ajax-event-alias,-effects,-effects/Tween,-effects/animatedSelector",w=function(t,e){return new w.fn.init(t,e)};function T(t){var e=!!t&&"length"in t&&t.length,n=C(t);return!d(t)&&!g(t)&&("array"===n||0===e||"number"==typeof e&&0<e&&e-1 in t)}w.fn=w.prototype={jquery:b,constructor:w,length:0,toArray:function(){return r.call(this)},get:function(t){return null==t?r.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=w.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return w.each(this,t)},map:function(t){return this.pushStack(w.map(this,(function(e,n){return t.call(e,n,e)})))},slice:function(){return this.pushStack(r.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,(function(t,e){return(e+1)%2})))},odd:function(){return this.pushStack(w.grep(this,(function(t,e){return e%2})))},eq:function(t){var e=this.length,n=+t+(t<0?e:0);return this.pushStack(0<=n&&n<e?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var t,e,n,o,r,i,a=arguments[0]||{},s=1,l=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[s]||{},s++),"object"==typeof a||d(a)||(a={}),s===l&&(a=this,s--);s<l;s++)if(null!=(t=arguments[s]))for(e in t)o=t[e],"__proto__"!==e&&a!==o&&(u&&o&&(w.isPlainObject(o)||(r=Array.isArray(o)))?(n=a[e],i=r&&!Array.isArray(n)?[]:r||w.isPlainObject(n)?n:{},r=!1,a[e]=w.extend(u,i,o)):void 0!==o&&(a[e]=o));return a},w.extend({expando:"jQuery"+(b+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,n;return!(!t||"[object Object]"!==u.call(t)||(e=o(t))&&("function"!=typeof(n=c.call(e,"constructor")&&e.constructor)||f.call(n)!==h))},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,n){v(t,{nonce:e&&e.nonce},n)},each:function(t,e){var n,o=0;if(T(t))for(n=t.length;o<n&&!1!==e.call(t[o],o,t[o]);o++);else for(o in t)if(!1===e.call(t[o],o,t[o]))break;return t},makeArray:function(t,e){var n=e||[];return null!=t&&(T(Object(t))?w.merge(n,"string"==typeof t?[t]:t):a.call(n,t)),n},inArray:function(t,e,n){return null==e?-1:s.call(e,t,n)},merge:function(t,e){for(var n=+e.length,o=0,r=t.length;o<n;o++)t[r++]=e[o];return t.length=r,t},grep:function(t,e,n){for(var o=[],r=0,i=t.length,a=!n;r<i;r++)!e(t[r],r)!==a&&o.push(t[r]);return o},map:function(t,e,n){var o,r,a=0,s=[];if(T(t))for(o=t.length;a<o;a++)null!=(r=e(t[a],a,n))&&s.push(r);else for(a in t)null!=(r=e(t[a],a,n))&&s.push(r);return i(s)},guid:1,support:p}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),(function(t,e){l["[object "+e+"]"]=e.toLowerCase()}));var x=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b="sizzle"+1*new Date,w=t.document,T=0,x=0,S=lt(),A=lt(),I=lt(),R=lt(),k=function(t,e){return t===e&&(f=!0),0},M={}.hasOwnProperty,N=[],E=N.pop,D=N.push,O=N.push,j=N.slice,F=function(t,e){for(var n=0,o=t.length;n<o;n++)if(t[n]===e)return n;return-1},P="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",_="[\\x20\\t\\r\\n\\f]",L="(?:\\\\[\\da-fA-F]{1,6}"+_+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",B="\\["+_+"*("+L+")(?:"+_+"*([*^$|!~]?=)"+_+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+L+"))|)"+_+"*\\]",G=":("+L+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+B+")*)|.*)\\)|)",H=new RegExp(_+"+","g"),V=new RegExp("^"+_+"+|((?:^|[^\\\\])(?:\\\\.)*)"+_+"+$","g"),z=new RegExp("^"+_+"*,"+_+"*"),W=new RegExp("^"+_+"*([>+~]|"+_+")"+_+"*"),U=new RegExp(_+"|>"),q=new RegExp(G),Y=new RegExp("^"+L+"$"),X={ID:new RegExp("^#("+L+")"),CLASS:new RegExp("^\\.("+L+")"),TAG:new RegExp("^("+L+"|[*])"),ATTR:new RegExp("^"+B),PSEUDO:new RegExp("^"+G),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+_+"*(even|odd|(([+-]|)(\\d*)n|)"+_+"*(?:([+-]|)"+_+"*(\\d+)|))"+_+"*\\)|)","i"),bool:new RegExp("^(?:"+P+")$","i"),needsContext:new RegExp("^"+_+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+_+"*((?:-\\d)?\\d*)"+_+"*\\)|)(?=[^-]|$)","i")},Z=/HTML$/i,Q=/^(?:input|select|textarea|button)$/i,J=/^h\d$/i,$=/^[^{]+\{\s*\[native \w/,K=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,tt=/[+~]/,et=new RegExp("\\\\[\\da-fA-F]{1,6}"+_+"?|\\\\([^\\r\\n\\f])","g"),nt=function(t,e){var n="0x"+t.slice(1)-65536;return e||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},ot=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,rt=function(t,e){return e?"\0"===t?"ï¿½":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},it=function(){h()},at=bt((function(t){return!0===t.disabled&&"fieldset"===t.nodeName.toLowerCase()}),{dir:"parentNode",next:"legend"});try{O.apply(N=j.call(w.childNodes),w.childNodes),N[w.childNodes.length].nodeType}catch(e){O={apply:N.length?function(t,e){D.apply(t,j.call(e))}:function(t,e){for(var n=t.length,o=0;t[n++]=e[o++];);t.length=n-1}}}function st(t,e,o,r){var i,s,u,c,f,d,y,v=e&&e.ownerDocument,w=e?e.nodeType:9;if(o=o||[],"string"!=typeof t||!t||1!==w&&9!==w&&11!==w)return o;if(!r&&(h(e),e=e||p,g)){if(11!==w&&(f=K.exec(t)))if(i=f[1]){if(9===w){if(!(u=e.getElementById(i)))return o;if(u.id===i)return o.push(u),o}else if(v&&(u=v.getElementById(i))&&C(e,u)&&u.id===i)return o.push(u),o}else{if(f[2])return O.apply(o,e.getElementsByTagName(t)),o;if((i=f[3])&&n.getElementsByClassName&&e.getElementsByClassName)return O.apply(o,e.getElementsByClassName(i)),o}if(n.qsa&&!R[t+" "]&&(!m||!m.test(t))&&(1!==w||"object"!==e.nodeName.toLowerCase())){if(y=t,v=e,1===w&&(U.test(t)||W.test(t))){for((v=tt.test(t)&&yt(e.parentNode)||e)===e&&n.scope||((c=e.getAttribute("id"))?c=c.replace(ot,rt):e.setAttribute("id",c=b)),s=(d=a(t)).length;s--;)d[s]=(c?"#"+c:":scope")+" "+Ct(d[s]);y=d.join(",")}try{return O.apply(o,v.querySelectorAll(y)),o}catch(e){R(t,!0)}finally{c===b&&e.removeAttribute("id")}}}return l(t.replace(V,"$1"),e,o,r)}function lt(){var t=[];return function e(n,r){return t.push(n+" ")>o.cacheLength&&delete e[t.shift()],e[n+" "]=r}}function ut(t){return t[b]=!0,t}function ct(t){var e=p.createElement("fieldset");try{return!!t(e)}catch(t){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function ft(t,e){for(var n=t.split("|"),r=n.length;r--;)o.attrHandle[n[r]]=e}function ht(t,e){var n=e&&t,o=n&&1===t.nodeType&&1===e.nodeType&&t.sourceIndex-e.sourceIndex;if(o)return o;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function pt(t){return function(e){return"input"===e.nodeName.toLowerCase()&&e.type===t}}function dt(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function gt(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===t||e.isDisabled!==!t&&at(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function mt(t){return ut((function(e){return e=+e,ut((function(n,o){for(var r,i=t([],n.length,e),a=i.length;a--;)n[r=i[a]]&&(n[r]=!(o[r]=n[r]))}))}))}function yt(t){return t&&void 0!==t.getElementsByTagName&&t}for(e in n=st.support={},i=st.isXML=function(t){var e=t.namespaceURI,n=(t.ownerDocument||t).documentElement;return!Z.test(e||n&&n.nodeName||"HTML")},h=st.setDocument=function(t){var e,r,a=t?t.ownerDocument||t:w;return a!=p&&9===a.nodeType&&a.documentElement&&(d=(p=a).documentElement,g=!i(p),w!=p&&(r=p.defaultView)&&r.top!==r&&(r.addEventListener?r.addEventListener("unload",it,!1):r.attachEvent&&r.attachEvent("onunload",it)),n.scope=ct((function(t){return d.appendChild(t).appendChild(p.createElement("div")),void 0!==t.querySelectorAll&&!t.querySelectorAll(":scope fieldset div").length})),n.attributes=ct((function(t){return t.className="i",!t.getAttribute("className")})),n.getElementsByTagName=ct((function(t){return t.appendChild(p.createComment("")),!t.getElementsByTagName("*").length})),n.getElementsByClassName=$.test(p.getElementsByClassName),n.getById=ct((function(t){return d.appendChild(t).id=b,!p.getElementsByName||!p.getElementsByName(b).length})),n.getById?(o.filter.ID=function(t){var e=t.replace(et,nt);return function(t){return t.getAttribute("id")===e}},o.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n=e.getElementById(t);return n?[n]:[]}}):(o.filter.ID=function(t){var e=t.replace(et,nt);return function(t){var n=void 0!==t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}},o.find.ID=function(t,e){if(void 0!==e.getElementById&&g){var n,o,r,i=e.getElementById(t);if(i){if((n=i.getAttributeNode("id"))&&n.value===t)return[i];for(r=e.getElementsByName(t),o=0;i=r[o++];)if((n=i.getAttributeNode("id"))&&n.value===t)return[i]}return[]}}),o.find.TAG=n.getElementsByTagName?function(t,e){return void 0!==e.getElementsByTagName?e.getElementsByTagName(t):n.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,o=[],r=0,i=e.getElementsByTagName(t);if("*"===t){for(;n=i[r++];)1===n.nodeType&&o.push(n);return o}return i},o.find.CLASS=n.getElementsByClassName&&function(t,e){if(void 0!==e.getElementsByClassName&&g)return e.getElementsByClassName(t)},y=[],m=[],(n.qsa=$.test(p.querySelectorAll))&&(ct((function(t){var e;d.appendChild(t).innerHTML="<a id='"+b+"'></a><select id='"+b+"-\r\\' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+_+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||m.push("\\["+_+"*(?:value|"+P+")"),t.querySelectorAll("[id~="+b+"-]").length||m.push("~="),(e=p.createElement("input")).setAttribute("name",""),t.appendChild(e),t.querySelectorAll("[name='']").length||m.push("\\["+_+"*name"+_+"*="+_+"*(?:''|\"\")"),t.querySelectorAll(":checked").length||m.push(":checked"),t.querySelectorAll("a#"+b+"+*").length||m.push(".#.+[+~]"),t.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")})),ct((function(t){t.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var e=p.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&m.push("name"+_+"*[*^$|!~]?="),2!==t.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),d.appendChild(t).disabled=!0,2!==t.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),m.push(",.*:")}))),(n.matchesSelector=$.test(v=d.matches||d.webkitMatchesSelector||d.mozMatchesSelector||d.oMatchesSelector||d.msMatchesSelector))&&ct((function(t){n.disconnectedMatch=v.call(t,"*"),v.call(t,"[s!='']:x"),y.push("!=",G)})),m=m.length&&new RegExp(m.join("|")),y=y.length&&new RegExp(y.join("|")),e=$.test(d.compareDocumentPosition),C=e||$.test(d.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,o=e&&e.parentNode;return t===o||!(!o||1!==o.nodeType||!(n.contains?n.contains(o):t.compareDocumentPosition&&16&t.compareDocumentPosition(o)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},k=e?function(t,e){if(t===e)return f=!0,0;var o=!t.compareDocumentPosition-!e.compareDocumentPosition;return o||(1&(o=(t.ownerDocument||t)==(e.ownerDocument||e)?t.compareDocumentPosition(e):1)||!n.sortDetached&&e.compareDocumentPosition(t)===o?t==p||t.ownerDocument==w&&C(w,t)?-1:e==p||e.ownerDocument==w&&C(w,e)?1:c?F(c,t)-F(c,e):0:4&o?-1:1)}:function(t,e){if(t===e)return f=!0,0;var n,o=0,r=t.parentNode,i=e.parentNode,a=[t],s=[e];if(!r||!i)return t==p?-1:e==p?1:r?-1:i?1:c?F(c,t)-F(c,e):0;if(r===i)return ht(t,e);for(n=t;n=n.parentNode;)a.unshift(n);for(n=e;n=n.parentNode;)s.unshift(n);for(;a[o]===s[o];)o++;return o?ht(a[o],s[o]):a[o]==w?-1:s[o]==w?1:0}),p},st.matches=function(t,e){return st(t,null,null,e)},st.matchesSelector=function(t,e){if(h(t),n.matchesSelector&&g&&!R[e+" "]&&(!y||!y.test(e))&&(!m||!m.test(e)))try{var o=v.call(t,e);if(o||n.disconnectedMatch||t.document&&11!==t.document.nodeType)return o}catch(t){R(e,!0)}return 0<st(e,p,null,[t]).length},st.contains=function(t,e){return(t.ownerDocument||t)!=p&&h(t),C(t,e)},st.attr=function(t,e){(t.ownerDocument||t)!=p&&h(t);var r=o.attrHandle[e.toLowerCase()],i=r&&M.call(o.attrHandle,e.toLowerCase())?r(t,e,!g):void 0;return void 0!==i?i:n.attributes||!g?t.getAttribute(e):(i=t.getAttributeNode(e))&&i.specified?i.value:null},st.escape=function(t){return(t+"").replace(ot,rt)},st.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},st.uniqueSort=function(t){var e,o=[],r=0,i=0;if(f=!n.detectDuplicates,c=!n.sortStable&&t.slice(0),t.sort(k),f){for(;e=t[i++];)e===t[i]&&(r=o.push(i));for(;r--;)t.splice(o[r],1)}return c=null,t},r=st.getText=function(t){var e,n="",o=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=r(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[o++];)n+=r(e);return n},(o=st.selectors={cacheLength:50,createPseudo:ut,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(et,nt),t[3]=(t[3]||t[4]||t[5]||"").replace(et,nt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||st.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&st.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return X.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&q.test(n)&&(e=a(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(et,nt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=S[t+" "];return e||(e=new RegExp("(^|"+_+")"+t+"("+_+"|$)"))&&S(t,(function(t){return e.test("string"==typeof t.className&&t.className||void 0!==t.getAttribute&&t.getAttribute("class")||"")}))},ATTR:function(t,e,n){return function(o){var r=st.attr(o,t);return null==r?"!="===e:!e||(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&-1<r.indexOf(n):"$="===e?n&&r.slice(-n.length)===n:"~="===e?-1<(" "+r.replace(H," ")+" ").indexOf(n):"|="===e&&(r===n||r.slice(0,n.length+1)===n+"-"))}},CHILD:function(t,e,n,o,r){var i="nth"!==t.slice(0,3),a="last"!==t.slice(-4),s="of-type"===e;return 1===o&&0===r?function(t){return!!t.parentNode}:function(e,n,l){var u,c,f,h,p,d,g=i!==a?"nextSibling":"previousSibling",m=e.parentNode,y=s&&e.nodeName.toLowerCase(),v=!l&&!s,C=!1;if(m){if(i){for(;g;){for(h=e;h=h[g];)if(s?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;d=g="only"===t&&!d&&"nextSibling"}return!0}if(d=[a?m.firstChild:m.lastChild],a&&v){for(C=(p=(u=(c=(f=(h=m)[b]||(h[b]={}))[h.uniqueID]||(f[h.uniqueID]={}))[t]||[])[0]===T&&u[1])&&u[2],h=p&&m.childNodes[p];h=++p&&h&&h[g]||(C=p=0)||d.pop();)if(1===h.nodeType&&++C&&h===e){c[t]=[T,p,C];break}}else if(v&&(C=p=(u=(c=(f=(h=e)[b]||(h[b]={}))[h.uniqueID]||(f[h.uniqueID]={}))[t]||[])[0]===T&&u[1]),!1===C)for(;(h=++p&&h&&h[g]||(C=p=0)||d.pop())&&((s?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++C||(v&&((c=(f=h[b]||(h[b]={}))[h.uniqueID]||(f[h.uniqueID]={}))[t]=[T,C]),h!==e)););return(C-=r)===o||C%o==0&&0<=C/o}}},PSEUDO:function(t,e){var n,r=o.pseudos[t]||o.setFilters[t.toLowerCase()]||st.error("unsupported pseudo: "+t);return r[b]?r(e):1<r.length?(n=[t,t,"",e],o.setFilters.hasOwnProperty(t.toLowerCase())?ut((function(t,n){for(var o,i=r(t,e),a=i.length;a--;)t[o=F(t,i[a])]=!(n[o]=i[a])})):function(t){return r(t,0,n)}):r}},pseudos:{not:ut((function(t){var e=[],n=[],o=s(t.replace(V,"$1"));return o[b]?ut((function(t,e,n,r){for(var i,a=o(t,null,r,[]),s=t.length;s--;)(i=a[s])&&(t[s]=!(e[s]=i))})):function(t,r,i){return e[0]=t,o(e,null,i,n),e[0]=null,!n.pop()}})),has:ut((function(t){return function(e){return 0<st(t,e).length}})),contains:ut((function(t){return t=t.replace(et,nt),function(e){return-1<(e.textContent||r(e)).indexOf(t)}})),lang:ut((function(t){return Y.test(t||"")||st.error("unsupported lang: "+t),t=t.replace(et,nt).toLowerCase(),function(e){var n;do{if(n=g?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(n=n.toLowerCase())===t||0===n.indexOf(t+"-")}while((e=e.parentNode)&&1===e.nodeType);return!1}})),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===d},focus:function(t){return t===p.activeElement&&(!p.hasFocus||p.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:gt(!1),disabled:gt(!0),checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,!0===t.selected},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!o.pseudos.empty(t)},header:function(t){return J.test(t.nodeName)},input:function(t){return Q.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:mt((function(){return[0]})),last:mt((function(t,e){return[e-1]})),eq:mt((function(t,e,n){return[n<0?n+e:n]})),even:mt((function(t,e){for(var n=0;n<e;n+=2)t.push(n);return t})),odd:mt((function(t,e){for(var n=1;n<e;n+=2)t.push(n);return t})),lt:mt((function(t,e,n){for(var o=n<0?n+e:e<n?e:n;0<=--o;)t.push(o);return t})),gt:mt((function(t,e,n){for(var o=n<0?n+e:n;++o<e;)t.push(o);return t}))}}).pseudos.nth=o.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})o.pseudos[e]=pt(e);for(e in{submit:!0,reset:!0})o.pseudos[e]=dt(e);function vt(){}function Ct(t){for(var e=0,n=t.length,o="";e<n;e++)o+=t[e].value;return o}function bt(t,e,n){var o=e.dir,r=e.next,i=r||o,a=n&&"parentNode"===i,s=x++;return e.first?function(e,n,r){for(;e=e[o];)if(1===e.nodeType||a)return t(e,n,r);return!1}:function(e,n,l){var u,c,f,h=[T,s];if(l){for(;e=e[o];)if((1===e.nodeType||a)&&t(e,n,l))return!0}else for(;e=e[o];)if(1===e.nodeType||a)if(c=(f=e[b]||(e[b]={}))[e.uniqueID]||(f[e.uniqueID]={}),r&&r===e.nodeName.toLowerCase())e=e[o]||e;else{if((u=c[i])&&u[0]===T&&u[1]===s)return h[2]=u[2];if((c[i]=h)[2]=t(e,n,l))return!0}return!1}}function wt(t){return 1<t.length?function(e,n,o){for(var r=t.length;r--;)if(!t[r](e,n,o))return!1;return!0}:t[0]}function Tt(t,e,n,o,r){for(var i,a=[],s=0,l=t.length,u=null!=e;s<l;s++)(i=t[s])&&(n&&!n(i,o,r)||(a.push(i),u&&e.push(s)));return a}function xt(t,e,n,o,r,i){return o&&!o[b]&&(o=xt(o)),r&&!r[b]&&(r=xt(r,i)),ut((function(i,a,s,l){var u,c,f,h=[],p=[],d=a.length,g=i||function(t,e,n){for(var o=0,r=e.length;o<r;o++)st(t,e[o],n);return n}(e||"*",s.nodeType?[s]:s,[]),m=!t||!i&&e?g:Tt(g,h,t,s,l),y=n?r||(i?t:d||o)?[]:a:m;if(n&&n(m,y,s,l),o)for(u=Tt(y,p),o(u,[],s,l),c=u.length;c--;)(f=u[c])&&(y[p[c]]=!(m[p[c]]=f));if(i){if(r||t){if(r){for(u=[],c=y.length;c--;)(f=y[c])&&u.push(m[c]=f);r(null,y=[],u,l)}for(c=y.length;c--;)(f=y[c])&&-1<(u=r?F(i,f):h[c])&&(i[u]=!(a[u]=f))}}else y=Tt(y===a?y.splice(d,y.length):y),r?r(null,a,y,l):O.apply(a,y)}))}function St(t){for(var e,n,r,i=t.length,a=o.relative[t[0].type],s=a||o.relative[" "],l=a?1:0,c=bt((function(t){return t===e}),s,!0),f=bt((function(t){return-1<F(e,t)}),s,!0),h=[function(t,n,o){var r=!a&&(o||n!==u)||((e=n).nodeType?c(t,n,o):f(t,n,o));return e=null,r}];l<i;l++)if(n=o.relative[t[l].type])h=[bt(wt(h),n)];else{if((n=o.filter[t[l].type].apply(null,t[l].matches))[b]){for(r=++l;r<i&&!o.relative[t[r].type];r++);return xt(1<l&&wt(h),1<l&&Ct(t.slice(0,l-1).concat({value:" "===t[l-2].type?"*":""})).replace(V,"$1"),n,l<r&&St(t.slice(l,r)),r<i&&St(t=t.slice(r)),r<i&&Ct(t))}h.push(n)}return wt(h)}return vt.prototype=o.filters=o.pseudos,o.setFilters=new vt,a=st.tokenize=function(t,e){var n,r,i,a,s,l,u,c=A[t+" "];if(c)return e?0:c.slice(0);for(s=t,l=[],u=o.preFilter;s;){for(a in n&&!(r=z.exec(s))||(r&&(s=s.slice(r[0].length)||s),l.push(i=[])),n=!1,(r=W.exec(s))&&(n=r.shift(),i.push({value:n,type:r[0].replace(V," ")}),s=s.slice(n.length)),o.filter)!(r=X[a].exec(s))||u[a]&&!(r=u[a](r))||(n=r.shift(),i.push({value:n,type:a,matches:r}),s=s.slice(n.length));if(!n)break}return e?s.length:s?st.error(t):A(t,l).slice(0)},s=st.compile=function(t,e){var n,r,i,s,l,c,f=[],d=[],m=I[t+" "];if(!m){for(e||(e=a(t)),n=e.length;n--;)(m=St(e[n]))[b]?f.push(m):d.push(m);(m=I(t,(r=d,s=0<(i=f).length,l=0<r.length,c=function(t,e,n,a,c){var f,d,m,y=0,v="0",C=t&&[],b=[],w=u,x=t||l&&o.find.TAG("*",c),S=T+=null==w?1:Math.random()||.1,A=x.length;for(c&&(u=e==p||e||c);v!==A&&null!=(f=x[v]);v++){if(l&&f){for(d=0,e||f.ownerDocument==p||(h(f),n=!g);m=r[d++];)if(m(f,e||p,n)){a.push(f);break}c&&(T=S)}s&&((f=!m&&f)&&y--,t&&C.push(f))}if(y+=v,s&&v!==y){for(d=0;m=i[d++];)m(C,b,e,n);if(t){if(0<y)for(;v--;)C[v]||b[v]||(b[v]=E.call(a));b=Tt(b)}O.apply(a,b),c&&!t&&0<b.length&&1<y+i.length&&st.uniqueSort(a)}return c&&(T=S,u=w),C},s?ut(c):c))).selector=t}return m},l=st.select=function(t,e,n,r){var i,l,u,c,f,h="function"==typeof t&&t,p=!r&&a(t=h.selector||t);if(n=n||[],1===p.length){if(2<(l=p[0]=p[0].slice(0)).length&&"ID"===(u=l[0]).type&&9===e.nodeType&&g&&o.relative[l[1].type]){if(!(e=(o.find.ID(u.matches[0].replace(et,nt),e)||[])[0]))return n;h&&(e=e.parentNode),t=t.slice(l.shift().value.length)}for(i=X.needsContext.test(t)?0:l.length;i--&&(u=l[i],!o.relative[c=u.type]);)if((f=o.find[c])&&(r=f(u.matches[0].replace(et,nt),tt.test(l[0].type)&&yt(e.parentNode)||e))){if(l.splice(i,1),!(t=r.length&&Ct(l)))return O.apply(n,r),n;break}}return(h||s(t,p))(r,e,!g,n,!e||tt.test(t)&&yt(e.parentNode)||e),n},n.sortStable=b.split("").sort(k).join("")===b,n.detectDuplicates=!!f,h(),n.sortDetached=ct((function(t){return 1&t.compareDocumentPosition(p.createElement("fieldset"))})),ct((function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")}))||ft("type|href|height|width",(function(t,e,n){if(!n)return t.getAttribute(e,"type"===e.toLowerCase()?1:2)})),n.attributes&&ct((function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")}))||ft("value",(function(t,e,n){if(!n&&"input"===t.nodeName.toLowerCase())return t.defaultValue})),ct((function(t){return null==t.getAttribute("disabled")}))||ft(P,(function(t,e,n){var o;if(!n)return!0===t[e]?e.toLowerCase():(o=t.getAttributeNode(e))&&o.specified?o.value:null})),st}(t);w.find=x,w.expr=x.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=x.uniqueSort,w.text=x.getText,w.isXMLDoc=x.isXML,w.contains=x.contains,w.escapeSelector=x.escape;var S=function(t,e,n){for(var o=[],r=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(r&&w(t).is(n))break;o.push(t)}return o},A=function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n},I=w.expr.match.needsContext;function R(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}var k=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function M(t,e,n){return d(e)?w.grep(t,(function(t,o){return!!e.call(t,o,t)!==n})):e.nodeType?w.grep(t,(function(t){return t===e!==n})):"string"!=typeof e?w.grep(t,(function(t){return-1<s.call(e,t)!==n})):w.filter(e,t,n)}w.filter=function(t,e,n){var o=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===o.nodeType?w.find.matchesSelector(o,t)?[o]:[]:w.find.matches(t,w.grep(e,(function(t){return 1===t.nodeType})))},w.fn.extend({find:function(t){var e,n,o=this.length,r=this;if("string"!=typeof t)return this.pushStack(w(t).filter((function(){for(e=0;e<o;e++)if(w.contains(r[e],this))return!0})));for(n=this.pushStack([]),e=0;e<o;e++)w.find(t,r[e],n);return 1<o?w.uniqueSort(n):n},filter:function(t){return this.pushStack(M(this,t||[],!1))},not:function(t){return this.pushStack(M(this,t||[],!0))},is:function(t){return!!M(this,"string"==typeof t&&I.test(t)?w(t):t||[],!1).length}});var N,E=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(t,e,n){var o,r;if(!t)return this;if(n=n||N,"string"==typeof t){if(!(o="<"===t[0]&&">"===t[t.length-1]&&3<=t.length?[null,t,null]:E.exec(t))||!o[1]&&e)return!e||e.jquery?(e||n).find(t):this.constructor(e).find(t);if(o[1]){if(e=e instanceof w?e[0]:e,w.merge(this,w.parseHTML(o[1],e&&e.nodeType?e.ownerDocument||e:m,!0)),k.test(o[1])&&w.isPlainObject(e))for(o in e)d(this[o])?this[o](e[o]):this.attr(o,e[o]);return this}return(r=m.getElementById(o[2]))&&(this[0]=r,this.length=1),this}return t.nodeType?(this[0]=t,this.length=1,this):d(t)?void 0!==n.ready?n.ready(t):t(w):w.makeArray(t,this)}).prototype=w.fn,N=w(m);var D=/^(?:parents|prev(?:Until|All))/,O={children:!0,contents:!0,next:!0,prev:!0};function j(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}w.fn.extend({has:function(t){var e=w(t,this),n=e.length;return this.filter((function(){for(var t=0;t<n;t++)if(w.contains(this,e[t]))return!0}))},closest:function(t,e){var n,o=0,r=this.length,i=[],a="string"!=typeof t&&w(t);if(!I.test(t))for(;o<r;o++)for(n=this[o];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&w.find.matchesSelector(n,t))){i.push(n);break}return this.pushStack(1<i.length?w.uniqueSort(i):i)},index:function(t){return t?"string"==typeof t?s.call(w(t),this[0]):s.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),w.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return S(t,"parentNode")},parentsUntil:function(t,e,n){return S(t,"parentNode",n)},next:function(t){return j(t,"nextSibling")},prev:function(t){return j(t,"previousSibling")},nextAll:function(t){return S(t,"nextSibling")},prevAll:function(t){return S(t,"previousSibling")},nextUntil:function(t,e,n){return S(t,"nextSibling",n)},prevUntil:function(t,e,n){return S(t,"previousSibling",n)},siblings:function(t){return A((t.parentNode||{}).firstChild,t)},children:function(t){return A(t.firstChild)},contents:function(t){return null!=t.contentDocument&&o(t.contentDocument)?t.contentDocument:(R(t,"template")&&(t=t.content||t),w.merge([],t.childNodes))}},(function(t,e){w.fn[t]=function(n,o){var r=w.map(this,e,n);return"Until"!==t.slice(-5)&&(o=n),o&&"string"==typeof o&&(r=w.filter(o,r)),1<this.length&&(O[t]||w.uniqueSort(r),D.test(t)&&r.reverse()),this.pushStack(r)}}));var F=/[^\x20\t\r\n\f]+/g;function P(t){return t}function _(t){throw t}function L(t,e,n,o){var r;try{t&&d(r=t.promise)?r.call(t).done(e).fail(n):t&&d(r=t.then)?r.call(t,e,n):e.apply(void 0,[t].slice(o))}catch(t){n.apply(void 0,[t])}}w.Callbacks=function(t){var e,n;t="string"==typeof t?(e=t,n={},w.each(e.match(F)||[],(function(t,e){n[e]=!0})),n):w.extend({},t);var o,r,i,a,s=[],l=[],u=-1,c=function(){for(a=a||t.once,i=o=!0;l.length;u=-1)for(r=l.shift();++u<s.length;)!1===s[u].apply(r[0],r[1])&&t.stopOnFalse&&(u=s.length,r=!1);t.memory||(r=!1),o=!1,a&&(s=r?[]:"")},f={add:function(){return s&&(r&&!o&&(u=s.length-1,l.push(r)),function e(n){w.each(n,(function(n,o){d(o)?t.unique&&f.has(o)||s.push(o):o&&o.length&&"string"!==C(o)&&e(o)}))}(arguments),r&&!o&&c()),this},remove:function(){return w.each(arguments,(function(t,e){for(var n;-1<(n=w.inArray(e,s,n));)s.splice(n,1),n<=u&&u--})),this},has:function(t){return t?-1<w.inArray(t,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=l=[],s=r="",this},disabled:function(){return!s},lock:function(){return a=l=[],r||o||(s=r=""),this},locked:function(){return!!a},fireWith:function(t,e){return a||(e=[t,(e=e||[]).slice?e.slice():e],l.push(e),o||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!i}};return f},w.extend({Deferred:function(e){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],o="pending",r={state:function(){return o},always:function(){return i.done(arguments).fail(arguments),this},catch:function(t){return r.then(null,t)},pipe:function(){var t=arguments;return w.Deferred((function(e){w.each(n,(function(n,o){var r=d(t[o[4]])&&t[o[4]];i[o[1]]((function(){var t=r&&r.apply(this,arguments);t&&d(t.promise)?t.promise().progress(e.notify).done(e.resolve).fail(e.reject):e[o[0]+"With"](this,r?[t]:arguments)}))})),t=null})).promise()},then:function(e,o,r){var i=0;function a(e,n,o,r){return function(){var s=this,l=arguments,u=function(){var t,u;if(!(e<i)){if((t=o.apply(s,l))===n.promise())throw new TypeError("Thenable self-resolution");u=t&&("object"==typeof t||"function"==typeof t)&&t.then,d(u)?r?u.call(t,a(i,n,P,r),a(i,n,_,r)):(i++,u.call(t,a(i,n,P,r),a(i,n,_,r),a(i,n,P,n.notifyWith))):(o!==P&&(s=void 0,l=[t]),(r||n.resolveWith)(s,l))}},c=r?u:function(){try{u()}catch(u){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(u,c.stackTrace),i<=e+1&&(o!==_&&(s=void 0,l=[u]),n.rejectWith(s,l))}};e?c():(w.Deferred.getStackHook&&(c.stackTrace=w.Deferred.getStackHook()),t.setTimeout(c))}}return w.Deferred((function(t){n[0][3].add(a(0,t,d(r)?r:P,t.notifyWith)),n[1][3].add(a(0,t,d(e)?e:P)),n[2][3].add(a(0,t,d(o)?o:_))})).promise()},promise:function(t){return null!=t?w.extend(t,r):r}},i={};return w.each(n,(function(t,e){var a=e[2],s=e[5];r[e[1]]=a.add,s&&a.add((function(){o=s}),n[3-t][2].disable,n[3-t][3].disable,n[0][2].lock,n[0][3].lock),a.add(e[3].fire),i[e[0]]=function(){return i[e[0]+"With"](this===i?void 0:this,arguments),this},i[e[0]+"With"]=a.fireWith})),r.promise(i),e&&e.call(i,i),i},when:function(t){var e=arguments.length,n=e,o=Array(n),i=r.call(arguments),a=w.Deferred(),s=function(t){return function(n){o[t]=this,i[t]=1<arguments.length?r.call(arguments):n,--e||a.resolveWith(o,i)}};if(e<=1&&(L(t,a.done(s(n)).resolve,a.reject,!e),"pending"===a.state()||d(i[n]&&i[n].then)))return a.then();for(;n--;)L(i[n],s(n),a.reject);return a.promise()}});var B=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(e,n){t.console&&t.console.warn&&e&&B.test(e.name)&&t.console.warn("jQuery.Deferred exception: "+e.message,e.stack,n)},w.readyException=function(e){t.setTimeout((function(){throw e}))};var G=w.Deferred();function H(){m.removeEventListener("DOMContentLoaded",H),t.removeEventListener("load",H),w.ready()}w.fn.ready=function(t){return G.then(t).catch((function(t){w.readyException(t)})),this},w.extend({isReady:!1,readyWait:1,ready:function(t){(!0===t?--w.readyWait:w.isReady)||(w.isReady=!0)!==t&&0<--w.readyWait||G.resolveWith(m,[w])}}),w.ready.then=G.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?t.setTimeout(w.ready):(m.addEventListener("DOMContentLoaded",H),t.addEventListener("load",H));var V=function(t,e,n,o,r,i,a){var s=0,l=t.length,u=null==n;if("object"===C(n))for(s in r=!0,n)V(t,e,s,n[s],!0,i,a);else if(void 0!==o&&(r=!0,d(o)||(a=!0),u&&(a?(e.call(t,o),e=null):(u=e,e=function(t,e,n){return u.call(w(t),n)})),e))for(;s<l;s++)e(t[s],n,a?o:o.call(t[s],s,e(t[s],n)));return r?t:u?e.call(t):l?e(t[0],n):i},z=/^-ms-/,W=/-([a-z])/g;function U(t,e){return e.toUpperCase()}function q(t){return t.replace(z,"ms-").replace(W,U)}var Y=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType};function X(){this.expando=w.expando+X.uid++}X.uid=1,X.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Y(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,n){var o,r=this.cache(t);if("string"==typeof e)r[q(e)]=n;else for(o in e)r[q(o)]=e[o];return r},get:function(t,e){return void 0===e?this.cache(t):t[this.expando]&&t[this.expando][q(e)]},access:function(t,e,n){return void 0===e||e&&"string"==typeof e&&void 0===n?this.get(t,e):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,o=t[this.expando];if(void 0!==o){if(void 0!==e){n=(e=Array.isArray(e)?e.map(q):(e=q(e))in o?[e]:e.match(F)||[]).length;for(;n--;)delete o[e[n]]}(void 0===e||w.isEmptyObject(o))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return void 0!==e&&!w.isEmptyObject(e)}};var Z=new X,Q=new X,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,$=/[A-Z]/g;function K(t,e,n){var o,r;if(void 0===n&&1===t.nodeType)if(o="data-"+e.replace($,"-$&").toLowerCase(),"string"==typeof(n=t.getAttribute(o))){try{n="true"===(r=n)||"false"!==r&&("null"===r?null:r===+r+""?+r:J.test(r)?JSON.parse(r):r)}catch(t){}Q.set(t,e,n)}else n=void 0;return n}w.extend({hasData:function(t){return Q.hasData(t)||Z.hasData(t)},data:function(t,e,n){return Q.access(t,e,n)},removeData:function(t,e){Q.remove(t,e)},_data:function(t,e,n){return Z.access(t,e,n)},_removeData:function(t,e){Z.remove(t,e)}}),w.fn.extend({data:function(t,e){var n,o,r,i=this[0],a=i&&i.attributes;if(void 0===t){if(this.length&&(r=Q.get(i),1===i.nodeType&&!Z.get(i,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&0===(o=a[n].name).indexOf("data-")&&(o=q(o.slice(5)),K(i,o,r[o]));Z.set(i,"hasDataAttrs",!0)}return r}return"object"==typeof t?this.each((function(){Q.set(this,t)})):V(this,(function(e){var n;if(i&&void 0===e)return void 0!==(n=Q.get(i,t))||void 0!==(n=K(i,t))?n:void 0;this.each((function(){Q.set(this,t,e)}))}),null,e,1<arguments.length,null,!0)},removeData:function(t){return this.each((function(){Q.remove(this,t)}))}}),w.extend({queue:function(t,e,n){var o;if(t)return e=(e||"fx")+"queue",o=Z.get(t,e),n&&(!o||Array.isArray(n)?o=Z.access(t,e,w.makeArray(n)):o.push(n)),o||[]},dequeue:function(t,e){e=e||"fx";var n=w.queue(t,e),o=n.length,r=n.shift(),i=w._queueHooks(t,e);"inprogress"===r&&(r=n.shift(),o--),r&&("fx"===e&&n.unshift("inprogress"),delete i.stop,r.call(t,(function(){w.dequeue(t,e)}),i)),!o&&i&&i.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return Z.get(t,n)||Z.access(t,n,{empty:w.Callbacks("once memory").add((function(){Z.remove(t,[e+"queue",n])}))})}}),w.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?w.queue(this[0],t):void 0===e?this:this.each((function(){var n=w.queue(this,t,e);w._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&w.dequeue(this,t)}))},dequeue:function(t){return this.each((function(){w.dequeue(this,t)}))},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,o=1,r=w.Deferred(),i=this,a=this.length,s=function(){--o||r.resolveWith(i,[i])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";a--;)(n=Z.get(i[a],t+"queueHooks"))&&n.empty&&(o++,n.empty.add(s));return s(),r.promise(e)}});var tt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,et=new RegExp("^(?:([+-])=|)("+tt+")([a-z%]*)$","i"),nt=["Top","Right","Bottom","Left"],ot=m.documentElement,rt=function(t){return w.contains(t.ownerDocument,t)},it={composed:!0};ot.getRootNode&&(rt=function(t){return w.contains(t.ownerDocument,t)||t.getRootNode(it)===t.ownerDocument});var at=function(t,e){return"none"===(t=e||t).style.display||""===t.style.display&&rt(t)&&"none"===w.css(t,"display")},st={};function lt(t,e){for(var n,o,r,i,a,s,l,u=[],c=0,f=t.length;c<f;c++)(o=t[c]).style&&(n=o.style.display,e?("none"===n&&(u[c]=Z.get(o,"display")||null,u[c]||(o.style.display="")),""===o.style.display&&at(o)&&(u[c]=(l=a=i=void 0,a=(r=o).ownerDocument,s=r.nodeName,(l=st[s])||(i=a.body.appendChild(a.createElement(s)),l=w.css(i,"display"),i.parentNode.removeChild(i),"none"===l&&(l="block"),st[s]=l)))):"none"!==n&&(u[c]="none",Z.set(o,"display",n)));for(c=0;c<f;c++)null!=u[c]&&(t[c].style.display=u[c]);return t}w.fn.extend({show:function(){return lt(this,!0)},hide:function(){return lt(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each((function(){at(this)?w(this).show():w(this).hide()}))}});var ut,ct,ft=/^(?:checkbox|radio)$/i,ht=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,pt=/^$|^module$|\/(?:java|ecma)script/i;ut=m.createDocumentFragment().appendChild(m.createElement("div")),(ct=m.createElement("input")).setAttribute("type","radio"),ct.setAttribute("checked","checked"),ct.setAttribute("name","t"),ut.appendChild(ct),p.checkClone=ut.cloneNode(!0).cloneNode(!0).lastChild.checked,ut.innerHTML="<textarea>x</textarea>",p.noCloneChecked=!!ut.cloneNode(!0).lastChild.defaultValue,ut.innerHTML="<option></option>",p.option=!!ut.lastChild;var dt={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function gt(t,e){var n;return n=void 0!==t.getElementsByTagName?t.getElementsByTagName(e||"*"):void 0!==t.querySelectorAll?t.querySelectorAll(e||"*"):[],void 0===e||e&&R(t,e)?w.merge([t],n):n}function mt(t,e){for(var n=0,o=t.length;n<o;n++)Z.set(t[n],"globalEval",!e||Z.get(e[n],"globalEval"))}dt.tbody=dt.tfoot=dt.colgroup=dt.caption=dt.thead,dt.th=dt.td,p.option||(dt.optgroup=dt.option=[1,"<select multiple='multiple'>","</select>"]);var yt=/<|&#?\w+;/;function vt(t,e,n,o,r){for(var i,a,s,l,u,c,f=e.createDocumentFragment(),h=[],p=0,d=t.length;p<d;p++)if((i=t[p])||0===i)if("object"===C(i))w.merge(h,i.nodeType?[i]:i);else if(yt.test(i)){for(a=a||f.appendChild(e.createElement("div")),s=(ht.exec(i)||["",""])[1].toLowerCase(),l=dt[s]||dt._default,a.innerHTML=l[1]+w.htmlPrefilter(i)+l[2],c=l[0];c--;)a=a.lastChild;w.merge(h,a.childNodes),(a=f.firstChild).textContent=""}else h.push(e.createTextNode(i));for(f.textContent="",p=0;i=h[p++];)if(o&&-1<w.inArray(i,o))r&&r.push(i);else if(u=rt(i),a=gt(f.appendChild(i),"script"),u&&mt(a),n)for(c=0;i=a[c++];)pt.test(i.type||"")&&n.push(i);return f}var Ct=/^key/,bt=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,wt=/^([^.]*)(?:\.(.+)|)/;function Tt(){return!0}function xt(){return!1}function St(t,e){return t===function(){try{return m.activeElement}catch(t){}}()==("focus"===e)}function At(t,e,n,o,r,i){var a,s;if("object"==typeof e){for(s in"string"!=typeof n&&(o=o||n,n=void 0),e)At(t,s,n,o,e[s],i);return t}if(null==o&&null==r?(r=n,o=n=void 0):null==r&&("string"==typeof n?(r=o,o=void 0):(r=o,o=n,n=void 0)),!1===r)r=xt;else if(!r)return t;return 1===i&&(a=r,(r=function(t){return w().off(t),a.apply(this,arguments)}).guid=a.guid||(a.guid=w.guid++)),t.each((function(){w.event.add(this,e,r,o,n)}))}function It(t,e,n){n?(Z.set(t,e,!1),w.event.add(t,e,{namespace:!1,handler:function(t){var o,i,a=Z.get(this,e);if(1&t.isTrigger&&this[e]){if(a.length)(w.event.special[e]||{}).delegateType&&t.stopPropagation();else if(a=r.call(arguments),Z.set(this,e,a),o=n(this,e),this[e](),a!==(i=Z.get(this,e))||o?Z.set(this,e,!1):i={},a!==i)return t.stopImmediatePropagation(),t.preventDefault(),i.value}else a.length&&(Z.set(this,e,{value:w.event.trigger(w.extend(a[0],w.Event.prototype),a.slice(1),this)}),t.stopImmediatePropagation())}})):void 0===Z.get(t,e)&&w.event.add(t,e,Tt)}w.event={global:{},add:function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=Z.get(t);if(Y(t))for(n.handler&&(n=(i=n).handler,r=i.selector),r&&w.find.matchesSelector(ot,r),n.guid||(n.guid=w.guid++),(l=m.events)||(l=m.events=Object.create(null)),(a=m.handle)||(a=m.handle=function(e){return void 0!==w&&w.event.triggered!==e.type?w.event.dispatch.apply(t,arguments):void 0}),u=(e=(e||"").match(F)||[""]).length;u--;)p=g=(s=wt.exec(e[u])||[])[1],d=(s[2]||"").split(".").sort(),p&&(f=w.event.special[p]||{},p=(r?f.delegateType:f.bindType)||p,f=w.event.special[p]||{},c=w.extend({type:p,origType:g,data:o,handler:n,guid:n.guid,selector:r,needsContext:r&&w.expr.match.needsContext.test(r),namespace:d.join(".")},i),(h=l[p])||((h=l[p]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,o,d,a)||t.addEventListener&&t.addEventListener(p,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?h.splice(h.delegateCount++,0,c):h.push(c),w.event.global[p]=!0)},remove:function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=Z.hasData(t)&&Z.get(t);if(m&&(l=m.events)){for(u=(e=(e||"").match(F)||[""]).length;u--;)if(p=g=(s=wt.exec(e[u])||[])[1],d=(s[2]||"").split(".").sort(),p){for(f=w.event.special[p]||{},h=l[p=(o?f.delegateType:f.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=i=h.length;i--;)c=h[i],!r&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||o&&o!==c.selector&&("**"!==o||!c.selector)||(h.splice(i,1),c.selector&&h.delegateCount--,f.remove&&f.remove.call(t,c));a&&!h.length&&(f.teardown&&!1!==f.teardown.call(t,d,m.handle)||w.removeEvent(t,p,m.handle),delete l[p])}else for(p in l)w.event.remove(t,p+e[u],n,o,!0);w.isEmptyObject(l)&&Z.remove(t,"handle events")}},dispatch:function(t){var e,n,o,r,i,a,s=new Array(arguments.length),l=w.event.fix(t),u=(Z.get(this,"events")||Object.create(null))[l.type]||[],c=w.event.special[l.type]||{};for(s[0]=l,e=1;e<arguments.length;e++)s[e]=arguments[e];if(l.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,l)){for(a=w.event.handlers.call(this,l,u),e=0;(r=a[e++])&&!l.isPropagationStopped();)for(l.currentTarget=r.elem,n=0;(i=r.handlers[n++])&&!l.isImmediatePropagationStopped();)l.rnamespace&&!1!==i.namespace&&!l.rnamespace.test(i.namespace)||(l.handleObj=i,l.data=i.data,void 0!==(o=((w.event.special[i.origType]||{}).handle||i.handler).apply(r.elem,s))&&!1===(l.result=o)&&(l.preventDefault(),l.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,l),l.result}},handlers:function(t,e){var n,o,r,i,a,s=[],l=e.delegateCount,u=t.target;if(l&&u.nodeType&&!("click"===t.type&&1<=t.button))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==t.type||!0!==u.disabled)){for(i=[],a={},n=0;n<l;n++)void 0===a[r=(o=e[n]).selector+" "]&&(a[r]=o.needsContext?-1<w(r,this).index(u):w.find(r,this,null,[u]).length),a[r]&&i.push(o);i.length&&s.push({elem:u,handlers:i})}return u=this,l<e.length&&s.push({elem:u,handlers:e.slice(l)}),s},addProp:function(t,e){Object.defineProperty(w.Event.prototype,t,{enumerable:!0,configurable:!0,get:d(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(t){return t[w.expando]?t:new w.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return ft.test(e.type)&&e.click&&R(e,"input")&&It(e,"click",Tt),!1},trigger:function(t){var e=this||t;return ft.test(e.type)&&e.click&&R(e,"input")&&It(e,"click"),!0},_default:function(t){var e=t.target;return ft.test(e.type)&&e.click&&R(e,"input")&&Z.get(e,"click")||R(e,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}},w.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n)},w.Event=function(t,e){if(!(this instanceof w.Event))return new w.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&!1===t.returnValue?Tt:xt,this.target=t.target&&3===t.target.nodeType?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&w.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:xt,isPropagationStopped:xt,isImmediatePropagationStopped:xt,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=Tt,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=Tt,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=Tt,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(t){var e=t.button;return null==t.which&&Ct.test(t.type)?null!=t.charCode?t.charCode:t.keyCode:!t.which&&void 0!==e&&bt.test(t.type)?1&e?1:2&e?3:4&e?2:0:t.which}},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},(function(t,e){w.event.special[t]={setup:function(){return It(this,t,St),!1},trigger:function(){return It(this,t),!0},delegateType:e}})),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(t,e){w.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,o=t.relatedTarget,r=t.handleObj;return o&&(o===this||w.contains(this,o))||(t.type=r.origType,n=r.handler.apply(this,arguments),t.type=e),n}}})),w.fn.extend({on:function(t,e,n,o){return At(this,t,e,n,o)},one:function(t,e,n,o){return At(this,t,e,n,o,1)},off:function(t,e,n){var o,r;if(t&&t.preventDefault&&t.handleObj)return o=t.handleObj,w(t.delegateTarget).off(o.namespace?o.origType+"."+o.namespace:o.origType,o.selector,o.handler),this;if("object"==typeof t){for(r in t)this.off(r,e,t[r]);return this}return!1!==e&&"function"!=typeof e||(n=e,e=void 0),!1===n&&(n=xt),this.each((function(){w.event.remove(this,t,n,e)}))}});var Rt=/<script|<style|<link/i,kt=/checked\s*(?:[^=]|=\s*.checked.)/i,Mt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Nt(t,e){return R(t,"table")&&R(11!==e.nodeType?e:e.firstChild,"tr")&&w(t).children("tbody")[0]||t}function Et(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function Dt(t){return"true/"===(t.type||"").slice(0,5)?t.type=t.type.slice(5):t.removeAttribute("type"),t}function Ot(t,e){var n,o,r,i,a,s;if(1===e.nodeType){if(Z.hasData(t)&&(s=Z.get(t).events))for(r in Z.remove(e,"handle events"),s)for(n=0,o=s[r].length;n<o;n++)w.event.add(e,r,s[r][n]);Q.hasData(t)&&(i=Q.access(t),a=w.extend({},i),Q.set(e,a))}}function jt(t,e,n,o){e=i(e);var r,a,s,l,u,c,f=0,h=t.length,g=h-1,m=e[0],y=d(m);if(y||1<h&&"string"==typeof m&&!p.checkClone&&kt.test(m))return t.each((function(r){var i=t.eq(r);y&&(e[0]=m.call(this,r,i.html())),jt(i,e,n,o)}));if(h&&(a=(r=vt(e,t[0].ownerDocument,!1,t,o)).firstChild,1===r.childNodes.length&&(r=a),a||o)){for(l=(s=w.map(gt(r,"script"),Et)).length;f<h;f++)u=r,f!==g&&(u=w.clone(u,!0,!0),l&&w.merge(s,gt(u,"script"))),n.call(t[f],u,f);if(l)for(c=s[s.length-1].ownerDocument,w.map(s,Dt),f=0;f<l;f++)u=s[f],pt.test(u.type||"")&&!Z.access(u,"globalEval")&&w.contains(c,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?w._evalUrl&&!u.noModule&&w._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},c):v(u.textContent.replace(Mt,""),u,c))}return t}function Ft(t,e,n){for(var o,r=e?w.filter(e,t):t,i=0;null!=(o=r[i]);i++)n||1!==o.nodeType||w.cleanData(gt(o)),o.parentNode&&(n&&rt(o)&&mt(gt(o,"script")),o.parentNode.removeChild(o));return t}w.extend({htmlPrefilter:function(t){return t},clone:function(t,e,n){var o,r,i,a,s,l,u,c=t.cloneNode(!0),f=rt(t);if(!(p.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||w.isXMLDoc(t)))for(a=gt(c),o=0,r=(i=gt(t)).length;o<r;o++)s=i[o],"input"===(u=(l=a[o]).nodeName.toLowerCase())&&ft.test(s.type)?l.checked=s.checked:"input"!==u&&"textarea"!==u||(l.defaultValue=s.defaultValue);if(e)if(n)for(i=i||gt(t),a=a||gt(c),o=0,r=i.length;o<r;o++)Ot(i[o],a[o]);else Ot(t,c);return 0<(a=gt(c,"script")).length&&mt(a,!f&&gt(t,"script")),c},cleanData:function(t){for(var e,n,o,r=w.event.special,i=0;void 0!==(n=t[i]);i++)if(Y(n)){if(e=n[Z.expando]){if(e.events)for(o in e.events)r[o]?w.event.remove(n,o):w.removeEvent(n,o,e.handle);n[Z.expando]=void 0}n[Q.expando]&&(n[Q.expando]=void 0)}}}),w.fn.extend({detach:function(t){return Ft(this,t,!0)},remove:function(t){return Ft(this,t)},text:function(t){return V(this,(function(t){return void 0===t?w.text(this):this.empty().each((function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=t)}))}),null,t,arguments.length)},append:function(){return jt(this,arguments,(function(t){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Nt(this,t).appendChild(t)}))},prepend:function(){return jt(this,arguments,(function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=Nt(this,t);e.insertBefore(t,e.firstChild)}}))},before:function(){return jt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this)}))},after:function(){return jt(this,arguments,(function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)}))},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(w.cleanData(gt(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null!=t&&t,e=null==e?t:e,this.map((function(){return w.clone(this,t,e)}))},html:function(t){return V(this,(function(t){var e=this[0]||{},n=0,o=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Rt.test(t)&&!dt[(ht.exec(t)||["",""])[1].toLowerCase()]){t=w.htmlPrefilter(t);try{for(;n<o;n++)1===(e=this[n]||{}).nodeType&&(w.cleanData(gt(e,!1)),e.innerHTML=t);e=0}catch(t){}}e&&this.empty().append(t)}),null,t,arguments.length)},replaceWith:function(){var t=[];return jt(this,arguments,(function(e){var n=this.parentNode;w.inArray(this,t)<0&&(w.cleanData(gt(this)),n&&n.replaceChild(e,this))}),t)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(t,e){w.fn[t]=function(t){for(var n,o=[],r=w(t),i=r.length-1,s=0;s<=i;s++)n=s===i?this:this.clone(!0),w(r[s])[e](n),a.apply(o,n.get());return this.pushStack(o)}}));var Pt=new RegExp("^("+tt+")(?!px)[a-z%]+$","i"),_t=function(e){var n=e.ownerDocument.defaultView;return n&&n.opener||(n=t),n.getComputedStyle(e)},Lt=function(t,e,n){var o,r,i={};for(r in e)i[r]=t.style[r],t.style[r]=e[r];for(r in o=n.call(t),e)t.style[r]=i[r];return o},Bt=new RegExp(nt.join("|"),"i");function Gt(t,e,n){var o,r,i,a,s=t.style;return(n=n||_t(t))&&(""!==(a=n.getPropertyValue(e)||n[e])||rt(t)||(a=w.style(t,e)),!p.pixelBoxStyles()&&Pt.test(a)&&Bt.test(e)&&(o=s.width,r=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=o,s.minWidth=r,s.maxWidth=i)),void 0!==a?a+"":a}function Ht(t,e){return{get:function(){if(!t())return(this.get=e).apply(this,arguments);delete this.get}}}!function(){function e(){if(c){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ot.appendChild(u).appendChild(c);var e=t.getComputedStyle(c);o="1%"!==e.top,l=12===n(e.marginLeft),c.style.right="60%",a=36===n(e.right),r=36===n(e.width),c.style.position="absolute",i=12===n(c.offsetWidth/3),ot.removeChild(u),c=null}}function n(t){return Math.round(parseFloat(t))}var o,r,i,a,s,l,u=m.createElement("div"),c=m.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",p.clearCloneStyle="content-box"===c.style.backgroundClip,w.extend(p,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),a},pixelPosition:function(){return e(),o},reliableMarginLeft:function(){return e(),l},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,n,o,r;return null==s&&(e=m.createElement("table"),n=m.createElement("tr"),o=m.createElement("div"),e.style.cssText="position:absolute;left:-11111px",n.style.height="1px",o.style.height="9px",ot.appendChild(e).appendChild(n).appendChild(o),r=t.getComputedStyle(n),s=3<parseInt(r.height),ot.removeChild(e)),s}}))}();var Vt=["Webkit","Moz","ms"],zt=m.createElement("div").style,Wt={};function Ut(t){return w.cssProps[t]||Wt[t]||(t in zt?t:Wt[t]=function(t){for(var e=t[0].toUpperCase()+t.slice(1),n=Vt.length;n--;)if((t=Vt[n]+e)in zt)return t}(t)||t)}var qt,Yt,Xt=/^(none|table(?!-c[ea]).+)/,Zt=/^--/,Qt={position:"absolute",visibility:"hidden",display:"block"},Jt={letterSpacing:"0",fontWeight:"400"};function $t(t,e,n){var o=et.exec(e);return o?Math.max(0,o[2]-(n||0))+(o[3]||"px"):e}function Kt(t,e,n,o,r,i){var a="width"===e?1:0,s=0,l=0;if(n===(o?"border":"content"))return 0;for(;a<4;a+=2)"margin"===n&&(l+=w.css(t,n+nt[a],!0,r)),o?("content"===n&&(l-=w.css(t,"padding"+nt[a],!0,r)),"margin"!==n&&(l-=w.css(t,"border"+nt[a]+"Width",!0,r))):(l+=w.css(t,"padding"+nt[a],!0,r),"padding"!==n?l+=w.css(t,"border"+nt[a]+"Width",!0,r):s+=w.css(t,"border"+nt[a]+"Width",!0,r));return!o&&0<=i&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-i-l-s-.5))||0),l}function te(t,e,n){var o=_t(t),r=(!p.boxSizingReliable()||n)&&"border-box"===w.css(t,"boxSizing",!1,o),i=r,a=Gt(t,e,o),s="offset"+e[0].toUpperCase()+e.slice(1);if(Pt.test(a)){if(!n)return a;a="auto"}return(!p.boxSizingReliable()&&r||!p.reliableTrDimensions()&&R(t,"tr")||"auto"===a||!parseFloat(a)&&"inline"===w.css(t,"display",!1,o))&&t.getClientRects().length&&(r="border-box"===w.css(t,"boxSizing",!1,o),(i=s in t)&&(a=t[s])),(a=parseFloat(a)||0)+Kt(t,e,n||(r?"border":"content"),i,o,a)+"px"}w.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=Gt(t,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,n,o){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,i,a,s=q(e),l=Zt.test(e),u=t.style;if(l||(e=Ut(s)),a=w.cssHooks[e]||w.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(r=a.get(t,!1,o))?r:u[e];"string"==(i=typeof n)&&(r=et.exec(n))&&r[1]&&(n=function(t,e,n,o){var r,i,a=20,s=function(){return w.css(t,e,"")},l=s(),u=n&&n[3]||(w.cssNumber[e]?"":"px"),c=t.nodeType&&(w.cssNumber[e]||"px"!==u&&+l)&&et.exec(w.css(t,e));if(c&&c[3]!==u){for(l/=2,u=u||c[3],c=+l||1;a--;)w.style(t,e,c+u),(1-i)*(1-(i=s()/l||.5))<=0&&(a=0),c/=i;c*=2,w.style(t,e,c+u),n=n||[]}return n&&(c=+c||+l||0,r=n[1]?c+(n[1]+1)*n[2]:+n[2]),r}(t,e,r),i="number"),null!=n&&n==n&&("number"!==i||l||(n+=r&&r[3]||(w.cssNumber[s]?"":"px")),p.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),a&&"set"in a&&void 0===(n=a.set(t,n,o))||(l?u.setProperty(e,n):u[e]=n))}},css:function(t,e,n,o){var r,i,a,s=q(e);return Zt.test(e)||(e=Ut(s)),(a=w.cssHooks[e]||w.cssHooks[s])&&"get"in a&&(r=a.get(t,!0,n)),void 0===r&&(r=Gt(t,e,o)),"normal"===r&&e in Jt&&(r=Jt[e]),""===n||n?(i=parseFloat(r),!0===n||isFinite(i)?i||0:r):r}}),w.each(["height","width"],(function(t,e){w.cssHooks[e]={get:function(t,n,o){if(n)return!Xt.test(w.css(t,"display"))||t.getClientRects().length&&t.getBoundingClientRect().width?te(t,e,o):Lt(t,Qt,(function(){return te(t,e,o)}))},set:function(t,n,o){var r,i=_t(t),a=!p.scrollboxSize()&&"absolute"===i.position,s=(a||o)&&"border-box"===w.css(t,"boxSizing",!1,i),l=o?Kt(t,e,o,s,i):0;return s&&a&&(l-=Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(i[e])-Kt(t,e,"border",!1,i)-.5)),l&&(r=et.exec(n))&&"px"!==(r[3]||"px")&&(t.style[e]=n,n=w.css(t,e)),$t(0,n,l)}}})),w.cssHooks.marginLeft=Ht(p.reliableMarginLeft,(function(t,e){if(e)return(parseFloat(Gt(t,"marginLeft"))||t.getBoundingClientRect().left-Lt(t,{marginLeft:0},(function(){return t.getBoundingClientRect().left})))+"px"})),w.each({margin:"",padding:"",border:"Width"},(function(t,e){w.cssHooks[t+e]={expand:function(n){for(var o=0,r={},i="string"==typeof n?n.split(" "):[n];o<4;o++)r[t+nt[o]+e]=i[o]||i[o-2]||i[0];return r}},"margin"!==t&&(w.cssHooks[t+e].set=$t)})),w.fn.extend({css:function(t,e){return V(this,(function(t,e,n){var o,r,i={},a=0;if(Array.isArray(e)){for(o=_t(t),r=e.length;a<r;a++)i[e[a]]=w.css(t,e[a],!1,o);return i}return void 0!==n?w.style(t,e,n):w.css(t,e)}),t,e,1<arguments.length)}}),w.fn.delay=function(e,n){return e=w.fx&&w.fx.speeds[e]||e,n=n||"fx",this.queue(n,(function(n,o){var r=t.setTimeout(n,e);o.stop=function(){t.clearTimeout(r)}}))},qt=m.createElement("input"),Yt=m.createElement("select").appendChild(m.createElement("option")),qt.type="checkbox",p.checkOn=""!==qt.value,p.optSelected=Yt.selected,(qt=m.createElement("input")).value="t",qt.type="radio",p.radioValue="t"===qt.value;var ee,ne=w.expr.attrHandle;w.fn.extend({attr:function(t,e){return V(this,w.attr,t,e,1<arguments.length)},removeAttr:function(t){return this.each((function(){w.removeAttr(this,t)}))}}),w.extend({attr:function(t,e,n){var o,r,i=t.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===t.getAttribute?w.prop(t,e,n):(1===i&&w.isXMLDoc(t)||(r=w.attrHooks[e.toLowerCase()]||(w.expr.match.bool.test(e)?ee:void 0)),void 0!==n?null===n?void w.removeAttr(t,e):r&&"set"in r&&void 0!==(o=r.set(t,n,e))?o:(t.setAttribute(e,n+""),n):r&&"get"in r&&null!==(o=r.get(t,e))?o:null==(o=w.find.attr(t,e))?void 0:o)},attrHooks:{type:{set:function(t,e){if(!p.radioValue&&"radio"===e&&R(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}},removeAttr:function(t,e){var n,o=0,r=e&&e.match(F);if(r&&1===t.nodeType)for(;n=r[o++];)t.removeAttribute(n)}}),ee={set:function(t,e,n){return!1===e?w.removeAttr(t,n):t.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),(function(t,e){var n=ne[e]||w.find.attr;ne[e]=function(t,e,o){var r,i,a=e.toLowerCase();return o||(i=ne[a],ne[a]=r,r=null!=n(t,e,o)?a:null,ne[a]=i),r}}));var oe=/^(?:input|select|textarea|button)$/i,re=/^(?:a|area)$/i;function ie(t){return(t.match(F)||[]).join(" ")}function ae(t){return t.getAttribute&&t.getAttribute("class")||""}function se(t){return Array.isArray(t)?t:"string"==typeof t&&t.match(F)||[]}w.fn.extend({prop:function(t,e){return V(this,w.prop,t,e,1<arguments.length)},removeProp:function(t){return this.each((function(){delete this[w.propFix[t]||t]}))}}),w.extend({prop:function(t,e,n){var o,r,i=t.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&w.isXMLDoc(t)||(e=w.propFix[e]||e,r=w.propHooks[e]),void 0!==n?r&&"set"in r&&void 0!==(o=r.set(t,n,e))?o:t[e]=n:r&&"get"in r&&null!==(o=r.get(t,e))?o:t[e]},propHooks:{tabIndex:{get:function(t){var e=w.find.attr(t,"tabindex");return e?parseInt(e,10):oe.test(t.nodeName)||re.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),p.optSelected||(w.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){w.propFix[this.toLowerCase()]=this})),w.fn.extend({addClass:function(t){var e,n,o,r,i,a,s,l=0;if(d(t))return this.each((function(e){w(this).addClass(t.call(this,e,ae(this)))}));if((e=se(t)).length)for(;n=this[l++];)if(r=ae(n),o=1===n.nodeType&&" "+ie(r)+" "){for(a=0;i=e[a++];)o.indexOf(" "+i+" ")<0&&(o+=i+" ");r!==(s=ie(o))&&n.setAttribute("class",s)}return this},removeClass:function(t){var e,n,o,r,i,a,s,l=0;if(d(t))return this.each((function(e){w(this).removeClass(t.call(this,e,ae(this)))}));if(!arguments.length)return this.attr("class","");if((e=se(t)).length)for(;n=this[l++];)if(r=ae(n),o=1===n.nodeType&&" "+ie(r)+" "){for(a=0;i=e[a++];)for(;-1<o.indexOf(" "+i+" ");)o=o.replace(" "+i+" "," ");r!==(s=ie(o))&&n.setAttribute("class",s)}return this},toggleClass:function(t,e){var n=typeof t,o="string"===n||Array.isArray(t);return"boolean"==typeof e&&o?e?this.addClass(t):this.removeClass(t):d(t)?this.each((function(n){w(this).toggleClass(t.call(this,n,ae(this),e),e)})):this.each((function(){var e,r,i,a;if(o)for(r=0,i=w(this),a=se(t);e=a[r++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else void 0!==t&&"boolean"!==n||((e=ae(this))&&Z.set(this,"__className__",e),this.setAttribute&&this.setAttribute("class",e||!1===t?"":Z.get(this,"__className__")||""))}))},hasClass:function(t){var e,n,o=0;for(e=" "+t+" ";n=this[o++];)if(1===n.nodeType&&-1<(" "+ie(ae(n))+" ").indexOf(e))return!0;return!1}});var le=/\r/g;w.fn.extend({val:function(t){var e,n,o,r=this[0];return arguments.length?(o=d(t),this.each((function(n){var r;1===this.nodeType&&(null==(r=o?t.call(this,n,w(this).val()):t)?r="":"number"==typeof r?r+="":Array.isArray(r)&&(r=w.map(r,(function(t){return null==t?"":t+""}))),(e=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in e&&void 0!==e.set(this,r,"value")||(this.value=r))}))):r?(e=w.valHooks[r.type]||w.valHooks[r.nodeName.toLowerCase()])&&"get"in e&&void 0!==(n=e.get(r,"value"))?n:"string"==typeof(n=r.value)?n.replace(le,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(t){var e=w.find.attr(t,"value");return null!=e?e:ie(w.text(t))}},select:{get:function(t){var e,n,o,r=t.options,i=t.selectedIndex,a="select-one"===t.type,s=a?null:[],l=a?i+1:r.length;for(o=i<0?l:a?i:0;o<l;o++)if(((n=r[o]).selected||o===i)&&!n.disabled&&(!n.parentNode.disabled||!R(n.parentNode,"optgroup"))){if(e=w(n).val(),a)return e;s.push(e)}return s},set:function(t,e){for(var n,o,r=t.options,i=w.makeArray(e),a=r.length;a--;)((o=r[a]).selected=-1<w.inArray(w.valHooks.option.get(o),i))&&(n=!0);return n||(t.selectedIndex=-1),i}}}}),w.each(["radio","checkbox"],(function(){w.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=-1<w.inArray(w(t).val(),e)}},p.checkOn||(w.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})})),p.focusin="onfocusin"in t;var ue=/^(?:focusinfocus|focusoutblur)$/,ce=function(t){t.stopPropagation()};w.extend(w.event,{trigger:function(e,n,o,r){var i,a,s,l,u,f,h,p,y=[o||m],v=c.call(e,"type")?e.type:e,C=c.call(e,"namespace")?e.namespace.split("."):[];if(a=p=s=o=o||m,3!==o.nodeType&&8!==o.nodeType&&!ue.test(v+w.event.triggered)&&(-1<v.indexOf(".")&&(v=(C=v.split(".")).shift(),C.sort()),u=v.indexOf(":")<0&&"on"+v,(e=e[w.expando]?e:new w.Event(v,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=C.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+C.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=o),n=null==n?[e]:w.makeArray(n,[e]),h=w.event.special[v]||{},r||!h.trigger||!1!==h.trigger.apply(o,n))){if(!r&&!h.noBubble&&!g(o)){for(l=h.delegateType||v,ue.test(l+v)||(a=a.parentNode);a;a=a.parentNode)y.push(a),s=a;s===(o.ownerDocument||m)&&y.push(s.defaultView||s.parentWindow||t)}for(i=0;(a=y[i++])&&!e.isPropagationStopped();)p=a,e.type=1<i?l:h.bindType||v,(f=(Z.get(a,"events")||Object.create(null))[e.type]&&Z.get(a,"handle"))&&f.apply(a,n),(f=u&&a[u])&&f.apply&&Y(a)&&(e.result=f.apply(a,n),!1===e.result&&e.preventDefault());return e.type=v,r||e.isDefaultPrevented()||h._default&&!1!==h._default.apply(y.pop(),n)||!Y(o)||u&&d(o[v])&&!g(o)&&((s=o[u])&&(o[u]=null),w.event.triggered=v,e.isPropagationStopped()&&p.addEventListener(v,ce),o[v](),e.isPropagationStopped()&&p.removeEventListener(v,ce),w.event.triggered=void 0,s&&(o[u]=s)),e.result}},simulate:function(t,e,n){var o=w.extend(new w.Event,n,{type:t,isSimulated:!0});w.event.trigger(o,null,e)}}),w.fn.extend({trigger:function(t,e){return this.each((function(){w.event.trigger(t,e,this)}))},triggerHandler:function(t,e){var n=this[0];if(n)return w.event.trigger(t,e,n,!0)}}),p.focusin||w.each({focus:"focusin",blur:"focusout"},(function(t,e){var n=function(t){w.event.simulate(e,t.target,w.event.fix(t))};w.event.special[e]={setup:function(){var o=this.ownerDocument||this.document||this,r=Z.access(o,e);r||o.addEventListener(t,n,!0),Z.access(o,e,(r||0)+1)},teardown:function(){var o=this.ownerDocument||this.document||this,r=Z.access(o,e)-1;r?Z.access(o,e,r):(o.removeEventListener(t,n,!0),Z.remove(o,e))}}})),w.parseXML=function(e){var n;if(!e||"string"!=typeof e)return null;try{n=(new t.DOMParser).parseFromString(e,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+e),n};var fe,he=/\[\]$/,pe=/\r?\n/g,de=/^(?:submit|button|image|reset|file)$/i,ge=/^(?:input|select|textarea|keygen)/i;function me(t,e,n,o){var r;if(Array.isArray(e))w.each(e,(function(e,r){n||he.test(t)?o(t,r):me(t+"["+("object"==typeof r&&null!=r?e:"")+"]",r,n,o)}));else if(n||"object"!==C(e))o(t,e);else for(r in e)me(t+"["+r+"]",e[r],n,o)}w.param=function(t,e){var n,o=[],r=function(t,e){var n=d(e)?e():e;o[o.length]=encodeURIComponent(t)+"="+encodeURIComponent(null==n?"":n)};if(null==t)return"";if(Array.isArray(t)||t.jquery&&!w.isPlainObject(t))w.each(t,(function(){r(this.name,this.value)}));else for(n in t)me(n,t[n],e,r);return o.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var t=w.prop(this,"elements");return t?w.makeArray(t):this})).filter((function(){var t=this.type;return this.name&&!w(this).is(":disabled")&&ge.test(this.nodeName)&&!de.test(t)&&(this.checked||!ft.test(t))})).map((function(t,e){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,(function(t){return{name:e.name,value:t.replace(pe,"\r\n")}})):{name:e.name,value:n.replace(pe,"\r\n")}})).get()}}),w.fn.extend({wrapAll:function(t){var e;return this[0]&&(d(t)&&(t=t.call(this[0])),e=w(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map((function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t})).append(this)),this},wrapInner:function(t){return d(t)?this.each((function(e){w(this).wrapInner(t.call(this,e))})):this.each((function(){var e=w(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)}))},wrap:function(t){var e=d(t);return this.each((function(n){w(this).wrapAll(e?t.call(this,n):t)}))},unwrap:function(t){return this.parent(t).not("body").each((function(){w(this).replaceWith(this.childNodes)})),this}}),w.expr.pseudos.hidden=function(t){return!w.expr.pseudos.visible(t)},w.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)},p.createHTMLDocument=((fe=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===fe.childNodes.length),w.parseHTML=function(t,e,n){return"string"!=typeof t?[]:("boolean"==typeof e&&(n=e,e=!1),e||(p.createHTMLDocument?((o=(e=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,e.head.appendChild(o)):e=m),i=!n&&[],(r=k.exec(t))?[e.createElement(r[1])]:(r=vt([t],e,i),i&&i.length&&w(i).remove(),w.merge([],r.childNodes)));var o,r,i},w.offset={setOffset:function(t,e,n){var o,r,i,a,s,l,u=w.css(t,"position"),c=w(t),f={};"static"===u&&(t.style.position="relative"),s=c.offset(),i=w.css(t,"top"),l=w.css(t,"left"),("absolute"===u||"fixed"===u)&&-1<(i+l).indexOf("auto")?(a=(o=c.position()).top,r=o.left):(a=parseFloat(i)||0,r=parseFloat(l)||0),d(e)&&(e=e.call(t,n,w.extend({},s))),null!=e.top&&(f.top=e.top-s.top+a),null!=e.left&&(f.left=e.left-s.left+r),"using"in e?e.using.call(t,f):("number"==typeof f.top&&(f.top+="px"),"number"==typeof f.left&&(f.left+="px"),c.css(f))}},w.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each((function(e){w.offset.setOffset(this,t,e)}));var e,n,o=this[0];return o?o.getClientRects().length?(e=o.getBoundingClientRect(),n=o.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var t,e,n,o=this[0],r={top:0,left:0};if("fixed"===w.css(o,"position"))e=o.getBoundingClientRect();else{for(e=this.offset(),n=o.ownerDocument,t=o.offsetParent||n.documentElement;t&&(t===n.body||t===n.documentElement)&&"static"===w.css(t,"position");)t=t.parentNode;t&&t!==o&&1===t.nodeType&&((r=w(t).offset()).top+=w.css(t,"borderTopWidth",!0),r.left+=w.css(t,"borderLeftWidth",!0))}return{top:e.top-r.top-w.css(o,"marginTop",!0),left:e.left-r.left-w.css(o,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var t=this.offsetParent;t&&"static"===w.css(t,"position");)t=t.offsetParent;return t||ot}))}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,e){var n="pageYOffset"===e;w.fn[t]=function(o){return V(this,(function(t,o,r){var i;if(g(t)?i=t:9===t.nodeType&&(i=t.defaultView),void 0===r)return i?i[e]:t[o];i?i.scrollTo(n?i.pageXOffset:r,n?r:i.pageYOffset):t[o]=r}),t,o,arguments.length)}})),w.each(["top","left"],(function(t,e){w.cssHooks[e]=Ht(p.pixelPosition,(function(t,n){if(n)return n=Gt(t,e),Pt.test(n)?w(t).position()[e]+"px":n}))})),w.each({Height:"height",Width:"width"},(function(t,e){w.each({padding:"inner"+t,content:e,"":"outer"+t},(function(n,o){w.fn[o]=function(r,i){var a=arguments.length&&(n||"boolean"!=typeof r),s=n||(!0===r||!0===i?"margin":"border");return V(this,(function(e,n,r){var i;return g(e)?0===o.indexOf("outer")?e["inner"+t]:e.document.documentElement["client"+t]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+t],i["scroll"+t],e.body["offset"+t],i["offset"+t],i["client"+t])):void 0===r?w.css(e,n,s):w.style(e,n,r,s)}),e,a?r:void 0,a)}}))})),w.fn.extend({bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,o){return this.on(e,t,n,o)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),(function(t,e){w.fn[e]=function(t,n){return 0<arguments.length?this.on(e,null,t,n):this.trigger(e)}}));var ye=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(t,e){var n,o,i;if("string"==typeof e&&(n=t[e],e=t,t=n),d(t))return o=r.call(arguments,2),(i=function(){return t.apply(e||this,o.concat(r.call(arguments)))}).guid=t.guid=t.guid||w.guid++,i},w.holdReady=function(t){t?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=R,w.isFunction=d,w.isWindow=g,w.camelCase=q,w.type=C,w.now=Date.now,w.isNumeric=function(t){var e=w.type(t);return("number"===e||"string"===e)&&!isNaN(t-parseFloat(t))},w.trim=function(t){return null==t?"":(t+"").replace(ye,"")},"function"==typeof define&&define.amd&&define("jquery",[],(function(){return w}));var ve=t.jQuery,Ce=t.$;return w.noConflict=function(e){return t.$===w&&(t.$=Ce),e&&t.jQuery===w&&(t.jQuery=ve),w},void 0===e&&(t.jQuery=t.$=w),w})),function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.Tether=e()}(this,(function(){"use strict";function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t){var n=t.getBoundingClientRect(),o={};for(var r in n)o[r]=n[r];try{if(t.ownerDocument!==document){var i=t.ownerDocument.defaultView.frameElement;if(i){var a=e(i);o.top+=a.top,o.bottom+=a.top,o.left+=a.left,o.right+=a.left}}}catch(s){}return o}function n(t){var e=(getComputedStyle(t)||{}).position,n=[];if("fixed"===e)return[t];for(var o=t;(o=o.parentNode)&&o&&1===o.nodeType;){var r=void 0;try{r=getComputedStyle(o)}catch(a){}if(null==r)return n.push(o),n;var i=r,s=i.overflow,l=i.overflowX,u=i.overflowY;/(auto|scroll|overlay)/.test(s+u+l)&&("absolute"!==e||["relative","absolute","fixed"].indexOf(r.position)>=0)&&n.push(o)}return n.push(t.ownerDocument.body),t.ownerDocument!==document&&n.push(t.ownerDocument.defaultView),n}function o(){w&&document.body.removeChild(w),w=null}function r(t){var n=void 0;t===document?(n=document,t=document.documentElement):n=t.ownerDocument;var o=n.documentElement,r=e(t),i=S();return r.top-=i.top,r.left-=i.left,void 0===r.width&&(r.width=document.body.scrollWidth-r.left-r.right),void 0===r.height&&(r.height=document.body.scrollHeight-r.top-r.bottom),r.top=r.top-o.clientTop,r.left=r.left-o.clientLeft,r.right=n.body.clientWidth-r.width-r.left,r.bottom=n.body.clientHeight-r.height-r.top,r}function i(t){return t.offsetParent||document.documentElement}function a(){if(A)return A;var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div");s(e.style,{position:"absolute",top:0,left:0,pointerEvents:"none",visibility:"hidden",width:"200px",height:"150px",overflow:"hidden"}),e.appendChild(t),document.body.appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var o=t.offsetWidth;n===o&&(o=e.clientWidth),document.body.removeChild(e);var r=n-o;return A={width:r,height:r}}function s(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=[];return Array.prototype.push.apply(e,arguments),e.slice(1).forEach((function(e){if(e)for(var n in e)({}).hasOwnProperty.call(e,n)&&(t[n]=e[n])})),t}function l(t,e){if(void 0!==t.classList)e.split(" ").forEach((function(e){e.trim()&&t.classList.remove(e)}));else{var n=new RegExp("(^| )"+e.split(" ").join("|")+"( |$)","gi"),o=f(t).replace(n," ");h(t,o)}}function u(t,e){if(void 0!==t.classList)e.split(" ").forEach((function(e){e.trim()&&t.classList.add(e)}));else{l(t,e);var n=f(t)+" "+e;h(t,n)}}function c(t,e){if(void 0!==t.classList)return t.classList.contains(e);var n=f(t);return new RegExp("(^| )"+e+"( |$)","gi").test(n)}function f(t){return t.className instanceof t.ownerDocument.defaultView.SVGAnimatedString?t.className.baseVal:t.className}function h(t,e){t.setAttribute("class",e)}function p(t,e,n){n.forEach((function(n){-1===e.indexOf(n)&&c(t,n)&&l(t,n)})),e.forEach((function(e){c(t,e)||u(t,e)}))}function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){var n=arguments.length<=2||void 0===arguments[2]?1:arguments[2];return t+n>=e&&e>=t-n}function g(){return"object"==typeof performance&&"function"==typeof performance.now?performance.now():+new Date}function m(){for(var t={top:0,left:0},e=arguments.length,n=Array(e),o=0;o<e;o++)n[o]=arguments[o];return n.forEach((function(e){var n=e.top,o=e.left;"string"==typeof n&&(n=parseFloat(n,10)),"string"==typeof o&&(o=parseFloat(o,10)),t.top+=n,t.left+=o})),t}function y(t,e){return"string"==typeof t.left&&-1!==t.left.indexOf("%")&&(t.left=parseFloat(t.left,10)/100*e.width),"string"==typeof t.top&&-1!==t.top.indexOf("%")&&(t.top=parseFloat(t.top,10)/100*e.height),t}function v(t,e){return"scrollParent"===e?e=t.scrollParents[0]:"window"===e&&(e=[pageXOffset,pageYOffset,innerWidth+pageXOffset,innerHeight+pageYOffset]),e===document&&(e=e.documentElement),void 0!==e.nodeType&&function(){var t=e,n=r(e),o=n,i=getComputedStyle(e);if(e=[o.left,o.top,n.width+o.left,n.height+o.top],t.ownerDocument!==document){var a=t.ownerDocument.defaultView;e[0]+=a.pageXOffset,e[1]+=a.pageYOffset,e[2]+=a.pageXOffset,e[3]+=a.pageYOffset}z.forEach((function(t,n){"Top"===(t=t[0].toUpperCase()+t.substr(1))||"Left"===t?e[n]+=parseFloat(i["border"+t+"Width"]):e[n]-=parseFloat(i["border"+t+"Width"])}))}(),e}var C=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),b=void 0;void 0===b&&(b={modules:[]});var w=null,T=function(){var t=0;return function(){return++t}}(),x={},S=function(){var t=w;t&&document.body.contains(t)||((t=document.createElement("div")).setAttribute("data-tether-id",T()),s(t.style,{top:0,left:0,position:"absolute"}),document.body.appendChild(t),w=t);var n=t.getAttribute("data-tether-id");return void 0===x[n]&&(x[n]=e(t),R((function(){delete x[n]}))),x[n]},A=null,I=[],R=function(t){I.push(t)},k=function(){for(var t=void 0;t=I.pop();)t()},M=function(){function e(){t(this,e)}return C(e,[{key:"on",value:function(t,e,n){var o=!(arguments.length<=3||void 0===arguments[3])&&arguments[3];void 0===this.bindings&&(this.bindings={}),void 0===this.bindings[t]&&(this.bindings[t]=[]),this.bindings[t].push({handler:e,ctx:n,once:o})}},{key:"once",value:function(t,e,n){this.on(t,e,n,!0)}},{key:"off",value:function(t,e){if(void 0!==this.bindings&&void 0!==this.bindings[t])if(void 0===e)delete this.bindings[t];else for(var n=0;n<this.bindings[t].length;)this.bindings[t][n].handler===e?this.bindings[t].splice(n,1):++n}},{key:"trigger",value:function(t){if(void 0!==this.bindings&&this.bindings[t]){for(var e=0,n=arguments.length,o=Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];for(;e<this.bindings[t].length;){var i=this.bindings[t][e],a=i.handler,s=i.ctx,l=i.once,u=s;void 0===u&&(u=this),a.apply(u,o),l?this.bindings[t].splice(e,1):++e}}}}]),e}();b.Utils={getActualBoundingClientRect:e,getScrollParents:n,getBounds:r,getOffsetParent:i,extend:s,addClass:u,removeClass:l,hasClass:c,updateClasses:p,defer:R,flush:k,uniqueId:T,Evented:M,getScrollBarSize:a,removeUtilElements:o};var N=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(l){r=!0,i=l}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};C=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}();if(void 0===b)throw new Error("You must include the utils.js file before tether.js");var n=(W=b.Utils).getScrollParents,i=(r=W.getBounds,W.getOffsetParent),u=(s=W.extend,W.addClass),l=W.removeClass,a=(p=W.updateClasses,R=W.defer,k=W.flush,W.getScrollBarSize),o=W.removeUtilElements,E=function(){if("undefined"==typeof document)return"";for(var t=document.createElement("div"),e=["transform","WebkitTransform","OTransform","MozTransform","msTransform"],n=0;n<e.length;++n){var o=e[n];if(void 0!==t.style[o])return o}}(),D=[],O=function(){D.forEach((function(t){t.position(!1)})),k()};!function(){var t=null,e=null,n=null,o=function o(){return void 0!==e&&e>16?(e=Math.min(e-16,250),void(n=setTimeout(o,250))):void(void 0!==t&&g()-t<10||(null!=n&&(clearTimeout(n),n=null),t=g(),O(),e=g()-t))};"undefined"!=typeof window&&void 0!==window.addEventListener&&["resize","scroll","touchmove"].forEach((function(t){window.addEventListener(t,o)}))}();var j={center:"center",left:"right",right:"left"},F={middle:"middle",top:"bottom",bottom:"top"},P={top:0,left:0,middle:"50%",center:"50%",bottom:"100%",right:"100%"},_=function(t,e){var n=t.left,o=t.top;return"auto"===n&&(n=j[e.left]),"auto"===o&&(o=F[e.top]),{left:n,top:o}},L=function(t){var e=t.left,n=t.top;return void 0!==P[t.left]&&(e=P[t.left]),void 0!==P[t.top]&&(n=P[t.top]),{left:e,top:n}},B=function(t){var e=t.split(" "),n=N(e,2);return{top:n[0],left:n[1]}},G=B,H=function(e){function c(e){var n=this;t(this,c),function(t,e,n){for(var o=!0;o;){var r=t,i=e,a=n;o=!1,null===r&&(r=Function.prototype);var s=Object.getOwnPropertyDescriptor(r,i);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(a)}var u=Object.getPrototypeOf(r);if(null===u)return;t=u,e=i,n=a,o=!0,s=u=void 0}}(Object.getPrototypeOf(c.prototype),"constructor",this).call(this),this.position=this.position.bind(this),D.push(this),this.history=[],this.setOptions(e,!1),b.modules.forEach((function(t){void 0!==t.initialize&&t.initialize.call(n)})),this.position()}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(c,e),C(c,[{key:"getClass",value:function(){var t=arguments.length<=0||void 0===arguments[0]?"":arguments[0],e=this.options.classes;return void 0!==e&&e[t]?this.options.classes[t]:this.options.classPrefix?this.options.classPrefix+"-"+t:t}},{key:"setOptions",value:function(t){var e=this,o=arguments.length<=1||void 0===arguments[1]||arguments[1],r={offset:"0 0",targetOffset:"0 0",targetAttachment:"auto auto",classPrefix:"tether"};this.options=s(r,t);var i=this.options,a=i.element,l=i.target,c=i.targetModifier;if(this.element=a,this.target=l,this.targetModifier=c,"viewport"===this.target?(this.target=document.body,this.targetModifier="visible"):"scroll-handle"===this.target&&(this.target=document.body,this.targetModifier="scroll-handle"),["element","target"].forEach((function(t){if(void 0===e[t])throw new Error("Tether Error: Both element and target must be defined");void 0!==e[t].jquery?e[t]=e[t][0]:"string"==typeof e[t]&&(e[t]=document.querySelector(e[t]))})),u(this.element,this.getClass("element")),!1!==this.options.addTargetClasses&&u(this.target,this.getClass("target")),!this.options.attachment)throw new Error("Tether Error: You must provide an attachment");this.targetAttachment=G(this.options.targetAttachment),this.attachment=G(this.options.attachment),this.offset=B(this.options.offset),this.targetOffset=B(this.options.targetOffset),void 0!==this.scrollParents&&this.disable(),"scroll-handle"===this.targetModifier?this.scrollParents=[this.target]:this.scrollParents=n(this.target),!1!==this.options.enabled&&this.enable(o)}},{key:"getTargetBounds",value:function(){if(void 0===this.targetModifier)return r(this.target);if("visible"===this.targetModifier)return this.target===document.body?{top:pageYOffset,left:pageXOffset,height:innerHeight,width:innerWidth}:((a={height:(t=r(this.target)).height,width:t.width,top:t.top,left:t.left}).height=Math.min(a.height,t.height-(pageYOffset-t.top)),a.height=Math.min(a.height,t.height-(t.top+t.height-(pageYOffset+innerHeight))),a.height=Math.min(innerHeight,a.height),a.height-=2,a.width=Math.min(a.width,t.width-(pageXOffset-t.left)),a.width=Math.min(a.width,t.width-(t.left+t.width-(pageXOffset+innerWidth))),a.width=Math.min(innerWidth,a.width),a.width-=2,a.top<pageYOffset&&(a.top=pageYOffset),a.left<pageXOffset&&(a.left=pageXOffset),a);if("scroll-handle"===this.targetModifier){var t=void 0,e=this.target;e===document.body?(e=document.documentElement,t={left:pageXOffset,top:pageYOffset,height:innerHeight,width:innerWidth}):t=r(e);var n=getComputedStyle(e),o=0;(e.scrollWidth>e.clientWidth||[n.overflow,n.overflowX].indexOf("scroll")>=0||this.target!==document.body)&&(o=15);var i=t.height-parseFloat(n.borderTopWidth)-parseFloat(n.borderBottomWidth)-o,a={width:15,height:.975*i*(i/e.scrollHeight),left:t.left+t.width-parseFloat(n.borderLeftWidth)-15},s=0;i<408&&this.target===document.body&&(s=-11e-5*Math.pow(i,2)-.00727*i+22.58),this.target!==document.body&&(a.height=Math.max(a.height,24));var l=this.target.scrollTop/(e.scrollHeight-i);return a.top=l*(i-a.height-s)+t.top+parseFloat(n.borderTopWidth),this.target===document.body&&(a.height=Math.max(a.height,24)),a}}},{key:"clearCache",value:function(){this._cache={}}},{key:"cache",value:function(t,e){return void 0===this._cache&&(this._cache={}),void 0===this._cache[t]&&(this._cache[t]=e.call(this)),this._cache[t]}},{key:"enable",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]||arguments[0];!1!==this.options.addTargetClasses&&u(this.target,this.getClass("enabled")),u(this.element,this.getClass("enabled")),this.enabled=!0,this.scrollParents.forEach((function(e){e!==t.target.ownerDocument&&e.addEventListener("scroll",t.position)})),e&&this.position()}},{key:"disable",value:function(){var t=this;l(this.target,this.getClass("enabled")),l(this.element,this.getClass("enabled")),this.enabled=!1,void 0!==this.scrollParents&&this.scrollParents.forEach((function(e){e.removeEventListener("scroll",t.position)}))}},{key:"destroy",value:function(){var t=this;this.disable(),D.forEach((function(e,n){e===t&&D.splice(n,1)})),0===D.length&&o()}},{key:"updateAttachClasses",value:function(t,e){var n=this;t=t||this.attachment,e=e||this.targetAttachment;void 0!==this._addAttachClasses&&this._addAttachClasses.length&&this._addAttachClasses.splice(0,this._addAttachClasses.length),void 0===this._addAttachClasses&&(this._addAttachClasses=[]);var o=this._addAttachClasses;t.top&&o.push(this.getClass("element-attached")+"-"+t.top),t.left&&o.push(this.getClass("element-attached")+"-"+t.left),e.top&&o.push(this.getClass("target-attached")+"-"+e.top),e.left&&o.push(this.getClass("target-attached")+"-"+e.left);var r=[];["left","top","bottom","right","middle","center"].forEach((function(t){r.push(n.getClass("element-attached")+"-"+t),r.push(n.getClass("target-attached")+"-"+t)})),R((function(){void 0!==n._addAttachClasses&&(p(n.element,n._addAttachClasses,r),!1!==n.options.addTargetClasses&&p(n.target,n._addAttachClasses,r),delete n._addAttachClasses)}))}},{key:"position",value:function(){var t=this,e=arguments.length<=0||void 0===arguments[0]||arguments[0];if(this.enabled){this.clearCache();var n=_(this.targetAttachment,this.attachment);this.updateAttachClasses(this.attachment,n);var o=this.cache("element-bounds",(function(){return r(t.element)})),s=o.width,l=o.height;if(0===s&&0===l&&void 0!==this.lastSize){var u=this.lastSize;s=u.width,l=u.height}else this.lastSize={width:s,height:l};var c=this.cache("target-bounds",(function(){return t.getTargetBounds()})),f=c,h=y(L(this.attachment),{width:s,height:l}),p=y(L(n),f),d=y(this.offset,{width:s,height:l}),g=y(this.targetOffset,f);h=m(h,d),p=m(p,g);for(var v=c.left+p.left-h.left,C=c.top+p.top-h.top,w=0;w<b.modules.length;++w){var T=b.modules[w],x=T.position.call(this,{left:v,top:C,targetAttachment:n,targetPos:c,elementPos:o,offset:h,targetOffset:p,manualOffset:d,manualTargetOffset:g,scrollbarSize:R,attachment:this.attachment});if(!1===x)return!1;void 0!==x&&"object"==typeof x&&(C=x.top,v=x.left)}var S={page:{top:C,left:v},viewport:{top:C-pageYOffset,bottom:pageYOffset-C-l+innerHeight,left:v-pageXOffset,right:pageXOffset-v-s+innerWidth}},A=this.target.ownerDocument,I=A.defaultView,R=void 0;return I.innerHeight>A.documentElement.clientHeight&&(R=this.cache("scrollbar-size",a),S.viewport.bottom-=R.height),I.innerWidth>A.documentElement.clientWidth&&(R=this.cache("scrollbar-size",a),S.viewport.right-=R.width),-1!==["","static"].indexOf(A.body.style.position)&&-1!==["","static"].indexOf(A.body.parentElement.style.position)||(S.page.bottom=A.body.scrollHeight-C-l,S.page.right=A.body.scrollWidth-v-s),void 0!==this.options.optimizations&&!1!==this.options.optimizations.moveElement&&void 0===this.targetModifier&&function(){var e=t.cache("target-offsetparent",(function(){return i(t.target)})),n=t.cache("target-offsetparent-bounds",(function(){return r(e)})),o=getComputedStyle(e),a=n,s={};if(["Top","Left","Bottom","Right"].forEach((function(t){s[t.toLowerCase()]=parseFloat(o["border"+t+"Width"])})),n.right=A.body.scrollWidth-n.left-a.width+s.right,n.bottom=A.body.scrollHeight-n.top-a.height+s.bottom,S.page.top>=n.top+s.top&&S.page.bottom>=n.bottom&&S.page.left>=n.left+s.left&&S.page.right>=n.right){var l=e.scrollTop,u=e.scrollLeft;S.offset={top:S.page.top-n.top+l-s.top,left:S.page.left-n.left+u-s.left}}}(),this.move(S),this.history.unshift(S),this.history.length>3&&this.history.pop(),e&&k(),!0}}},{key:"move",value:function(t){var e=this;if(void 0!==this.element.parentNode){var n={};for(var o in t)for(var r in n[o]={},t[o]){for(var a=!1,l=0;l<this.history.length;++l){var u=this.history[l];if(void 0!==u[o]&&!d(u[o][r],t[o][r])){a=!0;break}}a||(n[o][r]=!0)}var c={top:"",left:"",right:"",bottom:""},f=function(t,n){if(!1!==(void 0!==e.options.optimizations?e.options.optimizations.gpu:null)){var o=void 0,r=void 0;t.top?(c.top=0,o=n.top):(c.bottom=0,o=-n.bottom),t.left?(c.left=0,r=n.left):(c.right=0,r=-n.right),"number"==typeof window.devicePixelRatio&&devicePixelRatio%1==0&&(r=Math.round(r*devicePixelRatio)/devicePixelRatio,o=Math.round(o*devicePixelRatio)/devicePixelRatio),c[E]="translateX("+r+"px) translateY("+o+"px)","msTransform"!==E&&(c[E]+=" translateZ(0)")}else t.top?c.top=n.top+"px":c.bottom=n.bottom+"px",t.left?c.left=n.left+"px":c.right=n.right+"px"},h=!1;if((n.page.top||n.page.bottom)&&(n.page.left||n.page.right)?(c.position="absolute",f(n.page,t.page)):(n.viewport.top||n.viewport.bottom)&&(n.viewport.left||n.viewport.right)?(c.position="fixed",f(n.viewport,t.viewport)):void 0!==n.offset&&n.offset.top&&n.offset.left?function(){c.position="absolute";var o=e.cache("target-offsetparent",(function(){return i(e.target)}));i(e.element)!==o&&R((function(){e.element.parentNode.removeChild(e.element),o.appendChild(e.element)})),f(n.offset,t.offset),h=!0}():(c.position="absolute",f({top:!0,left:!0},t.page)),!h)if(this.options.bodyElement)this.element.parentNode!==this.options.bodyElement&&this.options.bodyElement.appendChild(this.element);else{for(var p=function(t){var e=t.ownerDocument;return(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement||e.msFullscreenElement)===t},g=!0,m=this.element.parentNode;m&&1===m.nodeType&&"BODY"!==m.tagName&&!p(m);){if("static"!==getComputedStyle(m).position){g=!1;break}m=m.parentNode}g||(this.element.parentNode.removeChild(this.element),this.element.ownerDocument.body.appendChild(this.element))}var y={},v=!1;for(var r in c){var C=c[r];this.element.style[r]!==C&&(v=!0,y[r]=C)}v&&R((function(){s(e.element.style,y),e.trigger("repositioned")}))}}}]),c}(M);H.modules=[],b.position=O;var V=s(H,b),s=(N=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(l){r=!0,i=l}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},r=(W=b.Utils).getBounds,W.extend),z=(p=W.updateClasses,R=W.defer,["left","top","right","bottom"]);b.modules.push({position:function(t){var e=this,n=t.top,o=t.left,i=t.targetAttachment;if(!this.options.constraints)return!0;var a=this.cache("element-bounds",(function(){return r(e.element)})),l=a.height,u=a.width;if(0===u&&0===l&&void 0!==this.lastSize){var c=this.lastSize;u=c.width,l=c.height}var f=this.cache("target-bounds",(function(){return e.getTargetBounds()})),h=f.height,d=f.width,g=[this.getClass("pinned"),this.getClass("out-of-bounds")];this.options.constraints.forEach((function(t){var e=t.outOfBoundsClass,n=t.pinnedClass;e&&g.push(e),n&&g.push(n)})),g.forEach((function(t){["left","top","right","bottom"].forEach((function(e){g.push(t+"-"+e)}))}));var m=[],y=s({},i),C=s({},this.attachment);return this.options.constraints.forEach((function(t){var r=t.to,a=t.attachment,s=t.pin;void 0===a&&(a="");var c=void 0,f=void 0;if(a.indexOf(" ")>=0){var p=a.split(" "),g=N(p,2);f=g[0],c=g[1]}else c=f=a;var b=v(e,r);"target"!==f&&"both"!==f||(n<b[1]&&"top"===y.top&&(n+=h,y.top="bottom"),n+l>b[3]&&"bottom"===y.top&&(n-=h,y.top="top")),"together"===f&&("top"===y.top&&("bottom"===C.top&&n<b[1]?(n+=h,y.top="bottom",n+=l,C.top="top"):"top"===C.top&&n+l>b[3]&&n-(l-h)>=b[1]&&(n-=l-h,y.top="bottom",C.top="bottom")),"bottom"===y.top&&("top"===C.top&&n+l>b[3]?(n-=h,y.top="top",n-=l,C.top="bottom"):"bottom"===C.top&&n<b[1]&&n+(2*l-h)<=b[3]&&(n+=l-h,y.top="top",C.top="top")),"middle"===y.top&&(n+l>b[3]&&"top"===C.top?(n-=l,C.top="bottom"):n<b[1]&&"bottom"===C.top&&(n+=l,C.top="top"))),"target"!==c&&"both"!==c||(o<b[0]&&"left"===y.left&&(o+=d,y.left="right"),o+u>b[2]&&"right"===y.left&&(o-=d,y.left="left")),"together"===c&&(o<b[0]&&"left"===y.left?"right"===C.left?(o+=d,y.left="right",o+=u,C.left="left"):"left"===C.left&&(o+=d,y.left="right",o-=u,C.left="right"):o+u>b[2]&&"right"===y.left?"left"===C.left?(o-=d,y.left="left",o-=u,C.left="right"):"right"===C.left&&(o-=d,y.left="left",o+=u,C.left="left"):"center"===y.left&&(o+u>b[2]&&"left"===C.left?(o-=u,C.left="right"):o<b[0]&&"right"===C.left&&(o+=u,C.left="left"))),"element"!==f&&"both"!==f||(n<b[1]&&"bottom"===C.top&&(n+=l,C.top="top"),n+l>b[3]&&"top"===C.top&&(n-=l,C.top="bottom")),"element"!==c&&"both"!==c||(o<b[0]&&("right"===C.left?(o+=u,C.left="left"):"center"===C.left&&(o+=u/2,C.left="left")),o+u>b[2]&&("left"===C.left?(o-=u,C.left="right"):"center"===C.left&&(o-=u/2,C.left="right"))),"string"==typeof s?s=s.split(",").map((function(t){return t.trim()})):!0===s&&(s=["top","left","right","bottom"]),s=s||[];var w=[],T=[];n<b[1]&&(s.indexOf("top")>=0?(n=b[1],w.push("top")):T.push("top")),n+l>b[3]&&(s.indexOf("bottom")>=0?(n=b[3]-l,w.push("bottom")):T.push("bottom")),o<b[0]&&(s.indexOf("left")>=0?(o=b[0],w.push("left")):T.push("left")),o+u>b[2]&&(s.indexOf("right")>=0?(o=b[2]-u,w.push("right")):T.push("right")),w.length&&function(){var t;t=void 0!==e.options.pinnedClass?e.options.pinnedClass:e.getClass("pinned"),m.push(t),w.forEach((function(e){m.push(t+"-"+e)}))}(),T.length&&function(){var t;t=void 0!==e.options.outOfBoundsClass?e.options.outOfBoundsClass:e.getClass("out-of-bounds"),m.push(t),T.forEach((function(e){m.push(t+"-"+e)}))}(),(w.indexOf("left")>=0||w.indexOf("right")>=0)&&(C.left=y.left=!1),(w.indexOf("top")>=0||w.indexOf("bottom")>=0)&&(C.top=y.top=!1),y.top===i.top&&y.left===i.left&&C.top===e.attachment.top&&C.left===e.attachment.left||(e.updateAttachClasses(C,y),e.trigger("update",{attachment:C,targetAttachment:y}))})),R((function(){!1!==e.options.addTargetClasses&&p(e.target,m,g),p(e.element,m,g)})),{top:n,left:o}}});var W,r=(W=b.Utils).getBounds,p=W.updateClasses;R=W.defer;b.modules.push({position:function(t){var e=this,n=t.top,o=t.left,i=this.cache("element-bounds",(function(){return r(e.element)})),a=i.height,s=i.width,l=this.getTargetBounds(),u=n+a,c=o+s,f=[];n<=l.bottom&&u>=l.top&&["left","right"].forEach((function(t){var e=l[t];e!==o&&e!==c||f.push(t)})),o<=l.right&&c>=l.left&&["top","bottom"].forEach((function(t){var e=l[t];e!==n&&e!==u||f.push(t)}));var h=[],d=[];return h.push(this.getClass("abutted")),["left","top","right","bottom"].forEach((function(t){h.push(e.getClass("abutted")+"-"+t)})),f.length&&d.push(this.getClass("abutted")),f.forEach((function(t){d.push(e.getClass("abutted")+"-"+t)})),R((function(){!1!==e.options.addTargetClasses&&p(e.target,d,h),p(e.element,d,h)})),!0}});N=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],o=!0,r=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(o=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);o=!0);}catch(l){r=!0,i=l}finally{try{!o&&s.return&&s.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};return b.modules.push({position:function(t){var e=t.top,n=t.left;if(this.options.shift){var o=this.options.shift;"function"==typeof this.options.shift&&(o=this.options.shift.call(this,{top:e,left:n}));var r=void 0,i=void 0;if("string"==typeof o){(o=o.split(" "))[1]=o[1]||o[0];var a=N(o,2);r=a[0],i=a[1],r=parseFloat(r,10),i=parseFloat(i,10)}else r=o.top,i=o.left;return{top:e+=r,left:n+=i}}}}),V})),function t(e,n,o){function r(a,s){if(!n[a]){if(!e[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(i)return i(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[a]={exports:{}};e[a][0].call(c.exports,(function(t){var n=e[a][1][t];return r(n||t)}),c,c.exports,t,e,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(t,e,n){"use strict";function o(t){t.fn.perfectScrollbar=function(t){return this.each((function(){if("object"==typeof t||void 0===t){var e=t;i.get(this)||r.initialize(this,e)}else{var n=t;"update"===n?r.update(this):"destroy"===n&&r.destroy(this)}}))}}var r=t("../main"),i=t("../plugin/instances");if("function"==typeof define&&define.amd)define(["jquery"],o);else{var a=window.jQuery?window.jQuery:window.$;void 0!==a&&o(a)}e.exports=o},{"../main":7,"../plugin/instances":18}],2:[function(t,e,n){"use strict";n.add=function(t,e){t.classList?t.classList.add(e):function(t,e){var n=t.className.split(" ");n.indexOf(e)<0&&n.push(e),t.className=n.join(" ")}(t,e)},n.remove=function(t,e){t.classList?t.classList.remove(e):function(t,e){var n=t.className.split(" "),o=n.indexOf(e);o>=0&&n.splice(o,1),t.className=n.join(" ")}(t,e)},n.list=function(t){return t.classList?Array.prototype.slice.apply(t.classList):t.className.split(" ")}},{}],3:[function(t,e,n){"use strict";var o={e:function(t,e){var n=document.createElement(t);return n.className=e,n},appendTo:function(t,e){return e.appendChild(t),t}};o.css=function(t,e,n){return"object"==typeof e?function(t,e){for(var n in e){var o=e[n];"number"==typeof o&&(o=o.toString()+"px"),t.style[n]=o}return t}(t,e):void 0===n?function(t,e){return window.getComputedStyle(t)[e]}(t,e):function(t,e,n){return"number"==typeof n&&(n=n.toString()+"px"),t.style[e]=n,t}(t,e,n)},o.matches=function(t,e){return void 0!==t.matches?t.matches(e):void 0!==t.matchesSelector?t.matchesSelector(e):void 0!==t.webkitMatchesSelector?t.webkitMatchesSelector(e):void 0!==t.mozMatchesSelector?t.mozMatchesSelector(e):void 0!==t.msMatchesSelector?t.msMatchesSelector(e):void 0},o.remove=function(t){void 0!==t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)},o.queryChildren=function(t,e){return Array.prototype.filter.call(t.childNodes,(function(t){return o.matches(t,e)}))},e.exports=o},{}],4:[function(t,e,n){"use strict";var o=function(t){this.element=t,this.events={}};o.prototype.bind=function(t,e){void 0===this.events[t]&&(this.events[t]=[]),this.events[t].push(e),this.element.addEventListener(t,e,!1)},o.prototype.unbind=function(t,e){var n=void 0!==e;this.events[t]=this.events[t].filter((function(o){return!(!n||o===e)||(this.element.removeEventListener(t,o,!1),!1)}),this)},o.prototype.unbindAll=function(){for(var t in this.events)this.unbind(t)};var r=function(){this.eventElements=[]};r.prototype.eventElement=function(t){var e=this.eventElements.filter((function(e){return e.element===t}))[0];return void 0===e&&(e=new o(t),this.eventElements.push(e)),e},r.prototype.bind=function(t,e,n){this.eventElement(t).bind(e,n)},r.prototype.unbind=function(t,e,n){this.eventElement(t).unbind(e,n)},r.prototype.unbindAll=function(){for(var t=0;t<this.eventElements.length;t++)this.eventElements[t].unbindAll()},r.prototype.once=function(t,e,n){var o=this.eventElement(t),r=function(t){o.unbind(e,r),n(t)};o.bind(e,r)},e.exports=r},{}],5:[function(t,e,n){"use strict";e.exports=function(){function t(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return function(){return t()+t()+"-"+t()+"-"+t()+"-"+t()+"-"+t()+t()+t()}}()},{}],6:[function(t,e,n){"use strict";function o(t){return function(e,n){t(e,"ps--in-scrolling"),void 0!==n?t(e,"ps--"+n):(t(e,"ps--x"),t(e,"ps--y"))}}var r=t("./class"),i=t("./dom"),a=n.toInt=function(t){return parseInt(t,10)||0},s=n.clone=function(t){if(t){if(Array.isArray(t))return t.map(s);if("object"==typeof t){var e={};for(var n in t)e[n]=s(t[n]);return e}return t}return null};n.extend=function(t,e){var n=s(t);for(var o in e)n[o]=s(e[o]);return n},n.isEditable=function(t){return i.matches(t,"input,[contenteditable]")||i.matches(t,"select,[contenteditable]")||i.matches(t,"textarea,[contenteditable]")||i.matches(t,"button,[contenteditable]")},n.removePsClasses=function(t){for(var e=r.list(t),n=0;n<e.length;n++){var o=e[n];0===o.indexOf("ps-")&&r.remove(t,o)}},n.outerWidth=function(t){return a(i.css(t,"width"))+a(i.css(t,"paddingLeft"))+a(i.css(t,"paddingRight"))+a(i.css(t,"borderLeftWidth"))+a(i.css(t,"borderRightWidth"))},n.startScrolling=o(r.add),n.stopScrolling=o(r.remove),n.env={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof window&&("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:"undefined"!=typeof window&&null!==window.navigator.msMaxTouchPoints}},{"./class":2,"./dom":3}],7:[function(t,e,n){"use strict";var o=t("./plugin/destroy"),r=t("./plugin/initialize"),i=t("./plugin/update");e.exports={initialize:r,update:i,destroy:o}},{"./plugin/destroy":9,"./plugin/initialize":17,"./plugin/update":21}],8:[function(t,e,n){"use strict";e.exports={handlers:["click-rail","drag-scrollbar","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipePropagation:!0,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!1,wheelSpeed:1,theme:"default"}},{}],9:[function(t,e,n){"use strict";var o=t("../lib/helper"),r=t("../lib/dom"),i=t("./instances");e.exports=function(t){var e=i.get(t);e&&(e.event.unbindAll(),r.remove(e.scrollbarX),r.remove(e.scrollbarY),r.remove(e.scrollbarXRail),r.remove(e.scrollbarYRail),o.removePsClasses(t),i.remove(t))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18}],10:[function(t,e,n){"use strict";var o=t("../instances"),r=t("../update-geometry"),i=t("../update-scroll");e.exports=function(t){!function(t,e){function n(t){return t.getBoundingClientRect()}var o=function(t){t.stopPropagation()};e.event.bind(e.scrollbarY,"click",o),e.event.bind(e.scrollbarYRail,"click",(function(o){var a=o.pageY-window.pageYOffset-n(e.scrollbarYRail).top>e.scrollbarYTop?1:-1;i(t,"top",t.scrollTop+a*e.containerHeight),r(t),o.stopPropagation()})),e.event.bind(e.scrollbarX,"click",o),e.event.bind(e.scrollbarXRail,"click",(function(o){var a=o.pageX-window.pageXOffset-n(e.scrollbarXRail).left>e.scrollbarXLeft?1:-1;i(t,"left",t.scrollLeft+a*e.containerWidth),r(t),o.stopPropagation()}))}(t,o.get(t))}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],11:[function(t,e,n){"use strict";var o=t("../../lib/helper"),r=t("../../lib/dom"),i=t("../instances"),a=t("../update-geometry"),s=t("../update-scroll");e.exports=function(t){var e=i.get(t);(function(t,e){function n(n){var r=i+n*e.railXRatio,a=Math.max(0,e.scrollbarXRail.getBoundingClientRect().left)+e.railXRatio*(e.railXWidth-e.scrollbarXWidth);e.scrollbarXLeft=r<0?0:r>a?a:r;var l=o.toInt(e.scrollbarXLeft*(e.contentWidth-e.containerWidth)/(e.containerWidth-e.railXRatio*e.scrollbarXWidth))-e.negativeScrollAdjustment;s(t,"left",l)}var i=null,l=null,u=function(e){n(e.pageX-l),a(t),e.stopPropagation(),e.preventDefault()},c=function(){o.stopScrolling(t,"x"),e.event.unbind(e.ownerDocument,"mousemove",u)};e.event.bind(e.scrollbarX,"mousedown",(function(n){l=n.pageX,i=o.toInt(r.css(e.scrollbarX,"left"))*e.railXRatio,o.startScrolling(t,"x"),e.event.bind(e.ownerDocument,"mousemove",u),e.event.once(e.ownerDocument,"mouseup",c),n.stopPropagation(),n.preventDefault()}))})(t,e),function(t,e){function n(n){var r=i+n*e.railYRatio,a=Math.max(0,e.scrollbarYRail.getBoundingClientRect().top)+e.railYRatio*(e.railYHeight-e.scrollbarYHeight);e.scrollbarYTop=r<0?0:r>a?a:r;var l=o.toInt(e.scrollbarYTop*(e.contentHeight-e.containerHeight)/(e.containerHeight-e.railYRatio*e.scrollbarYHeight));s(t,"top",l)}var i=null,l=null,u=function(e){n(e.pageY-l),a(t),e.stopPropagation(),e.preventDefault()},c=function(){o.stopScrolling(t,"y"),e.event.unbind(e.ownerDocument,"mousemove",u)};e.event.bind(e.scrollbarY,"mousedown",(function(n){l=n.pageY,i=o.toInt(r.css(e.scrollbarY,"top"))*e.railYRatio,o.startScrolling(t,"y"),e.event.bind(e.ownerDocument,"mousemove",u),e.event.once(e.ownerDocument,"mouseup",c),n.stopPropagation(),n.preventDefault()}))}(t,e)}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],12:[function(t,e,n){"use strict";function o(t,e){var n=!1;e.event.bind(t,"mouseenter",(function(){n=!0})),e.event.bind(t,"mouseleave",(function(){n=!1}));e.event.bind(e.ownerDocument,"keydown",(function(o){if(!(o.isDefaultPrevented&&o.isDefaultPrevented()||o.defaultPrevented)){var a=i.matches(e.scrollbarX,":focus")||i.matches(e.scrollbarY,":focus");if(n||a){var u=document.activeElement?document.activeElement:e.ownerDocument.activeElement;if(u){if("IFRAME"===u.tagName)u=u.contentDocument.activeElement;else for(;u.shadowRoot;)u=u.shadowRoot.activeElement;if(r.isEditable(u))return}var c=0,f=0;switch(o.which){case 37:c=o.metaKey?-e.contentWidth:o.altKey?-e.containerWidth:-30;break;case 38:f=o.metaKey?e.contentHeight:o.altKey?e.containerHeight:30;break;case 39:c=o.metaKey?e.contentWidth:o.altKey?e.containerWidth:30;break;case 40:f=o.metaKey?-e.contentHeight:o.altKey?-e.containerHeight:-30;break;case 33:f=90;break;case 32:f=o.shiftKey?90:-90;break;case 34:f=-90;break;case 35:f=o.ctrlKey?-e.contentHeight:-e.containerHeight;break;case 36:f=o.ctrlKey?t.scrollTop:e.containerHeight;break;default:return}l(t,"top",t.scrollTop-f),l(t,"left",t.scrollLeft+c),s(t),function(n,o){var r=t.scrollTop;if(0===n){if(!e.scrollbarYActive)return!1;if(0===r&&o>0||r>=e.contentHeight-e.containerHeight&&o<0)return!e.settings.wheelPropagation}var i=t.scrollLeft;if(0===o){if(!e.scrollbarXActive)return!1;if(0===i&&n<0||i>=e.contentWidth-e.containerWidth&&n>0)return!e.settings.wheelPropagation}return!0}(c,f)&&o.preventDefault()}}}))}var r=t("../../lib/helper"),i=t("../../lib/dom"),a=t("../instances"),s=t("../update-geometry"),l=t("../update-scroll");e.exports=function(t){o(t,a.get(t))}},{"../../lib/dom":3,"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],13:[function(t,e,n){"use strict";function o(t,e){function n(n){var r=function(t){var e=t.deltaX,n=-1*t.deltaY;return void 0!==e&&void 0!==n||(e=-1*t.wheelDeltaX/6,n=t.wheelDeltaY/6),t.deltaMode&&1===t.deltaMode&&(e*=10,n*=10),e!=e&&n!=n&&(e=0,n=t.wheelDelta),t.shiftKey?[-n,-e]:[e,n]}(n),s=r[0],l=r[1];(function(e,n){var o=t.querySelector("textarea:hover, select[multiple]:hover, .ps-child:hover");if(o){var r=window.getComputedStyle(o);if(![r.overflow,r.overflowX,r.overflowY].join("").match(/(scroll|auto)/))return!1;var i=o.scrollHeight-o.clientHeight;if(i>0&&!(0===o.scrollTop&&n>0||o.scrollTop===i&&n<0))return!0;var a=o.scrollLeft-o.clientWidth;if(a>0&&!(0===o.scrollLeft&&e<0||o.scrollLeft===a&&e>0))return!0}return!1})(s,l)||(o=!1,e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(a(t,"top",l?t.scrollTop-l*e.settings.wheelSpeed:t.scrollTop+s*e.settings.wheelSpeed),o=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(a(t,"left",s?t.scrollLeft+s*e.settings.wheelSpeed:t.scrollLeft-l*e.settings.wheelSpeed),o=!0):(a(t,"top",t.scrollTop-l*e.settings.wheelSpeed),a(t,"left",t.scrollLeft+s*e.settings.wheelSpeed)),i(t),(o=o||function(n,o){var r=t.scrollTop;if(0===n){if(!e.scrollbarYActive)return!1;if(0===r&&o>0||r>=e.contentHeight-e.containerHeight&&o<0)return!e.settings.wheelPropagation}var i=t.scrollLeft;if(0===o){if(!e.scrollbarXActive)return!1;if(0===i&&n<0||i>=e.contentWidth-e.containerWidth&&n>0)return!e.settings.wheelPropagation}return!0}(s,l))&&(n.stopPropagation(),n.preventDefault()))}var o=!1;void 0!==window.onwheel?e.event.bind(t,"wheel",n):void 0!==window.onmousewheel&&e.event.bind(t,"mousewheel",n)}var r=t("../instances"),i=t("../update-geometry"),a=t("../update-scroll");e.exports=function(t){o(t,r.get(t))}},{"../instances":18,"../update-geometry":19,"../update-scroll":20}],14:[function(t,e,n){"use strict";var o=t("../instances"),r=t("../update-geometry");e.exports=function(t){!function(t,e){e.event.bind(t,"scroll",(function(){r(t)}))}(t,o.get(t))}},{"../instances":18,"../update-geometry":19}],15:[function(t,e,n){"use strict";function o(t,e){function n(){l||(l=setInterval((function(){return i.get(t)?(s(t,"top",t.scrollTop+u.top),s(t,"left",t.scrollLeft+u.left),void a(t)):void clearInterval(l)}),50))}function o(){l&&(clearInterval(l),l=null),r.stopScrolling(t)}var l=null,u={top:0,left:0},c=!1;e.event.bind(e.ownerDocument,"selectionchange",(function(){t.contains(function(){var t=window.getSelection?window.getSelection():document.getSelection?document.getSelection():"";return 0===t.toString().length?null:t.getRangeAt(0).commonAncestorContainer}())?c=!0:(c=!1,o())})),e.event.bind(window,"mouseup",(function(){c&&(c=!1,o())})),e.event.bind(window,"keyup",(function(){c&&(c=!1,o())})),e.event.bind(window,"mousemove",(function(e){if(c){var i={x:e.pageX,y:e.pageY},a={left:t.offsetLeft,right:t.offsetLeft+t.offsetWidth,top:t.offsetTop,bottom:t.offsetTop+t.offsetHeight};i.x<a.left+3?(u.left=-5,r.startScrolling(t,"x")):i.x>a.right-3?(u.left=5,r.startScrolling(t,"x")):u.left=0,i.y<a.top+3?(a.top+3-i.y<5?u.top=-5:u.top=-20,r.startScrolling(t,"y")):i.y>a.bottom-3?(i.y-a.bottom+3<5?u.top=5:u.top=20,r.startScrolling(t,"y")):u.top=0,0===u.top&&0===u.left?o():n()}}))}var r=t("../../lib/helper"),i=t("../instances"),a=t("../update-geometry"),s=t("../update-scroll");e.exports=function(t){o(t,i.get(t))}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],16:[function(t,e,n){"use strict";var o=t("../../lib/helper"),r=t("../instances"),i=t("../update-geometry"),a=t("../update-scroll");e.exports=function(t){(o.env.supportsTouch||o.env.supportsIePointer)&&function(t,e,n,o){function s(n,o){var r=t.scrollTop,i=t.scrollLeft,a=Math.abs(n),s=Math.abs(o);if(s>a){if(o<0&&r===e.contentHeight-e.containerHeight||o>0&&0===r)return!e.settings.swipePropagation}else if(a>s&&(n<0&&i===e.contentWidth-e.containerWidth||n>0&&0===i))return!e.settings.swipePropagation;return!0}function l(e,n){a(t,"top",t.scrollTop-n),a(t,"left",t.scrollLeft-e),i(t)}function u(){b=!0}function c(){b=!1}function f(t){return t.targetTouches?t.targetTouches[0]:t}function h(t){return!(!t.targetTouches||1!==t.targetTouches.length)||!(!t.pointerType||"mouse"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_MOUSE)}function p(t){if(h(t)){w=!0;var e=f(t);m.pageX=e.pageX,m.pageY=e.pageY,y=(new Date).getTime(),null!==C&&clearInterval(C),t.stopPropagation()}}function d(t){if(!w&&e.settings.swipePropagation&&p(t),!b&&w&&h(t)){var n=f(t),o={pageX:n.pageX,pageY:n.pageY},r=o.pageX-m.pageX,i=o.pageY-m.pageY;l(r,i),m=o;var a=(new Date).getTime(),u=a-y;u>0&&(v.x=r/u,v.y=i/u,y=a),s(r,i)&&(t.stopPropagation(),t.preventDefault())}}function g(){!b&&w&&(w=!1,e.settings.swipeEasing&&(clearInterval(C),C=setInterval((function(){return r.get(t)&&(v.x||v.y)?Math.abs(v.x)<.01&&Math.abs(v.y)<.01?void clearInterval(C):(l(30*v.x,30*v.y),v.x*=.8,void(v.y*=.8)):void clearInterval(C)}),10)))}var m={},y=0,v={},C=null,b=!1,w=!1;n?(e.event.bind(window,"touchstart",u),e.event.bind(window,"touchend",c),e.event.bind(t,"touchstart",p),e.event.bind(t,"touchmove",d),e.event.bind(t,"touchend",g)):o&&(window.PointerEvent?(e.event.bind(window,"pointerdown",u),e.event.bind(window,"pointerup",c),e.event.bind(t,"pointerdown",p),e.event.bind(t,"pointermove",d),e.event.bind(t,"pointerup",g)):window.MSPointerEvent&&(e.event.bind(window,"MSPointerDown",u),e.event.bind(window,"MSPointerUp",c),e.event.bind(t,"MSPointerDown",p),e.event.bind(t,"MSPointerMove",d),e.event.bind(t,"MSPointerUp",g)))}(t,r.get(t),o.env.supportsTouch,o.env.supportsIePointer)}},{"../../lib/helper":6,"../instances":18,"../update-geometry":19,"../update-scroll":20}],17:[function(t,e,n){"use strict";var o=t("../lib/helper"),r=t("../lib/class"),i=t("./instances"),a=t("./update-geometry"),s={"click-rail":t("./handler/click-rail"),"drag-scrollbar":t("./handler/drag-scrollbar"),keyboard:t("./handler/keyboard"),wheel:t("./handler/mouse-wheel"),touch:t("./handler/touch"),selection:t("./handler/selection")},l=t("./handler/native-scroll");e.exports=function(t,e){e="object"==typeof e?e:{},r.add(t,"ps");var n=i.add(t);n.settings=o.extend(n.settings,e),r.add(t,"ps--theme_"+n.settings.theme),n.settings.handlers.forEach((function(e){s[e](t)})),l(t),a(t)}},{"../lib/class":2,"../lib/helper":6,"./handler/click-rail":10,"./handler/drag-scrollbar":11,"./handler/keyboard":12,"./handler/mouse-wheel":13,"./handler/native-scroll":14,"./handler/selection":15,"./handler/touch":16,"./instances":18,"./update-geometry":19}],18:[function(t,e,n){"use strict";function o(t){function e(){a.add(t,"ps--focus")}function n(){a.remove(t,"ps--focus")}var o=this;o.settings=i.clone(s),o.containerWidth=null,o.containerHeight=null,o.contentWidth=null,o.contentHeight=null,o.isRtl="rtl"===l.css(t,"direction"),o.isNegativeScroll=function(){var e,n=t.scrollLeft;return t.scrollLeft=-1,e=t.scrollLeft<0,t.scrollLeft=n,e}(),o.negativeScrollAdjustment=o.isNegativeScroll?t.scrollWidth-t.clientWidth:0,o.event=new u,o.ownerDocument=t.ownerDocument||document,o.scrollbarXRail=l.appendTo(l.e("div","ps__scrollbar-x-rail"),t),o.scrollbarX=l.appendTo(l.e("div","ps__scrollbar-x"),o.scrollbarXRail),o.scrollbarX.setAttribute("tabindex",0),o.event.bind(o.scrollbarX,"focus",e),o.event.bind(o.scrollbarX,"blur",n),o.scrollbarXActive=null,o.scrollbarXWidth=null,o.scrollbarXLeft=null,o.scrollbarXBottom=i.toInt(l.css(o.scrollbarXRail,"bottom")),o.isScrollbarXUsingBottom=o.scrollbarXBottom==o.scrollbarXBottom,o.scrollbarXTop=o.isScrollbarXUsingBottom?null:i.toInt(l.css(o.scrollbarXRail,"top")),o.railBorderXWidth=i.toInt(l.css(o.scrollbarXRail,"borderLeftWidth"))+i.toInt(l.css(o.scrollbarXRail,"borderRightWidth")),l.css(o.scrollbarXRail,"display","block"),o.railXMarginWidth=i.toInt(l.css(o.scrollbarXRail,"marginLeft"))+i.toInt(l.css(o.scrollbarXRail,"marginRight")),l.css(o.scrollbarXRail,"display",""),o.railXWidth=null,o.railXRatio=null,o.scrollbarYRail=l.appendTo(l.e("div","ps__scrollbar-y-rail"),t),o.scrollbarY=l.appendTo(l.e("div","ps__scrollbar-y"),o.scrollbarYRail),o.scrollbarY.setAttribute("tabindex",0),o.event.bind(o.scrollbarY,"focus",e),o.event.bind(o.scrollbarY,"blur",n),o.scrollbarYActive=null,o.scrollbarYHeight=null,o.scrollbarYTop=null,o.scrollbarYRight=i.toInt(l.css(o.scrollbarYRail,"right")),o.isScrollbarYUsingRight=o.scrollbarYRight==o.scrollbarYRight,o.scrollbarYLeft=o.isScrollbarYUsingRight?null:i.toInt(l.css(o.scrollbarYRail,"left")),o.scrollbarYOuterWidth=o.isRtl?i.outerWidth(o.scrollbarY):null,o.railBorderYWidth=i.toInt(l.css(o.scrollbarYRail,"borderTopWidth"))+i.toInt(l.css(o.scrollbarYRail,"borderBottomWidth")),l.css(o.scrollbarYRail,"display","block"),o.railYMarginHeight=i.toInt(l.css(o.scrollbarYRail,"marginTop"))+i.toInt(l.css(o.scrollbarYRail,"marginBottom")),l.css(o.scrollbarYRail,"display",""),o.railYHeight=null,o.railYRatio=null}function r(t){return t.getAttribute("data-ps-id")}var i=t("../lib/helper"),a=t("../lib/class"),s=t("./default-setting"),l=t("../lib/dom"),u=t("../lib/event-manager"),c=t("../lib/guid"),f={};n.add=function(t){var e=c();return function(t,e){t.setAttribute("data-ps-id",e)}(t,e),f[e]=new o(t),f[e]},n.remove=function(t){delete f[r(t)],function(t){t.removeAttribute("data-ps-id")}(t)},n.get=function(t){return f[r(t)]}},{"../lib/class":2,"../lib/dom":3,"../lib/event-manager":4,"../lib/guid":5,"../lib/helper":6,"./default-setting":8}],19:[function(t,e,n){"use strict";function o(t,e){return t.settings.minScrollbarLength&&(e=Math.max(e,t.settings.minScrollbarLength)),t.settings.maxScrollbarLength&&(e=Math.min(e,t.settings.maxScrollbarLength)),e}var r=t("../lib/helper"),i=t("../lib/class"),a=t("../lib/dom"),s=t("./instances"),l=t("./update-scroll");e.exports=function(t){var e,n=s.get(t);n.containerWidth=t.clientWidth,n.containerHeight=t.clientHeight,n.contentWidth=t.scrollWidth,n.contentHeight=t.scrollHeight,t.contains(n.scrollbarXRail)||((e=a.queryChildren(t,".ps__scrollbar-x-rail")).length>0&&e.forEach((function(t){a.remove(t)})),a.appendTo(n.scrollbarXRail,t)),t.contains(n.scrollbarYRail)||((e=a.queryChildren(t,".ps__scrollbar-y-rail")).length>0&&e.forEach((function(t){a.remove(t)})),a.appendTo(n.scrollbarYRail,t)),!n.settings.suppressScrollX&&n.containerWidth+n.settings.scrollXMarginOffset<n.contentWidth?(n.scrollbarXActive=!0,n.railXWidth=n.containerWidth-n.railXMarginWidth,n.railXRatio=n.containerWidth/n.railXWidth,n.scrollbarXWidth=o(n,r.toInt(n.railXWidth*n.containerWidth/n.contentWidth)),n.scrollbarXLeft=r.toInt((n.negativeScrollAdjustment+t.scrollLeft)*(n.railXWidth-n.scrollbarXWidth)/(n.contentWidth-n.containerWidth))):n.scrollbarXActive=!1,!n.settings.suppressScrollY&&n.containerHeight+n.settings.scrollYMarginOffset<n.contentHeight?(n.scrollbarYActive=!0,n.railYHeight=n.containerHeight-n.railYMarginHeight,n.railYRatio=n.containerHeight/n.railYHeight,n.scrollbarYHeight=o(n,r.toInt(n.railYHeight*n.containerHeight/n.contentHeight)),n.scrollbarYTop=r.toInt(t.scrollTop*(n.railYHeight-n.scrollbarYHeight)/(n.contentHeight-n.containerHeight))):n.scrollbarYActive=!1,n.scrollbarXLeft>=n.railXWidth-n.scrollbarXWidth&&(n.scrollbarXLeft=n.railXWidth-n.scrollbarXWidth),n.scrollbarYTop>=n.railYHeight-n.scrollbarYHeight&&(n.scrollbarYTop=n.railYHeight-n.scrollbarYHeight),function(t,e){var n={width:e.railXWidth};e.isRtl?n.left=e.negativeScrollAdjustment+t.scrollLeft+e.containerWidth-e.contentWidth:n.left=t.scrollLeft,e.isScrollbarXUsingBottom?n.bottom=e.scrollbarXBottom-t.scrollTop:n.top=e.scrollbarXTop+t.scrollTop,a.css(e.scrollbarXRail,n);var o={top:t.scrollTop,height:e.railYHeight};e.isScrollbarYUsingRight?e.isRtl?o.right=e.contentWidth-(e.negativeScrollAdjustment+t.scrollLeft)-e.scrollbarYRight-e.scrollbarYOuterWidth:o.right=e.scrollbarYRight-t.scrollLeft:e.isRtl?o.left=e.negativeScrollAdjustment+t.scrollLeft+2*e.containerWidth-e.contentWidth-e.scrollbarYLeft-e.scrollbarYOuterWidth:o.left=e.scrollbarYLeft+t.scrollLeft,a.css(e.scrollbarYRail,o),a.css(e.scrollbarX,{left:e.scrollbarXLeft,width:e.scrollbarXWidth-e.railBorderXWidth}),a.css(e.scrollbarY,{top:e.scrollbarYTop,height:e.scrollbarYHeight-e.railBorderYWidth})}(t,n),n.scrollbarXActive?i.add(t,"ps--active-x"):(i.remove(t,"ps--active-x"),n.scrollbarXWidth=0,n.scrollbarXLeft=0,l(t,"left",0)),n.scrollbarYActive?i.add(t,"ps--active-y"):(i.remove(t,"ps--active-y"),n.scrollbarYHeight=0,n.scrollbarYTop=0,l(t,"top",0))}},{"../lib/class":2,"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-scroll":20}],20:[function(t,e,n){"use strict";var o=t("./instances"),r=function(t){var e=document.createEvent("Event");return e.initEvent(t,!0,!0),e};e.exports=function(t,e,n){if(void 0===t)throw"You must provide an element to the update-scroll function";if(void 0===e)throw"You must provide an axis to the update-scroll function";if(void 0===n)throw"You must provide a value to the update-scroll function";"top"===e&&n<=0&&(t.scrollTop=n=0,t.dispatchEvent(r("ps-y-reach-start"))),"left"===e&&n<=0&&(t.scrollLeft=n=0,t.dispatchEvent(r("ps-x-reach-start")));var i=o.get(t);"top"===e&&n>=i.contentHeight-i.containerHeight&&((n=i.contentHeight-i.containerHeight)-t.scrollTop<=1?n=t.scrollTop:t.scrollTop=n,t.dispatchEvent(r("ps-y-reach-end"))),"left"===e&&n>=i.contentWidth-i.containerWidth&&((n=i.contentWidth-i.containerWidth)-t.scrollLeft<=1?n=t.scrollLeft:t.scrollLeft=n,t.dispatchEvent(r("ps-x-reach-end"))),void 0===i.lastTop&&(i.lastTop=t.scrollTop),void 0===i.lastLeft&&(i.lastLeft=t.scrollLeft),"top"===e&&n<i.lastTop&&t.dispatchEvent(r("ps-scroll-up")),"top"===e&&n>i.lastTop&&t.dispatchEvent(r("ps-scroll-down")),"left"===e&&n<i.lastLeft&&t.dispatchEvent(r("ps-scroll-left")),"left"===e&&n>i.lastLeft&&t.dispatchEvent(r("ps-scroll-right")),"top"===e&&n!==i.lastTop&&(t.scrollTop=i.lastTop=n,t.dispatchEvent(r("ps-scroll-y"))),"left"===e&&n!==i.lastLeft&&(t.scrollLeft=i.lastLeft=n,t.dispatchEvent(r("ps-scroll-x")))}},{"./instances":18}],21:[function(t,e,n){"use strict";var o=t("../lib/helper"),r=t("../lib/dom"),i=t("./instances"),a=t("./update-geometry"),s=t("./update-scroll");e.exports=function(t){var e=i.get(t);e&&(e.negativeScrollAdjustment=e.isNegativeScroll?t.scrollWidth-t.clientWidth:0,r.css(e.scrollbarXRail,"display","block"),r.css(e.scrollbarYRail,"display","block"),e.railXMarginWidth=o.toInt(r.css(e.scrollbarXRail,"marginLeft"))+o.toInt(r.css(e.scrollbarXRail,"marginRight")),e.railYMarginHeight=o.toInt(r.css(e.scrollbarYRail,"marginTop"))+o.toInt(r.css(e.scrollbarYRail,"marginBottom")),r.css(e.scrollbarXRail,"display","none"),r.css(e.scrollbarYRail,"display","none"),a(t),s(t,"top",t.scrollTop),s(t,"left",t.scrollLeft),r.css(e.scrollbarXRail,"display",""),r.css(e.scrollbarYRail,"display",""))}},{"../lib/dom":3,"../lib/helper":6,"./instances":18,"./update-geometry":19,"./update-scroll":20}]},{},[1]),function(t){"use strict";function e(t){return function(t){return null!==t&&t===t.window}(t)?t:9===t.nodeType&&t.defaultView}function n(t){var n,o,r={top:0,left:0},i=t&&t.ownerDocument;return n=i.documentElement,void 0!==t.getBoundingClientRect&&(r=t.getBoundingClientRect()),o=e(i),{top:r.top+o.pageYOffset-n.clientTop,left:r.left+o.pageXOffset-n.clientLeft}}function o(t){var e="";for(var n in t)t.hasOwnProperty(n)&&(e+=n+":"+t[n]+";");return e}function r(e){var n=function(t){if(!1===l.allowEvent(t))return null;for(var e=null,n=t.target||t.srcElement;null!==n.parentElement;){if(!(n instanceof SVGElement||-1===n.className.indexOf("waves-effect"))){e=n;break}if(n.classList.contains("waves-effect")){e=n;break}n=n.parentElement}return e}(e);null!==n&&(s.show(e,n),"ontouchstart"in t&&(n.addEventListener("touchend",s.hide,!1),n.addEventListener("touchcancel",s.hide,!1)),n.addEventListener("mouseup",s.hide,!1),n.addEventListener("mouseleave",s.hide,!1))}var i=i||{},a=document.querySelectorAll.bind(document),s={duration:750,show:function(t,e){if(2===t.button)return!1;var r=e||this,i=document.createElement("div");i.className="waves-ripple",r.appendChild(i);var a=n(r),l=t.pageY-a.top,u=t.pageX-a.left,c="scale("+r.clientWidth/100*10+")";"touches"in t&&(l=t.touches[0].pageY-a.top,u=t.touches[0].pageX-a.left),i.setAttribute("data-hold",Date.now()),i.setAttribute("data-scale",c),i.setAttribute("data-x",u),i.setAttribute("data-y",l);var f={top:l+"px",left:u+"px"};i.className=i.className+" waves-notransition",i.setAttribute("style",o(f)),i.className=i.className.replace("waves-notransition",""),f["-webkit-transform"]=c,f["-moz-transform"]=c,f["-ms-transform"]=c,f["-o-transform"]=c,f.transform=c,f.opacity="1",f["-webkit-transition-duration"]=s.duration+"ms",f["-moz-transition-duration"]=s.duration+"ms",f["-o-transition-duration"]=s.duration+"ms",f["transition-duration"]=s.duration+"ms",f["-webkit-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",f["-moz-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",f["-o-transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",f["transition-timing-function"]="cubic-bezier(0.250, 0.460, 0.450, 0.940)",i.setAttribute("style",o(f))},hide:function(t){l.touchup(t);var e=this,n=(e.clientWidth,null),r=e.getElementsByClassName("waves-ripple");if(!(r.length>0))return!1;var i=(n=r[r.length-1]).getAttribute("data-x"),a=n.getAttribute("data-y"),u=n.getAttribute("data-scale"),c=350-(Date.now()-Number(n.getAttribute("data-hold")));0>c&&(c=0),setTimeout((function(){var t={top:a+"px",left:i+"px",opacity:"0","-webkit-transition-duration":s.duration+"ms","-moz-transition-duration":s.duration+"ms","-o-transition-duration":s.duration+"ms","transition-duration":s.duration+"ms","-webkit-transform":u,"-moz-transform":u,"-ms-transform":u,"-o-transform":u,transform:u};n.setAttribute("style",o(t)),setTimeout((function(){try{e.removeChild(n)}catch(t){return!1}}),s.duration)}),c)},wrapInput:function(t){for(var e=0;e<t.length;e++){var n=t[e];if("input"===n.tagName.toLowerCase()){var o=n.parentNode;if("i"===o.tagName.toLowerCase()&&-1!==o.className.indexOf("waves-effect"))continue;var r=document.createElement("i");r.className=n.className+" waves-input-wrapper";var i=n.getAttribute("style");i||(i=""),r.setAttribute("style",i),n.className="waves-button-input",n.removeAttribute("style"),o.replaceChild(r,n),r.appendChild(n)}}}},l={touches:0,allowEvent:function(t){var e=!0;return"touchstart"===t.type?l.touches+=1:"touchend"===t.type||"touchcancel"===t.type?setTimeout((function(){l.touches>0&&(l.touches-=1)}),500):"mousedown"===t.type&&l.touches>0&&(e=!1),e},touchup:function(t){l.allowEvent(t)}};i.displayEffect=function(e){"duration"in(e=e||{})&&(s.duration=e.duration),s.wrapInput(a(".waves-effect")),"ontouchstart"in t&&document.body.addEventListener("touchstart",r,!1),document.body.addEventListener("mousedown",r,!1)},i.attach=function(e){"input"===e.tagName.toLowerCase()&&(s.wrapInput([e]),e=e.parentElement),"ontouchstart"in t&&e.addEventListener("touchstart",r,!1),e.addEventListener("mousedown",r,!1)},t.Waves=i,document.addEventListener("DOMContentLoaded",(function(){i.displayEffect()}),!1)}(window),function(t,e){if("function"==typeof define&&define.amd)define(["jquery"],e);else if("undefined"!=typeof exports)e(require("jquery"));else{e(t.jquery),t.AdminMenu={}}}(this,(function(t){"use strict";var e;(e=t)&&e.__esModule;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};var o=function(t){var e=!1,n={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};function o(e){var n=this,o=!1;return t(this).one(r.TRANSITION_END,(function(){o=!0})),setTimeout((function(){o||r.triggerTransitionEnd(n)}),e),this}var r={TRANSITION_END:"mmTransitionEnd",triggerTransitionEnd:function(n){t(n).trigger(e.end)},supportsTransitionEnd:function(){return Boolean(e)}};return e=function(){if(window.QUnit)return!1;var t=document.createElement("mm");for(var e in n)if(void 0!==t.style[e])return{end:n[e]};return!1}(),t.fn.emulateTransitionEnd=o,r.supportsTransitionEnd()&&(t.event.special[r.TRANSITION_END]={bindType:e.end,delegateType:e.end,handle:function(e){if(t(e.target).is(this))return e.handleObj.handler.apply(this,arguments)}}),r}(jQuery);!function(t){var e="AdminMenu",r=t.fn[e],i={toggle:!0,preventDefault:!0,activeClass:"active",collapseClass:"collapse",collapseInClass:"in",collapsingClass:"collapsing",triggerElement:"a",parentTrigger:"li",subMenu:"ul"},a={SHOW:"show.AdminMenu",SHOWN:"shown.AdminMenu",HIDE:"hide.AdminMenu",HIDDEN:"hidden.AdminMenu",CLICK_DATA_API:"click.AdminMenu.data-api"},s=function(){function e(t,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this._element=t,this._config=this._getConfig(n),this._transitioning=null,this.init()}return e.prototype.init=function(){var e=this;t(this._element).find(this._config.parentTrigger+"."+this._config.activeClass).has(this._config.subMenu).children(this._config.subMenu).attr("aria-expanded",!0).addClass(this._config.collapseClass+" "+this._config.collapseInClass),t(this._element).find(this._config.parentTrigger).not("."+this._config.activeClass).has(this._config.subMenu).children(this._config.subMenu).attr("aria-expanded",!1).addClass(this._config.collapseClass),t(this._element).find(this._config.parentTrigger).has(this._config.subMenu).children(this._config.triggerElement).on(a.CLICK_DATA_API,(function(n){var o=t(this),r=o.parent(e._config.parentTrigger),i=r.siblings(e._config.parentTrigger).children(e._config.triggerElement),a=r.children(e._config.subMenu);e._config.preventDefault&&n.preventDefault(),"true"!==o.attr("aria-disabled")&&(r.hasClass(e._config.activeClass)?(o.attr("aria-expanded",!1),e._hide(a)):(e._show(a),o.attr("aria-expanded",!0),e._config.toggle&&i.attr("aria-expanded",!1)),e._config.onTransitionStart&&e._config.onTransitionStart(n))}))},e.prototype._show=function(e){if(!this._transitioning&&!t(e).hasClass(this._config.collapsingClass)){var n=this,r=t(e),i=t.Event(a.SHOW);if(r.trigger(i),!i.isDefaultPrevented()){r.parent(this._config.parentTrigger).addClass(this._config.activeClass),this._config.toggle&&this._hide(r.parent(this._config.parentTrigger).siblings().children(this._config.subMenu+"."+this._config.collapseInClass).attr("aria-expanded",!1)),r.removeClass(this._config.collapseClass).addClass(this._config.collapsingClass).height(0),this.setTransitioning(!0);var s=function(){r.removeClass(n._config.collapsingClass).addClass(n._config.collapseClass+" "+n._config.collapseInClass).height("").attr("aria-expanded",!0),n.setTransitioning(!1),r.trigger(a.SHOWN)};o.supportsTransitionEnd()?r.height(r[0].scrollHeight).one(o.TRANSITION_END,s).emulateTransitionEnd(350):s()}}},e.prototype._hide=function(e){if(!this._transitioning&&t(e).hasClass(this._config.collapseInClass)){var n=this,r=t(e),i=t.Event(a.HIDE);if(r.trigger(i),!i.isDefaultPrevented()){r.parent(this._config.parentTrigger).removeClass(this._config.activeClass),r.height(r.height())[0].offsetHeight,r.addClass(this._config.collapsingClass).removeClass(this._config.collapseClass).removeClass(this._config.collapseInClass),this.setTransitioning(!0);var s=function(){n._transitioning&&n._config.onTransitionEnd&&n._config.onTransitionEnd(),n.setTransitioning(!1),r.trigger(a.HIDDEN),r.removeClass(n._config.collapsingClass).addClass(n._config.collapseClass).attr("aria-expanded",!1)};o.supportsTransitionEnd()?0==r.height()||"none"==r.css("display")?s():r.height(0).one(o.TRANSITION_END,s).emulateTransitionEnd(350):s()}}},e.prototype.setTransitioning=function(t){this._transitioning=t},e.prototype.dispose=function(){t.removeData(this._element,"AdminMenu"),t(this._element).find(this._config.parentTrigger).has(this._config.subMenu).children(this._config.triggerElement).off("click"),this._transitioning=null,this._config=null,this._element=null},e.prototype._getConfig=function(e){return e=t.extend({},i,e)},e._jQueryInterface=function(o){return this.each((function(){var r=t(this),a=r.data("AdminMenu"),s=t.extend({},i,r.data(),"object"===(void 0===o?"undefined":n(o))&&o);if(!a&&/dispose/.test(o)&&this.dispose(),a||(a=new e(this,s),r.data("AdminMenu",a)),"string"==typeof o){if(void 0===a[o])throw new Error('No method named "'+o+'"');a[o]()}}))},e}();t.fn[e]=s._jQueryInterface,t.fn[e].Constructor=s,t.fn[e].noConflict=function(){return t.fn[e]=r,s._jQueryInterface}}(jQuery)})),(function(){var t,e;t=window.jQuery,e=t(window),t.fn.stick_in_parent=function(n){var o,r,i,a,s,l,u,c,f,h,p,d;for(null==n&&(n={}),d=n.sticky_class,s=n.inner_scrolling,p=n.recalc_every,h=n.parent,c=n.offset_top,u=n.spacer,r=n.bottoming,null==c&&(c=0),null==h&&(h=void 0),null==s&&(s=!0),null==d&&(d="is_stuck"),o=t(document),null==r&&(r=!0),f=function(t){var e;return window.getComputedStyle?(t=window.getComputedStyle(t[0]),e=parseFloat(t.getPropertyValue("width"))+parseFloat(t.getPropertyValue("margin-left"))+parseFloat(t.getPropertyValue("margin-right")),"border-box"!==t.getPropertyValue("box-sizing")&&(e+=parseFloat(t.getPropertyValue("border-left-width"))+parseFloat(t.getPropertyValue("border-right-width"))+parseFloat(t.getPropertyValue("padding-left"))+parseFloat(t.getPropertyValue("padding-right"))),e):t.outerWidth(!0)},i=function(n,i,a,l,g,m,y,v){var C,b,w,T,x,S,A,I,R,k,M,N;if(!n.data("sticky_kit")){if(n.data("sticky_kit",!0),x=o.height(),A=n.parent(),null!=h&&(A=A.closest(h)),!A.length)throw"failed to find stick parent";if(C=w=!1,(M=null!=u?u&&n.closest(u):t("<div />"))&&M.css("position",n.css("position")),(I=function(){var t,e,r;if(!v&&(x=o.height(),t=parseInt(A.css("border-top-width"),10),e=parseInt(A.css("padding-top"),10),i=parseInt(A.css("padding-bottom"),10),a=A.offset().top+t+e,l=A.height(),w&&(C=w=!1,null==u&&(n.insertAfter(M),M.detach()),n.css({position:"",top:"",width:"",bottom:""}).removeClass(d),r=!0),g=n.offset().top-(parseInt(n.css("margin-top"),10)||0)-c,m=n.outerHeight(!0),y=n.css("float"),M&&M.css({width:f(n),height:m,display:n.css("display"),"vertical-align":n.css("vertical-align"),float:y}),r))return N()})(),m!==l)return T=void 0,S=c,k=p,N=function(){var t,f,h,b;if(!v&&(h=!1,null!=k&&(0>=--k&&(k=p,I(),h=!0)),h||o.height()===x||I(),h=e.scrollTop(),null!=T&&(f=h-T),T=h,w?(r&&(b=h+m+S>l+a,C&&!b&&(C=!1,n.css({position:"fixed",bottom:"",top:S}).trigger("sticky_kit:unbottom"))),h<g&&(w=!1,S=c,null==u&&("left"!==y&&"right"!==y||n.insertAfter(M),M.detach()),t={position:"",width:"",top:""},n.css(t).removeClass(d).trigger("sticky_kit:unstick")),s&&(t=e.height(),m+c>t&&!C&&(S-=f,S=Math.max(t-m,S),S=Math.min(c,S),w&&n.css({top:S+"px"})))):h>g&&(w=!0,(t={position:"fixed",top:S}).width="border-box"===n.css("box-sizing")?n.outerWidth()+"px":n.width()+"px",n.css(t).addClass(d),null==u&&(n.after(M),"left"!==y&&"right"!==y||M.append(n)),n.trigger("sticky_kit:stick")),w&&r&&(null==b&&(b=h+m+S>l+a),!C&&b)))return C=!0,"static"===A.css("position")&&A.css({position:"relative"}),n.css({position:"absolute",bottom:i,top:"auto"}).trigger("sticky_kit:bottom")},R=function(){return I(),N()},b=function(){if(v=!0,e.off("touchmove",N),e.off("scroll",N),e.off("resize",R),t(document.body).off("sticky_kit:recalc",R),n.off("sticky_kit:detach",b),n.removeData("sticky_kit"),n.css({position:"",bottom:"",top:"",width:""}),A.position("position",""),w)return null==u&&("left"!==y&&"right"!==y||n.insertAfter(M),M.remove()),n.removeClass(d)},e.on("touchmove",N),e.on("scroll",N),e.on("resize",R),t(document.body).on("sticky_kit:recalc",R),n.on("sticky_kit:detach",b),setTimeout(N,0)}},a=0,l=this.length;a<l;a++)n=this[a],i(t(n));return this}}).call(this),function(t,e,n){!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):jQuery&&!jQuery.fn.sparkline&&t(jQuery)}((function(o){"use strict";var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O={},j=0;r=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:n,normalRangeMax:n,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:n,chartRangeMax:n,chartRangeMinX:n,chartRangeMaxX:n,tooltipFormat:new a('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:n,nullColor:n,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:n,chartRangeMin:n,chartRangeClip:!1,colorMap:n,tooltipFormat:new a('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new a('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:n,thresholdValue:0,chartRangeMax:n,chartRangeMin:n,chartRangeClip:!1,tooltipFormat:new a("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:n,tooltipFormat:new a("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new a('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:n,targetColor:"#4a2",chartRangeMax:n,chartRangeMin:n,tooltipFormat:new a("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},i=function(){var t,e;return t=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(t.prototype=o.extend(new arguments[0],arguments[arguments.length-1]),t._super=arguments[0].prototype):t.prototype=arguments[arguments.length-1],arguments.length>2&&((e=Array.prototype.slice.call(arguments,1,-1)).unshift(t.prototype),o.extend.apply(o,e))):t.prototype=arguments[0],t.prototype.cls=t,t},o.SPFormatClass=a=i({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(t,e){this.format=t,this.fclass=e},render:function(t,e,o){var r,i,a,s,l,u=this,c=t;return this.format.replace(this.fre,(function(){return i=arguments[1],a=arguments[3],(r=u.precre.exec(i))?(l=r[2],i=r[1]):l=!1,(s=c[i])===n?"":a&&e&&e[a]?e[a].get?e[a].get(s)||s:e[a][s]||s:(h(s)&&(s=o.get("numberFormatter")?o.get("numberFormatter")(s):m(s,l,o.get("numberDigitGroupCount"),o.get("numberDigitGroupSep"),o.get("numberDecimalMark"))),s)}))}}),o.spformat=function(t,e){return new a(t,e)},s=function(t,e,n){return t<e?e:t>n?n:t},l=function(t,n){var o;return 2===n?(o=e.floor(t.length/2),t.length%2?t[o]:(t[o-1]+t[o])/2):t.length%2?(o=(t.length*n+n)/4)%1?(t[e.floor(o)]+t[e.floor(o)-1])/2:t[o-1]:(o=(t.length*n+2)/4)%1?(t[e.floor(o)]+t[e.floor(o)-1])/2:t[o-1]},u=function(t){var e;switch(t){case"undefined":t=n;break;case"null":t=null;break;case"true":t=!0;break;case"false":t=!1;break;default:t==(e=parseFloat(t))&&(t=e)}return t},c=function(t){var e,n=[];for(e=t.length;e--;)n[e]=u(t[e]);return n},f=function(t,e){var n,o,r=[];for(n=0,o=t.length;n<o;n++)t[n]!==e&&r.push(t[n]);return r},h=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},m=function(t,e,n,r,i){var a,s;for(t=(!1===e?parseFloat(t).toString():t.toFixed(e)).split(""),(a=(a=o.inArray(".",t))<0?t.length:a)<t.length&&(t[a]=i),s=a-n;s>0;s-=n)t.splice(s,0,r);return t.join("")},p=function(t,e,n){var o;for(o=e.length;o--;)if((!n||null!==e[o])&&e[o]!==t)return!1;return!0},g=function(t){return o.isArray(t)?t:[t]},d=function(e){var n;t.createStyleSheet?t.createStyleSheet().cssText=e:((n=t.createElement("style")).type="text/css",t.getElementsByTagName("head")[0].appendChild(n),n["string"==typeof t.body.style.WebkitAppearance?"innerText":"innerHTML"]=e)},o.fn.simpledraw=function(e,r,i,a){var s,l;if(i&&(s=this.data("_jqs_vcanvas")))return s;if(!1===o.fn.sparkline.canvas)return!1;if(o.fn.sparkline.canvas===n){var u=t.createElement("canvas");if(u.getContext&&u.getContext("2d"))o.fn.sparkline.canvas=function(t,e,n,o){return new N(t,e,n,o)};else{if(!t.namespaces||t.namespaces.v)return o.fn.sparkline.canvas=!1,!1;t.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),o.fn.sparkline.canvas=function(t,e,n,o){return new E(t,e,n)}}}return e===n&&(e=o(this).innerWidth()),r===n&&(r=o(this).innerHeight()),s=o.fn.sparkline.canvas(e,r,this,a),(l=o(this).data("_jqs_mhandler"))&&l.registerCanvas(s),s},o.fn.cleardraw=function(){var t=this.data("_jqs_vcanvas");t&&t.reset()},o.RangeMapClass=y=i({init:function(t){var e,n,o=[];for(e in t)t.hasOwnProperty(e)&&"string"==typeof e&&e.indexOf(":")>-1&&((n=e.split(":"))[0]=0===n[0].length?-1/0:parseFloat(n[0]),n[1]=0===n[1].length?1/0:parseFloat(n[1]),n[2]=t[e],o.push(n));this.map=t,this.rangelist=o||!1},get:function(t){var e,o,r,i=this.rangelist;if((r=this.map[t])!==n)return r;if(i)for(e=i.length;e--;)if((o=i[e])[0]<=t&&o[1]>=t)return o[2];return n}}),o.range_map=function(t){return new y(t)},v=i({init:function(t,e){var n=o(t);this.$el=n,this.options=e,this.currentPageX=0,this.currentPageY=0,this.el=t,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!e.get("disableTooltips"),this.highlightEnabled=!e.get("disableHighlight")},registerSparkline:function(t){this.splist.push(t),this.over&&this.updateDisplay()},registerCanvas:function(t){var e=o(t.canvas);this.canvas=t,this.$canvas=e,e.mouseenter(o.proxy(this.mouseenter,this)),e.mouseleave(o.proxy(this.mouseleave,this)),e.click(o.proxy(this.mouseclick,this))},reset:function(t){this.splist=[],this.tooltip&&t&&(this.tooltip.remove(),this.tooltip=n)},mouseclick:function(t){var e=o.Event("sparklineClick");e.originalEvent=t,e.sparklines=this.splist,this.$el.trigger(e)},mouseenter:function(e){o(t.body).unbind("mousemove.jqs"),o(t.body).bind("mousemove.jqs",o.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=e.pageX,this.currentPageY=e.pageY,this.currentEl=e.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new C(this.options),this.tooltip.updatePosition(e.pageX,e.pageY)),this.updateDisplay()},mouseleave:function(){o(t.body).unbind("mousemove.jqs");var e,n=this.splist,r=n.length,i=!1;for(this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null),e=0;e<r;e++)n[e].clearRegionHighlight()&&(i=!0);i&&this.canvas.render()},mousemove:function(t){this.currentPageX=t.pageX,this.currentPageY=t.pageY,this.currentEl=t.target,this.tooltip&&this.tooltip.updatePosition(t.pageX,t.pageY),this.updateDisplay()},updateDisplay:function(){var t,e,n,r,i=this.splist,a=i.length,s=!1,l=this.$canvas.offset(),u=this.currentPageX-l.left,c=this.currentPageY-l.top;if(this.over){for(e=0;e<a;e++)(n=i[e].setRegionHighlight(this.currentEl,u,c))&&(s=!0);if(s){if((r=o.Event("sparklineRegionChange")).sparklines=this.splist,this.$el.trigger(r),this.tooltip){for(t="",e=0;e<a;e++)t+=i[e].getCurrentRegionTooltip();this.tooltip.setContent(t)}this.disableHighlight||this.canvas.render()}null===n&&this.mouseleave()}}}),C=i({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(e){var n,r=e.get("tooltipClassname","jqstooltip"),i=this.sizeStyle;this.container=e.get("tooltipContainer")||t.body,this.tooltipOffsetX=e.get("tooltipOffsetX",10),this.tooltipOffsetY=e.get("tooltipOffsetY",12),o("#jqssizetip").remove(),o("#jqstooltip").remove(),this.sizetip=o("<div/>",{id:"jqssizetip",style:i,class:r}),this.tooltip=o("<div/>",{id:"jqstooltip",class:r}).appendTo(this.container),n=this.tooltip.offset(),this.offsetLeft=n.left,this.offsetTop=n.top,this.hidden=!0,o(window).unbind("resize.jqs scroll.jqs"),o(window).bind("resize.jqs scroll.jqs",o.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=o(window).scrollTop(),this.scrollLeft=o(window).scrollLeft(),this.scrollRight=this.scrollLeft+o(window).width(),this.updatePosition()},getSize:function(t){this.sizetip.html(t).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(t){if(!t)return this.tooltip.css("visibility","hidden"),void(this.hidden=!0);this.getSize(t),this.tooltip.html(t).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(t,e){if(t===n){if(this.mousex===n)return;t=this.mousex-this.offsetLeft,e=this.mousey-this.offsetTop}else this.mousex=t-=this.offsetLeft,this.mousey=e-=this.offsetTop;this.height&&this.width&&!this.hidden&&(e-=this.height+this.tooltipOffsetY,t+=this.tooltipOffsetX,e<this.scrollTop&&(e=this.scrollTop),t<this.scrollLeft?t=this.scrollLeft:t+this.width>this.scrollRight&&(t=this.scrollRight-this.width),this.tooltip.css({left:t,top:e}))},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=n,o(window).unbind("resize.jqs scroll.jqs")}}),o((function(){d('.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}')})),D=[],o.fn.sparkline=function(e,r){return this.each((function(){var i,a,s=new o.fn.sparkline.options(this,r),l=o(this);if(i=function(){var r,i,a,u,c,f,h;"html"===e||e===n?((h=this.getAttribute(s.get("tagValuesAttribute")))!==n&&null!==h||(h=l.html()),r=h.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")):r=e,i="auto"===s.get("width")?r.length*s.get("defaultPixelsPerValue"):s.get("width"),"auto"===s.get("height")?s.get("composite")&&o.data(this,"_jqs_vcanvas")||((u=t.createElement("span")).innerHTML="a",l.html(u),a=o(u).innerHeight()||o(u).height(),o(u).remove(),u=null):a=s.get("height"),s.get("disableInteraction")?c=!1:(c=o.data(this,"_jqs_mhandler"))?s.get("composite")||c.reset():(c=new v(this,s),o.data(this,"_jqs_mhandler",c)),!s.get("composite")||o.data(this,"_jqs_vcanvas")?((f=new(o.fn.sparkline[s.get("type")])(this,r,s,i,a)).render(),c&&c.registerSparkline(f)):o.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),o.data(this,"_jqs_errnotify",!0))},o(this).html()&&!s.get("disableHiddenCheck")&&o(this).is(":hidden")||!o(this).parents("body").length){if(!s.get("composite")&&o.data(this,"_jqs_pending"))for(a=D.length;a;a--)D[a-1][0]==this&&D.splice(a-1,1);D.push([this,i]),o.data(this,"_jqs_pending",!0)}else i.call(this)}))},o.fn.sparkline.defaults=r(),o.sparkline_display_visible=function(){var t,e,n,r=[];for(e=0,n=D.length;e<n;e++)t=D[e][0],o(t).is(":visible")&&!o(t).parents().is(":hidden")?(D[e][1].call(t),o.data(D[e][0],"_jqs_pending",!1),r.push(e)):!o(t).closest("html").length&&!o.data(t,"_jqs_pending")&&(o.data(D[e][0],"_jqs_pending",!1),r.push(e));for(e=r.length;e;e--)D.splice(r[e-1],1)},o.fn.sparkline.options=i({init:function(t,e){var n,r,i,a;this.userOptions=e=e||{},this.tag=t,this.tagValCache={},i=(r=o.fn.sparkline.defaults).common,this.tagOptionsPrefix=e.enableTagOptions&&(e.tagOptionsPrefix||i.tagOptionsPrefix),n=(a=this.getTagSetting("type"))===O?r[e.type||i.type]:r[a],this.mergedOptions=o.extend({},i,n,e)},getTagSetting:function(t){var e,o,r,i,a=this.tagOptionsPrefix;if(!1===a||a===n)return O;if(this.tagValCache.hasOwnProperty(t))e=this.tagValCache.key;else{if((e=this.tag.getAttribute(a+t))===n||null===e)e=O;else if("["===e.substr(0,1))for(o=(e=e.substr(1,e.length-2).split(",")).length;o--;)e[o]=u(e[o].replace(/(^\s*)|(\s*$)/g,""));else if("{"===e.substr(0,1))for(r=e.substr(1,e.length-2).split(","),e={},o=r.length;o--;)e[(i=r[o].split(":",2))[0].replace(/(^\s*)|(\s*$)/g,"")]=u(i[1].replace(/(^\s*)|(\s*$)/g,""));else e=u(e);this.tagValCache.key=e}return e},get:function(t,e){var o,r=this.getTagSetting(t);return r!==O?r:(o=this.mergedOptions[t])===n?e:o}}),o.fn.sparkline._base=i({disabled:!1,init:function(t,e,r,i,a){this.el=t,this.$el=o(t),this.values=e,this.options=r,this.width=i,this.height=a,this.currentRegion=n},initTarget:function(){var t=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),t))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return!this.disabled||(this.el.innerHTML="",!1)},getRegion:function(t,e){},setRegionHighlight:function(t,e,o){var r,i=this.currentRegion,a=!this.options.get("disableHighlight");return e>this.canvasWidth||o>this.canvasHeight||e<0||o<0?null:i!==(r=this.getRegion(t,e,o))&&(i!==n&&a&&this.removeHighlight(),this.currentRegion=r,r!==n&&a&&this.renderHighlight(),!0)},clearRegionHighlight:function(){return this.currentRegion!==n&&(this.removeHighlight(),this.currentRegion=n,!0)},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(t){},getCurrentRegionTooltip:function(){var t,e,r,i,s,l,u,c,f,h,p,d,g,m,y=this.options,v="",C=[];if(this.currentRegion===n)return"";if(t=this.getCurrentRegionFields(),p=y.get("tooltipFormatter"))return p(this,y,t);if(y.get("tooltipChartTitle")&&(v+='<div class="jqs jqstitle">'+y.get("tooltipChartTitle")+"</div>\n"),!(e=this.options.get("tooltipFormat")))return"";if(o.isArray(e)||(e=[e]),o.isArray(t)||(t=[t]),u=this.options.get("tooltipFormatFieldlist"),c=this.options.get("tooltipFormatFieldlistKey"),u&&c){for(f=[],l=t.length;l--;)h=t[l][c],-1!=(m=o.inArray(h,u))&&(f[m]=t[l]);t=f}for(r=e.length,g=t.length,l=0;l<r;l++)for("string"==typeof(d=e[l])&&(d=new a(d)),i=d.fclass||"jqsfield",m=0;m<g;m++)t[m].isNull&&y.get("tooltipSkipNull")||(o.extend(t[m],{prefix:y.get("tooltipPrefix"),suffix:y.get("tooltipSuffix")}),s=d.render(t[m],y.get("tooltipValueLookups"),y),C.push('<div class="'+i+'">'+s+"</div>"));return C.length?v+C.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(t,n){var o,r,i,a,l=n.get("highlightColor"),u=n.get("highlightLighten");if(l)return l;if(u&&(o=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(t)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(t))){for(i=[],r=4===t.length?16:1,a=0;a<3;a++)i[a]=s(e.round(parseInt(o[a+1],16)*r*u),0,255);return"rgb("+i.join(",")+")"}return t}}),b={changeHighlight:function(t){var e,n=this.currentRegion,r=this.target,i=this.regionShapes[n];i&&(e=this.renderRegion(n,t),o.isArray(e)||o.isArray(i)?(r.replaceWithShapes(i,e),this.regionShapes[n]=o.map(e,(function(t){return t.id}))):(r.replaceWithShape(i,e),this.regionShapes[n]=e.id))},render:function(){var t,e,n,r,i=this.values,a=this.target,s=this.regionShapes;if(this.cls._super.render.call(this)){for(n=i.length;n--;)if(t=this.renderRegion(n))if(o.isArray(t)){for(e=[],r=t.length;r--;)t[r].append(),e.push(t[r].id);s[n]=e}else t.append(),s[n]=t.id;else s[n]=null;a.render()}}},o.fn.sparkline.line=w=i(o.fn.sparkline._base,{type:"line",init:function(t,e,n,o,r){w._super.init.call(this,t,e,n,o,r),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(t,e,o){var r,i=this.regionMap;for(r=i.length;r--;)if(null!==i[r]&&e>=i[r][0]&&e<=i[r][1])return i[r][2];return n},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:null===this.yvalues[t],x:this.xvalues[t],y:this.yvalues[t],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:t}},renderHighlight:function(){var t,e,o=this.currentRegion,r=this.target,i=this.vertices[o],a=this.options,s=a.get("spotRadius"),l=a.get("highlightSpotColor"),u=a.get("highlightLineColor");i&&(s&&l&&(t=r.drawCircle(i[0],i[1],s,n,l),this.highlightSpotId=t.id,r.insertAfterShape(this.lastShapeId,t)),u&&(e=r.drawLine(i[0],this.canvasTop,i[0],this.canvasTop+this.canvasHeight,u),this.highlightLineId=e.id,r.insertAfterShape(this.lastShapeId,e)))},removeHighlight:function(){var t=this.target;this.highlightSpotId&&(t.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(t.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var t,n,o,r,i,a=this.values,s=a.length,l=this.xvalues,u=this.yvalues,c=this.yminmax;for(t=0;t<s;t++)n=a[t],o="string"==typeof a[t],r="object"==typeof a[t]&&a[t]instanceof Array,i=o&&a[t].split(":"),o&&2===i.length?(l.push(Number(i[0])),u.push(Number(i[1])),c.push(Number(i[1]))):r?(l.push(n[0]),u.push(n[1]),c.push(n[1])):(l.push(t),null===a[t]||"null"===a[t]?u.push(null):(u.push(Number(n)),c.push(Number(n))));this.options.get("xvalues")&&(l=this.options.get("xvalues")),this.maxy=this.maxyorg=e.max.apply(e,c),this.miny=this.minyorg=e.min.apply(e,c),this.maxx=e.max.apply(e,l),this.minx=e.min.apply(e,l),this.xvalues=l,this.yvalues=u,this.yminmax=c},processRangeOptions:function(){var t=this.options,e=t.get("normalRangeMin"),o=t.get("normalRangeMax");e!==n&&(e<this.miny&&(this.miny=e),o>this.maxy&&(this.maxy=o)),t.get("chartRangeMin")!==n&&(t.get("chartRangeClip")||t.get("chartRangeMin")<this.miny)&&(this.miny=t.get("chartRangeMin")),t.get("chartRangeMax")!==n&&(t.get("chartRangeClip")||t.get("chartRangeMax")>this.maxy)&&(this.maxy=t.get("chartRangeMax")),t.get("chartRangeMinX")!==n&&(t.get("chartRangeClipX")||t.get("chartRangeMinX")<this.minx)&&(this.minx=t.get("chartRangeMinX")),t.get("chartRangeMaxX")!==n&&(t.get("chartRangeClipX")||t.get("chartRangeMaxX")>this.maxx)&&(this.maxx=t.get("chartRangeMaxX"))},drawNormalRange:function(t,o,r,i,a){var s=this.options.get("normalRangeMin"),l=this.options.get("normalRangeMax"),u=o+e.round(r-r*((l-this.miny)/a)),c=e.round(r*(l-s)/a);this.target.drawRect(t,u,i,c,n,this.options.get("normalRangeColor")).append()},render:function(){var t,r,i,a,s,l,u,c,f,h,p,d,g,m,v,C,b,T,x,S,A,I,R,k,M=this.options,N=this.target,E=this.canvasWidth,D=this.canvasHeight,O=this.vertices,j=M.get("spotRadius"),F=this.regionMap;if(w._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),I=this.xvalues,R=this.yvalues,this.yminmax.length&&!(this.yvalues.length<2))){for(a=s=0,t=this.maxx-this.minx==0?1:this.maxx-this.minx,r=this.maxy-this.miny==0?1:this.maxy-this.miny,i=this.yvalues.length-1,j&&(E<4*j||D<4*j)&&(j=0),j&&(((S=M.get("highlightSpotColor")&&!M.get("disableInteraction"))||M.get("minSpotColor")||M.get("spotColor")&&R[i]===this.miny)&&(D-=e.ceil(j)),(S||M.get("maxSpotColor")||M.get("spotColor")&&R[i]===this.maxy)&&(D-=e.ceil(j),a+=e.ceil(j)),(S||(M.get("minSpotColor")||M.get("maxSpotColor"))&&(R[0]===this.miny||R[0]===this.maxy))&&(s+=e.ceil(j),E-=e.ceil(j)),(S||M.get("spotColor")||M.get("minSpotColor")||M.get("maxSpotColor")&&(R[i]===this.miny||R[i]===this.maxy))&&(E-=e.ceil(j))),D--,M.get("normalRangeMin")!==n&&!M.get("drawNormalOnTop")&&this.drawNormalRange(s,a,D,E,r),c=[u=[]],g=m=null,v=R.length,k=0;k<v;k++)f=I[k],p=I[k+1],h=R[k],m=(d=s+e.round((f-this.minx)*(E/t)))+((k<v-1?s+e.round((p-this.minx)*(E/t)):E)-d)/2,F[k]=[g||0,m,k],g=m,null===h?k&&(null!==R[k-1]&&(u=[],c.push(u)),O.push(null)):(h<this.miny&&(h=this.miny),h>this.maxy&&(h=this.maxy),u.length||u.push([d,a+D]),l=[d,a+e.round(D-D*((h-this.miny)/r))],u.push(l),O.push(l));for(C=[],b=[],T=c.length,k=0;k<T;k++)(u=c[k]).length&&(M.get("fillColor")&&(u.push([u[u.length-1][0],a+D]),b.push(u.slice(0)),u.pop()),u.length>2&&(u[0]=[u[0][0],u[1][1]]),C.push(u));for(T=b.length,k=0;k<T;k++)N.drawShape(b[k],M.get("fillColor"),M.get("fillColor")).append();for(M.get("normalRangeMin")!==n&&M.get("drawNormalOnTop")&&this.drawNormalRange(s,a,D,E,r),T=C.length,k=0;k<T;k++)N.drawShape(C[k],M.get("lineColor"),n,M.get("lineWidth")).append();if(j&&M.get("valueSpots"))for((x=M.get("valueSpots")).get===n&&(x=new y(x)),k=0;k<v;k++)(A=x.get(R[k]))&&N.drawCircle(s+e.round((I[k]-this.minx)*(E/t)),a+e.round(D-D*((R[k]-this.miny)/r)),j,n,A).append();j&&M.get("spotColor")&&null!==R[i]&&N.drawCircle(s+e.round((I[I.length-1]-this.minx)*(E/t)),a+e.round(D-D*((R[i]-this.miny)/r)),j,n,M.get("spotColor")).append(),this.maxy!==this.minyorg&&(j&&M.get("minSpotColor")&&(f=I[o.inArray(this.minyorg,R)],N.drawCircle(s+e.round((f-this.minx)*(E/t)),a+e.round(D-D*((this.minyorg-this.miny)/r)),j,n,M.get("minSpotColor")).append()),j&&M.get("maxSpotColor")&&(f=I[o.inArray(this.maxyorg,R)],N.drawCircle(s+e.round((f-this.minx)*(E/t)),a+e.round(D-D*((this.maxyorg-this.miny)/r)),j,n,M.get("maxSpotColor")).append())),this.lastShapeId=N.getLastShapeId(),this.canvasTop=a,N.render()}}}),o.fn.sparkline.bar=T=i(o.fn.sparkline._base,b,{type:"bar",init:function(t,r,i,a,l){var h,p,d,g,m,v,C,b,w,x,S,A,I,R,k,M,N,E,D,O,j,F=parseInt(i.get("barWidth"),10),P=parseInt(i.get("barSpacing"),10),_=i.get("chartRangeMin"),L=i.get("chartRangeMax"),B=i.get("chartRangeClip"),G=1/0,H=-1/0;for(T._super.init.call(this,t,r,i,a,l),v=0,C=r.length;v<C;v++)((h="string"==typeof(O=r[v])&&O.indexOf(":")>-1)||o.isArray(O))&&(k=!0,h&&(O=r[v]=c(O.split(":"))),O=f(O,null),(p=e.min.apply(e,O))<G&&(G=p),(d=e.max.apply(e,O))>H&&(H=d));this.stacked=k,this.regionShapes={},this.barWidth=F,this.barSpacing=P,this.totalBarWidth=F+P,this.width=a=r.length*F+(r.length-1)*P,this.initTarget(),B&&(I=_===n?-1/0:_,R=L===n?1/0:L),m=[],g=k?[]:m;var V=[],z=[];for(v=0,C=r.length;v<C;v++)if(k)for(M=r[v],r[v]=D=[],V[v]=0,g[v]=z[v]=0,N=0,E=M.length;N<E;N++)null!==(O=D[N]=B?s(M[N],I,R):M[N])&&(O>0&&(V[v]+=O),G<0&&H>0?O<0?z[v]+=e.abs(O):g[v]+=O:g[v]+=e.abs(O-(O<0?H:G)),m.push(O));else O=B?s(r[v],I,R):r[v],null!==(O=r[v]=u(O))&&m.push(O);this.max=A=e.max.apply(e,m),this.min=S=e.min.apply(e,m),this.stackMax=H=k?e.max.apply(e,V):A,this.stackMin=G=k?e.min.apply(e,m):S,i.get("chartRangeMin")!==n&&(i.get("chartRangeClip")||i.get("chartRangeMin")<S)&&(S=i.get("chartRangeMin")),i.get("chartRangeMax")!==n&&(i.get("chartRangeClip")||i.get("chartRangeMax")>A)&&(A=i.get("chartRangeMax")),this.zeroAxis=w=i.get("zeroAxis",!0),x=S<=0&&A>=0&&w?0:0==w||S>0?S:A,this.xaxisOffset=x,b=k?e.max.apply(e,g)+e.max.apply(e,z):A-S,this.canvasHeightEf=w&&S<0?this.canvasHeight-2:this.canvasHeight-1,S<x?(j=((k&&A>=0?H:A)-x)/b*this.canvasHeight)!==e.ceil(j)&&(this.canvasHeightEf-=2,j=e.ceil(j)):j=this.canvasHeight,this.yoffset=j,o.isArray(i.get("colorMap"))?(this.colorMapByIndex=i.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=i.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===n&&(this.colorMapByValue=new y(this.colorMapByValue))),this.range=b},getRegion:function(t,o,r){var i=e.floor(o/this.totalBarWidth);return i<0||i>=this.values.length?n:i},getCurrentRegionFields:function(){var t,e,n=this.currentRegion,o=g(this.values[n]),r=[];for(e=o.length;e--;)t=o[e],r.push({isNull:null===t,value:t,color:this.calcColor(e,t,n),offset:n});return r},calcColor:function(t,e,r){var i,a,s=this.colorMapByIndex,l=this.colorMapByValue,u=this.options;return i=this.stacked?u.get("stackedBarColor"):e<0?u.get("negBarColor"):u.get("barColor"),0===e&&u.get("zeroColor")!==n&&(i=u.get("zeroColor")),l&&(a=l.get(e))?i=a:s&&s.length>r&&(i=s[r]),o.isArray(i)?i[t%i.length]:i},renderRegion:function(t,r){var i,a,s,l,u,c,f,h,d,g,m=this.values[t],y=this.options,v=this.xaxisOffset,C=[],b=this.range,w=this.stacked,T=this.target,x=t*this.totalBarWidth,S=this.canvasHeightEf,A=this.yoffset;if(f=(m=o.isArray(m)?m:[m]).length,h=m[0],l=p(null,m),g=p(v,m,!0),l)return y.get("nullColor")?(s=r?y.get("nullColor"):this.calcHighlightColor(y.get("nullColor"),y),i=A>0?A-1:A,T.drawRect(x,i,this.barWidth-1,0,s,s)):n;for(u=A,c=0;c<f;c++){if(h=m[c],w&&h===v){if(!g||d)continue;d=!0}a=b>0?e.floor(S*(e.abs(h-v)/b))+1:1,h<v||h===v&&0===A?(i=u,u+=a):(i=A-a,A-=a),s=this.calcColor(c,h,t),r&&(s=this.calcHighlightColor(s,y)),C.push(T.drawRect(x,i,this.barWidth-1,a-1,s,s))}return 1===C.length?C[0]:C}}),o.fn.sparkline.tristate=x=i(o.fn.sparkline._base,b,{type:"tristate",init:function(t,e,r,i,a){var s=parseInt(r.get("barWidth"),10),l=parseInt(r.get("barSpacing"),10);x._super.init.call(this,t,e,r,i,a),this.regionShapes={},this.barWidth=s,this.barSpacing=l,this.totalBarWidth=s+l,this.values=o.map(e,Number),this.width=i=e.length*s+(e.length-1)*l,o.isArray(r.get("colorMap"))?(this.colorMapByIndex=r.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=r.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===n&&(this.colorMapByValue=new y(this.colorMapByValue))),this.initTarget()},getRegion:function(t,n,o){return e.floor(n/this.totalBarWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===n,value:this.values[t],color:this.calcColor(this.values[t],t),offset:t}},calcColor:function(t,e){var n,o=this.values,r=this.options,i=this.colorMapByIndex,a=this.colorMapByValue;return a&&(n=a.get(t))?n:i&&i.length>e?i[e]:o[e]<0?r.get("negBarColor"):o[e]>0?r.get("posBarColor"):r.get("zeroBarColor")},renderRegion:function(t,n){var o,r,i,a,s,l,u=this.values,c=this.options,f=this.target;if(o=f.pixelHeight,i=e.round(o/2),a=t*this.totalBarWidth,u[t]<0?(s=i,r=i-1):u[t]>0?(s=0,r=i-1):(s=i-1,r=2),null!==(l=this.calcColor(u[t],t)))return n&&(l=this.calcHighlightColor(l,c)),f.drawRect(a,s,this.barWidth-1,r-1,l,l)}}),o.fn.sparkline.discrete=S=i(o.fn.sparkline._base,b,{type:"discrete",init:function(t,r,i,a,s){S._super.init.call(this,t,r,i,a,s),this.regionShapes={},this.values=r=o.map(r,Number),this.min=e.min.apply(e,r),this.max=e.max.apply(e,r),this.range=this.max-this.min,this.width=a="auto"===i.get("width")?2*r.length:this.width,this.interval=e.floor(a/r.length),this.itemWidth=a/r.length,i.get("chartRangeMin")!==n&&(i.get("chartRangeClip")||i.get("chartRangeMin")<this.min)&&(this.min=i.get("chartRangeMin")),i.get("chartRangeMax")!==n&&(i.get("chartRangeClip")||i.get("chartRangeMax")>this.max)&&(this.max=i.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight="auto"===i.get("lineHeight")?e.round(.3*this.canvasHeight):i.get("lineHeight"))},getRegion:function(t,n,o){return e.floor(n/this.itemWidth)},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===n,value:this.values[t],offset:t}},renderRegion:function(t,n){var o,r,i,a,l=this.values,u=this.options,c=this.min,f=this.max,h=this.range,p=this.interval,d=this.target,g=this.canvasHeight,m=this.lineHeight,y=g-m;return r=s(l[t],c,f),a=t*p,o=e.round(y-y*((r-c)/h)),i=u.get("thresholdColor")&&r<u.get("thresholdValue")?u.get("thresholdColor"):u.get("lineColor"),n&&(i=this.calcHighlightColor(i,u)),d.drawLine(a,o,a,o+m,i)}}),o.fn.sparkline.bullet=A=i(o.fn.sparkline._base,{type:"bullet",init:function(t,o,r,i,a){var s,l,u;A._super.init.call(this,t,o,r,i,a),this.values=o=c(o),(u=o.slice())[0]=null===u[0]?u[2]:u[0],u[1]=null===o[1]?u[2]:u[1],s=e.min.apply(e,o),l=e.max.apply(e,o),s=r.get("base")===n?s<0?s:0:r.get("base"),this.min=s,this.max=l,this.range=l-s,this.shapes={},this.valueShapes={},this.regiondata={},this.width=i="auto"===r.get("width")?"4.0em":i,this.target=this.$el.simpledraw(i,a,r.get("composite")),o.length||(this.disabled=!0),this.initTarget()},getRegion:function(t,e,o){var r=this.target.getShapeAt(t,e,o);return r!==n&&this.shapes[r]!==n?this.shapes[r]:n},getCurrentRegionFields:function(){var t=this.currentRegion;return{fieldkey:t.substr(0,1),value:this.values[t.substr(1)],region:t}},changeHighlight:function(t){var e,n=this.currentRegion,o=this.valueShapes[n];switch(delete this.shapes[o],n.substr(0,1)){case"r":e=this.renderRange(n.substr(1),t);break;case"p":e=this.renderPerformance(t);break;case"t":e=this.renderTarget(t)}this.valueShapes[n]=e.id,this.shapes[e.id]=n,this.target.replaceWithShape(o,e)},renderRange:function(t,n){var o=this.values[t],r=e.round(this.canvasWidth*((o-this.min)/this.range)),i=this.options.get("rangeColors")[t-2];return n&&(i=this.calcHighlightColor(i,this.options)),this.target.drawRect(0,0,r-1,this.canvasHeight-1,i,i)},renderPerformance:function(t){var n=this.values[1],o=e.round(this.canvasWidth*((n-this.min)/this.range)),r=this.options.get("performanceColor");return t&&(r=this.calcHighlightColor(r,this.options)),this.target.drawRect(0,e.round(.3*this.canvasHeight),o-1,e.round(.4*this.canvasHeight)-1,r,r)},renderTarget:function(t){var n=this.values[0],o=e.round(this.canvasWidth*((n-this.min)/this.range)-this.options.get("targetWidth")/2),r=e.round(.1*this.canvasHeight),i=this.canvasHeight-2*r,a=this.options.get("targetColor");return t&&(a=this.calcHighlightColor(a,this.options)),this.target.drawRect(o,r,this.options.get("targetWidth")-1,i-1,a,a)},render:function(){var t,e,n=this.values.length,o=this.target;if(A._super.render.call(this)){for(t=2;t<n;t++)e=this.renderRange(t).append(),this.shapes[e.id]="r"+t,this.valueShapes["r"+t]=e.id;null!==this.values[1]&&(e=this.renderPerformance().append(),this.shapes[e.id]="p1",this.valueShapes.p1=e.id),null!==this.values[0]&&(e=this.renderTarget().append(),this.shapes[e.id]="t0",this.valueShapes.t0=e.id),o.render()}}}),o.fn.sparkline.pie=I=i(o.fn.sparkline._base,{type:"pie",init:function(t,n,r,i,a){var s,l=0;if(I._super.init.call(this,t,n,r,i,a),this.shapes={},this.valueShapes={},this.values=n=o.map(n,Number),"auto"===r.get("width")&&(this.width=this.height),n.length>0)for(s=n.length;s--;)l+=n[s];this.total=l,this.initTarget(),this.radius=e.floor(e.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(t,e,o){var r=this.target.getShapeAt(t,e,o);return r!==n&&this.shapes[r]!==n?this.shapes[r]:n},getCurrentRegionFields:function(){var t=this.currentRegion;return{isNull:this.values[t]===n,value:this.values[t],percent:this.values[t]/this.total*100,color:this.options.get("sliceColors")[t%this.options.get("sliceColors").length],offset:t}},changeHighlight:function(t){var e=this.currentRegion,n=this.renderSlice(e,t),o=this.valueShapes[e];delete this.shapes[o],this.target.replaceWithShape(o,n),this.valueShapes[e]=n.id,this.shapes[n.id]=e},renderSlice:function(t,o){var r,i,a,s,l,u=this.target,c=this.options,f=this.radius,h=c.get("borderWidth"),p=c.get("offset"),d=2*e.PI,g=this.values,m=this.total,y=p?2*e.PI*(p/360):0;for(s=g.length,a=0;a<s;a++){if(r=y,i=y,m>0&&(i=y+d*(g[a]/m)),t===a)return l=c.get("sliceColors")[a%c.get("sliceColors").length],o&&(l=this.calcHighlightColor(l,c)),u.drawPieSlice(f,f,f-h,r,i,n,l);y=i}},render:function(){var t,o,r=this.target,i=this.values,a=this.options,s=this.radius,l=a.get("borderWidth");if(I._super.render.call(this)){for(l&&r.drawCircle(s,s,e.floor(s-l/2),a.get("borderColor"),n,l).append(),o=i.length;o--;)i[o]&&(t=this.renderSlice(o).append(),this.valueShapes[o]=t.id,this.shapes[t.id]=o);r.render()}}}),o.fn.sparkline.box=R=i(o.fn.sparkline._base,{type:"box",init:function(t,e,n,r,i){R._super.init.call(this,t,e,n,r,i),this.values=o.map(e,Number),this.width="auto"===n.get("width")?"4.0em":r,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var t=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==n&&t.push({field:"lo",value:this.loutlier}),this.routlier!==n&&t.push({field:"ro",value:this.routlier}),this.lwhisker!==n&&t.push({field:"lw",value:this.lwhisker}),this.rwhisker!==n&&t.push({field:"rw",value:this.rwhisker}),t},render:function(){var t,o,r,i,a,s,u,c,f,h,p,d=this.target,g=this.values,m=g.length,y=this.options,v=this.canvasWidth,C=this.canvasHeight,b=y.get("chartRangeMin")===n?e.min.apply(e,g):y.get("chartRangeMin"),w=y.get("chartRangeMax")===n?e.max.apply(e,g):y.get("chartRangeMax"),T=0;if(R._super.render.call(this)){if(y.get("raw"))y.get("showOutliers")&&g.length>5?(o=g[0],t=g[1],i=g[2],a=g[3],s=g[4],u=g[5],c=g[6]):(t=g[0],i=g[1],a=g[2],s=g[3],u=g[4]);else if(g.sort((function(t,e){return t-e})),i=l(g,1),a=l(g,2),r=(s=l(g,3))-i,y.get("showOutliers")){for(t=u=n,f=0;f<m;f++)t===n&&g[f]>i-r*y.get("outlierIQR")&&(t=g[f]),g[f]<s+r*y.get("outlierIQR")&&(u=g[f]);o=g[0],c=g[m-1]}else t=g[0],u=g[m-1];this.quartiles=[i,a,s],this.lwhisker=t,this.rwhisker=u,this.loutlier=o,this.routlier=c,p=v/(w-b+1),y.get("showOutliers")&&(T=e.ceil(y.get("spotRadius")),p=(v-=2*e.ceil(y.get("spotRadius")))/(w-b+1),o<t&&d.drawCircle((o-b)*p+T,C/2,y.get("spotRadius"),y.get("outlierLineColor"),y.get("outlierFillColor")).append(),c>u&&d.drawCircle((c-b)*p+T,C/2,y.get("spotRadius"),y.get("outlierLineColor"),y.get("outlierFillColor")).append()),d.drawRect(e.round((i-b)*p+T),e.round(.1*C),e.round((s-i)*p),e.round(.8*C),y.get("boxLineColor"),y.get("boxFillColor")).append(),d.drawLine(e.round((t-b)*p+T),e.round(C/2),e.round((i-b)*p+T),e.round(C/2),y.get("lineColor")).append(),d.drawLine(e.round((t-b)*p+T),e.round(C/4),e.round((t-b)*p+T),e.round(C-C/4),y.get("whiskerColor")).append(),d.drawLine(e.round((u-b)*p+T),e.round(C/2),e.round((s-b)*p+T),e.round(C/2),y.get("lineColor")).append(),d.drawLine(e.round((u-b)*p+T),e.round(C/4),e.round((u-b)*p+T),e.round(C-C/4),y.get("whiskerColor")).append(),d.drawLine(e.round((a-b)*p+T),e.round(.1*C),e.round((a-b)*p+T),e.round(.9*C),y.get("medianColor")).append(),y.get("target")&&(h=e.ceil(y.get("spotRadius")),d.drawLine(e.round((y.get("target")-b)*p+T),e.round(C/2-h),e.round((y.get("target")-b)*p+T),e.round(C/2+h),y.get("targetColor")).append(),d.drawLine(e.round((y.get("target")-b)*p+T-h),e.round(C/2),e.round((y.get("target")-b)*p+T+h),e.round(C/2),y.get("targetColor")).append()),d.render()}}}),k=i({init:function(t,e,n,o){this.target=t,this.id=e,this.type=n,this.args=o},append:function(){return this.target.appendShape(this),this}}),M=i({_pxregex:/(\d+)(px)?\s*$/i,init:function(t,e,n){t&&(this.width=t,this.height=e,this.target=n,this.lastShapeId=null,n[0]&&(n=n[0]),o.data(n,"_jqs_vcanvas",this))},drawLine:function(t,e,n,o,r,i){return this.drawShape([[t,e],[n,o]],r,i)},drawShape:function(t,e,n,o){return this._genShape("Shape",[t,e,n,o])},drawCircle:function(t,e,n,o,r,i){return this._genShape("Circle",[t,e,n,o,r,i])},drawPieSlice:function(t,e,n,o,r,i,a){return this._genShape("PieSlice",[t,e,n,o,r,i,a])},drawRect:function(t,e,n,o,r,i){return this._genShape("Rect",[t,e,n,o,r,i])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(t,e){o(e).html(t)},_calculatePixelDims:function(t,e,n){var r;r=this._pxregex.exec(e),this.pixelHeight=r?r[1]:o(n).height(),r=this._pxregex.exec(t),this.pixelWidth=r?r[1]:o(n).width()},_genShape:function(t,e){var n=j++;return e.unshift(n),new k(this,n,t,e)},appendShape:function(t){alert("appendShape not implemented")},replaceWithShape:function(t,e){alert("replaceWithShape not implemented")},insertAfterShape:function(t,e){alert("insertAfterShape not implemented")},removeShapeId:function(t){alert("removeShapeId not implemented")},getShapeAt:function(t,e,n){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),N=i(M,{init:function(e,r,i,a){N._super.init.call(this,e,r,i),this.canvas=t.createElement("canvas"),i[0]&&(i=i[0]),o.data(i,"_jqs_vcanvas",this),o(this.canvas).css({display:"inline-block",width:e,height:r,verticalAlign:"top"}),this._insert(this.canvas,i),this._calculatePixelDims(e,r,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=a,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=n,o(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(t,e,o){var r=this.canvas.getContext("2d");return t!==n&&(r.strokeStyle=t),r.lineWidth=o===n?1:o,e!==n&&(r.fillStyle=e),r},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=n},_drawShape:function(t,e,o,r,i){var a,s,l=this._getContext(o,r,i);for(l.beginPath(),l.moveTo(e[0][0]+.5,e[0][1]+.5),a=1,s=e.length;a<s;a++)l.lineTo(e[a][0]+.5,e[a][1]+.5);o!==n&&l.stroke(),r!==n&&l.fill(),this.targetX!==n&&this.targetY!==n&&l.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawCircle:function(t,o,r,i,a,s,l){var u=this._getContext(a,s,l);u.beginPath(),u.arc(o,r,i,0,2*e.PI,!1),this.targetX!==n&&this.targetY!==n&&u.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t),a!==n&&u.stroke(),s!==n&&u.fill()},_drawPieSlice:function(t,e,o,r,i,a,s,l){var u=this._getContext(s,l);u.beginPath(),u.moveTo(e,o),u.arc(e,o,r,i,a,!1),u.lineTo(e,o),u.closePath(),s!==n&&u.stroke(),l&&u.fill(),this.targetX!==n&&this.targetY!==n&&u.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=t)},_drawRect:function(t,e,n,o,r,i,a){return this._drawShape(t,[[e,n],[e+o,n],[e+o,n+r],[e,n+r],[e,n]],i,a)},appendShape:function(t){return this.shapes[t.id]=t,this.shapeseq.push(t.id),this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var n,o=this.shapeseq;for(this.shapes[e.id]=e,n=o.length;n--;)o[n]==t&&(o[n]=e.id);delete this.shapes[t]},replaceWithShapes:function(t,e){var n,o,r,i=this.shapeseq,a={};for(o=t.length;o--;)a[t[o]]=!0;for(o=i.length;o--;)a[n=i[o]]&&(i.splice(o,1),delete this.shapes[n],r=o);for(o=e.length;o--;)i.splice(r,0,e[o].id),this.shapes[e[o].id]=e[o]},insertAfterShape:function(t,e){var n,o=this.shapeseq;for(n=o.length;n--;)if(o[n]===t)return o.splice(n+1,0,e.id),void(this.shapes[e.id]=e)},removeShapeId:function(t){var e,n=this.shapeseq;for(e=n.length;e--;)if(n[e]===t){n.splice(e,1);break}delete this.shapes[t]},getShapeAt:function(t,e,n){return this.targetX=e,this.targetY=n,this.render(),this.currentTargetShapeId},render:function(){var t,e,n=this.shapeseq,o=this.shapes,r=n.length;for(this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight),e=0;e<r;e++)this["_draw"+(t=o[n[e]]).type].apply(this,t.args);this.interact||(this.shapes={},this.shapeseq=[])}}),E=i(M,{init:function(e,n,r){var i;E._super.init.call(this,e,n,r),r[0]&&(r=r[0]),o.data(r,"_jqs_vcanvas",this),this.canvas=t.createElement("span"),o(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:e,height:n,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,r),this._calculatePixelDims(e,n,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,i='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",i),this.group=o(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(t,e,o,r,i){var a,s,l,u,c,f,h=[];for(f=0,c=e.length;f<c;f++)h[f]=e[f][0]+","+e[f][1];return a=h.splice(0,1),i=i===n?1:i,s=o===n?' stroked="false" ':' strokeWeight="'+i+'px" strokeColor="'+o+'" ',l=r===n?' filled="false"':' fillColor="'+r+'" filled="true" ',u=h[0]===h[h.length-1]?"x ":"",'<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+s+l+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+a+" l "+h.join(", ")+" "+u+'e"> </v:shape>'},_drawCircle:function(t,e,o,r,i,a,s){return'<v:oval  id="jqsshape'+t+'" '+(i===n?' stroked="false" ':' strokeWeight="'+s+'px" strokeColor="'+i+'" ')+(a===n?' filled="false"':' fillColor="'+a+'" filled="true" ')+' style="position:absolute;top:'+(o-=r)+"px; left:"+(e-=r)+"px; width:"+2*r+"px; height:"+2*r+'px"></v:oval>'},_drawPieSlice:function(t,o,r,i,a,s,l,u){var c,f,h,p,d,g,m;if(a===s)return"";if(s-a==2*e.PI&&(a=0,s=2*e.PI),f=o+e.round(e.cos(a)*i),h=r+e.round(e.sin(a)*i),p=o+e.round(e.cos(s)*i),d=r+e.round(e.sin(s)*i),f===p&&h===d){if(s-a<e.PI)return"";f=p=o+i,h=d=r}return f===p&&h===d&&s-a<e.PI?"":(c=[o-i,r-i,o+i,r+i,f,h,p,d],g=l===n?' stroked="false" ':' strokeWeight="1px" strokeColor="'+l+'" ',m=u===n?' filled="false"':' fillColor="'+u+'" filled="true" ','<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+t+'" '+g+m+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+o+","+r+" wa "+c.join(", ")+' x e"> </v:shape>')},_drawRect:function(t,e,n,o,r,i,a){return this._drawShape(t,[[e,n],[e,n+r],[e+o,n+r],[e+o,n],[e,n]],i,a)},reset:function(){this.group.innerHTML=""},appendShape:function(t){var e=this["_draw"+t.type].apply(this,t.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",e):this.prerender+=e,this.lastShapeId=t.id,t.id},replaceWithShape:function(t,e){var n=o("#jqsshape"+t),r=this["_draw"+e.type].apply(this,e.args);n[0].outerHTML=r},replaceWithShapes:function(t,e){var n,r=o("#jqsshape"+t[0]),i="",a=e.length;for(n=0;n<a;n++)i+=this["_draw"+e[n].type].apply(this,e[n].args);for(r[0].outerHTML=i,n=1;n<t.length;n++)o("#jqsshape"+t[n]).remove()},insertAfterShape:function(t,e){var n=o("#jqsshape"+t),r=this["_draw"+e.type].apply(this,e.args);n[0].insertAdjacentHTML("afterEnd",r)},removeShapeId:function(t){var e=o("#jqsshape"+t);this.group.removeChild(e[0])},getShapeAt:function(t,e,n){return t.id.substr(8)},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})}))}(document,Math),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("jquery"),require("popper.js")):"function"==typeof define&&define.amd?define(["exports","jquery","popper.js"],e):e((t=t||self).bootstrap={},t.jQuery,t.Popper)}(this,(function(t,e,n){"use strict";function o(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function r(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function a(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function s(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach((function(e){i(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e,n=n&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n;var l={TRANSITION_END:"bsTransitionEnd",getUID:function(t){do{t+=~~(1e6*Math.random())}while(document.getElementById(t));return t},getSelectorFromElement:function(t){var e=t.getAttribute("data-target");if(!e||"#"===e){var n=t.getAttribute("href");e=n&&"#"!==n?n.trim():""}try{return document.querySelector(e)?e:null}catch(t){return null}},getTransitionDurationFromElement:function(t){if(!t)return 0;var n=e(t).css("transition-duration"),o=e(t).css("transition-delay"),r=parseFloat(n),i=parseFloat(o);return r||i?(n=n.split(",")[0],o=o.split(",")[0],1e3*(parseFloat(n)+parseFloat(o))):0},reflow:function(t){return t.offsetHeight},triggerTransitionEnd:function(t){e(t).trigger("transitionend")},supportsTransitionEnd:function(){return Boolean("transitionend")},isElement:function(t){return(t[0]||t).nodeType},typeCheckConfig:function(t,e,n){for(var o in n)if(Object.prototype.hasOwnProperty.call(n,o)){var r=n[o],i=e[o],a=i&&l.isElement(i)?"element":null===(s=i)||void 0===s?""+s:{}.toString.call(s).match(/\s([a-z]+)/i)[1].toLowerCase();if(!new RegExp(r).test(a))throw new Error(t.toUpperCase()+': Option "'+o+'" provided type "'+a+'" but expected type "'+r+'".')}var s},findShadowRoot:function(t){if(!document.documentElement.attachShadow)return null;if("function"==typeof t.getRootNode){var e=t.getRootNode();return e instanceof ShadowRoot?e:null}return t instanceof ShadowRoot?t:t.parentNode?l.findShadowRoot(t.parentNode):null},jQueryDetection:function(){if(void 0===e)throw new TypeError("Bootstrap's JavaScript requires jQuery. jQuery must be included before Bootstrap's JavaScript.");var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1===t[0]&&9===t[1]&&t[2]<1||t[0]>=4)throw new Error("Bootstrap's JavaScript requires at least jQuery v1.9.1 but less than v4.0.0")}};l.jQueryDetection(),e.fn.emulateTransitionEnd=function(t){var n=this,o=!1;return e(this).one(l.TRANSITION_END,(function(){o=!0})),setTimeout((function(){o||l.triggerTransitionEnd(n)}),t),this},e.event.special[l.TRANSITION_END]={bindType:"transitionend",delegateType:"transitionend",handle:function(t){if(e(t.target).is(this))return t.handleObj.handler.apply(this,arguments)}};var u="alert",c=e.fn[u],f=function(){function t(t){this._element=t}var n=t.prototype;return n.close=function(t){var e=this._element;t&&(e=this._getRootElement(t)),this._triggerCloseEvent(e).isDefaultPrevented()||this._removeElement(e)},n.dispose=function(){e.removeData(this._element,"bs.alert"),this._element=null},n._getRootElement=function(t){var n=l.getSelectorFromElement(t),o=!1;return n&&(o=document.querySelector(n)),o||(o=e(t).closest(".alert")[0]),o},n._triggerCloseEvent=function(t){var n=e.Event("close.bs.alert");return e(t).trigger(n),n},n._removeElement=function(t){var n=this;if(e(t).removeClass("show"),e(t).hasClass("fade")){var o=l.getTransitionDurationFromElement(t);e(t).one(l.TRANSITION_END,(function(e){return n._destroyElement(t,e)})).emulateTransitionEnd(o)}else this._destroyElement(t)},n._destroyElement=function(t){e(t).detach().trigger("closed.bs.alert").remove()},t._jQueryInterface=function(n){return this.each((function(){var o=e(this),r=o.data("bs.alert");r||(r=new t(this),o.data("bs.alert",r)),"close"===n&&r[n](this)}))},t._handleDismiss=function(t){return function(e){e&&e.preventDefault(),t.close(this)}},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}}]),t}();e(document).on("click.bs.alert.data-api",'[data-dismiss="alert"]',f._handleDismiss(new f)),e.fn[u]=f._jQueryInterface,e.fn[u].Constructor=f,e.fn[u].noConflict=function(){return e.fn[u]=c,f._jQueryInterface};var h=e.fn.button,p=function(){function t(t){this._element=t}var n=t.prototype;return n.toggle=function(){var t=!0,n=!0,o=e(this._element).closest('[data-toggle="buttons"]')[0];if(o){var r=this._element.querySelector('input:not([type="hidden"])');if(r){if("radio"===r.type)if(r.checked&&this._element.classList.contains("active"))t=!1;else{var i=o.querySelector(".active");i&&e(i).removeClass("active")}t&&("checkbox"!==r.type&&"radio"!==r.type||(r.checked=!this._element.classList.contains("active")),e(r).trigger("change")),r.focus(),n=!1}}this._element.hasAttribute("disabled")||this._element.classList.contains("disabled")||(n&&this._element.setAttribute("aria-pressed",!this._element.classList.contains("active")),t&&e(this._element).toggleClass("active"))},n.dispose=function(){e.removeData(this._element,"bs.button"),this._element=null},t._jQueryInterface=function(n){return this.each((function(){var o=e(this).data("bs.button");o||(o=new t(this),e(this).data("bs.button",o)),"toggle"===n&&o[n]()}))},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}}]),t}();e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',(function(t){var n=t.target,o=n;if(e(n).hasClass("btn")||(n=e(n).closest(".btn")[0]),!n||n.hasAttribute("disabled")||n.classList.contains("disabled"))t.preventDefault();else{var r=n.querySelector('input:not([type="hidden"])');if(r&&(r.hasAttribute("disabled")||r.classList.contains("disabled")))return void t.preventDefault();"LABEL"===o.tagName&&r&&"checkbox"===r.type&&t.preventDefault(),p._jQueryInterface.call(e(n),"toggle")}})).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',(function(t){var n=e(t.target).closest(".btn")[0];e(n).toggleClass("focus",/^focus(in)?$/.test(t.type))})),e(window).on("load.bs.button.data-api",(function(){for(var t=[].slice.call(document.querySelectorAll('[data-toggle="buttons"] .btn')),e=0,n=t.length;e<n;e++){var o=t[e],r=o.querySelector('input:not([type="hidden"])');r.checked||r.hasAttribute("checked")?o.classList.add("active"):o.classList.remove("active")}for(var i=0,a=(t=[].slice.call(document.querySelectorAll('[data-toggle="button"]'))).length;i<a;i++){var s=t[i];"true"===s.getAttribute("aria-pressed")?s.classList.add("active"):s.classList.remove("active")}})),e.fn.button=p._jQueryInterface,e.fn.button.Constructor=p,e.fn.button.noConflict=function(){return e.fn.button=h,p._jQueryInterface};var d="carousel",g=e.fn[d],m={interval:5e3,keyboard:!0,slide:!1,pause:"hover",wrap:!0,touch:!0},y={interval:"(number|boolean)",keyboard:"boolean",slide:"(boolean|string)",pause:"(string|boolean)",wrap:"boolean",touch:"boolean"},v={TOUCH:"touch",PEN:"pen"},C=function(){function t(t,e){this._items=null,this._interval=null,this._activeElement=null,this._isPaused=!1,this._isSliding=!1,this.touchTimeout=null,this.touchStartX=0,this.touchDeltaX=0,this._config=this._getConfig(e),this._element=t,this._indicatorsElement=this._element.querySelector(".carousel-indicators"),this._touchSupported="ontouchstart"in document.documentElement||navigator.maxTouchPoints>0,this._pointerEvent=Boolean(window.PointerEvent||window.MSPointerEvent),this._addEventListeners()}var n=t.prototype;return n.next=function(){this._isSliding||this._slide("next")},n.nextWhenVisible=function(){!document.hidden&&e(this._element).is(":visible")&&"hidden"!==e(this._element).css("visibility")&&this.next()},n.prev=function(){this._isSliding||this._slide("prev")},n.pause=function(t){t||(this._isPaused=!0),this._element.querySelector(".carousel-item-next, .carousel-item-prev")&&(l.triggerTransitionEnd(this._element),this.cycle(!0)),clearInterval(this._interval),this._interval=null},n.cycle=function(t){t||(this._isPaused=!1),this._interval&&(clearInterval(this._interval),this._interval=null),this._config.interval&&!this._isPaused&&(this._interval=setInterval((document.visibilityState?this.nextWhenVisible:this.next).bind(this),this._config.interval))},n.to=function(t){var n=this;this._activeElement=this._element.querySelector(".active.carousel-item");var o=this._getItemIndex(this._activeElement);if(!(t>this._items.length-1||t<0))if(this._isSliding)e(this._element).one("slid.bs.carousel",(function(){return n.to(t)}));else{if(o===t)return this.pause(),void this.cycle();var r=t>o?"next":"prev";this._slide(r,this._items[t])}},n.dispose=function(){e(this._element).off(".bs.carousel"),e.removeData(this._element,"bs.carousel"),this._items=null,this._config=null,this._element=null,this._interval=null,this._isPaused=null,this._isSliding=null,this._activeElement=null,this._indicatorsElement=null},n._getConfig=function(t){return t=s(s({},m),t),l.typeCheckConfig(d,t,y),t},n._handleSwipe=function(){var t=Math.abs(this.touchDeltaX);if(!(t<=40)){var e=t/this.touchDeltaX;this.touchDeltaX=0,e>0&&this.prev(),e<0&&this.next()}},n._addEventListeners=function(){var t=this;this._config.keyboard&&e(this._element).on("keydown.bs.carousel",(function(e){return t._keydown(e)})),"hover"===this._config.pause&&e(this._element).on("mouseenter.bs.carousel",(function(e){return t.pause(e)})).on("mouseleave.bs.carousel",(function(e){return t.cycle(e)})),this._config.touch&&this._addTouchEventListeners()},n._addTouchEventListeners=function(){var t=this;if(this._touchSupported){var n=function(e){t._pointerEvent&&v[e.originalEvent.pointerType.toUpperCase()]?t.touchStartX=e.originalEvent.clientX:t._pointerEvent||(t.touchStartX=e.originalEvent.touches[0].clientX)},o=function(e){t._pointerEvent&&v[e.originalEvent.pointerType.toUpperCase()]&&(t.touchDeltaX=e.originalEvent.clientX-t.touchStartX),t._handleSwipe(),"hover"===t._config.pause&&(t.pause(),t.touchTimeout&&clearTimeout(t.touchTimeout),t.touchTimeout=setTimeout((function(e){return t.cycle(e)}),500+t._config.interval))};e(this._element.querySelectorAll(".carousel-item img")).on("dragstart.bs.carousel",(function(t){return t.preventDefault()})),this._pointerEvent?(e(this._element).on("pointerdown.bs.carousel",(function(t){return n(t)})),e(this._element).on("pointerup.bs.carousel",(function(t){return o(t)})),this._element.classList.add("pointer-event")):(e(this._element).on("touchstart.bs.carousel",(function(t){return n(t)})),e(this._element).on("touchmove.bs.carousel",(function(e){return function(e){e.originalEvent.touches&&e.originalEvent.touches.length>1?t.touchDeltaX=0:t.touchDeltaX=e.originalEvent.touches[0].clientX-t.touchStartX}(e)})),e(this._element).on("touchend.bs.carousel",(function(t){return o(t)})))}},n._keydown=function(t){if(!/input|textarea/i.test(t.target.tagName))switch(t.which){case 37:t.preventDefault(),this.prev();break;case 39:t.preventDefault(),this.next()}},n._getItemIndex=function(t){return this._items=t&&t.parentNode?[].slice.call(t.parentNode.querySelectorAll(".carousel-item")):[],this._items.indexOf(t)},n._getItemByDirection=function(t,e){var n="next"===t,o="prev"===t,r=this._getItemIndex(e),i=this._items.length-1;if((o&&0===r||n&&r===i)&&!this._config.wrap)return e;var a=(r+("prev"===t?-1:1))%this._items.length;return-1===a?this._items[this._items.length-1]:this._items[a]},n._triggerSlideEvent=function(t,n){var o=this._getItemIndex(t),r=this._getItemIndex(this._element.querySelector(".active.carousel-item")),i=e.Event("slide.bs.carousel",{relatedTarget:t,direction:n,from:r,to:o});return e(this._element).trigger(i),i},n._setActiveIndicatorElement=function(t){if(this._indicatorsElement){var n=[].slice.call(this._indicatorsElement.querySelectorAll(".active"));e(n).removeClass("active");var o=this._indicatorsElement.children[this._getItemIndex(t)];o&&e(o).addClass("active")}},n._slide=function(t,n){var o,r,i,a=this,s=this._element.querySelector(".active.carousel-item"),u=this._getItemIndex(s),c=n||s&&this._getItemByDirection(t,s),f=this._getItemIndex(c),h=Boolean(this._interval);if("next"===t?(o="carousel-item-left",r="carousel-item-next",i="left"):(o="carousel-item-right",r="carousel-item-prev",i="right"),c&&e(c).hasClass("active"))this._isSliding=!1;else if(!this._triggerSlideEvent(c,i).isDefaultPrevented()&&s&&c){this._isSliding=!0,h&&this.pause(),this._setActiveIndicatorElement(c);var p=e.Event("slid.bs.carousel",{relatedTarget:c,direction:i,from:u,to:f});if(e(this._element).hasClass("slide")){e(c).addClass(r),l.reflow(c),e(s).addClass(o),e(c).addClass(o);var d=parseInt(c.getAttribute("data-interval"),10);d?(this._config.defaultInterval=this._config.defaultInterval||this._config.interval,this._config.interval=d):this._config.interval=this._config.defaultInterval||this._config.interval;var g=l.getTransitionDurationFromElement(s);e(s).one(l.TRANSITION_END,(function(){e(c).removeClass(o+" "+r).addClass("active"),e(s).removeClass("active "+r+" "+o),a._isSliding=!1,setTimeout((function(){return e(a._element).trigger(p)}),0)})).emulateTransitionEnd(g)}else e(s).removeClass("active"),e(c).addClass("active"),this._isSliding=!1,e(this._element).trigger(p);h&&this.cycle()}},t._jQueryInterface=function(n){return this.each((function(){var o=e(this).data("bs.carousel"),r=s(s({},m),e(this).data());"object"==typeof n&&(r=s(s({},r),n));var i="string"==typeof n?n:r.slide;if(o||(o=new t(this,r),e(this).data("bs.carousel",o)),"number"==typeof n)o.to(n);else if("string"==typeof i){if(void 0===o[i])throw new TypeError('No method named "'+i+'"');o[i]()}else r.interval&&r.ride&&(o.pause(),o.cycle())}))},t._dataApiClickHandler=function(n){var o=l.getSelectorFromElement(this);if(o){var r=e(o)[0];if(r&&e(r).hasClass("carousel")){var i=s(s({},e(r).data()),e(this).data()),a=this.getAttribute("data-slide-to");a&&(i.interval=!1),t._jQueryInterface.call(e(r),i),a&&e(r).data("bs.carousel").to(a),n.preventDefault()}}},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return m}}]),t}();e(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",C._dataApiClickHandler),e(window).on("load.bs.carousel.data-api",(function(){for(var t=[].slice.call(document.querySelectorAll('[data-ride="carousel"]')),n=0,o=t.length;n<o;n++){var r=e(t[n]);C._jQueryInterface.call(r,r.data())}})),e.fn[d]=C._jQueryInterface,e.fn[d].Constructor=C,e.fn[d].noConflict=function(){return e.fn[d]=g,C._jQueryInterface};var b="collapse",w=e.fn[b],T={toggle:!0,parent:""},x={toggle:"boolean",parent:"(string|element)"},S=function(){function t(t,e){this._isTransitioning=!1,this._element=t,this._config=this._getConfig(e),this._triggerArray=[].slice.call(document.querySelectorAll('[data-toggle="collapse"][href="#'+t.id+'"],[data-toggle="collapse"][data-target="#'+t.id+'"]'));for(var n=[].slice.call(document.querySelectorAll('[data-toggle="collapse"]')),o=0,r=n.length;o<r;o++){var i=n[o],a=l.getSelectorFromElement(i),s=[].slice.call(document.querySelectorAll(a)).filter((function(e){return e===t}));null!==a&&s.length>0&&(this._selector=a,this._triggerArray.push(i))}this._parent=this._config.parent?this._getParent():null,this._config.parent||this._addAriaAndCollapsedClass(this._element,this._triggerArray),this._config.toggle&&this.toggle()}var n=t.prototype;return n.toggle=function(){e(this._element).hasClass("show")?this.hide():this.show()},n.show=function(){var n,o,r=this;if(!(this._isTransitioning||e(this._element).hasClass("show")||(this._parent&&0===(n=[].slice.call(this._parent.querySelectorAll(".show, .collapsing")).filter((function(t){return"string"==typeof r._config.parent?t.getAttribute("data-parent")===r._config.parent:t.classList.contains("collapse")}))).length&&(n=null),n&&(o=e(n).not(this._selector).data("bs.collapse"))&&o._isTransitioning))){var i=e.Event("show.bs.collapse");if(e(this._element).trigger(i),!i.isDefaultPrevented()){n&&(t._jQueryInterface.call(e(n).not(this._selector),"hide"),o||e(n).data("bs.collapse",null));var a=this._getDimension();e(this._element).removeClass("collapse").addClass("collapsing"),this._element.style[a]=0,this._triggerArray.length&&e(this._triggerArray).removeClass("collapsed").attr("aria-expanded",!0),this.setTransitioning(!0);var s="scroll"+(a[0].toUpperCase()+a.slice(1)),u=l.getTransitionDurationFromElement(this._element);e(this._element).one(l.TRANSITION_END,(function(){e(r._element).removeClass("collapsing").addClass("collapse show"),r._element.style[a]="",r.setTransitioning(!1),e(r._element).trigger("shown.bs.collapse")})).emulateTransitionEnd(u),this._element.style[a]=this._element[s]+"px"}}},n.hide=function(){var t=this;if(!this._isTransitioning&&e(this._element).hasClass("show")){var n=e.Event("hide.bs.collapse");if(e(this._element).trigger(n),!n.isDefaultPrevented()){var o=this._getDimension();this._element.style[o]=this._element.getBoundingClientRect()[o]+"px",l.reflow(this._element),e(this._element).addClass("collapsing").removeClass("collapse show");var r=this._triggerArray.length;if(r>0)for(var i=0;i<r;i++){var a=this._triggerArray[i],s=l.getSelectorFromElement(a);null!==s&&(e([].slice.call(document.querySelectorAll(s))).hasClass("show")||e(a).addClass("collapsed").attr("aria-expanded",!1))}this.setTransitioning(!0),this._element.style[o]="";var u=l.getTransitionDurationFromElement(this._element);e(this._element).one(l.TRANSITION_END,(function(){t.setTransitioning(!1),e(t._element).removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")})).emulateTransitionEnd(u)}}},n.setTransitioning=function(t){this._isTransitioning=t},n.dispose=function(){e.removeData(this._element,"bs.collapse"),this._config=null,this._parent=null,this._element=null,this._triggerArray=null,this._isTransitioning=null},n._getConfig=function(t){return(t=s(s({},T),t)).toggle=Boolean(t.toggle),l.typeCheckConfig(b,t,x),t},n._getDimension=function(){return e(this._element).hasClass("width")?"width":"height"},n._getParent=function(){var n,o=this;l.isElement(this._config.parent)?(n=this._config.parent,void 0!==this._config.parent.jquery&&(n=this._config.parent[0])):n=document.querySelector(this._config.parent);var r='[data-toggle="collapse"][data-parent="'+this._config.parent+'"]',i=[].slice.call(n.querySelectorAll(r));return e(i).each((function(e,n){o._addAriaAndCollapsedClass(t._getTargetFromElement(n),[n])})),n},n._addAriaAndCollapsedClass=function(t,n){var o=e(t).hasClass("show");n.length&&e(n).toggleClass("collapsed",!o).attr("aria-expanded",o)},t._getTargetFromElement=function(t){var e=l.getSelectorFromElement(t);return e?document.querySelector(e):null},t._jQueryInterface=function(n){return this.each((function(){var o=e(this),r=o.data("bs.collapse"),i=s(s(s({},T),o.data()),"object"==typeof n&&n?n:{});if(!r&&i.toggle&&"string"==typeof n&&/show|hide/.test(n)&&(i.toggle=!1),r||(r=new t(this,i),o.data("bs.collapse",r)),"string"==typeof n){if(void 0===r[n])throw new TypeError('No method named "'+n+'"');r[n]()}}))},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return T}}]),t}();e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',(function(t){"A"===t.currentTarget.tagName&&t.preventDefault();var n=e(this),o=l.getSelectorFromElement(this),r=[].slice.call(document.querySelectorAll(o));e(r).each((function(){var t=e(this),o=t.data("bs.collapse")?"toggle":n.data();S._jQueryInterface.call(t,o)}))})),e.fn[b]=S._jQueryInterface,e.fn[b].Constructor=S,e.fn[b].noConflict=function(){return e.fn[b]=w,S._jQueryInterface};var A="dropdown",I=e.fn[A],R=new RegExp("38|40|27"),k={offset:0,flip:!0,boundary:"scrollParent",reference:"toggle",display:"dynamic",popperConfig:null},M={offset:"(number|string|function)",flip:"boolean",boundary:"(string|element)",reference:"(string|element)",display:"string",popperConfig:"(null|object)"},N=function(){function t(t,e){this._element=t,this._popper=null,this._config=this._getConfig(e),this._menu=this._getMenuElement(),this._inNavbar=this._detectNavbar(),this._addEventListeners()}var o=t.prototype;return o.toggle=function(){if(!this._element.disabled&&!e(this._element).hasClass("disabled")){var n=e(this._menu).hasClass("show");t._clearMenus(),n||this.show(!0)}},o.show=function(o){if(void 0===o&&(o=!1),!(this._element.disabled||e(this._element).hasClass("disabled")||e(this._menu).hasClass("show"))){var r={relatedTarget:this._element},i=e.Event("show.bs.dropdown",r),a=t._getParentFromElement(this._element);if(e(a).trigger(i),!i.isDefaultPrevented()){if(!this._inNavbar&&o){if(void 0===n)throw new TypeError("Bootstrap's dropdowns require Popper.js (https://popper.js.org/)");var s=this._element;"parent"===this._config.reference?s=a:l.isElement(this._config.reference)&&(s=this._config.reference,void 0!==this._config.reference.jquery&&(s=this._config.reference[0])),"scrollParent"!==this._config.boundary&&e(a).addClass("position-static"),this._popper=new n(s,this._menu,this._getPopperConfig())}"ontouchstart"in document.documentElement&&0===e(a).closest(".navbar-nav").length&&e(document.body).children().on("mouseover",null,e.noop),this._element.focus(),this._element.setAttribute("aria-expanded",!0),e(this._menu).toggleClass("show"),e(a).toggleClass("show").trigger(e.Event("shown.bs.dropdown",r))}}},o.hide=function(){if(!this._element.disabled&&!e(this._element).hasClass("disabled")&&e(this._menu).hasClass("show")){var n={relatedTarget:this._element},o=e.Event("hide.bs.dropdown",n),r=t._getParentFromElement(this._element);e(r).trigger(o),o.isDefaultPrevented()||(this._popper&&this._popper.destroy(),e(this._menu).toggleClass("show"),e(r).toggleClass("show").trigger(e.Event("hidden.bs.dropdown",n)))}},o.dispose=function(){e.removeData(this._element,"bs.dropdown"),e(this._element).off(".bs.dropdown"),this._element=null,this._menu=null,null!==this._popper&&(this._popper.destroy(),this._popper=null)},o.update=function(){this._inNavbar=this._detectNavbar(),null!==this._popper&&this._popper.scheduleUpdate()},o._addEventListeners=function(){var t=this;e(this._element).on("click.bs.dropdown",(function(e){e.preventDefault(),e.stopPropagation(),t.toggle()}))},o._getConfig=function(t){return t=s(s(s({},this.constructor.Default),e(this._element).data()),t),l.typeCheckConfig(A,t,this.constructor.DefaultType),t},o._getMenuElement=function(){if(!this._menu){var e=t._getParentFromElement(this._element);e&&(this._menu=e.querySelector(".dropdown-menu"))}return this._menu},o._getPlacement=function(){var t=e(this._element.parentNode),n="bottom-start";return t.hasClass("dropup")?n=e(this._menu).hasClass("dropdown-menu-right")?"top-end":"top-start":t.hasClass("dropright")?n="right-start":t.hasClass("dropleft")?n="left-start":e(this._menu).hasClass("dropdown-menu-right")&&(n="bottom-end"),n},o._detectNavbar=function(){return e(this._element).closest(".navbar").length>0},o._getOffset=function(){var t=this,e={};return"function"==typeof this._config.offset?e.fn=function(e){return e.offsets=s(s({},e.offsets),t._config.offset(e.offsets,t._element)||{}),e}:e.offset=this._config.offset,e},o._getPopperConfig=function(){var t={placement:this._getPlacement(),modifiers:{offset:this._getOffset(),flip:{enabled:this._config.flip},preventOverflow:{boundariesElement:this._config.boundary}}};return"static"===this._config.display&&(t.modifiers.applyStyle={enabled:!1}),s(s({},t),this._config.popperConfig)},t._jQueryInterface=function(n){return this.each((function(){var o=e(this).data("bs.dropdown");if(o||(o=new t(this,"object"==typeof n?n:null),e(this).data("bs.dropdown",o)),"string"==typeof n){if(void 0===o[n])throw new TypeError('No method named "'+n+'"');o[n]()}}))},t._clearMenus=function(n){if(!n||3!==n.which&&("keyup"!==n.type||9===n.which))for(var o=[].slice.call(document.querySelectorAll('[data-toggle="dropdown"]')),r=0,i=o.length;r<i;r++){var a=t._getParentFromElement(o[r]),s=e(o[r]).data("bs.dropdown"),l={relatedTarget:o[r]};if(n&&"click"===n.type&&(l.clickEvent=n),s){var u=s._menu;if(e(a).hasClass("show")&&!(n&&("click"===n.type&&/input|textarea/i.test(n.target.tagName)||"keyup"===n.type&&9===n.which)&&e.contains(a,n.target))){var c=e.Event("hide.bs.dropdown",l);e(a).trigger(c),c.isDefaultPrevented()||("ontouchstart"in document.documentElement&&e(document.body).children().off("mouseover",null,e.noop),o[r].setAttribute("aria-expanded","false"),s._popper&&s._popper.destroy(),e(u).removeClass("show"),e(a).removeClass("show").trigger(e.Event("hidden.bs.dropdown",l)))}}}},t._getParentFromElement=function(t){var e,n=l.getSelectorFromElement(t);return n&&(e=document.querySelector(n)),e||t.parentNode},t._dataApiKeydownHandler=function(n){if(!(/input|textarea/i.test(n.target.tagName)?32===n.which||27!==n.which&&(40!==n.which&&38!==n.which||e(n.target).closest(".dropdown-menu").length):!R.test(n.which))&&!this.disabled&&!e(this).hasClass("disabled")){var o=t._getParentFromElement(this),r=e(o).hasClass("show");if(r||27!==n.which){if(n.preventDefault(),n.stopPropagation(),!r||r&&(27===n.which||32===n.which))return 27===n.which&&e(o.querySelector('[data-toggle="dropdown"]')).trigger("focus"),void e(this).trigger("click");var i=[].slice.call(o.querySelectorAll(".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)")).filter((function(t){return e(t).is(":visible")}));if(0!==i.length){var a=i.indexOf(n.target);38===n.which&&a>0&&a--,40===n.which&&a<i.length-1&&a++,a<0&&(a=0),i[a].focus()}}}},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return k}},{key:"DefaultType",get:function(){return M}}]),t}();e(document).on("keydown.bs.dropdown.data-api",'[data-toggle="dropdown"]',N._dataApiKeydownHandler).on("keydown.bs.dropdown.data-api",".dropdown-menu",N._dataApiKeydownHandler).on("click.bs.dropdown.data-api keyup.bs.dropdown.data-api",N._clearMenus).on("click.bs.dropdown.data-api",'[data-toggle="dropdown"]',(function(t){t.preventDefault(),t.stopPropagation(),N._jQueryInterface.call(e(this),"toggle")})).on("click.bs.dropdown.data-api",".dropdown form",(function(t){t.stopPropagation()})),e.fn[A]=N._jQueryInterface,e.fn[A].Constructor=N,e.fn[A].noConflict=function(){return e.fn[A]=I,N._jQueryInterface};var E=e.fn.modal,D={backdrop:!0,keyboard:!0,focus:!0,show:!0},O={backdrop:"(boolean|string)",keyboard:"boolean",focus:"boolean",show:"boolean"},j=function(){function t(t,e){this._config=this._getConfig(e),this._element=t,this._dialog=t.querySelector(".modal-dialog"),this._backdrop=null,this._isShown=!1,this._isBodyOverflowing=!1,this._ignoreBackdropClick=!1,this._isTransitioning=!1,this._scrollbarWidth=0}var n=t.prototype;return n.toggle=function(t){return this._isShown?this.hide():this.show(t)},n.show=function(t){var n=this;if(!this._isShown&&!this._isTransitioning){e(this._element).hasClass("fade")&&(this._isTransitioning=!0);var o=e.Event("show.bs.modal",{relatedTarget:t});e(this._element).trigger(o),this._isShown||o.isDefaultPrevented()||(this._isShown=!0,this._checkScrollbar(),this._setScrollbar(),this._adjustDialog(),this._setEscapeEvent(),this._setResizeEvent(),e(this._element).on("click.dismiss.bs.modal",'[data-dismiss="modal"]',(function(t){return n.hide(t)})),e(this._dialog).on("mousedown.dismiss.bs.modal",(function(){e(n._element).one("mouseup.dismiss.bs.modal",(function(t){e(t.target).is(n._element)&&(n._ignoreBackdropClick=!0)}))})),this._showBackdrop((function(){return n._showElement(t)})))}},n.hide=function(t){var n=this;if(t&&t.preventDefault(),this._isShown&&!this._isTransitioning){var o=e.Event("hide.bs.modal");if(e(this._element).trigger(o),this._isShown&&!o.isDefaultPrevented()){this._isShown=!1;var r=e(this._element).hasClass("fade");if(r&&(this._isTransitioning=!0),this._setEscapeEvent(),this._setResizeEvent(),e(document).off("focusin.bs.modal"),e(this._element).removeClass("show"),e(this._element).off("click.dismiss.bs.modal"),e(this._dialog).off("mousedown.dismiss.bs.modal"),r){var i=l.getTransitionDurationFromElement(this._element);e(this._element).one(l.TRANSITION_END,(function(t){return n._hideModal(t)})).emulateTransitionEnd(i)}else this._hideModal()}}},n.dispose=function(){[window,this._element,this._dialog].forEach((function(t){return e(t).off(".bs.modal")})),e(document).off("focusin.bs.modal"),e.removeData(this._element,"bs.modal"),this._config=null,this._element=null,this._dialog=null,this._backdrop=null,this._isShown=null,this._isBodyOverflowing=null,this._ignoreBackdropClick=null,this._isTransitioning=null,this._scrollbarWidth=null},n.handleUpdate=function(){this._adjustDialog()},n._getConfig=function(t){return t=s(s({},D),t),l.typeCheckConfig("modal",t,O),t},n._triggerBackdropTransition=function(){var t=this;if("static"===this._config.backdrop){var n=e.Event("hidePrevented.bs.modal");if(e(this._element).trigger(n),n.defaultPrevented)return;this._element.classList.add("modal-static");var o=l.getTransitionDurationFromElement(this._element);e(this._element).one(l.TRANSITION_END,(function(){t._element.classList.remove("modal-static")})).emulateTransitionEnd(o),this._element.focus()}else this.hide()},n._showElement=function(t){var n=this,o=e(this._element).hasClass("fade"),r=this._dialog?this._dialog.querySelector(".modal-body"):null;this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE||document.body.appendChild(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),e(this._dialog).hasClass("modal-dialog-scrollable")&&r?r.scrollTop=0:this._element.scrollTop=0,o&&l.reflow(this._element),e(this._element).addClass("show"),this._config.focus&&this._enforceFocus();var i=e.Event("shown.bs.modal",{relatedTarget:t}),a=function(){n._config.focus&&n._element.focus(),n._isTransitioning=!1,e(n._element).trigger(i)};if(o){var s=l.getTransitionDurationFromElement(this._dialog);e(this._dialog).one(l.TRANSITION_END,a).emulateTransitionEnd(s)}else a()},n._enforceFocus=function(){var t=this;e(document).off("focusin.bs.modal").on("focusin.bs.modal",(function(n){document!==n.target&&t._element!==n.target&&0===e(t._element).has(n.target).length&&t._element.focus()}))},n._setEscapeEvent=function(){var t=this;this._isShown?e(this._element).on("keydown.dismiss.bs.modal",(function(e){t._config.keyboard&&27===e.which?(e.preventDefault(),t.hide()):t._config.keyboard||27!==e.which||t._triggerBackdropTransition()})):this._isShown||e(this._element).off("keydown.dismiss.bs.modal")},n._setResizeEvent=function(){var t=this;this._isShown?e(window).on("resize.bs.modal",(function(e){return t.handleUpdate(e)})):e(window).off("resize.bs.modal")},n._hideModal=function(){var t=this;this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._isTransitioning=!1,this._showBackdrop((function(){e(document.body).removeClass("modal-open"),t._resetAdjustments(),t._resetScrollbar(),e(t._element).trigger("hidden.bs.modal")}))},n._removeBackdrop=function(){this._backdrop&&(e(this._backdrop).remove(),this._backdrop=null)},n._showBackdrop=function(t){var n=this,o=e(this._element).hasClass("fade")?"fade":"";if(this._isShown&&this._config.backdrop){if(this._backdrop=document.createElement("div"),this._backdrop.className="modal-backdrop",o&&this._backdrop.classList.add(o),e(this._backdrop).appendTo(document.body),e(this._element).on("click.dismiss.bs.modal",(function(t){n._ignoreBackdropClick?n._ignoreBackdropClick=!1:t.target===t.currentTarget&&n._triggerBackdropTransition()})),o&&l.reflow(this._backdrop),e(this._backdrop).addClass("show"),!t)return;if(!o)return void t();var r=l.getTransitionDurationFromElement(this._backdrop);e(this._backdrop).one(l.TRANSITION_END,t).emulateTransitionEnd(r)}else if(!this._isShown&&this._backdrop){e(this._backdrop).removeClass("show");var i=function(){n._removeBackdrop(),t&&t()};if(e(this._element).hasClass("fade")){var a=l.getTransitionDurationFromElement(this._backdrop);e(this._backdrop).one(l.TRANSITION_END,i).emulateTransitionEnd(a)}else i()}else t&&t()},n._adjustDialog=function(){var t=this._element.scrollHeight>document.documentElement.clientHeight;!this._isBodyOverflowing&&t&&(this._element.style.paddingLeft=this._scrollbarWidth+"px"),this._isBodyOverflowing&&!t&&(this._element.style.paddingRight=this._scrollbarWidth+"px")},n._resetAdjustments=function(){this._element.style.paddingLeft="",this._element.style.paddingRight=""},n._checkScrollbar=function(){var t=document.body.getBoundingClientRect();this._isBodyOverflowing=Math.round(t.left+t.right)<window.innerWidth,this._scrollbarWidth=this._getScrollbarWidth()},n._setScrollbar=function(){var t=this;if(this._isBodyOverflowing){var n=[].slice.call(document.querySelectorAll(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top")),o=[].slice.call(document.querySelectorAll(".sticky-top"));e(n).each((function(n,o){var r=o.style.paddingRight,i=e(o).css("padding-right");e(o).data("padding-right",r).css("padding-right",parseFloat(i)+t._scrollbarWidth+"px")})),e(o).each((function(n,o){var r=o.style.marginRight,i=e(o).css("margin-right");e(o).data("margin-right",r).css("margin-right",parseFloat(i)-t._scrollbarWidth+"px")}));var r=document.body.style.paddingRight,i=e(document.body).css("padding-right");e(document.body).data("padding-right",r).css("padding-right",parseFloat(i)+this._scrollbarWidth+"px")}e(document.body).addClass("modal-open")},n._resetScrollbar=function(){var t=[].slice.call(document.querySelectorAll(".fixed-top, .fixed-bottom, .is-fixed, .sticky-top"));e(t).each((function(t,n){var o=e(n).data("padding-right");e(n).removeData("padding-right"),n.style.paddingRight=o||""}));var n=[].slice.call(document.querySelectorAll(".sticky-top"));e(n).each((function(t,n){var o=e(n).data("margin-right");void 0!==o&&e(n).css("margin-right",o).removeData("margin-right")}));var o=e(document.body).data("padding-right");e(document.body).removeData("padding-right"),document.body.style.paddingRight=o||""},n._getScrollbarWidth=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",document.body.appendChild(t);var e=t.getBoundingClientRect().width-t.clientWidth;return document.body.removeChild(t),e},t._jQueryInterface=function(n,o){return this.each((function(){var r=e(this).data("bs.modal"),i=s(s(s({},D),e(this).data()),"object"==typeof n&&n?n:{});if(r||(r=new t(this,i),e(this).data("bs.modal",r)),"string"==typeof n){if(void 0===r[n])throw new TypeError('No method named "'+n+'"');r[n](o)}else i.show&&r.show(o)}))},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return D}}]),t}();e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',(function(t){var n,o=this,r=l.getSelectorFromElement(this);r&&(n=document.querySelector(r));var i=e(n).data("bs.modal")?"toggle":s(s({},e(n).data()),e(this).data());"A"!==this.tagName&&"AREA"!==this.tagName||t.preventDefault();var a=e(n).one("show.bs.modal",(function(t){t.isDefaultPrevented()||a.one("hidden.bs.modal",(function(){e(o).is(":visible")&&o.focus()}))}));j._jQueryInterface.call(e(n),i,this)})),e.fn.modal=j._jQueryInterface,e.fn.modal.Constructor=j,e.fn.modal.noConflict=function(){return e.fn.modal=E,j._jQueryInterface};var F=["background","cite","href","itemtype","longdesc","poster","src","xlink:href"],P=/^(?:(?:https?|mailto|ftp|tel|file):|[^#&/:?]*(?:[#/?]|$))/gi,_=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[\d+/a-z]+=*$/i;function L(t,e,n){if(0===t.length)return t;if(n&&"function"==typeof n)return n(t);for(var o=(new window.DOMParser).parseFromString(t,"text/html"),r=Object.keys(e),i=[].slice.call(o.body.querySelectorAll("*")),a=function(t,n){var o=i[t],a=o.nodeName.toLowerCase();if(-1===r.indexOf(o.nodeName.toLowerCase()))return o.parentNode.removeChild(o),"continue";var s=[].slice.call(o.attributes),l=[].concat(e["*"]||[],e[a]||[]);s.forEach((function(t){(function(t,e){var n=t.nodeName.toLowerCase();if(-1!==e.indexOf(n))return-1===F.indexOf(n)||Boolean(t.nodeValue.match(P)||t.nodeValue.match(_));for(var o=e.filter((function(t){return t instanceof RegExp})),r=0,i=o.length;r<i;r++)if(n.match(o[r]))return!0;return!1})(t,l)||o.removeAttribute(t.nodeName)}))},s=0,l=i.length;s<l;s++)a(s);return o.body.innerHTML}var B="tooltip",G=e.fn[B],H=new RegExp("(^|\\s)bs-tooltip\\S+","g"),V=["sanitize","whiteList","sanitizeFn"],z={animation:"boolean",template:"string",title:"(string|element|function)",trigger:"string",delay:"(number|object)",html:"boolean",selector:"(string|boolean)",placement:"(string|function)",offset:"(number|string|function)",container:"(string|element|boolean)",fallbackPlacement:"(string|array)",boundary:"(string|element)",sanitize:"boolean",sanitizeFn:"(null|function)",whiteList:"object",popperConfig:"(null|object)"},W={AUTO:"auto",TOP:"top",RIGHT:"right",BOTTOM:"bottom",LEFT:"left"},U={animation:!0,template:'<div class="tooltip" role="tooltip"><div class="arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,selector:!1,placement:"top",offset:0,container:!1,fallbackPlacement:"flip",boundary:"scrollParent",sanitize:!0,sanitizeFn:null,whiteList:{"*":["class","dir","id","lang","role",/^aria-[\w-]*$/i],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},popperConfig:null},q={HIDE:"hide.bs.tooltip",HIDDEN:"hidden.bs.tooltip",SHOW:"show.bs.tooltip",SHOWN:"shown.bs.tooltip",INSERTED:"inserted.bs.tooltip",CLICK:"click.bs.tooltip",FOCUSIN:"focusin.bs.tooltip",FOCUSOUT:"focusout.bs.tooltip",MOUSEENTER:"mouseenter.bs.tooltip",MOUSELEAVE:"mouseleave.bs.tooltip"},Y=function(){function t(t,e){if(void 0===n)throw new TypeError("Bootstrap's tooltips require Popper.js (https://popper.js.org/)");this._isEnabled=!0,this._timeout=0,this._hoverState="",this._activeTrigger={},this._popper=null,this.element=t,this.config=this._getConfig(e),this.tip=null,this._setListeners()}var o=t.prototype;return o.enable=function(){this._isEnabled=!0},o.disable=function(){this._isEnabled=!1},o.toggleEnabled=function(){this._isEnabled=!this._isEnabled},o.toggle=function(t){if(this._isEnabled)if(t){var n=this.constructor.DATA_KEY,o=e(t.currentTarget).data(n);o||(o=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(n,o)),o._activeTrigger.click=!o._activeTrigger.click,o._isWithActiveTrigger()?o._enter(null,o):o._leave(null,o)}else{if(e(this.getTipElement()).hasClass("show"))return void this._leave(null,this);this._enter(null,this)}},o.dispose=function(){clearTimeout(this._timeout),e.removeData(this.element,this.constructor.DATA_KEY),e(this.element).off(this.constructor.EVENT_KEY),e(this.element).closest(".modal").off("hide.bs.modal",this._hideModalHandler),this.tip&&e(this.tip).remove(),this._isEnabled=null,this._timeout=null,this._hoverState=null,this._activeTrigger=null,this._popper&&this._popper.destroy(),this._popper=null,this.element=null,this.config=null,this.tip=null},o.show=function(){var t=this;if("none"===e(this.element).css("display"))throw new Error("Please use show on visible elements");var o=e.Event(this.constructor.Event.SHOW);if(this.isWithContent()&&this._isEnabled){e(this.element).trigger(o);var r=l.findShadowRoot(this.element),i=e.contains(null!==r?r:this.element.ownerDocument.documentElement,this.element);if(o.isDefaultPrevented()||!i)return;var a=this.getTipElement(),s=l.getUID(this.constructor.NAME);a.setAttribute("id",s),this.element.setAttribute("aria-describedby",s),this.setContent(),this.config.animation&&e(a).addClass("fade");var u="function"==typeof this.config.placement?this.config.placement.call(this,a,this.element):this.config.placement,c=this._getAttachment(u);this.addAttachmentClass(c);var f=this._getContainer();e(a).data(this.constructor.DATA_KEY,this),e.contains(this.element.ownerDocument.documentElement,this.tip)||e(a).appendTo(f),e(this.element).trigger(this.constructor.Event.INSERTED),this._popper=new n(this.element,a,this._getPopperConfig(c)),e(a).addClass("show"),"ontouchstart"in document.documentElement&&e(document.body).children().on("mouseover",null,e.noop);var h=function(){t.config.animation&&t._fixTransition();var n=t._hoverState;t._hoverState=null,e(t.element).trigger(t.constructor.Event.SHOWN),"out"===n&&t._leave(null,t)};if(e(this.tip).hasClass("fade")){var p=l.getTransitionDurationFromElement(this.tip);e(this.tip).one(l.TRANSITION_END,h).emulateTransitionEnd(p)}else h()}},o.hide=function(t){var n=this,o=this.getTipElement(),r=e.Event(this.constructor.Event.HIDE),i=function(){"show"!==n._hoverState&&o.parentNode&&o.parentNode.removeChild(o),n._cleanTipClass(),n.element.removeAttribute("aria-describedby"),e(n.element).trigger(n.constructor.Event.HIDDEN),null!==n._popper&&n._popper.destroy(),t&&t()};if(e(this.element).trigger(r),!r.isDefaultPrevented()){if(e(o).removeClass("show"),"ontouchstart"in document.documentElement&&e(document.body).children().off("mouseover",null,e.noop),this._activeTrigger.click=!1,this._activeTrigger.focus=!1,this._activeTrigger.hover=!1,e(this.tip).hasClass("fade")){var a=l.getTransitionDurationFromElement(o);e(o).one(l.TRANSITION_END,i).emulateTransitionEnd(a)}else i();this._hoverState=""}},o.update=function(){null!==this._popper&&this._popper.scheduleUpdate()},o.isWithContent=function(){return Boolean(this.getTitle())},o.addAttachmentClass=function(t){e(this.getTipElement()).addClass("bs-tooltip-"+t)},o.getTipElement=function(){return this.tip=this.tip||e(this.config.template)[0],this.tip},o.setContent=function(){var t=this.getTipElement();this.setElementContent(e(t.querySelectorAll(".tooltip-inner")),this.getTitle()),e(t).removeClass("fade show")},o.setElementContent=function(t,n){"object"!=typeof n||!n.nodeType&&!n.jquery?this.config.html?(this.config.sanitize&&(n=L(n,this.config.whiteList,this.config.sanitizeFn)),t.html(n)):t.text(n):this.config.html?e(n).parent().is(t)||t.empty().append(n):t.text(e(n).text())},o.getTitle=function(){var t=this.element.getAttribute("data-original-title");return t||(t="function"==typeof this.config.title?this.config.title.call(this.element):this.config.title),t},o._getPopperConfig=function(t){var e=this;return s(s({},{placement:t,modifiers:{offset:this._getOffset(),flip:{behavior:this.config.fallbackPlacement},arrow:{element:".arrow"},preventOverflow:{boundariesElement:this.config.boundary}},onCreate:function(t){t.originalPlacement!==t.placement&&e._handlePopperPlacementChange(t)},onUpdate:function(t){return e._handlePopperPlacementChange(t)}}),this.config.popperConfig)},o._getOffset=function(){var t=this,e={};return"function"==typeof this.config.offset?e.fn=function(e){return e.offsets=s(s({},e.offsets),t.config.offset(e.offsets,t.element)||{}),e}:e.offset=this.config.offset,e},o._getContainer=function(){return!1===this.config.container?document.body:l.isElement(this.config.container)?e(this.config.container):e(document).find(this.config.container)},o._getAttachment=function(t){return W[t.toUpperCase()]},o._setListeners=function(){var t=this;this.config.trigger.split(" ").forEach((function(n){if("click"===n)e(t.element).on(t.constructor.Event.CLICK,t.config.selector,(function(e){return t.toggle(e)}));else if("manual"!==n){var o="hover"===n?t.constructor.Event.MOUSEENTER:t.constructor.Event.FOCUSIN,r="hover"===n?t.constructor.Event.MOUSELEAVE:t.constructor.Event.FOCUSOUT;e(t.element).on(o,t.config.selector,(function(e){return t._enter(e)})).on(r,t.config.selector,(function(e){return t._leave(e)}))}})),this._hideModalHandler=function(){t.element&&t.hide()},e(this.element).closest(".modal").on("hide.bs.modal",this._hideModalHandler),this.config.selector?this.config=s(s({},this.config),{},{trigger:"manual",selector:""}):this._fixTitle()},o._fixTitle=function(){var t=typeof this.element.getAttribute("data-original-title");(this.element.getAttribute("title")||"string"!==t)&&(this.element.setAttribute("data-original-title",this.element.getAttribute("title")||""),this.element.setAttribute("title",""))},o._enter=function(t,n){var o=this.constructor.DATA_KEY;(n=n||e(t.currentTarget).data(o))||(n=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(o,n)),t&&(n._activeTrigger["focusin"===t.type?"focus":"hover"]=!0),e(n.getTipElement()).hasClass("show")||"show"===n._hoverState?n._hoverState="show":(clearTimeout(n._timeout),n._hoverState="show",n.config.delay&&n.config.delay.show?n._timeout=setTimeout((function(){"show"===n._hoverState&&n.show()}),n.config.delay.show):n.show())},o._leave=function(t,n){var o=this.constructor.DATA_KEY;(n=n||e(t.currentTarget).data(o))||(n=new this.constructor(t.currentTarget,this._getDelegateConfig()),e(t.currentTarget).data(o,n)),t&&(n._activeTrigger["focusout"===t.type?"focus":"hover"]=!1),n._isWithActiveTrigger()||(clearTimeout(n._timeout),n._hoverState="out",n.config.delay&&n.config.delay.hide?n._timeout=setTimeout((function(){"out"===n._hoverState&&n.hide()}),n.config.delay.hide):n.hide())},o._isWithActiveTrigger=function(){for(var t in this._activeTrigger)if(this._activeTrigger[t])return!0;return!1},o._getConfig=function(t){var n=e(this.element).data();return Object.keys(n).forEach((function(t){-1!==V.indexOf(t)&&delete n[t]})),"number"==typeof(t=s(s(s({},this.constructor.Default),n),"object"==typeof t&&t?t:{})).delay&&(t.delay={show:t.delay,hide:t.delay}),"number"==typeof t.title&&(t.title=t.title.toString()),"number"==typeof t.content&&(t.content=t.content.toString()),l.typeCheckConfig(B,t,this.constructor.DefaultType),t.sanitize&&(t.template=L(t.template,t.whiteList,t.sanitizeFn)),t},o._getDelegateConfig=function(){var t={};if(this.config)for(var e in this.config)this.constructor.Default[e]!==this.config[e]&&(t[e]=this.config[e]);return t},o._cleanTipClass=function(){var t=e(this.getTipElement()),n=t.attr("class").match(H);null!==n&&n.length&&t.removeClass(n.join(""))},o._handlePopperPlacementChange=function(t){this.tip=t.instance.popper,this._cleanTipClass(),this.addAttachmentClass(this._getAttachment(t.placement))},o._fixTransition=function(){var t=this.getTipElement(),n=this.config.animation;null===t.getAttribute("x-placement")&&(e(t).removeClass("fade"),this.config.animation=!1,this.hide(),this.show(),this.config.animation=n)},t._jQueryInterface=function(n){return this.each((function(){var o=e(this).data("bs.tooltip"),r="object"==typeof n&&n;if((o||!/dispose|hide/.test(n))&&(o||(o=new t(this,r),e(this).data("bs.tooltip",o)),"string"==typeof n)){if(void 0===o[n])throw new TypeError('No method named "'+n+'"');o[n]()}}))},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return U}},{key:"NAME",get:function(){return B}},{key:"DATA_KEY",get:function(){return"bs.tooltip"}},{key:"Event",get:function(){return q}},{key:"EVENT_KEY",get:function(){return".bs.tooltip"}},{key:"DefaultType",get:function(){return z}}]),t}();e.fn[B]=Y._jQueryInterface,e.fn[B].Constructor=Y,e.fn[B].noConflict=function(){return e.fn[B]=G,Y._jQueryInterface};var X="popover",Z=e.fn[X],Q=new RegExp("(^|\\s)bs-popover\\S+","g"),J=s(s({},Y.Default),{},{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>'}),$=s(s({},Y.DefaultType),{},{content:"(string|element|function)"}),K={HIDE:"hide.bs.popover",HIDDEN:"hidden.bs.popover",SHOW:"show.bs.popover",SHOWN:"shown.bs.popover",INSERTED:"inserted.bs.popover",CLICK:"click.bs.popover",FOCUSIN:"focusin.bs.popover",FOCUSOUT:"focusout.bs.popover",MOUSEENTER:"mouseenter.bs.popover",MOUSELEAVE:"mouseleave.bs.popover"},tt=function(t){var n,o;function i(){return t.apply(this,arguments)||this}o=t,(n=i).prototype=Object.create(o.prototype),n.prototype.constructor=n,n.__proto__=o;var a=i.prototype;return a.isWithContent=function(){return this.getTitle()||this._getContent()},a.addAttachmentClass=function(t){e(this.getTipElement()).addClass("bs-popover-"+t)},a.getTipElement=function(){return this.tip=this.tip||e(this.config.template)[0],this.tip},a.setContent=function(){var t=e(this.getTipElement());this.setElementContent(t.find(".popover-header"),this.getTitle());var n=this._getContent();"function"==typeof n&&(n=n.call(this.element)),this.setElementContent(t.find(".popover-body"),n),t.removeClass("fade show")},a._getContent=function(){return this.element.getAttribute("data-content")||this.config.content},a._cleanTipClass=function(){var t=e(this.getTipElement()),n=t.attr("class").match(Q);null!==n&&n.length>0&&t.removeClass(n.join(""))},i._jQueryInterface=function(t){return this.each((function(){var n=e(this).data("bs.popover"),o="object"==typeof t?t:null;if((n||!/dispose|hide/.test(t))&&(n||(n=new i(this,o),e(this).data("bs.popover",n)),"string"==typeof t)){if(void 0===n[t])throw new TypeError('No method named "'+t+'"');n[t]()}}))},r(i,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return J}},{key:"NAME",get:function(){return X}},{key:"DATA_KEY",get:function(){return"bs.popover"}},{key:"Event",get:function(){return K}},{key:"EVENT_KEY",get:function(){return".bs.popover"}},{key:"DefaultType",get:function(){return $}}]),i}(Y);e.fn[X]=tt._jQueryInterface,e.fn[X].Constructor=tt,e.fn[X].noConflict=function(){return e.fn[X]=Z,tt._jQueryInterface};var et="scrollspy",nt=e.fn[et],ot={offset:10,method:"auto",target:""},rt={offset:"number",method:"string",target:"(string|element)"},it=function(){function t(t,n){var o=this;this._element=t,this._scrollElement="BODY"===t.tagName?window:t,this._config=this._getConfig(n),this._selector=this._config.target+" .nav-link,"+this._config.target+" .list-group-item,"+this._config.target+" .dropdown-item",this._offsets=[],this._targets=[],this._activeTarget=null,this._scrollHeight=0,e(this._scrollElement).on("scroll.bs.scrollspy",(function(t){return o._process(t)})),this.refresh(),this._process()}var n=t.prototype;return n.refresh=function(){var t=this,n=this._scrollElement===this._scrollElement.window?"offset":"position",o="auto"===this._config.method?n:this._config.method,r="position"===o?this._getScrollTop():0;this._offsets=[],this._targets=[],this._scrollHeight=this._getScrollHeight(),[].slice.call(document.querySelectorAll(this._selector)).map((function(t){var n,i=l.getSelectorFromElement(t);if(i&&(n=document.querySelector(i)),n){var a=n.getBoundingClientRect();if(a.width||a.height)return[e(n)[o]().top+r,i]}return null})).filter((function(t){return t})).sort((function(t,e){return t[0]-e[0]})).forEach((function(e){t._offsets.push(e[0]),t._targets.push(e[1])}))},n.dispose=function(){e.removeData(this._element,"bs.scrollspy"),e(this._scrollElement).off(".bs.scrollspy"),this._element=null,this._scrollElement=null,this._config=null,this._selector=null,this._offsets=null,this._targets=null,this._activeTarget=null,this._scrollHeight=null},n._getConfig=function(t){if("string"!=typeof(t=s(s({},ot),"object"==typeof t&&t?t:{})).target&&l.isElement(t.target)){var n=e(t.target).attr("id");n||(n=l.getUID(et),e(t.target).attr("id",n)),t.target="#"+n}return l.typeCheckConfig(et,t,rt),t},n._getScrollTop=function(){return this._scrollElement===window?this._scrollElement.pageYOffset:this._scrollElement.scrollTop},n._getScrollHeight=function(){return this._scrollElement.scrollHeight||Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},n._getOffsetHeight=function(){return this._scrollElement===window?window.innerHeight:this._scrollElement.getBoundingClientRect().height},n._process=function(){var t=this._getScrollTop()+this._config.offset,e=this._getScrollHeight(),n=this._config.offset+e-this._getOffsetHeight();if(this._scrollHeight!==e&&this.refresh(),t>=n){var o=this._targets[this._targets.length-1];this._activeTarget!==o&&this._activate(o)}else{if(this._activeTarget&&t<this._offsets[0]&&this._offsets[0]>0)return this._activeTarget=null,void this._clear();for(var r=this._offsets.length;r--;)this._activeTarget!==this._targets[r]&&t>=this._offsets[r]&&(void 0===this._offsets[r+1]||t<this._offsets[r+1])&&this._activate(this._targets[r])}},n._activate=function(t){this._activeTarget=t,this._clear();var n=this._selector.split(",").map((function(e){return e+'[data-target="'+t+'"],'+e+'[href="'+t+'"]'})),o=e([].slice.call(document.querySelectorAll(n.join(","))));o.hasClass("dropdown-item")?(o.closest(".dropdown").find(".dropdown-toggle").addClass("active"),o.addClass("active")):(o.addClass("active"),o.parents(".nav, .list-group").prev(".nav-link, .list-group-item").addClass("active"),o.parents(".nav, .list-group").prev(".nav-item").children(".nav-link").addClass("active")),e(this._scrollElement).trigger("activate.bs.scrollspy",{relatedTarget:t})},n._clear=function(){[].slice.call(document.querySelectorAll(this._selector)).filter((function(t){return t.classList.contains("active")})).forEach((function(t){return t.classList.remove("active")}))},t._jQueryInterface=function(n){return this.each((function(){var o=e(this).data("bs.scrollspy");if(o||(o=new t(this,"object"==typeof n&&n),e(this).data("bs.scrollspy",o)),"string"==typeof n){if(void 0===o[n])throw new TypeError('No method named "'+n+'"');o[n]()}}))},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"Default",get:function(){return ot}}]),t}();e(window).on("load.bs.scrollspy.data-api",(function(){for(var t=[].slice.call(document.querySelectorAll('[data-spy="scroll"]')),n=t.length;n--;){var o=e(t[n]);it._jQueryInterface.call(o,o.data())}})),e.fn[et]=it._jQueryInterface,e.fn[et].Constructor=it,e.fn[et].noConflict=function(){return e.fn[et]=nt,it._jQueryInterface};var at=e.fn.tab,st=function(){function t(t){this._element=t}var n=t.prototype;return n.show=function(){var t=this;if(!(this._element.parentNode&&this._element.parentNode.nodeType===Node.ELEMENT_NODE&&e(this._element).hasClass("active")||e(this._element).hasClass("disabled"))){var n,o,r=e(this._element).closest(".nav, .list-group")[0],i=l.getSelectorFromElement(this._element);if(r){var a="UL"===r.nodeName||"OL"===r.nodeName?"> li > .active":".active";o=(o=e.makeArray(e(r).find(a)))[o.length-1]}var s=e.Event("hide.bs.tab",{relatedTarget:this._element}),u=e.Event("show.bs.tab",{relatedTarget:o});if(o&&e(o).trigger(s),e(this._element).trigger(u),!u.isDefaultPrevented()&&!s.isDefaultPrevented()){i&&(n=document.querySelector(i)),this._activate(this._element,r);var c=function(){var n=e.Event("hidden.bs.tab",{relatedTarget:t._element}),r=e.Event("shown.bs.tab",{relatedTarget:o});e(o).trigger(n),e(t._element).trigger(r)};n?this._activate(n,n.parentNode,c):c()}}},n.dispose=function(){e.removeData(this._element,"bs.tab"),this._element=null},n._activate=function(t,n,o){var r=this,i=(!n||"UL"!==n.nodeName&&"OL"!==n.nodeName?e(n).children(".active"):e(n).find("> li > .active"))[0],a=o&&i&&e(i).hasClass("fade"),s=function(){return r._transitionComplete(t,i,o)};if(i&&a){var u=l.getTransitionDurationFromElement(i);e(i).removeClass("show").one(l.TRANSITION_END,s).emulateTransitionEnd(u)}else s()},n._transitionComplete=function(t,n,o){if(n){e(n).removeClass("active");var r=e(n.parentNode).find("> .dropdown-menu .active")[0];r&&e(r).removeClass("active"),"tab"===n.getAttribute("role")&&n.setAttribute("aria-selected",!1)}if(e(t).addClass("active"),"tab"===t.getAttribute("role")&&t.setAttribute("aria-selected",!0),l.reflow(t),t.classList.contains("fade")&&t.classList.add("show"),t.parentNode&&e(t.parentNode).hasClass("dropdown-menu")){var i=e(t).closest(".dropdown")[0];if(i){var a=[].slice.call(i.querySelectorAll(".dropdown-toggle"));e(a).addClass("active")}t.setAttribute("aria-expanded",!0)}o&&o()},t._jQueryInterface=function(n){return this.each((function(){var o=e(this),r=o.data("bs.tab");if(r||(r=new t(this),o.data("bs.tab",r)),"string"==typeof n){if(void 0===r[n])throw new TypeError('No method named "'+n+'"');r[n]()}}))},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}}]),t}();e(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"], [data-toggle="list"]',(function(t){t.preventDefault(),st._jQueryInterface.call(e(this),"show")})),e.fn.tab=st._jQueryInterface,e.fn.tab.Constructor=st,e.fn.tab.noConflict=function(){return e.fn.tab=at,st._jQueryInterface};var lt=e.fn.toast,ut={animation:"boolean",autohide:"boolean",delay:"number"},ct={animation:!0,autohide:!0,delay:500},ft=function(){function t(t,e){this._element=t,this._config=this._getConfig(e),this._timeout=null,this._setListeners()}var n=t.prototype;return n.show=function(){var t=this,n=e.Event("show.bs.toast");if(e(this._element).trigger(n),!n.isDefaultPrevented()){this._config.animation&&this._element.classList.add("fade");var o=function(){t._element.classList.remove("showing"),t._element.classList.add("show"),e(t._element).trigger("shown.bs.toast"),t._config.autohide&&(t._timeout=setTimeout((function(){t.hide()}),t._config.delay))};if(this._element.classList.remove("hide"),l.reflow(this._element),this._element.classList.add("showing"),this._config.animation){var r=l.getTransitionDurationFromElement(this._element);e(this._element).one(l.TRANSITION_END,o).emulateTransitionEnd(r)}else o()}},n.hide=function(){if(this._element.classList.contains("show")){var t=e.Event("hide.bs.toast");e(this._element).trigger(t),t.isDefaultPrevented()||this._close()}},n.dispose=function(){clearTimeout(this._timeout),this._timeout=null,this._element.classList.contains("show")&&this._element.classList.remove("show"),e(this._element).off("click.dismiss.bs.toast"),e.removeData(this._element,"bs.toast"),this._element=null,this._config=null},n._getConfig=function(t){return t=s(s(s({},ct),e(this._element).data()),"object"==typeof t&&t?t:{}),l.typeCheckConfig("toast",t,this.constructor.DefaultType),t},n._setListeners=function(){var t=this;e(this._element).on("click.dismiss.bs.toast",'[data-dismiss="toast"]',(function(){return t.hide()}))},n._close=function(){var t=this,n=function(){t._element.classList.add("hide"),e(t._element).trigger("hidden.bs.toast")};if(this._element.classList.remove("show"),this._config.animation){var o=l.getTransitionDurationFromElement(this._element);e(this._element).one(l.TRANSITION_END,n).emulateTransitionEnd(o)}else n()},t._jQueryInterface=function(n){return this.each((function(){var o=e(this),r=o.data("bs.toast");if(r||(r=new t(this,"object"==typeof n&&n),o.data("bs.toast",r)),"string"==typeof n){if(void 0===r[n])throw new TypeError('No method named "'+n+'"');r[n](this)}}))},r(t,null,[{key:"VERSION",get:function(){return"4.5.0"}},{key:"DefaultType",get:function(){return ut}},{key:"Default",get:function(){return ct}}]),t}();e.fn.toast=ft._jQueryInterface,e.fn.toast.Constructor=ft,e.fn.toast.noConflict=function(){return e.fn.toast=lt,ft._jQueryInterface},t.Alert=f,t.Button=p,t.Carousel=C,t.Collapse=S,t.Dropdown=N,t.Modal=j,t.Popover=tt,t.Scrollspy=it,t.Tab=st,t.Toast=ft,t.Tooltip=Y,t.Util=l,Object.defineProperty(t,"__esModule",{value:!0})})),function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Popper=e()}(this,(function(){"use strict";function t(t){return t&&"[object Function]"==={}.toString.call(t)}function e(t,e){if(1!==t.nodeType)return[];var n=window.getComputedStyle(t,null);return e?n[e]:n}function n(t){return"HTML"===t.nodeName?t:t.parentNode||t.host}function o(t){if(!t||-1!==["HTML","BODY","#document"].indexOf(t.nodeName))return window.document.body;var r=e(t),i=r.overflow,a=r.overflowX,s=r.overflowY;return/(auto|scroll)/.test(i+s+a)?t:o(n(t))}function r(t){var n=t&&t.offsetParent,o=n&&n.nodeName;return o&&"BODY"!==o&&"HTML"!==o?-1!==["TD","TABLE"].indexOf(n.nodeName)&&"static"===e(n,"position")?r(n):n:window.document.documentElement}function i(t){return null===t.parentNode?t:i(t.parentNode)}function a(t,e){if(!(t&&t.nodeType&&e&&e.nodeType))return window.document.documentElement;var n=t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_FOLLOWING,o=n?t:e,s=n?e:t,l=document.createRange();l.setStart(o,0),l.setEnd(s,0);var u=l.commonAncestorContainer;if(t!==u&&e!==u||o.contains(s))return function(t){var e=t.nodeName;return"BODY"!==e&&("HTML"===e||r(t.firstElementChild)===t)}(u)?u:r(u);var c=i(t);return c.host?a(c.host,e):a(t,i(e).host)}function s(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"top",n="top"===e?"scrollTop":"scrollLeft",o=t.nodeName;if("BODY"===o||"HTML"===o){var r=window.document.documentElement,i=window.document.scrollingElement||r;return i[n]}return t[n]}function l(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o=s(e,"top"),r=s(e,"left"),i=n?-1:1;return t.top+=o*i,t.bottom+=o*i,t.left+=r*i,t.right+=r*i,t}function u(t,e){var n="x"===e?"Left":"Top",o="Left"==n?"Right":"Bottom";return+t["border"+n+"Width"].split("px")[0]+ +t["border"+o+"Width"].split("px")[0]}function c(t,e,n,o){return G(e["offset"+t],n["client"+t],n["offset"+t],X()?n["offset"+t]+o["margin"+("Height"===t?"Top":"Left")]+o["margin"+("Height"===t?"Bottom":"Right")]:0)}function f(){var t=window.document.body,e=window.document.documentElement,n=X()&&window.getComputedStyle(e);return{height:c("Height",t,e,n),width:c("Width",t,e,n)}}function h(t){return $({},t,{right:t.left+t.width,bottom:t.top+t.height})}function p(t){var n={};if(X())try{n=t.getBoundingClientRect();var o=s(t,"top"),r=s(t,"left");n.top+=o,n.left+=r,n.bottom+=o,n.right+=r}catch(t){}else n=t.getBoundingClientRect();var i={left:n.left,top:n.top,width:n.right-n.left,height:n.bottom-n.top},a="HTML"===t.nodeName?f():{},l=a.width||t.clientWidth||i.right-i.left,c=a.height||t.clientHeight||i.bottom-i.top,p=t.offsetWidth-l,d=t.offsetHeight-c;if(p||d){var g=e(t);p-=u(g,"x"),d-=u(g,"y"),i.width-=p,i.height-=d}return h(i)}function d(t,n){var r=X(),i="HTML"===n.nodeName,a=p(t),s=p(n),u=o(t),c=e(n),f=+c.borderTopWidth.split("px")[0],d=+c.borderLeftWidth.split("px")[0],g=h({top:a.top-s.top-f,left:a.left-s.left-d,width:a.width,height:a.height});if(g.marginTop=0,g.marginLeft=0,!r&&i){var m=+c.marginTop.split("px")[0],y=+c.marginLeft.split("px")[0];g.top-=f-m,g.bottom-=f-m,g.left-=d-y,g.right-=d-y,g.marginTop=m,g.marginLeft=y}return(r?n.contains(u):n===u&&"BODY"!==u.nodeName)&&(g=l(g,n)),g}function g(t){var e=window.document.documentElement,n=d(t,e),o=G(e.clientWidth,window.innerWidth||0),r=G(e.clientHeight,window.innerHeight||0),i=s(e),a=s(e,"left");return h({top:i-n.top+n.marginTop,left:a-n.left+n.marginLeft,width:o,height:r})}function m(t){var o=t.nodeName;return"BODY"!==o&&"HTML"!==o&&("fixed"===e(t,"position")||m(n(t)))}function y(t,e,r,i){var s={top:0,left:0},l=a(t,e);if("viewport"===i)s=g(l);else{var u;"scrollParent"===i?"BODY"===(u=o(n(t))).nodeName&&(u=window.document.documentElement):u="window"===i?window.document.documentElement:i;var c=d(u,l);if("HTML"!==u.nodeName||m(l))s=c;else{var h=f(),p=h.height,y=h.width;s.top+=c.top-c.marginTop,s.bottom=p+c.top,s.left+=c.left-c.marginLeft,s.right=y+c.left}}return s.left+=r,s.top+=r,s.right-=r,s.bottom-=r,s}function v(t){return t.width*t.height}function C(t,e,n,o,r){var i=5<arguments.length&&void 0!==arguments[5]?arguments[5]:0;if(-1===t.indexOf("auto"))return t;var a=y(n,o,i,r),s={top:{width:a.width,height:e.top-a.top},right:{width:a.right-e.right,height:a.height},bottom:{width:a.width,height:a.bottom-e.bottom},left:{width:e.left-a.left,height:a.height}},l=Object.keys(s).map((function(t){return $({key:t},s[t],{area:v(s[t])})})).sort((function(t,e){return e.area-t.area})),u=l.filter((function(t){var e=t.width,o=t.height;return e>=n.clientWidth&&o>=n.clientHeight})),c=0<u.length?u[0].key:l[0].key,f=t.split("-")[1];return c+(f?"-"+f:"")}function b(t,e,n){return d(n,a(e,n))}function w(t){var e=window.getComputedStyle(t),n=parseFloat(e.marginTop)+parseFloat(e.marginBottom),o=parseFloat(e.marginLeft)+parseFloat(e.marginRight);return{width:t.offsetWidth+o,height:t.offsetHeight+n}}function T(t){var e={left:"right",right:"left",bottom:"top",top:"bottom"};return t.replace(/left|right|bottom|top/g,(function(t){return e[t]}))}function x(t,e,n){n=n.split("-")[0];var o=w(t),r={width:o.width,height:o.height},i=-1!==["right","left"].indexOf(n),a=i?"top":"left",s=i?"left":"top",l=i?"height":"width",u=i?"width":"height";return r[a]=e[a]+e[l]/2-o[l]/2,r[s]=n===s?e[s]-o[u]:e[T(s)],r}function S(t,e){return Array.prototype.find?t.find(e):t.filter(e)[0]}function A(e,n,o){return(void 0===o?e:e.slice(0,function(t,e,n){if(Array.prototype.findIndex)return t.findIndex((function(t){return t[e]===n}));var o=S(t,(function(t){return t[e]===n}));return t.indexOf(o)}(e,"name",o))).forEach((function(e){e.function&&console.warn("`modifier.function` is deprecated, use `modifier.fn`!");var o=e.function||e.fn;e.enabled&&t(o)&&(n.offsets.popper=h(n.offsets.popper),n.offsets.reference=h(n.offsets.reference),n=o(n,e))})),n}function I(){if(!this.state.isDestroyed){var t={instance:this,styles:{},attributes:{},flipped:!1,offsets:{}};t.offsets.reference=b(this.state,this.popper,this.reference),t.placement=C(this.options.placement,t.offsets.reference,this.popper,this.reference,this.options.modifiers.flip.boundariesElement,this.options.modifiers.flip.padding),t.originalPlacement=t.placement,t.offsets.popper=x(this.popper,t.offsets.reference,t.placement),t.offsets.popper.position="absolute",t=A(this.modifiers,t),this.state.isCreated?this.options.onUpdate(t):(this.state.isCreated=!0,this.options.onCreate(t))}}function R(t,e){return t.some((function(t){var n=t.name;return t.enabled&&n===e}))}function k(t){for(var e=[!1,"ms","Webkit","Moz","O"],n=t.charAt(0).toUpperCase()+t.slice(1),o=0;o<e.length-1;o++){var r=e[o],i=r?""+r+n:t;if(void 0!==window.document.body.style[i])return i}return null}function M(){return this.state.isDestroyed=!0,R(this.modifiers,"applyStyle")&&(this.popper.removeAttribute("x-placement"),this.popper.style.left="",this.popper.style.position="",this.popper.style.top="",this.popper.style[k("transform")]=""),this.disableEventListeners(),this.options.removeOnDestroy&&this.popper.parentNode.removeChild(this.popper),this}function N(t,e,n,r){n.updateBound=r,window.addEventListener("resize",n.updateBound,{passive:!0});var i=o(t);return function t(e,n,r,i){var a="BODY"===e.nodeName,s=a?window:e;s.addEventListener(n,r,{passive:!0}),a||t(o(s.parentNode),n,r,i),i.push(s)}(i,"scroll",n.updateBound,n.scrollParents),n.scrollElement=i,n.eventsEnabled=!0,n}function E(){this.state.eventsEnabled||(this.state=N(this.reference,this.options,this.state,this.scheduleUpdate))}function D(){this.state.eventsEnabled&&(window.cancelAnimationFrame(this.scheduleUpdate),this.state=function(t,e){return window.removeEventListener("resize",e.updateBound),e.scrollParents.forEach((function(t){t.removeEventListener("scroll",e.updateBound)})),e.updateBound=null,e.scrollParents=[],e.scrollElement=null,e.eventsEnabled=!1,e}(this.reference,this.state))}function O(t){return""!==t&&!isNaN(parseFloat(t))&&isFinite(t)}function j(t,e){Object.keys(e).forEach((function(n){var o="";-1!==["width","height","top","right","bottom","left"].indexOf(n)&&O(e[n])&&(o="px"),t.style[n]=e[n]+o}))}function F(t,e,n){var o=S(t,(function(t){return t.name===e})),r=!!o&&t.some((function(t){return t.name===n&&t.enabled&&t.order<o.order}));if(!r){var i="`"+e+"`";console.warn("`"+n+"` modifier is required by "+i+" modifier in order to work, be sure to include it before "+i+"!")}return r}function P(t){var e=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=tt.indexOf(t),o=tt.slice(n+1).concat(tt.slice(0,n));return e?o.reverse():o}function _(t,e,n,o){var r=[0,0],i=-1!==["right","left"].indexOf(o),a=t.split(/(\+|\-)/).map((function(t){return t.trim()})),s=a.indexOf(S(a,(function(t){return-1!==t.search(/,|\s/)})));a[s]&&-1===a[s].indexOf(",")&&console.warn("Offsets separated by white space(s) are deprecated, use a comma (,) instead.");var l=/\s*,\s*|\s+/,u=-1===s?[a]:[a.slice(0,s).concat([a[s].split(l)[0]]),[a[s].split(l)[1]].concat(a.slice(s+1))];return(u=u.map((function(t,o){var r=(1===o?!i:i)?"height":"width",a=!1;return t.reduce((function(t,e){return""===t[t.length-1]&&-1!==["+","-"].indexOf(e)?(t[t.length-1]=e,a=!0,t):a?(t[t.length-1]+=e,a=!1,t):t.concat(e)}),[]).map((function(t){return function(t,e,n,o){var r=t.match(/((?:\-|\+)?\d*\.?\d*)(.*)/),i=+r[1],a=r[2];if(!i)return t;if(0===a.indexOf("%")){var s;switch(a){case"%p":s=n;break;case"%":case"%r":default:s=o}return h(s)[e]/100*i}return"vh"===a||"vw"===a?("vh"===a?G(document.documentElement.clientHeight,window.innerHeight||0):G(document.documentElement.clientWidth,window.innerWidth||0))/100*i:i}(t,r,e,n)}))}))).forEach((function(t,e){t.forEach((function(n,o){O(n)&&(r[e]+=n*("-"===t[o-1]?-1:1))}))})),r}for(var L=Math.min,B=Math.floor,G=Math.max,H=["native code","[object MutationObserverConstructor]"],V="undefined"!=typeof window,z=["Edge","Trident","Firefox"],W=0,U=0;U<z.length;U+=1)if(V&&0<=navigator.userAgent.indexOf(z[U])){W=1;break}var q,Y=V&&function(t){return H.some((function(e){return-1<(t||"").toString().indexOf(e)}))}(window.MutationObserver)?function(t){var e=!1,n=0,o=document.createElement("span");return new MutationObserver((function(){t(),e=!1})).observe(o,{attributes:!0}),function(){e||(e=!0,o.setAttribute("x-index",n),++n)}}:function(t){var e=!1;return function(){e||(e=!0,setTimeout((function(){e=!1,t()}),W))}},X=function(){return null==q&&(q=-1!==navigator.appVersion.indexOf("MSIE 10")),q},Z=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},Q=function(){function t(t,e){for(var n,o=0;o<e.length;o++)(n=e[o]).enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),J=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t},$=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},K=["auto-start","auto","auto-end","top-start","top","top-end","right-start","right","right-end","bottom-end","bottom","bottom-start","left-end","left","left-start"],tt=K.slice(3),et="flip",nt="clockwise",ot="counterclockwise",rt=function(){function e(n,o){var r=this,i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{};Z(this,e),this.scheduleUpdate=function(){return requestAnimationFrame(r.update)},this.update=Y(this.update.bind(this)),this.options=$({},e.Defaults,i),this.state={isDestroyed:!1,isCreated:!1,scrollParents:[]},this.reference=n.jquery?n[0]:n,this.popper=o.jquery?o[0]:o,this.options.modifiers={},Object.keys($({},e.Defaults.modifiers,i.modifiers)).forEach((function(t){r.options.modifiers[t]=$({},e.Defaults.modifiers[t]||{},i.modifiers?i.modifiers[t]:{})})),this.modifiers=Object.keys(this.options.modifiers).map((function(t){return $({name:t},r.options.modifiers[t])})).sort((function(t,e){return t.order-e.order})),this.modifiers.forEach((function(e){e.enabled&&t(e.onLoad)&&e.onLoad(r.reference,r.popper,r.options,e,r.state)})),this.update();var a=this.options.eventsEnabled;a&&this.enableEventListeners(),this.state.eventsEnabled=a}return Q(e,[{key:"update",value:function(){return I.call(this)}},{key:"destroy",value:function(){return M.call(this)}},{key:"enableEventListeners",value:function(){return E.call(this)}},{key:"disableEventListeners",value:function(){return D.call(this)}}]),e}();return rt.Utils=("undefined"==typeof window?global:window).PopperUtils,rt.placements=K,rt.Defaults={placement:"bottom",eventsEnabled:!0,removeOnDestroy:!1,onCreate:function(){},onUpdate:function(){},modifiers:{shift:{order:100,enabled:!0,fn:function(t){var e=t.placement,n=e.split("-")[0],o=e.split("-")[1];if(o){var r=t.offsets,i=r.reference,a=r.popper,s=-1!==["bottom","top"].indexOf(n),l=s?"left":"top",u=s?"width":"height",c={start:J({},l,i[l]),end:J({},l,i[l]+i[u]-a[u])};t.offsets.popper=$({},a,c[o])}return t}},offset:{order:200,enabled:!0,fn:function(t,e){var n,o=e.offset,r=t.placement,i=t.offsets,a=i.popper,s=i.reference,l=r.split("-")[0];return n=O(+o)?[+o,0]:_(o,a,s,l),"left"===l?(a.top+=n[0],a.left-=n[1]):"right"===l?(a.top+=n[0],a.left+=n[1]):"top"===l?(a.left+=n[0],a.top-=n[1]):"bottom"===l&&(a.left+=n[0],a.top+=n[1]),t.popper=a,t},offset:0},preventOverflow:{order:300,enabled:!0,fn:function(t,e){var n=e.boundariesElement||r(t.instance.popper);t.instance.reference===n&&(n=r(n));var o=y(t.instance.popper,t.instance.reference,e.padding,n);e.boundaries=o;var i=e.priority,a=t.offsets.popper,s={primary:function(t){var n=a[t];return a[t]<o[t]&&!e.escapeWithReference&&(n=G(a[t],o[t])),J({},t,n)},secondary:function(t){var n="right"===t?"left":"top",r=a[n];return a[t]>o[t]&&!e.escapeWithReference&&(r=L(a[n],o[t]-("right"===t?a.width:a.height))),J({},n,r)}};return i.forEach((function(t){var e=-1===["left","top"].indexOf(t)?"secondary":"primary";a=$({},a,s[e](t))})),t.offsets.popper=a,t},priority:["left","right","top","bottom"],padding:5,boundariesElement:"scrollParent"},keepTogether:{order:400,enabled:!0,fn:function(t){var e=t.offsets,n=e.popper,o=e.reference,r=t.placement.split("-")[0],i=B,a=-1!==["top","bottom"].indexOf(r),s=a?"right":"bottom",l=a?"left":"top",u=a?"width":"height";return n[s]<i(o[l])&&(t.offsets.popper[l]=i(o[l])-n[u]),n[l]>i(o[s])&&(t.offsets.popper[l]=i(o[s])),t}},arrow:{order:500,enabled:!0,fn:function(t,e){if(!F(t.instance.modifiers,"arrow","keepTogether"))return t;var n=e.element;if("string"==typeof n){if(!(n=t.instance.popper.querySelector(n)))return t}else if(!t.instance.popper.contains(n))return console.warn("WARNING: `arrow.element` must be child of its popper element!"),t;var o=t.placement.split("-")[0],r=t.offsets,i=r.popper,a=r.reference,s=-1!==["left","right"].indexOf(o),l=s?"height":"width",u=s?"top":"left",c=s?"left":"top",f=s?"bottom":"right",p=w(n)[l];a[f]-p<i[u]&&(t.offsets.popper[u]-=i[u]-(a[f]-p)),a[u]+p>i[f]&&(t.offsets.popper[u]+=a[u]+p-i[f]);var d=a[u]+a[l]/2-p/2-h(t.offsets.popper)[u];return d=G(L(i[l]-p,d),0),t.arrowElement=n,t.offsets.arrow={},t.offsets.arrow[u]=Math.round(d),t.offsets.arrow[c]="",t},element:"[x-arrow]"},flip:{order:600,enabled:!0,fn:function(t,e){if(R(t.instance.modifiers,"inner"))return t;if(t.flipped&&t.placement===t.originalPlacement)return t;var n=y(t.instance.popper,t.instance.reference,e.padding,e.boundariesElement),o=t.placement.split("-")[0],r=T(o),i=t.placement.split("-")[1]||"",a=[];switch(e.behavior){case et:a=[o,r];break;case nt:a=P(o);break;case ot:a=P(o,!0);break;default:a=e.behavior}return a.forEach((function(s,l){if(o!==s||a.length===l+1)return t;o=t.placement.split("-")[0],r=T(o);var u=t.offsets.popper,c=t.offsets.reference,f=B,h="left"===o&&f(u.right)>f(c.left)||"right"===o&&f(u.left)<f(c.right)||"top"===o&&f(u.bottom)>f(c.top)||"bottom"===o&&f(u.top)<f(c.bottom),p=f(u.left)<f(n.left),d=f(u.right)>f(n.right),g=f(u.top)<f(n.top),m=f(u.bottom)>f(n.bottom),y="left"===o&&p||"right"===o&&d||"top"===o&&g||"bottom"===o&&m,v=-1!==["top","bottom"].indexOf(o),C=!!e.flipVariations&&(v&&"start"===i&&p||v&&"end"===i&&d||!v&&"start"===i&&g||!v&&"end"===i&&m);(h||y||C)&&(t.flipped=!0,(h||y)&&(o=a[l+1]),C&&(i=function(t){return"end"===t?"start":"start"===t?"end":t}(i)),t.placement=o+(i?"-"+i:""),t.offsets.popper=$({},t.offsets.popper,x(t.instance.popper,t.offsets.reference,t.placement)),t=A(t.instance.modifiers,t,"flip"))})),t},behavior:"flip",padding:5,boundariesElement:"viewport"},inner:{order:700,enabled:!1,fn:function(t){var e=t.placement,n=e.split("-")[0],o=t.offsets,r=o.popper,i=o.reference,a=-1!==["left","right"].indexOf(n),s=-1===["top","left"].indexOf(n);return r[a?"left":"top"]=i[e]-(s?r[a?"width":"height"]:0),t.placement=T(e),t.offsets.popper=h(r),t}},hide:{order:800,enabled:!0,fn:function(t){if(!F(t.instance.modifiers,"hide","preventOverflow"))return t;var e=t.offsets.reference,n=S(t.instance.modifiers,(function(t){return"preventOverflow"===t.name})).boundaries;if(e.bottom<n.top||e.left>n.right||e.top>n.bottom||e.right<n.left){if(!0===t.hide)return t;t.hide=!0,t.attributes["x-out-of-boundaries"]=""}else{if(!1===t.hide)return t;t.hide=!1,t.attributes["x-out-of-boundaries"]=!1}return t}},computeStyle:{order:850,enabled:!0,fn:function(t,e){var n=e.x,o=e.y,i=t.offsets.popper,a=S(t.instance.modifiers,(function(t){return"applyStyle"===t.name})).gpuAcceleration;void 0!==a&&console.warn("WARNING: `gpuAcceleration` option moved to `computeStyle` modifier and will not be supported in future versions of Popper.js!");var s,l,u=void 0===a?e.gpuAcceleration:a,c=p(r(t.instance.popper)),f={position:i.position},h={left:B(i.left),top:B(i.top),bottom:B(i.bottom),right:B(i.right)},d="bottom"===n?"top":"bottom",g="right"===o?"left":"right",m=k("transform");if(l="bottom"==d?-c.height+h.bottom:h.top,s="right"==g?-c.width+h.right:h.left,u&&m)f[m]="translate3d("+s+"px, "+l+"px, 0)",f[d]=0,f[g]=0,f.willChange="transform";else{var y="bottom"==d?-1:1,v="right"==g?-1:1;f[d]=l*y,f[g]=s*v,f.willChange=d+", "+g}var C={"x-placement":t.placement};return t.attributes=$({},C,t.attributes),t.styles=$({},f,t.styles),t},gpuAcceleration:!0,x:"bottom",y:"right"},applyStyle:{order:900,enabled:!0,fn:function(t){return j(t.instance.popper,t.styles),function(t,e){Object.keys(e).forEach((function(n){!1===e[n]?t.removeAttribute(n):t.setAttribute(n,e[n])}))}(t.instance.popper,t.attributes),t.offsets.arrow&&j(t.arrowElement,t.offsets.arrow),t},onLoad:function(t,e,n,o,r){var i=b(0,e,t),a=C(n.placement,i,e,t,n.modifiers.flip.boundariesElement,n.modifiers.flip.padding);return e.setAttribute("x-placement",a),j(e,{position:"absolute"}),n},gpuAcceleration:void 0}}},rt}));var GC="object"==typeof GC?GC:{};GC.Spread=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){var o,r;if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)n.d(o,r,(function(e){return t[e]}).bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s="./all.entry.js")}({"./all.entry.js":function(t,e,n){(GC=GC||{}).Spread=GC.Spread||{},GC.Spread=n("./node_modules_local/@grapecity/js-sheets-common/index.js"),GC.Spread.CalcEngine=n("./node_modules_local/@grapecity/js-calc/index.js"),GC.Spread.CalcEngine.BasicFunctions=n("./node_modules_local/@grapecity/js-calc-basicfunctions/index.js"),GC.Spread.CalcEngine.AdvancedFunctions=n("./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js"),GC.Spread.Sheets=n("./dist/core/core.entry.js"),GC.Spread.Sheets.Bindings=n("./dist/plugins/data/data.entry.js"),GC.Spread.Sheets.Outlines=n("./dist/plugins/group/group.entry.js"),GC.Spread.Sheets.CalcEngine=n("./dist/plugins/sheetsCalc/sheetsCalc.entry.js"),GC.Spread.Sheets.ConditionalFormatting=n("./dist/plugins/conditional/conditional.entry.js"),GC.Spread.Sheets.DataValidation=n("./dist/plugins/validation/datavalidation.entry.js"),GC.Spread.Sheets.Search=n("./dist/plugins/search/search.entry.js"),GC.Spread.Sheets.Touch=n("./dist/plugins/touch/touch.entry.js"),GC.Spread.Sheets.FloatingObjects=n("./dist/plugins/floatingObject/floatingobject.entry.js"),GC.Spread.Sheets.Sparklines=n("./dist/plugins/sparkline/sparkline-wrapper.entry.js"),GC.Spread.Sheets.Comments=n("./dist/plugins/comment/comment.entry.js"),GC.Spread.Sheets.CellState=n("./dist/plugins/cellState/cellstate.entry.js"),GC.Spread.Sheets.CellTypes=n("./dist/plugins/celltype/celltypes.entry.js"),GC.Spread.Sheets.Filter=n("./dist/plugins/filter/filter.entry.js"),GC.Spread.Sheets.Tables=n("./dist/plugins/table/table.entry.js"),GC.Spread.Sheets.Slicers=n("./dist/plugins/slicer/slicer.entry.js"),GC.Spread.Sheets.Fill=n("./dist/plugins/fill/fill.entry.js"),GC.Spread.Sheets.ContextMenu=n("./dist/plugins/contextMenu/context-menu.entry.js"),GC.Spread.Sheets.FormulaTextBox=n("./dist/plugins/formulaTextbox/formulaTextBox.entry.js"),GC.Spread.Sheets.OutlineColumn=n("./dist/plugins/outlineColumn/outlineColumn.entry.js"),GC.Spread.Sheets.DragMerge=n("./dist/plugins/dragMerge/dragMerge.entry.js"),GC.Spread.Sheets.StatusBar=n("./dist/plugins/statusBar/statusBar.entry.js"),GC.Spread.Sheets.AutoMerge=n("./dist/plugins/autoMerge/autoMerge.js"),GC.Spread.Sheets.Hyperlink=n("./dist/plugins/hyperlink/hyperlink.js"),t.exports=GC.Spread},"./dist/core/celltype/basecelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q;function J(t){var e=Z[t.charCodeAt(0)];return e?String.fromCharCode(e):t}function $(t,e,n){return g(t.x)||(t.x+=e.width),t.width=t.width-e.width-n.width,t}function K(t,e,n,o){var r,i,a=t.conditionalFormats;if(a)return r=t.getValue(e,n,o),i=a.oRa(t,e,n,r).iconSet,a.bp(e,n,o)&&i}function tt(t,e,n){var o,r,i=0;for(o=0;o<t.length;o++)void 0,r=t[o].style&&t[o].style.font?t[o].style.font:e,i=Math.max(y(r,F,C(t[o].text))/n,i),(t[o].style&&1===t[o].style.vertAlign||2===t[o].style.vertAlign)&&(i=Math.max(y(r,F,C(t[o].text))/n+2*a.To.No(r,W).fontSize*.218,i));return i}function et(t,e,n,o,r){var s,l,u,c,f,h=i.Vn.bm();if(!h)return 0;for(s=0,l=0;l<t.length;l++)u=void 0,u=t[l].style&&t[l].style.font?t[l].style.font:e,t[l].style&&t[l].style.vertAlign&&(u=a.To.No(u,W).font),b(h,u),"",c=l===t.length-1&&r?i.Vn.Rvb(t[l].text):t[l].text,f=0,o?f=y(u)*c.length/n:g(t[l].text)||(f=x(h,u,t[l].text)/n),s+=f;return s}function nt(t,e,n,o,r,i,s,l,u){var c,f,h,p=s.backColor,d=s.backgroundImage,g=s.textOrientation,m=s.isVerticalText,y=s.textIndent&&0!==s.textIndent,v=s.backgroundImageLayout,C=u.row,b=u.col,w=u.sheet&&u.sheet.getSpan(C,b),T=s&&(s.borderLeft||s.borderTop||s.borderRight||s.borderBottom),x=0,S=e;t.save(),g&&0!==g&&T&&l&&!w&&!m&&!y?(c=H(g*Math.PI/180),f=G(c),x=P(r/f),g>-90&&g<0&&(S=e-x),g>0&&g<90&&(S=e+x),h=function(){t.beginPath(),t.moveTo(S,n),t.lineTo(S+o,n),t.lineTo(e+o,n+r),t.lineTo(e,n+r),t.fill()}):h=function(){t.fillRect(e,n,o,r)},(p||d)&&(p&&a.To.setFillStyle(t,p,Math.min(S,e),n,o+x,r,h),X.ap(t,e,n,o,r,d,v,i)),t.restore()}function ot(t){return parseInt(16*t.zoom(),10)}function rt(t,e,n,o){var r=t.cellPadding,i=0,a=t.labelOptions;return n&&(r=a?a.margin:"0"),r&&(i=typeof(i=parseInt(at(r)[e],10))===O&&i>0?i:0),o===F?i:i*o}function it(t,e,n,o){var i,a,s,l,u=o&&o.sheet;u&&n&&(i=o.canvasOffset||u.mm.bG(),a=u.Dr(),(s=e.backColor||"white").stops&&(s=(l=s.stops)[0]&&l[0].color),s.backgroundColor&&(s=s.backgroundColor),r.GC$(t).width(n.width).height(n.height).css({top:i.top+a.y+n.y-2,left:i.left+a.x+n.x-2,"background-color":s}))}function at(t){var e,n,o,r,i=["0","0","0","0"];return typeof t===D&&(o=void 0,r=void 0,1===(n=(e=t.split(" ",4)).length)?i=[o=e[0],o,o,o]:2===n?i=[o=e[0],r=e[1],o,r]:3===n?(r=e[1],i=[e[0],r,e[2],r]):4===n&&(i=[e[0],e[1],e[2],e[3]])),i}function st(t,e){var n,o=rt(t,0),r=rt(t,2),i=rt(t,0,!0),a=rt(t,2,!0);if(rt(t,3,!0)+rt(t,1,!0)>=e.width)return!1;if((n=t.labelOptions.alignment)===F&&(n=t.labelOptions.alignment=0),0===n||1===n||2===n){if(o>0&&i+a<o)return!0}else if((3===n||4===n||5===n)&&o<e.height&&r>0&&i+a<r)return!0;return!1}function lt(t){var e="left";return 1===t||4===t?e="center":2!==t&&5!==t||(e="right"),e}function ut(t,e,n,o){var r=new i.Point(t.x,t.y),a=parseInt(n.fontSize,10),s=rt(e,0),l=rt(e,2),u=rt(e,3,!0),c=rt(e,1,!0),f=t.width,h=t.height,p=a>8?1:2,d=o-(o/2-a/2+(a>8?Math.floor((a-8)/5+2):1)-1)+rt(e,0,!0),g=d+1,m=s+l>h?s+d:h-l+d-1;switch(e.labelOptions.alignment){case 0:r.x+=u+p+1,r.y+=g;break;case 1:r.x+=u+(f-u-c)/2,r.y+=g;break;case 2:r.x+=f-c-2,r.y+=g;break;case 3:r.x+=u+p+1,r.y+=m;break;case 4:r.x+=u+(f-u-c)/2,r.y+=m;break;case 5:r.x+=f-c-2,r.y+=m}return r}function ct(t,e){var n,o,r;if(t.cellPadding){for(n=at(t.cellPadding),o=void 0,r=[],o=0;o<4;o++)r[o]=parseInt(n[o],10),"number"==typeof r[o]&&r[o]>0&&(r[o]*=e);t.cellPadding=r.join(" ")}}function ft(t,e,n){var o,r,i;if(m(e,D))return o=0,U[t.font+e]?o=U[t.font+e]:(o=x(t,t.font,e),U[t.font+e]=o),o;if(n&&e&&e[0]&&e[0].value)return e[0].value.length*y(t.font);for(r=0,i=0;i<e.length;i++)"fillingChar"!==e[i].type&&(o=0,U[t.font+e[i].value]?o=U[t.font+e[i].value]:(o=x(t,t.font,e[i].value),U[t.font+e[i].value]=o),r+=o);return r}function ht(t){for(var e=0;e<t.length;e++)if("fillingChar"===t[e].type)return!0;return!1}function pt(t,e,n,o,r){var i;return i=o?Math.floor(e/r):Math.floor(e/x(t,t.font,n)),Array(i+1).join(n)}function dt(t){var e=t.clone();return e.width--,e.height--,e}function gt(t,e,n){var o,r,i;for(o=0;o<t.length;o++)void 0,t[o].style=t[o].style||{},r=(i=t[o].style).font?a.To.No(i.font,n).font:e,i.font=r}function mt(t,e,n,o,r){var a=n*B(-o)+r*L(-o),s=n*B(-o)+r*L(-o),l=t-a/2,u=e-s/2;return new i.Rect(l,u,a,s)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/core.enum.js"),l=n("./dist/core/celltype/celltype.ns.js"),u=n("@grapecity/js-calc"),o.Common.F,c=o.Common.CultureManager,f=o.Common.o,h=o.Common.l,p=o.Common.pc,d=o.Common.j,g=d.Fa,m=d.Ma,y=i.Ul.fp,v=i.Ul.ol,C=i.Ul.uWa,b=i.Ul.lZa,w=i.Ul.hZa,T=i.Ul.K_a,x=i.Ul.pL,S=i.Ul.Fxb,A=i.Ul.lHb,I=r.GC$.extend,R=i.Ul.Ml,k="left",M="right",N="center",E="alphabetic",D="string",O="number",j=null,F=void 0,P=Math.floor,_=Math.ceil,L=Math.sin,B=Math.cos,G=Math.tan,H=Math.abs,V="General",z=Math.max,W=.7,U={},q="...",function(t){t[t.top=0]="top",t[t.right=1]="right",t[t.bottom=2]="bottom",t[t.left=3]="left"}(Y||(Y={})),X=function(){function t(){}return t.Gxb=function(t){var e,n,o=t.split("e")[1];if(o&&o.length>0&&("+"===o[0]?e=!0:"-"===o[0]&&(e=!1),n=o.slice(1)),void 0!==e)return{isAdd:e,length:n}},t.Apb=function(e,n,o){var r=t.Hxb,i=r[n+o];return i||(i=x(e,n,o),r[n+o]=i),i},t.Ixb=function(e,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x=r.font;if(o=o-1-3*i,a=r.textIndent&&0!==r.textIndent,s=r.isVerticalText,typeof n===O&&!0!==r.shrinkToFit&&!s&&!a){if(l=n<0,n=H(n),u=l?t.Apb(e,x,"-"):0,c=""+n,f=t.Gxb(c),h=void 0,p=t.Jxb(r._autoFormatter,n),f)return h=(""+f.length).length,h=z(h,2),t.Kxb(e,o,r,h,u,f.isAdd,p);if(d=u,g=t.Apb(e,x,"0"),m=c.split("."),d+=y=g*(""+Math.round(n)).length,v=t.Apb(e,x,"."),C=void 0,y<=o){if(!m[1]||0===m[1].length)return r._autoFormatter;if((d=d+m[1].length*g+v)<=o)return r._autoFormatter;if(n<.001)return h=(""+m[1].length).length,h=z(h,2),t.Kxb(e,o,r,h,u,!1,p);for(b=o-u-y-v,w=Math.floor(b/g),C="0",(w=Math.min(w,m[1].length))>0&&(C+="."),T=0;T<w;T++)C+="0";return C}return h=(""+(""+Math.round(n)).length).length,h=z(h,2),t.Kxb(e,o,r,h,u,!0,p)}return r._autoFormatter},t.Kxb=function(e,n,o,r,i,a,s){var l,u,c,f=o.font,h=t.Apb(e,f,"0"),p=t.Apb(e,f,"E"),d=t.Apb(e,f,"+"),g=t.Apb(e,f,"-"),m=n-i-r*h-p-(a?d:g)-h,y=m-t.Apb(e,f,".");if(y<=h)return a?"0E+00":m>0?"0E-00":"0";for(l=Math.floor(y/h),l=Math.min(l,s),u="0",c=0;c<l;c++)0===c&&(u+="."),u+="0";return u+(a?"E+00":"E-00")},t.Lxb=function(e,n,o,r,i){var a,s,l,u,c,f,h=r.font;if(o=o-1-3*i,a=r.textIndent||0,s=o,1!==r.hAlign&&a>0&&(s=o-8*a),s<x(e,r.font,n)){for(l=t.Apb(e,h,"#"),u=Math.floor(o/l),c="",f=0;f<u;f++)c+="#";return c}return n},t.ap=function(t,e,n,o,r,i,a,s){var l,u,c,f,h,p,d,g,m,y;if(i&&"none"!==i&&s)try{s.ko(i)?(l=s.lo(i),u=void 0,R.msie&&((u=document.createElement("div")).appendChild(l),document.body.appendChild(u)),c=l.width,f=l.height,R.msie&&(u.removeChild(l),document.body.removeChild(u)),0,0,h=c,p=f,d=o,g=r,m=e,y=n,1===a?(h=o>=c?c:o,p=r>=f?f:r,m=o>c&&c>0?_(e+o/2-c/2):e,y=r>f&&f>0?_(n+r/2-f/2):n,d=h,g=p):2===a?r>0&&f>0&&o/r>c/f?m=e+o/2-(d=c/f*r)/2:o>0&&c>0&&r/o>f/c&&(y=n+r/2-(g=f/c*o)/2):3===a&&(d=h=o>=c?c:o,g=p=r>=f?f:r),t.drawImage(l,0,0,h,p,m,y,d,g)):s.fo(i)}catch(t){}},t.cp=function(t,e,n,o,r){var a,s,l,u,c,f,h,p,d,g,m,v,C,b,w,T,x,S,A,R,k,M=0,N=r&&r.sheet,E=n.textIndent,O=n.hAlign,j=n.isVerticalText,F=n.textOrientation,P=n.borderTop||n.borderBottom||n.borderLeft||n.borderRight,_=n.font,G=r.row,V=r.col;if(F&&-90<=F&&F<=90&&(u=H(F*Math.PI/180),s=L(u),l=B(u)),N&&typeof e===D&&e)if(c=[],f=void 0,t&&t.richText)if(h=n.formatter||n._autoFormatter,d=(p=N.getCellType(G,V)).T_a(h,t.text),gt(f=I(!0,[],p.U_a(t,e,d,_,n.foreColor)),_,o),j)if(n.wordWrap){if(g=r.sheetArea,m=N.Sl(G),(v=N.ITa.findSpan(G,V,g))&&v.row>=G&&v.col>=V&&v.rowCount>1)for(C=G+1;C<G+v.rowCount;C++)m+=N.Sl(C);for(b=0,E>0&&(b=8*E),(w=rt(n,0))>0&&(m-=w),(T=rt(n,2))>0&&(m-=T),m++,c=i.Vn.M_a(e,m-3-b,_,f,j),a=0;a<c.length;a++)M+=tt(c[a].textInfos,_,o)}else M=tt(f,_,o);else{if(n.wordWrap){for(x=e.split(/\r\n|\r|\n/),a=0;a<x.length;a++)(S=[]).push(x[a]),c.push(S);for(c=i.Vn.O_a(c,i.Vn.P_a(f)),a=0;a<c.length;a++)M=Math.max(M,et(c[a],_,o,j,!0))}else M=et(f,_,o);1!==O&&E>0&&(M+=8*E/o),K(N,G,V,r.sheetArea)&&(M+=ot(N))}else if(c=e.split(/\r\n|\r|\n/),A=n.font,R=y(A)/o,j)if(n.wordWrap)for(a=0;a<c.length;a++)M+=R;else M=R;else{if(n.wordWrap){if(F)return k=N.Sl(G),i.Vn.mHb(G,V,s,l,e,A,k);for(a=0;a<c.length;a++)M=Math.max(M,i.Vn.Xn(c[a],A,!0)/o)}else M=F?P?(R+4)/s:l*(N.dp(e,A)/o)+R*s:N.dp(e,A)/o;1!==O&&E>0&&(M+=8*E/o),K(N,G,V,r.sheetArea)&&(M+=16)}return M},t.ep=function(t,e,n,o,r){var a,s,l,u,c,f,h,p,d,g,m,v,C,b,w,T,x,A,R,k,M,N,E,O,j,F,P,_=0,G=r&&r.sheet,V=n.font,z=n.isVerticalText,W=n.textIndent,U=n.vAlign,q=n.textOrientation,Y=r.row,X=r.col;if(q&&-90<=q&&q<=90&&(w=H(q*Math.PI/180),C=L(w),b=B(w)),G&&typeof e===D&&e)if(T=[],x=void 0,t&&t.richText)if(A=n.formatter||n._autoFormatter,k=(R=G.getCellType(Y,X)).T_a(A,t.text),gt(x=I(!0,[],R.U_a(t,e,k,V,n.foreColor)),V,o),z){if(n.wordWrap){for(M=e.split(/\r\n|\r|\n/),a=0;a<M.length;a++)(N=[]).push(M[a]),T.push(N);for(T=i.Vn.O_a(T,i.Vn.P_a(x)),a=0;a<T.length;a++)_=Math.max(_,et(T[a],V,o,z,!0))}else _=et(x,V,o,z);1!==U&&W>0&&(_+=8*W/o)}else if(n.wordWrap){if(s=r.sheetArea,l=G.Tl(X),(c=G.ITa.findSpan(Y,X,s))&&c.row>=Y&&c.col>=X&&c.colCount>1)for(f=X+1;f<X+c.colCount;f++)l+=G.Tl(f);for(p=0,W>0&&(p=8*W),d=rt(n,1),(g=rt(n,3))>0&&(l-=g),d>0&&(l-=d),l++,T=i.Vn.M_a(e,l-3-p,V,x),a=0;a<T.length;a++)_+=tt(T[a].textInfos,V,o)}else _=tt(x,V,o);else if(E=n.font,O=y(E)/o,z){if(n.wordWrap)for(T=e.split(/\r\n|\r|\n/),a=0;a<T.length;a++)j=T[a].length*O,_=Math.max(_,j);else _=e.length*O;1!==U&&W>0&&(_+=8*W/o)}else if(n.wordWrap){if(s=r.sheetArea,l=G.Tl(X),u=G.Sl(Y),(c=G.ITa.findSpan(Y,X,s))&&c.row>=Y&&c.col>=X&&c.colCount>1){for(f=X+1;f<X+c.colCount;f++)l+=G.Tl(f);for(h=Y+1;h<Y+c.colCount;h++)u+=G.Sl(h)}if(p=0,W>0&&(p=8*W),d=rt(n,1),(g=rt(n,3))>0&&(l-=g),d>0&&(l-=d),(m=rt(n,0))>0&&(u-=m),(v=rt(n,2))>0&&(u-=v),1===s&&(!!((F=G.rowFilter&&G.rowFilter())&&F.Dl(Y,X,s)&&F.filterButtonVisible(X))&&(l-=G.oK(new i.Rect(0,0,l,u),s).width)),q)return P=(u-O*b)/C,T=i.Vn.Wn(e,P,E),C*(G.dp(T[0],E)/o)+O*b;_=(T=S(t)?[e]:i.Vn.Wn(e,l-3-p,E)).length*O}else q?_=C*(G.dp(e,E)/o)+O*b:_=O;return _},t.gp=function(t,e,n,o,r,i,a,s,l,u,c){var f;1===l?(t.beginPath(),(f=t.createLinearGradient(e,n+1,e,n+r-2)).addColorStop(0,s.borderLeftColor),f.addColorStop(1,s.borderRightColor),t.strokeStyle!==f&&(t.strokeStyle=f),i.borderLeft||(t.moveTo(e+.5,n),t.lineTo(e+.5,n+r)),i.borderRight||(t.moveTo(e+o-.5,n),t.lineTo(e+o-.5,n+r)),u&&!i.borderTop&&(t.moveTo(e,n+.5),t.lineTo(e+o,n+.5)),t.stroke(),s.borderBottomWidth&&!i.borderBottom&&(t.beginPath(),t.strokeStyle!==s.borderBottomColor&&(t.strokeStyle=s.borderBottomColor),t.moveTo(e+1,n+r-.5),t.lineTo(e+o,n+r-.5),t.stroke())):(t.beginPath(),(f=t.createLinearGradient(e,n,e+o-2,n)).addColorStop(0,s.borderTopColor),f.addColorStop(1,s.borderBottomColor),t.strokeStyle!==f&&(t.strokeStyle=f),i.borderTop||(t.moveTo(e,n+.5),t.lineTo(e+o,n+.5)),i.borderBottom||(t.moveTo(e,n+r-.5),t.lineTo(e+o,n+r-.5)),c&&!i.borderLeft&&(t.moveTo(e+.5,n),t.lineTo(e+.5,n+r)),t.stroke(),s.borderRightWidth&&!i.borderRight&&(t.beginPath(),t.strokeStyle!==s.borderRightColor&&(t.strokeStyle=s.borderRightColor),t.moveTo(e+o-.5,n+1),t.lineTo(e+o-.5,n+r),t.stroke()))},t.hp=function(t,e){var n;n=2===e?"active":4===e?"inactive":0===e?"disabled":"auto",r.GC$(t).css("ime-mode",n)},t.bDc=function(t,e,n,o,r,i,a){var s,l;return!!(e&&"SparklineExValue"===e.typeName&&(s=a&&a.parent,s&&(l=s.getSparklineEx(e.name))))&&(l.paint(t,e.value,n,o,r,i,{zoomFactor:a.zoom(),sheet:a}),!0)},t.Hxb={},t.Jxb=function(t,e){var n,o,r,i,a;return t&&t.Ud&&((n=t.Ud(e).format(e))&&n[1]&&"decimalSeparator"===n[1].type)?(o=n[2])&&"number"===o.type?(r=o.value,a=(i=n[3])&&"exponent"===i.type&&i.value&&i.value.indexOf("E")>-1,!g(r)&&a?r.length:5):0:5},t.u5=rt,t}(),e.Context=X,Z={9001:65087,9002:65088,10216:65087,10217:65088,10092:65087,10093:65088,10096:65087,10097:65088,12296:65087,12297:65088,9121:65089,9126:65090,12300:65089,12301:65090,65378:65089,65379:65090,40:9180,41:9181,91:9140,93:9141,65339:9140,65341:9141,123:9182,125:9183,10100:9182,10101:9183,65115:9182,65116:9183,65371:9182,65373:9183,12310:65047,12311:65048,10098:65081,10099:65082,12308:65081,12309:65082,65117:65081,65118:65082,12304:65083,12305:65084,10218:65085,10219:65086,12298:65085,12299:65086,12302:65091,12303:65092},Q=function(){function t(){this.allowOverflow=!1,this.typeName="0"}return t.prototype.uxb=function(e,n,o,r){var i={ctx:e,options:{rect:n,context:o,value:r}};return t.ao(o.sheet,"paintCellPadding",i),i.options.rect},t.prototype.Mfc=function(e,n,o){var r={context:e,options:{dom:n,cellRect:o,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return t.ao(e.sheet,"onCreateCellEditor",r),r.options.dom},t.prototype.TBb=function(e,n,o){var r={ctx:null,options:{rect:n.clone(),context:e,value:null,style:o}};return t.ao(e.sheet,"getCellButtonRect",r),r.options.rect},t.prototype.Nfc=function(e,n,o,r){var a={context:e,options:{dom:n,cellRect:o,cellStyle:r,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return t.ao(e.sheet,"onActivateCellEditor",a),a},t.prototype.VBb=function(e,n,o,r){var a={context:e,contentContainer:n,editorBounds:o,cellStyle:r,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)};return t.ao(e.sheet,"onUpdateContainer",a),a},t.prototype.Ofc=function(e,n,o){var r={context:e,options:{dom:n,cellRect:o,contentRect:o.clone(),leftExternalRect:new i.Rect(0,0,0,0),rightExternalRect:new i.Rect(0,0,0,0)}};return t.ao(e.sheet,"onDeactivateCellEditor",r),r.options.dom},t.prototype.XBb=function(t,e,n){this.deactivateEditor(t,e),this.Ofc(e,t,n)},t.prototype.i5=function(t,e,n,o){var r,i,s,l,u,c,f,h,p,d,g=n.labelOptions;if(g&&(r=o.sheet,i=n.watermark)){if(s=g.visibility,l=r.getText(o.row,o.col,o.sheetArea),1===s||(2===s||s===F)&&""===l)return;1!==(u=r.zoom())&&ct(n,u),void 0,f=(c=g.font)?a.To.No(c,u):a.To.No(n.font,1),h=y(f.font),p=function(t,e){var n=rt(e,0),o=rt(e,3,!0),r=rt(e,2,!0),i=t.clone(),a=e.labelOptions.alignment;return 0===a||1===a||2===a?n<t.height&&(i.height=n-r+1):3!==a&&4!==a&&5!==a||(i.height=t.height-r),i.x+=o,i.width-=o+rt(e,1,!0),i}(e,n),d=void 0,st(n,e)&&(d=ut(e,n,f,h)),d&&(t.save(),t.textAlign=lt(g.alignment),t.textBaseline="alphabetic",b(t,f.font),t.fillStyle=g.foreColor||n.foreColor||"grey",t.rect(p.x,p.y,p.width,p.height),t.clip(),t.beginPath(),t.fillText(i,d.x,d.y),t.restore())}},t.prototype.f5=function(t,e){var n=t.clone(),o=rt(e,0),r=rt(e,1),i=rt(e,2),a=rt(e,3);return o>0&&(n.y+=o,n.height-=o),i>0&&(n.height-=i),a>0&&(n.x+=a,n.width-=a),r>0&&(n.width-=r),r+a>=t.width&&(n.width=0),o+i>=t.height&&(n.height=0),n},t.prototype.Ama=function(e,n,o,r){var i;return i={ctx:e,options:{rect:n=this.f5(n,o),context:r}},t.ao(r.sheet,"getCellPaddingRect",i),i.options.rect},t.prototype.e5=function(t,e,n,o){var a,s,l,u,c,f,h,p,d,g,m,v,C,b=n.labelOptions;b&&(s=(a=o.sheet).getText(o.row,o.col,o.sheetArea),l=n.watermark,1!==(u=b.visibility)&&l&&(c=b.font||n.font||a.yl.Bl(),1!==(f=a.zoom())&&(c=a.yl.Cl(c),ct(n,f)),h=y(c),st(n,e)&&(p=function(t,e){var n=rt(e,3,!0),o=rt(e,1,!0),r=rt(e,0,!0),i=rt(e,2,!0),a=t.clone(),s=e.labelOptions.alignment;return a.x=n+1,a.width-=n+o,0===s||1===s||2===s?(a.y=r,a.height=rt(e,0)-r-i):3!==s&&4!==s&&5!==s||(a.y=t.height-rt(e,2)+r,a.height=rt(e,2)-r-i),2!==s&&5!==s||(a.width-=2),a}(e,n)),p&&((d=r.GC$(i.Ul.Nl("span"))).text(l),g=(2===u||u===F)&&""===s,m=p.height-h,v=p.y+(g&&m>0?m:0),d.css({display:"block",position:"absolute",left:p.x,top:v,width:p.width,height:p.height,font:w(c),color:b.foreColor||n.foreColor||"grey",textAlign:lt(b.alignment),overflow:"hidden",whiteSpace:"nowrap"}).attr("gcUIElement","gcEditorLabel"),r.GC$(t).append(d),g&&(C=setInterval((function(){v--,d.css("top",v),v<=p.y&&clearInterval(C)}),20)))))},t.prototype.a5=function(t){var e,n,o=i.Ul.Nl("div");return o.style.cssText="position: absolute; margin: 0;padding: 0 ;overflow: hidden; box-sizing: content-box;resize: none;outline: none;border: 2px #5292f7 solid;box-shadow: 1px 2px 5px rgba(0,0,0,0.4);background-color: white",(e=i.Ul.Nl("div")).style.cssText="position: absolute; outline: none; border: none",r.GC$(o).append(r.GC$(e)),(n=this.createEditorElement(t,o))&&r.GC$(e).append(r.GC$(n)),this.Mfc(t,o,t.sheet.getCellRect(t.row,t.col)),o},t.prototype.d5=function(t,e,n,o){var r,i,a,s,l,u,c,f;t&&t.firstChild&&(r=this,it(t,e,i=dt(n),o),s=(a=r.Nfc(o,t,i,e)).options.contentRect,l=a.options.cellRect,u=a.options.leftExternalRect,c=a.options.rightExternalRect,r.e5&&r.e5(t,s,e,o),f=$(s=r.f5?r.f5(s,e):s,u,c),r.activateEditor(t.firstChild.firstChild,e,f,o,l,u,c))},t.prototype.updateEditorContainer=function(t,e,n,o,i,a,s){var l,u,c,f,h,p;t&&e&&((u=(l=t.parentNode)?l.parentNode:F)&&i&&(c=r.GC$(u),f=i.width,h=i.height,f>0&&(c.width(f),p=u.lastChild,n&&"gcEditorLabel"===p.getAttribute("gcUIElement")&&r.GC$(p).width(f-rt(n,3,!0)-rt(n,1,!0)-2)),h>0&&c.height(h),g(i.x)||c.css("left",i.x+"px"),g(i.y)||c.css("top",i.y+"px")))},t.prototype.g5=function(t,e,n,o,i){var a,s,l,u,c,f,h,p,d,g,m,y=this,v=t.firstChild,C=o.sheet,b=dt(n);it(t,e,b,o),a=y.VBb(o,v,b,e),i&&C&&ct(e,C.zoom()),r.GC$(v).css({left:(+r.GC$(v).css("left").replace("px","")||0)+rt(e,3),top:(+r.GC$(v).css("top").replace("px","")||0)+rt(e,0)}),s=a.editorBounds,l=a.contentRect,u=a.leftExternalRect,c=a.rightExternalRect,f=v.firstChild,h=$(l=y.f5?y.f5(l,e):l,u,c),p=y.updateEditor(f,e,h,o,s,u,c),d={width:u.width,height:u.height},g={width:c.width,height:c.height},m={width:!isNaN(p&&p.width)&&p.width+d.width+g.width>s.width?p.width+d.width+g.width:s.width,height:!isNaN(p&&p.height)&&p.height+d.height+g.height>s.height?p.height+d.height+g.height:s.height},y.updateEditorContainer(f,p,e,o,m,d,g)},t.prototype.h5=function(t,e,n,o,r){return this.getCellAndPaddingHitInfo(t,e,n,o,r)},t.prototype.X4=function(t,e,n,o,r){var i=function(t,e){var n={context:t,value:0,cellStyle:e};return Q.ao(t.sheet,"getCellButtonAutoWidth",n),n.value}(r,n)+function(t){var e={context:t,value:0};return Q.ao(t.sheet,"getOutlineColumnOffset",e),e.value}(r),a=this.getAutoFitWidth(t,e,n,o,r);return a>0&&(i+=a+rt(n,3,!1)+rt(n,1,!1)),i},t.prototype.Y4=function(t,e,n,o,r){var i=0,a=this.getAutoFitHeight(t,e,n,o,r);return a>0&&(i+=a+rt(n,0,!1)+rt(n,2,!1)),Math.max(function(t,e){var n={context:t,value:0,cellStyle:e};return Q.ao(t.sheet,"getCellButtonAutoHeight",n),n.value}(r,n),i)},t.prototype.paintValue=function(t,e,n,o,r,i,a,s){var l,u,c={};s.quotePrefix=a.quotePrefix,(l=this.format(T(e),a.formatter||a._autoFormatter,c,s))&&(u=this.Pfc(t,l,a,s,n,o,r,i),this.paintText(t,e,n,o,r,i,a,s,l,c,F,u.externals))},t.prototype.S_a=function(t,e,n){var o=0;return t>0&&(o=8*t),e&&e.XQa(n)&&(o=0),o},t.prototype.T_a=function(t,e){return!!(!t||m(t,D)&&t===V||t&&t.formatString&&t.formatString()===V)||!(e&&(!isNaN(e)||"TRUE"===e.toUpperCase()||"FALSE"===e.toUpperCase())&&"@"!==t)},t.prototype.Qfc=function(t){var e,n=0;for(e=0;e<t.length;e++)n+=t[e].width;return n},t.prototype.Rfc=function(t){var e,n=0;for(e=0;e<t.length;e++)n+=t[e].height;return n},t.prototype.Sfc=function(e,n,o,r,i){var a={ctx:e,options:{rect:o,context:n,value:r,style:i}};t.ao(n.sheet,"beforePaintLabel",a)},t.prototype.Pfc=function(e,n,o,r,a,s,l,u){var c={ctx:e,text:n,rect:new i.Rect(a,s,l,u),style:o,context:r,externals:{left:[],right:[]}};return t.ao(r.sheet,"beforePaintText",c),c},t.prototype.Tfc=function(e,n,o,r,a,s,l,u,c){var f={ctx:e,style:n,context:o,textRect:new i.Rect(r,a,s,l),availRect:u};return t.ao(o.sheet,c,f),f},t.prototype.Ufc=function(t,e,n,o,r,i,a,s){return this.Tfc(t,e,n,o,r,i,a,s,"beforeFillTextArea")},t.prototype.Vfc=function(t,e,n,o,r,i,a,s){return this.Tfc(t,e,n,o,r,i,a,s,"afterFillTextArea")},t.prototype.paintText=function(t,e,n,o,r,i,a,s,l,u,c,f){var h,p,d,m=this;t.save(),t.beginPath(),h=a.textOrientation,p=a.textIndent&&0!==a.textIndent,d=a.isVerticalText,e&&e.richText&&e.richText.length>0||d?m.Fpb(t,e,n,o,r,i,a,s,l,u,c,f):0!==h&&!g(h)&&-90<=h&&h<=90&&!p&&!d?m.nHb(t,e,n,o,r,i,a,s,l,u,c,f):m.N$a(t,e,n,o,r,i,a,s,l,u,c,f),t.restore()},t.prototype.oHb=function(t,e,n,o,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,v,C,b,w,T=e.sheet,x=e.row,S=e.col,A=r.vAlign,I=e.sheetArea;for(c=0;c<n.length;c++)if(f=n[c].text,h=o[c].lineHeight,p=1===A?0:s,d=this.pHb(t,"0"),g="",(m=i)-1-2-p<f.length*h){if(m<3*d)u.push(0),g=q;else if(y=P((m-1-2-3*d-(1===A?0:s))/h),v=0,0===A){for(C=0;C<y;C++)g+=f[C];b=g.length,3*d+((g+=q).length-3)*h+s>m-1-2?(g=g.substring(0,g.length-4)+q,u.push(g.split(q)[0].length)):u.push(b)}else if(1===A){for(w=0;w<_(y/2);w++)g+=f.charAt(w),v=w;for(b=g.length,g+=q,w=_(f.length-y/2);w<f.length;w++)g+=f.charAt(w);3*d+(g.length-3)*h+s>m-1-2?(g=g.replace(f[v],""),u.push(g.split(q)[0].length)):u.push(b),l[c].y=a+(i-(3*d+(g.length-3)*h))/2}else{for(u.push(0),C=f.length-1;C>=f.length-y;C--)g=f[C]+g;3*d+((g=q+g).length-3)*h+s>m-1-2&&(g=g.replace(f[f.length-y],"")),l[c].y=a+i-s-(3*d+(g.length-3)*h)-2}n[c].textInfos[0].text=g,T.ITa.qHb(x,S,f,I)}else T.ITa.qHb(x,S,null,I)},t.prototype.Fpb=function(t,e,n,o,r,a,s,l,u,c,f,h){var p,d,g,m,y,b,w,T,x,S,A,R,k,E,D,O,j,F,P,_,L,B=this,G=new i.Rect(n,o,r,a),H=B.S_a(s.textIndent,l.sheet.outlineColumn,l.col),V=s.hAlign;if(3===V&&(V=v(V,e,s.formatter)),d=!!(p=s.isVerticalText)&&C(u),g=s.font,m=s.formatter||s._autoFormatter,y=B.T_a(m,e.text),b=I(!0,[],B.U_a(e,u,y,g,s.foreColor)),e&&e.richText&&e.richText.length>0&&(w=l.sheet?l.sheet.zoom():1,B.V_a(b,g,w)),T=0,x=0,h&&(T=B.Qfc(h.left),x=B.Qfc(h.right)),S=T+x,A={left:T,right:x},!s.wordWrap&&s.shrinkToFit&&B.W_a(b,r-S,a,s,g,1,p),R=B.X_a(t,u,s.font,p?a:r-S,H,p?s.vAlign:s.hAlign,s.wordWrap,p,b),k=B.Y_a(R,s,V,f),E=B.Z_a(t,s,n,o,r,a,s.wordWrap,l.cellOverflowLayout,V,H,p,R[0].textLength,k[0].lineHeight),D=!1,s.showEllipsis&&p&&!e.richText&&(D=!0),O=B.$_a(n,o,r,a,V,s.vAlign,H,p,d,R,k,A,D),j=R.length,F=[],D&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===R.length&&R[0].text)&&this.oHb(t,l,R,k,s,a,o,H,O,F),1===j&&c&&!y)B.__a(t,l.sheet,u,c,O[0].x,O[0].y,r,a,V,s,E.width,E.height,H,p,R[0].textLength,l,A,G);else{for(P=B.Wfc(R),_=O[0].x,t.textAlign===N?_-=P/2:t.textAlign===M&&(_-=P),B.Ufc(t,s,l,_,O[0].y,P,0,G),L=0;L<j;L++)B.a0a(t,l.sheet,O[L].x,O[L].y,k[L],V,R[L],F[L]);B.Ufc(t,s,l,_,O[0].x,P,0,G)}},t.prototype.Wfc=function(t){var e,n=t[0].textLength;for(e=0;e<t.length;e++)n=z(n,t[e].textLength);return n},t.prototype.pHb=function(t,e){var n=0,o=t.font+e;return U[o]?n=U[o]:(n=x(t,t.font,e),U[o]=n),n},t.prototype.rHb=function(t,e,n,o,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S=e&&e.content,A=t.sheetArea;if(s=S?e.content[0].value:n,l=this.pHb(o,s),u=t.sheet,c=t.row,f=t.col,h=r,p=0,d=this.pHb(o,"0"),p=this.pHb(o,q),l>h-1-2-(1===i?0:a)){if(g="",2===i)for(m=s.length-1;m>=0;m--){if(p>h-1-2-a){y=g.length,g=q+g.substring(1,y);break}g=(v=s.charAt(m))+g,p+=this.pHb(o,v)}else if(1===i){for(C=_((h-p)/d),m=0;m<C/2;m++)g+=v=s.charAt(m);for(g+=q,m=P(s.length-C/2);m<s.length;m++)g+=v=s.charAt(m);for(b=this.pHb(o,g);b>h-1-2&&g!==q;)T=(w=g.split(q))[0],x=w[1],g=T.length>x.length?T.substring(0,T.length-1)+q+x:T+q+x.substring(1,x.length),b=this.pHb(o,g)}else for(m=0;m<s.length;m++){if(p>h-1-2-a){y=g.length,g=g.substring(0,y-1)+q;break}g+=v=s.charAt(m),p+=this.pHb(o,v)}S?e.content[0].value=g:e.content=[{value:g,type:"text"}],u.ITa.qHb(c,f,s,A)}},t.prototype.N$a=function(t,e,n,o,r,l,u,c,f,h,d,m){var w,T,S,A,I,R,k,D,O,j,F,_,L,B,G,H,V,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,it,at,st,lt=this,ut=0,ct=u.textIndent,ft=u.wordWrap,ht=u.hAlign,pt=u.vAlign,dt=u.shrinkToFit,gt=u.textDecoration,mt="left",yt=2,vt=2,Ct=u.font,bt=0,wt=[],Tt=0,xt=c.sheet,St=new i.Rect(n,o,r,l);if(g(c.fontInfo)&&(c.fontInfo=a.To.No(u.font,xt.zoom())),w=parseInt(c.fontInfo.fontSize,10),g(c.lineHeight)&&(c.lineHeight=y(a.To.No(u.font,xt.zoom()).font,!1,C(f))),T=c.lineHeight,S=u.foreColor,S=i.Im._ob(xt,S),(A=h.conditionalForeColor)&&(S=A),d=g(u.opacity)?d:u.opacity,g(d)||((I=p.ec(S)).a=d,S=p.bc(I)),t.fillStyle!==S&&(t.fillStyle=S||"#000000"),ct>0&&(ut=8*ct),xt.outlineColumn&&xt.outlineColumn.XQa(c.col)&&(ut=0),3===ht&&(ht=v(ht,e,u.formatter)),b(t,Ct),R=0,k=0,m&&(R=lt.Qfc(m.left),k=lt.Qfc(m.right)),D=R+k,O={left:R,right:k},!ft&&dt)for(j=0,F={value:!1},_=0;_<3&&!1===F.value&&(L=t.measureText(f).width,(j=z(0,r-4-(1===ht?0:ut)-D))<L);_++)Ct=a.To.No(Ct,j/L,F,!0).font,b(t,Ct);if((B=xt.parent&&xt.parent.options.numbersFitMode===s.NumbersFitMode.overflow||!1)||(B=h&&h.content?!(!h.content||1!==h.content.length||"text"!==h.content[0].type):"string"==typeof e&&e===f),!ft&&!dt&&u.showEllipsis&&B&&this.rHb(c,h,f,t,r,ht,ut),yt+=ut+R,1===ht?(yt=(r+R-k)/2,mt=N):2===ht&&(yt=r-k-1-2,yt-=ut,mt=M),t.textAlign!==mt&&(t.textAlign=mt),G=0,ft&&(G=r-D-3-ut,G-=1,(Tt=(wt=i.Vn.Wn(f,G,Ct,!1,t)).length)>1&&0!==pt&&(bt=(Tt-1)*T)),vt+=T-(V=T/2-w/2+(H=w>8?P((w-8)/5+2):1)-1),1===pt?vt=(l-bt)/2+T/2-V:2===pt&&(vt=l-bt-2-V),t.textBaseline!==E&&(t.textBaseline=E),q={x:(U=(W=c.cellOverflowLayout)&&W.layout)?U.x:n+1,y:U?U.y:o+1,width:U?U.width:r-2,height:U?U.height:l-2},Y=U&&U.width>r,X=q.x,Z=q.y,Q=q.width,J=q.height,ft)if(t.rect(X,Z,Q,J),t.clip(),t.beginPath(),$=o+vt,Tt>1){for(K=n+yt,t.textAlign===N?K-=G/2:t.textAlign===M&&(K-=G),lt.Ufc(t,u,c,K,$,G,T*Tt,St),_=0;_<Tt;_++)t.fillText(wt[_],n+yt,$),gt&&(L=t.measureText(wt[_]).width,lt.ip(t,gt,n+yt,$,L,w,H)),$+=T;lt.Ufc(t,u,c,K,$,G,T*Tt,St)}else lt.Oja(t,f,h,n+yt,o+vt,ht,Q,ut,gt,H,w,c,u,O,St,Y);else et=(tt=x(t,t.font,f))>Q-(n+1-X)||T>J,nt=rt(u,0),ot=rt(u,1),it=rt(u,2),at=rt(u,3),et||(1===ht?W&&(((st=tt/2)>W.backgroundLeftWidth||st>W.backgroundRightWidth)&&(et=!0)):(tt+ut+nt+it>Q||bt+at+ot>J)&&(et=!0)),et&&(t.rect(X,Z,Q,J),t.clip(),t.beginPath()),lt.Oja(t,f,h,n+yt,o+vt,ht,Q,ut,gt,H,w,c,u,O,St,Y)},t.prototype.nHb=function(t,e,n,o,r,s,l,u,c,f,h,d){var m,y,C,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,_,V,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,it,at,st=this,lt=l.wordWrap,ut=l.hAlign,ct=l.vAlign,ft=l.shrinkToFit,ht=l.textDecoration,pt=2,dt=2,gt=l.font,yt=[],vt=0,Ct=parseInt(u.fontInfo.fontSize,10),bt=u.sheet,wt=new i.Rect(n,o,r,s),Tt=u.cellOverflowLayout,xt=Tt&&Tt.layout,St=l&&(l.borderLeft||l.borderTop||l.borderRight||l.borderBottom)&&!bt.getSpan(u.row,u.col),At=l.textOrientation,It=At*Math.PI/180,Rt=H(It),kt=B(Rt),Mt=L(Rt),Nt=G(Rt),Et=u.lineHeight,Dt=90===At||-90===At;if(St&&(At>-90&&At<0&&(C=!1),At>0&&At<90&&(C=!0)),T=(w={x:xt?xt.x:n+1,y:xt?xt.y:o+1,width:xt?xt.width:r-2,height:xt?xt.height:s-2}).x,x=w.y,S=w.width,A=w.height,I=Et/2*L(Rt),R=Et/2*B(Rt),M=Et/2-Ct/2+(k=Ct>8?P((Ct-8)/5+2):1)-1,f&&f.content&&f.content.length>0&&!ft&&(c=st.sHb(t,f.content,s-4,gt)),N=bt.dp(c,gt),E=l.foreColor,E=i.Im._ob(bt,E),(D=f.conditionalForeColor)&&(E=D),h=g(l.opacity)?h:l.opacity,g(h)||((O=p.ec(E)).a=h,E=p.bc(O)),t.fillStyle!==E&&(t.fillStyle=E||"#000000"),3===ut&&(ut=v(ut,e,l.formatter,At)),b(t,gt),j=0,F=0,d&&(j=st.Qfc(d.left),F=st.Qfc(d.right)),!lt&&ft)for(_=0,V={value:!1},W=0;W<3&&!1===V.value&&(_=z(0,(s-4-2*R)/Mt))<N;W++)gt=a.To.No(gt,_/N,V,!0).font,b(t,gt),Ct=parseInt(u.fontInfo.fontSize,10),N=bt.dp(c,gt),I=(Et=i.Ul.fp(gt))/2*L(Rt),R=Et/2*B(Rt);if(U=0,q=0,lt)for(q=(s-4-2*R)/Mt,vt=(yt=i.Vn.Wn(c,q,gt,!1,t)).length,N=bt.dp(yt[0],gt),Y=0;Y<vt;Y++)(X=bt.dp(yt[Y],gt))>U&&(U=X);switch(s<=(lt?U:N)*Mt+2*R&&(ct=2),m=N/2*kt,y=(lt?U:N)/2*Mt,""+ut+ct){case"00":pt+=m+I+j,dt+=y,Dt||(dt+=R),St&&(pt=(s-dt)/Nt*(C?1:-1)+(Et/2+2)/Mt);break;case"01":pt+=m+I+j,dt=s/2,St&&(pt=(s-dt)/Nt*(C?1:-1)+(Et/2+2)/Mt);break;case"02":pt+=m+I+j,dt+=y,Dt||(dt+=R),St&&(pt=dt/Nt*(C?1:-1)+(Et/2+2)/Mt),dt=s-dt;break;case"10":pt=(r+j-F)/2,dt+=y,Dt||(dt+=R),St&&(pt+=(C?1:-1)*(s-dt)/Nt);break;case"11":pt=(r+j-F)/2,dt=s/2,St&&(pt+=(C?1:-1)*(s-dt)/Nt);break;case"12":pt=(r+j-F)/2,dt+=y,Dt||(dt+=R),St&&(pt+=(C?1:-1)*dt/Nt),dt=s-dt;break;case"20":pt=r-2-m-I-F,dt+=y,Dt||(dt+=R),St&&(pt=r+(s-dt)/Nt*(C?1:-1)-(Et/2+2)/Mt);break;case"21":pt=r-2-m-I-F,dt=s/2,St&&(pt=r+(s-dt)/Nt*(C?1:-1)-(Et/2+2)/Mt);break;case"22":pt=r-2-m-I-F,dt+=y,Dt||(dt+=R),St&&(pt=r+dt/Nt*(C?1:-1)-(Et/2+2)/Mt),dt=s-dt}if(lt)if(Z=n+pt,Q=Et/Mt,J=void 0,vt>1){for(1===ut&&(Z-=vt%2!=0?Q*(vt-1)/2:Q*(vt/2)-.5*Q),K=($=mt(Z,o+dt,N,It,Et)).width+Q*(vt-1),tt=$.height,et=2===ut?$.x-Q*(vt-1):$.x+Q*(vt-1),nt=$.y,st.Ufc(t,l,u,et,nt,K,tt,wt),W=0;W<vt;W++)J=W,(l.textOrientation>0&&2===ut||l.textOrientation<0&&(0===ut||1===ut))&&(J=vt-W-1),st.tHb(t,It,yt[J],Z,o+dt,ht,Ct,k,M),Z=2===ut?Z-Q:Z+Q;st.Ufc(t,l,u,et,nt,K,tt,wt)}else st.Xfc(t,c,n,o,pt,dt,u,l,N,It,ht,Ct,k,Et,M,wt);else ot=N*Mt+Ct*Mt+2,it=rt(l,0),at=rt(l,2),(ot>A-(o+1-x)||Et>A||ot+it+at>A)&&(t.rect(T,x,S,A),t.clip()),st.Xfc(t,c,n,o,pt,dt,u,l,N,It,ht,Ct,k,Et,M,wt)},t.prototype.Xfc=function(t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g){var m=this,y=mt(n,o,l,u,p),v=y.width,C=y.height,b=y.x,w=y.y;m.Ufc(t,s,a,b,w,v,C,g),m.tHb(t,u,e,n+r,o+i,c,f,h,d),m.Ufc(t,s,a,b,w,v,C,g)},t.prototype.V_a=function(t,e,n){gt(t,e,n)},t.prototype.W_a=function(t,e,n,o,r,i,s){var l,u,c,f=0,h={value:!1};for(l=0;l<3&&!1===h.value&&(u=et(t,r,i,s),f=z(0,(s?n:e)-4),(s?o.vAlign:1!==o.hAlign&&o.textIndent)&&(f=z(0,f-8*o.textIndent)),f<u);l++)for(c=0;c<t.length;c++)t[c].style.font=a.To.No(t[c].style.font,f/u,h,!0).font},t.prototype.U_a=function(t,e,n,o,r){var i=t.richText;return!g(i)&&n||(i=[{style:{font:o,foreColor:r},text:e}]),i},t.prototype.Z_a=function(t,e,n,o,r,i,a,s,l,u,c,f,h){var p=s&&s.layout,d={x:p?p.x:n+1,y:p?p.y:o+1,width:p?p.width:r-2,height:p?p.height:i-2},g=d.x,m=d.y,y=d.width,v=d.height;return a?(t.rect(g,m,y,v),t.clip(),t.beginPath()):this.b0a(e,l,e.vAlign,n,o,v,y,g,m,f,h,u,c,s)&&(t.rect(g,m,y,v),t.clip(),t.beginPath()),d},t.prototype.b0a=function(t,e,n,o,r,i,a,s,l,u,c,f,h,p){var d,g,m=rt(t,0),y=rt(t,1),v=rt(t,2),C=rt(t,3);return h?(!(d=u>i-(r+1-l)||c>a)&&1!==n&&u+f+m+v>i||c+C+y>a)&&(d=!0):(d=u>a-(o+1-s)||c>i)||(1===e?p&&(((g=u/2)>p.backgroundLeftWidth||g>p.backgroundRightWidth)&&(d=!0)):(u+f+C+y>a||c+m+v>i)&&(d=!0)),d},t.prototype.X_a=function(t,e,n,o,r,s,l,u,c){var f,h,p,d,g;if(1!==s?o=o-3-r:o-=3,l)return i.Vn.M_a(e,o,n,c,u,t);for(f=0,h=0;h<c.length;h++)p=c[h].text,u?f+=y(c[h].style.font)*(p?p.length:0):(d=a.To.No(c[h].style.font,1),g=c[h].style.vertAlign?d.fontSize*W+"px "+d.fontFamily:c[h].style.font,f+=x(t,g,p));return[{textLength:f,text:e,textInfos:c}]},t.prototype.__a=function(t,e,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v){var C,b,w=c.font,T=a.To.No(w,1).fontSize,x=T>8?P((T-8)/5+2):1;this.L$a(t,e,c),(C=o.conditionalForeColor)&&t.fillStyle!==C&&(t.fillStyle=C),d?this.c0a(t,n,o,c,r,i,h,p,h,m,y,v):(b=f>s,this.Oja(t,n,o,r,i,u,f,p,c.textDecoration,x,T,m,c,y,v,b,g))},t.prototype.c0a=function(t,e,n,o,r,i,a,s,l,u,c,f){var h,p,d,g=n.content,m=i;if(this.Ufc(t,o,u,r,m,l,l*e.length,f),g&&g.length>0)for(p=(p=a-s-ft(t,g,!0)-2)>0?p:0,void 0,h=0;h<g.length;h++)"fillingChar"===g[h].type?(d=pt(t,p,g[h].value,!0),this.vWa(t,d,r,i),i+=p):"placeholder"===g[h].type?i+=g[h].value?g[h].value.length*l:0:"numberPlaceholder"===g[h].type?i+=l:(this.vWa(t,g[h].value,r,i),i+=g[h].value?g[h].value.length*l:0);else if(e)for(h=0;h<e.length;h++)i=this.vWa(t,e[h],r,i,l).y;this.Vfc(t,o,u,r,m,l,i-m,f)},t.prototype.d0a=function(t){var e=k;return 1===t?e=N:2===t&&(e=M),e},t.prototype.a0a=function(t,e,n,o,r,i,a,s){var l,u,c=[],f=a.textInfos;for(l=0;l<f.length;l++)c.push(I(!0,{},r,f[l].style));for(l=0;l<f.length;l++)n=(u=this.f0a(t,e,n,o,c[l],f[l].text,s)).x,o=u.y},t.prototype.Y_a=function(t,e,n,o){var r,i,a=[],s=t.length;for(r=0;r<s;r++)i=this.g0a(e,n,o,t[r].textInfos),a.push(i);return a},t.prototype.g0a=function(t,e,n,o){var r,i,s,l=0,u=0;for(r=0;r<o.length;r++)void 0,i=o[r].style&&o[r].style.font?o[r].style.font:t.font,l=Math.max(y(i,F,C(o[r].text)),l),u=Math.max(a.To.No(i,1).fontSize,u),(o[r].style&&1===o[r].style.vertAlign||2===o[r].style.vertAlign)&&(l=Math.max(y(i,F,C(o[r].text))+2*a.To.No(i,W).fontSize*.218,l));return{lineHeight:l,fontSize:u,baselineOffset:s=u>8?P((u-8)/5+2):1,lineOffset:l/2-u/2+s-1,font:t.font,foreColor:t.foreColor,textDecoration:t.textDecoration,isVerticalText:t.isVerticalText,textAlign:this.d0a(e),textBaseline:E,opacity:n}},t.prototype.h0a=function(t,e,n){var o,r=0,i=0;for(o=0;o<t.length;o++)i+=e[o].lineHeight,r=Math.max(t[o].textLength,r);return{width:n?i:r,height:n?r:i}},t.prototype.$_a=function(t,e,n,o,r,i,a,s,l,u,c,f,h){var p,d=this.h0a(u,c,s),g=d.height,m=d.width,y=[];if(s)for(p=0;p<u.length;p++)y.push(this.i0a(t,e,n,o,r,i,a,m,u[p].textLength,c[p].lineHeight,c[p].lineOffset,l,f,u[p],h)),l?t-=c[p].lineHeight:t+=c[p].lineHeight;else for(p=0;p<u.length;p++)y.push(this.j0a(t,e,n,o,r,i,a,u[p].textLength,g,c[p].lineHeight,c[p].lineOffset,f)),e+=c[p].lineHeight;return y},t.prototype.j0a=function(t,e,n,o,r,i,a,s,l,u,c,f){var h=0,p=f.left,d=f.right;return 1===r?h=(n-s+p-d)/2:2===r?(h=n-1-2-s-d,h-=a):h=2+a+p,{x:t+h,y:e+(1===i?(o-l)/2+u-c:2===i?o-l-2+u-c:2+u-c)}},t.prototype.i0a=function(t,e,n,o,r,i,a,s,l,u,c,f,h,p,d){var g=0,m=h.left,y=h.right;return f?0===r?g=2+s+y-u/2:1===r?g=(n-m+y+s)/2-u/2:2===r&&(g=n-m-1-2-u/2):1===r?g=(n-s+m-y)/2+u/2:2===r?g=n-1-2-y-s+u/2:0===r&&(g=2+m+u/2),{x:t+g,y:e+(1===i?(o-l)/2:2===i?o-a-l-2:2+a)}},t.prototype.f0a=function(t,e,n,o,r,i,a){var s,l;return t.save(),this.L$a(t,e,r),s=r.vertAlign,l=r.isVerticalText?this.vWa(t,i,n,o,r.textDecoration,r.baselineOffset,a):this.k0a(t,n,o,r,i,s),t.restore(),l},t.prototype.L$a=function(t,e,n){var o,r,a=n.foreColor,s=n.opacity;a=i.Im._ob(e,a),g(s)||((o=p.ec(a)).a=s,a=p.bc(o)),t.fillStyle!==a&&(t.fillStyle=a),r=n.vertAlign?this.l0a(n.font):n.font,g(n.textBaseline)||t.textBaseline===n.textBaseline?g(t.textBaseline)&&t.textBaseline!==E&&(t.textBaseline=E):t.textBaseline=n.textBaseline,n.isVerticalText?t.textAlign!==N&&(t.textAlign=N):t.textAlign!==k&&(t.textAlign=k),b(t,r)},t.prototype.l0a=function(t){var e=a.To.Ko(t),n=parseFloat(e.fontSize)*W;return e.fontSize=n+"px",this.m0a(e)},t.prototype.m0a=function(t){var e="",n="normal",o=t.fontStyle,r=t.fontSize,i=t.fontWeight,a=t.fontFamily;return e=void 0!==o?o:n,e+=void 0!==i?(e?" ":"")+i:(e?" ":"")+n,(e+=(e?" ":"")+r)+(void 0!==a?(e?" ":"")+a:(e?" ":"")+"Calibri")},t.prototype.vWa=function(t,e,n,o,r,i,s){var l,u,c,f,h,p,d,g,m;if(e&&e.length>0)for(l=t.font,u=y(l,F,C(e)),c=function(t,e){return e/2-t/2+(t>8?P((t-8)/5+2):1)-1}(a.To.No(l,1).fontSize,u),h=(f=this.pHb(t,"0"))/2,p=0;p<e.length;p++)d=J(e[p]),o=o+((g=void 0!==s&&p>=s&&p<=s+2&&(s+3===e.length||0===s&&s+3<e.length||0!==s&&s+3<e.length))?f:u)-(m=g?h:c),t.fillText(d,n,o),this.Mxb(t,r,n,o,x(t,t.font,d),a.To.No(t.font,1).fontSize,i),o+=m;return{x:n,y:o}},t.prototype.Mxb=function(t,e,n,o,r,i,a){var s,l,u,c;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=0,u=.5,l=P(((i<=12?12:i)-12)/21+1),t.lineWidth!==l&&(t.lineWidth=l),0==(1&l)&&(u=0),(c=t.textAlign)===N?n-=r/2:c===M&&(n-=r),t.beginPath(),2==(2&e)&&(s=_(o+a-i/2)-u,t.moveTo(n,s),t.lineTo(n+r,s)),t.stroke()},t.prototype.k0a=function(t,e,n,o,r,i){var s,l,u,c,f;return g(r)?{x:e,y:n}:(l=(s=a.To.No(t.font,1).fontSize)>8?P((s-8)/5+2):1,u=0,i?(u=1===i?.74*s:.28*-s,t.fillText(r,e,n-u)):t.fillText(r,e,n),c=x(t,t.font,r),f=o.textDecoration,this.ip(t,f,e,n,c,s,l-u),{x:e+c,y:n})},t.prototype.jp=function(e,n,o,r,i,a,s,l){var u={row:l.row,col:l.col,sheet:l.sheet,sheetArea:l.sheetArea,style:s,underline:s.textDecoration,foreColor:s.foreColor};t.ao(l.sheet,"applyHyperlinkStyle",u),this.paint(e,n,o,r,i,a,s,l)},t.prototype.paint=function(t,e,n,o,r,a,s,l){var u,c,f;t&&(u=s.backColor,l.parentBackColor!==u&&nt(t,n,o,r,a,l.imageLoader,s,e,l),c=this,f=new i.Rect(n,o,r,a),c.Sfc(t,l,f,e,s),c.i5&&(c.i5(t,f,s,l),f=c.f5(f,s)),l.cellOverflowLayout||c.uxb(t,f,l,T(e)),f.width>0&&f.height>0&&(s&&s.showEllipsis&&l.sheet.ITa.qHb(l.row,l.col,null,l.sheetArea),c.paintContent(t,e,f.x,f.y,f.width,f.height,s,l)))},t.prototype.paintContent=function(t,e,n,o,r,a,s,l){var u,c,f,h,p,d,g,m,y=l.sheetArea;2!==y&&1!==y||(u=l.visualState||0,c="columnHeader",2===y&&(c="rowHeader"),f=this.getThemeStyle(l.visualState,"gc-"+c+"-"+i.Im.Jm(u)),X.gp(t,n,o,r,a,s,c,f,y)),(p=l.conditionalFormats)&&(h=p.jp(t,T(e),n,o,r,a,s,l)),l.showBarIconOnly=h,(d=l.sparkline)&&d.paintSparkline(t,n,o,r,a),g=X.bDc(t,T(e),n,o,r,a,l.sheet),l.cellOverflowLayout||h||g||(m=new i.Rect(n,o,r,a),function(t,e,n,o,r,i){if(0===t&&K(e,n,o,r)){var a=ot(e);i.x+=a,i.width-=a}}(s.hAlign,l.sheet,l.row,l.col,l.sheetArea,m),this.paintValue(t,e,m.x,m.y,m.width,m.height,s,l))},t.prototype.createEditorElement=function(t,e){return j},t.prototype.getEditorValue=function(t,e){return j},t.prototype.kp=function(t,e,n,o){return n},t.prototype.setEditorValue=function(t,e,n){},t.prototype.getEditingElement=function(){return j},t.prototype.parse=function(t,e,n){var r,i=g(e),a=g(t);try{if(r=o.Formatter&&o.Formatter.GeneralFormatter,!i&&!a&&r)return(typeof e===D?new r(e):e).parse(t)}catch(t){}return a?"":""+t},t.prototype.format=function(t,e,n,r){var a,s,l,p=A(e);if(r&&p&&(a=r.sheet.aHb(r.row,r.col,e),g(a)||(t=a)),g(t)||""===t)return"";if(r&&r.quotePrefix)return""+t;if(!p&&typeof e===D&&"object"!=typeof t)return i.mn.un(t,e,n);if(!e||"General"===e||p)return"boolean"==typeof t||t instanceof Boolean?(u&&(t=t?u.getBoolean().boolean_true:u.getBoolean().boolean_false),(""+t).toUpperCase()):t instanceof Date?(l=(s=c.q4(c.culture()).DateTimeFormat).shortDatePattern,0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(l=s.defaultDatePattern),h.Vb(t,l)):(typeof t===O&&(t=f.nb(""+t)),""+t);try{return o.Formatter&&o.Formatter.GeneralFormatter?(j,(typeof e===D?i.mn.tn(e):e).format(t,n)):""+t}catch(e){return""+t}},t.prototype.focus=function(t,e){t&&t.focus&&t.focus()},t.prototype.getThemeStyle=function(t,e){return i.Im.Km(t,e)},t.prototype.activateEditor=function(t,e,n,o,r,i,a){},t.prototype.deactivateEditor=function(t,e){},t.prototype.selectAll=function(t,e){t&&t.select&&t.select()},t.prototype.updateEditor=function(t,e,n,o,r,i,a){},t.prototype.setImeMode=function(t,e,n){this.isImeAware(n)?this.updateImeMode(t,e,n):t&&X.hp(t,0)},t.prototype.updateImeMode=function(t,e,n){t&&X.hp(t,e)},t.prototype.getHitInfo=function(t,e,n,o,r){return j},t.prototype.getCellAndPaddingHitInfo=function(e,n,o,r,i){var a,s;if(i){if(a={x:e,y:n,context:i,cellStyle:o,cellRect:r,paddingHitInfo:null},t.ao(i.sheet,"getCellButtonHitInfo",a,(function(){return null!==a.paddingHitInfo&&void 0!==a.paddingHitInfo})),s=a.paddingHitInfo,a.paddingHitInfo&&!g(a.paddingHitInfo.cellButtonHitInfo)&&!g(a.paddingHitInfo.cellButtonHitInfo.buttonConfig))return a.paddingHitInfo;if(a.cellRect=this.f5?this.f5(a.cellRect,o):a.cellRect,t.ao(i.sheet,"getCellTextHitInfo",a,(function(){return!g(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo&&a.paddingHitInfo.isReservedLocation)return a.paddingHitInfo;if(3===i.sheetArea)return t.ao(i.sheet,"getCellPaddingHitInfo",a,(function(){return!g(a.paddingHitInfo)&&a.paddingHitInfo.isReservedLocation})),a.paddingHitInfo?a.paddingHitInfo:s||this.getHitInfo(e,n,o,r,i)}return this.getHitInfo(e,n,o,r,i)},t.prototype.processCellAndPaddingMouseDown=function(e){return t.ao(e.sheet,"processMouseDownOnCellPadding",e),this.processMouseDown(e)},t.prototype.processMouseDown=function(t){return!1},t.prototype.YBb=function(e){return t.ao(e.sheet,"processMouseMoveOnCellPadding",e),this.processMouseMove(e)},t.prototype.processMouseMove=function(t){return!1},t.prototype.XGb=function(e){return t.ao(e.sheet,"processMouseUpOnCellPadding",e),this.processMouseUp(e)},t.prototype.processMouseUp=function(t){return!1},t.prototype.processMouseEnter=function(t){return!1},t.prototype.ZBb=function(e){return t.ao(e.sheet,"processMouseLeaveOnCellPadding",e),this.processMouseLeave(e)},t.prototype.processMouseLeave=function(t){return!1},t.prototype.isReservedKey=function(t,e){return!1},t.prototype.isEditingValueChanged=function(t,e,n){return n.klb&&(t=t.replace(/\r\n?/g,"\n")),t!==e},t.prototype.processKeyDown=function(t,e){return!1},t.prototype.processKeyUp=function(t,e){return!1},t.prototype.getAutoFitWidth=function(t,e,n,o,r){return X.cp(t,e,n,o,r)},t.prototype.getAutoFitHeight=function(t,e,n,o,r){return X.ep(t,e,n,o,r)},t.prototype.Oja=function(t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y){var v;n&&n.content&&n.content.length>0&&(y||!g)?this.Pja(t,n.content,o,r,i,a,s,l,u,c,f,h,p,d,m):(m=m||x(t,t.font,e),v=o,t.textAlign===N?v-=m/2:t.textAlign===M&&(v-=m),this.Ufc(t,h,f,v,r,m,f.lineHeight,d),t.fillText(e,o,r),l&&this.ip(t,l,o,r,m,c,u),this.Vfc(t,h,f,v,r,m,f.lineHeight,d))},t.prototype.tHb=function(t,e,n,o,r,i,a,s,l){if(t.save(),t.textAlign="center",t.textBaseline="middle",t.translate(o,r),t.rotate(-e),t.fillText(n,0,0),i){var u=t.measureText(n).width;this.ip(t,i,0,l,u,a,s)}t.restore()},t.prototype.sHb=function(t,e,n,o){var r,i,a;for(t.font||b(t,o),r=(r=n-ft(t,e))>0?r:0,i=[],a=0;a<e.length;a++)if("fillingChar"===e[a].type)i.push(pt(t,r,e[a].value));else{if("placeholder"===e[a].type||"numberPlaceholder"===e[a].type)continue;i.push(e[a].value)}return i.join("")},t.prototype.Pja=function(t,e,n,o,r,i,a,s,l,u,c,f,h,p,d){var m,y,v,C,b;t.save(),t.textAlign!==k&&(t.textAlign=k),C=(C=i-a-(m=ft(t,e))-((y=h?h.left:0)+(v=h?h.right:0))-2)>0?C:0,g(d)?ht(e)?1===r?(n-=(i+y-v)/2,n+=a+y):2===r&&(n=n-i+v+2,n+=a+y):g(m)||(1===r?n-=m/2:2===r&&(n-=m)):ht(e)?1===r?(n=n+(d||m)/2-(i+y-v)/2,n+=a+y):2===r&&(n=n+(d||m)-i+v+2,n+=a+y):g(m)||(1===r?n=n+d/2-m/2:2===r&&(n=n+d-m)),this.Ufc(t,f,c,n,o,m,c.lineHeight,p),b=this.Qja(t,e,n,o,C,s,l,u),this.Vfc(t,f,c,n,o,b-n,c.lineHeight,p),t.restore()},t.prototype.Qja=function(t,e,n,o,r,i,a,s,l){var u,c,f,h=0;for(U[t.font+"0"]?h=U[t.font+"0"]:(h=x(t,t.font,"0"),U[t.font+"0"]=h),u=0;u<e.length;u++)"fillingChar"===e[u].type?(t.fillText(pt(t,r,e[u].value),n,o),i&&this.ip(t,i,n,o,r,s,a),n+=r):"placeholder"===e[u].type?n+=x(t,t.font,e[u].value):"numberPlaceholder"===e[u].type?n+=h:((c=e[u].value)!==j&&t.fillText(c,n,o),f=x(t,t.font,c),i&&this.ip(t,i,n,o,f,s,a),n+=f);return n},t.prototype.ip=function(t,e,n,o,r,i,a){var s,l,u,c;t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),s=t.textAlign,l=0,c=.5,u=P(((i<=12?12:i)-12)/21+1),t.lineWidth!==u&&(t.lineWidth=u),0==(1&u)&&(c=0),s===N?n-=r/2:s===M&&(n-=r),t.beginPath(),4==(4&e)&&(l=_(o+a-i-1)-c,t.moveTo(n,l),t.lineTo(n+r,l)),2==(2&e)&&(l=_(o+a-i/2)-c,t.moveTo(n,l),t.lineTo(n+r,l)),1==(1&e)&&(l=_(o+a-1)-c,t.moveTo(n,l),t.lineTo(n+r,l)),8==(8&e)&&(l=_(o+a-1)-c,t.moveTo(n,l-u),t.lineTo(n+r,l-u),t.moveTo(n,l+u),t.lineTo(n+r,l+u)),t.stroke()},t.prototype.lp=function(t,e){var n="";4==(4&e)&&(n="overline"),2==(2&e)&&(n+=" line-through"),1==(1&e)&&(n+=" underline"),t.css("text-decoration",n)},t.prototype.gQa=function(){return j},t.prototype.isImeAware=function(t){return!1},t.prototype.isEditting=function(){return!1},t.prototype.toJSON=function(){var t,e={},n=this;for(t in n)n.hasOwnProperty(t)&&(e[t]=n[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)g(t[e])||(this[e]=t[e])},t}(),e.Base=Q,i.Zn(Q),l._o[0]=Q},"./dist/core/celltype/cellType.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/core/celltype/celltype.ns.js")),o(n("./dist/core/celltype/basecelltype.js")),o(n("./dist/core/celltype/textcelltype.js")),o(n("./dist/core/celltype/headercelltype.js"))},"./dist/core/celltype/celltype.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e._o={}},"./dist/core/celltype/headercelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function A(t,e){return t=t||0,c.Km(t,"gc-"+e+"-"+c.Jm(t))}function I(t,e,n,o,r,i){var a=new Image,s=i;s=(s=s.replace('url("',"")).replace('")',""),a.src=s,t.drawImage(a,e,n,o,r)}function R(t,e,n,o,r,i,s,c,f){var p,d,m,y,C,b,w,T,x,S,A,R,k;function M(){t.fillRect(e+1,n+1,o-1,r-1)}if(!g(c)){if(t.save(),t.beginPath(),p=i.backColor,0===c&&p)a.To.setFillStyle(t,p,e,n,o,r,M);else try{if(p=f&&f.backgroundColor,d=f&&f.backgroundImage,m=s.sheet,y=s.row,C=s.col,b=s.sheetArea,w=void 0,T=!1,m.cellStates&&c===u.VisualState.hover&&((w=m.cellStates.getStyle(y,C,b))&&w.backColor&&(p=w.backColor,T=!0)),!T&&d&&-1!==d.indexOf("linear-gradient")){for(x=h(d),S={degree:90,stops:[]},A=0,R=x.length;A<R;A++)k=x[A],S.stops.push({position:k.point,color:k.color});a.To.setFillStyle_Gradient(t,S,e,n,o,r,M)}else p?(t.fillStyle=p,M()):d&&d!==v&&I(t,e+1,n+1,o-1,r-1,d)}catch(t){}l.Context.ap(t,e,n,o,r,i.backgroundImage,i.backgroundImageLayout,s.imageLoader),t.restore()}}function k(t,e,n,o,r,a,s,u,c,f,h,p){var d,g,m;e&&(R(e,o,r,a,s,u,c,d=c.visualState||0,g=A(d,f)),l.Context.gp(e,o,r,a,s,u,f,g,h,c.needTopGridline,c.needLeftGridline),m=new i.Rect(o,r,a,s),t.Sfc(e,c,m,n,u),t.i5&&(t.i5(e,m,u,c),m=t.f5(m,u)),m.width>0&&m.height>0&&t.paintContent(e,n,m.x,m.y,m.width,m.height,u,c,p))}function M(t,e,n,o,r,i){var s,l={font:e,fillStyle:n},u=o.sheet;return 0!==o.visualState&&parseInt(i.zIndex,10)>2007&&u.vp(o.row,o.col,r)&&(void 0,s=u.wp(o.row,o.col,r)?t(o.visualState,"gc-columnHeader-selected"):t(o.visualState,"gc-columnHeader-highlight"),l.fillStyle=s.color,l.font=a.To.Ro(l.font,"bold")),l}function N(t,e,n,o,r,a,s,l,u,c,f,h){var p,d,g={},y=t.format(m(n),l.formatter,g),v=u.sheet;y&&(e.save(),e.beginPath(),(!!((p=v.rowFilter&&v.rowFilter())&&p.Dl(u.row,u.col,c)&&p.filterButtonVisible(u.col))||h)&&(a-=v.oK(new i.Rect(o,r,a,s),c).width),(d=l.foreColor)||(d=f.color),d&&e.fillStyle!==d&&(e.fillStyle=d),n&&n.richText&&n.richText.length>0||l.isVerticalText?E(t,v,e,n,o,r,a,s,l,y,g,u,c,f):D(t,e,n,o,r,a,s,l,y,g,u,c,f),e.restore())}function E(t,e,n,o,r,i,a,s,l,u,c,f,h,d){var g,v,C,w,T,x,S,A,I,R,k,N,E,D,O,j,F=new b(r,i,a,s),P=M(t.getThemeStyle,l.font||n.font,n.fillStyle,f,h,d),_=l.isVerticalText,L=l.hAlign,B=function(t){var e=0,n=t.textIndent;return n>0&&(e=8*n),e}(l),G=t.T_a(l.formatter||l._autoFormatter,o.text),H=y(!0,[],t.U_a(o,u,G,P.font,P.fillStyle));if(o&&o.richText&&o.richText.length>0&&(g=f.sheet?f.sheet.zoom():1,t.V_a(H,P,g)),v=t.Pfc(n,m(o),l,f,r,i,a,s),T=(C=t.Qfc(v.externals.left))+(w=t.Qfc(v.externals.right)),x={left:C,right:w},!l.wordWrap&&l.shrinkToFit&&t.W_a(H,a-T,s,l,P,1,_),S=t.X_a(n,u,l.font,_?s:a-T,B,_?l.vAlign:l.hAlign,l.wordWrap,_,H),A=t.Y_a(S,l,L),function(t,e,n,o,r,i,a,s,l){(!!e.wordWrap||(e.isVerticalText?s+a>i||l>r:s+a>r||l>i))&&(t.rect(n,o,r,i),t.clip(),t.beginPath())}(n,l,r,i,a,s,B,S[0].textLength,A[0].lineHeight),I=_?p(u):void 0,R=!1,l.wordWrap||l.shrinkToFit||!l.showEllipsis||!_||o.richText||(R=!0),k=t.$_a(F.x,F.y,F.width,F.height,L,l.vAlign,B,_,I,S,A,x,R),N=[],R&&c&&(c.content&&1===c.content.length&&"text"===c.content[0].type||!c.content&&1===S.length&&S[0].text)&&t.oHb(n,f,S,A,l,s,i,B,k,N),1===(E=S.length)&&c.content&&!G)t.__a(n,e,u,c,k[0].x,k[0].y,a,s,L,l,F.width,F.height,B,_,S[0].textLength,f,x,F);else for(D=0;D<E;D++)O=t.Wfc(S),j=k[0].x,"center"===n.textAlign?j-=O/2:"right"===n.textAlign&&(j-=O),t.Ufc(n,l,f,j,k[0].y,O,0,F),t.a0a(n,e,k[D].x,k[D].y,A[D],L,S[D],N[D]),t.Ufc(n,l,f,j,k[0].x,O,0,F)}function D(t,e,n,o,r,i,s,l,u,c,h,p,g){var m,y,v,w,T,x,S,A,I,R,k,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K=new b(o,r,i,s),tt=M(t.getThemeStyle,l.font||e.font,e.fillStyle,h,p,g);if(d(e,tt.font),e.fillStyle=tt.fillStyle,m=0,(y=l.textIndent)>0&&(m=8*y),v=parseInt(h.fontInfo.fontSize,10),w=l.hAlign,T=l.vAlign,x="left",S=2,A=t.Pfc(e,u,l,h,o,r,i,s),k=(I=t.Qfc(A.externals.left))+(R=t.Qfc(A.externals.right)),N={left:I,right:R},S+=m+I,1===w?(S=(i+I-R)/2,x="center"):2===w&&(S=i-R-1,S-=m,x="right"),e.textAlign!==x&&(e.textAlign=x),E=0,D="alphabetic",O=2,j=l.wordWrap,F=l.shrinkToFit,P=l.font,_=h.lineHeight,L=[],B=0,!j&&F)for(G=0,H={value:!1},V=0;V<3&&!1===H.value&&(z=e.measureText(u).width,(G=Math.max(0,i-4-(1===w?0:m)))<z);V++)P=a.To.No(P,G/z,H,!0).font,d(e,P);if(W=0,j&&(W=i-k-3-m,W-=1,(B=(L=f.Wn(u,W,tt.font)).length)>1&&0!==T&&(E=(B-1)*_)),q=_/2-v/2+(U=v>8?C((v-8)/5+2):1)-1,!j&&l.showEllipsis&&t.rHb(h,c,u,e,i,w,m),O+=_-q,1===T?O=(s-E)/2+_/2-q:2===T&&(O=s-E-2-q),e.textBaseline!==D&&(e.textBaseline=D),Y=l.textDecoration,X=K.x,Z=K.y,Q=K.width,J=K.height,l.wordWrap)if(e.rect(X,Z,Q,J),e.clip(),e.beginPath(),$=r+O,B>1){for(t.Ufc(e,l,h,o+S,$,W,_*B,K),V=0;V<B;V++)e.fillText(L[V],o+S,$),Y&&(z=e.measureText(L[V]).width,t.ip(e,Y,o+S,$,z,v,U)),$+=_;t.Ufc(e,l,h,o+S,$,W,_*B,K)}else t.Oja(e,u,c,o+S,r+O,w,Q,m,Y,U,v,h,l,N,K);else(e.measureText(u).width>Q||_>J)&&(e.rect(X,Z,Q,J),e.clip(),e.beginPath()),t.Oja(e,u,c,o+S,r+O,w,Q,m,Y,U,v,h,l,N,K,void 0,void 0,l.showEllipsis)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/celltype/celltype.ns.js"),l=n("./dist/core/celltype/basecelltype.js"),u=n("./dist/core/core.enum.js"),c=i.Im,f=i.Vn,h=i.Ul.wl,p=i.Ul.uWa,d=i.Ul.lZa,g=o.Common.j.Fa,m=i.Ul.K_a,y=r.GC$.extend,v="none",C=Math.floor,b=i.Rect,w=function(t){function e(){var e=t.call(this)||this;return e.typeName="2",e}return S(e,t),e.prototype.paint=function(t,e,n,o,r,i,a,s,l){k(this,t,e,n,o,r,i,a,s,"columnHeader",1,l)},e.prototype.paintContent=function(t,e,n,o,r,i,a,s,u){l.Context.bDc(t,m(e),n,o,r,i,s.sheet)||N(this,t,e,n,o,r,i,a,s,1,A(s.visualState,"columnHeader"),u)},e}(l.Base),e.ColumnHeader=w,s._o[2]=w,T=function(t){function e(){var e=t.call(this)||this;return e.typeName="3",e}return S(e,t),e.prototype.paint=function(t,e,n,o,r,i,a,s){k(this,t,e,n,o,r,i,a,s,"rowHeader",2)},e.prototype.paintContent=function(t,e,n,o,r,i,a,s){l.Context.bDc(t,m(e),n,o,r,i,s.sheet)||N(this,t,e,n,o,r,i,a,s,2,A(s.visualState,"rowHeader"))},e}(l.Base),e.RowHeader=T,s._o[3]=T,x=function(t){function e(){var e=t.call(this)||this;return e.typeName="4",e}return S(e,t),e.prototype.paint=function(t,e,n,o,r,i,a,s){var l,u,f,p,d,g,m,y,C,b,w,T,x,S,A;if(t){t.save(),t.rect(n,o,r,i),t.clip(),t.beginPath(),this,l=s.visualState||0;try{f=(u=this.getThemeStyle(s.visualState,"gc-corner-"+c.Jm(l)))&&u.backgroundColor,p=u&&u.backgroundImage,f?(t.fillStyle=f,t.fillRect(n,o,r,i)):p&&p!==v&&I(t,n,o,r,i,p)}catch(t){}if(g=(d=this.getThemeStyle(4,"gc-corner-triangle-"+c.Jm(l)))&&d.backgroundImage,m=d&&d.backgroundColor,y=t.createLinearGradient(n+r/2,o,n+r/2,o+i),g&&-1!==g.indexOf("linear-gradient")){for(b=0,w=(C=h(g)).length;b<w;b++)T=C[b],y.addColorStop(T.point,T.color);t.fillStyle=y}else m&&(y.addColorStop(.125,"#f6fafb"),y.addColorStop(1,m),t.fillStyle=y);(x=t.createLinearGradient(n+r,o+1,n+r,o+i-2)).addColorStop(0,d.borderLeftColor),x.addColorStop(1,d.borderRightColor),t.beginPath(),t.strokeStyle=x,t.moveTo(n+r-.5,o),t.lineTo(n+r-.5,o+i),t.stroke(),s.needLeftGridline&&(t.beginPath(),t.strokeStyle=d.borderLeftColor,t.moveTo(n+.5,o),t.lineTo(n+.5,o+i),t.stroke()),(S=t.createLinearGradient(n,o,n+r-2,o)).addColorStop(0,d.borderTopColor),S.addColorStop(1,d.borderBottomColor),t.beginPath(),t.strokeStyle=S,t.moveTo(n,o+i-.5),t.lineTo(n+r,o+i-.5),t.stroke(),s.needTopGridline&&(t.beginPath(),t.strokeStyle=d.borderTopColor,t.moveTo(n,o+.5),t.lineTo(n+r,o+.5),t.stroke()),t.beginPath(),3,A=i,r<i&&(A=r),t.moveTo(n+r-A+3,o+i-3),t.lineTo(n+r-3,o+i-3),t.lineTo(n+r-3,o+i-A+3),t.fill(),t.restore()}},e}(l.Base),e.Corner=x,s._o[4]=x},"./dist/core/celltype/textcelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function gt(t){return function(t){return ot||0===t}(t)?i.GC$(v("textarea")):i.GC$(v("div"))}function mt(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable}function yt(t){return mt(t)?b&&parseFloat(C.version)<10?g.Woa(t):t.innerText:t.value}function vt(t,e){mt(t)?t.innerText=e:t.value=e}function Ct(t){var e;return mt(t)?(e=tt.getSelection()).rangeCount>0?e.getRangeAt(0).startOffset:0:t.selectionStart}function bt(t){var e;return mt(t)?(e=tt.getSelection()).rangeCount>0?e.getRangeAt(0).endOffset:0:t.selectionEnd}function wt(t){return t&&"BR"===t.tagName}function Tt(t){return t&&"SPAN"===t.tagName}function xt(t){return t&&"DIV"===t.tagName}function St(t){return t instanceof Text}function At(t,e,n,o){return t.substr(0,e)+o+t.substr(n,t.length-n)}function It(t,e,n,o,r){var i,a,s=String.fromCharCode(function(t){var e=t.keyCode,n=t.shiftKey,o={106:42,107:43,109:45,110:46,111:47,173:45},r={186:59,187:61,188:44,189:45,190:46,191:47,192:96,219:91,220:92,221:93,222:39},i={186:58,187:43,188:60,189:95,190:62,191:63,192:126,219:123,220:124,221:125,222:34},a=e;return e>=96&&e<=105?a=e-48:o[e]?a=o[e]:n&&i[e]?a=i[e]:!n&&r[e]?a=r[e]:!n&&e>=65&&e<=90&&(a=e+32),a}(r));return mt(t)?(i=tt.getSelection()).rangeCount>0&&St((a=i.getRangeAt(0)).startContainer)?function t(e,n,o,r,i,a){var s,l,u,c,f,h="",p=e.childNodes,d=p.length;for(s=0;s<d;s++)Tt(l=p[s])?h+=t(l,n,o,r,i,a):St(l)?(u=n&&n.startContainer,c=n&&n.endContainer,f=l.textContent,l===u||l===c?u!==c?l===u?(h+=At(f,o,f.length,i),a=!0):(h+=At(f,0,r,""),a=!1):h+=At(f,o,r,i):a||(h+=f)):wt(l)&&!a&&(h+="\n");return h}(t,a,n,o,s):a&&a.startOffset===a.endOffset?e+s:s:At(e,n,o,s)}function Rt(t){var e=function(t){var e,n=t;return n?((e=n.length)>0&&"\n"===n[e-1]&&(n+="â"),n):n}(t);return e&&e.indexOf(" ")>=0&&(e=E(e," ","Â ")),e}function kt(t,e,n,o,i,a){var s,l,u,c,f,h,p,g,m,y,v=t.srcElement||t.target;v&&"gcEditingInput"===v.getAttribute(L)&&13===t.keyCode&&(t.ctrlKey||t.altKey)&&((s=d.Xl())instanceof r.Worksheet&&((l=s.getCellType(s.Jl,s.Kl))&&(mt(v)?(n&&(v.blur(),v.focus()),(u=tt.getSelection()).rangeCount>0&&(c=u.getRangeAt(0),(f=et.createElement("span")).innerHTML="<br/>â",c.insertNode(f),(h=et.createRange()).setStartAfter(f),h.setEndAfter(f),h.collapse(!1),u.removeAllRanges(),u.addRange(h))):(p=v.selectionStart,m=(g=v.value).substr(0,p),y=g.substr(p,g.length-p),v.value=m+"\n"+y,v.selectionStart=p+1,v.selectionEnd=p+1),l.$fc(s.BF,rt,rt,t,e,!0))),x(t))}function Mt(t){var e,n=t;return n?n.indexOf("â")<0&&n.indexOf("\n")<0?n:((e=t.split("\n")).forEach((function(t,e,n){(function(t){return"â"===t})(t[0])&&(n[e]=t.substr(1))})),e.join("\n")):n}function Nt(t){var e,n,o,r,i,a=tt.getSelection(),s=!1,l=0,u=0;if(a.rangeCount>0)return e=a.getRangeAt(0),n=Ct(t),o=bt(t),r=e.startContainer,i=e.endContainer,xt(r)&&(s=!0,l=n),xt(i)&&(u=o),function t(e,n,o,r,i,a,s,l){var u,c,f,h,p,d,g;if(r===i&&!a)return{content:Mt(r.textContent.slice(n,o))};for(u="",c=s,p=e.childNodes,d=l||p.length;c<d;c++)if(Tt(g=p[c])){if(f=t(g,n,o,r,i,a,0,0),u+=f.content,f.startFlag&&(a=!0),f.endFlag){h=!0;break}}else if(St(g)&&g===r)u+=g.textContent.slice(n,g.textContent.length),a=!0;else{if(St(g)&&g===i){u+=g.textContent.slice(0,o),h=!0;break}a&&(u+=wt(g)?"\n":g.innerText||g.textContent)}return{content:Mt(u),startFlag:a,endFlag:h}}(t,n,o,r,i,s,l,u).content}function Et(t,e){var n,o=t.length,r=[];for(n=0;n<o;n++)r.push(M(t[n],e));return r}function Dt(t,e,n,o){var r,i=0,a=n;for(r=0;r<t.length;r++)T&&(a=o[r]),t[r]>e?i+=a*at(t[r]/e):i+=a;return i}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=n("./dist/core/celltype/celltype.ns.js"),l=n("./dist/core/celltype/basecelltype.js"),u=n("./dist/core/core.enum.js"),c=n("./dist/core/util/common.js"),f=o.Common.j.Fa,h=a.Vn,p=a.Events.EditChange,d=a.Vl,g=a.Ul,m=a.uHb,y=g.lHb,v=g.Nl,C=g.Ml,b=C.msie,w=C.edge,T=C.chrome,x=g.nl,S=g.ol,A=g.Il,I=g.vl,R=g.rl(),k=g.fp,M=g.Voa,N=g.pL,E=g.Ika,D=g.hZa,O=g.K_a,j=g.Fxb,F="left",P="right",_="center",L="gcUIElement",B="none",G=".gcEditingInput",H="width",V="height",z="text-align",W="hidden",U="word-wrap",q="overflow",Y="vertical-align",X="normal",Z="break-word",Q="overflow-y",J="scroll",$="word-break",K="float",tt=window,et=document,nt=R.ipad,ot=R.iphone||nt||R.android,rt=null,it=void 0,at=Math.ceil,st=Math.min,lt=Math.sin,ut=Math.cos,ct=Math.abs,ft=Math.max,ht=parseInt,function(t){t[t.textarea=0]="textarea",t[t.editableDiv=1]="editableDiv"}(e.EditorType||(e.EditorType={})),pt=function(t){function e(e){var n=t.call(this)||this;return n.allowOverflow=!0,n.typeName="1",n.editorType=f(e)?1:e,n}return dt(e,t),e.prototype.getText=function(t,e){return t},e.prototype.paintValue=function(t,e,n,o,r,i,a,s){var c,f,h,p,d,g,m,v,C,b,w,x,A,I,R,k,M,N,E,D,F=this,P=s.sheet,_=P.zoom?P.zoom():1;if(e=F.getText(e,s),c={},s.quotePrefix=a.quotePrefix,p=(h=a.formatter)&&"General"!==h,d=y(h),"string"==typeof h&&(p=p&&!d),g=a.textOrientation,m=a.textIndent&&0!==a.textIndent,v=a.isVerticalText,C=r,g&&-90<=g&&g<=90&&!m&&!v&&(b=ct(g*Math.PI/180),C=(i-s.lineHeight*ut(b))/lt(b)),w=F.Pfc(t,f,a,s,n,o,r,i).externals,x=F.Qfc(w.left),A=F.Qfc(w.right),3===(I=a.hAlign)&&(I=S(I,e,a.formatter)),2===I?C-=A:0===I&&(C-=x),R=a._autoFormatter&&a._autoFormatter.formatCached&&"General"!==a._autoFormatter.formatCached,p?k=a.formatter:R?k=a._autoFormatter:P.parent&&P.parent.options.numbersFitMode===u.NumbersFitMode.mask?k=l.Context.Ixb(t,e,C,a,_):P.parent&&P.parent.options.numbersFitMode===u.NumbersFitMode.overflow&&(k=a._autoFormatter),f=d&&(e instanceof Date||"boolean"==typeof e||e instanceof Boolean||"number"==typeof e)?F.format(e,h,{}):F.format(O(e),k,c,s),!0!==a.shrinkToFit&&!v)if(j(e)){if(P.parent){switch(M=f,P.parent.options.numbersFitMode){case u.NumbersFitMode.mask:M=this.Yfc(t,f,C,a,_,s,c,P);break;case u.NumbersFitMode.overflow:M=this.Klb(t,s,e,a,P,f,c)}f=M}}else void 0===P.ITa.uIb(s.row,s.col,s.sheetArea)||a.showEllipsis||P.ITa.qHb(s.row,s.col,void 0,s.sheetArea);return N=a.labelOptions,E=a.watermark,D=!N||0!==N.visibility,E&&!f&&D?void F.paintText(t,E,n,o,r,i,a,s,E,c,.337):void((f||c.content&&c.content.length)&&(1===a.vAlign&&T&&o--,F.paintText(t,e,n,o,r,i,a,s,f,c,it,w)))},e.prototype.Yfc=function(t,e,n,o,r,i,a,s){var u=l.Context.Lxb(t,e,n,o,r),c=i.row,f=i.col;return e!==u?(delete a.content,o.textIndent=0,s.ITa.qHb(c,f,s.getText(c,f,i.sheetArea),i.sheetArea)):s.ITa.qHb(c,f,void 0,i.sheetArea),u},e.prototype.Klb=function(t,e,n,o,r,i,a){var s,l,u,c,f=e.row,h=e.col;if("number"==typeof n&&delete a.content,o.wordWrap&&(o.wordWrap=!1),s=N(t,o.font,i),l=r.ss._m(h),c=void 0,!(u=e.cellOverflowLayout)&&l<s)c=r.getText(f,h,e.sheetArea);else if(u&&l<s&&this.lDc(u.backgroundWidth)&&this.lDc(u.valueWidth)){if(!this.lDc(o.hAlign))return;void 0,c=(1!==o.hAlign?u.valueWidth>u.backgroundWidth:u.valueWidth/2>u.backgroundLeftWidth||u.valueWidth/2>u.backgroundRightWidth)?r.getText(f,h,e.sheetArea):void 0}return r.ITa.qHb(f,h,c,e.sheetArea),i},e.prototype.lDc=function(t){return null!=t},e.prototype.createEditorElement=function(t,e){var n,o=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.qo,r=I(o)+1e3;return i.GC$(e).css("z-index",r),n=gt(this.editorType),i.GC$(n).css({font:"normal 11pt calibri",outline:B,resize:B,border:B,padding:"1px","vertical-align":"top","min-height":"0px","box-sizing":"content-box",background:"transparent"}).css(U,X).attr({tabindex:-1,autocomplete:"off",contenteditable:!0}).css(q,W).attr(L,"gcEditingInput"),C.safari&&i.GC$(n).css("-webkit-user-select","auto"),mt(i.GC$(n)[0])&&(i.GC$(n).css("display","table-cell"),i.GC$(n).css($,X)),i.GC$(n)[0]},e.prototype.getEditorValue=function(t,e){var n,o;return t&&(n=yt(t),!f(n)&&n.length>0)?(o=(o=Mt(n)).replace(/\r\n?/g,"\n")).indexOf("Â ")<0?o:E(o,"Â "," "):rt},e.prototype.setEditorValue=function(t,e,n,o){var r,i;t&&(r=n&&n.sheet&&n.sheet.HF,i=Rt(e),b?r&&n.isImeInput||vt(t,f(i)?o?"%":"":i):vt(t,r?o?"%":"":i))},e.prototype.selectAll=function(t,e){t&&t.select?t.select():tt.getSelection().selectAllChildren(t)},e.prototype.focus=function(t,e){this.isImeAware()&&t?(t.focus(),function(t){if(mt(t)){var e=tt.getSelection();e.selectAllChildren(t),e.rangeCount>0&&e.collapseToEnd()}else t.selectionStart=t.selectionEnd=t.value.length}(t)):t.parentNode.parentNode.focus()},e.prototype.kp=function(t,e,n,o){var r=t&&o&&o.sheet,i={},a=A(e,n,r,i);return t.oja=i.formatter||it,a},e.prototype.activateEditor=function(t,e,n,o,r,a,s){var l,u,c,h,d=o&&o.sheet;d&&(l=this,(u=t)&&(c=i.GC$(u),h=mt(u),l._editingElement=u,R.android&&c.bind("input"+G,(function(t){try{l.$fc(u,e,n,t,o,!1,r,a,s)}catch(t){}})),c.bind("keydown"+G,(function(t){var i;try{i=t.keyCode,h&&(8===i?m.processBackspaceAndLeftArrowKeyEvent(t,!0):46===i?m.processDeleteAndRightArrowKeyEvent(t,!0):37===i?m.processBackspaceAndLeftArrowKeyEvent(t,!1):39===i&&m.processDeleteAndRightArrowKeyEvent(t,!1)),229===i||0===i||l.kK||l.$fc(u,e,n,t,o,!0,r,a,s),kt(t,o,l.kK)}catch(t){}})),c.bind("keyup"+G,(function(t){var c=t.keyCode,f=t.ctrlKey,g=t.altKey;229===c||0===c||l.kK||(46!==c&&8!==c&&(90!==c&&89!==c||!f||g)||(h&&"\n"===u.innerText&&i.GC$(u).empty(),l.$fc(u,e,n,t,o,!1,r,a,s)),(13!==c&&9!==c&&27!==c&&16!==c||f||g)&&d.Wq(p,{sheet:d,sheetName:d.name(),row:d.Jl,col:d.Kl,editingText:l.getEditorValue(u,o)}))})),c.bind("mousedown"+G,(function(){1===d.Px&&(d.Px=2,d.Cu(1,2))})),c.bind("textInput"+G,(function(t){if(t.data&&(l.probabilityAddPercentSpec||l.probabilityAddPercent)&&/^[0-9]+.?[0-9]*/.test(t.data)){var e=document.createElement("span");e.innerText="%",e.id="updateEditorImpAddPercent","#text"===u.firstChild.nodeName?u.appendChild(e):u.firstChild.appendChild(e),delete l.probabilityAddPercentSpec,delete l.probabilityAddPercent}})),c.bind("compositionstart"+G,(function(){l.kK=!0,l.nK=yt(u)})),c.bind("compositionupdate"+G,(function(t){l.$fc(u,e,n,t||rt,o,!0,r,a,s)})),c.bind("compositionend"+G,(function(t){var i,c,f,h;l.$fc(u,e,n,t||rt,o,!1,r,a,s),l.kK=!1,i=t.keyCode,c=t.ctrlKey,f=t.altKey,h=l.getEditorValue(u,o)||"",l.nK!==h&&(i===it||13!==i&&9!==i||c||f)&&d.Wq(p,{sheet:d,sheetName:d.name(),row:d.Jl,col:d.Kl,editingText:h})})),h&&(c.bind("copy"+G,(function(t){var e=tt.clipboardData,n=t.clipboardData,o=Nt(t.currentTarget);f(o)||(e&&e.setData?(e.setData("text",o),x(t)):n&&n.setData&&(n.setData("text/plain",o),x(t)))})),c.bind("paste"+G,(function(t){var i,c,f,p,d,g,m,y=!1;if(h)try{i=void 0,b&&!w&&tt.clipboardData&&tt.clipboardData.getData?i=tt.clipboardData.getData("text"):t.clipboardData&&t.clipboardData.getData&&(i=t.clipboardData.getData("text/plain")),i=Rt(i=i.replace(/\r\n?/g,"\n")),(c=tt.getSelection()).rangeCount>0&&((p=(f=c.getRangeAt(0)).startOffset)!==f.endOffset&&f.deleteContents(),function(t,e,n){var o=yt(t);return o&&"="===o[0]||""===o&&"="===e[0]||0===n&&"="===e[0]}(u,i,p)||(d=et.createElement("span"),"\n"===(i=i.replace(/\u200B/g,""))[(g=i.length)-1]&&(i="\r"===i[g-2]?i.substr(0,g-2):i.substr(0,g-1)),d.innerText=i,f.insertNode(d),(m=document.createRange()).setStartAfter(d),m.setEndAfter(d),m.collapse(!1),c.removeAllRanges(),c.addRange(m),y=!0))}catch(t){}if(l.mK=tt.setTimeout((function(){l.$fc(u,e,n,t,o,!1,r,a,s),l.mK&&(clearTimeout(l.mK),delete l.mK)}),10),y)return!1})))))},e.prototype.deactivateEditor=function(t,e){if(t){if(this.kK&&nt&&e&&e.sheet&&e.sheet.CH)try{var n=t;n&&i.GC$(n).trigger("compositionend"+G)}catch(t){}i.GC$(t).unbind(G)}this._editingElement=rt},e.prototype.getEditingElement=function(){return this._editingElement},e.prototype.lK=function(t,e,n,o,r,a,s,u,c){var p,d,g,m,y,v,C,w,x,A,I,R,M,N,E,O,j,L,G,tt,et,nt,ot,rt,it,lt,ut,ct,pt,dt,gt,vt,wt,Tt,xt,St,At,Rt,kt=r&&r.sheet,Mt=this,Nt=kt.options.sheetAreaOffset,Ot=t;if(Ot&&kt&&(p=i.GC$(Ot),d=kt.yl,g=r.preventOverflow,m=yt(Ot),kt.isEditing())){if(y=mt(Ot),v=void 0,C=F,w=void 0,x=l.Context.u5,A=0,I=0,R=0,M=0,e&&(A=x(e,0),I=x(e,1),R=x(e,2),M=x(e,3),1===(v=S(e.hAlign,t.LF))?C=_:2===v&&(C=P),p.css(z,C),e.foreColor&&p.css("color",e.foreColor),(w=e.font||d.Bl())&&(kt.zoom()>1&&(w=d.Cl(w)),p.css("font",D(w))),e.textDecoration&&Mt.lp(p,e.textDecoration)),N=ht(p.css("padding-left"),10)+ht(p.css("padding-right"),10),E=ht(p.css("padding-top"),10)+ht(p.css("padding-bottom"),10),f(s)&&(s=n),s&&(O=kt.am(),j=n.width,s.x+s.width-Nt.left>O.width&&(n.width=O.width-n.x,s.width=O.width-s.x),p.css(H,j-N).css(V,n.height-E),Ot.maxWidth=Nt.left+O.width-n.x-N-I,p.css("max-width",Ot.maxWidth+"px"),Ot.maxHeight=Nt.top+O.height-n.y-E-R,Ot.minWidth=ht(Ot.style.width,10),Ot.minHeight=ht(Ot.style.height,10)),L=Ct(Ot),G=bt(Ot),tt=(a=(a=a&&o&&o.keyCode&&kt.mm.LH(o)&&0===L&&G===m.length)||kt.HF)?"":m,(w=Ot.style.font)||(w=d.Cl(d.Bl())),et=k(w),o&&Mt.probabilityAddPercent&&((nt=o.keyCode)&&(nt>=96&&nt<=105||nt>=48&&nt<=57)&&(kt.parent.options.enableFormulaTextbox?(rt=Ot.innerText,/[a-z]/i.test(rt)?Mt.probabilityAddPercent=!1:((ot=document.createElement("span")).innerText="%",ot.id="updateEditorImpAddPercent",Ot.appendChild(ot),delete Mt.probabilityAddPercent)):((ot=document.createElement("span")).innerText="%",ot.id="updateEditorImpAddPercent",Ot.firstChild.appendChild(ot),delete Mt.probabilityAddPercent))),!a&&o&&(kt.mm.LH(o)&&8!==o.keyCode&&(tt=It(Ot,tt,L,G,o)),Mt.kK&&(tt=b?m:Mt.nK+o.data)),[],lt=void 0,ut=void 0,ct=(it=e&&e.wordWrap?h.Wn(tt,ht(Ot.style.width)-N,w):tt.split(/\r\n|\r|\n/)).length,Ot.minWidth=st(Ot.minWidth,Ot.maxWidth),Ot.minHeight=st(Ot.minHeight,Ot.maxHeight),e&&e.wordWrap||ct>0){if(pt=void 0,dt=void 0,T?pt=function(t){var e,n=t.length,o=0;for(e=0;e<n;e++)o+=t[e];return o}(dt=Et(it,w)):pt=ct*et,e&&e.wordWrap)p.css(U,Z).css(q,W).css("max-width",Ot.style.width);else{for(gt=0,vt=[],lt=0;lt<ct;lt++)ut=at(kt.rt(it[lt],w)),vt.push(ut),gt=ft(gt,ut);wt=p.css(U),Tt=ht(Ot.style.width),e||wt!==Z?gt<=Ot.minWidth?(p.css(H,Ot.minWidth).css(U,X).css(q,W),y&&p.css($,X)):gt>Ot.minWidth&&gt<=Ot.maxWidth&&!g?(p.css(H,gt).css(U,X).css(q,W),y&&p.css($,X)):gt>Ot.maxWidth&&!g&&(p.css(H,Ot.maxWidth-2).css(U,Z).css(q,W),pt=Dt(vt,Ot.maxWidth,et,dt)):gt>Tt&&!g&&(pt=Dt(vt,Tt,et,dt))}pt<=Ot.minHeight?p.css(V,Ot.minHeight).css(K,B):pt>Ot.minHeight&&pt<=Ot.maxHeight?p.css(V,pt).css(K,B):pt>Ot.maxHeight&&p.css(V,Ot.maxHeight-1).css(Q,J).css(K,F)}return v=p.css(z),xt=p.width()-Ot.minWidth,f(v)||v===F||(v===_?p.css(F,Ot.originalLeft-xt/2):v===P&&p.css(F,Ot.originalLeft-xt)),e&&y&&(1===(St=e.vAlign)?p.css(Y,"middle"):2===St&&p.css(Y,"bottom")),At=ht(Ot.style.height)+E+A+R,Rt=N+M+I,p.css(Q)===J?{width:Ot.offsetWidth+Rt,height:a?0:At}:{width:ht(Ot.style.width)+Rt,height:At}}},e.prototype.updateEditor=function(t,e,n,o,r,a,s){var l,u,h;return n=this.lK(t,e,n,rt,o,!1,r,a,s),b&&t&&(u=(l=i.GC$(t)).width(),l.width(u+1).width(u)),!f(n)&&t&&(h=new c.Rect(t.style.left?parseFloat(t.style.left):0,t.style.top?parseFloat(t.style.top):0,n.width,n.height)),h},e.prototype.$fc=function(t,e,n,o,r,a,s,l,u){if(n=this.lK(t,e,n,o,r,a,s,l,u),b&&t){var c=i.GC$(t),h=c.width();c.width(h+1).width(h)}!f(n)&&t&&(f(s)?s=n:(s.x=it,s.y=it),this.updateEditorContainer(t,n,e,r,s,l,u))},e.prototype.updateEditorContainer=function(e,n,o,r,a,s,l){var u,c,f;r&&r.preventOverflow?(t.prototype.updateEditorContainer.call(this,e,n,o,r,a,s,l),(u=e.parentNode)&&n&&(c=i.GC$(u),(f=n.width)>0&&c.width(f))):(n&&n.width&&a&&a.width&&(a.width=n.width),n&&n.height&&a&&a.height&&(a.height=n.height),t.prototype.updateEditorContainer.call(this,e,n,o,r,a,s,l))},e.prototype.updateImeMode=function(t,e,n){this.isImeAware()&&t&&l.Context.hp(t,e)},e.prototype.isReservedKey=function(t,e){var n=t.srcElement||t.target,o=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.metaKey;return!!(n&&e&&e.isEditing&&"gcEditingInput"===n.getAttribute(L))&&(13===o&&(r&&!t.shiftKey||i)||90===o&&r&&!i||89===o&&r&&!i||67===o&&(r||a)&&!i||88===o&&(r||a)&&!i)},e.prototype.isImeAware=function(t){return!0},e.prototype.toJSON=function(){var t,e={},n=this;for(t in n)n.hasOwnProperty(t)&&"_editingElement"!==t&&(e[t]=n[t]);return e},e}(l.Base),e.Text=pt,s._o[1]=pt},"./dist/core/core.definition.js":function(t,e){},"./dist/core/core.entry.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u;function c(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n("./dist/core/core.res.en.js"),c(n("./dist/core/core.ns.js")),c(n("./dist/core/core.enum.js")),c(n("./dist/core/util/common.js")),c(n("./dist/core/util/domUtil.js")),n("./dist/core/core.definition.js"),o=n("./dist/core/util/common.js"),Object.defineProperty(e,"getTypeFromString",{set:function(t){o.getTypeFromString=t},get:function(){return o.getTypeFromString}}),a=-1,1===(i=(r=n("./dist/core/lc/releaseLc.js")).Soa)&&(a=Math.floor(5*Math.random()),e["G".concat("C","$")]["s".concat("d")]=a),c(n("./dist/core/util/theme.js")),c(n("./dist/core/util/basedialog.js")),c(n("./dist/core/util/imageLoader.js")),c(n("./dist/core/util/tasks.js")),0===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/stylehelper.js")),1===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/style.js")),2===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/clipboardhelper.js")),3===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/worksheet-model.js")),4===a&&n("./dist/core/lc/lcRegister.js"),c(n("./dist/core/worksheet/worksheet.js")),n("./dist/core/worksheet/worksheet-formatter.js"),c(n("./dist/core/worksheet/worksheet-actions.js")),c(n("./dist/core/worksheet/worksheet-border.js")),n("./dist/core/worksheet/worksheet-edit.js"),c(n("./dist/core/worksheet/worksheet-event.js")),n("./dist/core/worksheet/worksheet-json.js"),c(n("./dist/core/worksheet/worksheet-render.js")),n("./dist/core/worksheet/worksheet-selection.js"),n("./dist/core/worksheet/worksheet-sort.js"),c(n("./dist/core/worksheet/worksheet-ui.js")),c(n("./dist/core/worksheet/worksheet-static.js")),c(n("./dist/core/workbook/workbook.js")),n("./dist/core/workbook/workbook-json.js"),c(n("./dist/core/workbook/sheettabbase.js")),c(n("./dist/core/workbook/sheettab.js")),c(n("./dist/core/workbook/sheettab2007.js")),c(n("./dist/core/workbook/workbookpanelex.js")),s=n("./dist/core/celltype/cellType.entry.js"),e.CellTypes=s,l=n("./dist/core/celltype/headercelltype.js"),Object.defineProperty(s,"Corner",{set:function(t){t!==l.Corner&&(l.Corner=t)},get:function(){return l.Corner}}),Object.defineProperty(s,"ColumnHeader",{set:function(t){t!==l.ColumnHeader&&(l.ColumnHeader=t)},get:function(){return l.ColumnHeader}}),Object.defineProperty(s,"RowHeader",{set:function(t){t!==l.RowHeader&&(l.RowHeader=t)},get:function(){return l.RowHeader}}),u=n("./dist/core/celltype/textcelltype.js"),Object.defineProperty(s,"Text",{set:function(t){t!==u.Text&&(u.Text=t)},get:function(){return u.Text}}),s.vHb=l,s.wHb=u,1!==i&&2!==i||r.Gb(e)},"./dist/core/core.enum.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.pixels=0]="pixels",t[t.continuous=1]="continuous"}(e.ScrollType||(e.ScrollType={})),function(t){t[t.setRowCount=0]="setRowCount",t[t.setColumnCount=1]="setColumnCount",t[t.addRows=2]="addRows",t[t.deleteRows=3]="deleteRows",t[t.addColumns=4]="addColumns",t[t.deleteColumns=5]="deleteColumns",t[t.setRowHeight=6]="setRowHeight",t[t.setColumnWidth=7]="setColumnWidth",t[t.setRowVisible=8]="setRowVisible",t[t.setColumnVisible=9]="setColumnVisible",t[t.filterRows=10]="filterRows",t[t.outlineExpandRows=11]="outlineExpandRows",t[t.outlineExpandColumns=12]="outlineExpandColumns"}(e.AxisInfoChangeType||(e.AxisInfoChangeType={})),function(t){t[t.hide=0]="hide",t[t.show=1]="show",t[t.active=2]="active",t[t.unactive=3]="unactive"}(e.ScrollbarState||(e.ScrollbarState={})),function(t){t[t.none=0]="none",t[t.column=1]="column",t[t.row=2]="row",t[t.both=3]="both"}(e.ShowResizeTip||(e.ShowResizeTip={})),function(t){t[t.skin=0]="skin",t[t.mobile=1]="mobile"}(e.ScrollbarAppearance||(e.ScrollbarAppearance={})),function(t){t[t.none=0]="none",t[t.horizontal=1]="horizontal",t[t.vertical=2]="vertical",t[t.both=3]="both"}(e.ShowScrollTip||(e.ShowScrollTip={})),function(t){t[t.right=0]="right",t[t.down=1]="down"}(e.InsertShiftCell||(e.InsertShiftCell={})),function(t){t[t.normal=0]="normal",t[t.split=1]="split"}(e.ResizeMode||(e.ResizeMode={})),function(t){t[t.noHeaders=0]="noHeaders",t[t.rowHeaders=1]="rowHeaders",t[t.columnHeaders=2]="columnHeaders",t[t.allHeaders=3]="allHeaders"}(e.CopyPasteHeaderOptions||(e.CopyPasteHeaderOptions={})),function(t){t[t.noHeaders=0]="noHeaders",t[t.rowHeaders=1]="rowHeaders",t[t.columnHeaders=2]="columnHeaders",t[t.allHeaders=3]="allHeaders"}(e.HeaderOptions||(e.HeaderOptions={})),function(t){t[t.default=0]="default",t[t.enhanced=1]="enhanced"}(e.ResizeZeroIndicator||(e.ResizeZeroIndicator={})),function(t){t[t.setFormula=0]="setFormula",t[t.copyPaste=1]="copyPaste",t[t.dragFill=2]="dragFill",t[t.dragDrop=3]="dragDrop",t[t.changePartOfArrayFormula=4]="changePartOfArrayFormula",t[t.changeSheetName=5]="changeSheetName"}(e.InvalidOperationType||(e.InvalidOperationType={})),function(t){t[t.cell=0]="cell",t[t.cellWithHeader=1]="cellWithHeader"}(e.AutoFitType||(e.AutoFitType={})),function(t){t[t.all=0]="all",t[t.values=1]="values",t[t.formatting=2]="formatting",t[t.formulas=3]="formulas",t[t.valuesAndFormatting=4]="valuesAndFormatting",t[t.formulasAndFormatting=5]="formulasAndFormatting"}(e.ClipboardPasteOptions||(e.ClipboardPasteOptions={})),function(t){t[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.bottomLeft=3]="bottomLeft",t[t.bottomCenter=4]="bottomCenter",t[t.bottomRight=5]="bottomRight"}(e.LabelAlignment||(e.LabelAlignment={})),function(t){t[t.visible=0]="visible",t[t.hidden=1]="hidden",t[t.auto=2]="auto"}(e.LabelVisibility||(e.LabelVisibility={})),function(t){t[t.underline=1]="underline",t[t.lineThrough=2]="lineThrough",t[t.overline=4]="overline",t[t.doubleUnderline=8]="doubleUnderline",t[t.none=0]="none"}(e.TextDecorationType||(e.TextDecorationType={})),function(t){t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right",t[t.general=3]="general"}(e.HorizontalAlign||(e.HorizontalAlign={})),function(t){t[t.top=0]="top",t[t.center=1]="center",t[t.bottom=2]="bottom"}(e.VerticalAlign||(e.VerticalAlign={})),function(t){t[t.normal=0]="normal",t[t.superscript=1]="superscript",t[t.subscript=2]="subscript"}(e.VertAlign||(e.VertAlign={})),function(t){t[t.smallDecrement=0]="smallDecrement",t[t.smallIncrement=1]="smallIncrement",t[t.largeDecrement=2]="largeDecrement",t[t.largeIncrement=3]="largeIncrement",t[t.thumbPosition=4]="thumbPosition",t[t.thumbTrack=5]="thumbTrack",t[t.endScroll=6]="endScroll"}(e.Nxb||(e.Nxb={})),function(t){t[t.normal=0]="normal",t[t.highlight=1]="highlight",t[t.selected=2]="selected",t[t.active=3]="active",t[t.hover=4]="hover",t[t.activeNotSelected=5]="activeNotSelected"}(e.VisualState||(e.VisualState={})),function(t){t[t.ready=0]="ready",t[t.enter=1]="enter",t[t.edit=2]="edit"}(e.EditorStatus||(e.EditorStatus={})),function(t){t[t.auto=1]="auto",t[t.active=2]="active",t[t.inactive=4]="inactive",t[t.disabled=0]="disabled"}(e.ImeMode||(e.ImeMode={})),function(t){t[t.single=0]="single",t[t.range=1]="range",t[t.multiRange=2]="multiRange"}(e.SelectionPolicy||(e.SelectionPolicy={})),function(t){t[t.cell=0]="cell",t[t.row=1]="row",t[t.column=2]="column"}(e.SelectionUnit||(e.SelectionUnit={})),function(t){t[t.data=1]="data",t[t.style=2]="style",t[t.comment=4]="comment",t[t.tag=8]="tag",t[t.sparkline=16]="sparkline",t[t.axis=32]="axis",t[t.bindingPath=64]="bindingPath",t[t.hyperlink=256]="hyperlink"}(e.StorageType||(e.StorageType={})),function(t){t[t.blank=0]="blank",t[t.numbers=1]="numbers",t[t.letters=2]="letters"}(e.HeaderAutoText||(e.HeaderAutoText={})),function(t){t[t.dragDrop=0]="dragDrop",t[t.dragFill=1]="dragFill",t[t.clear=2]="clear",t[t.paste=3]="paste",t[t.sort=4]="sort",t[t.setArrayFormula=5]="setArrayFormula",t[t.evaluateFormula=6]="evaluateFormula"}(e.RangeChangedAction||(e.RangeChangedAction={})),function(t){t[t.normal=0]="normal",t[t.richText=1]="richText"}(e.ValueType||(e.ValueType={})),function(t){t[t.stretch=0]="stretch",t[t.center=1]="center",t[t.zoom=2]="zoom",t[t.none=3]="none"}(e.ImageLayout||(e.ImageLayout={})),function(t){t.ThumbButton="thumbButton",t.TrackButton="trackButton",t.LeftButton="leftButton",t.RightButton="rightButton",t.UpButton="upButton",t.DownButton="downButton"}(e.Oxb||(e.Oxb={})),function(t){t[t.left=0]="left",t[t.center=1]="center",t[t.right=2]="right",t[t.nearest=3]="nearest"}(e.HorizontalPosition||(e.HorizontalPosition={})),function(t){t[t.top=0]="top",t[t.center=1]="center",t[t.bottom=2]="bottom",t[t.nearest=3]="nearest"}(e.VerticalPosition||(e.VerticalPosition={})),function(t){t[t.corner=0]="corner",t[t.colHeader=1]="colHeader",t[t.rowHeader=2]="rowHeader",t[t.viewport=3]="viewport"}(e.SheetArea||(e.SheetArea={})),function(t){t[t.none=0]="none",t[t.ascending=1]="ascending",t[t.descending=2]="descending"}(e.SortState||(e.SortState={})),function(t){t[t.hover=1]="hover",t[t.invalid=2]="invalid",t[t.readonly=4]="readonly",t[t.edit=8]="edit",t[t.active=16]="active",t[t.selected=32]="selected",t[t.dirty=64]="dirty"}(e.CellStatesType||(e.CellStatesType={})),function(t){t[t.always=0]="always",t[t.onSelected=1]="onSelected",t[t.onEditing=2]="onEditing"}(e.ButtonVisibility||(e.ButtonVisibility={})),function(t){t[t.none=0]="none",t[t.custom=1]="custom",t[t.clear=2]="clear",t[t.calcel=3]="calcel",t[t.ok=4]="ok",t[t.dropdown=5]="dropdown",t[t.ellipsis=6]="ellipsis",t[t.left=7]="left",t[t.right=8]="right",t[t.plus=9]="plus",t[t.minus=10]="minus",t[t.undo=11]="undo",t[t.redo=12]="redo",t[t.search=13]="search",t[t.separator=14]="separator",t[t.spinLeft=15]="spinLeft",t[t.spinRight=16]="spinRight",t[t.collapse=17]="collapse",t[t.expand=18]="expand"}(e.ButtonImageType||(e.ButtonImageType={})),function(t){t[t.colorPicker=0]="colorPicker",t[t.dateTimePicker=1]="dateTimePicker",t[t.timePicker=2]="timePicker",t[t.monthPicker=3]="monthPicker",t[t.list=4]="list",t[t.slider=5]="slider",t[t.calculator=6]="calculator",t[t.workflowList=7]="workflowList",t[t.multiColumn=8]="multiColumn"}(e.DropDownType||(e.DropDownType={})),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.leftOfText=2]="leftOfText",t[t.rightOfText=3]="rightOfText"}(e.ButtonPosition||(e.ButtonPosition={})),function(t){t[t.left=0]="left",t[t.right=1]="right"}(e.CaptionAlignment||(e.CaptionAlignment={})),function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(e.LayoutDirection||(e.LayoutDirection={})),function(t){t[t.inline=0]="inline",t[t.popup=1]="popup",t[t.tree=2]="tree"}(e.LayoutDisplayAs||(e.LayoutDisplayAs={})),function(t){t[t.year=1]="year",t[t.month=2]="month",t[t.day=3]="day"}(e.CalendarPage||(e.CalendarPage={})),function(t){t[t.monday=1]="monday",t[t.tuesday=2]="tuesday",t[t.wednesday=3]="wednesday",t[t.thursday=4]="thursday",t[t.friday=5]="friday",t[t.saturday=6]="saturday",t[t.sunday=7]="sunday"}(e.CalendarStartDay||(e.CalendarStartDay={})),function(t){t[t.none=0]="none",t[t.group=1]="group",t[t.child=2]="child",t[t.full=3]="full"}(e.GroupSort||(e.GroupSort={})),function(t){t[t.string=0]="string",t[t.array=1]="array"}(e.DropdownListValue||(e.DropdownListValue={})),function(t){t[t.solid=1]="solid",t[t.darkGray=2]="darkGray",t[t.mediumGray=3]="mediumGray",t[t.lightGray=4]="lightGray",t[t.gray125=5]="gray125",t[t.gray0625=6]="gray0625",t[t.darkHorizontal=7]="darkHorizontal",t[t.darkVertical=8]="darkVertical",t[t.darkDown=9]="darkDown",t[t.darkUp=10]="darkUp",t[t.darkGrid=11]="darkGrid",t[t.darkTrellis=12]="darkTrellis",t[t.lightHorizontal=13]="lightHorizontal",t[t.lightVertical=14]="lightVertical",t[t.lightDown=15]="lightDown",t[t.lightUp=16]="lightUp",t[t.lightGrid=17]="lightGrid",t[t.lightTrellis=18]="lightTrellis"}(e.PatternType||(e.PatternType={})),function(t){t[t.mask=0]="mask",t[t.overflow=1]="overflow"}(e.NumbersFitMode||(e.NumbersFitMode={}))},"./dist/core/core.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/core/core.res.en.js");e.SR={en:o}},"./dist/core/core.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_NotSupported="NotSupportException",e.Exp_PasteExtentIsNull="pasteExtent is null",e.Exp_InvalidPastedArea="The pasted area should have the same size as the copy or cut area.",e.Exp_MultipleSelections="This action won't work on multiple selections.",e.Exp_ChangePartOfArray="Cannot change part of an array.",e.Exp_InvalidAndSpace="Invalid {0}: {1} (must be between {2} and {3}).",e.Exp_SrcIsNull="The argument 'src' is null",e.Exp_DestIsNull="The argument 'dest' is null",e.Exp_InvalidCustomFunction="invalid custom function",e.Exp_InvalidCustomName="invalid custom name",e.Exp_IndexOutOfRange="Index is out of range!",e.Exp_InvalidRange="Invalid range",e.Exp_ArgumentOutOfRange="ArgumentOutOfRange",e.Exp_PasteSourceCellsLocked="Source sheet's cells are locked.",e.Exp_InvalidCopyPasteSize="The copy and paste areas are not the same size.",e.Exp_PasteDestinationCellsLocked="The cell you are trying to change is protected and therefore read-only.",e.Exp_PasteChangeMergeCell="Cannot change part of a merged cell.",e.Tip_Row="Row: ",e.Tip_Column="Column: ",e.Tip_Height="Height: {0} pixels",e.Tip_Width="Width: {0} pixels",e.NewTab="New...",e.Exp_EmptyNamedStyle="The name of named style cannot be empty or null",e.Exp_SheetNameInvalid="The sheet name can not be blank or contains these characters : *, :, [, ], ?, \\, /",e.Exp_ArrayFormulaSpan="Array formulas are not valid in merged cells.",e.Exp_DestSheetIsNull="destSheet is null",e.Exp_SheetIsNull="sheet is null.",e.Exp_OverlappingSpans="This operation will cause overlapping spans.",e.NeedCanvasSupport="You need a browser which full supports HTML5 Canvas to run SpreadJS",e.ARIA_Resize="resize",e.ARIA_First="first",e.ARIA_PreviousArrow="previous arrow",e.ARIA_NextArrow="next arrow",e.ARIA_Last="last",e.ARIA_PreviousButton="previous button",e.ARIA_NextButton="next button",e.ARIA_SheetTab="sheet tab",e.ARIA_NewSheet="new sheet",e.ARIA_Blank="blank",e.ARIA_Scrollbar_Left_Button="scrollbar left button",e.ARIA_Scrollbar_Top_Button="scrollbar top button",e.ARIA_Scrollbar_Thumb_Button="scrollbar thumb button",e.ARIA_Scrollbar_Right_Button="scrollbar right button",e.ARIA_Scrollbar_Bottom_Button="scrollbar bottom button",e.ARIA_Scrollbar_TRACK_Button="scrollbar track button",e.ARIA_Cell="cell",e.ARIA_HasValue="has value",e.ARIA_RowHeader="row header",e.ARIA_ColumnHeader="column header",e.SHEET_NAME="Sheet",e.lsru=["","6465706c6f796d656e74"],e.lsde=["","64657369676e6572"],e.ls1=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f752063616e206f6e6c79206465706c6f792074686973204556414c554154494f4e2076657273696f6e206c6f63616c6c792e0d0a54656d706f72617279207b317d206b6579732061726520617661696c61626c6520666f722074657374696e672e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d2e"],e.ls2=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b6579206578706972657320696e207b307d206461792873292e"],e.ls3=["","4c6963656e7365204e6f7420466f756e640d0a596f75206e65656420612076616c6964206c6963656e7365206b657920746f2072756e205370726561642e5368656574732e0d0a54656d706f72617279206b6579732061726520617661696c61626c6520666f72206576616c756174696f6e2e0d0a496620796f75207075726368617365642061206c6963656e73652c20796f7572206b657920697320696e20796f757220707572636861736520636f6e6669726d6174696f6e20656d61696c2e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e65656420617373697374616e63652e"],e.ls4=["","496e76616c6964206c6963656e7365206b65792e20456d61696c2075732e73616c6573406772617065636974792e636f6d20696620796f75206e6565642068656c702e"],e.ls5=["","506f776572656420627920477261706543697479205370726561644a532e0d0a596f75722074656d706f72617279207b317d206b65792068617320657870697265642e0d0a456d61696c2075732e73616c6573406772617065636974792e636f6d20666f722068656c702e"],e.ls6=["","506f776572656420627920477261706543697479205370726561644a53204576616c756174696f6e2056657273696f6e0d0a4e6f74204c6963656e73656420666f7220446973747269627574696f6e"],e.Exp_InsertCopiedCutCells="This selection is not valid. The copy/paste area must be the same size",e.Exp_InsertCopiedCutCellsOnSpanTable="This wonât work because it would move cells in a table on your worksheet or will cause some merged cells to unmerge.",e.Exp_InsertCopiedCutCellsNoRange="New cells can not be inserted as there are non-empty cells that would extend beyond the worksheet.",e.Exp_InvalidSortArrayFormulaInRange="Can't sort current range as array formula exist.",e.Exp_InvalidSortSpanInRange="Can't sort current range as span exist.",e.Exp_InvalidSortPartTableOrMultiTableInRange="Can't sort current range as part table or more than one table exist."},"./dist/core/lc/common.js":function(t,e,n){"use strict";(function(t){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I;function R(){return I}function k(t,e){var n,o,r,i,a="",s=0;for(n=0;n<t.length;n++)s=Math.max(s,t[n].length);for(n=0;n<s;n++){for(e&&(o=""),i=0;i<t.length;i++)e?o+=n>=t[i].length?"00":t[i].charAt(n)+t[i].charAt(n+1):n<t[i].length&&(a+=t[i].charAt(n));e&&(r=parseInt(o,16),a+=String.fromCharCode(r),n++)}return a}function M(t,e,n){var o,r=k(["Lcnee","iesKy"]),i=R()[r];return u(i,{pK:"l6/zrbWoSbcLFwEetFh38rH3ErBZE9H+Cqix3R+wTlfA1wD5B+lUcCQn+EJ60I4RGrm0x1sFjkiLWwB0jAn6BWZv0W4WbqAKriOdeoivxDp1Wmjs3qkEDhvbsjPtfvwx2BHil6o+/tDrdMJQSGs18WZm2PoQLQuL+9VhZ4FNRHUQU3Jtioke/OZEGHJOdYVwvCGalzBad6QFOiVbDBQPePpS3++GJzOxN8SN/7lyS5/IdKiy3WJRaVGkB370+HbN6hKraDfUgReLX26yxRaKC/5aWnGAJ2NnWLoGyAGRcwT9dVjo4bcAZNrrA0U9JVKQxaSskhdv2p49XzJkltXx5w==",aC:"B0"},(function(r){(o=N(r,"VIEE")).hl=!!i,o.m=i?o.m:-1,e.call(t,o),D(o,t,i,n)}),(function(){(o=N()).hl=!!i,o.m=i?o.m:-1,e.call(t,o),D(o,t,i,n)})),o}function N(t,e){var n,o,r,i,a={isVd:function(t){var e=this;return t=1===R().Workbook.lm||t,e.s&&!e.e&&(!e.adr||!!e.adr.dsr==!!t)}},s=function(){var t=c(S);return function(t){var e=c("VdgJHc#wJb59"),n=c("Zdg3Ga#UHbw5");return t&&(function(t){var e=c("MlSZto#Z");return t&&t===e}(t[e])||function(t){var e=c("yXbog&w");return t&&t===e}(t[e])||function(t){var e=c("4LJITMx8UMcA"),n=c("jOxo"),o=c("JYw3Gb4NOb6x"),r=c("g1Jbww#Y"),i=RegExp("^[\\w\\-]+\\."+r+"$","i");return t&&(t===e||t===n||t===o||d.test(t)||i.test(t))}(t[n]))}(p[t])}();return a.b=s,a.s=function(){var a,l,u,c,f,h,p;if(!t)return!1;if(!(a=t[y])||!a.length)return!1;for(c=0,f=a.length;c<f;c++)if(u=(l=a[c])&&l[C]===e){n=l[v];break}if(!u)return!1;if(t[x]&&(i=t[x]),t[T]){if(h=new Date,p=function(t){return new Date(E(t.substr(0,4))||0,E(t.substr(4,2))-1||0,E(t.substr(6,2))||0)}(t[T]),r=Math.ceil((p-h)/864e5),o=r<=0)return!1}else r=void 0;return!!(s||!t[b]&&!t[w]||O(t[b],t[w])||j(t[b],t[w]))}(),a.m=t?t[m]?-1:1:0,a.n=n,a.e=o,o||(a.d=r),a.adr=i,a}function E(t){return parseInt(t,10)}function D(t,e,n,o){F(t)?o||e.repaint&&!e.Js&&e.repaint():P(e,t)}function O(t,e){var n,o,r,i;return!!(function(){var t=c(S),e=c("VdgJHc#wJb59"),n=c("Udg36Y#oUddV"),o=p[t];return o&&o[e]===n}()&&(n=c(S),o=c("1agFGc#UHbw5"),r=p[n]&&p[n][o],r&&(r=r.toLowerCase(),i=t.split(","),t&&function(t,e){var n,o,r,i;if(!t||0!==t.indexOf("//"))return!1;if((n=t.slice(2).split("/")).length<1)return!1;for(o=n[0],r=0,i=e.length;r<i;r++)if(e[r]===o)return!0;return!1}(r,i))))}function j(t,e){var n,o=c(S),r=c("Zdg3Ga#UHbw5"),i=p[o]&&p[o][r];return!i||(i=i.toLowerCase(),n=t.split(","),!(!t||!function(t,e){var n,o,r,i,a;for(n=0,o=e.length;n<o;n++){if(i=!1,(r=e[n])&&0===r.lastIndexOf("*.",0)&&(i=!0),(r=i?r.slice(2):r)===t)return!0;if(i&&((a=t.indexOf("."+r))>0&&a===t.length-r.length-1))return!0}return!1}(i,n))||!(!t||!function(t,e){var n,o,r,i;if(t&&4===t.split(".").length)for(n=0,o=e.length;n<o;n++)if((r=e[n])&&((i=r.length-2)>0&&(r===t||".*"===r.substr(i)&&t.substr(0,i)===r.substr(0,i)&&g.test(t))))return!0;return!1}(i,n)))}function F(t){return t&&(t.isVd(!1)||t.b&&!t.hl)}function P(t,e){var n,o;function r(){o.width=i.GC$(n).width(),o.height=i.GC$(n).height(),function(t,e,n,o){var r,i,a,l,u;if(!o||!o.isVd(!1))for(r=o.hl?o.adr&&o.adr.dsr?"l4":o.e?"l5":"l4":"l3",i=L(r,A,o),s(t,"16pt calibri"),t.fillStyle="black",t.fillRect(0,0,e,n),t.fillStyle="white",20,a=30,l=0;l<i.length;l++)u=i[l],t.fillText(u,20,a),a+=25}(o.getContext("2d"),o.width,o.height,e)}t.EIc||(t.EIc=!0,n=t.qo,t.sheets=[],t.no(),n&&(o=document.createElement("canvas"),n.appendChild(o),r(),i.GC$(window).bind("resize",(function(){setTimeout(r,100)}))))}function _(t){return new o.Common.ResourceManager(r.SR).getResource()[t]}function L(t,e,n){var o,r,i,a=_(k([t,"s"])),s=_(1===R().Workbook.lm?k(["ld","se"]):k(["lr","su"])),l=B(a,e);for(s=B(s,e),l=(l=l.replace("{0}",n.d)).replace("{1}",s).replace("{1}",s),o=[],r=0,i=0;i<l.length;i++)"\r"!==l[i]&&"\n"!==l[i]||(o.push(l.substring(r,i)),"\r"===l[i]&&i<l.length-1&&"\n"===l[i+1]&&i++,r=i+1);return r<l.length&&o.push(l.substring(r,l.length)),o}function B(t,e){var n,o,r,i=!0,a="";if(t)if("string"==typeof t)(t=t.trim())&&(n=[t]);else if(Array.isArray(t)){for(o=!0,n=[],r=0;r<t.length;r++)a=t[r].trim(),n.push(a),o&&a&&(o=!1);o&&(n=null)}return n||(i=!1,n=e),k(n,i)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/core.ns.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=a.Ul.lZa,l=n("./dist/core/lc/lcValidator.js"),u=l.CIc,c=l.DIc,f="object"==typeof t&&t&&t.Object===Object&&t,h="object"==typeof self&&self&&self.Object===Object&&self,p=f||h||Function("return this")(),d=/^[\w\-]+$/i,g=/^[0-9.]+$/,m=c("XRsZ"),y=c("HUkJ"),v=c("T&g"),C=c("Q&w"),b=c("GRz1"),w=c("XSzB"),T=c("XRwh"),x=c("WQs5"),S="JYx3Gb#8Pb5R",A=["Ivldlcneky mi pedslsgaeiycmi o edassac.","nai ies e.Ealsra.ae@rpct.o fyune sitne"],e.CIc=M,e.Gb=function(t,e){var n,o,r,i,a,s,l,u;I=e,o=e.Workbook.prototype,r=o.ad,o.ad=function(){var t=this;if(M(t,(function(e){t.ls=e,n=e,t.ul=function(){M(t,(function(e){t.ls=e,n=e}))}})),!n||F(n))return r.apply(t,arguments)},i=e.Worksheet.prototype,a=i.ad,i.ad=function(){if(n||this.parent||M(this,(function(t){n=t})),!n||F(n))return a.apply(this,arguments)},s=e.oJ.prototype,l=s.Pw,s.Pw=function(e,o){l.apply(this,arguments),n&&(-1===n.m||!n.hl&&n.b)&&t(this.kj,e,o,n)},u=s.RI,s.RI=function(e,o){u.apply(this,arguments),n&&(-1===n.m||!n.hl&&n.b)&&t(this.kj,e,o,n)}},e.Hhc=P,e.e6=L,e.FIc=function(t){return _(k([t,"sa"]))}}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./dist/core/lc/lcRegister.js":function(t,e,n){"use strict";var o,r,i,a,s;function l(){if(s=null,a[0])try{var t=a[0].tc;t&&t.qo&&o.CIc(t,(function(e){var n,r=t.getActiveSheet();r&&((n=r.l)&&(e=n),n||e.b||-1!==e.m||!e.d||(e.s=!1,o.Hhc(t,e)))}),!0)}finally{a=[]}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/lc/releaseLc.js"),i=(r=n("./dist/core/util/domUtil.js")).GC$.sd,a=[],r.GC$[i]=function(t){a.push(t),s||(s=setTimeout(l,5e3*Math.random()+3e3))}},"./dist/core/lc/lcValidator.js":function(t,e){var n=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={exports:{},id:o,loaded:!1};return t[o].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}return n.m=t,n.c=e,n.p="dist",n(0)}([function(t,e){(function(t){"use strict";var n,o,r,i,a,s,l,u;function c(t,e,n,o){return 1==t.length||t.splice(n,1,o(t.splice(e,1,o(t[n]))[0])),t}function f(t){var e,n=t.split(""),o=function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t.charCodeAt(0);return n>=65&&n<=90?t.toLowerCase():n>=97&&n<=122?t.toUpperCase():n>=48&&n<=57?r(48+(n-48+10+e)%10):t}(t,-1)};for(e=n.length-5;e>=0;e--)c(n,e+1,e+3,o),c(n,e,e+2,o);return n.join("")}function h(t){var e,n,o,r,i,s,l=[],u="",c=a,f=t,h=f.length%3;if(h>0)for(;h++<3;)u+="=",f+="\0";for(h=0;h<f.length;h+=3)n=(e=f.charCodeAt(h)<<16|f.charCodeAt(h+1)<<8|f.charCodeAt(h+2))>>18&63,o=e>>12&63,r=e>>6&63,i=63&e,l[h/3]=c.charAt(n)+c.charAt(o)+c.charAt(r)+c.charAt(i);return(s=l.join("")).slice(0,s.length-u.length)+u}function p(t){var e,n,o,i,s,l,u,c=[],f=a,h=t;for(u=0;u<h.length;u+=4)e=(l=f.indexOf(h.charAt(u))<<18|f.indexOf(h.charAt(u+1))<<12|(i=f.indexOf(h.charAt(u+2)))<<6|(s=f.indexOf(h.charAt(u+3))))>>>16&255,n=l>>>8&255,o=255&l,c[u/4]=r(e,n,o),64==s&&(c[u/4]=r(e,n)),64==i&&(c[u/4]=r(e));return c.join("")}function d(t){return(o&&window.atob||p)(t)}function g(t){return(o&&window.btoa||h)(t)}function m(t){return g(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(function(t,e){return r(parseInt(e,16))})))}function y(t){var e,n;return t?(e=function(t){return t.split("").reverse().join("")}(e=f(t)),n=Math.ceil(e.length/2),function(t){return decodeURIComponent(Array.prototype.map.call(d(t),(function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)})).join(""))}(e=(e=(e=e.substr(n)+e.substr(0,n)).replace("#","=")).replace("&","=="))):""}function v(t){var e,n=d(t),o=n.length,r=new i(o);for(e=0;e<o;e++)r[e]=n.charCodeAt(e);return r.buffer}function C(t){var e,n,o=new ArrayBuffer(t.length),r=new i(o);for(e=0,n=t.length;e<n;e++)r[e]=t.charCodeAt(e);return o}function b(t){return r.apply(null,new i(t))}function w(t){return t.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"")}function T(t){return"oncomplete"in t&&(t.then=function(e,n){t.resolve=e,t.reject=n},t.oncomplete=function(e){t.resolve(t.result)},t.onerror=function(){t.reject()}),t}Object.defineProperty(e,"__esModule",{value:!0}),n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o="undefined"!=typeof window,r=String.fromCharCode,i=o&&window.Uint8Array||function(t){var e,o;if("number"==typeof t)for(e=Array(t),o=0;o<t;++o)e[o]=0;else e=t.slice(0);return e.buffer=e,e.byteLength=e.length,"object"===(void 0===t?"undefined":n(t))&&t.buffer&&(e.buffer=t.buffer),e},a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="object"==(void 0===t?"undefined":n(t))&&t&&t.Object===Object&&t,l="object"==("undefined"==typeof self?"undefined":n(self))&&self&&self.Object===Object&&self,u=s||l||Function("return this")(),e.iDe=y,e.attorn=function(t,e,n,r){var i,a,s,l,c,f,h,p=o?window.msCrypto?window.msCrypto:window.crypto:void 0,d=function(t,e){try{e="#"+e;var n=t.indexOf(e);if(n>-1)return{prefix:t.substring(0,n),licData:JSON.parse(y(t.substr(n+e.length)))}}catch(t){}return!1}(t,e.aC);if(!d)return r();function g(){return function(t){var e,n,o,r=0,i=5381,a=0;for(e=t.length-1;e>=0;e--)r=(n=t.charCodeAt(e))+(r<<6)+(r<<16)-r,i=n+((i<<5)+i),a=n+((a<<5)-a),a&=a;return(o=r^i^a)<0&&(o=~o),o.toString(16).toUpperCase()}(a+JSON.stringify(i.D))===i.H?n(i.D):r()}return i=d.licData,a=d.prefix+"#"+e.aC,s=b(v(m(a+JSON.stringify(i.D)))),l=y("JYx3Gb#8Pb5R"),c=y("VdgJHc#wJb59"),u[l]&&u[l][c]&&!location.protocol.match(/^https/i)?g():p&&p.subtle?(f={alg:"RS256",e:"AQAB",kty:"RSA",n:w(e.pK)},f=window.msCrypto?C(JSON.stringify(f)):f,h={name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},void T(p.subtle.importKey("jwk",f,h,!1,["verify"])).then((function(t){T(p.subtle.verify(h,t,v(i.S),C(s))).then((function(t){return t?n(i.D):r()}))}),(function(){return g()}))):g()}}).call(e,function(){return this}())}]);t.exports={CIc:n.attorn,DIc:n.iDe}},"./dist/core/lc/releaseLc.js":function(t,e,n){"use strict";var o,r,i,a,s;function l(t,e,n,r){var l,u,c,f,h,p,d,g,m=t.am(),y=t.parent,v="11pt calibri",C=r.hl&&r.isVd(!1)&&r.d,b=y&&y.jDc,w="";for(C?l="l2":r.e?l="l5":r.hl&&!r.d?l="l6":(l="l1",u=o.FIc(l)),m=m||t.am(),c=o.e6(l,a,r),f=0,u&&c.forEach((function(e){f=s(f,t.dp(e,v))})),t.l=c[0]?r:void 0,h=0;h<c.length&&(m.width>203||m.height>203)&&!b;h++)w=c[h],p=f||t.dp(w,v),10,20,d=m.width-p-10,g=m.height-10-20*(c.length-h),n&&!n.intersect(d,g,p,20)||(e.save(),e.fillStyle="rgba(0, 0, 0, 0.5)",i(e,v),n&&(e.rect(n.x,n.y,n.width,n.height),e.clip(),e.beginPath()),e.fillText(w,d,g+20),w&&(t.l=r),e.restore())}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/lc/common.js"),r=n("./dist/core/util/common.js"),i=r.Ul.lZa,a=["LcneNtFud\no edavldlcnekyt u pedSet.\neprr esaeaalbefreauto.\nfyuprhsdalcne orkyi nyu ucaecnimto mi.\nmi sslsgaeiycmi o edassac.","ies o on\rYune  ai ies e ornSra.hes\rTmoayky r vial o vlain\rI o ucae  ies,yu e si orprhs ofraineal\rEalu.ae@rpct.o fyune sitne"],s=Math.max,e.Gb=function(t){o.Gb(l,t)},e.Soa=1,e.CIc=o.CIc,e.Hhc=o.Hhc},"./dist/core/util/basedialog.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/util/common.js"),r=n("./dist/core/util/domUtil.js"),i=r.GC$,a=o.util.Nl,s=o.util.Ml,l=o.util.nl,u=document,c=window,f=c.Yl,h=function(){function t(t,e,n){this.c4="gc-popup",this.so="gc-overlay",this.AWa=null;var o=this;o.qo=t,o.zWa=n,e=e||0,o.to={position:"fixed",width:"100%",height:"100%",margin:0,padding:0,top:0,left:0,border:"none",zIndex:e,backgroundColor:"rgba(0,0,0,0)"},o.uo={position:"absolute",padding:0,margin:0,height:"auto",zIndex:e+1,outline:"none"},o.ad()}return t.prototype.ad=function(){var t=this;t.vo(t.Cj)?t.xo=i("#"+t.Cj):(t.Cj=t.wo(),t.xo=i(a("div")).addClass(t.c4+" ui-widget").attr({id:t.Cj,tabIndex:-1}).css(t.uo))},t.prototype.wo=function(){for(var t=0,e="gc-dialog";this.vo(e+""+t);)t++;return e+""+t},t.prototype.yo=function(){if(this.xo)return this.xo},t.prototype.zo=function(){return this.qo?this.qo:u.body},t.prototype.Ao=function(t){var e=this,n=e.xo;e.Bo()||e.Co(),f.Gm(),e.vo(e.Cj)||(i(e.zo()).append(n),e.Do(),n.css("display","none")),n.show(t)},t.prototype.close=function(){var t=this;t.vo(t.Cj)&&t.xo.remove(),i("."+t.c4).isVisible()||t.Eo(),f.Hm()},t.prototype.Eo=function(){i("."+this.so).remove(),this.AWa=null},t.prototype.Do=function(){var t,e,n,o,r,a,s,l,c,f,h,p=this.xo,d=this.zo();0!==p.length&&(t=i(d).offset(),e=parseInt(p.css("left"),10)+t.left,n=parseInt(p.css("top"),10)+t.top,o=p.width(),r=p.height(),isNaN(e)||isNaN(n)||isNaN(o)||isNaN(r)||(a=0,s=0,c=(l=u.documentElement).clientWidth,f=l.clientHeight,(h=p[0].getBoundingClientRect()).left+o>c&&(s=h.left+o-c),h.top+r>f&&(a=h.top+r-f),(e<0||n<0||a>0||s>0)&&((e-=s)<0&&(e=0),(n-=a)<0&&(n=0),p.css({left:e-t.left+"px",top:n-t.top+"px"}))))},t.prototype.vo=function(t){return i("#"+t).length>0},t.prototype.Co=function(){var t,e,n=this,o=i(a("div")).addClass(n.so),r=n.xo;this.AWa=o,o.css(n.to),i(n.qo).append(o),(t=s&&s.mozilla)&&(e=(new Date).valueOf()),o.bind("mousedown",(function(o){if(!n.zWa){if(t)if((new Date).valueOf()-e<100)return;n.close(),t&&n.Fo&&clearTimeout(n.Fo)}l(o)})),o.bind("contextmenu",(function(t){n.zWa&&l(t)})),r.bind("contextmenu",(function(t){l(t)})),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(e){o.bind(e,(function(e){n.zWa||(t?n.Fo=c.setTimeout((function(){n.close()}),100):n.close()),l(e)}))}))},t.prototype.Bo=function(){return i("."+this.so).length>0},t}(),e.Go=h},"./dist/core/util/common.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt;function et(t){return void 0!==t}function nt(t){return m.createElement(t)}function ot(t){m.body&&m.body.insertBefore(t,b)}function rt(t){return t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1),!1}function it(t){var e,n,o=!1;if(t)for(e=0;e<t.length;e++)if((n=t.charCodeAt(e))>=11904&&n<12032||n>=12288&&n<40960||n>=43360&&n<43392||n>=63744&&n<64256){o=!0;break}return o}function at(t,e){var n=nt("span");return n.className=t,e&&(n.id=e),n.style.display="none",ot(n),n}function st(t,e,n,o){t.addEventListener(e,n,o)}function lt(t){var e=t.currentStyle,n=m.defaultView;return n&&n.getComputedStyle&&(e=n.getComputedStyle(t,"")),e}function ut(t){var e,n,o,r,i,a,l=g.Yl;l.jm>0||(16!==t.keyCode&&(l.XCb=!0),(n=(e=L.Xl())&&e.lm)&&s(n).isVisible()||e&&e.mm&&e.mm.nm&&(e.mm.nm(t),e.isEditing()||(o=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.shiftKey,90!==o&&89!==o||!r||i?86!==o||!r||i||a||t.stopPropagation&&t.stopPropagation():rt(t))))}function ct(t){var e,n=g.Yl;n.jm>0||(n.XCb=!1,(e=L.Xl())&&e.mm&&e.mm.om&&e.mm.om(t))}function ft(t){var e;g.Yl.jm>0||(e=L.Xl())&&e.mm&&e.mm.pm&&e.mm.pm(t)}function ht(t){var e,n=g.Yl;n.jm>0||!0!==n.XCb&&((e=L.Xl())&&e.mm&&e.mm.pm&&e.mm.pm(t))}function pt(t){return m.all===C&&L.Xl()&&rt(t),!1}function dt(t,e){var n=x(t.row,e.row),o=x(t.col,e.col),r=S(t.row+t.rowCount-1,e.row+e.rowCount-1),i=S(t.col+t.colCount-1,e.col+e.colCount-1);return n>=0&&o>=0?new W(n,o,r-n+1,i-o+1):n>=0?new W(n,-1,r-n+1,-1):o>=0?new W(-1,o,-1,i-o+1):new W(-1,-1,-1,-1)}function gt(t){var e=t.An||{scaleX:1,scaleY:1,translateX:0,translateY:0,skewX:0,skewY:0,orgTranslateX:0,orgTranslateY:0};return t.An=e,e}function mt(t,e){t&&(t.Gn=e)}function yt(t,e){t&&(t.Hn=e)}function vt(){return $.Yn||($.Yn=nt("canvas").getContext("2d")),$.Yn}function Ct(t){var e,n,o,r=[],i=0;for(e=0;e<t.length;e++)r[i]===C&&(r[i]=""),n=t.charAt(e),o="",e+1<t.length&&(o=t.charAt(e+1))," "===n&&" "!==o||"-"===n&&"-"!==o?(r[i]+=n,i++):r[i]+=n;return r}function bt(t){for(var e=t.length-1;" "===t.charAt(e);)e--;return e!==t.length-1&&(t=t.substring(0,e+1)),t}function wt(t){var e,n=t instanceof Array?[]:{};for(e in t)t.hasOwnProperty(e)&&(n[e]="object"==typeof t[e]&&t[e]!==b?wt(t[e]):t[e]);return n}function Tt(t,e,n,o,r){var i,a,s,l,u,c,f,h,p=[],d=r||vt();if(!d)return p;for(n?(s=t.length*o,a=T(e/o)):(i=(s=_(d,d.font,t))/t.length,a=T(e/i));s>e&&t;)for(l=!1,u=a;;){if(t.length<u){p.push(t),t="";break}if(c=t.substring(0,u),f=n?u*o:_(d,d.font,c),"-"===c.charAt(c.length-1)&&(f=n?u*o:_(d,d.font,c)-_(d,d.font,"-")),f===e||l&&f<e){p.push(c),t=t.substring(u),s-=f;break}if(f>e){if(1===c.length){t.substring(c.length).trim()?(p.push(c),t=t.substring(u),s-=f):(p.push(t),t="");break}u-=1,l=!0}else u+=h=(h=n?(e-f)/o:(e-f)/i)>=1?h:1}return t&&-1===t.search(/^[ ]*$/)&&p.push(t),p}function xt(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m=i||vt();if(!m)return[t];for(a=[],s=0,l=e,u=[],c=0;c<t.length;c++)if(f=t[c].style&&t[c].style.font||r,h=P.fp(f),t[c].text&&t[c].text.length>0?s+=o?h*t[c].text.length:_(m,f,t[c].text):s=0,s<l)u.push(t[c]);else for(s-=o?h*t[c].text.length:_(m,f,t[c].text),p=0;p<t[c].text.length;p++){if((d=o?h:_(m,f,t[c].text.charAt(p)))>n&&0===p){u.length>0&&(a.push(u),u=[]),u.push({style:t[c].style,text:t[c].text.substring(0,1)}),a.push(u),u=[],(g=t[c].text.substring(1,t[c].text.length)).length&&t.splice(c+1,0,{style:t[c].style,text:g}),s=0,l=n;break}if((s+=d)>l){u.push({style:t[c].style,text:t[c].text.substring(0,p)}),a.push(u),u=[],(g=t[c].text.substring(p,t[c].text.length)).length&&t.splice(c+1,0,{style:t[c].style,text:g}),s=0,l=n;break}}return u.length>0&&a.push(u),a}function St(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,C=[],b=Ct(t),w=r||vt();if(!w)return C;for(i=_(w,w.font,t),a=n?o:i/t.length,s=I(e/a+"",10),l=0,u=0,c=0,f=0,h=[],p=!1;f<b.length;){if(!1===p){if(d=b[f],h.push(d),(u+=d.length)<s&&f<b.length-1){f++;continue}c=u,u=0}if(g=n?h.join("").length*o:$.Xn(h.join(""),w.font,!0,w),"-"===h.join("").charAt(h.join("").length-1)&&(g=n?h.join("").length*o:_(w,w.font,h.join(""))-_(w,w.font,"-")),g>e)if(m=h.pop(),0===h.length){for(y=Tt(m,e,n,o,w),v=0;v<y.length-1;v++)C[l]=y[v],l++;1===y.length&&(C[l]=y[0],l++),y.length>=2?b[f]=y[y.length-1]:f++,p=!1}else p=!0,f--;else g<e&&!0===p||g===e?(p=!1,C[l]=bt(h.join("")),l++,h=[],f++):g<e&&(f++,u=c)}return 0!==h.length&&(C[l]=bt(h.join(""))),C}function At(t,e,n,o,r){var i,a,s,l,u,c,f,h,d,g,m=[],y=r||vt();if(!y)return m;if(0===t.length)return m.push({textLength:0,text:"",textInfos:[{style:{font:n},text:""}]}),m;for(i=0,a=[],s=0;s<t.length;s++){for(l=t[s],u=0,0,c=0;c<l.length;c++)void 0,f=l[c].style&&l[c].style.font?l[c].style.font:n,o?u+=P.fp(f)*l[c].text.length:p(l[c].text)||(u+=_(y,f,l[c].text));if(u>e){for(a.length>0&&(m.push({textLength:i,text:bt(Rt(a)),textInfos:wt(a)}),a=[],i=0),h=xt(l,e-i,e,o,n,y),a=a.concat(h[0]),p(h[0])||m.push({textLength:i+It(h[0],n,o,y),text:bt(Rt(a)),textInfos:wt(a)}),a=[],i=0,d=1;d<h.length-1;d++)p(h[d])||m.push({textLength:It(h[d],n,o,y),text:bt(Rt(h[d])),textInfos:wt(h[d])});h.length>1&&(g=h[h.length-1],a=a.concat(g),p(g)||(i+=It(g,n,o,y)))}else i+u>e?(m.push({textLength:i,text:bt(Rt(a)),textInfos:wt(a)}),a=(a=[]).concat(l),i=u):(a=a.concat(l),i+=u)}return a.length>0&&m.push({textLength:i,text:bt(Rt(a)),textInfos:wt(a)}),m}function It(t,e,n,o){var r,i,a=0,s=o||vt();for(r=0;r<t.length;r++)i=t[r].style&&t[r].style.font||e,a+=n?P.fp(i)*t[r].text.length:_(s,i,t[r].text);return a}function Rt(t){var e,n="";for(e=0;e<t.length;e++)n+=t[e].text;return n}function kt(t){return t&&"SPAN"===t.tagName}function Mt(t){return t&&"BR"===t.tagName}function Nt(t){return t instanceof Text}function Et(t){if(t){var e=t.childNodes;return kt(t)&&2===e.length&&Mt(e[0])&&Dt(e[1])}return!1}function Dt(t){if(t&&Nt(t)){var e=t.textContent;if(1===e.length&&jt(e[0]))return!0}return!1}function Ot(t,e,n,o){return t.substr(0,e)+o+t.substr(n,t.length-n)}function jt(t){return"â"===t}function Ft(t,e){for(var n=t&&t.previousSibling;n;){if(e(n))return n;n=n.lastChild}return b}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/core.enum.js"),a=n("@grapecity/js-calc"),s=r.GC$,l=s.extend,u=o.Common.o,c=o.Common.k.Uo,f=o.Formatter&&o.Formatter.GeneralFormatter,h=o.Formatter&&o.Formatter.lxb,p=o.Common.j.Fa,d=o.Common.u,e.FallbackFontFamily='"Helvetica Neue", Arial, sans-serif',g=window,m=document,y="boolean",v="date",C=void 0,b=null,w=Math.floor,T=Math.ceil,x=Math.min,S=Math.max,A=Math.round,I=parseInt,R=parseFloat,k=isNaN,M="px",N=" ",E=".",D="string",O="number",j=RegExp("^/Date\\((-?\\d+)([-+]{1}\\d+)?\\)/\\s*$"),F=RegExp("^/OADate\\(([-+]?(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)\\)/\\s*$"),e.productInfo={productVersion:"14.0.2"},e.CursorResource={ResizeCol:"col-Resize",ResizeRow:"row-resize",ResizeHiddenCol:"w-resize",ResizeHiddenRow:"n-resize"},e.getTypeFromString=function(t){var e,n,o,r=!1,i=g;if(typeof t===D){for(n=0,o=(e=t.split(E)).length;n<o&&i;n++)i=i[e[n]];i&&n===o&&o>0&&(r=!0)}return r?i:C},e.findControl=function(t){return typeof t===D&&(t=m.getElementById(t)),s(t).data("workbook")},P=function(){function t(){}return t.xq=function(t){for(var e,n="";t>0;t=parseInt((t-1)/26+"",10))e=(t-1)%26,n=String.fromCharCode(65+e)+n;return n},t.ol=function(e,n,o,r){if(3===e){var i=s.getType(n);e=o&&"@"===o?0:i===y?1:i===O||i===v||i===D&&t.YGb(n)?2:0,r&&0!==r&&(r>0?e=0:r<0&&(e=2),-90===r?e=0:90===r&&(e=2))}return e},t.YGb=function(e){return t.ZGb.test(e)},t.bc=function(e){var n,r=s.getType(e);return e===b||e===C?e="":r===y?e=(""+e).toUpperCase():r===v?(n=0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds(),e=o.Common.l.Vb(e,n?"M/d/yyyy":"M/d/yyyy h:mm:ss")):e=e.richText?t.K_a(e):""+e,e},t.ql=function(t,e,n,o,r,i,a){var l,u,c,f,h,p,d=s(t),g=e,m=n,y="background-position",v="background-size",C="auto",b="0%",w="100%";switch(i){case 0:a?d.css(y,a.position).css(v,a.size):d.css(y,"0% 0%").css(v,w+N+w);break;case 1:l="50%",u="50%",o>g&&(l=b),r>m&&(u=b),d.css(y,l+N+u).css(v,C+N+C);break;case 2:c=0,f=0,h=g,p=m,m>0&&r>0&&g/m>o/r?c=c+g/2-(h=o/r*m)/2:g>0&&o>0&&m/g>r/o&&(f=f+m/2-(p=r/o*g)/2),d.css(y,c+M+N+f+M).css(v,h+M+N+p+M);break;case 3:d.css(y,"0% 0%").css(v,C+N+C)}},t.device=function(){var t,e,n,o,r=navigator.userAgent,i=r.match(/iPad/i);if(i)(t=i[0])&&(e="ipad"===t.toLowerCase());else if((i=r.match(/Macintosh/i))&&(t=i[0]))try{document.createEvent("TouchEvent"),e="macintosh"===t.toLowerCase()}catch(t){}return(i=r.match(/iPhone/i))&&((t=i[0])&&(n="iphone"===t.toLowerCase())),(i=r.match(/android/i))&&((t=i[0])&&(o="android"===t.toLowerCase())),{ipad:e,iphone:n,android:o}},t.sl=function(){var t=navigator.platform;return t&&t.indexOf("Mac")>-1},t.tl=function(t){if(t===C||t===b)return!1;var e=""+t;return e=u.Oa(e),!k(+(""===e.trim()?NaN:e))||/^[1-9]\d{0,2}(?:(,\d{3})*|\d*)(?:\.\d*)?$/.test(e)},t.ul=function(e,n,o,r,i){var a,s,l,u,c,h,p=b,d=!1;if(e&&((a=e.formatter)?(i?p=i:t.lHb(a)||(p=a,d=!0),typeof p===D&&f&&(p=new f(p))):p=e._autoFormatter),p&&!p.isAuto){s=b;try{if(s=p.parse(n),d&&s instanceof Date&&((l=(new f).getPreferredDisplayFormatter(n,i))&&(s=l.parse(n))),typeof s===O)return s}catch(t){}return s===C||s===b?n:s}if(o){if(u=void 0,u={},c=void 0,h=b,f)try{h=(new f).getPreferredDisplayFormatter(n,u)}catch(t){}return typeof(c=u.value)===O?n=c:t.tl(n)&&(c=u.value=n),r&&(r.value=h),c!==C&&c!==b?c:n}return n},t.vl=function(t){for(var e,n,o=m.body,r=t;r&&r.parentElement&&r.parentElement!==o;)r=r.parentElement;return e=1e3,r&&r.parentElement===o&&(n=I(s(r).css("z-index")),k(n)||(e+=n)),e},t.wl=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g;if(!t)return[];if(e=t.indexOf("("),n=t.lastIndexOf(")"),!(o=t.substring(e+1,n)))return[];for(r=[],i=0,a="",s=0,l=0;l<o.length;)s=o.indexOf("rgb",i),-1===(l=o.indexOf("rgb",i+1))&&(l=o.length),a=o.substring(s,l),r.push(a),i=l;for(u=[],c=0,f=r.length;c<f;c++)p=(h=r[c]).indexOf(")"),d=h.substring(0,p+1),g=R(h.substring(p+1,h.length)),k(g)&&(c===f-1?g=100:c<=1&&(g=0)),(d||0!==c)&&(g/=100,u.push({color:d,point:g}));return u},t.xl=function(e,n,o,r){var a,s,l,u,c,f,h,d,g,m,y,v,C,w,S,A,R,k,M,N=n.yl,E=0,D=[o],O=n.zoom();for(r===i.AutoFitType.cellWithHeader&&(o===i.SheetArea.viewport?D.push(1):o===i.SheetArea.rowHeader&&D.push(0)),a=0;a<D.length;a++)for(s=0,l=D[a],u=n.getRowCount(l);s>=0&&s<u;)(c=n.ITa.findSpan(s,e,l))&&(c.col<e||c.colCount>1||c.row<s)?s=c.row+c.rowCount:(n.getRowHeight(s,l)>0&&(h=0,(d=(f=n.getActualStyle(s,e,l)).cellType||n.Al(l))&&(g=f.font||N.Bl(),f.font=N.Cl(g),(y=!(!(m=n.rowFilter&&n.rowFilter())||!m.Dl(s,e,l)))||3!==l||(v=n.tables?n.tables.find(s,e):b)&&v.showHeader()&&v.headerIndex()===s&&v.rowFilter()&&v.filterButtonVisible(e-v.range().col)&&(y=!0),C=f.formatter?f.formatter:f._autoFormatter,w={sheet:n,row:s,col:e,sheetArea:l,quotePrefix:f.quotePrefix},S={},A=n.getValue(s,e,l,i.ValueType.richText),R=n.xHb(s,e,o),"",k=A&&A.richText?n.getText(s,e,l):p(R)?d.format(A,C,S,w):R,h=d.X4(A,k,f,O,w),y&&(M=x(O,1),h+=I(""+n.defaults.rowHeight*M,10))),h>E&&(E=h)),l===i.SheetArea.viewport?s=t.El(s,e,n,l):s++);return 0===E?E=n.defaults.colWidth:E+=T(3),T(E)},t.El=function(t,e,n,o){var r,i,a=-1,s=n.getRowCount(o);for(r=t+1;r<s;r++){if(n.getText(r,e,o)){a=r;break}if((i=n.getActualStyle(r,e,o))&&(i.cellType||i.cellButtons&&i.cellButtons.length>0)){a=r;break}}return a},t.Fl=function(e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=n.yl,y=0,v=[o],C=n.zoom();for(1===r&&(3===o?v.push(2):1===o&&v.push(0)),i=0;i<v.length;i++)for(o=v[i],a=0,s=n.getColumnCount(o);a>=0&&a<s;)(l=n.ITa.findSpan(e,a,o))&&(l.row<e||l.rowCount>1||l.col<a)?a=l.col+l.colCount:(n.getColumnWidth(a,o)>0&&(c=(u=n.getActualStyle(e,a,o)).font||m.Bl(),u.font=m.Cl(c),f=0,(h=n.getCellType(e,a,o))&&(p=n.getText(e,a,o),d=n.getValue(e,a,o,1),g={sheet:n,row:e,col:a,sheetArea:o},f=h.Y4(d,p,u,C,g)),f>y&&(y=f)),3===o?a=t.Gl(e,a,n,o):a++);return 0===y?y=n.defaults.rowHeight:y+=T(3),T(y)},t.Gl=function(t,e,n,o){var r,i,a=-1,s=n.getColumnCount(o);for(r=e+1;r<s;r++){if(n.getText(t,r,o)){a=r;break}if((i=n.getActualStyle(t,r,o))&&i.cellType){a=r;break}}return a},t.Il=function(e,n,r,i){var s,l,c,p,d,g,m,y,v;if(r&&(s=r.Jl,l=r.Kl,c=e.formatter?e.formatter:e._autoFormatter,p=i||{},f&&n!==b&&n!==C))if(d=void 0,c&&c.isAuto)d=typeof n===O,g=t.tl(n),!d&&g&&(n=u.Oa(n)),n=c.getPreferredEditingFormatter?c.getPreferredEditingFormatter(n).format(n):n;else if(typeof c!==D||t.lHb(c)||(c=new f(c)),c)try{n instanceof Date?((m=a&&a.Convert.Wh(n))&&(n=m),y=o.Common.CultureManager.q4().DateTimeFormat,v=o.Common.l.Ra(n),c=new f(!h.Lc(c.formatString(),["d","y"])&&v>=0&&v<1?y.longTimePattern:0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds()?y.shortDatePattern:y.shortDatePattern+N+y.longTimePattern),r.Ll=!0,n=c.format(n),p.formatter=c):typeof n===O&&(n=u.nb(""+n))}catch(t){n=r.getText(s,l)}else n=r.getText(s,l,3);return n!==b&&n!==C&&(n=t.bc(n)),n},t.yIc=function(t,e){var n,r,i=t,a=o.Common.CultureManager.q4(e).NumberFormat,s=o.Common.u,l=a&&a.percentSymbol;return!(!l||!t)&&("object"==typeof t&&t.formatCached&&(i=t.formatCached),"object"!=typeof i&&(n=!0,r=i,s.kb(i,l)?r=s.Fb(i,0,l.length):s.jb(i,l)?r=s.Fb(i,t.length-l.length,l.length):n=!1,s.Bb(r,l)&&(n=!1),n))},t._Va=function(e){var n,o=t.Ml.msie||t.Ml.edge,r=o&&g.MSPointerEvent&&(navigator.msMaxTouchPoints||0)>1;return e?r:(n=o&&g.PointerEvent&&(navigator.maxTouchPoints||0)>1,r||n)},t.K_a=function(e){return e&&e.richText&&e.richText.length>0?(e.text||(e=t.n0a(e)),e.text):e},t.n0a=function(t){var e,n,o;if(!t)return t;if((e=t.richText)&&e.length>0){for(n=[],o=0;o<e.length;o++)n.push(e[o].text?e[o].text:"");t.text=n.join("")}return t},t.lHb=function(t){return"string"==typeof t&&("="===t.charAt(0)||t.indexOf("{{")>=0&&t.indexOf("}}")>=0)},t.Pl=function(t,e,n,o){var r=t,i=e,a=function(t,e){var a,s,l=this;return l.hasOwnProperty("_ps")||(l._ps={}),a=l._ps,0===arguments.length?a[r]!==C?a[r]:i:(!1!==e&&o&&!o.call(l,t)||(s=a[r]!==C?a[r]:i)!==t&&(a[r]=t,!1!==e&&n&&n.call(l,t,s)),l)};return a.isDefault=function(t){return t===i},a},t.Ql=function(t,e){var n={_ps:{}};return o.Common.j.H(t,(function(t){!function(t,e,n){Object.defineProperty(t,e,{get:function(){return this._ps[e]},set:function(t){var o=this._ps[e];o!==t&&(this._ps[e]=t,n&&n(e,t,o))},enumerable:!0})}(n,t,e)})),n},t.Rl=function(t,e,n,o,r){var i,a=x(e,n),s=S(e,n),l=0;for(i=a;i<s&&(l+=o?t.Sl(i,3):t.Tl(i,3),!(r&&l>r));i++);return l},t.Z3=function(t,e){var n,o,r=0,i=0;return t!==e&&(n=s(t).offset(),o=s(e).offset(),r=n.left-o.left,i=n.top-o.top),{FB:i,EB:r}},t.bq=function(t,e,n){var o,r,i,a;if(!t||"string"!=typeof t)return!1;for(r=0;r<t.length;r++)if("*"===(o=t.charAt(r))||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return!1;if("'"===t.charAt(0)||"'"===t.charAt(t.length-1))return!1;if(!e)return!0;for(i=e.length,r=0;r<i;r++)if(n!==(a=e[r])&&t.toUpperCase()===a.name().toUpperCase())return!1;return!0},t.Ika=function(t,e,n){var o,r,i;if(!t)return t;for(o=0,r=t.length,i=[];o<r;)t[o]===e?i[o]=n:i[o]=t[o],o++;return i.join("")},t.tt=function(){var e,n,o,r=t;return r.ct||(o="-10000px",(n=(e=nt("span")).style).visibility="hidden",n.top=o,n.left=o,n.position="absolute",e.setAttribute("gcUIElement","gcStringWidthSpan"),m.body.insertBefore(e,b),r.ct=e),r.ct},t.fp=function(e,n,o){var r,i,a,s=t,l=s.st;if(!n)if(l){if(o&&(l=l.CJKFontCache),r=l[e])return r}else l=s.st={CJKFontCache:{}},o&&(l=l.CJKFontCache);return(i=s.tt()).style.font=t.hZa(e),t.Ml&&t.Ml.safari&&(i.style.lineHeight="normal"),i.innerHTML=o?String.fromCharCode(20013):"H",a=i.offsetHeight,n||(l[e]=a),a},t.Pxb=function(e){var n,o,r=t,i=r.Qxb;if(i){if(i[e])return i[e]}else i=r.Qxb={};return(o=r.tt()).style.font=e,o.innerHTML="H",(n={}).fontFamily=o.style.fontFamily,n.fontSize=o.style.fontSize,n.fontStyle=o.style.fontStyle,n.fontWeight=o.style.fontWeight,i[e]=n,n},t.Voa=function(e,n){var o=t.tt();return o.style.font=t.hZa(n),t.Ml&&t.Ml.safari&&(o.style.lineHeight="normal"),o.innerHTML=d.Ob(e||"H"),o.offsetHeight},t.iZa=function(n){var o,r=t;return n.indexOf(e.FallbackFontFamily)>=0?n:(n=n.replace("("+String.fromCharCode(27491)+String.fromCharCode(25991)+")","").replace("(Body)","").replace("("+String.fromCharCode(26631)+String.fromCharCode(39064)+")",""),(o=r.tt().style).font=n,o.fontFamily=[].concat(o.fontFamily.split(","),e.FallbackFontFamily.split(",")).join(","),o.font)},t.hZa=function(e){var n,o,r=t;return e&&r.jZa?((n=r.kZa)||(n=r.kZa={}),(o=n[e])||(o=n[e]=r.iZa(e)),o):e},t.lZa=function(e,n){n&&(n=t.hZa(n),e.font!==n&&(e.font=n))},t.pL=function(e,n,o){return!n||p(o)?0:(t.lZa(e,n),e.measureText(o).width)},t.no=function(){var e=t,n=e.ct;n&&(s(n).remove(),e.ct=C),e.st=C,e.Qxb=C,t._0&&(t._0=C),e.kZa=C},t.Woa=function(e){var n,o=t._0;return o||(o=t._0=nt("div")),n=e.innerHTML,o.innerHTML=n,o.innerText},t.G$a=function(t){return t&&/^[A-Za-z_\\\u0080-\uFFFF][A-Za-z0-9_\.\\\?\u0080-\uFFFF]*$/.test(t)&&!(-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||t.length>=255)},t.T$a=function(t){t&&(t.j_a(!0),t.initExpression(),t.k_a())},t.l_a=function(t){var e,n,o=0,r=0,i=t.length;for(i>0&&(o=t[0].row,r=t[0].col),e=1;e<i;e++)o>(n=t[e]).row&&(o=n.row),r>n.col&&(r=n.col);return{r:o=o<0?0:o,c:r=r<0?0:r}},t.w0a=function(t){var e,n;return typeof t===D&&"/"===t.charAt(0)?(n=void 0,F.test(t)?(n=t.match(F),e=o.Common.l.Xb(R(n[1]))):j.test(t)?(n=t.match(j),e=new Date(R(n[1]))):e=t):e=t,e},t.x0a=function(t){return!p(t)&&o.Common.l.Ska(t)?o.Common.l.Daa(t):t},t.yHb=function(t,e){var n,o,r=t.getImageData(e.x,e.y,e.width,e.height),i=r.data;for(n=0;n<i.length-4;n+=4)o=w((30*i[n]+59*i[n+1]+11*i[n+2]+50)/100),i[n]=o,i[n+1]=o,i[n+2]=o;t.putImageData(r,e.x,e.y)},t.ZGb=/[\u0600-\u06FF\u0750-\u077F]/,t.nl=rt,t.rl=t.device,t.Ml=function(){var t,e,n,o,r;return e=function(t){t=t.toLowerCase();var e=/(chrome)[ \/]([\w.]+)/.exec(t)||/(webkit)[ \/]([\w.]+)/.exec(t)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(t)||/(msie) ([\w.]+)/.exec(t)||t.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(t)||[];return{browser:e[1]||"",version:e[2]||"0"}}(t=navigator.userAgent),n={version:C,chrome:C,webkit:C,safari:C,mozilla:C,msie:C,metroMode:C,edge:C},e.browser&&(n[e.browser]=!0,n.version=e.version),n.chrome?n.webkit=!0:n.webkit&&(n.safari=!0),t.indexOf("PhantomJS")>=0&&(n.safari=!1,n.chrome=!0),(o=t.toLowerCase()).indexOf("compatible")<0&&/(trident)(?:.*? rv ([\w.]+)|)/.exec(o)!==b&&(n.mozilla=C,n.msie=!0),(r=/Edge\/\d+/.exec(t))!==b&&r.length>0&&(n.webkit=C,n.chrome=C,n.msie=!0,n.edge=!0,n.version=r[0].substr(r[0].indexOf("/")+1)),n.msie&&function(){var t=b,e=!1;try{new ActiveXObject("")}catch(e){t=e.name}try{e=!!new ActiveXObject("htmlfile")}catch(t){e=!1}return!(e="ReferenceError"===t||!1!==e)}()&&(n.metroMode=!0),n}(),t.browser=t.Ml,t.Nl=nt,t.Ol=et,t.uWa=it,t.jZa=t.sl(),t.Fxb=function(t){return!p(t)&&(typeof t===O||typeof t===y||t instanceof Date||a&&t instanceof a.CalcError)},t}(),e.util=P,e.Ul=P,_=P.pL,L=function(){function t(){}return t.Wl=function(e){return!(t.Xl()!==e||!e.mm||!e.mm.YH)},t.Xl=function(){return g.Yl.activeElement},t.kmb=function(e){var n,o,r,i,a,s,l;function u(t){var i,a;for(i=0;i<=2;i++)(a=t.call(n,i))&&0!==a.width&&0!==a.height&&(e.$l=!0,o._l(r,a))}if(e&&!t.Wl(e)&&e.parent&&e.parent.options.hideSelection){for(n=e.am(),o=e.yl,r=o.bm(),i=e.getSelections(),a=void 0,s=void 0,a=0;a<i.length;a++)l=i[a],(s=e.cm(l)).width>=0&&s.height>=0&&(s.x-=9,s.y-=9,s.width+=18,s.height+=30,o.dm(s));s=n.em(),e.$l=!0,o._l(r,s),u(n.fm),u(n.gm)}},t.Zl=function(e,n){var o=t.Xl();g.Yl.activeElement=e,e===o||n||(o&&(o.endEdit(),t.kmb(o),o.hm&&o.hm()),e&&e.yl.im())},t}(),e.Vl=L,B=function(){function t(){this.jm=0,this.km=[],this.XCb=!1,this.ad()}return t.prototype.rm=function(){var t="gc-theme-version ui-widget-header ui-state-default wijmoThemeHelper btn-default",e="span."+t.split(N).join(E);return G.vm?s(m).find(e).length<=0&&ot(G.vm):G.vm=at(t),G.vm},t.prototype.sm=function(){var t="gc-theme-version ui-widget-content wijmoThemeHelper btn-default",e="span."+t.split(N).join(E);return G.wm?s(m).find(e).length<=0&&ot(G.wm):G.wm=at(t),G.wm},t.prototype.tm=function(){var t="gc-theme-version ui-state-hover wijmoThemeHelper btn-primary",e="span."+t.split(N).join(E);return G.xm?s(m).find(e).length<=0&&ot(G.xm):G.xm=at(t),G.xm},t.prototype.um=function(){var t="gc-theme-version ui-state-highlight wijmoThemeHelper btn-warning",e="span."+t.split(N).join(E);return G.ym?s(m).find(e).length<=0&&ot(G.ym):G.ym=at(t),G.ym},t.prototype.zm=function(){var t="gcDummyElement";return G.Am?s(m).find("#"+t).length<=0&&ot(G.Am):G.Am=at("gc-theme-version",t),G.Am},t.prototype.qm=function(){G.rm(),G.sm(),G.tm(),G.um()},t.prototype.ad=function(){var t,e,n=this;function o(t,e){for(var n=!1,o=t;o;){if("gcSpread"===s(o).attr("gcUIElement")){n=e.zo()!==o;break}o=o.parentElement}return n}function r(t){var r,i,a,s=L.Xl();if(s&&(r=G.Bm(t.target),i=s.Cw&&s.Cw.V4,n.km.forEach((function(t){t&&t(s,r)})),!r||o(r,s)))if(s.gv(C,C,i))e&&((a=s.mm)&&a.Cm&&a.Cm()),L.Zl(b);else if(t.cancelable)return!1}function i(t){var e=t.pointerType;e!==t.MSPOINTER_TYPE_TOUCH&&"touch"!==e||r(t)}n.jm=0,st(g,"keydown",ut,!0),st(g,"keyup",ct,!0),st(g,"compositionstart",ft,!0),st(g,"selectstart",pt,!0),t=P.rl(),e=t.ipad||t.iphone,P.browser.safari&&!e&&st(g,"textInput",ht,!0),P._Va()?(s(m).bind("MSPointerDown",i),s(m).bind("pointerdown",i)):s(m).bind("touchstart",r),st(m,"mousedown",(function(t){!1===r(t)&&rt(t)}),!0),s(m).bind("DOMContentLoaded",(function(){G.qm()}))},t.prototype.Bm=function(t){for(var e,n=t;n&&"BODY"!==n.tagName&&"function"==typeof n.getAttribute;){if((e=n.getAttribute("gcUIElement"))||(e=n.gcUIElement),e)return n;n=n.parentNode}return b},t.prototype.Dm=function(t,e){var n,o,r,a,l=G.rm();return t===i.VisualState.highlight||t===i.VisualState.selected?l=G.um():t===i.VisualState.hover&&(l=G.tm()),n=l.className,s(l).removeClass(n).addClass(e),r={backgroundColor:(o=lt(l)).backgroundColor,backgroundImage:o.backgroundImage},s(l).addClass(n),(a={backgroundColor:(o=lt(l)).backgroundColor,backgroundImage:o.backgroundImage,color:o.color,zIndex:o.zIndex}).borderLeftColor=o.borderLeftColor,a.borderRightColor=o.borderRightColor,a.borderBottomColor=o.borderBottomColor,a.borderBottomWidth=o.borderBottomWidth,a.borderTopColor=o.borderTopColor,a.borderRightWidth=o.borderRightWidth,a.backgroundImage===r.backgroundImage&&a.backgroundColor!==r.backgroundColor&&(a.backgroundImage=C),s(l).removeClass(e),a},t.prototype.Em=function(t){var e,n=G.zm();return s(n).removeClass(n.className).addClass("gc-theme-version "+t),e=lt(n),l({},e)},t.prototype.Fm=function(t){var e,n=G.sm();return s(n).removeClass(n.className).addClass("gc-theme-version ui-widget-content wijmoThemeHelper btn-default "+t),e=lt(n),l({},e)},t.prototype.Gm=function(){g.Yl.jm++},t.prototype.Hm=function(){var t=g.Yl;t.jm--,t.jm<0&&(t.jm=0)},t}(),G=B.prototype,g.Yl||(g.Yl=new B),H=function(){function t(){}return t.Jm=function(t){return{0:"normal",1:"highlight",2:"selected",3:"active",4:"hover",5:"activeNotSelected"}[t]||""},t.Km=function(e,n){var o=t.Jm(e)+n,r=t.styleCache;return r[o]||(r[o]=G.Dm(e,n)),r[o]},t.Lm=function(e){var n=e,o=t.styleCache;return o[n]||(o[n]=G.Em(e)),o[n]},t.Mm=function(e){var n="content"+e,o=t.styleCache;return o[n]||(o[n]=G.Fm(e)),o[n]},t._ob=function(t,e){var n=t.Pm;return n&&n.getColor&&(e=n.getColor(e)),e},t.Nm=function(){t.styleCache={}},t.styleCache={},t}(),e.Im=H,V=function(){function t(t,e){this.x=t,this.y=e}return t.prototype.clone=function(){return new t(this.x,this.y)},t}(),e.Point=V,z=function(){function t(t,e,n,o){var r=this;r.x=t,r.y=e,r.width=n,r.height=o}return t.prototype.intersect=function(t,e,n,o){var r=this;return t<r.x+r.width&&r.x<t+n&&e<r.y+r.height&&r.y<e+o},t.prototype.intersectRect=function(t){return this.intersect(t.x,t.y,t.width,t.height)},t.prototype.contains=function(t,e){var n=this;return n.x<t&&t<n.x+n.width&&n.y<e&&e<n.y+n.height},t.prototype.containsRect=function(t){return this.contains(t.x,t.y)&&this.contains(t.x+t.width,t.y+t.height)},t.prototype.getIntersectRect=function(t){return this.getIntersect(t.x,t.y,t.width,t.height)},t.prototype.getIntersect=function(e,n,o,r){var i=this,a=i.x,s=i.y,l=i.x+i.width,u=i.y+i.height,c=n,f=e+o,h=n+r,p=S(a,e),d=S(s,c),g=x(l,f)-p,m=x(u,h)-d;return g>0&&m>0?new t(p,d,g,m):b},t.prototype.round=function(){var t=this;t.x=w(t.x),t.y=w(t.y),t.width=T(t.width),t.height=T(t.height)},t.prototype.clone=function(){var e=this;return new t(e.x,e.y,e.width,e.height)},t}(),e.Rect=z,W=function(){function t(t,e,n,o){var r=this;r.row=t,r.rowCount=n,r.col=e,r.colCount=o}return t.prototype.intersect=function(t,e,n,o){var r=this;return(-1===t||-1===r.row||r.row<t+n&&t<r.row+r.rowCount)&&(-1===e||-1===r.col||r.col<e+o&&e<r.col+r.colCount)},t.prototype.getIntersect=function(e,n,o){var r,i,a,s,l,u,c,f,h=this;return e&&h.intersect(e.row,e.col,e.rowCount,e.colCount)?(r=-1===h.col?o-1:h.col+h.colCount-1,i=-1===e.col?o-1:e.col+e.colCount-1,a=-1===h.row?n-1:h.row+h.rowCount-1,s=-1===e.row?n-1:e.row+e.rowCount-1,l=S(h.col,e.col),u=x(r,i),c=S(h.row,e.row),f=x(a,s),new t(c,l,-1===c?-1:f-c+1,-1===l?-1:u-l+1)):b},t.prototype.contains=function(t,e,n,o){var r=this,i=arguments.length,a=!1;return 2!==i&&4!==i||(2===i&&(n=1,o=1),a=(-1===r.row||r.row<=t&&t+n<=r.row+r.rowCount)&&(-1===r.col||r.col<=e&&e+o<=r.col+r.colCount)),a},t.prototype.containsRange=function(t){return this.contains(t.row,t.col,t.rowCount,t.colCount)},t.prototype.offset=function(e,n){var o=this,r=o.col,i=o.row;return-1!==r&&(r+=e),-1!==i&&(i+=n),new t(i,r,o.rowCount,o.colCount)},t.prototype.union=function(t){return dt(this,t)},t.prototype.equals=function(e){var n=this;return e instanceof t&&n.row===e.row&&n.col===e.col&&n.rowCount===e.rowCount&&n.colCount===e.colCount},t}(),e.Range=W,e.kf=function(t,e,n,o){return new W(t,e,n,o)},e.getUnionRange=dt,U=function(){function t(){}return t.Om=function(t,e){if(t&&e){var n=t.Pm;if(n)return n.getColor(e)}return e},t.Qm=function(t,e){if(t&&e){var n=t.Pm;return n?n.getFont(e):e}return b},t}(),e.Rm=U,q=function(){function t(){}return t.ValidationError="ValidationError",t.CellClick="CellClick",t.CellDoubleClick="CellDoubleClick",t.ColumnChanging="ColumnChanging",t.RowChanging="RowChanging",t.EnterCell="EnterCell",t.LeaveCell="LeaveCell",t.ValueChanged="ValueChanged",t.TopRowChanged="TopRowChanged",t.SheetChanging="SheetChanging",t.SheetChanged="SheetChanged",t.LeftColumnChanged="LeftColumnChanged",t.InvalidOperation="InvalidOperation",t.RangeFiltering="RangeFiltering",t.RangeFiltered="RangeFiltered",t.RangeFilterClearing="RangeFilterClearing",t.TableFilterClearing="TableFilterClearing",t.RangeFilterCleared="RangeFilterCleared",t.TableFilterCleared="TableFilterCleared",t.TableFiltering="TableFiltering",t.TableFiltered="TableFiltered",t.RangeSorting="RangeSorting",t.RangeSorted="RangeSorted",t.ClipboardChanging="ClipboardChanging",t.ClipboardChanged="ClipboardChanged",t.ClipboardPasting="ClipboardPasting",t.ClipboardPasted="ClipboardPasted",t.ColumnWidthChanging="ColumnWidthChanging",t.ColumnWidthChanged="ColumnWidthChanged",t.RowHeightChanging="RowHeightChanging",t.RowHeightChanged="RowHeightChanged",t.DragDropBlock="DragDropBlock",t.DragDropBlockCompleted="DragDropBlockCompleted",t.DragFillBlock="DragFillBlock",t.DragFillBlockCompleted="DragFillBlockCompleted",t.EditStarting="EditStarting",t.EditStarted="EditStarted",t.EditChange="EditChange",t.EditEnding="EditEnding",t.EditEnd="EditEnd",t.EditEnded="EditEnded",t.RangeGroupStateChanging="RangeGroupStateChanging",t.RangeGroupStateChanged="RangeGroupStateChanged",t.SelectionChanging="SelectionChanging",t.SelectionChanged="SelectionChanged",t.SheetTabClick="SheetTabClick",t.SheetTabDoubleClick="SheetTabDoubleClick",t.SheetNameChanging="SheetNameChanging",t.SheetNameChanged="SheetNameChanged",t.ViewZooming="ViewZooming",t.ViewZoomed="ViewZoomed",t.UserZooming="UserZooming",t.UserFormulaEntered="UserFormulaEntered",t.CellChanged="CellChanged",t.ColumnChanged="ColumnChanged",t.RowChanged="RowChanged",t.ActiveSheetChanging="ActiveSheetChanging",t.ActiveSheetChanged="ActiveSheetChanged",t.SparklineChanged="SparklineChanged",t.OutlineColumnCheckStatusChanged="OutlineColumnCheckStatusChanged",t.RangeChanged="RangeChanged",t.ButtonClicked="ButtonClicked",t.EditorStatusChanged="EditorStatusChanged",t.FloatingObjectChanged="FloatingObjectChanged",t.FloatingObjectSelectionChanged="FloatingObjectSelectionChanged",t.ShapeChanged="ShapeChanged",t.ShapeSelectionChanged="ShapeSelectionChanged",t.PictureChanged="PictureChanged",t.FloatingObjectRemoving="FloatingObjectRemoving",t.ShapeRemoving="ShapeRemoving",t.FloatingObjectRemoved="FloatingObjectRemoved",t.ShapeRemoved="ShapeRemoved",t.PictureSelectionChanged="PictureSelectionChanged",t.FloatingObjectLoaded="FloatingObjectLoaded",t.TouchToolStripOpening="TouchToolStripOpening",t.CommentChanged="CommentChanged",t.CommentRemoving="CommentRemoving",t.CommentRemoved="CommentRemoved",t.SlicerChanged="SlicerChanged",t.BeforeDragDrop="BeforeDragDrop",t.FormulatextboxActiveSheetChanging="FormulatextboxActiveSheetChanging",t.FormulatextboxActiveSheetChanged="FormulatextboxActiveSheetChanged",t.FormulatextboxEditStarted="FormulatextboxEditStarted",t.FormulatextboxEnterCell="FormulatextboxEnterCell",t.FormulatextboxEditEnded="FormulatextboxEditEnded",t.FormulatextboxRangeChanged="FormulatextboxRangeChanged",t.SheetMoving="SheetMoving",t.SheetMoved="SheetMoved",t.DragMerging="DragMerging",t.DragMerged="DragMerged",t.ChartClicked="ChartClicked",t.FloatingElementSelected="FloatingElementSelected",t.BeforePrint="BeforePrint",t.TableResizing="TableResizing",t.TableResized="TableResized",t.TableRowsChanged="TableRowsChanged",t.TableColumnsChanged="TableColumnsChanged",t.DropdownSpreadMouseClick="DropdownSpreadMouseClick",t.DropdownSpreadKeyboardEnter="DropdownSpreadKeyboardEnter",t}(),e.Events=q,Y=function(){function t(t){this.kj=t}return t.prototype.no=function(){this.kj=b},t.prototype.Sm=function(t,e,n){var o,r=this.Tm,i=t<<4+e;return r?((o=r[i])||(o=n(),r[i]=o),o):n()},t.prototype.Um=function(t,e){var n,o=this.Vm;return o&&(n=o[t])?n[e]:b},t.prototype.Wm=function(t,e,n,o){var r=this.Vm;r&&(r[t]||(r[t]={}),r[t][e]={d:n,i:o})},t.prototype.zHb=function(t,e,n,o,r){var i,a=this,s=a.kj;return n===C&&(n=3),i=s.xHb(t,e,n),p(i)?!p(r)&&P.lHb(r.formatter)?X.vn(s,r,a.ge(t,e,n,0),{},{row:t,col:e,sheet:s}):a.ge(t,e,n,o):i},t.prototype.ge=function(t,e,n,o){var r,i,a,s=this.kj,l=this.Xm;return n===C&&(n=3),l?((r=l[n])||(r={},l[n]=r),(i=r[t])||(i={},r[t]=i),(a=i[e])===C&&(a=s.getValue(t,e,n,o),i[e]=a),a):s.getValue(t,e,n,o)},t.prototype.Ym=function(t,e,n){var o,r,i,a=this.kj,s=this.Zm;return n===C&&(n=3),s?((o=s[n])||(o={},s[n]=o),(r=o[t])||(r={},o[t]=r),(i=r[e])||(i=a.AHb(t,e,n,!1,!0),r[e]=i),i.clone(!0)):a.AHb(t,e,n,!1,!1)},t.prototype.Sl=function(t){var e,n=this.kj,o=this.$m;return o?((e=o[t])===C&&(e=o[t]=n.Sl(t)),e):n.Sl(t)},t.prototype._m=function(t){var e,n=this.kj,o=this.an;return o?((e=o[t])===C&&(e=o[t]=n.Tl(t)),e):n.Tl(t)},t.prototype.bn=function(t){var e=this;return e.Xm?(e.cn||(e.cn=t()),e.cn):t()},t.prototype.dn=function(t){var e=this;return e.Xm?(e.gn||(e.gn=t()),e.gn):t()},t.prototype.hn=function(){var t=this;t.in=!0,t.Tm={},t.Vm={},t.Xm={},t.Zm={},t.$m={},t.an={}},t.prototype.jn=function(){this.in=!1},t.prototype.kn=function(){var t=this;t.in=!1,t.Tm=b,t.Vm=b,t.Xm=b,t.Zm=b,t.an=b,t.$m=b,t.cn=b,t.gn=b},t}(),e.ln=Y,X=function(){function t(){}return t.qn=function(e,n,o,r,i){var a,s,l,u;if(t.nn=!0,(a=e.tables)&&a.rn(n,o,r-n+1,i-o+1))for(s=-1,l=t.sn=[],u=0;u<=r;u++)e.getRowVisible(u)?(s++,l[u]=s):l[u]=-1},t.Nm=function(){t.sn=b,t.nn=!1},t.tn=function(e){var n=t.on;return n[e]||(n[e]=f?new f(e):b),n[e]},t.un=function(e,n,o){var r,i,a,s,l,u,h=t.pn,p=e+"_"+typeof e;return f?(h[n]||(h[n]={}),(i=(r=h[n])[p])?(o&&(o.conditionalForeColor=o.value=i.color,o.content=c(i.content)),i.text):((a=t.on)[n]||(a[n]=new f(n)),s={},l=a[n].format(e,s),(u=r[p]={}).text=l,u.color=s.conditionalForeColor,u.content=s.content,o&&(o.conditionalForeColor=o.value=s.conditionalForeColor,o.content=c(s.content)),l)):""+e},t.vn=function(t,e,n,o,r){var i,a;return n&&"SparklineExValue"===n.typeName?"":(i=e.cellType||t.Al(),a=e.formatter||e._autoFormatter,i.format(n,a,o,r))},t.wn=function(){t.on={},t.pn={}},t.nn=!1,t.on={},t.pn={},t.sn=[],t}(),e.mn=X,Z=function(){function t(){}return t.Cn=function(t,e,n){var o=gt(t);o.scaleX=e,o.scaleY=n,o.translateX=o.orgTranslateX*e,o.translateY=o.orgTranslateY*n,t.setTransform(o.scaleX,o.skewX,o.skewY,o.scaleY,o.translateX,o.translateY)},t.Dn=function(t,e,n){var o=gt(t);o.orgTranslateX+=e,o.orgTranslateY+=n,o.translateX=o.orgTranslateX*o.scaleX,o.translateY=o.orgTranslateY*o.scaleY,t.setTransform(o.scaleX,o.skewX,o.skewY,o.scaleY,o.translateX,o.translateY)},t}(),e.Bn=Z,Q=Z,J=function(){function t(){}return t.npb=function(){var t=g.screen,e=t.deviceXDPI,n=g.devicePixelRatio||(e?e/t.logicalXDPI:1),o=20*n,r=A(o);return r-o>.82?r/20:A(100*n)/100},t.Kn=function(e,n,o){var r,i,a,s,l,u,c,f,h=t;if(mt(e,1),yt(e,1),(1!==(r=t.npb())||1!==h.dpr)&&(h.dpr=r,i=n||o&&o.parent)){for(a=h.Fn,s=void 0,l=0;l<a.length;l++)if(i===a[l].workbook){s=a[l];break}if(s||(s={workbook:i,sheets:[],canvases:[]},a.push(s)),n)s.canvases.push(e);else{for(u=void 0,c=s.sheets,f=0;f<c.length;f++)if(c[f].sheet===o){u=c[f];break}u||(u={sheet:o,canvases:[]},c.push(u)),u.canvases.push(e)}}},t.Ln=function(t){return t&&t.Gn||1},t.Mn=function(t){return t&&t.Hn||1},t.Nn=function(t){return t.In},t.On=function(t){return t.Jn},t.Pn=function(e,n,o){var r,i,a,s=t,l=s.dpr,u=s.Ln(e),c=s.Mn(e);(function(t,e){t.In=e})(e,n),function(t,e){t.Jn=e}(e,o),1===l&&1===u&&1===c?(e.width=n,e.height=o):(r=e.getContext("2d"),Q.Cn(r,1,1),P.Ml.mozilla?(e.width=T(n*l),e.height=T(o*l)):(e.width=A(n*l),e.height=A(o*l)),e.style.width=n+M,e.style.height=o+M,i=e.width/n,a=e.height/o,i===u&&a===c||(mt(e,i),yt(e,a)),Q.Cn(r,i,a))},t.Qn=function(e,n){var o,r,i,a,s,l=t.Fn,u=e.parent;for(i=0;i<l.length;i++)if(!u||l[i].workbook===u)for(o=l[i].sheets,a=0;a<o.length;a++)if(o[a].sheet===e){for(r=o[a].canvases,s=0;s<r.length;s++)if(r[s]===n){r.splice(s,1);break}break}},t.Rn=function(e,n){var o,r,i,a=t.Fn;for(r=0;r<a.length;r++)if(a[r].workbook===e)for(o=a[r].canvases,i=0;i<o.length;i++)if(o[i]===n){o.splice(i,1);break}},t.Sn=function(e){var n,o,r,i=t.Fn,a=e.parent;for(o=0;o<i.length;o++)if(!a||i[o].workbook===a){for(n=i[o].sheets,r=0;r<n.length;r++)n[r].sheet===e&&n.splice(r,1);return}},t.Tn=function(e){var n,o=t.Fn;for(n=0;n<o.length;n++)if(o[n].workbook===e)return void o.splice(n,1)},t.Un=function(){var e,n,o,r,i,a,s,l,u=t,c=u.npb();if(u.dpr!==c)for(e=u.Fn,n=void 0,o=void 0,r=void 0,i=void 0,u.dpr=c,a=0;a<e.length;a++){for(r=(o=e[a]).canvases,n=o.sheets,s=0;s<n.length;s++)r=r.concat(n[s].canvases);for(l=0;l<r.length;l++)i=r[l],u.Pn(i,u.Nn(i),u.On(i))}},t.dpr=1,t.Fn=[],t}(),e.En=J,$=function(){function t(){}return t.Wn=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g=[];if(!t||0===t.length)return g;if(!(i=r||vt()))return g;if(P.lZa(i,n),a=P.fp(n),e<=0){for(s=-1,l=!0,u=0;u<t.length;u++)(c=t.charAt(u))===N||l?c!==N&&l&&(s=o?a:_(i,i.font,c),l=!1):s=x(s,o?a:_(i,i.font,c));if((e=s)<=0)return[t]}for(f=t.split(/\r\n|\r|\n/),h=0;h<f.length;h++)if(p=St(f[h],e,o,a,i))if(0===p.length)g.push("");else for(d=0;d<p.length;d++)g.push(p[d]);return g},t.oV=function(e,n,o,r,i){var a,s,l,u,c=[];if(0===n.length)return c;if(r)c=t.Wn(n,i,o,!0);else for(a=n.split(/\r\n|\r|\n/),s=0;s<a.length;s++){for(l=[],u=0;u<a[s].length;u++)l.push(a[s][u]);c.push(l)}return c},t.M_a=function(e,n,o,r,i,a){var s,l,u,c,f,h,d,g=[];if(0===e.length)return g;if(!(s=a||vt()))return g;if(n<=0&&(n=function(t,e,n,o){var r,i,a,s,l,u=-1,c=!0;for(r=0;r<e.length;r++)if(!p(e[r].text))for(i=0;i<e[r].text.length;i++)a=e[r].text.charAt(i),s=e[r].style?e[r].style.font:n,P.lZa(t,s),l=P.fp(s),a===N||c?a!==N&&c&&(u=o?l:_(t,n,a),c=!1):u=x(u,o?l:_(t,n,a));return u}(s,r,o,i))<=0){for(u=[],l=0;l<r.length;l++)p(r[l].text)||u.push({textLength:t.R_a([r[l]],o,1,i,!1,s),text:r[l].text,textInfos:[r[l]]});return u}for(c=t.N_a(e),f=t.O_a(c,t.P_a(r)),l=0;l<f.length;l++)if(h=At(f[l],n,o,i,s))if(0===h.length)g.push("");else for(d=0;d<h.length;d++)g.push(h[d]);return g},t.N_a=function(t){var e,n=[],o=t.split(/\r\n|\r|\n/);for(e=0;e<o.length;e++)n.push(Ct(o[e]));return n},t.O_a=function(t,e){var n,o,r,i,a,s,l=[],u=0,c=0;for(n=0;n<t.length;n++){for(o=[],r=0;r<t[n].length&&u<e.length;r++)if((i=t[n][r]).length<=e[u].text.length-c)o.push([{style:e[u].style,text:i}]),c+=i.length;else{for((a=[]).push({style:e[u].style,text:e[u].text.substring(c)}),s=i.length-(e[u].text.length-c),u++;u<e.length;u++){if(s<e[u].text.length){a.push({style:e[u].style,text:i.substring(i.length-s)}),c=s;break}if(s===e[u].text.length){a.push({style:e[u].style,text:i.substring(i.length-s)}),u++,c=0;break}a.push({style:e[u].style,text:e[u].text}),s-=e[u].text.length}o.push(a)}l.push(o)}return l},t.Xn=function(t,e,n,o){var r,i=o||vt();return i?(e&&P.lZa(i,e),r=n?bt(t):t,_(i,i.font,r)):0},t.P_a=function(t){var e,n=[];for(e=0;e<t.length;e++)n.push({style:t[e].style,text:t[e].text?t[e].text.replace(/\r\n|\r|\n/g,""):t[e].text});return n},t.R_a=function(t,e,n,o,r,i){var a,s,l,u,c,f=i||vt();if(!f)return 0;for(a=0,s=0;s<t.length;s++)void 0,l=t[s].style&&t[s].style.font?t[s].style.font:e,P.lZa(f,l),"",u=s===t.length-1&&r?bt(t[s].text):t[s].text,c=0,o?c=P.fp(l)*u.length/n:p(t[s].text)||(c=_(f,f.font,t[s].text)/n),t[s].style&&t[s].style.vertAlign&&(c*=.7),a+=c;return a},t.mHb=function(e,n,o,r,i,a,s,l){var u=0,c=P.fp(a),f=(s-4-c*r)/o,h=t.Wn(i,f,a),p=h.length,d=c*o;return u=(p-1)*(c/o),(u+=t.Xn(h[0],a)/2*r+d)+(t.Xn(h[p-1],a)/2*r+d)},t.Rvb=function(t){return bt(t)},t.bm=function(){return vt()},t}(),e.Vn=$,e.Zn=function(t){t.$n=function(e,n){var o,r;for(t._n||(t._n=[]),t._fc={},o=t._n,n.name=e,n.priority=n.priority||5e3,r=0;;r++)if(r>=o.length||n.priority>o[r].priority){o.splice(r,0,n);break}},t.ao=function(e,n,o,r){var i,a,s,l=t._n;if(l){if(!(i=t._fc[n]))for(i=t._fc[n]=[],a=0;a<l.length;a++)(s=l[a][n])&&i.push(s);for(a=0;a<i.length&&(i[a].call(e,o),!r||!r());a++);}}},K=function(){function t(){this.JTa={}}return t.prototype.get=function(t,e){var n=this.JTa[t];return n?n[e]:C},t.prototype.set=function(t,e,n){var o=this.JTa[t];o||(o=this.JTa[t]={}),o[e]=n},t}(),e.KTa=K,tt=function(){function t(){}return t.processBackspaceAndLeftArrowKeyEvent=function(t,e){var n,o,r,i,a,s,l,u,c,f,h=g.getSelection();if(!(h.rangeCount<=0)){if(n=h.anchorNode,o=h.anchorOffset,r=t.target,P.browser.msie&&!P.browser.edge&&e&&function(t,e,n){if(1===e&&kt(n.firstChild)&&kt(n.firstChild.firstChild)){var o=n.firstChild.firstChild.lastChild,r=void 0;if(t===n)return 1===(r=o.textContent).length&&"â"!==r[0]&&Mt(o.previousSibling);if(o===t||Mt(o)&&t===o.previousSibling)return 1===(r=t.textContent).length&&"â"!==r[0]&&Mt(t.previousSibling)}return!1}(n,o,r))return i=parseFloat(P.browser.version)<10?function t(e,n,o,r,i,a){var s,l,u,c,f,h="",p=e.childNodes,d=p.length;for(s=0;s<d;s++)kt(l=p[s])?h+=t(l,n,o,r,i,a):Nt(l)?(u=n&&n.startContainer,c=n&&n.endContainer,f=l.textContent,l===u||l===c?u!==c?l===u?(h+=Ot(f,o,f.length,i),a=!0):(h+=Ot(f,0,r,""),a=!1):h+=Ot(f,o,r,i):a||(h+=f)):Mt(l)&&!a&&(h+="\n");return h}(r):r.innerText,a=i.slice(0,-1),r.innerHTML=a.replace(/\r/g,"").replace(/\n/g,"<br>â"),h.selectAllChildren(r),h.rangeCount>0&&h.collapseToEnd(),void rt(t);if((s=function(t,e){var n,o,r,i,a,s=t.childNodes.length;if(!jt(t.textContent[0])||0!==e&&1!==e)if(0===e)o=t,t===t.parentNode.firstChild&&(o=t.parentNode),r=Ft(o,Et),n=r&&r.lastChild;else{if(function(t){return t&&"DIV"===t.tagName}(t))return 1===s&&1===e?n=t.firstChild.firstChild.lastChild:s>1&&e===s&&(n=t.lastChild),Dt(n)?{zeroWidthCharNode:n,previousTextNode:n.previousSibling.previousSibling}:Et(n)?{zeroWidthCharNode:n,previousTextNode:Ft(o,Nt)}:b;!kt(t)||e!==s&&e!==s-1||(Et(t)?n=t:Et(t.lastChild)&&(n=t.lastChild))}else n=t;return n?(kt(n)?o=n:Nt(n)&&(i=n.previousSibling,a=n.parentNode,o=i===a.firstChild?a:i),{zeroWidthCharNode:n,previousTextNode:Ft(o,Nt)}):b}(n,o))&&s.zeroWidthCharNode){if(l=s.zeroWidthCharNode,u=s.previousTextNode,e)if(kt(l))l.parentNode.removeChild(l);else{if(l.parentNode.removeChild(l.previousSibling),Mt(u))return void rt(t);(c=h.getRangeAt(0)).setStart(l,0),c.setEnd(l,1),c.deleteContents()}(f=m.createRange()).setStartAfter(u),f.setEndAfter(u),f.collapse(!1),h.removeAllRanges(),h.addRange(f),rt(t)}}},t.processDeleteAndRightArrowKeyEvent=function(t,e){var n,o,r,i,a,s=g.getSelection();s.rangeCount<=0||(n=function(t){var e,n,o=t.anchorNode,r=t.anchorOffset,i=o.textContent.length;if(r===i){if(e=function(t){for(var e,n=t;n;){if(e=n.parentNode,n!==e.lastChild)return n.nextSibling;n=e}return b}(o),n=void 0,!e)return b;if(kt(e)&&jt(e.textContent[0])){for(;kt(e.firstChild);)e=e.firstChild;n=e.childNodes[1]}else Mt(e)&&jt(e.nextSibling.textContent[0])&&(n=e.nextSibling);return{node:n,offset:1}}return b}(s))&&n.node&&(o=n.node,r=n.offset,e?((i=s.getRangeAt(0)).setStart(o,0),i.setEnd(o,1),i.deleteContents(),o.parentNode.removeChild(o.previousSibling)):((a=m.createRange()).setStart(o,r),a.setEnd(o,r),a.collapse(!1),s.removeAllRanges(),s.addRange(a)),rt(t))},t}(),e.uHb=tt,e.Rxb={touch:!1}},"./dist/core/util/domUtil.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F;function P(t,e){var n,o;for(Array.call(this),"string"==typeof t?n=(e||u).querySelectorAll(t):t&&(n=r.Ca(t)||t instanceof HTMLCollection?t:[t]),o=0;n&&o<n.length;o++)this.push(n[o])}function _(t){return O.isWindow(t)?t:9===t.nodeType&&(t.defaultView||t.parentWindow)}function L(t,e){var n=t.nodeName;return n&&n.toLowerCase()===e.toLowerCase()}function B(t,e){return"top left right bottom width height border-radius border-width border-left-width border-right-width border-top-width border-bottom-width line-height padding padding-left padding-right padding-top padding-bottom margin margin-left margin-right margin-top margin-bottom".split(" ").indexOf(t)>=0&&isFinite(e)?("width height".split(" ").indexOf(t)>=0&&e<0&&(e=0),e+"px"):e}function G(t,e,n){var o,r,i=t.nodeType;if(t&&3!==i&&8!==i&&2!==i)return 1!==i&&(e=I[e]||e,r=R[e]),X(n)?r&&h in r&&(o=r.get(t,e))!==s?o:t[e]:r&&p in r&&!X(o=r.set(t,n,e))?o:(t[e]=n,n)}function H(t){var e,n,o,r=t.nodeType;return(!r||1===r||9===r)&&(e={embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},!(o=(n=t.nodeName)&&e[n.toLowerCase()])||!0!==o&&t.getAttribute("classid")===o)}function V(t){return t.replace(/^-ms-/,"ms-").replace(/-([\da-z])/gi,(function(t,e){return e.toUpperCase()}))}function z(t,e,n,o){if(H(t)){var r,i,l=N,u=q(e),c=t.nodeType,f=c?M:t,h=c?t[l]:t[l]&&l;if(h&&f[h]&&(o||f[h].data)||!u||!X(n))return h||(c?(t[l]=h=E,E++):h=l),f[h]||(f[h]={},c||(f[h].toJSON=function(){})),(Y(e)||"function"==typeof e)&&(o?f[h]=O.extend(f[h],e):f[h].data=O.extend(f[h].data,e)),r=f[h],o||(r.data||(r.data={}),r=r.data),X(n)||(r[V(e)]=n),u?(i=r[e])!==s&&i!==a||(i=r[V(e)]):i=r,i}}function W(t){var e;for(e in t)if(("data"!==e||!O.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function U(t,e){for(var n,o,r,a,l,u,c,f,h,p=0,d=N,g=M,m=t[p];m!==s&&void 0!==m;){if((e||H(m))&&(o=(n=m[d])&&g[n])){if(r=o.events)for(a in r)if(i(r,a)&&(l=r[a]))for(u in l)if(i(l,u)&&(c=l[u]))for(f=0,h=c.length;f<h;f++)tt(m,a,c[f]);g[n]&&(delete g[n],delete m[d])}m=t[++p]}}function q(t){return"string"==typeof t}function Y(t){return"object"==typeof t}function X(t){return typeof t==typeof a}function Z(t){var e=t;return function(t){var n,o=this,r="border-box"===o.css("box-sizing"),i=e?d:g,a=e?m:v,s=e?y:C;return 0===arguments.length?(n=Math.round(l(o.css(i)))||0,r&&(n-=l(o.css("padding-"+a))+l(o.css("padding-"+s))+l(o.css("border-"+a+"-"+d))+l(o.css("border-"+s+"-"+d))),n):(o.css(i,t),o)}}function Q(t){var e=t;return function(){var t=this,n=e?m:v,o=e?y:C;return e?t.width():t.height()+l(t.css("padding-"+n))+l(t.css("padding-"+o))}}function J(t){var e=t;return function(t){var n=e?m:v,o=e?y:C,r=this,i=e?r.innerWidth():r.innerHeight();return i+=l(r.css("border-"+n+"-"+d))+l(r.css("border-"+o+"-"+d)),t&&(i+=l(r.css("margin-"+n))+l(r.css("margin-"+o))),i}}function $(t){var e=t;return function(t){return this.forEach((function(n){n.style[A]=e?w:T,t&&t.apply(n)})),this}}function K(t){var e=t;return function(t){var n="scrollLeft",o="scrollTop",r=e?n:o,i=e?"pageXOffset":"pageYOffset",a=this[0],s=_(a);return X(t)?s?i in s?s[i]:u.documentElement[r]:a[r]:(s?s.scrollTo(e?t:O(s)[n](),e?O(s)[o]():t):a[r]=t,this)}}function tt(t,e,n){t.removeEventListener(e,n)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=o.Common.j,i=o.Common.D,a=void 0,s=null,l=parseFloat,u=document,c="_nonamespace",f="events",h="get",p="set",d="width",g="height",m="left",y="right",v="top",C="bottom",b="hidden",w="block",T="none",x="position",S="visibility",A="display",I={tabindex:"tabIndex",readonly:"readOnly",for:"htmlFor",class:"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},R={tabIndex:{get:function(t){var e=t.getAttributeNode("tabindex"),n=t.nodeName;return e&&e.specified?parseInt(e.value,10):/^(?:input|select|textarea|button|object)$/i.test(n)||/^(?:a|area)$/i.test(n)&&t.href?0:a}}},k={option:{get:function(t){var e=t.attributes.value;return!e||e.specified?t.value:t.text}},select:{get:function(t){var e,n,o=t.options,r=t.selectedIndex,i="select-one"===t.type||r<0,a=i?s:[],l=i?r+1:o.length,u=i?r:0;for(r<0&&(u=l);u<l;u++)if(((n=o[u]).selected||u===r)&&!n.disabled&&(!n.parentNode.disabled||!L(n.parentNode,"optgroup"))){if(e=O(n).val(),i)return e;a.push(e)}return a},set:function(t,e){var n=O.makeArray(e);return O(t).find("option").getAll().forEach((function(t){t.selected=O.inArray(O(t).val(),n)>=0})),n.length||(t.selectedIndex=-1),n}}},M={},N="$"+(""+Math.random()).replace(/\D/g,""),E=1,D={},[g,d].forEach((function(t){D[t]={get:function(e){var n,o,r,i=getComputedStyle(e),a=e.style,s=a[x],l=a[S],c=a[A],f=0===e.offsetWidth&&/^(none|table(?!-c[ea]).+)/.test(i[A]);if(f&&(a[x]="absolute",a[S]=b,a[A]=w),n=i&&i[t],f&&(a[x]=s,a[S]=l,a[A]=c),""===n){for(o=e.parentElement,r=u.body;o&&o!==r;)o=o.parentElement;o!==r&&(n=a[t])}return n}}})),O=function(t,e){return t instanceof P?t:new P(t,e)},e.GC$=O,j={get:function(t){return this[t]},getAll:function(){return this},bind:function(t,e,n){return X(n)&&(n=e,e=a),this.forEach((function(o){var r,i,s,l,u,h,p=z(o,f,a,!0);p||z(o,f,p={},!0),i=(r=t.split("."))[0],(l=p[s=r[1]||c])||(l=p[s]={}),(u=function(t){X(e)||(t.data=e);var r=n.apply(o,arguments);t.result=r,!1===r&&(t.preventDefault?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!1,t.returnValue=!1))}).original=n,(h=l[i])||(h=l[i]=[]),h.push(u),o.addEventListener(i,u)})),this},unbind:function(t,e){return this.forEach((function(n){var o,r,s,l,u=t.split("."),h=u[0],p=u[1]||c,d=z(n,f,a,!0),g=d&&d[p];if(e){if(g&&h&&(o=g[h]))for(s=o.length,r=0;r<s;r++)if(o[r].original===e){tt(n,h,o[r]),o.splice(r,1);break}}else if(g)if(h){if(o=g[h])for(s=o.length,r=0;r<s;r++)tt(n,h,o[r]);g[h]=a}else{for(l in g)if(i(g,l)&&(o=g[l]))for(s=o.length,r=0;r<s;r++)tt(n,l,o[r]);d[p]=a}})),this},trigger:function(t,e){var n,o,r,s,l,u,c,h,p,d,g=this;for(n=0,o=g.length;n<o;n++)if(s=z(r=g[n],f,a,!0))for(u in l=t.split(".")[0],s)if(i(s,u)&&(h=(c=s[u])&&c[l]))for(p=0,d=h.length;p<d;p++)h[p].apply(r,[{type:l},e]);return g},css:function(t,e){var n,o,r,a=this,s=a,l=arguments.length;function u(t,e){s.forEach((function(n){n.style[t]=B(t,e)}))}if(1===l){if(!Y(t))return n=a[0],(o=D[t])&&h in o?o.get(n):(r=getComputedStyle(n))&&r[t];s.forEach((function(e){for(var n in t)i(t,n)&&(e.style[n]=B(n,t[n]))}))}else 2===l&&(Array.isArray(t)&&Array.isArray(e)&&t.length===e.length?t.forEach((function(t,n){u(t,e[n])})):u(t,e));return a},width:Z(!0),height:Z(),innerWidth:Q(!0),innerHeight:Q(),outerWidth:J(!0),outerHeight:J(),append:function(t){var e,n=[t];return t instanceof O&&(n=t.getAll()),this,e=this[0],n.forEach((function(t){t&&e.appendChild(t)})),this},appendTo:function(t){var e=t;return t instanceof O&&(e=t[0]),this,this.forEach((function(t){e.appendChild(t)})),this},prepend:function(t){var e=this[0];return e.insertBefore(t,e.firstChild),this},insertBefore:function(t){var e=t.parentElement;return this.forEach((function(n){e.insertBefore(n,t)})),this},addClass:function(t){var e,n,o,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(e=(t||"").match(/\S+/g)||[];a<s;a++)if(o=1===(n=this[a]).nodeType&&(n.className?(" "+n.className+" ").replace(l," "):" ")){for(r=e[i=0];r;)o.indexOf(" "+r+" ")<0&&(o+=r+" "),r=e[++i];n.className=O.trim(o)}return this},removeClass:function(t){var e,n,o,r,i,a=0,s=this.length,l=/[\t\r\n]/g;for(e=(t||"").match(/\S+/g)||[];a<s;a++)if(o=1===(n=this[a]).nodeType&&(n.className?(" "+n.className+" ").replace(l," "):"")){for(r=e[i=0];r;){for(;o.indexOf(" "+r+" ")>=0;)o=o.replace(" "+r+" "," ");r=e[++i]}n.className=t?O.trim(o):""}return this},hasClass:function(t){var e,n=0,o=this.length,r=/[\t\r\n]/g;for(t=" "+t+" ";n<o;n++)if(1===(e=this[n]).nodeType&&(" "+e.className+" ").replace(r," ").indexOf(t)>=0)return!0;return!1},toggle:function(){var t=this;return t[0].style[A]===T?t.show():t.hide(),t},show:$(!0),hide:$(),attr:function(t,e){var n=this,o=n,r=arguments.length;if(1===r){if(!Y(t))return n[0].getAttribute(t);o.forEach((function(e){for(var n in t)i(t,n)&&e.setAttribute(n,t[n])}))}else 2===r&&o.forEach((function(n){n.setAttribute(t,e)}));return n},removeAttr:function(t){return this.forEach((function(e){e.removeAttribute(t)})),this},prop:function(t,e){var n=this,o=n,r=arguments.length;if(1===r){if(!Y(t))return G(n[0],t);o.forEach((function(e){for(var n in t)i(t,n)&&G(e,n,t[n])}))}else 2===r&&o.forEach((function(n){G(n,t,e)}));return n},removeProp:function(t){t=I[t]||t;return this.forEach((function(e){try{e[t]=a,delete e[t]}catch(t){}})),this},text:function(t){var e=this,n=e;return 0===arguments.length?e[0].textContent:(n.forEach((function(e){e.textContent=t})),e)},val:function(t){var e,n,o,r,i=this;return arguments.length?(r=O.isFunction(t),i.forEach((function(n,o){var i;1===n.nodeType&&((i=r?t.call(n,o,O(n).val()):t)===s||i===a?i="":"number"==typeof i?i+="":O.isArray(i)&&(i=O.map(i,(function(t){return t===s||t===a?"":t+""}))),(e=k[n.type]||k[n.nodeName.toLowerCase()])&&p in e&&!X(e.set(n,i,"value"))||(n.value=i))})),i):(o=void 0,(n=i[0])?(e=k[n.type]||k[n.nodeName.toLowerCase()])&&h in e&&!X(o=e.get(n,"value"))?o:q(o=n.value)?o.replace(/\r/g,""):o===s||o===a?"":o:void 0)},position:function(){var t,e,n,o,r=this[0];if(r){if(t={top:0,left:0},e={top:0,left:0},"fixed"===O(r).css(x))try{t=r.getBoundingClientRect()}catch(t){}else n=this.offsetParent(),t=this.offset(),L(o=n[0],"html")||((e=n.offset()).left-=o.scrollLeft,e.top-=o.scrollTop),e.top+=l(O(o).css("borderTopWidth")),e.left+=l(O(o).css("borderLeftWidth"));return{top:t.top-e.top-l(O(r).css("marginTop")),left:t.left-e.left-l(O(r).css("marginLeft"))}}},offsetParent:function(){var t=O.map(this,(function(t){for(var e=u.documentElement,n=t.offsetParent||e;n&&!L(n,"html")&&"static"===O(n).css(x);)n=n.offsetParent;return n||e}));return O(t)},offset:function(){var t,e,n={top:0,left:0},o=this[0],r=o&&o.ownerDocument;if(r){if(t=r.documentElement,!X(o.getBoundingClientRect))try{n=o.getBoundingClientRect()}catch(t){}return e=_(r),{top:n.top+(e.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(e.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}}},scrollLeft:K(!0),scrollTop:K(),html:function(t){var e=this,n=e;return 0===arguments.length?e[0].innerHTML:(n.forEach((function(e){e.innerHTML=t})),e)},remove:function(){this.forEach((function(t){var e=t.parentElement;e&&(e.removeChild(t),U([t]))}))},empty:function(){return this.forEach((function(t){O(t.children).remove()})),this},find:function(t){var e=[];return q(t)&&this.forEach((function(n){var o=n.querySelectorAll(t);O.merge(e,o)})),O(e)},parent:function(){var t=[];return this.forEach((function(e){var n=e.parentElement;n&&t.push(n)})),O(t)},index:function(t){var e=this[0];return t?q(t)?O.inArray(e,O(t).getAll()):O.inArray(t,this):e&&e.parentElement?O.inArray(e,e.parentElement.children):-1},focus:function(){var t=this[0];return t!==u.activeElement&&t.focus&&t.focus(),this},isVisible:function(){var t=0;return this.forEach((function(e){var n=getComputedStyle(e);n[S]!==b&&n[A]!==T&&t++})),t>0},data:function(t,e){var n=this,o=X(e);return o&&(n=void 0),O.each(this,(function(r,i){var a=z(i,t,e);if(o)return n=a,!1})),n},removeData:function(t){return O.each(this,(function(e,n){!function(t,e,n){if(H(t)){var o,r,i,a=t.nodeType,l=a?M:t,u=a?t[N]:N;if(l[u]){if(e&&(i=n?l[u]:l[u].data)){O.isArray(e)?e=e.concat(O.map(e,V)):e in i?e=[e]:e=(e=V(e))in i?[e]:e.split(" "),r=e.length;for(o=0;o<r;o++)delete i[e[o]];if(!(n?W:O.isEmptyObject)(i))return}(n||(delete l[u].data,W(l[u])))&&(a?U([t],!0):l!==l.window?delete l[u]:l[u]=s)}}}(n,t)})),this}},F=P.prototype=[],r.Ia(F,j),O.prototype=F,O.each=r.H,O.isEmptyObject=r.za,O.isFunction=r.Aa,O.isArray=r.Ca,O.isNumeric=r.Da,O.getType=r.Ba,O.inArray=r.Ea,O.merge=r.Ga,O.map=r.Ha,O.extend=r.Ia,O.inherit=r.G,O.isPlainObject=r.Ja,O.isArraylike=r.ya,O.isWindow=r.Ka,O.makeArray=r.La,O.trim=function(t){if(t.trim)return t.trim();return t===s||t===a?"":(t+"").replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")},O.Nl=function(t,e,n,o,r){var i=O(u.createElement(t));return e&&n&&i.css(e,n),o&&i.addClass(o),r&&(r instanceof O?r.append(i):O(r).append(i)),i}},"./dist/core/util/imageLoader.js":function(t,e,n){"use strict";var o,r,i,a;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=o.GC$,i=".gcSheet",a=function(){function t(t){this.bo=0,this.co=0,this.eo={};this.do=t}return t.prototype.fo=function(t){var e,n,o=this;function a(){o.ho(t,!1)}(e=o.eo)[t]||((n=r(document.createElement("img"))).bind("load"+i,(function(){o.ho(t,!0)})),n.bind("error"+i,a),n.bind("abort"+i,a),o.bo++,e[t]={io:!1,jo:n[0],agc:!1},n[0].src=t)},t.prototype.ko=function(t){var e=this.eo[t];return!!e&&e.io},t.prototype.bgc=function(t){var e=this.eo[t];return!!e&&e.agc},t.prototype.lo=function(t){var e=this.eo[t];return e?e.jo:null},t.prototype.ho=function(t,e){var n=this;n.co++,n.eo[t].io=!0,n.eo[t].agc=e,n.mo()&&n.do&&n.do()},t.prototype.mo=function(){return this.co>=this.bo},t.prototype.no=function(){var t,e=this.eo;if(e)for(t in e)e[t]&&r(e[t].jo).unbind(i);this.do=null},t}(),e.oo=a},"./dist/core/util/tasks.js":function(t,e,n){"use strict";var o,r;Object.defineProperty(e,"__esModule",{value:!0}),o=function(){function t(t,e){this.fn=t,this.args=e}return t.prototype.run=function(){this.fn.apply(null,this.args)},t}(),e.Task=o,r=function(){function t(t,e){var n=this;n.tasks=[],n.nextTaskFunc=t.bind(n),n.isBusyFunc=e.bind(n)}return t.prototype.addTask=function(t,e){this.tasks.splice(0,0,new o(t,e))},t.prototype.pushTask=function(t,e){this.tasks.push(new o(t,e))},t.prototype.runNextTask=function(){var t=this,e=t.tasks;if(!t.isTerminated){if(e.length<1)return void(t.endingCallback&&t.endingCallback());if(t.isBusyFunc())return void setTimeout((function(){t.runNextTask()}),100);t.nextTaskFunc().run(),setTimeout((function(){t.runNextTask()}),10)}},t.prototype.start=function(){this.runNextTask()},t.prototype.terminate=function(){this.tasks=[],this.isTerminated=!0},t}(),e.Tasks=r},"./dist/core/util/theme.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b;function w(t){var e=t;return function(n){return 0===arguments.length?this.po[e]:(this.po[t]=s(n),this)}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/util/common.js"),i=o.Common.j.Fa,a=o.Common.pc,s=a.ec,l=parseInt,u=r.util.Pl,c="Gill Sans MT",f="Franklin Gothic Book",h="Trebuchet MS",p=10,d=11,g=function(){function t(t,e,n,o,r,i,a,l,u,c,f,h,g){this.background1=w(0),this.background2=w(1),this.textColor1=w(2),this.textColor2=w(3),this.accent1=w(4),this.accent2=w(5),this.accent3=w(6),this.accent4=w(7),this.accent5=w(8),this.accent6=w(9),this.hyperlink=w(p),this.followedHyperlink=w(d),this.Cj=t,this.po=[];for(var m=1;m<13;m++)this.po.push(s(arguments[m]))}return t.prototype.name=function(t){return 0===arguments.length?this.Cj:(this.Cj=t,this)},t.prototype.getColor=function(t){var e,n,o,r,i;if(t&&"string"==typeof t&&(n=void 0,e=t.split(" "))){if(o=-1,(r=e.length)>1){if(!e[0])return t;"background"===(n=e[0].toLowerCase())?o=l(e[1],10)-1:"text"===n?o=l(e[1],10)+1:"accent"===n&&(o=l(e[1],10)+3)}else 1===r&&("hyperlink"===(n=e[0].toLowerCase())?o=p:"followedhyperlink"===n&&(o=d));if(o>=0&&o<=11)return r>2?(i=l(e[2],10)/100,a.bc(a.jc(this.po[o],i))):a.bc(this.po[o])}return t},t.prototype.toJSON=function(){var t=this.po;return{name:this.Cj,background1:t[0],background2:t[1],text1:t[2],text2:t[3],accent1:t[4],accent2:t[5],accent3:t[6],accent4:t[7],accent5:t[8],accent6:t[9],hyperlink:t[p],followedHyperlink:t[d]}},t.prototype.fromJSON=function(t,e){var n,o,r,a,s,l,u,c,f,h,g,m,y,v,C;function b(t,e){i(e)||(n.po[t]={a:e.a,r:e.r,g:e.g,b:e.b})}t&&(n=this,"_colorList","_name",e?(v=t.name?t.name:t._name,i(v)||(n.Cj=v),o=(C=t.colorList?t.colorList:t._colorList)[0],r=C[1],a=C[2],s=C[3],l=C[4],u=C[5],c=C[6],f=C[7],h=C[8],g=C[9],m=C[p],y=C[d]):(i(t.name)||(n.Cj=t.name),o=t.background1,r=t.background2,a=t.text1,s=t.text2,l=t.accent1,u=t.accent2,c=t.accent3,f=t.accent4,h=t.accent5,g=t.accent6,m=t.hyperlink,y=t.followedHyperlink),b(0,o),b(1,r),b(2,a),b(3,s),b(4,l),b(5,u),b(6,c),b(7,f),b(8,h),b(9,g),b(p,m),b(d,y))},t.prototype.e4=function(t){var e,n,o,r;if(this.name()!==t.name())return!1;for(n=0,o=(e=["textColor1","textColor2","background1","background2","accent1","accent2","accent3","accent4","accent5","accent6","hyperlink","followedHyperlink"]).length;n<o;n++)if(r=e[n],!a.Pka(this[r](),t[r]()))return!1;return!0},t}(),e.ColorScheme=g,m=function(){function t(t,e,n,o){this.name=u("name"),this.colors=u("colors"),this.headerFont=u("headerFont"),this.bodyFont=u("bodyFont");var r=this;r.name(t),r.colors(e||new g(t)),r.headerFont(n),r.bodyFont(o)}return t.prototype.getColor=function(t){return this.colors().getColor(t)},t.prototype.getFont=function(t){return"Body"===t?this.bodyFont():"Headings"===t?this.headerFont():t},t.prototype.toJSON=function(){var e=this,n=e.name();return t.f4(e)?n:{name:n,themeColor:e.colors()?e.colors().toJSON():void 0,headingFont:e.headerFont(),bodyFont:e.bodyFont()}},t.f4=function(t){var e,n=t.name();return!!b[n]&&(e=b[n],t.bodyFont()===e.bodyFont()&&t.headerFont()===e.headerFont()&&t.colors().e4(e.colors()))},t}(),e.Theme=m,y="#000000",v="#FFFFFF",C=function(){function t(){}return t.Default=new g("Default",v,"#EEECE1",y,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),t.Office2007=new g("Office2007",v,"#EEECE1",y,"#1F497D","#4F81BD","#C0504D","#9BBB59","#8064A2","#4BACC6","#F79646","#0000FF","#800080"),t.Office=new g("Office",v,"#E7E6E6",y,"#44546A","#5B9BD5","#ED7D31","#A5A5A5","#FFC000","#4472C4","#70AD47","#0563C1","#954F72"),t.Apex=new g("Apex",v,"#C9C2D1",y,"#69676D","#CEB966","#9CB084","#6BB1C9","#6585CF","#7E6BC9","#A379BB","#410082","#932968"),t.Aspect=new g("Aspect",v,"#E3DED1",y,"#323232","#F07F09","#9F2936","#1B587C","#4E8542","#604878","#C19859","#6B9F25","#B26B02"),t.Concourse=new g("Concourse",v,"#DEF5FA",y,"#464646","#2DA2BF","#DA1F28","#EB641B","#39639D","#474B78","#7D3C4A","#FF8119","#44B9E8"),t.Civic=new g("Civic",v,"#C5D1D7",y,"#646B86","#D16349","#CCB400","#8CADAE","#8C7B70","#8FB08C","#D19049","#00A3D6","#694F07"),t.Oriel=new g("Oriel",v,"#FFF39D",y,"#575F6D","#FE8637","#7598D9","#B32C16","#F5CD2D","#AEBAD5","#777C84","#D2611C","#3B435B"),t.Origin=new g("Origin",v,"#DDE9EC",y,"#464653","#727CA3","#9FB8CD","#D2DA7A","#FADA7A","#B88472","#8E736A","#B292CA","#6B5680"),t.Paper=new g("Paper",v,"#FEFAC9",y,"#444D26","#A5B592","#F3A447","#E7BC29","#D092A7","#9C85C0","#809EC2","#8E58B6","#7F6F6F"),t.Solstice=new g("Solstice",v,"#E7DEC9",y,"#4F271C","#3891A7","#FEB80A","#C32D2E","#84AA33","#964305","#475A8D","#8DC765","#AA8A14"),t.Technic=new g("Technic",v,"#D4D2D0",y,"#3B3B3B","#6EA0B0","#CCAF0A","#8D89A4","#748560","#9E9273","#7E848D","#00C8C3","#A116E0"),t.Trek=new g("Trek",v,"#FBEEC9",y,"#4E3B30","#F0A22E","#A5644E","#B58B80","#C3986D","#A19574","#C17529","#AD1F1F","#FFC42F"),t.Urban=new g("Urban",v,"#DEDEDE",y,"#424456","#53548A","#438086","#A04DA3","#C4652D","#8B5D3D","#5C92B5","#67AFBD","#C2A874"),t.Verve=new g("Verve",v,"#D2D2D2",y,"#666666","#FF388C","#E40059","#9C007F","#68007F","#005BD3","#00349E","#17BBFD","#FF79C2"),t.Equity=new g("Equity",v,"#E9E5DC",y,"#696464","#D34817","#9B2D1F","#A28E6A","#956251","#918485","#855D5D","#CC9900","#96A9A9"),t.Flow=new g("Flow",v,"#DBF5F9",y,"#04617B","#0F6FC6","#009DD9","#0BD0D9","#10CF9B","#7CCA62","#A5C249","#E2D700","#85DFD0"),t.Foundry=new g("Foundry",v,"#EAEBDE",y,"#676A55","#72A376","#B0CCB0","#A8CDD7","#C0BEAF","#CEC597","#E8B7B7","#DB5353","#903638"),t.Median=new g("Median",v,"#EBDDC3",y,"#775F55","#94B6D2","#DD8047","#A5AB81","#D8B25C","#7BA79D","#968C8C","#F7B615","#704404"),t.Metro=new g("Metro",v,"#D6ECFF",y,"#4E5B6F","#7FD13B","#EA157A","#FEB80A","#00ADDC","#738AC8","#1AB39F","#EB8803","#5F7791"),t.Module=new g("Module",v,"#D4D4D6",y,"#5A6378","#F0AD00","#60B5CC","#E66C7D","#6BB76D","#E88651","#C64847","#168BBA","#680000"),t.Opulent=new g("Opulent",v,"#F4E7ED",y,"#B13F9A","#B83D68","#AC66BB","#DE6C36","#F9B639","#CF6DA4","#FA8D3D","#FFDE66","#D490C5"),t}(),e.ThemeColors=C,b=function(){function t(){}return t.Default=new m("Default",C.Default,"Cambria","Calibri"),t.Office=new m("Office",C.Office,"Calibri Light","Calibri"),t.Office2007=new m("Office2007",C.Office2007,"Cambria","Calibri"),t.Apex=new m("Apex",C.Apex,"Lucida Sans","Book Antiqua"),t.Aspect=new m("Aspect",C.Aspect,"Verdana","Verdana"),t.Concourse=new m("Concourse",C.Concourse,"Lucida Sans Unicode","Lucida Sans Unicode"),t.Civic=new m("Civic",C.Civic,"Georgia","Georgia"),t.Oriel=new m("Oriel",C.Oriel,"Century Schoolbook","Century Schoolbook"),t.Origin=new m("Origin",C.Origin,"Bookman Old Style",c),t.Paper=new m("Paper",C.Paper,"Constantia","Constantia"),t.Solstice=new m("Solstice",C.Solstice,c,c),t.Technic=new m("Technic",C.Technic,f,"Arial"),t.Trek=new m("Trek",C.Trek,"Franklin Gothic Medium",f),t.Urban=new m("Urban",C.Urban,h,"Georgia"),t.Verve=new m("Verve",C.Verve,"Century Gothic","Century Gothic"),t.Equity=new m("Equity",C.Equity,f,"Perpetua"),t.Flow=new m("Flow",C.Flow,"Calibri","Constantia"),t.Foundry=new m("Foundry",C.Foundry,"Rockwell","Rockwell"),t.Median=new m("Median",C.Median,"Tw Cen MT","Tw Cen MT"),t.Metro=new m("Metro",C.Metro,"Consolas","Corbel"),t.Module=new m("Module",C.Module,"Corbel","Corbel"),t.Opulent=new m("Opulent",C.Opulent,h,h),t}(),e.Themes=b},"./dist/core/workbook/sheettab.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/util/common.js"),i=n("./dist/core/worksheet/stylehelper.js"),a=n("./dist/core/workbook/sheettabbase.js"),s=n("./dist/core/core.enum.js"),l=o.Common.pc,u=l.ic,c=l.ec,f=null,h=function(t){function e(e){var n=t.call(this,e)||this,o=n;return o.EC=13,o.GC=12,o.HC=0,o.kw=30,o.IC=28,o.JC=28,o.KC=28,o.LC=0,o._font="10pt Segoe UI",n}return p(e,t),e.prototype.NC=function(){var t=this.OC,e=t&&t.options;return e&&e.tabNavigationVisible?this.IC*(e.useTouchLayout?1.5:1):0},e.prototype.PC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?t.Jv():0},e.prototype.QC=function(){return this.JC},e.prototype.RC=function(){return this.SC?0:this.JC},e.prototype.TC=function(){return this.SC?0:this.KC},e.prototype.UC=function(){var t,e,n=this,o=n.OC.sheets,r=n.VC(),i=n.WC,a=n.Dr(),s=a.x+a.width-n.kw-n.TC()-n.RC();for(t=n.gq,e=o.length;t<e;t++)if(o[t].visible()&&(r+=i[t]),r>s){r=s;break}return r},e.prototype.VC=function(){var t=this;return 2*t.NC()+t.QC()+t.XC()},e.prototype.XC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?this.kw/2:0},e.prototype.getResizeBarBounds=function(){var t=this,e=t.Dr();return{x:e.x+e.width-t.kw,y:f,width:t.kw,height:f}},e.prototype.getNavButtonBounds=function(){return{x:this.kw/2,y:f,width:this.NC(),height:f,endIndex:3,startIndex:1}},e.prototype.getSheetTabBounds=function(){var t=this,e=t.Dr(),n=t.RC();return{x:t.VC(),y:f,height:f,secondMoreTabWidth:t.RC(),moreTabPos:e.x+e.width-t.kw-t.TC()-n}},e.prototype.getPreMoreTabBounds=function(){var t=this;return{x:t.VC()-t.QC(),width:t.QC()}},e.prototype.YC=function(){var t=this;return t.ZC+t.WC[t.$C]>t._C()},e.prototype._C=function(){var t=this;return t.Dr().width-t.kw-t.TC()-t.RC()},e.prototype.aD=function(){return 6},e.prototype.Via=function(){return["blank","nextButton"]},e.prototype.cD=function(){return this.VC()},e.prototype.dD=function(t,e){t.save(),t.beginPath();var n=r.Im.Km(0,"gc-tabStripBackground");this.eD=c(n.backgroundColor),t.fillStyle=n.backgroundColor,t.fillRect(e.x,e.y,e.width,e.height),t.beginPath(),t.strokeStyle=n.borderTopColor,t.moveTo(e.x,e.y+.5),t.lineTo(e.x+e.width,e.y+.5),t.stroke(),t.restore()},e.prototype.fD=function(t,e,n,o){var r,i,a=this,s=a.OC.options.newTabVisible,l=a.IC,u=a.RC();n+=u,a.KC=s?l:0,n>(r=e.x+e.width-a.kw-a.TC())&&(n=r,(i=r-u)<o&&(n=(i=o)+l),a.gD(t,i,0,u,e.height)),s&&a.hD(t,n,0,l,e.height,-2===a.iD)},e.prototype.jD=function(t,e,n,o){var r=this.QC();this.gD(t,o-r,0,r,e.height)},e.prototype.kD=function(t,e,n){var o=this,r=o.NC(),i=o.PC(),a=o.kw/2+r/2,s=i/2,l=o.lD;o.mD(t,a,s,a+5,s+5,a+5,s-5,!0,f,1===l),a+=r,o.mD(t,a,s,a-5,s+5,a-5,s-5,!1,f,2===l)},e.prototype.nD=function(t,e){var n,o,i=this.kw,a=r.Im.Km(0,"gc-tabStripResizeBarInner");this.OC.options.showHorizontalScrollbar&&(t.beginPath(),t.rect(e.x+e.width-i,0,i,e.height),t.clip(),n=e.x+e.width-i/2,o=e.y+e.height/2,t.fillStyle=a.color,t.fillRect(n,o,2,2),t.fillRect(n,o-4,2,2),t.fillRect(n,o+4,2,2))},e.prototype.oD=function(t,e,n,o,a,l,u,c,f,h){var p,d,g,m,y,v=this,C=s.VisualState.normal;c&&(C=s.VisualState.hover),h&&(C=s.VisualState.selected),u&&(C=s.VisualState.active),u&&!h&&(C=s.VisualState.activeNotSelected),p=r.Im.Km(C,"gc-tab-"+r.Im.Jm(C)),d=r.Im.Km(0,"gc-tab-"+r.Im.Jm(0)),t.save(),u&&h&&(t.fillStyle="white",t.fillRect(e,n,o,a-4)),h?(t.fillStyle="white",t.fillRect(e,n+1,o,a-4)):u&&(t.fillStyle="white",t.fillRect(e,n,o,1)),g=v.pD(t,u,f,p),t.fillStyle=g,t.fillRect(e+3,n+3,o-6+1,a-6),t.beginPath(),t.lineWidth=1,t.strokeStyle=d&&d.borderLeftColor,u?(t.moveTo(e+.5,n),t.lineTo(e+.5,n+a-4),t.moveTo(e+o+.5,n),t.lineTo(e+o+.5,n+a-4)):(t.moveTo(e+.5,n+4),t.lineTo(e+.5,n+a-4),t.moveTo(e+o+.5,n+4),t.lineTo(e+o+.5,n+a-4)),t.stroke(),h&&(t.beginPath(),t.strokeStyle=p&&p.borderBottomColor,t.lineWidth=2,t.moveTo(e,n+a-4),t.lineTo(e+o+1,n+a-4),t.stroke()),t.textBaseline="top","string"==typeof g&&(m=g),t.fillStyle=v.qD(p,m),(c||u||h)&&(t.font=i.To.Ro(t.font,"bold")),y=v.EC,t.textBaseline="middle",t.fillText(f,e+y,n+a/2-1),t.restore()},e.prototype.mD=function(t,e,n,o,i,a,l,u,c,f){var h,p,d,g;t.save(),h=this,p=s.VisualState.highlight,f&&(p=s.VisualState.hover),u?(e-=2,o-=2,-1===h.rw(h.gq)&&(p=s.VisualState.normal)):(e+=2,o+=2,-1===h.rD(h.sD())&&(p=s.VisualState.normal)),d=r.Im.Km(p,"gc-navButton-"+r.Im.Jm(p)),t.strokeStyle=this.tD(d.borderTopColor),t.beginPath(),g=1,e>o&&(g=-1),t.moveTo(e-.5,n),t.lineTo(e-.5,n+1),t.moveTo(e+g-.5,n-1),t.lineTo(e+g-.5,n+2),t.moveTo(e+2*g-.5,n-2),t.lineTo(e+2*g-.5,n+3),t.moveTo(e+3*g-.5,n-3),t.lineTo(e+3*g-.5,n+4),t.stroke(),t.restore()},e.prototype.hD=function(t,e,n,o,i,a){var l,u,c;t.save(),t.beginPath(),l=(i-14)/2,u=s.VisualState.highlight,a&&(u=s.VisualState.hover),c=r.Im.Km(u,"gc-tabStripNewTab-"+r.Im.Jm(u)),t.lineWidth=1.5,t.strokeStyle=this.tD(c.borderTopColor),t.arc(e+o/2,n+i/2,l,0,2*Math.PI),t.stroke(),t.beginPath(),t.lineWidth=2,t.moveTo(e+o/2-4,n+i/2),t.lineTo(e+o/2+4,n+i/2),t.moveTo(e+o/2,n+i/2-4),t.lineTo(e+o/2,n+i/2+4),t.stroke(),t.restore()},e.prototype.gD=function(t,e,n,o,i){var a,l,u;t.save(),t.beginPath(),a=s.VisualState.highlight,5!==(l=this.lD)&&6!==l||(a=s.VisualState.hover),u=r.Im.Km(a,"gc-navMoreButton-"+r.Im.Jm(a)),t.fillStyle=this.tD(u.borderTopColor),t.fillRect(e+o/2,n+i/2,2,2),t.fillRect(e+o/2-4,n+i/2,2,2),t.fillRect(e+o/2+4,n+i/2,2,2),t.restore()},e.prototype.tD=function(t){var e=c(t),n=this.eD;return e.a<=.01?u(n):l.hc(n,e)?u(e):t},e}(a.DC),e.iv=h},"./dist/core/workbook/sheettab2007.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("Common"),i=n("./dist/core/util/common.js"),a=n("./dist/core/workbook/sheettabbase.js"),s=n("./dist/core/worksheet/stylehelper.js"),l=i.Ul.wl,u=null,c=Math.min,f="#92A5C7",h=new r.Common.ResourceManager(o.SR),p=h.getResource.bind(h),d=function(t){function e(e){var n=t.call(this,e)||this,o=n;return o.EC=12,o.GC=8,o.HC=3,o.kw=12,o.KC=48,o.LC=5,o._font="10pt Arial",n}return g(e,t),e.prototype.NC=function(){var t=this.OC,e=t&&t.options;return e&&e.tabNavigationVisible?t.Wv()*(e.useTouchLayout?2:1):0},e.prototype.PC=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?t.Wv():0},e.prototype.VC=function(){return 4*this.NC()+this.lE()},e.prototype.lE=function(){var t=this.OC;return t&&t.options.tabNavigationVisible?2:0},e.prototype.getResizeBarBounds=function(){var t=this,e=t.Dr();return{x:e.x+e.width-t.kw,y:u,width:t.kw,height:u}},e.prototype.getNavButtonBounds=function(){return{x:0,y:u,width:this.NC(),height:u,endIndex:4,startIndex:0}},e.prototype.getSheetTabBounds=function(){return{x:this.VC(),y:u,height:u,secondMoreTabWidth:0,moreTabPos:0}},e.prototype.getPreMoreTabBounds=function(){var t=this;return{x:t.VC(),width:t.HC+t.LC}},e.prototype.YC=function(){var t=this;return t.ZC+t.WC[t.$C]+t.TC()>t._C()},e.prototype._C=function(){return this.Dr().width-this.kw},e.prototype.aD=function(){return 1},e.prototype.Via=function(){return["newSheet"]},e.prototype.cD=function(){var t=this,e=t.VC()+t.Dr().height;return t.OC.options.newTabVisible&&(e+=t.TC(),e+=t.HC),e},e.prototype.dD=function(t,e){var n,o,r,a,s,u,c,f;if(t.save(),t.beginPath(),n=t.createLinearGradient(e.x,e.y,e.width,e.height),r=(o=i.Im.Km(0,"gc-tabStripBackground"))&&o.backgroundImage,a=o&&o.backgroundColor,r&&-1!==r.indexOf("linear-gradient"))for(u=0,c=(s=l(r)).length;u<c;u++)f=s[u],n.addColorStop(f.point,f.color);else a&&(n.addColorStop(0,"#DDDDDD"),n.addColorStop(1,a));t.fillStyle=n,t.fillRect(e.x,e.y,e.width,e.height),t.restore()},e.prototype.fD=function(t,e,n,o){var r=this,i=r.OC,a=p().NewTab;i.options.newTabVisible&&(r.KC=t.measureText(a).width+r.EC,r.oD(t,n,0,r.TC(),e.height,5,!1,-2===r.iD,a,!1))},e.prototype.jD=function(t,e,n,o){var r=this,i=n-1,a=r.WC[i];r.oD(t,o+r.LC-a-r.HC,0,a,e.height,5,r.$C===i,r.iD===i,"",!1)},e.prototype.kD=function(t,e,n){var o,r,i,a,s=this;t.fillStyle=f,t.fillRect(e.x,e.y,n-1,e.height),r=(o=s.NC())/2,i=s.PC()/2,a=s.lD,s.mD(t,r,i,r+5,i+5,r+5,i-5,!0,r-5,0===a),r+=o,s.mD(t,r,i,r+5,i+5,r+5,i-5,!0,u,1===a),r+=o,s.mD(t,r,i,r-5,i+5,r-5,i-5,!1,u,2===a),r+=o,s.mD(t,r,i,r-5,i+5,r-5,i-5,!1,r+4,3===a)},e.prototype.nD=function(t,e){var n,o=this.OC,r=this.kw,a=i.Im.Km,s=a(4,"gc-tabStripResizeBarInner"),l=a(0,"gc-tabStripResizeBarOuter");o.options.showHorizontalScrollbar&&(n=e.x+e.width-r,t.fillStyle=l.backgroundColor,t.fillRect(n,e.y,r,e.height),t.fillStyle=s.backgroundColor,t.fillRect(n+1,e.y+1,r-2,e.height-2),t.fillStyle=s.color,t.fillRect(n+r/2-1,e.y+4,2,e.height-8))},e.prototype.oD=function(t,e,n,o,r,a,l,u,c,h){var p,d,g,m,y,v;t.save(),t.beginPath(),t.moveTo(e,n),t.lineTo(e,n+r-a),t.arcTo(e,n+r,e+o,n+r,a),t.lineTo(e+o,n+r),t.lineTo(e+o+r,n),l||t.lineTo(e,n),p=this,d=0,(u||h)&&(d=4),g=i.Im.Km(d,"gc-tab-"+i.Im.Jm(d)),m=p.pD(t,h||u,c,g),t.fillStyle=m,t.fill(),t.strokeStyle=f,t.stroke(),t.textBaseline="top","string"==typeof m&&(y=m),t.fillStyle=p.qD(g,y),l&&(t.font=s.To.Ro(t.font,"bold")),v=p.EC,t.textBaseline="middle",t.fillText(c,e+v,n+r/2),t.restore()},e.prototype.mD=function(t,e,n,o,r,a,s,f,h,p){var d,g,m,y,v,C,b,w,T,x,S,A;if(t.save(),this,d=this.Dr(),g=this.NC(),y=(m=i.Im.Km)(4,"gc-navButton-hover"),C=(v=m(0,"gc-navButton-normal"))&&v.backgroundColor,p)t.fillStyle=y.backgroundColor,t.fillRect(e-g/2+2,d.y+2,g-4,d.height-4);else{if((b=v&&v.backgroundImage)&&-1!==b.indexOf("linear-gradient")){for(w=t.createLinearGradient(d.x+.7*d.height,d.y+0,.7*d.height,d.height),x=0,S=(T=l(b)).length;x<S;x++)A=T[x],w.addColorStop(A.point,A.color);t.fillStyle=w}else C&&(t.fillStyle=C);t.fillRect(e-g/2,d.y+1,g,d.height-2)}t.fillStyle=p?y.color:v.color,void 0!==h&&h!==u&&t.fillRect(h,c(r,s),1,Math.max(r,s)-c(r,s)),f?(e-=2,o-=2,a-=2):(e+=2,o+=2,a+=2),t.beginPath(),t.moveTo(e,n),t.lineTo(o,r),t.lineTo(a,s),t.lineTo(e,n),t.fill(),t.restore()},e}(a.DC),e.jv=d},"./dist/core/workbook/sheettabbase.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z;function Q(t,e,n){t.Wq(a.Events.SheetTabClick,{sheet:e,sheetName:e?e.name():y,sheetTabIndex:h(n)?-1:n})}function J(t,e){t.Wq(a.Events.SheetMoving,e)}function $(t,e,n,o){t.Wq(a.Events.SheetMoved,{sheet:e,sheetName:e?e.name():y,oldIndex:n,newIndex:o})}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("Common"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=n("./dist/core/worksheet/stylehelper.js"),l=n("./dist/core/core.enum.js"),u=r.Common.pc,c=a.Ul.wl,f=a.Ul.bq,h=r.Common.j.Fa,p=a.Ul.Nl,d=a.Ul.lZa,g=window,m=document,y=null,v=Math.max,C=Math.min,b=Math.pow,w="px",T="none",S="mousedown"+(x=".gcTab"),A="mousemove"+x,I="mouseup"+x,R="mouseout"+x,k="dblclick"+x,N="mousemove"+(M=".spliter"),E="mouseup"+M,O="keydown"+(D=".tabNameEditor"),j="focus"+D,F="blur"+D,P="canvas",_="2d",L="resize",B="navButton",G="tab",H="newSheet",V="blank",z="black",W="white",U="navButton",q="sheetTab",Y=new r.Common.ResourceManager(o.SR),X=Y.getResource.bind(Y),Z=function(){function t(t){this.Cj=t,this.SC=!1,this.LC=0,this.HC=0,this.buffer=null;var e=this;e.OC=y,e.$C=0,e.gq=0,e.ZC=70,e.lD=-1,e.iD=-1,e._font="",e.WC=[],e.uD=-1,e.vD=-1,e.wD=y,e.xD=0,e.Us(new a.Rect(0,0,200,28))}return t.prototype.ws=function(e){var n,o=this;o.Xs&&o.no(!0),n=p(P),a.En.Kn(n,o.OC),n.setAttribute("id",o.Cj),o.yD=o.zD(),e.appendChild(o.yD[0]),e.appendChild(n),o.Xs=n,i.GC$(n).bind(S,(function(t){return o.AD(t)})).bind(A,(function(t){return o.BD(t)})).bind(I,(function(t){return o.CD(t)})).bind(R,(function(t){return o.DD(t)})).bind(k,(function(t){return o.ED(t)})),o.fq(),t.ao(o,"setHost")},t.prototype.Yv=function(t){var e=t.options.font;this.OC=t,t&&e&&e.length>0&&(this._font=e)},t.prototype.Dr=function(){var t=this.Zs;return new a.Rect(t.x,t.y,t.width,t.height)},t.prototype.Us=function(t){var e=this.Zs=new a.Rect(0,0,0,0);e.x=t.x,e.y=t.y,e.width=t.width,e.height=t.height},t.prototype.TC=function(){return this.KC},t.prototype.UC=function(){var t=this.Dr();return t.x+t.width-this.kw},t.prototype.VC=function(){return 0},t.prototype.fq=function(){var t,e,n,o,r=this,s=r.Ws();s&&s.parentNode&&(0!==(t=i.GC$(s.parentNode)).width()&&0!==t.height()&&(e=v(t.width(),0),n=v(t.height(),0),s.style.display=T,s.width=e,s.height=n,s.style.display="",s.style.width=e+w,s.style.height=n+w,e=s.clientWidth||s.width,n=s.clientHeight||s.height,o=r.Dr(),r.Us(new a.Rect(o.x,o.y,e,n)),a.En.Pn(s,e,n),r.repaint()))},t.prototype.YC=function(){return!1},t.prototype._C=function(){return 0},t.prototype.aD=function(){return 0},t.prototype.Via=function(){return[]},t.prototype.cD=function(){return 0},t.prototype.zD=function(){var t="transparent";return i.GC$(p("div")).css({position:"absolute","border-style":"solid","border-color":z,"border-width":4+w,display:"none",width:0,"border-bottom":0,"border-left-color":t,"border-right-color":t})},t.prototype.no=function(e){var n,o=this,r=o.Xs;r&&(n=r.parentNode,i.GC$(r).unbind(S).unbind(A).unbind(I).unbind(k).unbind(R),n&&n.removeChild(r)),i.GC$(o.yD).remove(),t.ao(o,"dispose"),e||(o.OC=y)},t.prototype.hitTest=function(t,e){var n,o,r,i,a,s,u,c,f,h,p,d,g,m,y=this,v=y.OC,C=v.options.scrollbarAppearance===l.ScrollbarAppearance.mobile,b=y.Dr(),w=y.getResizeBarBounds();if(v.options.showHorizontalScrollbar&&!C&&t>w.x&&t<b.x+b.width)return{type:"resize",element:L};for(o=-1,r=(n=y.getNavButtonBounds()).startIndex,i=n.x,a=n.endIndex,s=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],u=r;u<a;u++){if(i<t&&t<i+n.width){o=u,B=s[u];break}i+=n.width}if(-1!==o)return{type:U,element:B,index:u};if(i=(c=y.getPreMoreTabBounds()).x,f=0,-1!==y.rw(y.gq)){if(i<=t&&t<i+c.width)return B=s[5],{type:U,element:B,index:5,position:i};f=y.LC}if(h=y.getSheetTabBounds(),p=v.sheets,d=y.WC,g=y.HC,m=0,i=h.x+f,y.gq>-1)for(u=y.gq;u<p.length&&u<d.length;u++)if(p[u].visible()){if(m=d[u],i<t&&t<i+m+g){if(h.moreTabPos>0&&t<h.moreTabPos)return{type:q,element:G,index:u,position:i};if(0===h.moreTabPos)return{type:q,element:G,index:u,position:i}}i+=m+g}if(i>h.moreTabPos&&h.moreTabPos>0&&(i=h.moreTabPos),-1!==y.rD(y.sD())){if(i<t&&t<i+h.secondMoreTabWidth)return B=s[6],{type:U,element:s[6],index:6,position:i}}else if(i<t&&t<i+h.secondMoreTabWidth)return{element:V,position:i};return i+=h.secondMoreTabWidth,v.options.newTabVisible&&i<t&&t<i+y.TC()?{type:q,element:H,position:i,index:-1}:{element:V}},t.prototype.AD=function(e){var n,o,r,a,s,l,u,c=this,f={e:e,r:y};return t.ao(c,"preProcessMouseDown",f),n=f.r,h(n)?(o=i.GC$(c.Ws()).offset(),r=e.pageX-o.left,a=e.pageY-o.top,s=c.OC.getActiveSheet(),c.FD&&c.GD(s,!1),u=(l=c.hitTest(r,a)).element,0===e.button&&(u===L?(c.HD=!0,c.ID=e.pageX,c.tC()):u===B?c.JD(l.index):u===G?(c.KD(l.index,l.position,e),c.LD(e,l)):u===H&&c.MD(l.position),(s=c.OC.getActiveSheet())&&s.mm&&!s.isEditing()&&s.zt()),c.ND=!0,!1):n},t.prototype.BD=function(e){var n,o,r,a,s,l,u,c,f,p,d,g,m,v=this,C=v.OC,w={e:e,r:y};if(t.ao(v,"preProcessMouseMove",w),n=w.r,!h(n))return n;if(o=v.Xs.style,r="default",a="w-resize",v.OD&&!v.PD&&(Math.sqrt(b(v.OD.x-e.pageX,2)+b(v.OD.y-e.pageY,2))>10&&(v.PD=!0)),v.HD)o.cursor=a,s=e.pageX-v.ID,l=v.OC.xs.clientWidth,C.options.tabStripRatio=C.Iv()+s/l,u=v.kw/l,1,C.Iv()<u?(C.options.tabStripRatio=u,v.ID=v.kw):C.Iv()>=1?(C.options.tabStripRatio=1,v.ID=l):v.ID=e.pageX,C.aq();else if(v.PD)v.QD(e.pageX,e.pageY),v.RD(e);else{if(v.lD=-1,v.iD=-1,c=i.GC$(v.Ws()).offset(),f=e.pageX-c.left,p=e.pageY-c.top,g=(d=v.hitTest(f,p)).element,v.OC&&v.OC.options.enableAccessibility&&(m=v.cgc(d),v.OC.dgc(m)),""===g)return o.cursor=r,v.repaint(),!1;g===L?o.cursor=a:(o.cursor=r,g===B?v.lD=d.index:g===G?v.iD=d.index:g===H&&(v.iD=-2)),v.repaint()}return!1},t.prototype.cgc=function(t){var e=X(),n="",o=t.element;return o===L?n=e.ARIA_Resize:o===B?n={first:e.ARIA_First,prevArrow:e.ARIA_PreviousArrow,nextArrow:e.ARIA_NextArrow,last:e.ARIA_Last,prevButton:e.ARIA_PreviousButton,nextButton:e.ARIA_NextButton}[B]||"":o===G?n=e.ARIA_SheetTab+" "+this.OC.getSheet(t.index).name().replace(/([0-9]+)/," $1 "):o===H?n=e.ARIA_NewSheet:o===V&&(n=e.ARIA_Blank),n},t.prototype.CD=function(e){var n,o=this,r={e:e,r:y};return t.ao(o,"preProcessMouseUp",r),n=r.r,h(n)?(o.HD&&(o.HD=!1,o.OC.aq()),o.SD(),o.PD&&(o.PD=!1,o.TD.remove(),o.UD(),o.yD.hide()),o.OD=y,o.VD(),o.uC(),!o.ND||(o.ND=!1,!1)):n},t.prototype.DD=function(e){var n,o,r,i=this,a={e:e,r:y};return t.ao(i,"preProcessMouseOut",a),n=a.r,h(n)?(i.VD(),o=i.lD,i.lD=-1,r=i.iD,i.iD=-1,i.lD===o&&i.iD===r||i.repaint(),!1):n},t.prototype.tC=function(){var t,e=this;e.WD||(i.GC$(m).bind(N,(function(t){e.BD(t)})).bind(E,(function(t){e.CD(t)})),(t=e.OC.getActiveSheet())&&(t.XD=!0),e.WD=!0)},t.prototype.uC=function(){if(this.WD){this.WD=!1,i.GC$(m).unbind(N).unbind(E);var t=this.OC.getActiveSheet();t&&delete t.XD}},t.prototype.JD=function(t,e){var n,o=this;o.VD(),(n=o.sD()).length<=0||(200,0===(t%=4)?o.YD(n):1===t?(e||(o.ZD=g.setTimeout((function(){o.JD(1)}),200)),o.$D(n)):2===t?(e||(o.ZD=g.setTimeout((function(){o.JD(2)}),200)),o._D(n)):3===t&&o.aE(n))},t.prototype.KD=function(t,e,n){var o,r,i,a=this,s=a.OC;a.$C=t,a.ZC=e,s.suspendPaint(),o=s.getActiveSheet(),(r=s.getSheet(t))&&r.isEditing()&&r!==o&&(i=o&&o.Cw&&o.Cw.V4,!r.gv(void 0,void 0,i))||(Q(s,r,t),a.iw(t,n),s.resumePaint(),a.repaint())},t.prototype.BHb=function(t,e,n,o,r,i){var s={oldValue:n,newValue:o,sheetName:r,propertyName:"isSelected",cancel:!1,sheetIndex:i};t.Wq(a.Events.SheetChanging,s),s.cancel||(e.ITa.CHb(o),t&&t.hq&&t.hq.repaint(),delete s.cancel,t.Wq(a.Events.SheetChanged,s))},t.prototype.MD=function(t){var e,n,o,r,i=this,s=i.OC,l=s.getActiveSheet();if((!i.bE||i.bE(l))&&(Q(s,y,y),e=s.sheets.length,n=s.vv(s.wv(e)),s.sheets.forEach((function(t){t.DHb(!1,!0)})),r={sheetName:o=n.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:e},i.BHb(s,n,!1,!0,o,e),s.Wq(a.Events.SheetChanging,r),!r.cancel)){for(s.ow(e,1,n),s.Wq(a.Events.SheetChanged,{sheetName:n.name(),propertyName:"insertSheet",sheetIndex:e}),i.$C=e,i.ZC=t,s.dq(e,1,!1,!0);i.$C>i.gq&&(i.YC()||i.gq<i.jw(-1));)i.hE(i.gq)&&(i.ZC-=i.WC[i.gq]),i.gq++;i.repaint()}},t.prototype.iw=function(t,e){var n,o,r,i,s,l,u,c=this,f=c.OC,h=f.sheets,p=f.getActiveSheet(),d=!1;p&&p.Cw&&p.Cw.V4&&(d=!0),!!e&&(n=a.Ul.sl()?e.metaKey:e.ctrlKey,o=e.shiftKey),t!==f.eq?(n?(i=(r=h[t]).name(),r.DHb()?c.BHb(f,r,!0,!1,i,t):(c.BHb(f,r,!1,!0,i,t),p.DHb()||(i=p.name(),c.BHb(f,p,!1,!0,i,t)))):o?(s=h.slice(C(f.eq,t),v(f.eq,t)+1),h.forEach((function(t){var e=t.name();t.visible()&&(-1!==s.indexOf(t)?t.DHb()||c.BHb(f,t,!1,!0,e,f.getSheetIndex(e)):t.DHb()&&c.BHb(f,t,!0,!1,e,f.getSheetIndex(e)))}))):(l=h.every((function(t){return!t.visible()||t.isSelected()})),h[t].DHb()&&!l||h.forEach((function(t){t.DHb(!1,!0)})),i=(r=h[t]).name(),r.DHb()||c.BHb(f,r,!1,!0,i,t),f.dq(t,1,d,!0)),u=c.jw(c.gq),c.$C>c.gq&&c.ZC+c.WC[c.$C]>c._C()&&-1!==u&&(c.gq=u)):o&&h.forEach((function(e){var n=e.name();f.getSheetIndex(n)!==f.eq&&e.DHb()&&e.visible()&&c.BHb(f,e,!0,!1,n,t)})),c.$C<c.gq&&(c.gq=c.rw(c.gq))},t.prototype.cE=function(t,e){var n,o,r,s,l,u,c,f,h,d=this,g=d.OC,m=d.hitTest(t,e);if(m.element===G){if(n=d.$C,o=g.sheets[n],m.index!==n)return;if(g.Wq(a.Events.SheetTabDoubleClick,{sheet:o,sheetName:o.name(),sheetTabIndex:n}),!g.options.tabEditable)return!1;if((r=a.Vl.Xl())&&r.endEdit&&!r.endEdit())return;a.Vl.Zl(y),s=d.WC[n],l=i.GC$(d.Ws()).offset(),u=g.xv(),c=i.GC$(u).offset(),h=(f=p("input")).style,f.type="text",f.value=o.name(),f.setAttribute("contentEditable","true"),f.setAttribute("autocomplete","off"),h.position="absolute",h.margin="0px",h.padding="0px",h.left=l.left-c.left+d.ZC+d.EC+w,h.top=l.top-c.top+d.aD()+w,h.width=s-d.EC-d.GC+2+w,h.backgroundColor=W,h.borderWidth="0px",h.outline=T,i.GC$(f).appendTo(u),d.FD=f,i.GC$(f).addClass("gc-sheetTabEditor").bind(O,(function(t){return 13===t.keyCode?(d.GD(o,!1),!1):27===t.keyCode?(d.GD(o,!0),!1):void 0})).bind(j,(function(){f.selectionStart=0,f.selectionEnd=f.value.length})).bind(F,(function(){d.GD(o,!1)})),f.focus()}return!1},t.prototype.ED=function(e){var n,o,r,a,s=this,l={e:e,r:y};return t.ao(s,"preProcessMouseDbClick",l),n=l.r,h(n)?(o=i.GC$(s.Ws()).offset(),r=e.pageX-o.left,a=e.pageY-o.top,s.cE(r,a)):n},t.prototype.GD=function(t,e){var n,o,r,s,l=this,u=l.FD;u&&(i.GC$(u).unbind(O).unbind(j).unbind(F),n=u.value,!1===e&&(n!==(o=t.name())&&(!h(n)&&""!==n&&f(n,l.OC.sheets,t)?(r={sheet:t,oldValue:o,newValue:n,cancel:!1},t.Wq(a.Events.SheetNameChanging,r),!1===r.cancel&&(t.wu().execute({cmd:"renameSheet",sheetName:o,name:n}),s={sheet:t,oldValue:o,newValue:n},t.Wq(a.Events.SheetNameChanged,s))):t.Wq(a.Events.InvalidOperation,{sheet:t,sheetName:t.name(),invalidType:5,message:X().Exp_SheetNameInvalid}))),u.parentNode.removeChild(u),delete l.FD)},t.prototype.dE=function(){return this.OC.options.allowSheetReorder},t.prototype.LD=function(t,e){var n=this;n.dE()?(n.vD=e.index,n.TD=n.eE(n.vD),n.OD=new a.Point(t.pageX,t.pageY),n.tC()):n.PD=!1},t.prototype.eE=function(t){var e,n,o=this.OC.sheets;if(!(t>=o.length||t<0))return(e=o[t].name())||(e="sheet"),(n=i.GC$(p("span")).text(e).css({position:"absolute",cursor:"default","border-radius":"5px",opacity:".7"})).addClass("ui-widget-header gc-tab-tip-span btn-primary"),n},t.prototype.VD=function(){var t=this.ZD;t&&(clearTimeout(t),this.ZD=y)},t.prototype.QD=function(t,e){var n,o,r=this.TD;r&&0===i.GC$(".gc-tab-tip-span").length&&(r.appendTo(m.body),r.hide()),n=r.width(),o=r.height(),r.css({left:t-n/2,top:e-o/2}),r.show()},t.prototype.RD=function(t){var e=this,n=i.GC$(e.Ws()),o=n.position(),r=n.offset(),a=t.pageX-r.left,s=t.pageY-r.top,l=e.hitTest(a,s),u=l.element,c=e.Dr(),f=e.VC(),p=e.OC.sheets.length,d=c.x+e._C(),m=e.yD;a>d?e.wD===y&&e.uD<p&&(e.wD=g.setInterval((function(){e._D(e.sD()),e.uD===p?(e.SD(),m.css({left:o.left+e.fE()-4,top:o.top-4}),m.show()):(e.uD++,m.hide())}),100)):a<f?e.wD===y&&e.uD>0&&(e.wD=g.setInterval((function(){e.$D(e.sD()),0===e.uD?(e.SD(),m.css({left:o.left+f-4,top:o.top-4}),m.show()):(e.uD--,m.hide())}),100)):(e.SD(),u!==G&&-1===e.Via().indexOf(u)||(u!==G||h(l.index)?e.uD=e.OC.sheets.length:e.uD=l.index,m.css({left:o.left+l.position-4,top:o.top-4}),m.show()))},t.prototype.fE=function(){var t,e=this,n=e.WC,o=e.sD(),r=e.gE(e.gq,o),i=e.VC()+e.LC;for(t=r;t<o.length;t++)i+=n[o[t]],i+=e.HC;return i},t.prototype.SD=function(){var t=this.wD;t&&(clearInterval(t),this.wD=y)},t.prototype.UD=function(){var t,e,n,o,r=this,i=r.OC,a=r.uD,s=r.vD,l=-1,u=i.getActiveSheet(),c=s,f=a;if(s<a-1&&(f=a-1),-1!==a&&-1!==s&&s!==a&&s!==a-1&&r.yD.isVisible()){if(J(i,t={sheet:u,sheetName:u.name(),oldIndex:c,newIndex:f,cancel:!1}),t.cancel)return;if(n=void 0,o=(e=i.sheets)[s],s>a){for(n=s;n>a;n--)e[n]=e[n-1];e[a]=o,l=a}else if(s<a-1){for(n=s;n<a-1;n++)e[n]=e[n+1];e[a-1]=o,l=a-1}i.eq=l,r.fq(),$(i,u,c,f)}},t.prototype.sD=function(){var t,e=[];for(t=0;t<this.OC.sheets.length;t++)this.hE(t)&&e.push(t);return e},t.prototype.YD=function(t){t.length>0&&this.gq!==t[0]&&this.OC.startSheetIndex(t[0])},t.prototype.$D=function(t){var e,n;t.length>0&&((e=this).gq>t[0]&&(-1!==(n=e.rw(e.gq))&&e.OC.startSheetIndex(n)))},t.prototype._D=function(t){var e;t.length>0&&((e=this).gq<t[t.length-1]&&(-1!==e.rD(t)&&e.OC.startSheetIndex(e.jw(e.gq))))},t.prototype.aE=function(t){if(t.length>0&&this.gq<t[t.length-1]){var e=this.rD(t);-1!==e&&this.OC.startSheetIndex(e)}},t.prototype.rD=function(t){var e,n,o,r,i,a,s,l,u;if(t.length>0)for(n=(e=this)._C(),o=0,r=e.WC,i=void 0,void 0,a=e.cD(),-1===(s=e.gE(e.gq,t))&&(s=0),i=t.length-1;i>=s;i--)if(o+=r[t[i]],i!==t.length-1&&(o+=e.HC),l=a+o,0!==i&&(l+=e.LC),l>n)return void 0,u=i+1<t.length?t[i+1]:t[t.length-1],e.gq<u?u:-1;return-1},t.prototype.rw=function(t){var e;for(e=t-1;e>=0;e--)if(this.hE(e))return e;return-1},t.prototype.jw=function(t){var e,n=this.OC.sheets.length;for(e=t+1;e<n;e++)if(this.hE(e))return e;return-1},t.prototype.gE=function(t,e){var n;for(n=0;n<=e.length-1;n++)if(t===e[n])return n;return-1},t.prototype.hE=function(t){var e=this.OC.sheets[t];return e&&e.visible()},t.prototype.fw=function(){this.xD++},t.prototype.gw=function(){var t=this;t.xD--,t.xD<=0&&(t.xD=0,t.repaint())},t.prototype.repaint=function(t){var e=this.Ws();e&&e.getContext&&this.jp(e.getContext(_),t)},t.prototype.jp=function(t,e){var n,o,r,i,s,l,u,c,f,h,d,g,m,b=this;if(!(b.xD>0)){if(n=b.Dr(),o=b.Xs,e){if(e.x>=n.x+n.width)return;if(e.y>=n.y+n.height)return;if(e.x+e.width>n.width&&(e.width=n.width-e.x,e.width<=0))return;if(e.y+e.height>n.height&&(e.height=n.height-e.y,e.height<=0))return;if(e.width<=0||e.height<=0)return}if((i=b.buffer)&&(!i||i.width===o.width&&i.height===o.height)&&(i||i.width===n.width&&i.height===n.height)||(i&&a.En.Rn(b.OC,i),b.buffer=i=p(P),a.En.Kn(i,b.OC),a.En.Pn(i,n.width,n.height)),!(n.width<=0||n.height<=0||e&&(e.width<=0||e.height<=0))){(r=b.buffer.getContext(_)).clearRect(0,0,n.width,n.height),a.Bn.Dn(r,-n.x,-n.y),b.iE(r,e),a.Bn.Dn(r,n.x,n.y),u=s=n.x>=0?0:-n.x,c=l=n.y>=0?0:-n.y,e&&(u=n.x+e.x,c=n.y+e.y,n=new a.Rect(u,c,e.width,e.height)),s=n.x>=0?n.x:0,l=n.y>=0?n.y:0,d=y,g=a.En.Ln(o),m=a.En.Mn(o),o&&1!==g&&(u*=g,c*=m,n.x*=g,n.y*=m,n.width*=g,n.height*=m);try{o?e?(f=v(n.width-u,0),h=v(n.height-c,0)):(f=C(n.width-u,v(o.width-n.x,3)),h=C(n.height-c,v(o.height-n.y,3))):(u=e.x,c=e.y,f=e.width,h=e.height),o?(a.Bn.Cn(t,1,1),t.clearRect(s,l,f,h),t.drawImage(b.buffer,u,c,f,h,s,l,f,h),a.Bn.Cn(t,g,m)):d=(r=b.buffer.getContext(_)).getImageData(u,c,f,h)}catch(t){return}!o&&d&&n.width>0&&n.height>0&&t.putImageData(d,s,l)}}},t.prototype.iE=function(t,e){var n,o,r,i,a,u,c,f,h,p=this,g=p.OC,m=g.options.scrollbarAppearance===l.ScrollbarAppearance.mobile;if(t&&g){for(n=p.Dr(),t.save(),d(t,p._font),e?t.rect(e.x,e.y,e.width,e.height):t.rect(n.x,n.y,n.width,n.height),t.clip(),t.beginPath(),i=r=p.VC(),t.save(),t.font=s.To.Ro(t.font,"bold"),p.WC=[],u=g.sheets,a=0;a<u.length;a++)o=Math.round(t.measureText(u[a].name()).width)+p.GC+p.EC,p.WC.push(o);for(t.restore(),c=[],(f=p.gq)>0&&p.rw(f)>=0&&(i+=p.LC),f<0&&(f=0),a=f;a<u.length&&(h=u[a].visible(),o=p.WC[a],!(i>n.x+n.width));a++)c.push({i:a,x:i,w:o,t:u[a].name(),visible:h}),h&&(i+=o+p.HC);p.dD(t,n),p.fD(t,n,i,r),p.jE(t,n,c,f,r),p.OC&&p.OC.options.tabNavigationVisible&&p.kD(t,n,r),m||p.nD(t,n),t.beginPath(),t.restore()}},t.prototype.dD=function(t,e){},t.prototype.fD=function(t,e,n,o){},t.prototype.jE=function(t,e,n,o,r){var i,a,s,l,u,c,f,h=this,p=h.OC,d=p.sheets,g=h.iD;if(h.$C=p.getActiveSheetIndex(),i=h.$C,d.length>0){for(t.save(),t.beginPath(),a=e.x+h._C(),t.rect(r,0,a-r,e.height),t.clip(),s=n.length-1;s>=0;s--)(l=n[s]).i!==i&&l.visible&&(u=p.getSheetFromName(l.t).DHb(),h.oD(t,l.x,0,l.w,e.height,5,!1,l.i===g,l.t,u));c=n[i-o],i>=o&&i<d.length&&c&&c.visible&&(f=p.getActiveSheet().isSelected(),h.oD(t,c.x,0,c.w,e.height,5,!0,!1,c.t,f)),t.restore(),t.save(),t.beginPath(),o>0&&h.rw(o)>=0&&h.jD(t,e,o,r),t.restore()}},t.prototype.jD=function(t,e,n,o){},t.prototype.kD=function(t,e,n){},t.prototype.nD=function(t,e){},t.prototype.mD=function(t,e,n,o,r,i,a,s,l,u){},t.prototype.oD=function(t,e,n,o,r,i,a,s,l,u){},t.prototype.Ws=function(){return this.Xs},t.prototype.kE=function(t,e){var n,o,r,i,s=t.createLinearGradient(e.x,e.y,e.width,e.height),u=a.Im.Km(l.VisualState.normal,"gc-tabStripBackground"),f=u&&u.backgroundImage,h=u&&u.backgroundColor;if(f&&-1!==f.indexOf("linear-gradient"))for(o=0,r=(n=c(f)).length;o<r;o++)i=n[o],s.addColorStop(i.point,i.color);else h&&(s.addColorStop(0,"#DDDDDD"),s.addColorStop(1,h));return s},t.prototype.pD=function(t,e,n,o){var r,i,s,l,u,f,h,p,d,g=this,m=g.Dr(),y=t.createLinearGradient(m.x+.7*m.height,m.y+0,.7*m.height,m.height),v=g.OC.getSheetFromName(n);if(""===n&&g.gq>0&&(v=g.OC.getSheet(g.gq-1)),r=v&&v.options.sheetTabColor)"rgba(0, 0, 0, 0)",t.fillStyle="rgba(0, 0, 0, 0)",i=t.fillStyle,t.fillStyle=a.Rm.Om(v,r),(s=t.fillStyle)!==i&&(e?(y.addColorStop(0,W),y.addColorStop(.45,"#F1F6FD"),y.addColorStop(.9,s),y.addColorStop(1,W)):y=s);else if(o)if(l=o.backgroundImage,u=o.backgroundColor,l&&-1!==l.indexOf("linear-gradient"))for(h=0,p=(f=c(l)).length;h<p;h++)d=f[h],y.addColorStop(d.point,d.color);else u&&y.addColorStop(0,u);return y},t.prototype.qD=function(t,e){var n=z;return t&&(n=t.color),e&&u.dc(u.ec(e))<127.5&&(n=W),n},t}(),e.DC=Z,a.Zn(Z)},"./dist/core/workbook/workbook-json.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(t,e){return t.hasOwnProperty(e)}function C(t){var e,n,o,r;if(!t||"string"!=typeof t)return 1;if((n=(e=t.split(".")).length)>3)return 3;if(o=y(e[0]),n<=2)return isNaN(o)?1:o;if(r=y(e[1]),o>=10)return o;if(o>=3){if(r>=20143)return 3;if(r>=20142)return 2}return 1}function b(t,e){var n,o,r,i,a=e&&e.frozenColumnsAsRowHeaders,s=e&&e.frozenRowsAsColumnHeaders,l=0,u=t.sheets;if(s||a)for(o in u)"string"==typeof o&&(r=u[o],i=m(r.index)?r.index:r.mi,n=this.sheets[m(i)?i:l],s&&m(r.frozenRowCount)&&(n.$Bb=!0,n.deleteRows(0,r.frozenRowCount)),a&&m(r.frozenColCount)&&n.deleteColumns(0,r.frozenColCount),l++)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/workbook/workbook.js"),r=n("./dist/core/worksheet/style.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/tasks.js"),s=n("Common"),l=n("./dist/core/util/common.js"),u=n("@grapecity/js-calc"),c=!!u,f=r.Style.kxb,h=s.Commands.UndoManager,p=s.Common.CultureManager,d=s.Common.j.C4,g=i.GC$.each,m=l.Ul.Ol,y=parseFloat,o.Workbook.prototype.toJSON=function(t){var e,n,r,a,s,f,h,p,m,y,C,b,w,T,x,S,A,I,R=this,k={version:l.productInfo.productVersion},M=t&&t.rowHeadersAsFrozenColumns,N=t&&t.columnHeadersAsFrozenRows,E=M||N;if(E&&(t.Yec=!0),R.EHb&&(k.docProps=d(R.EHb)),c&&((e=u.Functions.setLanguagepackage)&&(n=e(),e("en"))),(r=R.getSheetCount())!==o.Workbook.nv&&(k.sheetCount=r),E)for((a=new o.Workbook).fromJSON(R.toJSON({includeBindingSource:!0})),R=a,s=0;s<r;s++)h=(f=R.getSheet(s)).getRowCount(1),p=f.getColumnCount(2),y=N&&h>0,(m=M&&p>0)&&f.addColumns(0,p),y&&f.addRows(0,h,y),m&&f.Zec(p,y?h:0),y&&f.$ec(h,m?p:0);for(R.mv=!0,R.suspendPaint(),R.suspendEvent(),c&&((C=R.Wu).calcOnDemand&&(C.calcOnDemand=!1,R.FHb(),C.suspend(!0),C.resume(!0),C.calcOnDemand=!0),C.suspend(!0)),(b=R.startSheetIndex())&&(k.startSheetIndex=b),g(R.options,(function(t,e){"_ps"!==t&&o.Workbook.Qp[t]!==e&&(k[t]=e)})),(w=R.getActiveSheetIndex())!==o.Workbook.ov&&(k.activeSheetIndex=w),T={},x=0;x<r;x++)T[(f=R.getSheet(x)).name()]=f.toJSON(t),T[f.name()].index=x;if(i.GC$.isEmptyObject(T)||(k.sheets=T),S=[],A=R.Lq){for(I in A)v(A,I)&&S.push(A[I]);S.length>0&&(k.namedStyles=S)}return o.Workbook._n&&g(o.Workbook._n,(function(e,n){n.toJson&&n.toJson.call(R,k,t)})),c&&e&&e(n),R.mv=!1,c&&R.Wu.resume(!1),R.resumeEvent(),R.resumePaint(),E&&delete t.Yec,k},o.Workbook.prototype.fromJSON=function(t,e){var n,i,a,s,u,y,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W;if(t){if(e&&e.incrementalLoading)return!0===e.incrementalLoading&&(e.incrementalLoading={}),this.egc(t,e);n=this,i=C(t.version),s={noSchema:a=i<3,version:i},u=l.Vl.Xl(),n.mv=!0,n.suspendPaint(),n.suspendEvent(),y=p.culture(),p.culture("");try{for(A in n.T3(),n.pv=new h(n,-1,n.options.allowUndo),c&&n.qv(!0),c&&n.Wu.suspendAdjust(),n.lv=-1,n.clearSheets(),w=n.options,T=t.canUserEditFormula,m(T)&&(w.allowUserEditFormula=T),x=t.allowDragDrop,m(x)&&(w.allowUserDragDrop=x),S=t.allowDragFill,m(S)&&(w.allowUserDragFill=S),w)v(w,A)&&(I=t[A],m(I)&&(w[A]=I));if(n.EHb=d(t.docProps),o.Workbook._n&&g(o.Workbook._n,(function(o,r){var i=r.preFromJson;i&&i.call(n,t,a,e)})),R=t.sheetCount,m(R)||(R=o.Workbook.nv),n.sw(R,0),n.Lq={},k=t.namedStyles)for(M=0,N=k;M<N.length;M++)E=N[M],D=new r.Style,f(E,n),D.fromJSON(E,a,n),n.Kq(D);if(O=0,void 0,j=t.sheets,F=void 0,P=void 0,_=!1,L=!0,j)for(B in j)"string"==typeof B&&(G=j[B],H=m(G.index)?G.index:G.mi,n.sheets[m(H)?H:O].fromJSON(G,!1,s,e,!0),O++,P=G.allowUndo,_?L=L&&P===F:(F=P,_=!0));m(F)&&L&&(w.allowUndo=F),V=t.activeSheetIndex,m(V)||(V=o.Workbook.ov),n.dq(V,0),(z=n.sheets[V])&&z.DHb(!0,!1),W=t.startSheetIndex,m(W)&&n.startSheetIndex(W),o.Workbook._n&&g(o.Workbook._n,(function(o,r){var i=r.fromJson;i&&i.call(n,t,a,e)})),c&&n.Wu.resumeAdjust(),b.call(n,t,e)}finally{c&&n.Wu.resumeAdjust(),p.culture(y),n.mv=!1,z=n.getActiveSheet(),u&&z&&z.zt(),n.resumeEvent(),n.fq(),n.resumePaint(),z&&n.Wq(l.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:z})}}},o.Workbook.prototype.egc=function(t,e){var n,i,s,u,y,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q=this;q.fgc&&q.fgc.terminate(),q.fgc=new a.Tasks((function(){var t,e,n,o=q.getActiveSheet();if(!o.loaded)for(t=this.tasks.length-1;t>=0;t--)if((e=this.tasks[t].args[0])&&e.ITa&&e.name&&e.name()===o.name())return n=this.tasks[t],this.tasks.splice(t,1),n;return this.tasks.pop()}),(function(){var t=q.getActiveSheet();return t&&(q.ku.Gw||t.isEditing()||t.mm.OG||t.mm.xG||t.mm.eG)})),n=C(t.version),s={noSchema:i=n<3,version:n},u=l.Vl.Xl(),q.mv=!0,q.suspendPaint(),q.suspendEvent(),y=p.culture(),p.culture("");try{for(A in q.T3(),q.pv=new h(q,-1,q.options.allowUndo),c&&q.qv(!0),c&&q.Wu.suspendAdjust(),q.lv=-1,q.clearSheets(),w=q.options,T=t.canUserEditFormula,m(T)&&(w.allowUserEditFormula=T),x=t.allowDragDrop,m(x)&&(w.allowUserDragDrop=x),S=t.allowDragFill,m(S)&&(w.allowUserDragFill=S),w)v(w,A)&&(I=t[A],m(I)&&(w[A]=I));if(q.EHb=d(t.docProps),R=t.sheetCount,m(R)||(R=o.Workbook.nv),q.sw(R,0),q.Lq={},k=t.namedStyles)for(M=0;M<k.length;M++)N=k[M],E=new r.Style,f(N,q),E.fromJSON(N,i,q),q.Kq(E);if(D=0,j=t.sheets,F=void 0,P=void 0,_=!1,L=!0,j)for(G in B={total:0,valuesLoad:0,formulaLoad:0},D=0,e.incrementLoadTask=q.fgc,e.incrementalLoading.loadStatus=B,j)"string"==typeof G&&(H=j[G],V=m(H.index)?H.index:H.mi,(O=q.sheets[m(V)?V:D]).loading=!0,O.cq(H.name+"",!0),O.DHb(H.isSelected),O.setRowCount(H.rowCount),O.setColumnCount(H.columnCount),B.total+=O.getRowCount(),q.fgc.addTask((function(t,n){t.egc(n,!1,s,e,!0)}),[O,H]),D++,P=H.allowUndo,_?L=L&&P===F:(F=P,_=!0));m(F)&&L&&(w.allowUndo=F),z=t.activeSheetIndex,m(z)||(z=o.Workbook.ov),q.dq(z,0),(W=q.sheets[z])&&W.DHb(!0,!1),U=t.startSheetIndex,m(U)&&q.startSheetIndex(U),q.fgc.endingCallback=function(){o.Workbook._n&&g(o.Workbook._n,(function(n,o){o.egc?q.fgc.addTask((function(t,e,n,r){o.egc.call(t,e,n,r)}),[q,t,i,e]):o.fromJson&&o.fromJson.call(q,t,i,e)})),q.fgc.endingCallback=function(){var n,o;for(c&&q.Wu.resumeAdjust(),b.call(q,t,e),n=0;n<q.sheets.length;n++)delete q.sheets[n].loading;(O=q.getActiveSheet())&&q.Wq(l.Events.FormulatextboxActiveSheetChanged,{oldSheet:void 0,newSheet:O}),e&&e.incrementalLoading&&e.incrementalLoading.loading&&e.incrementalLoading.loading(1),(o=e&&e.incrementalLoading&&e.incrementalLoading.loaded)&&o()},q.fgc.start()},q.fgc.start()}finally{p.culture(y),q.mv=!1,W=q.getActiveSheet(),u&&W&&W.zt(),q.resumeEvent(),q.fq(),q.resumePaint()}}},"./dist/core/workbook/workbook.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt;function Ct(t){return t.getActiveSheet()}function bt(t){return s.En.npb()%1!=0||t.zoom()%1!=0}function wt(t,e){return N.setTimeout((function(){t.invalidateLayout(),t.repaint(),e.GHb=D}),200)}function Tt(t,e,n){var o,r,i=s.Im.Lm("gc-vertical-scrollbar"+nt),l=M(i.zIndex)>2007?1:0,u=e-n;u%2==0?r=(o=u/2)-l:r=o=(u-l)/2,a.GC$(t).css({"box-sizing":et,border:K,"border-color":K,"border-left-style":"solid","border-left-width":l+Q,"border-left-color":i.borderLeftColor,"background-color":i.backgroundColor,width:n,padding:"0px "+o+"px 0px "+r+Q,margin:0})}function xt(t,e,n){var o,r,i=s.Im.Lm("gc-horizontal-scrollbar"+nt),l=M(i.zIndex)>2007?1:0,u=e-n;u%2==0?r=(o=u/2)-l:r=o=(u-l)/2,a.GC$(t).css({"box-sizing":et,border:K,"border-color":K,"border-top-style":"solid","border-top-width":l+Q,"border-top-color":i.borderTopColor,"background-color":i.backgroundColor,height:n,padding:r+"px 0px "+o+"px 0px",margin:0})}function St(t,e,n){var o=s.Im.Lm("gc-footer-corner"+nt);a.GC$(t).css({border:K,padding:0,margin:0,width:e+Q,height:n+Q,"background-color":o.backgroundColor})}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/workbook/workbookpanelex.js"),r=n("./dist/core/core.ns.js"),i=n("Common"),a=n("./dist/core/util/domUtil.js"),s=n("./dist/core/util/common.js"),l=n("./dist/core/util/imageLoader.js"),u=n("./dist/core/worksheet/worksheet-actions.js"),c=n("./dist/core/workbook/sheettab.js"),f=n("./dist/core/workbook/sheettab2007.js"),h=n("./dist/core/worksheet/stylehelper.js"),p=n("./dist/core/worksheet/clipboardhelper.js"),d=n("./dist/core/worksheet/worksheet.js"),g=!!n("@grapecity/js-calc"),m=n("./dist/core/core.enum.js"),y=i.Common.u,v=i.Commands.UndoManager,C=i.Commands.CommandManager,b=a.GC$.each,w=a.GC$.extend,T=g,x=i.Common.j.Fa,S=s.Ul.Nl,A=s.Ul.Pl,I=s.Ul.Ql,R=s.Ul.hZa,k=i.Common.CultureManager,M=parseInt,parseFloat,N=window,E=document,D=null,O=Math.round,j=Math.min,F=Math.abs,P="number",_="mousedown",L="mousemove",B="mouseup",G="mouseenter",H="mouseleave",V="scroll",z="resize",W="focus",U=".gcSpread",q=".gcSpreadInternal",Y=".gcScrollbar",X="div",Z="table",Q="px",J="gc-scroll-handle",$="gc-scroll-bar",K="none",tt="absolute",et="content-box",nt=" ui-widget-header ui-state-default btn btn-default",ot="gc-scroll-mobile-container",rt="gc-scroll-mobile-container-horizontal",it="gc-scroll-mobile-container-vertical",at="gc-scroll-mobile-spread-hovering",st="gc-scroll-mobile-state-hide",lt="gc-scroll-mobile-state-hover",ut=N.jQuery,ct="cultureChanged",ft="workbook",ht="gcUIElement",pt="gc-no-user-select",dt=new i.Common.ResourceManager(r.SR),gt=dt.getResource.bind(dt),mt=function(){function t(t){this.yw=t}return t.Lv=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,C,b,w,T,S,A,I,R=t.data,k=R.ku;if(k.HHb&&(N.clearTimeout(k.HHb),k.HHb=D),(n=Ct(R))&&e){if(o=n.zoom(),r=e.newValue,i=e.oldValue,a=e.scrollEventType,s=R.options.scrollByPixel,l=R.options.scrollPixel,u=void 0,c=void 0,i=e.oldValue=x(i)?0:s?O(i):M(i+"",10),n.oq=!1,f=n.$t(),h=n.ps(),p=R.options.scrollbarShowMax,d=0,s){for(g=(r=O(r))-i,a!==m.Nxb.thumbTrack&&((r=i+(g*=l*o))<0&&(r=0)),p||(n.oq=!0,a===m.Nxb.smallIncrement&&r===i?r+=l*o:e.ignoreUpdatePosition=!0),C=(v=y=n.frozenColumnCount())+(n.getRowCount()-n.frozenTrailingRowCount()-y)-1,b=0,w=0,T=v;T<=C;T++)if((b+=w=n.Tl(T))>=r){d=b-r-w,u=T;break}x(u)&&(u=C,d=-n.Tl(C),r=b)}else u=M(r+"",10),u=n.du(u),a===m.Nxb.largeDecrement||a===m.Nxb.smallDecrement?(a===m.Nxb.largeDecrement&&(u=n.zw()),-1!==(c=n.Ot(u,!0))&&c!==u&&(u=c),p||(n.oq=!0,e.ignoreUpdatePosition=!0)):a!==m.Nxb.largeIncrement&&a!==m.Nxb.smallIncrement||(a===m.Nxb.largeIncrement&&((u=n.Aw())===n.qq&&u++),p||(n.oq=!0,a===m.Nxb.smallIncrement&&r===i&&u++),-1!==(c=n.Ot(u))&&c!==u&&(u=c)),u<f&&(u=f),u>h&&(u=h);S=s?O(r):n.Qt(u),e.newValue!==S&&(e.newValue=S),A=S,0!==(I=n.Tl(u))&&(A+=F(d)/I),e.newValueWithOffset=s?S:A,(i!==S||s)&&R.ku.Bw(u,d,!0)}},t.Mv=function(t){var e,n,o,r=t.data,i=Ct(r),a=r.Pt;i&&a&&(a.QB===m.ScrollType.pixels||(e=i.du(a.value()),n=i.$t(),o=i.ps(),e<n?a.value(i.Qt(n)):e>o&&a.value(i.Qt(o))),r.xw(),r.options.scrollbarShowMax||(r.ku.scrolling?i.oq=!0:r.Ut()))},t.Nv=function(t){var e,n,o,r,i,s=t.data;s&&((e=Ct(s))&&((n=s.Pt.xR)&&n.mR&&(e.CH=!0),e.zt(),1!==(o=s.options.showScrollTip)&&3!==o||(i=(r=a.GC$(t.srcElement||t.target)).parent(),(r&&(r.hasClass(J)||r.hasClass($))||i&&(i.hasClass(J)||i.hasClass($)))&&s.ku.Dw(!1,t))))},t.Dv=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,C,b,w,T,S,A,I,R=t.data,k=R.ku;if(k.HHb&&(N.clearTimeout(k.HHb),k.HHb=D),(n=Ct(R))&&e){if(o=n.zoom(),r=e.newValue,i=e.oldValue,a=e.scrollEventType,s=R.options.scrollByPixel,l=R.options.scrollPixel,u=void 0,c=void 0,i=e.oldValue=x(i)?0:s?O(i):M(i+"",10),n.jq=!1,f=n._t(),h=n.ns(),p=R.options.scrollbarShowMax,d=0,s){for(g=(r=O(r))-i,a!==m.Nxb.thumbTrack&&((r=i+(g*=l*o))<0&&(r=0)),p||(n.jq=!0,a===m.Nxb.smallIncrement&&r===i?r+=l*o:e.ignoreUpdatePosition=!0),C=(v=y=n.frozenRowCount())+(n.getRowCount()-n.frozenTrailingRowCount()-y)-1,b=0,w=0,T=v;T<=C;T++)if((b+=w=n.Sl(T))>=r){d=b-r-w,u=T;break}x(u)&&(u=C,d=-n.Sl(C),r=b)}else u=M(r+"",10),u=n.cu(u),a===m.Nxb.largeDecrement||a===m.Nxb.smallDecrement?(a===m.Nxb.largeDecrement&&(u=n.Ew()),-1!==(c=n.Rt(u,!0))&&c!==u&&(u=c),p||(n.jq=!0,e.ignoreUpdatePosition=!0)):a!==m.Nxb.largeIncrement&&a!==m.Nxb.smallIncrement||(a===m.Nxb.largeIncrement&&((u=n.Fw())===n.lq&&u++),p||(n.jq=!0,a===m.Nxb.smallIncrement&&r===i&&u++),-1!==(c=n.Rt(u))&&c!==u&&(u=c)),u<f&&(u=f),u>h&&(u=h);S=s?O(r):n.Tt(u),e.newValue!==S&&(e.newValue=S),A=S,0!==(I=n.Sl(u))&&(A+=F(d)/I),e.newValueWithOffset=s?S:A,(i!==S||s)&&R.ku.Bw(u,d)}},t.Ev=function(t){var e,n,o,r=t.data,i=Ct(r),a=r.St;i&&a&&(a.QB===m.ScrollType.pixels||(e=i.cu(a.value()),n=i._t(),o=i.ns(),e<n?a.value(i.Tt(n)):e>o&&a.value(i.Tt(o))),r.xw(),r.options.scrollbarShowMax||(r.ku.scrolling?i.jq=!0:r.Xt()))},t.Fv=function(t){var e,n,o,r,i,s=t.data;s&&((e=Ct(s))&&((n=s.St.xR)&&n.mR&&(e.CH=!0),e.zt(),2!==(o=s.options.showScrollTip)&&3!==o||(r=a.GC$(t.srcElement||t.target))&&(i=r.parent(),(r.hasClass(J)||i&&i.hasClass(J)||r.hasClass($)||i&&i.hasClass($))&&s.ku.Dw(!0,t))))},t.Gv=function(t){var e=t.data;e&&e.xw()},t.ggc=function(t){var e,n,o,r=gt(),i=t.data,s=t.scrollbar;i.options.enableAccessibility&&(e=a.GC$(s.Bv()).offset(),n=s.hitTest(t.x-e.left,t.y-e.top),o={thumbButton:r.ARIA_Scrollbar_Thumb_Button,trackButton:r.ARIA_Scrollbar_TRACK_Button,leftButton:r.ARIA_Scrollbar_Left_Button,rightButton:r.ARIA_Scrollbar_Right_Button,upButton:r.ARIA_Scrollbar_Top_Button,downButton:r.ARIA_Scrollbar_Bottom_Button}[n.element],i.dgc(o))},t.prototype.no=function(){this.yw=D},t.prototype.Bw=function(t,e,n){var o=this,r=Ct(o.yw);r&&(o.Gw=!0,o.Hw=n?r.lq:t,o.bCb=n?r.cCb:e,o.Iw=n?t:r.qq,o.dCb=n?e:r.eCb,N.setTimeout((function(){o.Kw()}),0))},t.prototype.Kw=function(){var t=this;Ct(t.yw)&&t.Gw&&(t.Gw=!1,t.Lw())},t.prototype.Lw=function(){var t,e,n,o,r,i,a,s=this;s.Mw||(s.Mw=!0,(e=Ct(t=s.yw))&&(n=t.options.showScrollTip,o=s.Hw,r=s.bCb,i=s.Iw,a=s.dCb,o!==e.lq||r!==e.cCb?(s.ju(o,r),2!==n&&3!==n||t.ww(s.Nw(!0))):i===e.qq&&a===e.eCb||(s.lu(i,a),1!==n&&3!==n||t.ww(s.Nw(!1)))),s.Mw=!1)},t.prototype.ju=function(t,e,n){var o,r,i,a,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,E=this;if(E.GHb&&(N.clearTimeout(E.GHb),E.GHb=D),o=Ct(E.yw)){if(r=o.lq,i=o.cCb,!n&&t===r&&e===i)return;if(o.lq=t,o.cCb=e,o.Xq>0)return void o.Wq(s.Events.TopRowChanged,{sheet:o,sheetName:o.name(),oldTopRow:r,newTopRow:t});if(a=!1,c=(u=(l=o.options).sheetAreaOffset.top)+2,f=o.Zs,p=(h=o.am()).qt,d=h.jr,g=void 0,m=void 0,y=h.width+l.sheetAreaOffset.left,v=void 0,b=(C=o.yl).bm(),o.tables&&0===o.frozenRowCount()&&((w=o.tables.KHb())&&(w.x=w.x-2,w.width=w.width+4,w.y=u,w.height=p,C.AI(b,w))),t>r||t===r&&F(e)>F(i)){if(T=void 0,x=void 0,(S=o.Gr(1))&&S.length>0&&(T=S.findRow(t)),T){for(x=S[A=S.length-1];x&&x.y+x.height>p+d;)x=S[A-=1];x&&x.row>t&&(a=!0,g=f?f.x:h.x,m=T.y+F(e),v=x.y+x.height-m-c,C.Ow(g,m,y,v,g,p),l.colHeaderVisible||(o.invalidateLayout(),C._l(b,new s.Rect(g,0,y,u))),o.invalidateLayout(),C._l(b,new s.Rect(g,p+v,y,d-v)),C.Pw(b,new s.Rect(g,p-2,y,d+2)))}}else{for(I=0,R=t;R<r&&I<d;R++)I+=o.Sl(R);(I+=F(i)-F(e))<d&&(a=!0,g=f?f.x:h.x,m=p,v=d-I,o.frozenTrailingRowCount()>0&&(v-=1),C.Ow(g,m,y,v,g,m+I),o.invalidateLayout(),k=o.rowOutlines&&!o.rowOutlines.iT()?o.rowOutlines.s0a()+u+1:0,C._l(b,new s.Rect(g,m-u,y,I+u+k+5)),C.Pw(b,new s.Rect(g,p-2,y,d+2)))}a||(o.invalidateLayout(),o.repaint()),o.Wq(s.Events.TopRowChanged,{sheet:o,sheetName:o.name(),oldTopRow:r,newTopRow:t}),(M=o.mm)&&M.Qw(),a&&bt(o)&&(E.GHb=wt(o,E))}},t.prototype.lu=function(t,e,n){var o,r,i,a,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M=this;if(M.GHb&&(N.clearTimeout(M.GHb),M.GHb=D),o=Ct(M.yw)){if(r=o.qq,i=o.eCb,!n&&t===r&&e===i)return;if(o.qq=t,o.eCb=e,o.Xq>0)return void o.Wq(s.Events.LeftColumnChanged,{sheet:o,sheetName:o.name(),oldLeftCol:r,newLeftCol:t});if(a=!1,c=(u=(l=o.options).sheetAreaOffset.left)+2,f=o.Zs,p=(h=o.am()).pt,d=h.er,g=void 0,m=void 0,y=void 0,v=h.height+l.sheetAreaOffset.top,b=(C=o.yl).bm(),t>r||t===r&&F(e)>F(i)){if(w=void 0,T=void 0,(x=o.Hr(1))&&x.length>0&&(w=x.findCol(t)),w){for(T=x[S=x.length-1];T&&T.x+T.width>p+d;)T=x[S-=1];T&&T.col>t&&(a=!0,g=w.x+F(e),m=f?f.y:h.y,y=T.x+T.width-g-c,C.Ow(g,m,y,v,p,m),l.rowHeaderVisible||(o.invalidateLayout(),C._l(b,new s.Rect(0,m,u,v))),o.invalidateLayout(),C._l(b,new s.Rect(p+y,m,d-y,v)),C.Pw(b,new s.Rect(p-2,m,d+2,v)))}}else{for(A=0,I=t;I<r&&A<d;I++)A+=o.Tl(I);(A+=F(i)-F(e))<d&&(a=!0,g=p,m=f?f.y:h.y,y=d-A,o.frozenTrailingColumnCount()>0&&(y-=1),C.Ow(g,m,y,v,g+A,m),o.invalidateLayout(),R=o.columnOutlines&&!o.columnOutlines.iT()?o.columnOutlines.s0a()+u+1:0,C._l(b,new s.Rect(g-u,m,A+u+R+5,v)),C.Pw(b,new s.Rect(p-2,m,d+2,v)))}a||(o.invalidateLayout(),o.repaint()),o.Wq(s.Events.LeftColumnChanged,{sheet:o,sheetName:o.name(),oldLeftCol:r,newLeftCol:t}),(k=o.mm)&&k.Qw(),a&&bt(o)&&(M.GHb=wt(o,M))}},t.prototype.Rw=function(t,e,n){var o,r,i,a,l,u,c,f,h,p,d,g,y,v,C,b,w,T,x,S,A=this,I=A.yw,R=Ct(I),k=!1,M=I.St,N=I.Pt,E=I.options.scrollbarShowMax,D=I.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;if(R){if(o=R.name(),t.ctrlKey){if(!I.options.allowUserZoom)return!0;if(i=function(t,e){return void 0===e&&(e=12),+parseFloat(t.toPrecision(e))}((r=R.zoom())-.05*e),R.isEditing()&&!R.endEdit())return;if(a={sheet:R,sheetName:R.name(),oldZoomFactor:r,newZoomFactor:i,cancel:!1},R.Wq(s.Events.ViewZooming,a),a&&!0===a.cancel)return!1;l={cmd:"zoom",sheetName:o,oldZoomFactor:r,zoomFactor:a.newZoomFactor},R.wu().execute(l),r!==(i=R.zoom())&&(delete a.cancel,R.Wq(s.Events.ViewZoomed,a),R.Wq(s.Events.UserZooming,a))}else n=n||0,u=R.lq,c=R.cCb,h=(f=A.ms(R,e)).cj,p=f.UP,u!==h||c!==p?(D&&(M.Jwa(m.ScrollbarState.show),A.Rdc(!0)),A.ju(h,p),R.os(),E||R.es()):k=!0,d=R.qq,g=R.eCb,v=(y=A.Sw(R,n)).dj,C=y.UP,d===v&&g===C||(D&&(N.Jwa(m.ScrollbarState.show),A.Rdc(!1)),A.lu(v,C),R.qs(),E||R.ds());b=R.Vs(),w=R.hitTest(t.pageX-b.left,t.pageY-b.top),(x=(T=R.yt)&&T.cellTypeHitInfo)&&(x.cellRect=R.getCellRect(T.row,T.col)),(S=R.mm).Tw(w),S.Uw(w)}return k&&0===n},t.prototype.aCb=function(t,e){var n,o,r,i,a,s,l,u,c=t.lq,f=t.cCb,h=t.parent,p=t.zoom(),d=O(e*h.options.scrollPixel*p),g=0,m=t.am().qt,y=t.jt(1).findRow(c);if(y)if(d<0){for(n=t.Rt(-1),g=-(m-y.y);c>n&&g>=d;)c--,g-=t.Sl(c);f=g-d,c===n&&f>0&&(f=0)}else if(d>0){for(o=t.ns(),g=y.y+y.height-m;c<o&&g<=d;)c++,g+=t.Sl(c);f=g-d-(r=t.Sl(c)),h.options.scrollbarMaxAlign?(i=t.am(),a=t.frozenRowCount(),s=t.getRowCount()-t.frozenTrailingRowCount()-1,o=(l=t.LHb(i.jr,a,s)).cj,u=l.UP,c>o?(c=o,f=u):c===o&&F(f)>F(u)&&(f=u)):c<o&&g-d==0?(c++,f=0):c===o&&g-d<0&&(f=-r)}return{cj:c,UP:f}},t.prototype.ms=function(t,e){var n,o,r,i,a=t.lq,s=t.cCb,l=t.parent;return l&&l.options.scrollByPixel?l.ku.aCb(t,e):((n=t.frozenRowCount())>0&&(0===a&&e>0?a=n:e<0&&a===n-e&&(a=0)),-1!==(o=t.Rt(a+e,e<0))?a=o:a+=e,r=t._t(),i=t.ns(),t.getRowCount()-n-t.frozenTrailingRowCount()<=0||r===D?a=t.lq:(a<r?a=r:a>i&&(a=i),a===D&&(a=-1)),{cj:a,UP:s})},t.prototype._Bb=function(t,e){var n,o,r,i,a,s,l,u,c=t.qq,f=t.eCb,h=t.parent,p=t.zoom(),d=O(e*h.options.scrollPixel*p),g=0,m=t.am().pt,y=t.it(1).findCol(c);if(y)if(d<0){for(n=t.Ot(-1),g=-(m-y.x);c>n&&g>=d;)c--,g-=t.Tl(c);f=g-d,c===n&&f>0&&(f=0)}else if(d>0){for(o=t.ps(),g=y.x+y.width-m;c<o&&g<=d;)c++,g+=t.Tl(c);f=g-d-(r=t.Tl(c)),h.options.scrollbarMaxAlign?(i=t.am(),a=t.frozenColumnCount(),s=t.getColumnCount()-t.frozenTrailingColumnCount()-1,o=(l=t.MHb(i.er,a,s)).dj,u=l.UP,c>o?(c=o,f=u):c===o&&F(f)>F(u)&&(f=u)):c<o&&g-d==0?(c++,f=0):c===o&&g-d<0&&(f=-r)}return{dj:c,UP:f}},t.prototype.Sw=function(t,e){var n,o,r,i,a=t.qq,s=t.eCb,l=t.parent;return l&&l.options.scrollByPixel?l.ku._Bb(t,e):((n=t.frozenColumnCount())>0&&(0===a&&e>0?a=n:e<0&&a===n-e&&(a=0)),-1!==(o=t.Ot(a+e,e<0))?a=o:a+=e,r=t.$t(),i=t.ps(),t.getColumnCount()-n-t.frozenTrailingColumnCount()<=0||r===D?a=t.qq:(a<r?a=r:a>i&&(a=i),a===D&&(a=-1)),{dj:a,UP:s})},t.prototype.Dw=function(t,e){var n,o,r=this.yw;Ct(r)&&(t?(n=e.pageY,o=e.pageX-100):(n=e.pageY-40,o=e.pageX-30),r.uw(this.Nw(t),o,n,!0))},t.prototype.Nw=function(t){var e,n=Ct(this.yw),o=n.qq+1;return n&&(t?e=gt().Tip_Row+(n.lq+1):(1!==n.options.colHeaderAutoText&&(o=s.Ul.xq(o)),e=gt().Tip_Column+o)),e},t.prototype.Sdc=function(t){a.GC$(t).addClass(st)},t.prototype.Tdc=function(t){a.GC$(t).removeClass(st)},t.prototype.Udc=function(t){a.GC$(t).addClass(lt)},t.prototype.Vdc=function(t){a.GC$(t).removeClass(lt)},t.prototype.Rdc=function(t,e){var n,o,r,i;void 0===e&&(e=1e3),o=(n=this).yw,r=t?o.Cv:o.Kv,i=function(){n.Vdc(r),n.Sdc(r)},(o.options.scrollbarAppearance=m.ScrollbarAppearance.mobile)&&(n.Wdc(t),t?n.Xdc=setTimeout(i,e):n.Ydc=setTimeout(i,e))},t.prototype.Wdc=function(t){var e=this;t&&e.Xdc?(clearTimeout(e.Xdc),e.Xdc=null):!t&&e.Ydc&&(clearTimeout(e.Ydc),e.Ydc=null)},t}(),yt={allowUserDragDrop:!0,allowUserDragFill:!0,allowUserZoom:!0,allowUserResize:!0,allowUndo:!0,allowSheetReorder:!0,allowContextMenu:!0,allowUserDeselect:!0,defaultDragFillType:5,showDragFillSmartTag:!0,showHorizontalScrollbar:!0,showVerticalScrollbar:!0,scrollbarShowMax:!0,scrollbarMaxAlign:!1,tabStripVisible:!0,tabStripRatio:.5,tabEditable:!0,newTabVisible:!0,cutCopyIndicatorVisible:!0,cutCopyIndicatorBorderColor:"#217346",tabNavigationVisible:!0,backColor:"white",backgroundImage:D,backgroundImageLayout:0,showResizeTip:m.ShowResizeTip.none,showDragDropTip:!0,showDragFillTip:!0,scrollIgnoreHidden:!1,highlightInvalidData:!1,showScrollTip:m.ShowScrollTip.none,grayAreaBackColor:D,useTouchLayout:!1,hideSelection:!1,resizeZeroIndicator:m.ResizeZeroIndicator.enhanced,allowUserEditFormula:!0,enableFormulaTextbox:!0,referenceStyle:0,allowDynamicArray:!1,iterativeCalculation:!0,iterativeCalculationMaximumIterations:1e3,iterativeCalculationMaximumChange:.01,calcOnDemand:!1,autoFitType:m.AutoFitType.cell,allowCopyPasteExcelStyle:!0,allowExtendPasteRange:!1,copyPasteHeaderOptions:m.CopyPasteHeaderOptions.allHeaders,allowUserDragMerge:!1,rowResizeMode:m.ResizeMode.normal,columnResizeMode:m.ResizeMode.normal,scrollByPixel:!1,scrollPixel:5,enableAccessibility:!1,allowAutoCreateHyperlink:!0,scrollbarAppearance:m.ScrollbarAppearance.skin,font:D,customList:[],numbersFitMode:m.NumbersFitMode.mask},vt=function(){function t(t,e){var n,o,r=this;r.name="",r.kv=!1,r.lv=-1,r.eq=0,r.mv=!1,r.options=I(yt,(function(t,e,n){r.Op(t,e,n)})),r.T3(e),e&&"white"===e.backColor?r.Sxb=!0:r.Sxb=!1,n=1,e&&(typeof(o=e.sheetCount)===P&&(n=o)),r.qo=t,r.ad(n,t)}return t.prototype.commandManager=function(){return this.wu},t.prototype.undoManager=function(){return this.pv},t.prototype.Txb=function(){var t=this.Uxb(),e=this.Vxb;return e instanceof Array?e.concat(t):t},t.prototype.Uxb=function(){var t=k.culture(),e=[],n=[],o=k.q4("en-US").DateTimeFormat,r=k.q4(t).DateTimeFormat;return e=this.Wxb(o),"en-US"!==t&&(n=this.Wxb(r)),e.concat(n)},t.prototype.Wxb=function(t){var e,n,o=[];return this.Xxb=["abbreviatedDayNames","dayNames","abbreviatedMonthNames","monthNames"],this.Xxb.forEach((function(r){(e=t[r])instanceof Array&&e.length>0&&(n=r.indexOf("month")>-1||r.indexOf("Month")>-1,e=n?e.slice(0,12):e,o.push(e))})),o},t.prototype.FHb=function(){var t=T&&this.Cf();t&&t.NHb(),this.sheets.forEach((function(t){t.yj().OHb()}))},t.prototype.Op=function(t,e,n){var o,r=this,i=Ct(r),a=T&&r.Cf();switch(t){case"allowUndo":r.pv&&(r.pv.zc=e);break;case"backColor":r.Sxb=!0,i&&i.$p();break;case"cutCopyIndicatorBorderColor":case"cutCopyIndicatorVisible":case"grayAreaBackColor":case"hideSelection":case"highlightInvalidData":case"resizeZeroIndicator":case"allowUserDragFill":case"allowUserDragMerge":case"numbersFitMode":i&&i.$p();break;case"backgroundImage":case"backgroundImageLayout":r.Ys(),i&&i.$p();break;case"newTabVisible":case"tabNavigationVisible":(o=r.hq)&&o.repaint();break;case"showHorizontalScrollbar":case"showVerticalScrollbar":case"useTouchLayout":case"tabStripVisible":r.fq();break;case"tabStripRatio":r.aq();break;case"scrollIgnoreHidden":case"scrollbarMaxAlign":case"scrollbarShowMax":i&&(i.oq=!0,i.jq=!0,i.$p());break;case"scrollByPixel":i&&(i.oq=!0,i.jq=!0,i.cCb=0,i.eCb=0,i.$p());break;case"scrollPixel":e<=0&&(r.options.scrollPixel=n);break;case"scrollbarAppearance":r.ku&&e!==n&&r.Zdc(e);break;case"calcOnDemand":a&&(!e&&a.calcOnDemand&&r.FHb(),a.calcOnDemand=e);break;case"customList":r.Vxb=e;break;case"referenceStyle":case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":r.PHb(t,e),i&&i.$p()}},t.prototype.Zdc=function(t){var e,n;x(t)&&(t=m.ScrollbarAppearance.skin),e=this,n=t===m.ScrollbarAppearance.mobile,e.St.$dc(t),e.Pt.$dc(t),e._dc(),n?e.aec():e.bec(),e.refresh()},t.prototype.PHb=function(t,e){var n=T&&this.Cf();if(n)switch(t){case"referenceStyle":n.useR1C1=1===e;break;case"allowDynamicArray":case"iterativeCalculation":case"iterativeCalculationMaximumIterations":case"iterativeCalculationMaximumChange":n[t]=e}},t.prototype.ad=function(e,n){var o,r,i,a,s=this;for(T&&s.qv(),s.rv=[],s.sv=S("input"),s.jm=0,s.xD=0,s.tv={fromSheet:D,isCutting:!1},s.mmb={fromSheet:D,isCutting:!1},s.Ks=D,s.sheets=[],s.Lq={},s.Vxb=s.options.customList,s.pv=new v(s,-1,s.options.allowUndo),(o=s.wu=new C(s)).addListener("workbookUndo",(function(t){var e,n,o=t.command,r=u.Commands.aWa(o),i=s.wu[o.cmd];i&&i.canUndo()&&!r&&!o.yTa&&((e=s.getSheetFromName(o.sheetName))&&(o.sheetId=e.yn),s.undoManager().Cc(o,t.s4)),1!==t.s4&&2!==t.s4||((n=s.getActiveSheet())&&n.name())!==o.sheetName&&s.setActiveSheet(o.sheetName)})),u.Commands.uv(o),t.ao(s,"init"),r=0;r<e;r++)i=s.vv(s.wv(r)),s.sheets.push(i),i.Ls(s);(a=s.sheets[s.eq])&&a.isSelected(!0),s.suspendPaint(),n&&s.ws(n),s.uu=new p.S4(s),s.resumePaint()},t.prototype.hitTest=function(t,e,n){var o,r,i,s,l,u,c,f,h,p,d,g,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,O,j,F=this,P=F.getActiveSheet(),_=F.hq,L=F.Pt,B=F.St,G=a.GC$(F.getHost()).width(),H=a.GC$(F.getHost()).height();if(t<0||t>G||e<0||e>H)return D;if(o=F.oia(),F.options.scrollbarAppearance===m.ScrollbarAppearance.mobile){if(r=function(t,e,n,o,r){var i=t.pia(),a=e.left-n.left,s=e.top-n.top;if(o>a&&o<i.width+a&&r>s&&r<i.height+s)return{horizontalScrollBarHitInfo:{element:t.hitTest(o-a,r-s).element},x:o,y:r}}(L,a.GC$(F.Kv).offset(),o,t,e))return r;if(i=function(t,e,n,o,r){var i=t.pia(),a=e.left-n.left,s=e.top-n.top;if(o>a&&o<i.width+a&&r>s&&r<i.height+s)return{verticalScrollBarHitInfo:{element:t.hitTest(o-a,r-s).element},x:o,y:r}}(B,a.GC$(F.Cv).offset(),o,t,e))return i}if(P&&(s=P.Vs(),l=P.Dr(),u=s.left-o.left,c=s.top-o.top,t>u&&t<l.width+u&&e>c&&e<l.height+c))return{worksheetHitInfo:P.hitTest(t-u,e-c,!1,n),x:t,y:e};if(f=a.GC$(_.Ws()).offset(),h=_.Dr(),p=f.left-o.left,d=f.top-o.top,t>p&&t<h.width+p&&e>d&&e<h.height+d){switch(y={},v=(g=_.hitTest(t-p,e-d)).index,b=(C=F.sheets[v])&&C.name(),g.type){case"navButton":y={navButton:g.element};break;case"sheetTab":y={sheetTab:{sheetName:b||g.element,sheetIndex:v}};break;case"resize":y={resize:!0};break;default:y={blank:!0}}return{tabStripHitInfo:y,x:t,y:e}}return w=a.GC$(L.Bv()).offset(),T=L.pia(),x=w.left-o.left,S=w.top-o.top,t>x&&t<T.width+x&&e>S&&e<T.height+S?{horizontalScrollBarHitInfo:{element:L.hitTest(t-x,e-S).element},x:t,y:e}:(A=a.GC$(B.Bv()).offset(),I=B.pia(),R=A.left-o.left,k=A.top-o.top,t>R&&t<I.width+R&&e>k&&e<I.height+k?{verticalScrollBarHitInfo:{element:B.hitTest(t-R,e-k).element},x:t,y:e}:(M=a.GC$(F.Ov).offset(),N=parseInt(F.Ov.style.width.substr(0,F.Ov.style.width.indexOf("px")),10),E=parseInt(F.Ov.style.height.substr(0,F.Ov.style.height.indexOf("px")),10),O=M.left-o.left,j=M.top-o.top,t>O&&t<N+O&&e>j&&e<E+j?{footerCornerHitInfo:{element:"footerCorner"},x:t,y:e}:void 0))},t.prototype.oia=function(){var t;return(t=ut?ut(this.qo).offset():a.GC$(this.qo).offset())?(t.top+=E.body.clientTop||0,t.left+=E.body.clientLeft||0):t={top:0,left:0},t},t.prototype.T3=function(t){var e=this.options,n=t||{};n=w(!0,{},yt,n),b(n,(function(t,n){e.hasOwnProperty(t)&&(e[t]=n)}))},t.prototype.xv=function(){var t=this;return!t.Ks&&t.qo&&(t.Ks=S(X),a.GC$(t.Ks).css({position:"relative",left:0,top:0,height:0}),a.GC$(t.qo).prepend(t.Ks)),t.Ks},t.prototype.wv=function(t){var e,n,o,r,i,a,s=this,l=s.getSheetCount();s.lv<l?s.lv=l:s.lv++,(x(t)||t<s.lv)&&(t=s.lv),e=!1,o=s.sheets;do{for(n=(gt().SHEET_NAME||"Sheet")+(t+1),r=o.length,i=0;i<r;i++)if(a=o[i]){if(a.name().toUpperCase()===n.toUpperCase()){t++,e=!0;break}e&&(e=!1)}}while(e);return n},t.prototype.vv=function(t){return new d.Worksheet(t)},t.prototype.ws=function(e){var n,r,i,s,l,u,c,f,h,p,d,g,y,v,C,b,w,T,x,A,I,R,k=this;if(e){for(k.qo=e,ut&&ut(e).data(ft,k),a.GC$(e).data(ft,k).attr(ht,"gcSpread").addClass(pt).css("overflow","visible"),N.Yl.qm(),k.cultureChangedHandler=function(){k.Av()},E.addEventListener(ct,k.cultureChangedHandler),r=(n=S(Z)).style,i=void 0,s=void 0,l=void 0,u=void 0,c=void 0,f="100%",h=k.options.scrollbarAppearance,p=k.options.scrollByPixel,n.cellSpacing="0px",n.cellPadding="0px",n.border="0",r.width=f,r.height=f,r.border="0",r.margin="0",r.borderCollapse="collapse",i=0;i<2;i++){for(l=S("tr"),s=0;s<2;s++)(c=(u=S("td")).style).padding=0,c.border=0,l.appendChild(u);n.appendChild(l)}for(e.appendChild(n),k.xs=S(X),k.xs.id=e.id+"vp",a.GC$(n.rows[0].cells[0]).append(k.xs),d=h===m.ScrollbarAppearance.mobile,g=p?m.ScrollType.pixels:m.ScrollType.continuous,k.St=new o.hv(!1,D,D,D,D,D,g,h,(function(){k.cec(!0)})),y=k.St.Bv(),v=k.Cv=S(X),a.GC$(v).append(y),k.dec=n.rows[0].cells[1],a.GC$(y).bind(V+Y,(function(t,e){var n=e.scrollEventType;t.data=k,1===e.scrollOrientation&&(0===n||1===n||2===n||3===n||5===n?mt.Dv(t,e):4===n&&mt.Ev(t))})).bind(_+Y,(function(t){t.data=k,mt.Fv(t)})).bind(B+Y,(function(t){t.data=k,mt.Gv(t)})).bind(L+Y,(function(t){t.data=k,t.scrollbar=k.St,mt.ggc(t)})),b=(C=S(Z)).style,C.cellSpacing="0",C.cellPadding="0",C.border="0",b.border="0",b.margin="0",a.GC$(C).css("user-select",K),l=S("tr"),s=0;s<2;s++)(c=(u=S("td")).style).padding=0,c.border=0,l.appendChild(u);C.appendChild(l),a.GC$(n.rows[1].cells[0]).append(C),void 0,T=void 0,(T=(w=k.Hv=S(X)).style).width=""+k.Iv()*a.GC$(e).width()+Q,T.height=""+k.Jv()+Q,T.fontSize="10pt",T.fontFamily="Arial",a.GC$(C.rows[0].cells[0]).append(w),k.Pt=new o.hv(!0,D,D,D,D,D,g,h,(function(){k.cec(!1)})),x=k.Pt.Bv(),A=k.Kv=S(X),a.GC$(A).append(x),k.eec=C.rows[0].cells[1],a.GC$(x).bind(V+Y,(function(t,e){var n=e.scrollEventType;t.data=k,0===e.scrollOrientation&&(0===n||1===n||2===n||3===n||5===n?mt.Lv(t,e):4===n&&mt.Mv(t))})).bind(_+Y,(function(t){t.data=k,mt.Nv(t)})).bind(B+Y,(function(t){t.data=k,mt.Gv(t)})).bind(L+Y,(function(t){t.data=k,t.scrollbar=k.Pt,mt.ggc(t)})),k.Ov=S(X),a.GC$(n.rows[1].cells[1]).append(k.Ov),k.ku=new mt(this),d&&k.aec(),k._dc(),I=k.oTa=function(){k.Pv()},a.GC$(N).bind(z+U,I),(R=Ct(k))&&R.ws(k.xs),k.Qv(),k.fq(),k.Rv(e),t.ao(k,"setHost",e)}},t.prototype._dc=function(){var t,e,n,o,r,i=this,s=i.qo;i.ku&&(t=i.options.scrollbarAppearance===m.ScrollbarAppearance.mobile,e=i.dec,n=i.eec,o=i.Cv,r=i.Kv,a.GC$(o).removeAttr("style"),a.GC$(r).removeAttr("style"),t?(o.style.position="absolute",o.style.top="0px",o.style.left="0px",a.GC$(o).addClass(ot+" "+it),a.GC$(s).css("position","relative").append(o),r.style.position="absolute",r.style.top="0px",r.style.left="0px",a.GC$(r).addClass(ot+" "+rt),a.GC$(s).append(r)):(a.GC$(e).append(o),a.GC$(n).append(r),a.GC$(o).removeClass(ot+" "+st+" "+it+" "+lt),a.GC$(r).removeClass(ot+" "+st+" "+rt+" "+lt),a.GC$(s).css("position","auto")))},t.prototype.aec=function(){var t=this,e=t.qo,n=t.Cv,o=t.Kv;a.GC$(n).bind(G,(function(){t.St.Jwa(m.ScrollbarState.active)})).bind(H,(function(){t.St.Jwa(m.ScrollbarState.unactive)})),a.GC$(o).bind(G,(function(){t.Pt.Jwa(m.ScrollbarState.active)})).bind(H,(function(){t.Pt.Jwa(m.ScrollbarState.unactive)})),a.GC$(e).bind(G,t.fec).bind(H,t.gec)},t.prototype.bec=function(){var t=this,e=t.Cv,n=t.Kv;e&&(a.GC$(e).unbind(G).unbind(H),t.ku.Wdc(!0)),n&&(a.GC$(n).unbind(G).unbind(H),t.ku.Wdc(!1)),a.GC$(t.qo).unbind(G,t.fec).bind(H,t.gec)},t.prototype.fec=function(){a.GC$(this).find("."+ot).addClass(at)},t.prototype.gec=function(){a.GC$(this).find("."+ot).removeClass(at)},t.prototype.Rv=function(t){var e=this,n="tabindex",o=M(a.GC$(t).attr(n),10)||0,r=S(X);a.GC$(r).css({position:tt,overflow:"hidden"}).attr(ht,"gcSheetFocusElementForTab").attr(n,o).bind(W,(function(){e.Sv||Ct(e).zt(),e.Sv=!1})),t.insertBefore(r,D),e.Tv=r},t.prototype.Uv=function(){var t=this.Tv;t&&(this.Sv=!0,t.focus())},t.prototype.hgc=function(){var t,e,n,o,r,i=this.getActiveSheet();if(i)if(s.Vl.Wl(i)){if(e=this.qo)for(n=document.activeElement,o=document.body,r=n;r;){if(r===e){t=n;break}if(r===o)break;r=r.parentElement}}else i.Xs&&(t=i.Xs);return t},t.prototype.dgc=function(t){var e=this;e.igc&&(N.clearTimeout(e.igc),e.igc=D),e.igc=N.setTimeout((function(){var n=e.hgc();n&&n.setAttribute("aria-label",t),N.clearTimeout(e.igc),e.igc=D}),50)},t.prototype.no=function(){var e,n,o,r,i,l,u=this,c=u.Pt,f=u.St,p=u.sheets,d=u.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;for(s.En.Tn(u),s.Ul.no(),u.oTa&&a.GC$(N).unbind(z+U,u.oTa),u.oTa=D,u.Zv&&clearTimeout(u.Zv),c&&c.dispose(),f&&f.dispose(),u.mu(),s.Vl.Xl()===u.getActiveSheet()&&s.Vl.Zl(D),e=0;e<p.length;e++)p[e].no(!0);p.splice(0,p.length),(n=u.uu)&&(n.no(),u.uu=D),i="class",l="unselectable",(o=u.qo)&&(r=a.GC$(o),E.removeEventListener(ct,u.cultureChangedHandler),r.html("").removeAttr(ht).removeClass(pt),r.attr(i)||r.removeAttr(i),r.attr(l)||r.removeAttr(l),r.data(ft)&&r.data(ft,D),ut&&ut(o).data(ft)&&ut(o).data(ft,D)),d&&u.bec(),u.Kv=D,u.Cv=D,u.pv&&(u.pv.no(),u.pv=D),u.hq&&(u.hq.no(),u.hq=D),t.ao(u,"dispose"),u.Tv&&(a.GC$(u.Tv).unbind(W),u.Tv=D),u.Wu&&(u.Wu.dispose(),u.Wu=D,u.yv=D,u.zv=D),u.bt&&(u.bt.no(),u.bt=D),h.To.no(),u.wu&&(u.wu.no(),u.wu=D),u.ku&&(u.ku.no(),u.ku=D)},t.prototype.mu=function(){var t,e=this.sheets;for(a.GC$(this.sv).unbind(U),t=0;t<e.length;t++)e[t].mu()},t.prototype.Qv=function(){var t,e,n,o=this,r=M(s.Im.Lm("").zIndex),i=r!==o.Vv,a=o.options.scrollbarAppearance===m.ScrollbarAppearance.mobile,l=o.qo.getAttribute("id")+"_tabStrip",u=o.hq;i&&(o.Vv=r),t=o.Jv(),e=o.Wv(),n=o.Xv(),u&&!i?u.repaint():(u&&u.no(),(u=o.hq=r>2007?new c.iv(l):new f.jv(l)).Yv(o),u.ws(o.Hv)),a?o.hec():(Tt(o.Cv,n,e),xt(o.Kv,t,e)),St(o.Ov,n,t)},t.prototype.Pv=function(){var t=this,e=t.Zv;e&&clearTimeout(e),t.Zv=N.setTimeout((function(){s.En.Un(),t.fq(),t.Zv=D}),100)},t.prototype.fq=function(){var t=this;t.kv||(t.kv=!0,t.$v(),t.kv=!1)},t.prototype.$v=function(){var t,e,n,o,r,i,s,l,u,c,f,h,p,d,g,y,v,C,b,w,T=this,x="display",S="block",A=T.Jv(),I=T.Wv(),R=T.Xv(),k=T.qo;k&&(e=(t=T.options).showVerticalScrollbar,n=t.showHorizontalScrollbar,o=t.tabStripVisible,r=t.scrollbarAppearance===m.ScrollbarAppearance.mobile,i=n||o,l=(s=a.GC$(k)).width(),u=s.height(),c=T.Ov,f=T.Pt,h=T.St,p=T.xs.style,d=T.Hv.style,r&&!o&&n&&(A=0),p.width=""+(l-(e&&!r?R:0))+Q,a.GC$(T.Cv).css(x,e?S:K),a.GC$(c).css("width",(e&&!r?R:0)+Q),g=u-(i?A:0),p.height=""+(g>=2?g:2)+Q,a.GC$(T.Kv).css(x,i?S:K),a.GC$(c).css("height",i?A:0+Q),n?a.GC$(f.Bv()).show():a.GC$(f.Bv()).hide(),y=a.GC$(T.xs).width(),(v=O(T.Iv()*y))===y&&(v=y-1),d.width=""+v+Q,d.height=""+A+Q,h.Vo(I),h._v(a.GC$(T.xs).height()),C=l-(o&&!r?v:0)-(e?R:0),f.Vo(C>0?C:1),f._v(I),(b=Ct(T))&&(0===b.lq&&(b.lq=b._t()),0===b.qq&&(b.qq=b.$t()),b.fq()),r&&T.hec(),T.Ut(),T.Xt(),r&&(T.St.Jwa(m.ScrollbarState.hide),T.Pt.Jwa(m.ScrollbarState.hide)),b&&(b.invalidateLayout(),b.repaint()),o?a.GC$(T.Hv).show():a.GC$(T.Hv).hide(),T.hq&&T.hq.fq(),l!==(w=s.width())&&F(l-w)>2&&!T.aw&&(T.aw=!0,setTimeout((function(){delete T.aw,T.$v()}),1)))},t.prototype.hec=function(){var t,e,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w=this;x(w.qo)||(t=a.GC$(w.qo),(e=w.getActiveSheet())&&(n=e.am(),o=w.options.showVerticalScrollbar,2,r=a.GC$(w.Cv),i=a.GC$(w.Kv),s=t.width(),l=t.height(),u=w.options.tabStripVisible?w.Jv():0,c=n.x+n.Br,f=n.y+n.Cr,h=o?r.width():0,0,d=f,g=(p=l-u-f)-M(r.css("padding-top"))-M(r.css("padding-bottom")),m=s-h-c,y=i.height(),v=u,C=c,b=m-M(i.css("padding-left"))-M(i.css("padding-right"))-2,w.St.Vo(h),w.St._v(g),w.Pt.Vo(b),w.Pt._v(y),r.css(["height","left","right","top"],[p,"auto",0,d]),i.css(["width","top","bottom","left"],[m,"auto",v,C])))},t.prototype.Ut=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,C,b=this,w=Ct(b),T=b.options;w&&(e=(t=b.Pt)&&t.QB===m.ScrollType.pixels,n=w.frozenColumnCount(),o=w.getColumnCount()-w.frozenTrailingColumnCount()-n,r=n,i=w.am(),a=0===o?r:r+o-1,s=w.qq,l=w.eCb,u=void 0,c=0,T.scrollbarMaxAlign?(e?(u=(f=w.MHb(i.er,r,a)).dj,c=f.UP):u=w.fu(i.er,r,a),a=u):e&&(c=-w.Tl(a)),T.scrollbarShowMax?e&&!T.scrollbarMaxAlign&&(c=-w.Tl(a)):(h=w.iu().lastNonNullCol,(p=w.fu(i.er,r,h))===r&&(++p>a&&(p=a)),a=s>p?s<a?s:a:p,c=l),s>a?(w.qq=a,w.eCb=e?c:0):s===a&&c>l&&(w.eCb=e?c:0),-1!==(d=w.Ot(w.qq))&&d!==w.qq&&(w.qq=d),t&&(g=0,y=0,v=0,C=0,e?(g=w.jgc(r),y=w.jgc(a)-c,v=i.er,C=w.jgc(w.qq)-w.eCb):(g=w.Qt(r),y=w.Qt(a),v=w.gu(),C=w.Qt(w.qq),v<1&&(v=1)),t.bw(g),t.cw(y),t.dw(v),t.ew(),t.value(C)))},t.prototype.Xt=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,y,v,C,b=this,w=Ct(b),T=b.options;w&&(e=(t=b.St)&&t.QB===m.ScrollType.pixels,n=w.frozenRowCount(),o=w.getRowCount()-w.frozenTrailingRowCount()-n,r=n,i=w.am(),a=0===o?r:r+o-1,s=w.lq,l=w.cCb,u=void 0,c=0,T.scrollbarMaxAlign?(e?(u=(f=w.LHb(i.jr,r,a)).cj,c=f.UP):u=w.eu(i.jr,r,a),a=u):e&&(c=-w.Sl(a)),T.scrollbarShowMax?e&&!T.scrollbarMaxAlign&&(c=-w.Sl(a)):(h=w.iu().lastNonNullRow,(p=w.eu(i.jr,r,h))===r&&(++p>a&&(p=a)),a=s>p?s<a?s:a:p,c=l),s>a?(w.lq=a,w.cCb=e?c:0):s===a&&c>l&&(w.cCb=e?c:0),-1!==(d=w.Rt(w.lq))&&d!==w.lq&&(w.lq=d),t&&(g=0,y=0,v=0,C=0,e?(g=w.kgc(r),y=w.kgc(a)-c,v=i.jr,C=w.kgc(w.lq)-w.cCb):(g=w.Tt(r),y=w.Tt(a),v=w.hu(),C=w.Tt(w.lq),v<1&&(v=1)),t.bw(g),t.cw(y),t.dw(v),t.ew(),t.value(C)))},t.prototype.aq=function(){var t,e,n,o,r,i,s,l,u,c=this,f=c.Jv(),h=c.Wv(),p=c.Xv(),d=c.qo,g=c.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;d&&(e=(t=c.options).tabStripVisible,n=a.GC$(d).width(),o=c.Pt,r=c.Hv.style,i=a.GC$(c.xs).width(),(s=O(c.Iv()*i))===i&&(s=i-1),r.width=""+s+Q,r.height=""+f+Q,l=n-(e&&!g?s:0)-(t.showVerticalScrollbar?p:0),o.Vo(l>0?l:1),o._v(h),(u=Ct(c))&&0===u.qq&&(u.qq=u.$t()),c.Ut(),e?a.GC$(c.Hv).show():a.GC$(c.Hv).hide(),c.hq&&c.hq.fq())},t.prototype.suspendPaint=function(){var t,e,n=this,o=n.hq,r=n.sheets;for(n.xD++,t=0,e=r;t<e.length;t++)e[t].suspendPaint();o&&o.fw()},t.prototype.resumePaint=function(){var t,e,n=this,o=n.hq,r=n.sheets;for(n.xD-=n.xD>0?1:0,t=0,e=r;t<e.length;t++)e[t].resumePaint();o&&o.gw()},t.prototype.isPaintSuspended=function(){return this.xD>0},t.prototype.Ys=function(){var e,n,o,r,i,u=this,c=u.options.backgroundImage,f=u.options.backgroundImageLayout,h=Ct(u);if(h&&c&&(e=void 0,a.GC$(h.Ws()).css({"background-image":"url('"+c+"')","background-repeat":"no-repeat"}),!x(f))){(e=u.bt)||(e=u.bt=new l.oo((function(){u.bt&&u.Ys()})));try{e.ko(c)?(n=e.lo(c),r=(o=h.Dr()).width,i=o.height,s.Ul.ql(h.Ws(),r,i,n.width,n.height,f)):e.fo(c)}catch(t){}}},t.prototype.hw=function(t){this.hq.iw(this.getSheetIndex(t.name()))},t.prototype.startSheetIndex=function(t){var e=this,n=e.hq;return 0===arguments.length?n?n.gq:0:(n&&(n.hE(t)||-1===(t=n.jw(t))&&(t=n.rw(t)),n.gq=t),e.aq(),e)},t.prototype.Iv=function(){var t,e,n,o,r,i=this,s=i.options,l=i.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;return s.showHorizontalScrollbar&&!l?(t=s.tabStripRatio,isNaN(t)?.5:(e=0,n=i.xs,o=i.hq,n&&o&&(r=a.GC$(n).width(),e=o.kw/r),t<e?t=e:t>1&&(t=1),t)):1},t.prototype.destroy=function(){this.oTa&&a.GC$(N).unbind(z+U,this.oTa),this.no()},t.prototype.repaint=function(){var t,e=this.hq;e&&e.repaint(),(t=Ct(this))&&t.repaint()},t.prototype.refresh=function(){var t=this;t.qo&&(s.Im.Nm(),t.Qv(),t.fq(),t.repaint())},t.prototype.getHost=function(){return this.qo},t.prototype.invalidateLayout=function(){var t=Ct(this);t&&t.invalidateLayout()},t.prototype.addNamedStyle=function(t){this.Kq(t);var e=Ct(this);e&&e.$p()},t.prototype.Kq=function(t){if(t){if(!t.name)throw Error(gt().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Lq[e]=t}},t.prototype.getNamedStyle=function(t){return this.Mq(t,!0)},t.prototype.Mq=function(t,e){var n,o=this.Lq;return o&&t?((n=o[t=t.toUpperCase()])&&e&&this.Jq(),n):D},t.prototype.Jq=function(){var t,e;for(t=0,e=this.sheets;t<e.length;t++)e[t].Jq()},t.prototype.removeNamedStyle=function(t){var e,n,o=this.Lq;o&&t&&(t=t.toUpperCase(),o.hasOwnProperty(t)&&((e=o[t].formatter)&&"string"==typeof e&&this.QHb[e]&&this.RHb(e),delete o[t],this.Jq(),(n=Ct(this))&&n.$p()))},t.prototype.getNamedStyles=function(){var t=[],e=this.Lq;return e&&b(e,(function(e,n){t.push(n)})),this.Jq(),t},t.prototype.getActiveSheet=function(){return this.sheets&&this.sheets.length>0?this.sheets[this.eq]:D},t.prototype.setActiveSheet=function(t){this.lw(t,2)},t.prototype.lw=function(t,e){var n,o=this.sheets,r=this.getActiveSheet();for(n=0;n<o.length;n++)o[n].name()===t&&this.dq(n,e);this.SHb(r)},t.prototype.getActiveSheetIndex=function(){return this.eq},t.prototype.setActiveSheetIndex=function(t){var e=this.getActiveSheet();this.dq(t,2),this.SHb(e)},t.prototype.dq=function(t,e,n,o){var r,i,a,l,u,c,f,h;typeof t===P&&(t!==(r=this).eq&&((i=r.sheets[t])&&i.visible()&&(((a=s.Ul.rl()).ipad||a.iphone)&&((l=r.mw)&&(new Date).valueOf()-l<300)||(function(t,e){t.Wq(s.Events.FormulatextboxActiveSheetChanging,e)}(r,c={oldSheet:u=Ct(r),newSheet:i,needTriggerSheetChange:!0}),f={oldSheet:u,newSheet:i,cancel:!1},(h=c.needTriggerSheetChange&&o)&&function(t,e){t.Wq(s.Events.ActiveSheetChanging,e)}(r,f),!1===f.cancel&&(r.eq=t,i!==u&&(u&&(u.no(!1),u.charts&&u.charts.all().forEach((function(t){t.clearflexDVs()}))),r.nw(i,e,!1,h,n)),r.fq(),function(t,e,n){t.Wq(s.Events.FormulatextboxActiveSheetChanged,{oldSheet:e,newSheet:n})}(r,u,i),h&&function(t,e,n){t.Wq(s.Events.ActiveSheetChanged,{oldSheet:e,newSheet:n})}(r,u,i)),(a.ipad||a.iphone)&&(r.mw=(new Date).valueOf())))))},t.prototype.nw=function(t,e,n,o,r){var i,a,l;n||t.ws(this.xs),a=(i=s.Vl.Xl())&&i.parent===this,l=2===e?a:1===e,s.Vl.Zl(D),!this.mv&&l&&t.zt(r),t.qs(),t.os()},t.prototype.SHb=function(t){var e=this.getActiveSheet();t&&t.DHb(!1,!1),e&&e.DHb(!0,!1)},t.prototype.addSheet=function(t,e){var n=this.getActiveSheet();this.ow(t,2,e),this.SHb(n)},t.prototype.ow=function(t,e,n){var o,r,i,a,s,l,u,c,f=this;if(n||(n=f.vv(f.wv(t))),i=(r=f.sheets).length,n.name()){for(o=0;o<i;o++)if(r[o].name()===n.name())throw gt().Exp_NotSupported}else n.cq(f.wv(t));for(f.pw(n),a=Ct(f),s=f.eq,l=i-t,u=[],o=0;o<l&&i>0;o++)u.push(r.pop());for(r.push(n),n.Ls(f);u.length>0;)r.push(u.pop());1===(i=r.length)?(f.xs&&n.ws(f.xs),f.eq=0):(s<0&&f.hq&&(s=f.hq.jw(s)),f.eq=s),(c=Ct(f))!==a&&(a&&a.no(!1),c&&f.nw(c,e,1===i,!0),f.fq()),f.hq&&(f.hq.gq<0&&(f.hq.gq=f.eq),f.hq.repaint())},t.prototype.removeSheet=function(t){this.qw(t,2)},t.prototype.qw=function(t,e){var n,o,r,i,a,s,l,u=this,c=u.sheets,f=u.Wu,h=u.hq,p=c.length;if(isNaN(t)||t<0||t>=p)throw Error(gt().Exp_IndexOutOfRange);if(n=t<=u.eq||t===p-1,o=Ct(u),t<u.eq&&u.eq--,(r=c[t]).mu(),c.splice(t,1),0===(p=c.length))u.eq=-1;else if(u.eq>=p)u.eq=h.rw(p);else{for(i=void 0,i=u.eq;i<p;i++)if(c[i].visible()){u.eq=i;break}i>=p&&(u.eq=h.rw(p))}n&&(o!==(a=c[u.eq])&&(o&&o.no(!1),a&&u.nw(a,e,!1,!0))),f&&((s=r.yj()).VDc=t,f.removeSource(s)),r.no(!0,-1!==u.eq),T&&!f.Dh&&u.sheets&&u.sheets.length>0&&(l=u.sheets[0],f.initParserContext(l.yj())),h&&(h.gq>=p?u.startSheetIndex(h.rw(p)):h.gq<0?u.startSheetIndex(h.jw(-1)):u.fq())},t.prototype.clearSheets=function(){var t,e,n,o=this,r=o.sheets,i=o.Wu,a=o.hq;for(t=0,e=r;t<e.length;t++)(n=e[t]).mu(),n.no(!0);r.splice(0,r.length),i&&i.clearSource(),o.eq=-1,a&&(a.gq=-1,a.repaint())},t.prototype.getSheet=function(t){var e=this.sheets;return t>=0&&t<e.length?e[t]:D},t.prototype.getSheetFromName=function(t){var e,n,o;for(e=0,n=this.sheets;e<n.length;e++)if((o=n[e]).name()===t)return o;return D},t.prototype.getSheetIndex=function(t){var e,n=this.sheets;for(e=0;e<n.length;e++)if(n[e].name()===t)return e;return D},t.prototype.getSheetCount=function(){return this.sheets.length},t.prototype.setSheetCount=function(t){this.sw(t,2)},t.prototype.sw=function(t,e){var n,o,r=this;if(t<0)throw gt().Exp_ArgumentOutOfRange;if(0===t&&r.clearSheets(),t<(n=r.sheets.length))for(o=n-1;o>=t;o--)r.qw(o,e);else if(t>n)for(o=n;o<t;o++)r.ow(o,e)},t.prototype.bind=function(t,e,n){var o,r,i=this,s=i.sheets;for(i.rv.push({type:t,data:e,fn:n}),a.GC$(i.sv).bind(t+U,e,n),o=0,r=s;o<r.length;o++)r[o].bind(t,e,n)},t.prototype.unbind=function(t,e){var n,o,r,i=this,s=i.sheets,l=i.rv;for(n=0;n<l.length;n++)l[n].type===t&&l.splice(n,1);for(a.GC$(i.sv).unbind(t+U,e),o=0,r=s;o<r.length;o++)r[o].unbind(t,e)},t.prototype.unbindAll=function(){var t,e,n=this,o=n.sheets;for(n.rv.length=0,a.GC$(n.sv).unbind(U),t=0,e=o;t<e.length;t++)e[t].unbindAll()},t.prototype.Fu=function(t,e,n){var o,r,i=this,s=i.sheets;for(i.rv.push({type:t,data:e,fn:n}),a.GC$(i.sv).bind(t+q,e,n),o=0,r=s;o<r.length;o++)r[o].Fu(t,e,n)},t.prototype.Gu=function(t,e){var n,o,r,i=this,s=i.sheets,l=i.rv;for(n=0;n<l.length;n++)l[n].type===t&&l.splice(n,1);for(a.GC$(i.sv).unbind(t+q,e),o=0,r=s;o<r.length;o++)r[o].Gu(t,e)},t.prototype.nu=function(){var t,e,n=this,o=n.sheets;for(n.rv.length=0,a.GC$(n.sv).unbind(q),t=0,e=o;t<e.length;t++)e[t].nu()},t.prototype.Wq=function(t,e){0===this.jm&&a.GC$(this.sv).trigger(t,e)},t.prototype.tw=function(t,e,n,o){this.Wq(s.Events.ButtonClicked,{sheet:t,sheetName:t.name(),row:e,col:n,sheetArea:o})},t.prototype.pw=function(t){var e,n,o;for(e=0,n=this.rv;e<n.length;e++)o=n[e],t.bind(o.type,o.data,o.fn)},t.prototype.suspendEvent=function(){var t,e,n=this.sheets;for(this.jm++,t=0,e=n;t<e.length;t++)e[t].suspendEvent()},t.prototype.resumeEvent=function(){var t,e,n=this,o=n.sheets;for(n.jm--,n.jm<0&&(n.jm=0),t=0,e=o;t<e.length;t++)e[t].resumeEvent()},t.prototype.focus=function(t){if(!1===t)s.Vl.Zl(D);else{var e=Ct(this);e&&e.zt()}},t.prototype.Wv=function(){return this.Vv>2007?15:18},t.prototype.Xv=function(){return this.Vv>2007?22:this.Wv()},t.prototype.cec=function(t){var e,n=this,o=t?n.Cv:n.Kv,r=t?n.St:n.Pt,i=n.options.scrollbarAppearance===m.ScrollbarAppearance.mobile;if(o&&r&&i)switch(e=n.ku,r.iec){case m.ScrollbarState.hide:e.Rdc(t);break;case m.ScrollbarState.show:e.Tdc(o),e.Wdc(t);break;case m.ScrollbarState.active:e.Tdc(o),e.Wdc(t),e.Udc(o);break;case m.ScrollbarState.unactive:e.Vdc(o),e.Rdc(t)}},t.prototype.Jv=function(){return this.Vv>2007?28:this.Wv()},t.prototype.uw=function(t,e,n,o){var r,i="auto",s=this;s.vw||(r=S(X),a.GC$(r).addClass("gc-spread-toolTip ui-state-default ui-widget-content btn-default").css({position:tt,padding:"0px 3px 0px 3px",font:R("normal normal normal 11pt calibri"),"box-shadow":"1px 2px 5px rgba(0,0,0,0.4)","white-space":"pre-wrap"}).width(i).height(i).appendTo(E.body),s.vw=r),s.ww(t,e,n,o)},t.prototype.ww=function(t,e,n,o){var r,i,s,l,u,c,f=Ct(this);f&&((r=this.vw)&&(i=a.GC$(r),t?(i.html(y.Ob(t)),i.show()):i.hide(),s=f.Vs(),o&&(n-=s.top,e-=s.left),u=(l=f.Dr()).x+l.width-i.outerWidth(),c=l.y+l.height-i.outerHeight(),u<0?e=0:c<0?n=0:(n=j(n,c),e=j(e,u)),x(n)||i.css("top",n+s.top),x(e)||i.css("left",e+s.left)))},t.prototype.xw=function(){var t=this.vw;t&&(a.GC$(t).remove(),this.vw=D)},t.prototype.Av=function(){var e,n,o,r,i,a,l,u,c,f=this,h=f.sheets;for(s.mn.wn(),f.invalidateLayout(),e=0,n=h.length;e<n;e++)for(r=(o=h[e]).getRowCount(),i=o.getColumnCount(),a=0;a<r;a++)for(l=0;l<i;l++)(u=o.getValue(a,l))instanceof Date&&((c=o.getStyle(a,l))&&c.$o(u),o.Nq(a,l,c));f.repaint(),t.ao(f,"onCultureChanged")},t.prototype.getTab=function(){return this.hq},t.Qp=yt,t.nv=1,t.ov=0,t}(),e.Workbook=vt,s.Zn(vt),vt.prototype.nextControl=A("nextControl",D),vt.prototype.previousControl=A("previousControl",D)},"./dist/core/workbook/workbookpanelex.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et;function nt(t){t.preventDefault?t.preventDefault():t.returnValue=!1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/util/common.js"),i=n("Common"),a=n("./dist/core/core.enum.js"),s=n("./dist/core/workbook/sheettabbase.js"),l=i.Common.j.Fa,u=null,c=r.Ul.Ml,f=r.Ul.nl,h=r.Ul.Nl,p=r.Ul.Pl,d=document,g=window,m=Math.round,y=Math.ceil,v="gc-scroll-arrow",C="gc-scrollbar-wrapper",b="gc-scroll-mobile-track",w="gc-scroll-mobile-thumb",T="gc-scroll-mobile-state-active",x="gc-no-user-select",S="width",A="height",I="gc-scrollbar-stateActive ui-state-active",R="left",k="right",M="top",N="bottom",E="position",D="border",O="padding",j="margin",F="overflow",P="display",_="100%",L="borderWidth",B="boxSizing",H="mousedown"+(G=".gcScrollbar"),V="mouseup"+G,z="mousemove"+G,W="mouseover"+G,U="mouseout"+G,q="mousewheel",Y="inline-block",X="content-box",Z="DOMMouseScroll",Q="scroll"+G,function(t){t[t.horizontalScroll=0]="horizontalScroll",t[t.verticalScroll=1]="verticalScroll"}(J||(J={})),$=function(){function t(t,e,n,o,r,i,s,l,c){this.updateStateFn=c;var f=this;f.jec=l,f.JB=!1,f.KB=!1,f.LB=u,f.MB=u,f.NB=300,f.OB=70,f.PB=t,f.Jwa(a.ScrollbarState.show),f.Vo("number"==typeof e?e:0),f._v("number"==typeof n?n:0),f.dw("number"==typeof o?o:0),f.cw("number"==typeof r?r:0),f.bw("number"==typeof i?i:0),f.QB="number"==typeof s?s:1,f.RB=!1,f.SB=0,f.Qb=f.bw(),f.ew()}return t.prototype.Bv=function(){return this.TB},t.prototype.Jwa=function(t){t===a.ScrollbarState.unactive&&this.JB||(this.iec=t,this.updateStateFn&&this.updateStateFn())},t.prototype.value=function(t){var e,n=this;return 0===arguments.length?n.Qb:("number"==typeof t&&t<=n.cw()&&t>=n.bw()&&(n.Qb=t,e=(t-n.bw())*n.UB,n.scrollTo(e,!0)),n)},t.prototype.ew=function(){var t,e,n,r=this,i=0,s=0,l=!1,u=r.jec===a.ScrollbarAppearance.mobile,c=u?0:2,f=r._v(),p=r.Vo(),d=u?0:f,g=p-2*d,y=d,T=R,I=k,G="gc-scroll-arrowLeft",H="gc-scroll-arrowRight",V="gc-scrollbar-horizontal",z="margin-left",W="ui-button ui-state-default ui-corner-bl btn btn-default",U="ui-icon ui-icon-triangle-1-w",q="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",Z="ui-icon ui-icon-grip-solid-vertical",Q="ui-button ui-state-default ui-corner-br btn btn-default",J="ui-icon ui-icon-triangle-1-e";r.VB=g,r.PB||(g=d=u?0:p,y=f-2*d,T=M,I=N,G="gc-scroll-arrowUp",H="gc-scroll-arrowDown",V="gc-scrollbar-vertical",z="margin-top",W="ui-button ui-state-default ui-corner-tr btn btn-default",U="ui-icon ui-icon-triangle-1-n",q="gc-scroll-handle ui-button ui-state-default ui-corner-all ui-draggable btn btn-default",Z="ui-icon ui-icon-grip-solid-horizontal",Q="ui-button ui-state-default ui-corner-br btn btn-default",J="ui-icon ui-icon-triangle-1-s",r.VB=y),t=r.VB,e=r.cw()-r.bw(),r.dC=r.dw()*t/(e+r.dw()),r.dC>t&&(r.dC=t),r.dC<10&&(r.dC=10),n=r.dC,r.UB=0===e?1:(t-n)/e,r.PB?(i=n,s=d):(i=d,s=n),r.WB||(l=!0,r.TB=h("div"),r.WB=o.GC$(r.TB),r.WB.css([E,R,M,F,"outline",O,j],["relative",0,0,"hidden","none",0,0]).addClass("gc-scroll-container gc-scroll-corner-all ui-widget ui-corner-all ")),u?r.WB.addClass(b):r.WB.removeClass(b),r.XB||function(t){r.XB=o.GC$.Nl("div",[E,P,L,O,j,B],["absolute",Y,"1px",0,0,X],v+" "+W,t),r.YB=o.GC$.Nl("span",[P,D,O,j],["block","none",0,0],G+" "+U,r.XB)}(r.WB),r.ZB||function(t){r.ZB=o.GC$.Nl("div",[E,P,B,D,O,j],["absolute",Y,X,"none",0,0],C+" "+C,t)}(r.WB),r.$B?r.$B.removeAttr("style"):function(t){r.$B=o.GC$.Nl("div",[],[],x+" "+q+" gc-scroll-bar",t),r._B=o.GC$.Nl("span",[P,D,O,j],["block","none",0,0],V+" "+Z,r.$B)}(r.ZB),u?r.$B.css(E,"absolute").addClass(w):r.$B.css([E,L,O,j,B],["absolute","1px",0,0,X]).removeClass(w),r.aC||function(t){r.aC=o.GC$.Nl("div",[E,P,L,O,j,B],["absolute",Y,"1px",0,0,X],v+" "+Q,t),r.bC=o.GC$.Nl("span",[P,D,O,j],["block","none",0,0],H+" "+J,r.aC)}(r.WB),u?(function(t,e){var n=t.get(0);n&&(n.style[e]="")}(r.WB,"border"),r.PB?(r.WB.css([S,A],[_,_]),r.ZB.css([T,S,A],[d,_,_]),r.$B.css([T,S,A],[r.SB,m(i-c),_])):(r.WB.css([S,A],[_,_]),r.ZB.css([T,S,A],[d,_,_]),r.$B.css([T,S,A],[r.SB,_,m(s-c)])),r._B.remove(),r.XB.remove(),r.aC.remove()):(r.WB.css([S,A,D],[p,f,"none"]),r.ZB.css([T,S,A],[d,g,y]),r.$B.css([T,S,A],[r.SB,m(i-c),m(s-c)]),r.XB.css([T,S,A],[0,d-c,d-c]),r.YB.css([S,A],[_,_]),r.aC.css([I,S,A],[0,d-c,d-c]),r.bC.css([S,A],[_,_]),r._B.css([S,A,z],[d-c,d-c,Math.floor((r.dC-d)/2)]),r.$B.append(r._B),r.WB.append(r.XB),r.WB.append(r.aC)),l&&r.eC()},t.prototype.eC=function(){var e=this;function n(t,n){t.bind(H,(function(t){e.fC(t,n)})).bind(V,(function(t){e.gC(t,n)})).bind(W,(function(t){e.hC(t,n)})).bind(U,(function(t){e.iC(t,n)}))}n(e.XB,!0),n(e.aC,!1),e.$B.bind(H,(function(t){e.jC(t)})).bind(z,(function(t){e.kC(t)})).bind(V,(function(t){e.lC(t)})).bind(W,(function(t){e.mC(t)})).bind(U,(function(t){e.nC(t)})),e.ZB.bind(H,(function(t){var n,o;c&&c.mozilla&&(n=(new Date).valueOf(),o=e.oC,e.oC=n,o&&n-o<100)||e.pC(t)})).bind(V,(function(t){e.qC(t)})),e.GB=function(t){e.sC(t)},e.WB.bind(q,e.GB),e.WB.bind(Z,e.GB),t.ao(e,"initEvents",e.TB)},t.prototype.$dc=function(t){this.jec=t},t.prototype.dispose=function(){var e=this;function n(t){t&&t.unbind(G)}n(e.aC),n(e.$B),n(e.XB),n(e.ZB),e.WB&&(e.GB&&(e.WB.unbind(q,e.GB),e.WB.unbind(Z,e.GB)),t.ao(e,"dispose",e.TB),e.WB.unbind(G).remove())},t.prototype.tC=function(){var t=this;t.RB||(o.GC$(d).bind(z,(function(e){t.kC(e)})).bind(V,(function(e){t.lC(e)})),t.RB=!0)},t.prototype.uC=function(){this.RB&&(this.RB=!1,o.GC$(d).unbind(z).unbind(V))},t.prototype.fC=function(t,e){var n,o=0,r=this,i=!0;r.KB=!0,null===r.LB&&(e?(r.XB.addClass(I),o=0-r.qB(),r.vC=a.Nxb.smallDecrement):(r.aC.addClass(I),o=r.qB(),r.vC=1),(n=function(){r.scrollTo(r.SB+o*r.UB,!1),r.LB=g.setTimeout(n,i?r.NB:r.OB),i=!1})(),nt(t))},t.prototype.gC=function(t,e){var n=this;(e?n.XB:n.aC).removeClass(I),n.wC(),nt(t)},t.prototype.hC=function(t,e){(e?this.XB:this.aC).addClass("gc-scroll-arrow-hover ui-state-hover"),nt(t)},t.prototype.iC=function(t,e){var n=this;(e?n.XB:n.aC).removeClass("gc-scroll-arrow-hover ui-state-hover "+I),n.wC(),nt(t)},t.prototype.jC=function(t){var e,n,o,r,i,s,l=this;0===t.button&&(l.JB=!0,l.xC={x:t.pageX,y:t.pageY},l.Jwa(a.ScrollbarState.show),l.tC(),l.WB.addClass(T),l.$B.addClass(I),e=l.$B.offset(),n=l.$B.outerWidth(!0),o=l.$B.outerHeight(!0),r=l.ZB.offset(),i=l.ZB.outerWidth(!0),s=l.ZB.outerHeight(!0),l.yC={isBeyondEdge:!1,startEdgePosition:{x:r.left+t.pageX-e.left,y:r.top+t.pageY-e.top},endEdgePosition:{x:r.left+i-(n-t.pageX+e.left),y:r.top+s-(o-t.pageY+e.top)}}),nt(t)},t.prototype.kC=function(t){var e=this;e.JB&&(e.Jwa(a.ScrollbarState.active),e.zC={x:t.pageX,y:t.pageY},e.AC(),e.xC=e.zC,o.GC$(d.body).attr("unselectable","on").addClass(x)),nt(t)},t.prototype.lC=function(t){var e,n,r,i=this;i.JB=!1,i.vC=a.Nxb.thumbPosition,i.yC=null,i.WB.trigger(Q,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?J.horizontalScroll:J.verticalScroll,scrollEventType:i.vC}),e=(i.Qb-i.bw())*i.UB,n="left",r=t.target.classList.contains(w),i.PB||(n="top"),r?i.Jwa(a.ScrollbarState.hide):i.Jwa(a.ScrollbarState.unactive),i.SB=e,i.$B.css(n,m(e)),i.uC(),o.GC$(d.body).removeClass(x),o.GC$(d.body).attr("unselectable")&&o.GC$(d.body).removeAttr("unselectable"),i.$B.removeClass(I),i.WB.removeClass(T),i.vC=6,i.WB.trigger(Q,{newValue:i.Qb,oldValue:i.Qb,scrollOrientation:i.PB?J.horizontalScroll:J.verticalScroll,scrollEventType:i.vC}),nt(t)},t.prototype.mC=function(t){this.$B.addClass("gc-scrollbar-stateHover ui-state-hover"),nt(t)},t.prototype.nC=function(t){this.$B.removeClass("gc-scrollbar-stateHover ui-state-hover"),nt(t)},t.prototype.sC=function(t){var e,n,o=this;l(t.wheelDelta)&&l(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=(t.detail?t.detail:t.wheelDelta/-40)/3*o.qB()*o.UB,o.vC=e>=0?1:0,o.scrollTo(o.SB+e,!1),o.vC=6,n={newValue:o.Qb,oldValue:o.Qb,scrollOrientation:o.PB?J.horizontalScroll:J.verticalScroll,scrollEventType:o.vC},o.WB.trigger(Q,n),nt(t)},t.prototype.pC=function(t){var e,n=this,o=!0,r=t.pageX,i=t.pageY,s=0,l=n.ZB.offset(),u=n.rB();null===n.MB&&(s=n.PB?r-l.left-n.SB:i-l.top-n.SB,(e=function(){var t,c=n.SB;if((t=n.PB?r-l.left-c:i-l.top-c)*s<0||t>=0&&t<n.dC)n.CC();else{if(s<0)n.vC=a.Nxb.largeDecrement,n.scrollTo(c-u*n.UB,!1);else{if(!(s>0))return void n.CC();n.vC=a.Nxb.largeIncrement,n.scrollTo(c+u*n.UB,!1)}1===n.QB&&(n.MB=g.setTimeout(e,o?n.NB:n.OB)),o=!1}})(),nt(t))},t.prototype.qC=function(t){this.CC(),nt(t)},t.prototype.CC=function(){var t,e=this;e.MB&&clearTimeout(e.MB),e.MB=u,e.vC=a.Nxb.endScroll,t={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?J.horizontalScroll:J.verticalScroll,scrollEventType:e.vC},e.WB.trigger(Q,t)},t.prototype.wC=function(){var t,e=this;e.KB&&(e.KB=!1,e.LB&&clearTimeout(e.LB),e.LB=u,e.vC=6,t={newValue:e.Qb,oldValue:e.Qb,scrollOrientation:e.PB?J.horizontalScroll:J.verticalScroll,scrollEventType:e.vC},e.WB.trigger(Q,t))},t.prototype.AC=function(){var t,e,n,o,r,i=this,a=i.SB,s=i.zC,l=i.yC;function u(t){return i.PB?t.x:t.y}function c(t,e){i.PB?t.x=e:t.y=e}if(t=u(s),e=u(i.xC),l&&l.isBeyondEdge){if(n=u(l.startEdgePosition),o=u(l.endEdgePosition),t<n||t>o)return;e<n&&c(i.xC,n),e>o&&c(i.xC,o)}(r=a+(t-e))!==a&&(i.vC=5,i.scrollTo(r,!1))},t.prototype.scrollTo=function(t,e){var n,o,r,i,s,u,c,f,h=this,p=M,d=h.VB-h.dC;h.PB&&(p=R),n=!1,o=!1,r=!1,t>d&&(t=d,r=!0,o=!0),t<0&&(t=0,r=!0,n=!0),h.yC&&(h.yC.isBeyondEdge=r),i=h.QB===a.ScrollType.continuous?m(t/h.UB)+h.bw():t/h.UB+h.bw(),s=h.Qb,u=!1,e||(f={newValue:i,oldValue:s,scrollOrientation:h.PB?J.horizontalScroll:J.verticalScroll,scrollEventType:h.vC,isBeyondMaxEdge:o,isBeyondMinEdge:n},h.WB.trigger(Q,f),u=f.ignoreUpdatePosition,f.newValue>h.cw()&&(f.newValue=h.cw()),i=f.newValue,c=f.newValueWithOffset),l(c)&&(c=i),h.Qb=i,5!==h.vC&&(t=(c-h.bw())*h.UB),h.SB=t,u||h.$B.css(p,m(t))},t.prototype.hitTest=function(t,e){var n,r,i,s,l=this,u=l.$B.outerWidth(),c=l.XB.outerWidth(),f=l.ZB.outerWidth(),h=l.$B.offset(),p=o.GC$(l.Bv()).offset(),d=h.left-p.left-18;return l.PB?t<0+f+c&&t>0+c?t<0+d+u+c&&t>d?{element:a.Oxb.ThumbButton,x:t,y:e}:{element:a.Oxb.TrackButton}:t<=0+c&&t>0?{element:a.Oxb.LeftButton,x:t,y:e}:{element:a.Oxb.RightButton,x:t,y:e}:(n=l.$B.outerHeight(),r=l.XB.outerHeight(),i=l.ZB.outerHeight(),s=h.top-p.top-18,e<0+i+r&&e>0+r?e<0+s+n+r&&e>s?{element:a.Oxb.ThumbButton,x:t,y:e}:{element:a.Oxb.TrackButton}:e<=0+r&&e>0?{element:a.Oxb.UpButton,x:t,y:e}:{element:a.Oxb.DownButton,x:t,y:e})},t.prototype.pia=function(){return{x:0,y:0,width:this.Vo(),height:this._v()}},t.prototype.show=function(){this.ZB.show()},t.prototype.hide=function(){this.ZB.hide()},t.prototype.wDc=function(t){var e=this.WB.parent()&&this.WB.parent().parent();return e?t?e.height():e.width():u},t}(),e.hv=$,r.Zn($),(K=$.prototype).qB=p("smallChange",1),K.rB=p("largeChange",10),K.dw=p("pageValue",10,(function(t){t<=0&&this.dw(1)})),K.cw=p("maximum",100,(function(t){t<=0&&this.cw(0)})),K.bw=p("minimum",0,(function(t){t<=0&&this.bw(0)})),K.Vo=p("width",0),K._v=p("height",0),tt=function(){function t(t,e){var n=this;n.fB=!0,n.gB=!0,n.hB=18,n.iB=t&&o.GC$(t),n.jB=e&&o.GC$(e),n.ew(!0)}return t.prototype.ew=function(t){var e,n,r,i,a,s,l,f,h,p,d,g=this;function v(){return o.GC$.Nl("div",[E,R,M,D,O,j],["absolute",0,0,"none",0,0])}function C(t,e){var n,r,i,a=e?g.mB:g.nB;return a||(n=new $(e),r=o.GC$.Nl("div"),e?(g.oB=r,g.mB=n,r.css([E,R,N,D,O,j],["absolute",0,0,"none",0,0])):(g.pB=r,g.nB=n,r.css([E,k,M,D,O,j],["absolute",0,0,"none",0,0])),i=(e?g.mB:g.nB).Bv(),r.append(i),t.append(r),n)}function b(t,e,n,r,i,a){a?(g.oB.css([S,A],[e,r]),t.Vo(e),t._v(r)):(g.pB.css([S,A],[r,e]),t.Vo(r),t._v(e)),t.bw(0),t.cw(i-e),t.dw(e),t.qB(a?g.kB():g.lB()),t.rB(e),t.ew(),o.GC$(t.Bv()).bind(Q,(function(t,e){n.css(a?R:M,0-e.newValue)})),a?g.oB.show():g.pB.show()}g.iB&&g.jB&&(e=g.hB,n=g.jB.width(),r=g.jB.height(),s=(i=g.iB.width())-e,l=(a=g.iB.height())-e,f=!1,g.uB||(g.uB=v(),g.uB.css([E,F],["relative","hidden"]),f=!0),g.uB.css([S,A],[i,a]),function(t){g.sB||(g.sB=v(),g.sB.css([F,P],["hidden",Y]),t.append(g.sB))}(g.uB),function(t){g.tB||(g.tB=o.GC$.Nl("div",E,"relative",u,t))}(g.sB),t&&g.tB.append(g.jB).css([M,R],[0,0]),c.chrome&&(n=m(n),r=m(r),i=y(i),a=y(a)),p=(h=g.vB(n,r,i,a)).wB,(d=h.xB)?(p||(s+=e),b(C(g.uB,!0),s,g.tB,e,n,!0)):g.oB&&g.oB.hide(),p?(d||(l+=e),b(C(g.uB,!1),l,g.tB,e,r,!1)):g.pB&&g.pB.hide(),d||p||(s+=e,l+=e),g.fB=d,g.gB=p,g.yB=s,g.zB=l,g.sB.css([S,A],[s,l]),f&&(g.iB.append(g.uB),g.AB()))},t.prototype.BB=function(t){var e=this,n=e.CB(t),o=n.EB,r=n.FB;!l(o)&&e.mB&&e.lu(o),!l(r)&&e.nB&&e.ju(r)},t.prototype.lu=function(t){var e,n,o=this;o.mB.value(t),e=o.yB,n=o.jB.width(),t>=0&&t<=n-e&&o.tB.css(R,0-t)},t.prototype.ju=function(t){var e,n,o=this;o.nB.value(t),e=o.zB,n=o.jB.height(),t>=0&&t<=n-e&&o.tB.css(M,0-t)},t.prototype.vB=function(t,e,n,o){var r=this.hB,i=n-r,a=o-r,s={xB:!1,wB:!1};return t>n&&(s.xB=!0,s.wB=e>a),e>o&&(s.wB=!0,s.xB=t>i),s},t.prototype.CB=function(t){var e,n,r,i,a,s,l,c=o.GC$(t),f=this.sB,h=this.tB,p={EB:u,FB:u};return t?(e=c.offset(),n=h.offset(),r=f.offset(),e.leftWidth=e.left+c.outerWidth(),e.topHeight=e.top+c.outerHeight(),r.leftWidth=r.left+f.outerWidth(),r.topHeight=r.top+f.outerHeight(),i=e.left-n.left,e.left<r.left?p.EB=i:e.leftWidth>r.leftWidth&&(a=e.leftWidth-n.left-f.innerWidth(),p.EB=i<a?i:a),s=e.top-n.top,e.top<r.top?p.FB=s:e.topHeight>r.topHeight&&(l=e.topHeight-n.top-f.innerHeight(),p.FB=s<l?s:l),p):p},t.prototype.AB=function(){var t=this;this.tB&&(t.GB=function(e){t.HB(e)},t.tB.bind(q,t.GB),t.tB.bind(Z,t.GB))},t.prototype.HB=function(t){var e,n,o,r,i,a,s=this;l(t.wheelDelta)&&l(t.detail)&&(t.wheelDelta=t.originalEvent.wheelDelta,t.detail=t.originalEvent.detail),e=t.detail?t.detail:t.wheelDelta/-40,n=s.nB,o=parseInt(s.tB.css(M),10),r=s.zB,(i=s.jB.height())<r&&(i=r),isNaN(o)&&(o=0),(a=o-e*s.lB())>=0&&(a=0),a<0&&0-a>i-r&&(a=0-(i-r)),a!==o&&(s.tB.css(M,a),s.gB&&n.value(0-a)),f(t)},t.prototype.dispose=function(){var t=this;t.uB&&(t.mB&&t.mB.dispose(),t.nB&&t.nB.dispose(),t.tB&&t.GB&&(t.tB.unbind(q,t.GB),t.tB.unbind(Z,t.GB)),o.GC$(t.uB).remove())},t}(),e.IB=tt,(et=tt.prototype).kB=p("horizontalSmallChange",10),et.lB=p("verticalSmallChange",10),s.DC.$n("scrollbar",{preProcessMouseMove:function(t){var e=this.OC;(e.St.JB||e.Pt.JB)&&(t.r=!0)}})},"./dist/core/worksheet/clipboardhelper.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;function g(t){return t&&t.options.allowCopyPasteExcelStyle}function m(t,e){var n,o;if(c.msie){for(n=[],o=0;o<t.length;o++)e&&""===t[o].trim()||n.push(t[o]);return n.join("")}return t.join("")}function y(t,e,n,o){var r,i,a=[];for(r=0,i=n;r<i;r++)a[r]=t.getRowHeight(e+r,o);return a}function v(t,e,n,o){var r,i,a=[];for(r=0,i=n;r<i;r++)a[r]=t.getColumnWidth(e+r,o);return a}function C(t,e,n){var o,r=-1;if(n)for(r=0,o=0;o<e;o++)r+=n[t+o]||0;return r}function b(t,e,n){var o,r=-1;if(n)for(r=0,o=0;o<e;o++)r+=n[t+o]||0;return r}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/util/common.js"),r=n("Common"),i=n("./dist/core/worksheet/stylehelper.js"),a=n("./dist/core/worksheet/style.js"),s=n("./dist/core/core.enum.js"),l=r.Common.u,u=/<img[^>]+>/g,c=o.Ul.Ml,f=r.Common.j.Fa,h=r.Common.k.Bb,p=null,d=function(){function t(t){var e=this;e.PA=p,e.n5=p,e.G4=!1,e.tc=t,e.Nl()}return t.prototype.Nl=function(){var e,n,o,r=this,i=document.createElement("div");i.style.position="fixed",i.style.top="0px",i.style.left="0px",i.style.width="0px",i.style.height="0px",i.style.overflow="hidden",(e=document.createElement("div")).setAttribute("contenteditable","true"),e.setAttribute("gcUIElement","gcSheetClipboard"),e.setAttribute("tabindex","-1"),e.style.position="absolute",e.style.overflow="hidden",e.style.background="white",e.style.webkitUserSelect="text",i.appendChild(e),r.KM=e,(n=document.createElement("textarea")).setAttribute("gcUIElement","gcSheetClipboard"),r.tc&&r.tc.options.enableAccessibility&&n.setAttribute("aria-hidden","true"),n.setAttribute("tabindex","-1"),n.style.position="absolute",n.style.overflow="hidden",n.style.background="white",n.style.webkitUserSelect="text",i.appendChild(n),r.qka=n,(o=r.tc.getHost())&&o.appendChild(i),c.msie||c.edge||(r.H4=function(e){var n,o,i,a,s,l,c,f=r.tc.getActiveSheet(),h=e.clipboardData;if(h)if(n=(n=h.getData("text/html")).replace(u,""),(o=r.I4()).innerHTML=n,i=n?r.EZa(o,!0):t.formatClipboardData(h.getData("text/plain")),o.innerHTML="",i||n)f.J4(i,n);else{for(a=void 0,s=h.items,l=0;l<s.length;l++)if(0===s[l].type.indexOf("image")){a=s[l].getAsFile();break}a&&((c=new FileReader).onload=function(t){var e=new Image;e.src=t.target.result,e.onload=function(){f.J4(i,n,e.src)}},c.readAsDataURL(a))}e.preventDefault()},e.addEventListener("paste",r.H4),r.rka=function(e){var n,o,i,a=r.tc.getActiveSheet(),s=e.clipboardData;s&&((n=t.formatClipboardData(s.getData("text/plain")))||(o=s.getData("text/html"))&&((i=r.I4()).innerHTML=o,n=r.EZa(i,!1),i.innerHTML=""),a.J4(n,"")),e.preventDefault()},n.addEventListener("paste",r.rka))},t.prototype.no=function(){var t,e,n,o,r,i,a=this,s=a.KM;s&&(c.msie||c.edge||(s.removeEventListener("paste",a.H4),a.qka.removeEventListener("paste",a.rka)),(t=s.parentElement)&&((e=t.parentElement)&&e.removeChild(t)),a.KM=p,a.qka=p),(n=a.K4)&&((o=n.parentElement)&&o.removeChild(n),a.K4=p),(r=a.FZa)&&((i=r.parentElement)&&i.removeChild(r),a.FZa=p),a.tc=p},t.prototype.ska=function(t){g(this.tc)?this.KM.innerHTML=t:this.qka.value=t},t.prototype.M4=function(){g(this.tc)?this.KM.focus():this.qka.focus()},t.prototype.N4=function(){g(this.tc)?document.execCommand("selectAll"):this.qka.select()},t.prototype.wx=function(){var e,n,o,r="",i="",a="";return g(this.tc)?((e=this.KM)&&((n=e.getElementsByTagName("table")).length>0?r=n[0].outerHTML:(o=e.getElementsByTagName("img")).length>0&&(a=o[0].src)),i=this.EZa(this.KM,!0)):i=t.formatClipboardData(this.qka.value),{html:r,text:i,image:a}},t.Q4=function(e,n,r,i,a,l,u,c,f,h,d,g,m,C){var b,w,T,x,S,A,I,R,k,M,N,E=e.Tq(o.kf(r,a,i,l),u),D=RegExp(String.fromCharCode(32),"g"),O="&nbsp;",j=!1,F=!1;return u===s.SheetArea.viewport&&(r<0&&2==(2&n)&&(j=!0),a<0&&1==(1&n)&&(F=!0)),r=E.row,a=E.col,i=E.rowCount,l=E.colCount,b=d?e.options.gridline:p,w=d?{color:"#d4d4d4",showHorizontalGridline:!0,showVerticalGridline:!0}:p,T=m?y(e,r,i,u):p,x=m?v(e,a,l,u):p,u===s.SheetArea.viewport?(S=void 0,A=void 0,I=p,R=p,k=t.Ema(e,r,i,a,l,3,f,h,c,E,D,O,b,g,T,x,C),F&&(S=m?v(e,a,l,2):p,M=e.getColumnCount(2),I=t.Ema(e,r,i,0,M,2,f,[],c,E,D,O,w,g,T,S,C)),j&&(A=m?y(e,r,i,1):p,N=e.getRowCount(1),R=t.Ema(e,0,N,a,l,1,[],h,c,E,D,O,w,g,A,x,C)),t.yb(k,I,R,C)):u===s.SheetArea.rowHeader?(I=t.Ema(e,r,i,a,l,2,f,h,c,E,D,O,w,g,T,x,C),t.yb(I,p,p,C)):u===s.SheetArea.colHeader?(R=t.Ema(e,r,i,a,l,1,f,h,c,E,D,O,w,g,T,x,C),t.yb(R,p,p,C)):void 0},t.yb=function(e,n,o,r){var i,a=e,s=0,l=function(t,e){var n,o=[],r=t.length;for(n=0;n<r;n++)o.push(t[n].concat(e[n]));return o};return n&&(s=n[0].length,a=l(n,e)),o&&(i=o.length,s&&(o=l(t.Ema(p,0,i,0,s,p,[],[],!1,p,p,p,p,!1,[],[],r),o)),a=o.concat(a)),t.Fma(a,r)},t.Fma=function(t,e){var n,o,r="",i=t.length;for(r+=e?'<table style="border-collapse: collapse">':"<table>",n=0;n<i;n++){for(r+="<tr>",o=0;o<t[n].length;o++)r+=t[n][o];r+="</tr>"}return r+"</table>"},t.Ema=function(e,n,r,i,a,s,u,d,g,m,y,v,w,T,x,S,A){var I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st;for(w&&(I=w.color,R=w.showHorizontalGridline,k=w.showVerticalGridline),M=[],N=0;N<r;N++)if(!h(u,E=n+N)){for(D=[],O=0;O<a;O++)h(d,j=i+O)||(F="",P=void 0,_=void 0,L=1,B=1,g&&e&&((P=e.getSpan(E,j,s))&&t.isPartSpan(P,m,u,d)&&(P=p),P&&(P.row!==E||P.col!==j))||(F+="<td",G=e&&e.getValue(E,j,s),g&&e&&(P&&((L=P.rowCount)>1&&(F+=" rowSpan="+L),(B=P.colCount)>1&&(F+=" colSpan="+B)),_=e.getActualStyle(E,j,s),H=t.convertVAlign,V=t.convertHAlign,z=t.convertLineBorder,F+=A?' style="padding: 0; word-break: break-all; ':' style="',W=R,U=k,(q=_.backColor)&&(F+="background-color: "+q+";",W=!1,U=!1),(Y=_.foreColor)&&(F+="color: "+Y+";"),(X=_.font)&&(T&&(X=X+", "+o.FallbackFontFamily),F+="font: "+X.replace(/"/g,"'")+";"),Z=_.vAlign,f(Z)||(F+="vertical-align: "+H(Z)+";"),Q=_.hAlign,f(Q)||(A&&(Q=o.Ul.ol(Q,G)),(J=V(Q))&&(F+="text-align: "+J+";")),($=_.borderLeft)&&(F+="border-left: "+z($)+";",U=!1),(K=_.borderRight)&&(F+="border-right: "+z(K)+";",U=!1),(tt=_.borderTop)&&(F+="border-top: "+z(tt)+";",W=!1),(et=_.borderBottom)&&(F+="border-bottom: "+z(et)+";",W=!1),W&&U?F+="border: 1px solid "+I+";":W?(F+="border-top: 1px solid "+I+";",F+="border-bottom: 1px solid "+I+";"):U&&(F+="border-left: 1px solid "+I+";",F+="border-right: 1px solid "+I+";"),F+='"'),F+=">",nt=void 0,ot=void 0,g&&e&&((ot=1==(1&(rt=_.textDecoration)))||(ot=8==(8&rt)),(nt=2==(2&rt))&&(F+="<s>"),ot&&(F+="<u>")),(it=e?e.getText(E,j,s):"")?(" "!==it[0]&&" "!==it[it.length-1]||"number"!=typeof G||(it=it.trim()),it=l.Ob(it).replace(y,v)):c.chrome?it=" ":c.safari&&(it="&nbsp;"),(at=C(N,L,x))>0&&(at-=1),(st=b(O,B,S))>0&&(st-=1),F+=at>=0&&st>=0?'<div style="overflow: hidden; height: '+at+"px; width: "+st+'px;">'+it+"</div>":it,g&&(ot&&(F+="</u>"),nt&&(F+="</s>")),F+="</td>",D.push(F)));M.push(D)}return M},t.prototype.I4=function(){var t,e,n=this;return n.K4||((t=document.createElement("div")).style.display="none",(e=n.tc.getHost())&&e.appendChild(t),n.K4=t),n.K4},t.prototype.GZa=function(){var t,e,n=this;return n.FZa||((t=document.createElement("div")).style.display="none",(e=n.tc.getHost())&&e.appendChild(t),n.FZa=t),n.FZa},t.prototype.R4=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g=this.I4();if(g.innerHTML=t,(r=g.getElementsByTagName("table")).length>0)for(i=this.HZa(r[0],!0),a=0;a<i.length;a++)for(s=i[a],l=n+a,u=0;u<s.length;u++)(c=s[u])&&(f=o+u,e.Pq(l,f,c.style),h=c.rowSpan,p=c.colSpan,(h>1||p>1)&&((d=e.getSpan(l,f))?(d.row=l,d.col=f,d.rowCount=h,d.colCount=p):e.addSpan(l,f,h,p)));g.innerHTML=""},t.prototype.lgc=function(t,e,n,o){var r,i,a=e.pictures;a&&(r=function(t){for(var e="picture",n=1,o=e+""+n;t.get(o);)o=e+""+ ++n;return o}(a),(i=a.add(r,t,0,0)).startRow(n),i.startColumn(o))},t.prototype.HZa=function(e,n){var o,r,i,a,s,l,u,c,f,h,p,d=this.GZa(),g=[],m=/ +/g;for(o=0;o<e.rows.length;o++)for(r=e.rows[o],g[o]||(g[o]=[]),i=g[o],a=0,s=0;a<r.cells.length;a++){for(l=r.cells[a];i[s];)s++;for(u=i[s]={},c=void 0,n&&(c=t.getStyleFromDOM(l),u.style=c),d.innerHTML=l.innerHTML.replace(m," "),u.text=d.innerText,u.rowSpan=l.rowSpan,(f=l.getAttribute("style"))&&f.indexOf("mso-ignore:colspan;")>=0?u.colSpan=1:u.colSpan=l.colSpan,h=0;h<l.rowSpan;h++)for(p=0;p<l.colSpan;p++)0===h&&0===p||(g[o+h]||(g[o+h]=[]),g[o+h][s+p]={style:c,text:"",rowSpan:1,colSpan:1});s+=l.colSpan}return d.innerHTML="",g},t.prototype.EZa=function(t,e){var n,o,r,i,a,s,l,u,c,f,h=[];if(t)if((n=t.getElementsByTagName("table")).length>0)for(o=this.HZa(n[0],!1),r=RegExp(String.fromCharCode(160),"g"),i=String.fromCharCode(32),a=0,s=o.length;a<s;a++){for(u=0,c=(l=o[a]).length;u<c;u++)(f=l[u]?l[u].text:"").indexOf("\n")>=0&&(e?(f.indexOf("\r\n")>=0&&(f=m(f.split("\r\n"),!0)),f=m(f.split("\n"),!0)):f='"'+f+'"'),h.push(f.replace(r,i)),u<c-1&&h.push("\t");a<s-1&&h.push("\r\n")}else h.push(function(t){var e,n,o;if(!t)return t;for(e=0;e<t.length&&!((n=t.indexOf("\x3c!--",e))<0)&&(e=n,!((o=t.indexOf("--\x3e",e))<0));)e=o,t=t.substring(0,n)+t.substring(o+3);return t}(t.innerText).trim());return h.join("")},t.prototype.hZ=function(t){var e=this;e.PA=p,e.n5=p,e.G4=!1,e.tc.Wq("ClipboardStatusChanged",{isReset:!0,isSystemPasted:!!t})},t.isPartSpan=function(t,e,n,o){var r,i,a,s,l,u;if(!e.containsRange(t))return!0;for(r=0,i=n;r<i.length;r++)if(a=i[r],t.row<=a&&a<t.row+t.rowCount)return!0;for(s=0,l=o;s<l.length;s++)if(u=l[s],t.col<=u&&u<t.col+t.colCount)return!0;return!1},t.formatClipboardData=function(t){var e,n,o,r,i=[];if(t){for('"',e=!1,n=0;n<t.length;n++)o=n>0?t[n-1]:"",'"'===(r=t[n])?(e=!e,i.push('"')):e||"\n"!==r||"\r"===o?i.push(r):i.push("\r\n");return i.join("")}return""},t.convertHAlign=function(t){return{0:"left",1:"center",2:"right"}[t]},t.convertVAlign=function(t){return{0:"top",1:"middle",2:"bottom"}[t]},t.convertLineBorder=function(t){return{9:.5,1:.5,3:.5,4:.5,7:.5,11:.5,2:1,10:1,12:1,8:1,13:1,5:1.5,6:1.5}[t.style]+"pt "+{0:"none",1:"solid",2:"solid",3:"dashed",4:"dotted",5:"solid",6:"double",7:"dotted",8:"dashed",9:"dashed",10:"dashed",11:"dashed",12:"dashed",13:"dashed"}[t.style]+" "+t.color},t.convertToHAlign=function(t){return{left:0,center:1,right:2}[t]},t.convertToVAlign=function(t){return{top:0,middle:1,bottom:2}[t]},t.convertToLineBorder=function(t,e,n){var o={none:0,solid:1,dashed:3,dotted:4,double:6};return(c.msie||c.edge)&&"2px"===n?o.solid=5:(n=Math.round(10*parseFloat(n)*3/4)/10)<=.8?o.solid=1:n<=1?(o.solid=2,o.dashed=8):n<=1.5&&(o.solid=5),new a.LineBorder(t,o[e])},t.convertToTextDecoration=function(t){return{underline:1,"line-through":2,none:0}[t]},t.isTransparent=function(t){return 0===r.Common.pc.ec(t).a},t.isBlack=function(t){var e=r.Common.pc.ec(t);return 0!==e.a&&0===e.r&&0===e.g&&0===e.b},t.getStyleFromDOM=function(e){var n,o,r,s,l,u,f,h,p,d,g,m,y,v,C=e.getElementsByTagName("font")[0],b=getComputedStyle(e),w=e.style,T=new a.Style,x=b.backgroundColor;return x&&!t.isTransparent(x)&&(T.backColor=x),n=b.color,C&&(n=C.color),n&&!t.isBlack(n)&&(T.foreColor=n),C?T.font=i.To.F4(getComputedStyle(C)):(o=i.To.F4(b))&&(T.font=o),r=b.verticalAlign,s=t.convertToVAlign,l=t.convertToHAlign,u=t.convertToLineBorder,f=t.convertToTextDecoration,r&&(T.vAlign=s(r)),h=w.textAlign,p=b.textAlign,c.msie||c.edge?T.hAlign=l(""!==h?h:"general"):p&&(T.hAlign=l(p)),"none"!==(d=b.borderLeftStyle)&&(T.borderLeft=u(b.borderLeftColor,d,b.borderLeftWidth)),"none"!==(g=b.borderRightStyle)&&(T.borderRight=u(b.borderRightColor,g,b.borderRightWidth)),"none"!==(m=b.borderTopStyle)&&(T.borderTop=u(b.borderTopColor,m,b.borderTopWidth)),"none"!==(y=b.borderBottomStyle)&&(T.borderBottom=u(b.borderBottomColor,y,b.borderBottomWidth)),v=f(b.textDecorationLine||b.textDecoration),e.getElementsByTagName("u").length>0&&(v|=f("underline")),e.getElementsByTagName("s").length>0&&(v|=f("line-through")),0!==v&&(T.textDecoration=v),T},t}(),e.S4=d},"./dist/core/worksheet/style.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S;function A(t,e,n,o){var r,a,l,u=e;if(n&&e){if(e.gQa&&e.gQa())return void(t.cellType=u);e.toJSON&&(e=e.toJSON()),r=s._o,a=e.typeName,(l=r[e.type]||r[a]||i.getTypeFromString(a))?(u=new l).fromJSON(e,o):u=h}t.cellType=u}function I(t,e,n){var r,a,s,l,u=e;n&&e&&"object"==typeof e&&(e.toJSON&&(e=e.toJSON()),(a=(r=o.Formatter)&&r.GeneralFormatter)&&((s=e.typeName)?(l=i.getTypeFromString(s))&&(u=new l).fromJSON(e):u=new a(e.formatCached,e.customerCultureName))),t.formatter=u}function R(t,e,n){var r,i,a=e;n&&e&&(e.toJSON&&(e=e.toJSON()),(i=(r=o.Formatter)&&r.GeneralFormatter)&&((a=new i(e.formatCached,e.customerCultureName)).isAuto=!0)),t._autoFormatter=a}function k(t,e,n){e&&((e=t.getColor(e))&&n(e))}function M(t,e,n){return t===g?2===n||1===n?1===e:3===e:t===m?2===n||1===n?1===e:0===e:t===y?1===e:t===p?e===h:void 0}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/celltype/celltype.ns.js"),l=r.GC$.each,u=i.Ul,c=u.Ol,f=o.Common.j.C4,h=void 0,Math.sin,Math.cos,Math.abs,Math.max,p="autoFormatter",d="cellType",g="hAlign",m="vAlign",y="imeMode",v="labelOptions",C="cellButtons",b="dropDowns",w={borderLeft:!0,borderRight:!0,borderTop:!0,borderBottom:!0,diagonalDown:!0,diagonalUp:!0},function(t){t[t.empty=0]="empty",t[t.thin=1]="thin",t[t.medium=2]="medium",t[t.dashed=3]="dashed",t[t.dotted=4]="dotted",t[t.thick=5]="thick",t[t.double=6]="double",t[t.hair=7]="hair",t[t.mediumDashed=8]="mediumDashed",t[t.dashDot=9]="dashDot",t[t.mediumDashDot=10]="mediumDashDot",t[t.dashDotDot=11]="dashDotDot",t[t.mediumDashDotDot=12]="mediumDashDotDot",t[t.slantedDashDot=13]="slantedDashDot"}(e.LineStyle||(e.LineStyle={})),function(t){t[t.conditionalFormat=1]="conditionalFormat",t[t.cell=10]="cell",t[t.table=20]="table",t[t.row=30]="row",t[t.column=40]="column",t[t.sheet=50]="sheet"}(e.LineBorderComposeLevel||(e.LineBorderComposeLevel={})),T=function(){function t(t,e,n){this.color=t||"black",this.style=e||0,this.level=n}return t.prototype.Uo=function(){return new t(this.color,this.style,this.level)},t.prototype.toJSON=function(){var t={},e=this.color,n=this.style;return"black"!==e&&(t.color=e),0!==n&&(t.style=n),t},t.prototype.fromJSON=function(t,e){if(t){var n=t.color,o=t.style;c(n)&&(this.color=n),c(o)&&(this.style=o)}},t.Vo=function(t){return{9:1,1:1,3:1,4:1,7:1,11:1,2:2,10:2,12:2,8:2,13:2,5:3,6:3}[t&&t.style]||0},t}(),e.LineBorder=T,x=["backColor","foreColor",g,m,"font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage",d,"backgroundImageLayout","tabStop","textDecoration",y,"name","parentName","watermark","cellPadding",v,"quotePrefix","diagonalDown","diagonalUp","isVerticalText",C,b,"textOrientation"],S=function(){function t(){var e,n,o=this;if(o.yn=t.Wo,t.Wo++,0!==(e=arguments).length)for(n=0;n<x.length;n++)o[x[n]]=e[n]}return t.kxb=function(t,e){var n=t.parentName;n&&!e.getNamedStyle(n)&&delete t.parentName},t.prototype.Yo=function(t,e,n,o){var r,i,a,s,l,u,c,p,d,g=this,m=t.labelOptions,y=t.cellButtons;if(t.cellButtons&&t.cellButtons.length>0)for(y=[],c=0;c<t.cellButtons.length;c++)y.push(f(t.cellButtons[c]));if(p=t.dropDowns,t.dropDowns&&t.dropDowns.length>0)for(p=[],c=0;c<t.dropDowns.length;c++)p.push(f(t.dropDowns[c]));e?(g._autoFormatter=t._autoFormatter,g.backgroundImage=t.backgroundImage,g.backgroundImageLayout=t.backgroundImageLayout,g.backColor=t.backColor,g.foreColor=t.foreColor,g.hAlign=t.hAlign,g.vAlign=t.vAlign,g.font=t.font,g.themeFont=t.themeFont,g.formatter=t.formatter,g.showEllipsis=t.showEllipsis,g.THb=t.THb,r=t.borderLeft,g.borderLeft=r&&r.Uo()||r,g.borderLeft&&n&&(g.borderLeft.level=n),i=t.borderTop,g.borderTop=i&&i.Uo()||i,g.borderTop&&n&&(g.borderTop.level=n),a=t.borderRight,g.borderRight=a&&a.Uo()||a,g.borderRight&&n&&(g.borderRight.level=n),s=t.borderBottom,g.borderBottom=s&&s.Uo()||s,g.borderBottom&&n&&(g.borderBottom.level=n),l=t.diagonalDown,g.diagonalDown=l&&l.Uo()||l,g.diagonalDown&&n&&(g.diagonalDown.level=n),u=t.diagonalUp,g.diagonalUp=u&&u.Uo()||u,g.diagonalUp&&n&&(g.diagonalUp.level=n),g.locked=t.locked,g.textIndent=t.textIndent,g.wordWrap=t.wordWrap,g.shrinkToFit=t.shrinkToFit,g.cellType=t.cellType,g.name=t.name,g.parentName=t.parentName,g.tabStop=t.tabStop,g.textDecoration=t.textDecoration,g.imeMode=t.imeMode,g.watermark=t.watermark,g.cellPadding=t.cellPadding,g.isVerticalText=t.isVerticalText,g.textOrientation=t.textOrientation,m&&(g.labelOptions={alignment:m.alignment,font:m.font,foreColor:m.foreColor,visibility:m.visibility,margin:m.margin}),g.quotePrefix=t.quotePrefix,g.cellButtons=y,g.dropDowns=p):(g.backgroundImage===h&&(g.backgroundImage=t.backgroundImage),g.backgroundImageLayout===h&&(g.backgroundImageLayout=t.backgroundImageLayout),g.backColor===h&&(g.backColor=t.backColor),g.foreColor===h&&(g.foreColor=t.foreColor),g.hAlign===h&&(g.hAlign=t.hAlign),g.vAlign===h&&(g.vAlign=t.vAlign),g.themeFont===h&&g.font===h?(g.themeFont=t.themeFont,g.font=t.font):g.themeFont!==h&&g.font===h&&(g.font=t.font),g.formatter===h&&(g.formatter=t.formatter),g.showEllipsis===h&&(g.showEllipsis=t.showEllipsis),g.THb===h&&(g.THb=t.THb),g._autoFormatter===h&&(g._autoFormatter=t._autoFormatter),g.borderLeft===h&&(r=t.borderLeft,g.borderLeft=r&&r.Uo()||r,g.borderLeft&&n&&(g.borderLeft.level=n)),g.borderTop===h&&(i=t.borderTop,g.borderTop=i&&i.Uo()||i,g.borderTop&&n&&(g.borderTop.level=n)),g.borderRight===h&&(a=t.borderRight,g.borderRight=a&&a.Uo()||a,g.borderRight&&n&&(g.borderRight.level=n)),g.borderBottom===h&&(s=t.borderBottom,g.borderBottom=s&&s.Uo()||s,g.borderBottom&&n&&(g.borderBottom.level=n)),g.diagonalDown===h&&(l=t.diagonalDown,g.diagonalDown=l&&l.Uo()||l,g.diagonalDown&&n&&(g.diagonalDown.level=n)),g.diagonalUp===h&&(u=t.diagonalUp,g.diagonalUp=u&&u.Uo()||u,g.diagonalUp&&n&&(g.diagonalUp.level=n)),g.locked===h&&(g.locked=t.locked),g.textIndent===h&&(g.textIndent=t.textIndent),g.wordWrap===h&&(g.wordWrap=t.wordWrap),g.shrinkToFit===h&&(g.shrinkToFit=t.shrinkToFit),g.cellType===h&&(g.cellType=t.cellType),g.tabStop===h&&(g.tabStop=t.tabStop),g.textDecoration===h&&(g.textDecoration=t.textDecoration),g.imeMode===h&&(g.imeMode=t.imeMode),g.name===h&&(g.name=t.name),g.parentName===h&&(g.parentName=t.parentName),g.watermark===h&&(g.watermark=t.watermark),g.cellPadding===h&&(g.cellPadding=t.cellPadding),!g.labelOptions&&m&&(g.labelOptions={}),(d=g.labelOptions)&&m&&(d.alignment===h&&(d.alignment=m.alignment),d.font===h&&(d.font=m.font),d.foreColor===h&&(d.foreColor=m.foreColor),d.visibility===h&&(d.visibility=m.visibility),d.margin===h&&(d.margin=m.margin)),o||g.quotePrefix!==h||(g.quotePrefix=t.quotePrefix),g.isVerticalText===h&&(g.isVerticalText=t.isVerticalText),g.textOrientation===h&&(g.textOrientation=t.textOrientation),g.cellButtons===h&&(g.cellButtons=y),g.dropDowns===h&&(g.dropDowns=p))},t.prototype.$b=function(t){var e=this;0===arguments.length?l(x,(function(t,n){e[n]=h})):e[t]=h},t.prototype.clone=function(e){var n=this,o=n.borderLeft,r=n.borderTop,i=n.borderRight,a=n.borderBottom,s=n.diagonalDown,l=n.diagonalUp,u=new t;return u.backColor=n.backColor,u.foreColor=n.foreColor,u.hAlign=n.hAlign,u.vAlign=n.vAlign,u.font=n.font,u.themeFont=n.themeFont,u.formatter=h,u.borderLeft=o&&!e&&o.Uo()||o,u.borderTop=r&&!e&&r.Uo()||r,u.borderRight=i&&!e&&i.Uo()||i,u.borderBottom=a&&!e&&a.Uo()||a,u.locked=n.locked,u.textIndent=n.textIndent,u.wordWrap=n.wordWrap,u.shrinkToFit=n.shrinkToFit,u.backgroundImage=n.backgroundImage,u.cellType=h,u.backgroundImageLayout=n.backgroundImageLayout,u.tabStop=n.tabStop,u.textDecoration=n.textDecoration,u.imeMode=n.imeMode,u.name=n.name,u.parentName=n.parentName,u.watermark=n.watermark,u.cellPadding=n.cellPadding,u.labelOptions=n.labelOptions,u.quotePrefix=n.quotePrefix,u.diagonalDown=s&&!e&&s.Uo()||s,u.diagonalUp=l&&!e&&l.Uo()||l,u.isVerticalText=n.isVerticalText,u.showEllipsis=n.showEllipsis,u.THb=n.THb,u.textOrientation=n.textOrientation,I(u,n.formatter,!e),R(u,n._autoFormatter,!e),A(u,n.cellType,!e,!0),function(t,e,n,o){var r,i;if(e){if(r=e,n)for(r=[],i=0;i<e.length;i++)r.push(f(e[i]));t.cellButtons=r}}(u,n.cellButtons,!e),function(t,e,n,o){var r,i;if(e&&(t.dropDowns=e.slice()),e){if(r=e.slice(),n)for(r=[],i=0;i<e.length;i++)r.push(f(e[i]));t.dropDowns=r}}(u,n.dropDowns,!e),u},t.prototype.Zo=function(t){var e,n,o,r,i,s,l,u,c=this;if(t&&t.getColor){if(k(t,c.foreColor,(function(t){c.foreColor=t})),"string"==typeof(e=c.backColor))k(t,e,(function(t){c.backColor=t}));else if(e&&(e.backgroundColor&&k(t,e.backgroundColor,(function(t){e.backgroundColor=t})),e.patternColor&&k(t,e.patternColor,(function(t){e.patternColor=t})),e.stops))for(n=function(n){k(t,e.stops[n].color,(function(t){e.stops[n].color=t}))},o=0;o<e.stops.length;o++)n(o);for(i=function(e,n){var o=r[e];o&&o.color&&k(t,o.color,(function(t){o.color=t}))},o=0,s=(r=[c.borderLeft,c.borderTop,c.borderRight,c.borderBottom,c.diagonalDown,c.diagonalUp]).length;o<s;o++)i(o)}return l=c.themeFont,u=c.font,t&&t.getFont&&(l?c.font=a.To.Io(u,t.getFont(l)):u||(c.font=a.To.Io(u,t.bodyFont()))),c},t.prototype.$o=function(t){var e,n=this._autoFormatter;n&&null!==t&&((e=n.getPreferredEditingFormatter(t)).isAuto=!0,this._autoFormatter=e)},t.prototype.toJSON=function(t,e){var n,o,i={},a=this._autoFormatter;for(!c(a)||e&&M(p,a,t)||(a.toJSON&&(a=a.toJSON()),r.GC$.isEmptyObject(a)||(i[p]=a)),n=0;n<x.length;n++)a=this[o=x[n]],o!==v||r.GC$.isEmptyObject(a)?o!==b&&o!==C||r.GC$.isEmptyObject(a)?!c(a)||e&&M(o,a,t)||(i[o]=a&&a.toJSON?a.toJSON():a):i[o]=a:i[v]=a;return r.GC$.isEmptyObject(i)?h:i},t.prototype.fromJSON=function(e,n,o){var r,i,a,s,l;if(e)for(i in r=this,e)if(e.hasOwnProperty(i)){if(a=e[i],!c(a))continue;(s={p:i,v:a,r:!1}).noSchema=n,s.context=o,t.ao(r,"fromJson",s),s.r||("formatter"===i?I(r,a,!0):"autoFormatter"===i?R(r,a,!0):i===d?A(r,a,!0,n):w[i]?null===a?r[i]=null:((l=new T).fromJSON(a,n),r[i]=l):r[i]=a)}},t}(),e.Style=S,i.Zn(S),S.Wo=0},"./dist/core/worksheet/stylehelper.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function C(t){return t=a(t=t||0,0),s(t,1)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/util/common.js"),i=document,a=Math.max,s=Math.min,l=void 0,u="#FFFFFF",c="#000000",f=Math.abs,h=Math.PI,p=Math.cos,d=Math.sin,g=Math.atan,m=Math.tan,e.Ho="11pt",y={1:[[1]],2:[[1,0,1,1],[1,1,1,0]],3:[[0,1],[1,0]],4:[[0,0,1,0],[1,0,0,0]],5:[[0,0,0,0],[0,0,1,0],[0,0,0,0],[1,0,0,0]],6:[[0,0,0,0,0,0,0,0],[1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0]],7:[[0],[1],[1],[0]],8:[[1,1,0,0]],9:[[0,1,1,0],[0,0,1,1],[1,0,0,1],[1,1,0,0]],10:[[0,1,1,0],[1,1,0,0],[1,0,0,1],[0,0,1,1]],11:[[0,0,1,1],[0,0,1,1],[1,1,0,0],[1,1,0,0]],12:[[0,1,1,0],[1,1,1,1],[1,0,0,1],[1,1,1,1]],13:[[0],[1],[0],[0]],14:[[1,0,0,0]],15:[[0,1,0,0],[0,0,1,0],[0,0,0,1],[1,0,0,0]],16:[[0,0,1,0],[0,1,0,0],[1,0,0,0],[0,0,0,1]],17:[[0,0,1,0],[1,1,1,1],[0,0,1,0],[0,0,1,0]],18:[[1,0,1,0],[0,0,0,1],[1,0,1,0],[0,1,0,0]]},v=function(){function t(){}return t.Io=function(e,n){return n?t.Jo(e,n):e},t.Ko=function(e){var n,o;return e?((n=t.Lo()).style.font=e,{fontFamily:(o=n.style).fontFamily,fontSize:o.fontSize,fontStyle:o.fontStyle,fontWeight:o.fontWeight}):{}},t.F4=function(t){var e,n,o,i,a,s;return r.Ul.Ml.safari?t.font:(e="",n="normal","400","11pt","Calibri",o=t.fontStyle,i=t.fontVariant,a=t.fontWeight,s=t.lineHeight,o&&o!==n&&(e=o),i&&i!==n&&(e+=(e?" ":"")+i),a&&a!==n&&"400"!==a&&(e+=(e?" ":"")+a),e+=(e?" ":"")+(t.fontSize||"11pt"),s&&s!==n&&(e+="/"+s),e+=" "+(t.fontFamily||"Calibri"))},t.Jo=function(n,r){var a,s,l,u,c;if(!n&&!r)return n;if(n){if(s=r?n+"+"+r:n,l=t.Mo[s])return l;a=t.Lo(),o.GC$(a).css("font",n)}else{if(s=r,l=t.Mo[s])return l;a=t.Lo(),o.GC$(a).css("fontSize",e.Ho)}return r&&o.GC$(a).css("fontFamily",r),u=a.currentStyle,(c=i.defaultView)&&c.getComputedStyle&&(u=c.getComputedStyle(a,"")),l=t.F4(u),t.Mo[s]=l,t.Mo[l]=l,l},t.No=function(e,n,o,r){var s,l,u,c,f,h,p,d,g,m=t.Oo[n];if(!r)if(m){if(s=m[e])return s}else m=t.Oo[n]={};return(l=t.Lo()).style.font=e,u=l.currentStyle,(c=i.defaultView)&&c.getComputedStyle&&(u=c.getComputedStyle(l,"")),h="px",-1!==(f=u.fontSize).indexOf(h)&&(p=a(1,parseFloat(f.replace(h,""))*n),o&&1===p&&(o.value=!0),f=p+h),-1!==(d=u.lineHeight).indexOf(h)&&(g=a(1,parseFloat(d.replace(h,""))*n),d=g+h),1===n?s={font:e,fontFamily:l.style.fontFamily,fontSize:p}:(l.style.fontSize=f,l.style.lineHeight=d,s={font:l.style.font,fontFamily:l.style.fontFamily,fontSize:p}),r||(m[e]=s),s},t.Lo=function(){var e,n,o;return t.Po?t.Po.style.cssText=t.Qo:(e="-10000px",(o=(n=r.Ul.Nl("span")).style).visibility="hidden",o.top=e,o.left=e,o.lineHeight="normal",o.position="absolute",o.fontWeight="normal",o.fontStretch="normal",o.fontVariant="normal",o.fontStyle="normal",i.body.insertBefore(n,null),t.Po=n,t.Qo=o.cssText),t.Po},t.no=function(){var e=t.Po;e&&(o.GC$(e).remove(),t.Po=l,t.Qo=l)},t.stringFontCatch={},t.Ro=function(e,n){var o,r=e+","+n,i=t.stringFontCatch,a=i[r];return a||((o=t.Lo()).style.font=e,n&&(o.style.fontWeight=n),a=i[r]=o.style.font),a},t.Mo={},t.Oo={},t.So=function(t){if(t<=0)return"none";var e="";return(1|t)===t&&(e+="underline "),(2|t)===t&&(e+="line-through "),(4|t)===t&&(e+="overline "),e.trim()},t.setFillStyle=function(e,n,o,r,i,a,s){"string"==typeof n?(e.fillStyle!==n&&(e.fillStyle=n),s()):"path"===n.type?t.setFillStyle_Path(e,n,o,r,i,a,s):n.stops?t.setFillStyle_Gradient(e,n,o,r,i,a,s):n.type&&t.setFillStyle_patternFill(e,n,o,r,i,a,s)},t.setFillStyle_patternFill=function(t,e,n,o,r,i,a){var s,l,f,h,p=y[e.type],d=p.length,g=p[0].length,m=document.createElement("canvas");for(m.width=g,m.height=d,(s=m.getContext("2d")).fillStyle=e.backgroundColor||u,s.fillRect(0,0,g,d),s.fillStyle=e.patternColor||c,l=0;l<d;l++)for(f=0;f<g;f++)p[l][f]&&s.fillRect(f,l,1,1);t.createPattern(m,"repeat"),h=t.createPattern(m,"repeat"),t.fillStyle=h,a()},t.processStops=function(t){var e,n;if(t.stops||"path"===t.type){if(e=t.stops)if(0===e.length)e=[{position:0,color:c},{position:1,color:c}];else{for((e=e.filter((function(t,e,n){return t.position<=1&&t.position>=0}))).sort((function(t,e){return t.position-e.position})),n=0;n<e.length;n++)e[n].color=e[n].color||c;0!==e[0].position&&e.splice(0,0,{position:0,color:c}),1!==e[e.length-1].position&&e.push({position:1,color:c})}else e=[{position:0,color:u},{position:1,color:u}];t.stops=e}"path"===t.type?(t.left=C(t.left),t.right=C(t.right),t.top=C(t.top),t.bottom=C(t.bottom)):t.stops&&(delete t.type,t.degree=t.degree||0)},t.setFillStyle_Gradient=function(t,e,n,o,r,i,a){var s,l,c,y,v,C,b,w=e.degree||0;for(w%90==0?(l=w/180*h,c=f(w%180/180*h)-g(i/r)):(l=g(r/i*m(w/180*h)),c=f(l)-g(i/r),l=Math.round(w/180)*h+l),y=Math.sqrt(r*r+i*i)/2,s=t.createLinearGradient(n+r/2-y*p(c)*p(l),o+i/2-y*p(c)*d(l),n+r/2+y*p(c)*p(l),o+i/2+y*p(c)*d(l)),C=0,b=(v=e.stops).length;C<b;C++)s.addColorStop(v[C].position,v[C].color||u);t.fillStyle=s,a()},t.setFillStyle_Path=function(t,e,n,o,r,i,a){var s,l,c,f=e.left||0,h=e.right||0,p=e.top||0,d=e.bottom||0,g=e.stops;if(f>h&&(h=f),p>d&&(d=p),f>0){for(t.save(),t.beginPath(),s=t.createLinearGradient(n+r*f,0,n,0),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(n,o-1),t.lineTo(n+r*f+1,o+i*p),t.lineTo(n+r*f+1,o+i*d),t.lineTo(n,o+i+1),t.clip(),a(),t.restore()}if(h<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(n+r*h,0,n+r,0),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(n+r,o-1),t.lineTo(n+r,o+i+1),t.lineTo(n+r*h-1,o+i*d),t.lineTo(n+r*h-1,o+i*p),t.clip(),a(),t.restore()}if(p>0){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,o+i*p,0,o),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(n,o),t.lineTo(n+r,o),t.lineTo(n+r*h,o+i*p+1),t.lineTo(n+r*f,o+i*p+1),t.clip(),a(),t.restore()}if(d<1){for(t.save(),t.beginPath(),s=t.createLinearGradient(0,o+i*d,0,o+i),l=0,c=g.length;l<c;l++)s.addColorStop(g[l].position,g[l].color||u);t.fillStyle=s,t.moveTo(n+r,o+i),t.lineTo(n,o+i),t.lineTo(n+r*f,o+i*d-1),t.lineTo(n+r*h,o+i*d-1),t.clip(),a(),t.restore()}f<h&&p<d&&(t.save(),t.beginPath(),t.fillStyle=g[0].color,t.rect(n+r*f,o+i*p,r*(h-f),i*(d-p)),t.clip(),a(),t.restore())},t}(),e.To=v},"./dist/core/worksheet/worksheet-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht,Vt,zt,Wt,Ut,qt,Yt,Xt,Zt,Qt,Jt,$t,Kt,te,ee,ne=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function oe(t,e){return t.getRowCount(e)}function re(t,e){return t.getColumnCount(e)}function ie(t){return t.rowCount}function ae(t){return t.colCount}function se(t){var e=t.parent;return e&&e.options.allowExtendPasteRange}function le(t){var e=t.parent;return e&&e.options.allowCopyPasteExcelStyle}function ue(t){var e=t.parent;return e&&e.options.copyPasteHeaderOptions}function ce(t,e,n,o){throw Error(v.Kb(F().Exp_InvalidAndSpace,[t,e,n,o]))}function fe(t){t.suspendPaint()}function he(t){t.resumePaint()}function pe(t){t.suspendEvent()}function de(t){t.resumeEvent()}function ge(t,e){t&&g&&t.suspendCalcService(e)}function me(t,e){t&&g&&t.resumeCalcService(e)}function ye(t,e,n,o,r){var i=t.getSpan(e,n,o);if(i&&r&&(i.row!==e||i.col!==n))return!0}function ve(t){var e=this;e.Vw=1==(1&t),e.Ww=2==(2&t),e.Xw=8==(8&t),e.Yw=g&&16==(16&t),e.Zw=!0,e.$w=!0}function Ce(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,y,v;if(m(t)||""===t)return k;for((m(e)||""===e)&&(e="\r\n"),"\n",(m(n)||""===n)&&(n="\t"),(m(o)||""===o)&&(o='"'),C(t,e)||(t+=e),r=[],i=[],a="",l=!1,u=o.length,c=e.length,f="\n".length,h=n.length,p=t.length,d=0;d<p;d++)(s=(a+=t[d]).length)>=u&&o===a.substr(s-u,u)?l&&p>=d+1+u&&o===t.substr(d+1,u)?d+=u:l?(a=a.substr(0,s-u),l=!1):0===a.indexOf(o)&&(a=a.substr(0,s-u),l=!0):!l&&s>=h&&n===a.substr(s-h,h)?(a=a.substr(0,s-h),i.push(""+a),a=""):!l&&s>=c&&e===a.substr(s-c,c)?(a=a.substr(0,s-c),i.push(""+a),r.push(i),i=[],a=""):!l&&s>=f&&"\n"===a.substr(s-f,f)?(a=a.substr(0,s-f),i.push(""+a),r.push(i),i=[],a=""):l&&p>=d+1+h&&n===t.substr(d+1,h)&&","!==n&&(d+=u);if(l){if(i.length>0){for(g=void 0,g=0;g<r.length&&r[g]!==i;g++);g>=r.length&&r.push(i)}(y=""+a)&&(y=y.replace(RegExp(n,"g"),""),C(y,e)&&(y=y.substr(0,y.length-c)),0===r.length&&r.push([y]))}return 0===r.length&&(v=t,C(t,e)&&(v=v.substr(0,v.length-c)),r.push([v])),function(t){var e,n;if(t){for(e=0;e<t.length&&((n=t[e])&&1===n.length);e++);if(e===t.length)return!0}return!1}(r)&&/^(\s)*$/.test(t)&&"\n"===t.substr(t.length-f,f)&&r.push([""]),r}function be(t,e,n,o,r,i,a){for(var s=0,l=o;s<e.length;s++,l++)r>0&&l<re(t,i)&&we(t,i,n,l,e[s],a)}function we(t,e,n,o,r,a){var s,u,c,f,h,p,d,g=r,y=k;if(!1===a.Xw&&(s={value:k},g=l.Ul.ul(k,r,!a.Xw,s),y=s.value),m(g))t.setValue(n,o,g,e);else if(""!==r)if(a.Yw&&"="===r[0]&&r.length>1)try{t.setFormula(n,o,r.substr(1))}catch(i){t.setText(n,o,r,e)}else u=t.tq(n,o,"formatter",e),!1===a.Xw&&y?u?u&&("string"==typeof u&&i.Formatter&&(u=new i.Formatter.GeneralFormatter(u)),d=u.parse&&u.parse(r),g=m(d)?g:d):(y.isAuto=!0,t.getCell(n,o,e)._w("_autoFormatter",y),c=r,f=t.getCellType(n,o,e),h=y.formatString(),f&&"7"===f.typeName&&(p={sheet:t,row:n,col:o,sheetArea:e},c=f.parse(r,h,p),g=m(c)?r:c)):u&&t.getCell(n,o,e).formatter(k),t.setValue(n,o,g,e);else t.setValue(n,o,k,e)}function Te(t){var e,n,o=0;for(e=0;e<(t&&t.length);e++)n=t[e],o=N(n.length,o);return o}function xe(t,e,n,o,r,i,a,s){if(!t)throw Error(F().Exp_SheetIsNull);if((e<-1||e>=oe(t))&&ce("row",e,"-1",oe(t)-1),(n<-1||n>=re(t))&&ce("column",n,"-1",re(t)-1),!m(o)&&""!==o){-1===e&&(e=0),-1===n&&(n=0);var l=Ce(o,r,i,a);l&&l.length>0&&function(t,e,n,o,r){var i,a,s,l,u,c,f,h=o.length,p=Te(o);if(0!==h&&0!==p)for(i=new ve(r),t&&(re(t,2)<=0&&(i.Vw=!1),oe(t,1)<=0&&(i.Ww=!1)),l=0,(p-=a=i.Vw?re(t,2):0)<=0&&(p=0),(h-=s=i.Ww?oe(t,1):0)<=0&&(l=0),(h-=l)<=0&&(h=0),i.Zw&&e+h>oe(t)&&t.setRowCount(e+h),i.$w&&n+p>re(t)&&t.setColumnCount(n+p),u=0,c=0;u<o.length;u++,c++)(f=o[u]).length<=0||(s>0&&u<s?be(t,f,c,n,p,1,i):h>0&&c<oe(t)&&(u===s&&(c=e),be(t,f,c,0,a,2,i),f.splice(0,a),be(t,f,c,n,p,3,i)))}(t,e,n,l,s)}}function Se(t,e,n,o,r,i,a,s,l,u,c,f,h,p){var d,g,y,v,C,b,w,T,x,S,A,I;if(!t)throw Error(F().Exp_SheetIsNull);return d=oe(t),g=re(t),(e<-1||e>=d)&&ce("row",e,"-1",d-1),(n<-1||e+n>d)&&ce("rowCount",n,"-1",d-e),(o<-1||o>=g)&&ce("column",o,"-1",g-1),(r<-1||o+r>g)&&ce("columnCount",r,"-1",g-o),y=-1,v=-1,C=!1,b=!1,-1===e&&-1===o&&-1===n&&-1===r?(e=0,o=0,y=oe(t)-1,v=re(t)-1):(-1===e&&(e=0,2==(2&ue(t))&&(C=!0)),-1===o&&(o=0,1==(1&ue(t))&&(b=!0)),-1===n&&(n=oe(t)-e),-1===r&&(r=re(t)-o),y=e+n-1,v=o+r-1),(m(i)||""===i)&&(i="\r\n"),(m(a)||""===a)&&(a="\t"),(m(s)||""===s)&&(s='"'),T=null,x=null,S=Ae(t,e,y,o,v,3,u,c,i,a,s,w=RegExp(s,"g"),l,f,h,p),b&&(A=t.getColumnCount(2),T=Ae(t,e,y,0,A-1,2,u,c,i,a,s,w,l,f,h,p)),C&&(I=t.getRowCount(1),x=Ae(t,0,I-1,o,v,1,u,c,i,a,s,w,l,f,h,p)),function(t,e,n,o,r){var i,a,s=t,l=0,u=function(t,e){var n,o=[],r=t.length;for(n=0;n<r;n++)o.push(t[n].concat(e[n]));return o};return e&&(l=e[0].length,s=u(e,t)),n&&(i=n.length,a=null,l&&(a=Ae(null,0,i-1,0,l-1,null,[],[],o,r,null,null,null,!1,!1),n=u(a,n)),s=n.concat(s)),function(t,e,n){var o,r,i="",a=t.length;for(o=0;o<a;o++){for(r=0;r<t[o].length;r++)0!==r&&(i+=n),i+=t[o][r];i+=e}return i}(s,o,r)}(S,T,x,i,a)}function Ae(t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g){var m,v,C,b,w=[],T=t&&le(t);for(m=e;m<=n;m++)if(!a||!y(a,m)){for(C=[],v=o;v<=r;v++)s&&y(s,v)||(b="",t&&!ye(t,m,v,i,p)&&(b=t.getText(m,v,i),g&&T&&b&&(" "===b[0]||" "===b[b.length-1])&&"number"==typeof t.getValue(m,v,i)&&(b=b.trim())),b=Ie(b,p,T,f,c,d,h,u,l),C.push(b));w.push(C)}return w}function Ie(t,e,n,o,r,i,a,s,l){var u="";return m(t)||(u=t,e||(u=u.replace(o,r+r))),i&&!u&&(u=" "),e&&n?u=u.replace(/\n/g," "):(a||-1!==u.indexOf(r)||-1!==u.indexOf(s)||-1!==u.indexOf(l)||-1!==u.indexOf("\n"))&&(u=r+u+r),u}function Re(t,e){return t.sheets?t.getSheetFromName(e.sheetName):t}function ke(t,e,n,o){var r=Re(t,n),i=new e(r,n,o);return o?i.undo(r):i.execute(r)}function Me(t){var e=t;return function(t,n){var o=Re(t,n);return P.Ox(o,e)}}function Ne(t,e){var n=t,o=e;return function(t,e){var r=Re(t,e);return P.Rx(r,n,o)}}function Ee(t,e){var n,o,r,i=t.parent;i&&(n=i.getSheetCount(),void 0,r=void 0,o=r=i.getActiveSheetIndex(),e?r<n-1&&r++:r>0&&r--,o!==r&&(i.dq(r,1),i.repaint()))}function De(t,e){t.Tx=!0,t.Hx?t.Ex(e):t.yx(e,!0),t.Tx=!1}function Oe(t,e){var n,o,r,i;return!!t.endEdit()&&((n=t.mm).Ux(),n.Vx(),l.Vl.Zl(k),o=!1,(r=t.parent)&&((i=e.call(r))&&i.focus?(i.focus(),o=!0):r.Uv()),{ignoreCancelDefault:!o})}function je(t,e){var n=[];return"string"==typeof e?n.push(t.getSheetFromName(e)):Array.isArray(e)&&e.forEach((function(e){n.push(t.getSheetFromName(e))})),n}function Fe(t,e){fe(t),e||pe(t)}function Pe(t,e){e||de(t),he(t)}function _e(t,e){m(t.lq)&&(t.lq=e.lq,t.qq=e.qq)}function Le(t,e){"value"===e.propertyName&&t.xu(e.row,e.col,e.oldValue,e.newValue)}function Be(t){var e=t.parent,n=e&&e.hq;n&&n.repaint()}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("Common"),i=n("Common"),a=n("./dist/core/worksheet/style.js"),s=n("./dist/core/worksheet/worksheet.js"),l=n("./dist/core/util/common.js"),u=n("./dist/core/worksheet/clipboardhelper.js"),c=n("./dist/core/util/domUtil.js"),f=n("./dist/core/core.enum.js"),h=c.GC$,p=n("./dist/core/worksheet/worksheet-static.js"),d=n("@grapecity/js-calc"),g=!!d,m=r.Common.j.Fa,y=r.Common.k.Bb,v=r.Common.u,C=v.jb,b=l.Events.CellChanged,w=l.Events.ColumnWidthChanging,T=l.Events.ColumnWidthChanged,x=l.Events.RowHeightChanging,S=l.Events.RowHeightChanged,A=l.Ul.Ml,I=l.Ul.Ol,R=h.extend,h.inherit,k=null,M=void 0,N=Math.max,Math.min,E=Math.floor,D=Math.ceil,Number.MAX_VALUE,isNaN,function(t){t[t.value=1]="value",t[t.formula=2]="formula",t[t.comment=4]="comment",t[t.outline=8]="outline",t[t.sparkline=16]="sparkline",t[t.span=32]="span",t[t.style=64]="style",t[t.tag=128]="tag",t[t.bindingPath=256]="bindingPath",t[t.conditionalFormat=512]="conditionalFormat",t[t.hyperlink=1024]="hyperlink",t[t.all=2047]="all"}(O=e.CopyToOptions||(e.CopyToOptions={})),j=new r.Common.ResourceManager(o.SR),F=j.getResource.bind(j),R(s.Worksheet.prototype,{autoFitColumn:function(t){0<=t&&t<re(this)&&this.wu().execute({cmd:"autoFitColumn",sheetName:this.name(),columns:[{col:t}],rowHeader:!1})},autoFitRow:function(t){0<=t&&t<oe(this)&&this.wu().execute({cmd:"autoFitRow",sheetName:this.name(),rows:[{row:t}],columnHeader:!1})},setCsv:function(t,e,n,o,r,i){var a=this;fe(a),pe(a),xe(a,t,e,n,o,r,'"',i),de(a),he(a)},getCsv:function(t,e,n,o,r,i){return Se(this,t,n,e,o,r,i,'"',!0)},copyTo:function(t,e,n,o,r,i,a){this.ax(t,e,n,o,r,i,a)},ax:function(t,e,n,o,r,i,a,s){var l=this;fe(l),pe(l),p.staticMembers.copyTo(l,t,e,l,n,o,r,i,a,s,0),de(l),he(l)},moveTo:function(t,e,n,o,r,i,a){var s=this;if(!(g&&a&O.formula)||s.Vq(t,e,r,i,!0)&&s.Vq(n,o,r,i,!0))try{fe(s),pe(s),p.staticMembers.moveTo(s,t,e,s,n,o,r,i,a)}finally{de(s),he(s)}},bx:function(t,e,n){var o,r,i,a,s,c,h,p=this,d=p.o5(t);if(d){o=p.J5(t),"\t","\r\n",'"',r=p.mm,i=Se(p,d.row,ie(d),d.col,ae(d),"\r\n","\t",'"',!1,o.rows,o.cols,!0),(a=p.tu()).PA=p,a.n5=t,a.G4=e,p.tu().UHb=!0,s=ue(p),c=u.S4.Q4(p,s,d.row,ie(d),d.col,ae(d),f.SheetArea.viewport,le(p),o.rows,o.cols,!1,!1,!1,!1),p.ex&&p.ex(),p.Sob&&p.Sob();try{if(h={sheet:p,sheetName:p.name(),copyData:{text:i,html:c},cancel:!1},p.Wq(l.Events.ClipboardChanging,h),h&&!1===h.cancel)return r&&!n&&r.gx(le(p)?c:i),p.Wq(l.Events.ClipboardChanged,{sheet:p,sheetName:p.name(),copyData:{text:i,html:c}}),setTimeout((function(){!r||n||p.Js||r.hx()}),100),{copyText:i,copyHtml:c};a.hZ()}catch(t){}}},ix:function(t,e,n,o,r,i,a,s){var l,u,c,f,h=F().Exp_PasteSourceCellsLocked;if(i.pastedInternal=!1,i.pastedRange=k,l=!r&&!s,!t&&l)return!1;if(c=u=this,f=u.J5(e),u.jx(t,u.o5(e),c,r,f.rows,f.cols)||l){if(i.pastedInternal=!0,o&&t.options.isProtected&&t.p5(e))return u.Os(1,h),!1;i.pastedRange=u.kx(t,e,c,n,o)}else i.pastedRange=u.lx(n,r);return u.mx(t,e,n,o,i,a)},mx:function(t,e,n,o,r,i){var a,s,u,c,f,h,p,d,g,m,y,v,C,b,w=F().Exp_InvalidCopyPasteSize,T=F().Exp_PasteDestinationCellsLocked,x=F().Exp_PasteChangeMergeCell,S=F().Exp_ChangePartOfArray,A=this,I=A,R=r.pastedRange;if(!R)return A.Os(1,w),!1;if(!I.Y3(R.row,R.col,ie(R),ae(R),T,S,M,i))return!1;if(r.pastedInternal){if(1===(a=e.length)){if(s=e[0],o&&!t.Y3(s.row,s.col,ie(s),ae(s),T,S))return!1;if(t.qu(s.row,s.col,ie(s),ae(s)))return A.Os(1,x),!1;if(u=R.row<0?oe(I):ie(R),c=R.col<0?re(I):ae(R),f=s.row<0?oe(t):ie(s),h=s.col<0?re(t):ae(s),u>f||c>h){for(p=n.row,d=n.col,n.row<0&&f<oe(I)&&(p=0),n.col<0&&h<re(I)&&(d=0),u%f==0&&1===c?(c=h,R=r.pastedRange=new l.Range(p,d,u,c)):1===u&&c%h==0?(u=f,R=r.pastedRange=new l.Range(p,d,u,c)):u%f==0&&c%h==0||(u=f,c=h,R=r.pastedRange=new l.Range(p,d,u,c)),g=E(u/f),m=E(c/h),y=0;y<g;y++)for(v=0;v<m;v++)if(!A.nx(s,R)&&I.qu(p<0?-1:p+y*f,d<0?-1:d+v*h,p<0?-1:f,d<0?-1:h))return A.Os(1,x),!1}else if(i===M&&!A.nx(s,R)&&I.qu(R.row,R.col,ie(R),ae(R)))return A.Os(1,x),!1}else if(a>1){for(C=0;C<a;C++)if(b=e[C],t.qu(b.row,b.col,ie(b),ae(b)))return A.Os(1,x),!1;if(I.qu(R.row,R.col,ie(R),ae(R)))return A.Os(1,x),!1}}else{if(I.qu(R.row,R.col,ie(R),ae(R)))return A.Os(1,x),!1;if(!I.l5(R.row,R.col,ie(R),ae(R)))return A.Os(1,w),!1}return!0},nx:function(t,e){if(t&&1===ie(t)&&1===ae(t)){var n=this.getSpan(e.row,e.col);if(n&&n.equals(e))return!0}return!1},jx:function(t,e,n,o,r,i){var a,s;if(t&&e&&n)try{return(s=(a=Se(t,e.row,ie(e),e.col,ae(e),"\r\n","\t",'"',!1,r,i,!0,A.safari,!0))===o)||(!(s=a===o+"\r\n")&&A.chrome&&(s=a===o+"\t\r\n"),s||!A.safari&&le(n)||(s=a.replace(/\s/g,"")===o.replace(/\s/g,"")),s||(s=a.replace(/\s+$/,"")===o.replace(/\s+$/,""))),s}catch(t){return!1}return!1},kx:function(t,e,n,o,r){var i,a,s,u,c,f,h,p,d,g,m=e.length;if(1===m){if(a=(i=e[0]).row<0?0:i.row,s=i.col<0?0:i.col,u=i.row<0?oe(t):ie(i),c=i.col<0?re(t):ae(i),f=o.row<0?0:o.row,h=o.col<0?0:o.col,p=o.row<0?oe(n):ie(o),d=o.col<0?re(n):ae(o),r?(p=u,d=c):p%u==0&&1===d?d=c:1===p&&d%c==0?p=u:p%u==0&&d%c==0||(p=u,d=c),!this.pu(a,s,u,c,oe(t),re(t)))return k;if(!n.l5(f,h,p,d))return k;if(g=new l.Range(f,h,p,d),!r&&t.name()===n.name())if(g.contains(a,s,u,c)){if((a-f)%u!=0||(s-h)%c!=0)return k}else if(g.intersect(a,s,u,c)&&(p>u||d>c))return k;return-1===o.row&&(f=-1,p=-1),-1===o.col&&(h=-1,d=-1),new l.Range(f,h,p,d)}return m>1?this.q5(e,o):k},q5:function(t,e){var n,o,r,i,a,s;if(t.length>1){if(n=t[0],o=t[1],r=n.rowCount,i=n.colCount,n.row===o.row&&r===o.rowCount)return a=0,t.forEach((function(t){a+=t.colCount})),l.kf(e.row,e.col,r,a);if(n.col===o.col&&i===o.colCount)return s=0,t.forEach((function(t){s+=t.rowCount})),l.kf(e.row,e.col,s,i)}return k},lx:function(t,e){var n,o,r=t.row<0?0:t.row,i=t.col<0?0:t.col,a=new l.Range(r,i,1,1),s=function(t,e,n,o){var r,i,a,s,l,u=k,c=Ce(t,e,n,o);if(c){for(r=c.length,i=Te(c),a=[],s=0;s<r;s++)for(a[s]=[],l=0;l<i;l++)l<c[s].length?a[s][l]=c[s][l]:a[s][l]=k;u=a}return u}(e,"\r\n","\t",'"');return s&&(n=s.length,o=Te(s),n>0&&o>0&&(a=new l.Range(r,i,n,o))),a},ox:function(){var t=this.tu();t&&t.hZ()},px:function(t,e,n,o,i,a,s,u,c,f){var h,d,m,v,C,b,w,T,x,S,A,I,R,M,N,D;if(t&&n.name()===t.name()&&n.parent&&!y(n.parent.sheets,t))t.ox();else{w=te.qx(c),ge(t),ge(n);try{if(t&&e){if(0!=(2&w)&&i&&g&&(t.Ns(e.row,e.col,ie(e),ae(e))||n.Ns(o.row,o.col,ie(o),ae(o))))throw F().Exp_ChangePartOfArray;if(i)p.staticMembers.moveTo(t,e.row,e.col,n,o.row,o.col,ie(e),ae(e),w),t.ox();else if(T=o.row<0?oe(n):ie(o),x=o.col<0?re(n):ae(o),m=e.row<0?oe(t):ie(e),v=e.col<0?re(t):ae(e),T>m||x>v)for(h=o.row,d=o.col,o.row<0&&m<oe(n)&&(h=0),o.col<0&&v<re(n)&&(d=0),T%m==0&&1===x?x=v:1===T&&x%v==0?T=m:T%m==0&&x%v==0||(T=m,x=v),S=E(T/m),A=E(x/v),C=0;C<S;C++)for(b=0;b<A;b++)p.staticMembers.copyTo(t,e.row,e.col,n,h<0?-1:h+C*m,d<0?-1:d+b*v,h<0?-1:m,d<0?-1:v,w,f,ue(t));else p.staticMembers.copyTo(t,e.row,e.col,n,o.row,o.col,ie(e),ae(e),w,f,ue(t))}else{for(h=o.row,d=o.col,m=ie(o),v=ae(o),M=(R=(I=n.ITa).getSpans(l.kf(h,d,m,v))).length-1;M>=0;M--)I.do("removeSpan",R[M]);if(g&&(1&w)>0&&n.clearFormula(h,d,m,v,(function(t,e){return!t.Ps||!t.Ps(e)})),N=n.tu(),D=0===c||2===c,a&&""!==a)n.parent.options.allowAutoCreateHyperlink&&1===m&&1===v&&(r.Common.q.qb("^(((ht|f)tp(s?)):\\/\\/(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|www\\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\\.[^\\s]{2,}|((ht|f)tp(s?)):\\/\\/(?:www\\.|(?!www))[a-zA-Z0-9]+\\.[^\\s]{2,}|www\\.[a-zA-Z0-9]+\\.[^\\s]{2,})$").test(a)||r.Common.q.qb("^(mailto:\\/\\/)?([A-Za-z0-9_\\-\\.\\!\\#$%&'*\\+/=?^`{|}~])+\\@([A-Za-z0-9\\-])+\\.([A-Za-z0-9\\-]){2,63}(\\?subject=.+)?$").test(a))&&n.setHyperlink&&n.setHyperlink(h,d,{url:a,tooltip:a}),n.setCsv(h,d,a,"\r\n","\t",16);else{for(C=0;C<m;C++)for(b=0;b<v;b++)n.setValue(h+C,d+b,k);N&&D&&u&&N.lgc(u,n,h,d)}N&&D&&s&&N.R4(s,n,h,d)}}finally{me(t,!1),me(n,!1)}}},sx:function(t){if(!this.isEditing()){var e=this.getSelections();if(e&&1===e.length)return this.bx(e,!0,t)}return k},r5:function(t,e){var n,o,r,i,a,s,l;if(t&&(n=t.length)>1){for(o=void 0,o=0;o<n;o++)for(r=t[o],i=o+1;i<n;i++)if(a=t[i],r.intersect(a.row,a.col,a.rowCount,a.colCount))return!1;for(s=t[0],l=void 0,o=1;o<n&&(l=t[o],s.row===l.row&&s.rowCount===l.rowCount);o++);if(o>=n)return e&&(e.inSameRow=!0),!0;for(o=1;o<n&&(l=t[o],s.col===l.col&&s.colCount===l.colCount);o++);if(o>=n)return e&&(e.inSameCol=!0),!0}return!1},o5:function(t){var e,n,o,r,i;if(t){if(1===(e=t.length))return t[0];if(e>1){if(n=t[0],o=t[e-1],r=void 0,i=void 0,n.row===o.row&&n.rowCount===o.rowCount){for(r=0;r<e;r++)(i=t[r]).col<n.col&&(n=i),i.col>o.col&&(o=i);return l.kf(n.row,n.col,n.rowCount,o.col+o.colCount-n.col)}if(n.col===o.col&&n.colCount===o.colCount){for(r=0;r<e;r++)(i=t[r]).row<n.row&&(n=i),i.row>o.row&&(o=i);return l.kf(n.row,n.col,o.row+o.rowCount-n.row,n.colCount)}}}return k},J5:function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p=[],d=[];if(t&&((e=t.length)>1&&(n=t[0],o=t[e-1],r=n.row===o.row&&n.rowCount===o.rowCount,i=n.col===o.col&&n.colCount===o.colCount,r||i)))for(t.sort(r?function(t,e){return t.col-e.col}:function(t,e){return t.row-e.row}),a=1;a<e;a++)for(s=t[a-1],l=t[a],u=r?s.col+s.colCount:s.row+s.rowCount,c=r?l.col:l.row,f=r?d:p,h=u;h<c;h++)f.push(h);return{rows:p,cols:d}},ux:function(t){var e,n,o,r,i,a,s=this;if(!s.isEditing()){if((e=s.getSelections())&&1===e.length){if(s.tu().UHb=!0,-1!==(n=e[0]).row&&s.Nu&&s.Nu()){for(o=[],r=-1,i=0;i<n.rowCount;i++)a=n.row+i,s.Ps(a)?-1!==r&&(o.push(l.kf(r,n.col,a-r,n.colCount)),r=-1):-1===r&&(r=a);-1!==r&&o.push(l.kf(r,n.col,n.row+n.rowCount-r,n.colCount)),e=o}return s.bx(e,!1,t)}if(s.r5(e))return s.bx(e,!1,t);s.Os(1,F().Exp_MultipleSelections)}return k},vx:function(t){var e,n,o,r,i,a,s=this,l=s.mm;s.isEditing()||(t&&(e=t.pasteText,n=t.pasteHtml,o=t.callback,r=t.shiftCells,i=s.getSelections()[0]),l&&!e&&l.gx(""),(a=s.tu())&&(a.VHb=!1),setTimeout((function(){var t,u,c,f,h;s.Js||(t=e||"",u=n||"",l&&!e&&(a&&(t=(h=a.wx()).text,u=h.html,f=h.image,c=a.n5&&a.n5[0]),l.hx()),(A.msie||A.edge||e||!t&&!u&&!a.VHb)&&(s.J4(t,u,f,r,i,c),o&&o()),s.mm.Qq())}),100))},J4:function(t,e,n,o,r,i){var a,s=this,u=s.tu();if(u&&(u.VHb=!0),!(a=s.xx(t,o,e))){if(!n)return;a={pasteOption:s.options.clipBoardOptions,pastedRanges:[l.kf(s.getActiveRowIndex(),s.getActiveColumnIndex(),1,1)],clipboardText:""}}o!==M&&(a.WHb=o),r&&(a.XHb=r),i&&(a.YHb=i),a.cmd="clipboardPaste",a.sheetName=s.name(),le(s)&&(a.clipboardHtml=e,a.clipboardImage=n),s.wu().execute(a)},xx:function(t,e,n){var o,r,i,a,s,l,u,c,f,h=this,p=F().Exp_InvalidPastedArea,d=h.tu(),g=d.PA,m=d.n5,y=d.G4;if(y&&g&&m&&g.options.isProtected&&g.p5(m)&&(y=!1),o={pastedRange:k,pastedInternal:!1},r=[],(i=h.getSelections()).length>1)for(s=0;s<i.length;s++){if(a=i[s],!h.ix(g,m,a,y,t,o,M,n))return;if(a.containsRange(o.pastedRange)&&!a.equals(o.pastedRange))return void h.Os(1,p);r.push(o.pastedRange)}else{if(a=i.length>0?i[0]:h.ITa.getSpan(h.Jl,h.Kl),!h.ix(g,m,a,y,t,o,e,n))return;r.push(o.pastedRange)}if((l=h.at)&&l.jx(o.pastedInternal),o.pastedInternal||(g=k,m=k,y=!1),u=h.options.clipBoardOptions,y&&(u=0),m&&1===m.length)for(c=0;c<r.length;c++)f=r[c],h.nx(m[0],f)&&(f.rowCount=1,f.colCount=1);return(!m||m.length>1)&&r.length>1?void h.Os(1,F().Exp_MultipleSelections):{fromSheet:g,fromRanges:m,isCutting:y,pasteOption:u,pastedRanges:r,clipboardText:t}},l5:function(t,e,n,o,r){var i=this,a=oe(i),s=re(i);return se(i)?-1<=t&&(r||t<a)&&-1<=e&&(r||e<s):i.pu(t,e,n,o,a,s)},p5:function(t){for(var e=0;e<t.length;e++)if(this.ou(t[e]))return!0;return!1},yx:function(t,e,n,o){var r,i,a,s=this;s.endEdit&&!s.endEdit()||(r={sheet:s,sheetName:s.name(),row:s.Jl,col:s.Kl,cancel:!1},s.Wq(l.Events.LeaveCell,r),!0!==r.cancel&&(i=s.Jl,a=s.Kl,m(n)&&(n=s.Jl),m(o)&&(o=s.Kl),3===t?s.zx(n,o,e):4===t?s.Rs(n,o,e):1===t?s.Ax(n,o,e):2===t?s.Bx(n,o,e):5===t?s.Cx():6===t&&s.Dx(),s.Ss(t,i,a)))},Ex:function(t){var e,n,o,r=this;r.endEdit()&&(e={sheet:r,sheetName:r.name(),row:r.Jl,col:r.Kl,cancel:!1},r.Wq(l.Events.LeaveCell,e),!0!==e.cancel&&(n=r.Jl,o=r.Kl,3===t?r.Fx(r.Jl,r.Kl):4===t&&r.Gx(r.Jl,r.Kl),r.Ss(t,n,o)))},Ss:function(t,e,n){var o,r,i,a,s,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x=this,S=x.mm,A=x.ITa.getSelections(),I=!1;x.Hx||(o=x.Tq(x.Ix()),(A.length>1||ie(o)>1||ae(o)>1)&&(I=!0),!I&&x.mJb&&x.mJb.mgc(o)&&(I=!0),x.Tr()),r=x.Jl,i=x.Kl,a=x.ITa.getSpan(r,i),x.Lr=ie(a),x.Mr=ae(a),x.Hx||(s=x.Jx(r,i),u=x.selectionPolicy(),c=x.selectionUnit(),(0===u||1===u)&&x.ITa.do("clearSelection"),1===c?(s.col=-1,s.colCount=-1):2===c&&(s.row=-1,s.rowCount=-1),x.Kx(s.row,s.col,ie(s),ae(s),!1),f=x.ITa.getSelections(),S.zu(A,f)&&(x.yu(A,f),x.Au(A))),x.Yq(r,i),e!==r&&((h=x.wq)&&h.Lx()),p=x.yl,I?(g=(d=x.am()).zr,m=d.Ar,y=d.width-g,v=d.height-m,p.Mx(g,m,y,v),p.repaint(new l.Rect(g,m,y,d.Cr)),p.repaint(new l.Rect(g,m,d.Br,v)),p.Pw(p.bm())):(b=ie(C=x.ITa.getSpan(e,n)),w=ae(C),p.im(new l.Range(r,i,x.Lr,x.Mr).union(new l.Range(e,n,b,w)))),T={sheet:x,sheetName:x.name(),row:r,col:i},x.Wq(l.Events.EnterCell,T),x.Wq(l.Events.FormulatextboxEnterCell,T),S.cs&&S.cs(r,i)},Nx:function(t,e){var n=this,o=n.getDataValidator&&n.getDataValidator(t,e),r={sheet:n,sheetName:n.name(),row:t,col:e,validator:o,validationResult:0};return n.Wq(l.Events.ValidationError,r),r.validationResult}}),P={},e.Commands=P,P.Ox=function(t,e){return!!t&&2!==t.Px&&(t.yx(e,!1),!0)},P.Qx=function(t,e,n,o){return!!t&&2!==t.Px&&(t.yx(e,!1,n,o),!0)},P.Rx=function(t,e,n){return!(!t||2===t.Px||t.endEdit&&!t.endEdit()||(t.Sx(e,n),0))},_="navigationLeft",L="navigationRight",B="navigationUp",G="navigationDown",H="navigationHome2",V="navigationEnd2",z="navigationTop",W="navigationBottom",U="navigationHome",q="navigationFirst",Y="navigationEnd",X="navigationLast",Z="moveToNextCell",Q="moveToPreviousCell",J="navigationPageUp",$="navigationPageDown",K="navigationPreviousSheet",tt="navigationNextSheet",et="clear",nt="clearAndEditing",ot="commitInputNavigationDown",rt="commitInputNavigationUp",it="cancelInput",at="commitArrayFormula",st="selectionLeft",lt="selectionRight",ut="selectionUp",ct="selectionDown",ft="selectionHome",ht="selectionEnd",pt="selectionPageUp",dt="selectionPageDown",gt="selectionTop",mt="selectionBottom",yt="selectionFirst",vt="selectionLast",Ct="copy",bt="paste",wt="undo",Tt="redo",xt="resizeColumn",St="resizeRow",At="splitResizeRow",It="splitResizeColumn",Rt="autoFitColumn",kt="autoFitRow",Mt="editCell",Nt="renameSheet",Et="zoom",Dt="clearValues",Ot="clipboardPaste",jt="selectNextControl",Ft="selectPreviousControl",Pt="moveToNextCellThenControl",_t="moveToPreviousCellThenControl",Lt="changeFormulaReference",P.bT=Re,P.h4=ke,P.uv=function(t){var e=l.Ul.sl(),n=!e,o=e;t.register(_,P[_],37,!1,!1,!1,!1),t.register(L,P[L],39,!1,!1,!1,!1),t.register(B,P[B],38,!1,!1,!1,!1),t.register(G,P[G],40,!1,!1,!1,!1),t.register(H,P[H],37,n,!1,!1,o),t.register(V,P[V],39,n,!1,!1,o),t.register(z,P[z],38,n,!1,!1,o),t.register(W,P[W],40,n,!1,!1,o),t.register(U,P[U],36,!1,!1,!1,!1),t.register(q,P[q],36,!0,!1,!1,!1),t.register(Y,P[Y],35,!1,!1,!1,!1),t.register(X,P[X],35,!0,!1,!1,!1),t.register(Z,P[Z],9,!1,!1,!1,!1),t.register(Q,P[Q],9,!1,!0,!1,!1),t.register(J,P[J],33,!1,!1,!1,!1),t.register($,P[$],34,!1,!1,!1,!1),t.register(K,P[K],33,n,!1,!1,o),t.register(tt,P[tt],34,n,!1,!1,o),t.register(et,P[et],46,!1,!1,!1,!1),t.register(nt,P[nt],8,!1,!1,!1,!1),t.register(ot,P[ot],13,!1,!1,!1,!1),t.register(rt,P[rt],13,!1,!0,!1,!1),t.register(it,P[it],27,!1,!1,!1,!1),t.register(at,P[at],13,!0,!0,!1,!1),t.register(st,P[st],37,!1,!0,!1,!1),t.register(lt,P[lt],39,!1,!0,!1,!1),t.register(ut,P[ut],38,!1,!0,!1,!1),t.register(ct,P[ct],40,!1,!0,!1,!1),t.register(ft,P[ft],36,!1,!0,!1,!1),t.register(ht,P[ht],35,!1,!0,!1,!1),t.register(pt,P[pt],33,!1,!0,!1,!1),t.register(dt,P[dt],34,!1,!0,!1,!1),t.register(ft,P[ft],37,n,!0,!1,o),t.register(ht,P[ht],39,n,!0,!1,o),t.register(gt,P[gt],38,n,!0,!1,o),t.register(mt,P[mt],40,n,!0,!1,o),t.register(yt,P[yt],36,!0,!0,!1,!1),t.register(vt,P[vt],35,!0,!0,!1,!1),t.register(Ct,P[Ct],67,n,!1,!1,o),t.register("cut",P.cut,88,n,!1,!1,o),t.register(bt,P[bt],86,n,!1,!1,o),t.register(wt,P[wt],90,n,!1,!1,o),t.register(Tt,P[Tt],89,n,!1,!1,o),e&&t.register(Tt,P[Tt],90,n,!0,!1,o),t.register(jt,P[jt]),t.register(Ft,P[Ft]),t.register(Pt,P[Pt]),t.register(_t,P[_t]),t.register(Lt,P[Lt]),t.register(xt,P[xt]),t.register(St,P[St]),t.register(It,P[It]),t.register(At,P[At]),t.register(Rt,P[Rt]),t.register(kt,P[kt]),t.register(Mt,P[Mt]),t.register(Nt,P[Nt]),t.register(Et,P[Et]),t.register(Dt,P[Dt]),t.register(Ot,P[Ot])},Bt={256:"bindingPath",4:"comment",2:"formula",16:"sparkline",64:"style",128:"tag",1024:"hyperlink",1:"value"},Gt=".cellEditAction",P[_]={canUndo:!1,execute:Me(3)},P[L]={canUndo:!1,execute:Me(4)},P[B]={canUndo:!1,execute:Me(1)},P[G]={canUndo:!1,execute:Me(2)},P[at]={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=P.Wx;return o&&(n=o.fv(n)),n.fv&&n.fv(),!0}},P[ot]={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=P.Wx;return o&&(n=o.Xx(n)),n.yx(2,!1),!0}},P[rt]={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=P.Wx;return o&&(n=o.Yx(n)),n.yx(1,!1),!0}},P[U]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return P.Qx(n,4,k,n.frozenColumnCount()-1)}},P[H]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return P.Qx(n,4,k,-1)}},P[Y]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return P.Qx(n,3,k,re(n)-n.frozenTrailingColumnCount())}},P[V]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return P.Qx(n,3,k,re(n))}},P[z]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return P.Qx(n,2,-1,k)}},P[W]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return P.Qx(n,1,oe(n),k)}},P[J]={canUndo:!1,execute:function(t,e){var n,o,r,i,a,s=Re(t,e);if(!s||2===s.Px)return!1;if((n=s.Ew())===k||n===s.lq)return!0;if(o=s.Gr(1,3),(r=s._q(s.Jl-o.length))<n&&(r=n),i=P.Wx){if((a=i.Zx(s,r,n)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,k),s.Qr=r,s.yx()),s.mq(n,0),!0)}},P[$]={canUndo:!1,execute:function(t,e){var n,o,r,i,a,s=Re(t,e);if(!s||2===s.Px)return!1;if((n=s.$x())===k||n===s.lq)return!0;if(o=s.Gr(1,3),(r=s.gr(s.Jl+o.length))<n&&(r=n),i=P.Wx){if((a=i._x(s,r,n)).r)return!0;s=a.sheet}return!!s.endEdit()&&(s.Qs(r,s.getActiveColumnIndex())&&(s.Jr(r,k),s.Qr=r,s.yx()),s.mq(n,0),!0)}},P[tt]={canUndo:!1,execute:function(t,e){Ee(Re(t,e),!0)}},P[K]={canUndo:!1,execute:function(t,e){Ee(Re(t,e),!1)}},P[q]={canUndo:!1,execute:function(t,e){var n,o,r=Re(t,e);if(!r||2===r.Px)return!1;if(n=P.Wx){if((o=n.ay(r)).r)return!0;r=o.sheet}return r.yx(5,!1,r.Jl,r.Kl),!0}},P[X]={canUndo:!1,execute:function(t,e){var n,o,r=Re(t,e);if(!r||2===r.Px)return!1;if(n=P.Wx){if((o=n.by(r)).r)return!0;r=o.sheet}return r.yx(6,!1,r.Jl,r.Kl),!0}},P[jt]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return!!n.parent&&Oe(n,n.parent.nextControl)}},P[Ft]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return!!n.parent&&Oe(n,n.parent.previousControl)}},P[Z]={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=P.Wx;return o&&(n=o.ey(n)),De(n,4),!0}},P[Q]={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=P.Wx;return o&&(n=o.gy(n)),De(n,3),!0}},P[Pt]={canUndo:!1,execute:function(t,e){var n,o=Re(t,e),r=o.Qr,i=o.getActiveColumnIndex();return o.Tx=!0,n=o.hy(o.getActiveRowIndex(),i,!0,r),o.Tx=!1,!n||n.leadingCellRow<r||n.leadingCellRow===r&&i>n.col?P[jt].execute(t,e):P[Z].execute(t,e)}},P[_t]={canUndo:!1,execute:function(t,e){var n,o=Re(t,e),r=o.Qr,i=o.getActiveColumnIndex();return o.Tx=!0,n=o.iy(o.getActiveRowIndex(),i,!0,r),o.Tx=!1,!n||n.leadingCellRow>r||n.leadingCellRow===r&&i<n.col?P[Ft].execute(t,e):P[Q].execute(t,e)}},P[it]={canUndo:!1,execute:function(t,e){var n,o,r,i,a,s,l,u=Re(t,e),c=P.Wx;return c&&(n=c.jy(u)),u.isEditing()?(o=u.Jl,r=u.Kl,i=u.getValue(o,r,3,1),!!u.endEdit(!0)&&((s=(a=u.ITa)&&a.ZHb)&&s.getAnchorCell(o,r)||u.setValue(o,r,i,3,!0),!0)):m(n)?(P.Yxb(u.parent),u.uu=k,u.parent.uu.hZ(),(l=u).ex&&l.ex(),void(l.Sob&&l.Sob())):n}},P.Yxb=function(t){var e,n,o,r=t&&t.sheets;if(r)for(e=0,n=r.length;e<n;e++)(o=r[e])&&o.at&&o.at.ky()},P[et]={canUndo:!1,execute:function(t,e){var n,o=Re(t,e);return!o.isEditing()&&(n=o.getSelections(),o.wu().execute({cmd:Dt,sheetName:o.name(),ranges:n}),!0)}},P[nt]={canUndo:!1,execute:function(t,e){var n=Re(t,e);return!n.isEditing()&&(l.Ul.sl()?(P[et].execute(t,e),!0):(n.startEdit(!0,""),!0))}},P[Ct]={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=e.copyData=n.ux(e.ignoreClipboard);return e.callback&&e.callback(),!o||M}},P.cut={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=e.cutData=n.sx(e.ignoreClipboard);return e.callback&&e.callback(),!o||M}},P[bt]={canUndo:!1,execute:function(t,e){Re(t,e).vx(e)}},P[st]={canUndo:!1,execute:Ne(37)},P[lt]={canUndo:!1,execute:Ne(39)},P[ut]={canUndo:!1,execute:Ne(38)},P[ct]={canUndo:!1,execute:Ne(40)},P[ft]={canUndo:!1,execute:Ne(37,!0)},P[ht]={canUndo:!1,execute:Ne(39,!0)},P[pt]={canUndo:!1,execute:Ne(33)},P[dt]={canUndo:!1,execute:Ne(34)},P[gt]={canUndo:!1,execute:Ne(38,!0)},P[mt]={canUndo:!1,execute:Ne(40,!0)},P[yt]={canUndo:!1,execute:Ne(36,!0)},P[vt]={canUndo:!1,execute:Ne(35,!0)},P[Lt]={canUndo:!1,execute:function(t,e){var n=Re(t,e),o=n&&n.mm;if(o){fe(n);try{o.ly&&o.ly()}finally{he(n)}}}},P[wt]={canUndo:!1,execute:function(t){var e;t&&((e=t.undoManager())&&e.canUndo()&&e.undo())}},P[Tt]={canUndo:!1,execute:function(t){var e;t&&((e=t.undoManager())&&e.canRedo()&&e.redo())}},P[xt]={canUndo:!0,execute:function(t,e,n){return ke(t,zt,e,n)}},P[St]={canUndo:!0,execute:function(t,e,n){return ke(t,Wt,e,n)}},P[It]={canUndo:!0,execute:function(t,e,n){return ke(t,Ut,e,n)}},P[At]={canUndo:!0,execute:function(t,e,n){return ke(t,qt,e,n)}},P[Rt]={canUndo:!0,execute:function(t,e,n){return ke(t,Yt,e,n)}},P[kt]={canUndo:!0,execute:function(t,e,n){return ke(t,Xt,e,n)}},P[Mt]={canUndo:!0,execute:function(t,e,n){return ke(t,Zt,e,n)}},P[Nt]={canUndo:!0,execute:function(t,e,n){return ke(t,Qt,e,n)}},P[Et]={canUndo:!0,execute:function(t,e,n){return ke(t,Jt,e,n)}},P[Dt]={canUndo:!0,execute:function(t,e,n){return ke(t,Kt,e,n)}},P[Ot]={canUndo:!0,execute:function(t,e,n){return ke(t,ee,e,n)}},Ht=function(){function t(t,e,n){var o=this;o.kj=t,o.my=e,o.ny=n,o.oy=[],o.Iu=[],o.py()}return t.prototype.py=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,m,y,v,C,b,w,T,x,S,A,I,R=this,N=R.my,E=R.kj;if(E&&N){if(t=R.ny,e=N.row,n=N.col,o=ie(N),r=ae(N),i=R.oy,a=!1,-1===e&&(a=!0,e=0,o=oe(E)),-1===n&&(a=!0,n=0,r=re(E)),l=[],(64&t)>0)for(c=0;c<r;c++)l[c]=E.Aj(-1,c)||k;for(f=0;f<o;f++)for(h=e+f,(64&t)>0&&(s=E.Aj(h,-1)||k),p=0;p<r;p++){if(d=void 0,m=n+p,g&&(2&t)>0&&E.getFormulaInformation&&(d=E.getFormulaInformation(h,m)).hasFormula)if(d.isArrayFormula){if((y=d.baseRange).row===h&&y.col===m)for(v=y.row,C=y.row+ie(y);v<C;v++)for(b=y.col,w=y.col+ae(y);b<w;b++)R.qy(i,v-e,b-n,d,2)}else R.qy(i,f,p,d.formula,2);!((1&t)>0)||d&&d.hasFormula||R.qy(i,f,p,E.getValue(h,m,3),1),(16&t)>0&&E.getSparkline&&(T=E.getSparkline(h,m),x=k,T&&(x=T.data()),T&&x&&R.qy(i,f,p,T,16)),(64&t)>0&&(S=void 0,a?S=E.getActualStyle(h,m,3):(u=E.Aj(h,m)||k,S=E.Dq(h,m,3,u,s,l[p])),A=M,S&&S.toJSON&&(A=JSON.stringify(S.toJSON(3,!0))),R.qy(i,f,p,A,64)),I=E.ITa.Ky,(4&t)>0&&I&&R.qy(i,f,p,I.get(h,m),4),(128&t)>0&&R.qy(i,f,p,E.getTag(h,m,3),128),(256&t)>0&&R.qy(i,f,p,E.getBindingPath&&E.getBindingPath(h,m,3),256),(1024&t)>0&&R.qy(i,f,p,E.getHyperlink&&E.getHyperlink(f,p,3),1024)}}},t.prototype.sy=function(){return this.oy},t.prototype.qy=function(t,e,n,o,r){!m(o)&&t&&(t[e]===M&&(t[e]=[]),t[e][n]===M&&(t[e][n]={}),t[e][n][Bt[r]]=o)},t.prototype.uy=function(t){var e,n,o,r,i,a,s,l;if(t)for(this,e=this.oy,n=0,o=t.length;n<o;n++)if(r=t[n])for(i=0,a=r.length;i<a;i++)(s=r[i])&&(e[n]||(e[n]=[]),(l=e[n][i])?this.vy(s,l)&&(e[n][i]=M):e[n][i]=s)},t.prototype.vy=function(t,e){var n,o,r,i=this.ny,a=[];for(256&i&&a.push(Bt[256]),4&i&&a.push(Bt[4]),2&i&&a.push(Bt[2]),16&i&&a.push(Bt[16]),64&i&&a.push(Bt[64]),128&i&&a.push(Bt[128]),1024&i&&a.push(Bt[1024]),1&i&&a.push(Bt[1]),n=0,o=a.length;n<o;n++)if(t[r=a[n]]!==e[r])return!1;return!0},t.prototype.wy=function(){var t,e,n,o,r,i=this,a=i.my.row,s=i.my.col,l=i.oy,u=i.Iu;if(u&&u.length>0)return u;for(u=[],a=-1===a?0:a,s=-1===s?0:s,t=0,e=l.length;t<e;t++)if(n=l[t])for(o=0,r=n.length;o<r;o++)n[o]&&u.push({row:t+a,col:o+s});return i.Iu=u,u},t}(),P.xy=Ht,P.Bu=function(t,e,n,o,r,i,a,s,l){t&&(e<0&&(e=0,o=oe(t)),n<0&&(n=0,r=re(t)),t.Bu(e,n,o,r,i,a,M,M,s,l))},P.bWa=function(t){return"changes"+t},P.cWa=function(t){return t&&(0!==t.length||!h.isEmptyObject(t))},P.aWa=function(t){var e,n=t.sheetName;return"string"==typeof n?e=[n]:Array.isArray(n)&&(e=n),!!e&&e.every((function(e){var n=P.bWa(e),o=t[n];return o&&0===o.length&&h.isEmptyObject(o)}))},P.startTransaction=function(t,e){je(t,e.sheetName).forEach((function(t){t.ITa.startTransaction()}))},P.endTransaction=function(t,e){je(t,e.sheetName).forEach((function(t){var n=P.bWa(t.name());e[n]=t.ITa.endTransaction()}))},P.undoTransaction=function(t,e){je(t,e.sheetName).forEach((function(t){var n=P.bWa(t.name());t.ITa.undo(e[n]),t.$p()}))},P.Zxb=function(t){t.forEach((function(t){t.ITa.startTransaction()}))},P.$xb=function(t,e){t.forEach((function(t){var n=P.bWa(t.name());e[n]=t.ITa.endTransaction()}))},P._xb=function(t,e){t.forEach((function(t){var n=P.bWa(t.name());t.ITa.undo(e[n])}))},Vt=function(){function t(t,e){this.Lz=Fe,this.Mz=Pe;this.kj=t,this.VQ=e}return t.prototype.execute=function(){},t.prototype.canExecute=function(){return!0},t.prototype.canUndo=function(){return!0},t.prototype.undo=function(){return!0},t}(),P.ActionBase=Vt,zt=function(t){function e(e,n){var o=t.call(this,e,n)||this;return _e(n,e),o}return ne(e,t),e.prototype.execute=function(){var t,e,n,o,r,i,a,s,l,u,c,f,p,d,g=this,m=!1;if(g.canExecute()&&(t=g.VQ,e=g.kj,n=t.columns,o=t.rowHeader,r=n&&n.length,e&&r>0)){if(i=g.Sz(n),a={sheet:e,sheetName:e.name(),colList:i,header:o,cancel:!1},e.Wq(w,a),a&&!0===a.cancel)return m;t.Tz=!0,e.ITa.startTransaction(),Fe(e);try{for(2,3,s=re(e,o?2:3),e.qq=t.qq,l=t.size,u=0;u<r;u++)for(f=(c=n[u]).firstCol,p=c.lastCol,d=f;d<=p;d++)0<=d&&d<s&&(o&&e.getColumnResizable(d,2)&&l!==e.$r(d,2)?(e.setColumnWidth(d,l,2),m=!0):!o&&e.getColumnResizable(d,3)&&l!==e.$r(d,3)&&(e.setColumnWidth(d,l,3),m=!0))}finally{de(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:i,header:t.rowHeader}),he(e),t[P.bWa(e.name())]=e.ITa.endTransaction()}e.qs()}return m},e.prototype.undo=function(){var t,e,n,o,r,i,a,s,l=this,u=!1;if(l.canUndo()&&(t=l.VQ,e=l.kj,n=t.columns,o=t.rowHeader,r=n&&n.length,e&&r>0)){if(i=l.Sz(n),a={sheet:e,sheetName:e.name(),colList:i,header:o,cancel:!1},e.Wq(w,a),a&&!0===a.cancel)return u;Fe(e);try{s=P.bWa(e.name()),e.ITa.undo(t[s]),e.oq=!0,e.showCell(e.getActiveRowIndex(),e.getActiveColumnIndex(),1,1),u=!0}finally{de(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:i,header:t.rowHeader}),he(e)}}return u},e.prototype.Sz=function(t){var e,n,o,r,i,a,s=[];for(e=0,n=t.length;e<n;e++)for(r=(o=t[e]).firstCol,i=o.lastCol,a=r;a<=i;a++)s.push(a);return s},e.prototype.canUndo=function(){return this.VQ.Tz},e}(Vt),Wt=function(t){function e(e,n){var o=t.call(this,e,n)||this;return _e(n,e),o}return ne(e,t),e.prototype.execute=function(){var t,e,n,o,r,i,a,s,l,u,c,f,p,d,g=this,m=!1;if(g.canExecute()&&(t=g.kj,o=(n=(e=g.VQ).rows)&&n.length,t&&o>0)){if(r=g.Vz(n),i={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.Wq(x,i),i&&!0===i.cancel)return m;e.Tz=!0,t.ITa.startTransaction(),Fe(t);try{for(3,1,s=oe(t,(a=e.columnHeader)?1:3),t.lq=e.lq,l=e.size,u=0;u<o;u++)for(f=(c=n[u]).firstRow,p=c.lastRow,d=f;d<=p;d++)0<=d&&d<s&&(a&&t.getRowResizable(d,1)&&l!==t.Yr(d,1)?(t.setRowHeight(d,l,1),m=!0):!a&&t.getRowResizable(d,3)&&l!==t.Yr(d,3)&&(t.setRowHeight(d,l,3),m=!0))}finally{de(t),h[h.sd]({tc:t.parent}),t.Wq(S,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),he(t),e[P.bWa(t.name())]=t.ITa.endTransaction()}t.os()}return m},e.prototype.undo=function(){var t,e,n,o,r,i,a,s=this,l=!1;if(s.canUndo()&&(t=s.kj,o=(n=(e=s.VQ).rows)&&n.length,t&&o>0)){if(r=s.Vz(n),i={sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader,cancel:!1},t.Wq(x,i),i&&!0===i.cancel)return l;Fe(t);try{a=P.bWa(t.name()),t.ITa.undo(e[a]),t.jq=!0,t.showCell(t.getActiveRowIndex(),t.getActiveColumnIndex(),1,1),l=!0}finally{de(t),h[h.sd]({tc:t.parent}),t.Wq(S,{sheet:t,sheetName:t.name(),rowList:r,header:e.columnHeader}),he(t)}}return l},e.prototype.Vz=function(t){var e,n,o,r,i,a,s=[];for(e=0,n=t.length;e<n;e++)for(r=(o=t[e]).firstRow,i=o.lastRow,a=r;a<=i;a++)s.push(a);return s},e.prototype.canUndo=function(){return this.VQ.Tz},e}(Vt),Ut=function(t){function e(e,n){var o=t.call(this)||this,r=o;return r.kj=e,r.VQ=n,o}return ne(e,t),e.prototype.execute=function(){var t,e,n,o,r,i,a,s=this,l=!1,u=s.VQ,c=s.kj,f=u.columns,p=u.rowHeader,d=s.Sz(f);if(c&&f&&f.length>0){if(t={sheet:c,sheetName:c.Cj,colList:d,header:p,cancel:!1},c.Wq(w,t),t&&!0===t.cancel)return l;c.ITa.startTransaction(),s.Lz(c);try{e=D(u.size),n=p?2:3,o=f[0].firstCol,void 0,i=void 0,a=void 0,e!==(r=c.$r(o,n))&&(i=e-r,a=c.Zq(o,n),c.setColumnWidth(o,e,n),c.setColumnWidth(a,c.$r(a,n)-i,n)),l=!0}finally{de(c),h[h.sd]({tc:c.parent}),c.Wq(T,{sheet:c,sheetName:c.Cj,colList:d,header:u.rowHeader}),he(c),u[P.bWa(c.name())]=c.ITa.endTransaction()}}return l},e.prototype.undo=function(){var t,e=this.kj,n=this.VQ.columns,o=!1,r=this.VQ,i=this.VQ.rowHeader,a=this.Sz(n),s={sheet:e,sheetName:e.Cj,colList:a,header:i,cancel:!1};if(e.Wq(w,s),s&&!0===s.cancel)return o;Fe(e);try{t=P.bWa(e.name()),e.ITa.undo(r[t]),o=!0}finally{de(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.Cj,colList:a,header:r.rowHeader}),he(e)}return o},e.prototype.Sz=function(t){var e,n,o,r,i,a,s=[];for(e=0,n=t.length;e<n;e++)for(r=(o=t[e]).firstCol,i=o.lastCol,a=r;a<=i;a++)s.push(a);return s},e}(Vt),qt=function(t){function e(e,n){var o=t.call(this)||this,r=o;return r.kj=e,r.VQ=n,o}return ne(e,t),e.prototype.execute=function(){var t,e,n,o,r,i,a,s=this,l=!1,u=s.VQ,c=s.kj,f=u.rows,p=u.columnHeader,d=s.Vz(f);if(c&&f&&f.length>0){if(t={sheet:c,sheetName:c.Cj,rowList:d,header:p,cancel:!1},c.Wq(x,t),t&&!0===t.cancel)return l;c.ITa.startTransaction(),s.Lz(c);try{e=D(u.size),n=p?1:3,o=f[0].firstRow,void 0,i=void 0,a=void 0,e!==(r=c.Yr(o,n))&&(i=e-r,a=c._q(o,n),c.setRowHeight(o,e,n),c.setRowHeight(a,c.Yr(a,n)-i,n)),l=!0}finally{de(c),h[h.sd]({tc:c.parent}),c.Wq(S,{sheet:c,sheetName:c.Cj,rowList:d,header:u.columnHeader}),he(c),u[P.bWa(c.name())]=c.ITa.endTransaction()}}return l},e.prototype.undo=function(){var t,e=this.kj,n=this.VQ.rows,o=!1,r=this.VQ,i=this.VQ.columnHeader,a=this.Vz(n),s={sheet:e,sheetName:e.Cj,rowList:a,header:i,cancel:!1};if(e.Wq(x,s),s&&!0===s.cancel)return o;Fe(e);try{t=P.bWa(e.name()),e.ITa.undo(r[t]),o=!0}finally{de(e),h[h.sd]({tc:e.parent}),e.Wq(S,{sheet:e,sheetName:e.Cj,rowList:a,header:r.columnHeader}),he(e)}return o},e.prototype.Vz=function(t){var e,n,o,r,i,a,s=[];for(e=0,n=t.length;e<n;e++)for(r=(o=t[e]).firstRow,i=o.lastRow,a=r;a<=i;a++)s.push(a);return s},e}(Vt),Yt=function(t){function e(e,n){var o=t.call(this,e,n)||this,r=o,i=e.parent;return r.Wz=n.rowHeader?2:3,I(n.autoFitType)||(n.autoFitType=i?i.options.autoFitType:0),o}return ne(e,t),e.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.columns&&t.columns.length>0},e.prototype.execute=function(){var t,e,n,o,r,i,a,s,u,c,f,p,d,g,y=this,v=!1;if(y.canExecute()){if(t=y.VQ,e=y.kj,n=y.Wz,o=y.Sz(t.columns),r=2===n,i={sheet:e,sheetName:e.name(),colList:o,header:r,cancel:!1},e.Wq(w,i),i&&!0===i.cancel)return v;for(t.Tz=!0,s=(a=re(e,n))-1,u=0,c=void 0,f=0,p=t.columns.length;f<p;f++)s=s>(c=t.columns[f].col)?c:s,u=u<c?c:u;l.mn.qn(e,0,s,oe(e)-1,u),e.ITa.startTransaction(),Fe(e);try{for(d=void 0,f=0,p=t.columns.length;f<p;f++)0<=(g=t.columns[f].col)&&g<a&&e.getColumnResizable(g,n)&&((d=y.xl(g))===e.getColumnWidth(g,n)&&m(e.getColumnWidth(g,n,!0))||(e.setColumnWidth(g,d,n),v=!0))}finally{l.mn.Nm(),de(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:o,header:r}),he(e),t[P.bWa(e.name())]=e.ITa.endTransaction()}}return v},e.prototype.undo=function(){var t,e,n,o,r,i,a,s=this,l=!1;if(s.canUndo()){if(t=s.VQ,e=s.kj,n=s.Wz,o=s.Sz(t.columns),r=2===n,i={sheet:e,sheetName:e.name(),colList:o,header:r,cancel:!1},e.Wq(w,i),i&&!0===i.cancel)return l;Fe(e);try{a=P.bWa(e.name()),e.ITa.undo(t[a]),l=!0}finally{de(e),h[h.sd]({tc:e.parent}),e.Wq(T,{sheet:e,sheetName:e.name(),colList:o,header:r}),he(e)}}return l},e.prototype.Sz=function(t){var e,n,o=[];for(e=0;e<t.length;e++)n=t[e],o.push(n.col);return o},e.prototype.xl=function(t){return l.Ul.xl(t,this.kj,this.Wz,this.VQ.autoFitType)},e.prototype.canUndo=function(){return this.VQ.Tz},e}(Vt),Xt=function(t){function e(e,n){var o=t.call(this,e,n)||this,r=o,i=e.parent;return r.Wz=n.columnHeader?1:3,I(n.autoFitType)||(n.autoFitType=i?i.options.autoFitType:0),o}return ne(e,t),e.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.rows&&t.rows.length>0},e.prototype.execute=function(){var t,e,n,o,r,i,a,s,l,u,c,f=this,p=!1;if(f.canExecute()){if(t=f.VQ,e=f.kj,n=f.Vz(t.rows),o=f.Wz,r=1===f.Wz,i={sheet:e,sheetName:e.name(),rowList:n,header:r,cancel:!1},e.Wq(x,i),i&&!0===i.cancel)return p;t.Tz=!0,e.ITa.startTransaction(),Fe(e);try{for(a=oe(e,o),s=void 0,l=0,u=t.rows.length;l<u;l++)0<=(c=t.rows[l].row)&&c<a&&e.getRowResizable(c,o)&&((s=f.Fl(c))===e.getRowHeight(c,o)&&m(e.getRowHeight(c,o,!0))||(e.setRowHeight(c,s,o),p=!0))}finally{de(e),h[h.sd]({tc:e.parent}),e.Wq(S,{sheet:e,sheetName:e.name(),rowList:n,header:r}),he(e),t[P.bWa(e.name())]=e.ITa.endTransaction()}}return p},e.prototype.undo=function(){var t,e,n,o,r,i,a=this,s=!1;if(a.canUndo()){if(t=a.VQ,e=a.kj,n=a.Vz(t.rows),o=1===a.Wz,r={sheet:e,sheetName:e.name(),rowList:n,header:o,cancel:!1},e.Wq(x,r),r&&!0===r.cancel)return s;Fe(e);try{i=P.bWa(e.name()),e.ITa.undo(t[i]),s=!0}finally{de(e),h[h.sd]({tc:e.parent}),e.Wq(S,{sheet:e,sheetName:e.name(),rowList:n,header:o}),he(e)}}return s},e.prototype.Vz=function(t){var e,n,o,r=[];for(e=0,n=t.length;e<n;e++)o=t[e],r.push(o.row);return r},e.prototype.Fl=function(t){return l.Ul.Fl(t,this.kj,this.Wz,this.VQ.autoFitType)},e.prototype.canUndo=function(){return this.VQ.Tz},e}(Vt),Zt=function(t){function e(e,n){var o,r,i=t.call(this,e,n)||this;return g&&n.ranges&&1===n.endEditType&&(o=e.Tq(n.ranges[0]),n.ranges[0]=o,1===ie(o)&&1===ae(o)&&((r=e.Ms(o.row,o.col,1,1))&&r.ranges&&r.ranges.length>0&&(n.ranges=[r.ranges[0]]))),i}return ne(e,t),e.prototype.canExecute=function(){var t,e,n=this.kj,o=this.VQ,r=o.ranges,i=o.row,a=o.col;if(r){for(t=0;t<r.length;t++)if(e=r[t],!n.Y3(e.row,e.col,ie(e),ae(e)))return!1}else if(!n.Y3(i,a,1,1))return!1;return!0},e.prototype.yA=function(t){var e,n,o,r,i=this.VQ,a=i.ranges;if(a)for(e=0;e<a.length;e++)for(o=(n=a[e]).row;o<n.row+ie(n);o++)for(r=n.col;r<n.col+ae(n);r++)t(o,r);else t(i.row,i.col)},e.prototype.undo=function(){var t,e,n,o=this;if(o.canUndo()){t=o.kj,e=o.VQ,Fe(t,!0);try{t.Fu(b+Gt,(function(e,n){Le(t,n)})),n=P.bWa(t.name()),t.ITa.undo(e[n])}catch(t){return!1}finally{t.Gu(b+Gt),Pe(t,!0)}return!0}return!1},e.prototype.execute=function(){var t,e,n,o,r=this,i=!1;if(r.canExecute()){(t=r.kj).ITa.startTransaction(),Fe(t,!0);try{t.Fu(b+Gt,(function(e,n){Le(t,n)})),r.VQ.applyResult=r.AA(),i=!0}catch(t){i=!1}finally{t.Gu(b+Gt),Pe(t,!0),e=P.bWa(t.name()),r.VQ[e]=t.ITa.endTransaction()}n=t.am(),o=new l.Rect(n.kt,n.nt,n.width-n.kt,n.height-n.nt),t.repaint(o)}return i},e.prototype.zA=function(t,e){return t+"_"+e},e.prototype.BA=function(t){var e,n,o,r,i,a=this,s=0,l=a.kj,u=a.VQ,c=u.row,f=u.col,h=u.newValue,p=!u.hasOwnProperty("autoFormat")||u.autoFormat;return g&&h&&h.length>0&&"="===h[0]?l.getDataValidator&&l.getDataValidator(c,f)&&(""!==(e=h.substring(1))&&e!==l.getFormula(c,f)&&((n=l.Cf())&&((o=n.parse(l.yj(),e,c>=0?c:0,f>=0?f:0,!0))&&(r=n.Hg(l.yj(),o,{row:c,col:f}),l.isValid&&!l.isValid(c,f,r)&&(s=l.Nx(c,f)))))):(i=a.CA(c,f,h,p,t),!l.isValid||l.isValid(c,f,i)||(s=l.Nx(c,f),l.mm.DA=!0)),s},e.prototype.AA=function(){var t,e,n,o,r,i,u,c,f,h,p,m,y,v,C=this,b=C.kj,w=C.VQ,T=w.newValue,x={tka:!1,uka:!1,_autoFormatter:M,quotePrefix:M},S=C.BA(x);if(1===S||2===S)return S;if(e=!w.hasOwnProperty("autoFormat")||w.autoFormat,n=(n=w.row)>=0?n:0,o=(o=w.col)>=0?o:0,g&&d&&d.Parser)if(u=b.Cf(),f=(c=b.parent)&&c.options.allowUserEditFormula,"@"!==b.getFormatter(n,o)&&f&&u&&T&&T.length>0&&"="===T[0])try{if(w.ranges&&1===w.endEditType)return i=w.ranges[0],b.setArrayFormula(i.row,i.col,ie(i),ae(i),T.substring(1)),S;r=u.parse(b.yj(),T.substring(1),n,o,!0)}catch(t){throw b.Os(0,"string"==typeof t?t:t.message),t}else w.ranges&&1===w.endEditType&&(i=w.ranges[0],b.getRange(i.row,i.col,ie(i),ae(i),3).clear(1));return r||(T&&"'"===T[0]?C.Uia(n,o,!0,x):C.Uia(n,o,M,x),t=C.CA(n,o,T,e,x)),C.yA((function(e,n){if(r)try{b._u(e,n,u.unparse(b.yj(),r,e,n),r),b.Wq(l.Events.UserFormulaEntered,{sheet:b,sheetName:b.name(),row:e,col:n,isCircularReference:b.ngc(e,n),formula:T.substring(1).toUpperCase()})}catch(t){throw b.Os(0,"string"==typeof t?t:t.message),t}else{try{b.hasFormula&&b.hasFormula(e,n)&&b.setFormula(e,n,k)}catch(t){throw b.Os(0,"string"==typeof t?t:t.message),t}try{b.uq(e,n,t,w.sheetArea),"string"!=typeof t&&null!==t||s.Worksheet.ao(b,"setHyperlinkWhenEditing",{url:t,row:e,col:n,sheetArea:w.sheetArea})}catch(t){b.setValue(e,n,T)}}})),h=x.tka,p=x.uka,(h||p)&&(y="string"==typeof(m=b.Aj(n,o)),m&&!y||(v=new a.Style,y&&(v.parentName=m),m=v),h&&(m._autoFormatter=x._autoFormatter),p&&(m.quotePrefix=x.quotePrefix),b.setStyle(n,o,m)),S},e.prototype.canUndo=function(){return 0===this.VQ.applyResult},e.prototype.CA=function(t,e,n,o,r){var i,a,s,u=this.kj,c=this.VQ,f=u.getActualStyle(t,e),h={};return i="string"==typeof n?n&&"'"===n[0]?n.substring(1):l.Ul.ul(f,n,o,h,c.editingFormatter):n,r.quotePrefix?(r._autoFormatter=M,r.tka=!0):(a=h.value,o&&a&&(s=k,(i!==k&&"General"!==a.formatString()||!f._autoFormatter)&&(a.isAuto=!0,s=a),s&&(r.tka=!0,r._autoFormatter=s))),i},e.prototype.Uia=function(t,e,n,o){var r,i=this.kj.Aj(t,e),s="string"==typeof i;i&&!s||(r=new a.Style,s&&(r.parentName=i),i=r),i.quotePrefix!==n&&(o.uka=!0,o.quotePrefix=n)},e}(Vt),Qt=function(t){function e(e,n){return t.call(this,e,n)||this}return ne(e,t),e.prototype.canUndo=function(){return!!this.VQ.FA},e.prototype.canExecute=function(){var t=this.VQ;return this.kj&&t.name&&t.name!==t.FA},e.prototype.execute=function(){var t=this,e=t.kj,n=t.VQ,o=n.name,r=!1;return t.canExecute()&&(n.FA=e.name(),e.ITa.startTransaction(),Fe(e,!0),ge(e),e.cq(o),Be(e),n[P.bWa(e.name())]=e.ITa.endTransaction(),r=!0,n.sheetName=o,me(e,!1),Pe(e,!0)),r},e.prototype.undo=function(){var t,e,n,o=this;return!(!o.canUndo()||(t=o.kj,e=o.VQ,!t)||(Fe(t,!0),ge(t),n=P.bWa(t.name()),t.ITa.undo(e[n]),Be(t),e.sheetName=e.FA,me(t,!1),Pe(t,!0),0))},e}(Vt),Jt=function(t){function e(e,n){return t.call(this,e,n)||this}return ne(e,t),e.prototype.canExecute=function(){var t=this;return t.kj&&t.kj.parent.options.allowUserZoom&&t.kj.zoom()!==t.VQ.zoomFactor},e.prototype.execute=function(){var t,e,n,o=this,r=o.VQ,i=!1;return o.canExecute()&&(e=(t=o.kj).ITa,n=r.zoomFactor,e.startTransaction(),i=function(t,e){return!(!0===t.isEditing()&&!t.endEdit()||(t.suspendPaint(),t.zoom(e),t.resumePaint(),0))}(t,n),e.ZVa(["zoomChanged",n,r.oldZoomFactor]),r[P.bWa(t.name())]=t.ITa.endTransaction()),i},e.prototype.undo=function(){var t,e=this.kj;if(this.canUndo())return!(!0===e.isEditing()&&!e.endEdit()||(e.suspendPaint(),t=P.bWa(e.name()),e.ITa.undo(this.VQ[t]),e.resumePaint(),0))},e}(Vt),$t=function(t){function e(e,n){return t.call(this,e,n)||this}return ne(e,t),e.prototype.execute=function(){var t,e,n,o,r,i,a,s,l,u,c=this;c.canExecute()&&(t=c.kj,e=c.VQ.clearRange,n=t.tables&&t.tables.$Hb&&t.tables.$Hb(e.row,e.col,e.rowCount,e.colCount),t.isDirtySuspended()||(c.VQ.Iu=new Ht(t,t.Tq(e),3)),n&&n.length>0&&(c.VQ.tableNames=n),r=(o=t.Tq(e)).row,i=o.col,a=ie(o),(s=ae(o))>0&&a>0&&(t.ITa.startTransaction(),Fe(t),t.vxb=!0,t.cg(r,i,a,s,3,1,!0),Pe(t),t.vxb=!1,l=P.bWa(t.name()),c.VQ[l]=t.ITa.endTransaction(),u=c.VQ.Iu,P.Bu(t,r,i,a,s,u?u.wy():[],2,n)))},e.prototype.canExecute=function(){var t=this.VQ.clearRange;return this.kj.Y3(t.row,t.col,ie(t),ae(t))},e.prototype.canUndo=function(){var t=P.bWa(this.kj.name()),e=this.VQ[t];return P.cWa(e)},e.prototype.undo=function(){var t,e,n,o=this,r=o.kj;if(o.canUndo()&&r&&(ae(t=r.Tq(o.VQ.clearRange))>0&&ie(t)>0)){Fe(r);try{e=P.bWa(r.name()),r.ITa.undo(o.VQ[e])}finally{Pe(r)}return n=o.VQ.Iu,P.Bu(r,t.row,t.col,ie(t),ae(t),n?n.wy():[],2,o.VQ.tableNames,!0),!0}return!1},e}(Vt),Kt=function(t){function e(e,n,o){var r,i,a=t.call(this,e,n)||this;if(!o&&(n.MA=[],(r=n.ranges)&&r.length>0))for(i=0;i<r.length;i++)n.MA[i]=new $t(e,{clearRange:r[i]});return a}return ne(e,t),e.prototype.canExecute=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canExecute())return!1;return!0}return!1},e.prototype.execute=function(){var t,e,n,o=this;if(o.canExecute()&&(t=o.VQ.MA,e=o.kj,t)){for(Fe(e,!0),n=0;n<t.length;n++)t[n].execute();return Pe(e,!0),!0}return!1},e.prototype.canUndo=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canUndo())return!1;return!0}return!1},e.prototype.undo=function(){var t,e,n,o,r=this,i=r.VQ.MA;if(r.canUndo()){for(t=r.kj,e=i.length-1;e>=0;e--)if(n=i[e],Fe(t,!0),o=n.undo(),Pe(t,!0),!o)return!1;return!0}return!1},e}(Vt),P.OA=Kt,te=function(t){function e(e,n){return t.call(this,e,n)||this}return ne(e,t),e.qx=function(t){var e=0;return 0!==t&&1!==t||(e|=1),0!==t&&2!==t||(e|=64,e|=32),0!==t&&3!==t||(e|=2),0!==t&&4!==t||(e|=1,e|=64,e|=32),0!==t&&5!==t||(e|=64,e|=32,e|=2),0===t&&(e|=32,e|=16,e|=256,e|=4,e|=512,e|=128,e|=1024),e},e.prototype.canExecute=function(){var t=this.VQ,e=t.pasteExtent,n=e.targetRange,o=e.sourceRange;return t.toSheet.Y3(n.row,n.col,ie(n),ae(n))&&(!e.isCutting||t.fromSheet.Y3(o.row,o.col,ie(o),ae(o)))},e.prototype.oUa=function(){var t=this,n=t.VQ.pasteExtent,o=t.VQ.io={},r=n.isCutting,i=e.qx(t.VQ.pasteOption),a=n.sourceRange,s=n.targetRange,l=t.VQ.fromSheet,u=t.VQ.toSheet;l&&a&&r&&!l.isDirtySuspended()&&(o.cA=new Ht(l,a,i)),u.isDirtySuspended()||(o.fA=new Ht(u,s,i))},e.prototype.VA=function(){return this.VQ.pasteExtent.targetRange},e.prototype._Hb=function(t,e,n,o,r){var i,a=!1,s=e.row,l=e.col,u=e.rowCount,c=e.colCount,h=!1,p=!1,d=!1,g=!1,m=se(r),y=!1,v=!1;if(t||u%n.rowCount!=0||c%n.colCount!=0){if(o===f.InsertShiftCell.right){if(s!==n.row&&n.intersect(s,l,n.rowCount,r.getColumnCount()-l))return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(l>n.col&&l<=n.col+n.colCount-1&&s>n.row&&s<=n.row+n.rowCount-1)return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.aIb(r,s,l,n.rowCount,r.getColumnCount()-l))return r.Os(1,F().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,s,r.getColumnCount()-n.colCount,n.rowCount,n.colCount))&&!m)return r.Os(1,F().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};s===n.row&&l<=n.col&&(n.col=n.col+n.colCount,h=!0)}else if(o===f.InsertShiftCell.down){if(l!==n.col&&n.intersect(s,l,r.getRowCount()-s,n.colCount))return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(s>n.row&&s<=n.row+n.rowCount-1&&l>n.col&&l<=n.col+n.colCount-1)return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.cIb(r,s,l,r.getRowCount()-s,n.colCount))return r.Os(1,F().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,r.getRowCount()-n.rowCount,l,n.rowCount,n.colCount))&&!m)return r.Os(1,F().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};l===n.col&&s<=n.row&&(n.row=n.row+n.rowCount,p=!0)}}else if(a=!0,o===f.InsertShiftCell.right){if(i=!1,s<=n.row&&s+u>=n.row+n.rowCount&&(i=!0),l>n.col&&l<=n.col+n.colCount-1&&s>n.row&&s<=n.row+n.rowCount-1)return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(!i&&n.intersect(s,l,u,r.getColumnCount()-l))return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.aIb(r,s,l,u,r.getColumnCount()-l))return r.Os(1,F().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,s,r.getColumnCount()-c,u,c))&&!m)return r.Os(1,F().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};i&&l<=n.col&&(n.col=n.col+c,d=!0)}else if(o===f.InsertShiftCell.down){if(i=!1,l<=n.col&&l+c>=n.col+n.colCount&&(i=!0),s>n.row&&s<=n.row+n.rowCount-1&&l>n.col&&l<=n.col+n.colCount-1)return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(!i&&n.intersect(s,l,r.getRowCount()-s,c))return r.Os(1,F().Exp_InsertCopiedCutCells),{returnFunc:v=!0};if(this.cIb(r,s,l,r.getRowCount()-s,c))return r.Os(1,F().Exp_InsertCopiedCutCellsOnSpanTable),{returnFunc:v=!0};if((y=this.bIb(r,r.getRowCount()-u,l,u,c))&&!m)return r.Os(1,F().Exp_InsertCopiedCutCellsNoRange),{returnFunc:v=!0};i&&s<=n.row&&(n.row=n.row+u,g=!0)}return{changePasteDataRangeCol:h,changePasteDataRangeRow:p,changePasteDataRangeCols:d,changePasteDataRangeRows:g,moveRangeHaveValue:y,returnFunc:v,selectRange:a}},e.prototype.dIb=function(t,e,n,o,r,i,a,s,l){var u,c,h=!1,p=!1;return t?e===f.InsertShiftCell.right?n.Vq(i,a+l,s,n.getColumnCount()-a-l,!0)?a+l<n.getColumnCount()?(n.moveTo(i,a,i,a+l,s,n.getColumnCount()-a-l,1023),(c=(u=n.rowFilter())&&u.range)&&-1===i&&c.colCount>1&&a>c.col&&a<=c.col+c.colCount-1&&(c.colCount=c.colCount+r.colCount)):a+l>n.getColumnCount()&&(h=!0,p=!0):(h=!0,p=!0):e===f.InsertShiftCell.down&&(n.Vq(i+s,a,n.getRowCount()-i-s,l,!0)?i+s<n.getRowCount()?n.moveTo(i,a,i+s,a,n.getRowCount()-i-s,l,1023):i+s>n.getRowCount()&&(h=!0,p=!0):(h=!0,p=!0)):e===f.InsertShiftCell.right?n.Vq(i,a+r.colCount,r.rowCount,n.getColumnCount()-a-r.colCount,!0)?a+r.colCount<n.getColumnCount()?(n.moveTo(i,a,i,a+r.colCount,r.rowCount,n.getColumnCount()-a-r.colCount,1023),(c=(u=n.rowFilter())&&u.range)&&-1===i&&c.colCount>1&&a>c.col&&a<=c.col+c.colCount-1&&(c.colCount=c.colCount+r.colCount)):a+r.colCount>n.getColumnCount()&&(h=!0,p=!0):(h=!0,p=!0):e===f.InsertShiftCell.down&&(n.Vq(i+r.rowCount,a,n.getRowCount()-i-r.rowCount,r.colCount,!0)?i+r.rowCount<n.getRowCount()?n.moveTo(i,a,i+r.rowCount,a,n.getRowCount()-i-r.rowCount,r.colCount,1023):i+r.rowCount>n.getRowCount()&&(h=!0,p=!0):(h=!0,p=!0)),{raiseInvalidOperation:h,returnFunc:p}},e.prototype.ogc=function(t,e,n,o,r,i,a){t&&(e.col=e.col-e.colCount),n&&(e.row=e.row-e.rowCount),o&&(e.col=e.col-i),r&&(e.row=e.row-a)},e.prototype.execute=function(){var t,n,o,r,i,a,s,u,c,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,N,E,D,O,j,_,L,B,G,H,V,z,W,U,q,Y=this;if(Y.canExecute()){if(t=Y.VQ.fromSheet,n=Y.VQ.toSheet,o=Y.VQ.pasteExtent,r=Y.VQ.pasteOption,i=o.sourceRange,a=o.targetRange,s=o.isCutting,t&&i&&!t.pu(i.row,i.col,ie(i),ae(i),oe(t),re(t)))return;if(!(n&&a&&n.l5(a.row,a.col,ie(a),ae(a),!0)))return;if(n.tables&&n.tables.zxb(t,i,n,a,s))return;if(u=void 0,c=void 0,h=void 0,t&&(h=t.tu(),u=Y.WHb,c=Y.YHb),p=void 0,d=void 0,g=void 0,m=void 0,y=void 0,Y.XHb&&(p=Y.XHb.row,d=Y.XHb.col,g=Y.XHb.rowCount,m=Y.XHb.colCount),v=!1,C=!1,b=!1,w=!1,T=se(n),x=!1,u!==M&&c){if((S=this._Hb(s,Y.XHb,c,u,n)).returnFunc)return;v=S.changePasteDataRangeCol,C=S.changePasteDataRangeRow,b=S.changePasteDataRangeCols,w=S.changePasteDataRangeRows,x=S.moveRangeHaveValue,y=S.selectRange}Y.oUa(),A=n.parent.sheets,P.Zxb(A),fe(n),pe(n),n.vxb=!0,I=!1,t&&(pe(t),t.vxb=!0);try{if(T&&(R=-1,k=-1,-1!==a.row?R=a.row+ie(a):-1===i.row&&(R=oe(t)),E=R-(N=oe(n)),R>N&&Y.vTa(i,a)?u===f.InsertShiftCell.down&&x?n.addRows(N,E+(N-p)):n.addRows(N,E):x||p+a.rowCount!==oe(n)||u!==f.InsertShiftCell.down?x&&u===f.InsertShiftCell.down&&n.addRows(N,E+(N-p)):n.addRows(N,E+(N-p)-c.rowCount),-1!==a.col?k=a.col+ae(a):-1===i.col&&(k=re(t)),k>re(n)&&Y.vTa(i,a)?u===f.InsertShiftCell.right&&x?n.setColumnCount(k+n.getColumnCount()-d):n.setColumnCount(k):x||d+a.colCount!==re(n)||u!==f.InsertShiftCell.right?x&&u===f.InsertShiftCell.right&&n.setColumnCount(k+n.getColumnCount()-d):n.setColumnCount(k+n.getColumnCount()-d-c.colCount)),I=(D=u!==M&&this.dIb(y,u,n,Y.XHb,c,p,d,g,m)).raiseInvalidOperation,D.returnFunc)return;i&&l.mn.qn(t,i.row,i.col,i.row+ie(i)-1,i.col+ae(i)-1);try{if(O=!1,t)for(j=i.row;j<i.row+i.rowCount&&!O;j++)for(_=i.col;_<i.col+i.colCount;_++)if(t.getValue(j,_)){O=!0;break}n.tables&&(O||o.clipboardText.replace(/[\r\n\t]/gi,""))&&n.tables.fIb(a,i)}catch(t){return n.Os(6,t.message),void n.resumePaint()}n.px(t,i,n,a,o.isCutting,o.clipboardText,o.clipboardHtml,o.clipboardImage,r,!o.includeFilteredOutRow)}finally{i&&l.mn.Nm(),de(n),n.vxb=!1,t&&(de(t),t.vxb=!1),he(n),P.$xb(A,Y.VQ),L=Y.VQ.io,B=e.qx(r),o.isCutting&&t&&(G=[],t.isDirtySuspended()||((H=new Ht(t,i,B)).uy(L.cA.sy()),L._z=H,G=H.wy()),P.Bu(t,i.row,i.col,ie(i),ae(i),G,3)),n&&(V=[],n.isDirtySuspended()||((z=new Ht(n,a,B)).uy(L.fA.sy()),L.dA=z,V=z.wy()),W=n.tables&&n.tables.$Hb&&n.tables.$Hb(a.row,a.col,a.rowCount,a.colCount),U=ie(a),q=ae(a),P.Bu(n,a.row,a.col,U,q,V,3,W),Y.tableNamesObj={r:a.row,c:a.col,rc:U,cc:q,tableNames:W}),Y.pgc={changePasteDataRangeCol:v,changePasteDataRangeRow:C,changePasteDataRangeCols:b,changePasteDataRangeRows:w,acColCount:m,acRowCount:g},h&&delete h.UHb,I&&n.Os(1,F().Exp_InsertCopiedCutCellsNoRange)}}},e.prototype.aIb=function(t,e,n,o,r){var i,a,s,l=t.ITa.getSpans(),u=t.tables.l$;for(i=0;i<l.length;i++)if(!(e<=(a=l[i]).row&&n<=a.col&&e+o>=a.row+a.rowCount&&n+r>=a.col+a.colCount||a.row>e+o||a.row+a.rowCount-1<e||a.row>e+o-1||a.row+a.rowCount-1<e||a.col+a.colCount-1<n))return!0;for(i=0;i<u.length;i++)if(!(e<=(s=u[i]).cj&&n<=s.dj&&e+o>=s.cj+s.Xj&&n+r>=s.dj+s.OZ||s.cj>e+o||s.cj+s.Xj-1<e||s.cj>e+o-1||s.cj+s.Xj-1<e||s.dj+s.OZ-1<n))return!0;return!1},e.prototype.cIb=function(t,e,n,o,r){var i,a,s,l=t.ITa.getSpans(),u=t.tables.l$;for(i=0;i<l.length;i++)if(!(e<=(a=l[i]).row&&n<=a.col&&e+o>=a.row+a.rowCount&&n+r>=a.col+a.colCount||a.col>n+r||a.col+a.colCount-1<n||a.col>n+r-1||a.col+a.colCount-1<n||a.row+a.rowCount-1<e))return!0;for(i=0;i<u.length;i++)if(!(e<=(s=u[i]).cj&&n<=s.dj&&e+o>=s.cj+s.Xj&&n+r>=s.dj+s.OZ||s.dj>n+r||s.dj+s.OZ-1<n||s.dj>n+r-1||s.dj+s.OZ-1<n||s.cj+s.Xj-1<e))return!0;return!1},e.prototype.bIb=function(t,e,n,o,r){var i,a,s,l,u,c,f,h=t.ITa.getSpans(),p=t.tables.l$;for(i=e;i<e+o;i++)for(a=n;a<n+r;a++){if(s=t.getCell(i,a),!m(s.value())||s.backColor()||s.comment()||s.tag())return!0;for(l=0;l<h.length;l++)if(i>=(u=h[l]).row&&i<=u.row+u.rowCount-1&&a>=u.col&&a<=u.col+u.colCount-1)return!0;for(c=0;c<p.length;c++)if(i>=(f=p[c]).cj&&i<=f.cj+f.Xj-1&&a>=f.dj&&a<=f.dj+f.OZ-1)return!0}return!1},e.prototype.vTa=function(t,e){var n,o,r,i;return!t||(n=t.row,o=t.col,r=e.row,i=e.col,-1!==n&&-1!==o||-1===n&&-1!==o&&r<=0||-1===o&&-1!==n&&i<=0||-1===n&&-1===o&&r<=0&&i<=0)},e.prototype.undo=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,v,C,b,w,T,x,S=this;if(S.canUndo()){if(t=S.VQ.fromSheet,e=S.VQ.toSheet,o=(n=S.VQ.pasteExtent).sourceRange,r=n.targetRange,!e||!r)return!1;if(S.pgc&&(i=S.pgc,this.ogc(i.changePasteDataRangeCol,o,i.changePasteDataRangeRow,i.changePasteDataRangeCols,i.changePasteDataRangeRows,i.acColCount,i.acRowCount)),!e.pu(r.row,r.col,ie(r),ae(r),oe(e),re(e)))return!1;if(t&&o){if(!t.pu(o.row,o.col,ie(o),ae(o),oe(t),re(t)))return!1;if(t&&t.name()===e.name()&&e.parent&&!y(e.parent.sheets,t))return!1}a=S.VQ.io,fe(e);try{s=r.row<0?0:r.row,l=r.col<0?0:r.col,u=r.row<0?oe(e):ie(r),c=r.col<0?re(e):ae(r),f=e.parent.sheets,P._xb(f,S.VQ),(p=(h=e.rowFilter())&&h.range)&&-1===r.row&&p.col<r.col&&p.col+p.colCount>=r.col+r.colCount&&(p.colCount=p.colCount-r.colCount),d=0,g=0,m=0,v=0,t&&o&&(d=o.row<0?0:o.row,g=o.col<0?0:o.col,m=o.row<0?oe(t):ie(o),v=o.col<0?re(t):ae(o)),C=[],b=[],(w=S.tableNamesObj)&&(e&&w.r===s&&w.c===l&&w.rc===u&&w.cc===c&&(b=w.tableNames),t&&w.r===d&&w.c===g&&w.rc===m&&w.cc===v&&(C=w.tableNames)),e&&(T=a.dA,P.Bu(e,s,l,u,c,T?T.wy():[],3,C,!0)),t&&(x=a._z,P.Bu(t,d,g,m,v,x?x.wy():[],3,b,!0))}finally{he(e)}}return!0},e}(Vt),ee=function(t){function e(e,n,o){var r,i,a,s,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M=t.call(this,e,n)||this;if(!o){if(r=e,i=n.fromSheet,!r)throw Error(F().Exp_DestSheetIsNull);if((s=(a=n).pastedRanges)&&s.length>0)if(n.MA=[],c=(u=a.fromRanges||[a.fromRange]).length,f=a.isCutting,h=a.clipboardText,p=a.clipboardHtml,d=a.clipboardImage,g=a.pasteOption,m={},y=s[0],!f&&i&&i.r5(u,m)&&y.equals(i.q5(u,y))){for(v=m.inSameRow,C=m.inSameCol,v?u.sort((function(t,e){return t.col-e.col})):C&&u.sort((function(t,e){return t.row-e.row})),b=y.row,w=y.col,T=0;T<c;T++)S=(x=u[T]).rowCount,A=x.colCount,I={sourceRange:x,targetRange:l.kf(b,w,S,A),isCutting:f,clipboardText:h,clipboardHtml:p,clipboardImage:d,includeFilteredOutRow:!0},n.MA[T]=new te(e,{fromSheet:i,toSheet:r,pasteExtent:I,pasteOption:g}),v?w+=A:C&&(b+=S);n.s5=!0}else for(R=0;R<s.length;R++)k={sourceRange:u[0],targetRange:s[R],isCutting:f,clipboardText:h,clipboardHtml:p,clipboardImage:d},n.MA[R]=new te(e,{fromSheet:i,toSheet:r,pasteExtent:k,pasteOption:g})}return M}return ne(e,t),e.prototype.execute=function(){var t,e,n,o,r,i,a,s,u=this,c=u.VQ,f=c.MA,h=!1;if(u.canExecute()&&f){Fe(e=(t=u.kj).parent.getActiveSheet(),!0);try{for(n=!1,o=0;o<f.length;o++)(r=f[o]).WHb=c.WHb,r.XHb=c.XHb,r.YHb=c.YHb,t?(i=r.VQ.pasteExtent,a={sheet:t,sheetName:t.name(),cellRange:r.VA(),pasteOption:r.VQ.pasteOption,pasteData:{text:i.clipboardText,html:i.clipboardHtml},shiftCells:c.WHb,cancel:!1},(s=i.clipboardImage)&&(a.pasteData.image=s),t.Wq(l.Events.ClipboardPasting,a),a.cancel||(h=r.execute(),delete a.cancel,n=!0,t.Wq(l.Events.ClipboardPasted,a))):h=r.execute();n&&u.WA()}finally{Pe(e,!0)}}return h},e.prototype.WA=function(){var t,e,n,o,r,i=this.VQ,a=i.MA,s=this.kj;if(s&&a){if(t=s.getSelections(),s.Tr(),i.s5)e=i.pastedRanges[0],s.addSelection(e.row,e.col,ie(e),ae(e));else if(a.length>1)for(n=0;n<a.length;n++)o=a[n].VA(),s.addSelection(o.row,o.col,ie(o),ae(o));else a.length>0&&(r=a[0].VA(),s.addSelection(r.row,r.col,ie(r),ae(r)),r.contains(s.Jl,s.Kl)||s.Jr(r.row,r.col));s.yu(t,s.getSelections())&&s.Au(t)}},e.prototype.canExecute=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canExecute())return!1;return!0}return!1},e.prototype.canUndo=function(){var t,e=this.VQ.MA;if(e){for(t=0;t<e.length;t++)if(!e[t].canUndo())return!1;return!0}return!1},e.prototype.undo=function(){var t,e,n,o,r=this,i=r.VQ.MA;if(r.canUndo()&&i){t=!0,Fe(e=r.kj.parent.getActiveSheet(),!0);try{for(n=i.length-1;n>=0;n--)o=i[n],t=t&&o.undo()}finally{Pe(e,!0)}return t}return!1},e}(Vt)},"./dist/core/worksheet/worksheet-border.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function A(t,e,n,o,r,s,l){switch(s!==i&&s!==a||(s=1),s){case 1:return new y(t,e,n,o,r,1,l);case 2:return new y(t,e,n,o,r,2,l);case 5:return new y(t,e,n,o,r,3,l);case 3:return new v(t,e,n,o,r,1,[3,1],l);case 9:return new v(t,e,n,o,r,1,[8,2,2,2],l);case 4:return new v(t,e,n,o,r,1,[2,2],l);case 11:return new v(t,e,n,o,r,1,[9,3,3,3,3,3],l);case 13:return new C(t,e,n,o,r,t!==n,[11,1,5,1],[10,2,4,2],l);case 10:return new v(t,e,n,o,r,2,[9,3,3,3],l);case 12:return new v(t,e,n,o,r,2,[9,3,3,3,3,3],l);case 8:return new v(t,e,n,o,r,2,[9,3],l);case 7:return new v(t,e,n,o,r,1,[1],l);case 6:return new w(t,e,n,o,r,l)}return a}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/worksheet/style.js"),r=n("./dist/core/util/domUtil.js"),i=void 0,a=null,s=Math.sqrt,l=Math.pow,u=Math.min,c=Math.abs,f=Math.tan,Math.floor,h=Math.PI,r.GC$.inherit,p=r.GC$.isEmptyObject,d={LEFT_TOP:0,RIGHT_TOP:1,RIGHT_BOTTOM:2,LEFT_BOTTOM:3},g={H_TOP_LEFT:0,H_TOP_Right:1,V_RIGHT_TOP:2,V_RIGHT_BOTTOM:3,H_BOTTOM_RIGHT:4,H_BOTTOM_LEFT:5,V_LEFT_BOTTOM:6,V_LEFT_TOP:7},m=function(){function t(){}return t.prototype.mE=function(t){var e=this;0===t._orientation?(t.nE&&(e.oE+=t.nE),t.pE&&(e.qE+=t.pE)):(t.nE&&(e.rE+=t.nE),t.pE&&(e.sE+=t.pE))},t.prototype.jp=function(t){var e=this.tE||"#9eb6ce",n=this.uE,o=t.lineWidth,r=t.strokeStyle;o===n&&r===e||(o!==n&&(t.lineWidth=n),r!==e&&(t.strokeStyle=e)),this.hWa(t)},t.prototype.hWa=function(t){var e,n,o=this;o.qE===o.oE||o.sE===o.rE?(t.beginPath(),o.vE(t),t.stroke()):(t.save(),e=Math.min(o.qE,o.oE),n=Math.min(o.sE,o.rE),t.rect(e,n,Math.abs(o.oE-o.qE),Math.abs(o.rE-o.sE)),t.clip(),t.beginPath(),o.vE(t),t.stroke(),t.beginPath(),t.restore())},t.prototype.vE=function(t){var e=this;t.moveTo(e.qE,e.sE),t.lineTo(e.oE,e.rE)},t}(),y=function(t){function e(e,n,o,r,i,a,s){var l,u=t.call(this)||this;return a%2||(e!==o?(n-=.5,r-=.5):(e-=.5,o-=.5)),(l=u).qE=e,l.sE=n,l.oE=o,l.rE=r,l.tE=i,l.uE=a,l.gIb=s,u}return S(e,t),e}(m),v=function(t){function e(e,n,o,r,i,a,s,l){var u,c=t.call(this)||this;return a%2||(e!==o?(n-=.5,r-=.5):(e-=.5,o-=.5)),(u=c).qE=e,u.sE=n,u.oE=o,u.rE=r,u.tE=i,u.uE=a,u.wE=s,u.gIb=l,c}return S(e,t),e.prototype.vE=function(t){var n=this;e.yl(t,n.qE,n.sE,n.oE,n.rE,n.wE)},e.yl=function(t,e,n,o,r,i){var a,c,f=s(l(o-e,2)+l(r-n,2)),h=(o-e)/f,p=(r-n)/f,d=0,g=0;for(i=i&&i.length?i:[4,4];d<f;)d+=a=u(i[g%i.length],f-d),(c=++g%2)&&t.moveTo(e,n),e+=a*h,n+=a*p,c&&t.lineTo(e,n)},e}(m),C=function(t){function e(e,n,o,r,i,a,s,l,u){var c,f=t.call(this)||this;return a?(e-=1,o-=1):(n-=1,r-=1),(c=f).qE=e,c.sE=n,c.oE=o,c.rE=r,c.tE=i,c.xE=a,c.uE=1,c.yE=s,c.zE=l,c.gIb=u,f}return S(e,t),e.prototype.vE=function(t){var e=this,n=e.xE?0:1,o=e.xE?1:0;v.yl(t,e.qE-n,e.sE-o,e.oE-n,e.rE-o,e.yE),v.yl(t,e.qE,e.sE,e.oE,e.rE,e.zE)},e}(m),b=function(t){function e(e,n,o,r,i,a,s){var l=t.call(this)||this,u=l;return u.qE=e,u.sE=n,u.oE=o,u.rE=r,u.tE=i,u.iWa=a,u.gIb=s,u.AE=new y(u.qE,u.sE,u.oE,u.rE,i,1,s),u.BE=null,l}return S(e,t),e.prototype.hWa=function(t){this.AE&&this.AE.hWa(t),this.BE&&this.BE.hWa(t)},e.prototype.mE=function(t){var e=this;e.BE?(t.pE&&e.AE&&e.AE.mE(t),t.nE&&e.BE.mE(t)):e.AE&&e.AE.mE(t)},e.prototype.jWa=function(t){var e,n,o,r,i,a,s,l,u=this;t&&t.severX&&t.severY?(e=t.severX||0,n=t.severY||0,e=u.iWa?e:-e,i=(o=parseInt(u.qE+(u.oE-u.qE)/2,10))-e,a=(r=parseInt(u.sE+(u.rE-u.sE)/2,10))-n,s=o+e,l=r+n,u.AE=new y(u.qE,u.sE,i,a,u.tE,1,u.gIb),u.BE=new y(s,l,u.oE,u.rE,u.tE,1,u.gIb)):(u.AE=new y(u.qE,u.sE,u.oE,u.rE,u.tE,1,u.gIb),u.BE=null)},e}(m),w=function(t){function e(e,n,o,r,i,a){var s=t.call(this)||this,l=s,u=0,c=0;return e===o&&(u=1),n===r&&(c=1),e!==o&&n!==r?a?(u=2,l.AE=new y(e-u,n,o-u,r,i,1,a),l.BE=new y(e+u,n,o+u,r,i,1,a)):(u=2,c=2,e>o?(l.AE=new b(e-u,n,o,r-c,i,!1,a),l.BE=new b(e,n+c,o+u,r,i,!1,a)):(l.AE=new b(e,n+c,o-u,r,i,!0,a),l.BE=new b(e+u,n,o,r-c,i,!0,a))):(l.AE=new y(e-u,n-c,o-u,r-c,i,1,a),l.BE=new y(e+u,n+c,o+u,r+c,i,1,a)),l.gIb=a,l.tE=i,l.uE=1,s}return S(e,t),e.prototype.hWa=function(t){this.AE.hWa(t),this.BE.hWa(t)},e.prototype.mE=function(t){var e=this;t.CE?1===t.CE?e.AE.mE(t):2===t.CE&&e.BE.mE(t):(e.AE.mE(t),e.BE.mE(t))},e.prototype.jWa=function(){var t={severX:1,severY:1},e=this.AE,n=this.BE;e.jWa(t),n.jWa(t)},e}(m),e.zF=A,T=function(){function t(){}return t.DE=function(e,n,o){var r,i;return e?n?0!==(i=(r=t.EE)[e.style]-r[n.style])||o?i:n.level-e.level:1:n?-1:0},t.FE=function(t){if(t){if(t.isGridLine)return 1;if(t.style)return o.LineBorder.Vo(t.style)}return 0},t.GE=function(t){return t&&6===t.style},t.HE=function(t){return t&&13===t.style},t.IE=function(e,n){return e?n?t.DE(e.style,n.style)>=0?e:n:e:n},t.JE=function(t,e){t&&t.line&&t.line.mE(e)},t.KE=function(e,n,o){return e===n?0:e?n?e.isGridLine?n.isGridLine?0:-1:n.isGridLine?1:t.DE(e.style,n.style,o):1:-1},t.LE=function(t){return t&&t.style&&6===t.style.style},t.ME=function(t,e,n,o){if(t.style&&6===t.style.style)return!0;var r=0;return r+=e&&e.style&&6===e.style.style?1:0,r+=n&&n.style&&6===n.style.style?1:0,(r+=o&&o.style&&6===o.style.style?1:0)<2},t.NE=function(t,e,n,o,r,i){var a={_orientation:i?1:0,pE:0,nE:0},s=this.KE(t,n),l=this.KE(t,o);s>=0&&l>=0?0===s&&0===l?-1!==r&&1===r&&(a.nE-=r):-1===r?a.pE-=r:1===r&&(a.nE-=2*r):l>=0?(a.CE=2,a.pE+=r):s>=0&&(a.CE=1,a.pE+=r),this.JE(t,a)},t.OE=function(e,n,o,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,v={_orientation:l?1:0,CE:u?2:1,pE:0,nE:0},C={_orientation:l?1:0,CE:u?1:2,pE:0,nE:0},b=1===a?r:i,w=1===s?o:n;this.LE(w)?0===(c=this.KE(e,b))?0===(f=this.KE(e,w))?1===s&&(C.nE-=s):f>0&&(-1===s?C.pE-=2*s:1===s&&(C.nE-=2*s)):c>0?0===(h=this.KE(e,w))?1===s&&(C.nE-=s):h>0&&(-1===s?C.pE-=2*s:1===s&&(C.nE-=2*s)):0===(p=this.KE(e,w))?-1===s?v.pE+=2*s:1===s&&(v.nE+=2*s):p>0&&(-1===s?v.pE-=3*s:1===s&&(v.nE-=3*s)):this.KE(e,b)>=0?-1===s?C.pE-=2*s:1===s&&(C.nE-=2*s):-1===s?v.pE+=2*s:1===s&&(v.nE+=2*s),d=1===(1===a?2:1)?r:i,g=!1,m=0,this.LE(d)&&this.KE(d,e)>0&&(g=!0,y=t.FE(d),this.KE(d,b)>0?y>0&&(m=1===s&&this.LE(o)?y>=2?2:1:-1===s&&this.LE(n)?y>=3?2:1:3===y?3:2):m=3===y?3:2),g||this.LE(w)||!(w&&!w.isGridLine||d&&!d.isGridLine)||(g=!0,m=-1===s?2:1),g&&(-1===s?(v.pE+=s*m,C.pE+=s*m):1===s&&(v.nE+=s*m,C.nE+=s*m)),(v.pE||v.nE)&&this.JE(e,v),(C.pE||C.nE)&&this.JE(e,C)},t.PE=function(t,e,n,o,r,i){if(this.KE(t,n)>=0&&this.KE(t,o)>=0){var a={_orientation:i?1:0,pE:0,nE:0};-1===r?(a.pE-=2*r,this.LE(t)&&this.KE(e,t)>0&&(a.pE-=1)):1===r&&(a.nE-=2*r,this.LE(t)&&this.KE(e,t)>0&&(a.nE+=1)),this.JE(t,a)}},t.QE=function(e,n,o,r,i,a){var s,l,u;this.LE(e)&&((s=this.IE(o,r))&&!s.isGridLine&&((l=t.FE(s))>0&&(u={_orientation:a?1:0,pE:0,nE:0},-1===i?u.pE+=l*i:u.nE+=l*i,(u.pE||u.nE)&&this.JE(e,u))))},t.RE=function(e,n,o,r,i,a,s){var l,u,c,f,h=t;(n||o||r)&&(c=h.IE(o,r),h.ME(e,n,o,r)?(u=h.KE(c,e,!0))>0?(l=h.FE(c),h.LE(e)&&(h.LE(o)||h.LE(r)||h.LE(n))||3===l&&h.JE(e,{_orientation:0,pE:1})):c&&u<0?(u=h.KE(e,n,!0))>0?3===(l=h.FE(c))||2===l?h.JE(e,{_orientation:0,pE:-2}):1===l&&h.JE(e,{_orientation:0,pE:-1}):0!==u&&h.KE(n,c,!0)>0&&(3===(l=h.FE(c))&&h.JE(e,{_orientation:0,pE:1})):0===u&&(!n||h.KE(e,n,!0)>0)&&(3===(l=h.FE(c))||2===l?h.JE(e,{_orientation:0,pE:-2}):1===l&&h.JE(e,{_orientation:0,pE:-1})):h.JE(e,{_orientation:0,pE:1})),(i||a||s)&&(f=h.IE(a,s),h.ME(e,i,a,s)?(u=h.KE(f,e,!0))>0?(l=h.FE(f),h.LE(e)&&(h.LE(a)||h.LE(s)||h.LE(i))||(3===l?h.JE(e,{_orientation:0,nE:-2}):2!==l&&1!==l||h.JE(e,{_orientation:0,nE:-1}))):u<=0&&((u=h.KE(e,i,!0))>0?3===(l=h.FE(f))&&h.JE(e,{_orientation:0,nE:1}):0!==u&&h.JE(e,{_orientation:0,nE:-1})):h.JE(e,{_orientation:0,nE:-2}))},t.SE=function(e,n,o,r,i,s,l){var u,c,f,h,p=t;(n||o||r)&&(f=p.IE(o,r),c=p.KE(f,e,!0),p.ME(e,n,o,r)?c>0?(u=p.FE(f),p.LE(e)&&(p.LE(o)||p.LE(r)||p.LE(n))||3===u&&p.JE(e,{_orientation:1,pE:1})):c<0?(c=p.KE(e,n,!0))>0?3===(u=p.FE(f))||2===u?p.JE(e,{_orientation:1,pE:-2}):1===u&&p.JE(e,{_orientation:1,pE:-1}):0!==c&&p.KE(n,f,!0)>0&&(3===(u=p.FE(f))&&p.JE(e,{_orientation:1,pE:1})):0===c&&p.KE(e,n,!0)>0&&(3===(u=p.FE(f))||2===u?p.JE(e,{_orientation:1,pE:-2}):1===u&&p.JE(e,{_orientation:1,pE:-1})):p.JE(e,{_orientation:1,pE:1})),(i||s||l)&&(h=p.IE(s,l),c=p.KE(e,h,!0),p.ME(e,i,s,l)?c<0?(u=p.FE(h),p.LE(e)&&(p.LE(s)||p.LE(l)||p.LE(i))||(3===u||2===u?p.JE(e,{_orientation:1,nE:-2}):1===u&&p.JE(e,{_orientation:1,nE:-1}))):h!==a&&c>=0&&((c=p.KE(e,i,!0))>0?3===(u=p.FE(h))&&p.JE(e,{_orientation:1,nE:1}):0!==c&&p.JE(e,{_orientation:1,nE:-1})):p.JE(e,{_orientation:1,nE:-2}))},t.TE=function(e,n,o,r,i,a,s,l){var u,c,f,h,p=t;l?this.SE(e,n,o,r,i,a,s):this.RE(e,n,o,r,i,a,s),u=p.LE(o),c=p.LE(r),f=p.LE(n),u&&c&&f?p.NE(e,n,o,r,-1,l):u&&!c?p.OE(e,n,i,o,r,1,-1,l,!0):!u&&c?p.OE(e,n,i,o,r,2,-1,l,!1):u&&c&&!f?p.PE(e,n,o,r,-1,l):f&&p.QE(e,n,o,r,-1,l),u=p.LE(a),c=p.LE(s),h=p.LE(i),u&&c&&h?p.NE(e,i,a,s,1,l):u&&!c?p.OE(e,n,i,a,s,1,1,l,!0):!u&&c?p.OE(e,n,i,a,s,2,1,l,!1):u&&c&&!h?p.PE(e,i,a,s,1,l):h&&p.QE(e,i,a,s,1,l)},t.EE=[0,101,199,100,100,300,90,100,198,100,198,100,198,198],t.kWa=function(t,e){return!(!t||!e||t.color!==e.color||t.level!==e.level||t.style!==e.style)},t}(),x=function(){function t(t,e,n,o){var r=this;r.UE=!1,r.VE=!1,r.kj=t,r.Wz=o,r.hIb=e,r.pJ=n}return t.prototype.YE=function(){var t,e,n,o,r,i,a,s,l,u,c=this;if(c.ZE=[],c.$E=[],c._E=[],c.aF=[],c.bF=[],c.cF={},c.dF={},c.eF={},c.fF={},c.lWa={},c.mWa={},c.C$a={},t=c.hIb,e=c.pJ,t&&t.length>0&&e&&e.length>0){for(n=c.$E,o=t.length,r=void 0,i=0;i<o;i++)(r=t[i]).height>0&&n.push(r.row);for(n.push(n[n.length-1]+1),a=c._E,s=e.length,l=void 0,u=0;u<s;u++)(l=e[u]).width>0&&a.push(l.col);a.push(a[a.length-1]+1)}c.UE=!0},t.prototype.gF=function(t,e,n,o,r,i,a,s){if(n){var l={cj:t,dj:e,hF:n.startColumn,iF:n.endColumn,Wqa:o,XHa:r,YHa:i,Vo:a,_v:s};this.aF.push(l)}},t.prototype.jF=function(t,e,n,o,r,i,a,s,l,u,c){var f,h,p,d,g,m,y,v,C,b,w=this;w.UE||w.YE(),s?w.ZE.push(s):(f=void 0,h=void 0,p=void 0,d=void 0,g=void 0,m=void 0,y=void 0,v=void 0,C=void 0,b=void 0,a&&(f=a.borderLeft,h=a.borderTop,p=a.borderRight,d=a.borderBottom,b=a.backColor,g=a.diagonalDown,m=a.diagonalUp,y=a.textOrientation,v=a.isVerticalText,C=a.textIndent),!b||f||p||h||d||w.bF.push({r:t,c:e,rc:1,cc:1}),w.kF(t,e,n,o,r,i,f,h,p,d,g,m,b,!1,!1,l,u,y,v,C&&0!==C,c))},t.prototype.kF=function(t,e,n,o,r,a,s,l,u,p,d,g,m,y,v,C,b,w,T,x,S){var A,I,R,k,M,N,E=this,D=!1,O=!1,j=!1,F=!1,P=w!==i&&w&&-90<=w&&w<=90,_=n;P&&(s||l||u||p)&&!T&&!x&&S&&(A=c(w*h/180),I=f(A),R=Math.floor(a/I),w>-90&&w<0&&(_=n-R),w>0&&w<90&&(_=n+R)),d&&!P&&E.lF(t,e,n-1,o-1,n+r,o+a,d,E.lWa),g&&!P&&E.lF(t,e,n+r,o-1,n-1,o+a,g,E.mWa),l&&a>0&&(D=E.lF(t,e,_,o-.5,_+r,o-.5,l,E.eF,P)),s&&r>0&&(O=E.lF(t,e,_-.5,o,n-.5,o+a,s,E.fF,P)),u&&r>0&&(F=E.lF(t,e+1,_+r-.5,o,n+r-.5,o+a,u,E.fF,P)),p&&a>0&&(j=E.lF(t+1,e,n,o+a-.5,n+r,o+a-.5,p,E.eF,P)),k=E.kj,m&&0!==k.ss.Sl(t)&&0!==k.ss._m(e)||(N=!F&&!v,((M=!j&&!y)||N||!D&&!y||!O&&!v)&&E.mF(t,e,n,o,r,a,M,N,C,b)),!D&&!m||P||E.nF(t-1,e,E.cF),(O||m)&&E.nF(t,e-1,E.dF),!m||s||u||l||p||(E.oF(t-1,e-1,E.dF,!1),E.oF(t-1,e-1,E.cF,!0))},t.prototype.lF=function(t,e,n,o,r,i,s,l,u){if(s){var c=this.pF(t,e,l,!0);return c?(u||6!==c.style.style&&(6===s.style||T.DE(s,c.style)>0))&&(c.line=A(n,o,r,i,s.color,s.style,u),c.style=s):((c=this.pF(t,e,l)).line=A(n,o,r,i,s.color,s.style,u),c.style=s),c.line!==a}return!1},t.prototype.mF=function(t,e,n,o,r,i,a,s,l,u){var c,f,h,p,d,g=this,m=3===g.Wz,y=g.kj.options.gridline;m&&y&&(c=y.color,y.showHorizontalGridline&&(a&&((f=g.pF(t,e,g.cF)).isGridLine=!0,f.line=A(n,o+i-.5,n+r,o+i-.5,c)),l&&((h=g.pF(-1,e,g.cF,!1,!0)).isGridLine=!0,h.line=A(n,o-.5,n+r,o-.5,c))),y.showVerticalGridline&&(s&&((p=g.pF(t,e,g.dF)).isGridLine=!0,p.line=A(n+r-.5,o,n+r-.5,o+i,c)),u&&((d=g.pF(t,-1,g.dF,!1,!0)).isGridLine=!0,d.line=A(n-.5,o,n-.5,o+i,c))))},t.prototype.oF=function(t,e,n,o){var r,i=this.pF(t,e,n,!0);i&&((r=i).line&&r.line.mE({_orientation:o?0:1,nE:-1}))},t.prototype.nF=function(t,e,n){var o;(t>=0&&e>=0||0===t&&-1===e||-1===t&&0===e)&&((o=n[t])&&(o[e]&&delete o[e]))},t.prototype.pF=function(t,e,n,o,r){var i,s;if(!r&&(-1===t||-1===e))return a;if(!(i=n[t])){if(o)return a;n[t]=i={}}if(!(s=i[e])){if(o)return a;i[e]=s={}}return s},t.prototype.qF=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,I,R,k=this,M=k.aF,N=M.length,E=k.fF,D=k.eF,O=k.dF,j=k.cF;for(t=0;t<N;t++)if(n=(e=M[t]).cj,o=e.dj,r=e.hF,i=e.Wqa,a=e.iF,void 0,s=e.XHa,l=e.Vo,u=e._v,c=s,f=void 0,h=i.textOrientation,p=i.borderTop,!(d=M[t-1])||d.cj!==n||d.hF!==r||d.iF!==a){for(g=r;g<a;g++)k.pF(n,g+1,E,!0)&&!h?k.nF(n,g+1,E):k.pF(n,g,O,!0)&&k.nF(n,g,O);if(m=k.pF(n,o,D,!0),h&&p&&!m)for(void 0,y=u/Math.tan(Math.abs(h*Math.PI/180)),h>-90&&h<0&&(c=s-y),h>0&&h<90&&(c=s+y),f=c+l,v=r;v<a+1;v++)if(b=(C=k.pF(n-1,v,j,!0))&&C.line)for(C.splitLines||(C.splitLines=[],C.splitLines.push(b)),w=0;w<C.splitLines.length;w++)if(x=(T=C.splitLines[w]).qE,S=T.oE,I=T.sE,R=T.rE,c>x&&f>S&&S>c)T.oE=c;else if(c<x&&f>S)k.nF(n-1,v,k.cF);else if(c<x&&f<S&&x<f)T.qE=f;else if(c>x&&f<S){C.splitLines.splice(w,1,A(x,I,c,I,T.color),A(f,R,S,R,T.color));break}}},t.prototype.rF=function(){var t,e,n=this.ZE,o=n.length;if(o>0)for(e=0;e<o;e++)t=n[e],this.sF(t)},t.prototype.D$a=function(){var t,e,n,o,r,i,a,s;if(this.C$a={},(e=(t=this.ZE).length)>0)for(o=0;o<e;o++)for(n=t[o],r=0;r<n.rowCount;r++)for(i=r+n.row,this.C$a[i]=this.C$a[i]||{},a=0;a<n.colCount;a++)s=a+n.col,this.C$a[i][s]=n},t.prototype.sF=function(t){var e,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v=this,C=t.row,b=t.col,w=t.x,x=t.y,S=t.spanSizeInfo,A=S.styleList[0][0],I=A?A.backColor:a,R=w,k=x,M=null,N=!0,E=null,D=!0;if(1===t.rowCount){for(s=C,u=S.rowSizes[0],i=0;i<t.colCount;i++)f=0===i,p=i===t.colCount-1,l=b+i,c=S.colSizes[i],g=S.styleList[0][i],s===t.row&&l===t.col&&(M=(m=g)&&m.diagonalDown,E=m&&m.diagonalUp),g?(e=g.borderLeft,n=g.borderTop,o=g.borderRight,r=g.borderBottom,N&&(N=T.kWa(M,g.diagonalDown)),D&&(D=T.kWa(E,g.diagonalUp))):e=n=o=r=a,f?v.kF(s,l,R,k,c,u,e,n,a,r,a,a,I,!1,!0):p?v.kF(s,l,R,k,c,u,a,n,o,r,a,a,I,!1,!1):v.kF(s,l,R,k,c,u,a,n,a,r,a,a,I,!1,!0),R+=c;M=N?M:null,E=D?E:null,v.kF(t.row,t.col,t.x,t.y,t.width,t.height,a,a,a,a,M,E,a,!0,!0)}else if(1===t.colCount){for(l=b,c=S.colSizes[0],i=0;i<t.rowCount;i++)h=0===i,d=i===t.rowCount-1,s=C+i,u=S.rowSizes[i],g=S.styleList[i][0],s===t.row&&l===t.col&&(M=(m=g)&&m.diagonalDown,E=m&&m.diagonalUp),g?(e=g.borderLeft,n=g.borderTop,o=g.borderRight,r=g.borderBottom,N&&(N=T.kWa(M,g.diagonalDown)),D&&(D=T.kWa(E,g.diagonalUp))):e=n=o=r=a,h?v.kF(s,l,R,k,c,u,e,n,o,a,a,a,I,!0,!1):d?v.kF(s,l,R,k,c,u,e,a,o,r,a,a,I,!1,!1):v.kF(s,l,R,k,c,u,e,a,o,a,a,a,I,!0,!1),k+=u;M=N?M:null,E=D?E:null,v.kF(t.row,t.col,t.x,t.y,t.width,t.height,a,a,a,a,M,E,a,!0,!0)}else{for(i=0;i<t.rowCount;i++){for(s=C+i,h=0===i,d=i===t.rowCount-1,u=S.rowSizes[i],y=0;y<t.colCount;y++)l=b+y,f=0===y,p=y===t.colCount-1,c=S.colSizes[y],g=S.styleList[i][y],s===t.row&&l===t.col&&(M=(m=g)&&m.diagonalDown,E=m&&m.diagonalUp),g?(e=g.borderLeft,n=g.borderTop,o=g.borderRight,r=g.borderBottom,N&&(N=T.kWa(M,g.diagonalDown)),D&&(D=T.kWa(E,g.diagonalUp))):e=n=o=r=a,h?f?v.kF(s,l,R,k,c,u,e,n,a,a,a,a,I,!0,!0):p?v.kF(s,l,R,k,c,u,a,n,o,a,a,a,I,!0,!1):v.kF(s,l,R,k,c,u,a,n,a,a,a,a,I,!0,!0):d?f?v.kF(s,l,R,k,c,u,e,a,a,r,a,a,I,!1,!0):p?v.kF(s,l,R,k,c,u,a,a,o,r,a,a,I,!1,!1):v.kF(s,l,R,k,c,u,a,a,a,r,a,a,I,!1,!0):f?v.kF(s,l,R,k,c,u,e,a,a,a,a,a,I,!0,!0):p&&v.kF(s,l,R,k,c,u,a,a,o,a,a,a,I,!0,!1),R+=c;R=w,k+=u}M=N?M:null,E=D?E:null,v.kF(t.row,t.col,t.x,t.y,t.width,t.height,a,a,a,a,M,E,a,!0,!0)}!I||e||o||n||r||v.bF.push({r:C,c:b,rc:t.rowCount,cc:t.colCount})},t.prototype.mE=function(){var t=this,e=!1,n=!1,o=!1,r=!1;p(t.fF)||(e=!0),p(t.eF)||(n=!0),(e||n)&&(t.tF(),t.tWa()),p(t.lWa)||(o=!0),p(t.mWa)||(r=!0),(o||r)&&t.oWa(),t.bF.length>0&&t.uF()},t.prototype.E$a=function(t,e,n,o,r){var i=this,a=this.C$a[t]?this.C$a[t][e]:null;if(a)switch(r){case g.H_TOP_LEFT:return i.vF(t,e,n,o);case g.H_TOP_Right:case g.V_RIGHT_TOP:return i.vF(t,e+a.colCount-1,n,o);case g.V_RIGHT_BOTTOM:case g.H_BOTTOM_RIGHT:return i.vF(t+a.rowCount-1,e+a.colCount-1,n,o);case g.H_BOTTOM_LEFT:case g.V_LEFT_BOTTOM:return i.vF(t+a.rowCount-1,e,n,o);case g.V_LEFT_TOP:return i.vF(t,e,n,o)}return i.vF(t,e,n,o)},t.prototype.oWa=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,m=this,y=m.$E,v=m._E,C=y.length,b=v.length,w={},x={};for(t=0;t<C;t++)for(n=y[t],e=0;e<b;e++)o=v[e],h=m.pF(n,o,m.lWa,!1),p=m.pF(n,o,m.mWa,!1),(h||p)&&(T.LE(h)&&T.LE(p)&&(h.line.jWa(),p.line.jWa()),d=[],(r=m.E$a(n,o,!1,w,g.H_TOP_LEFT))&&r.line&&!r.isGridLine&&(d=[1,1,2],m.pWa(d,r,h,!0,1)),(l=m.E$a(n,o,!1,w,g.H_TOP_Right))&&l.line&&!l.isGridLine&&(d=[1,1,2],m.pWa(d,l,p,!0,1)),(i=m.E$a(n,o,!0,x,g.V_LEFT_TOP))&&i.line&&!i.isGridLine&&(d=[1,1,2],m.pWa(d,i,h,!0,0)),(u=m.E$a(n,o,!0,x,g.V_LEFT_BOTTOM))&&u.line&&!u.isGridLine&&(d=[1,1,2],m.pWa(d,u,p,!1,0)),(a=m.E$a(n+1,o,!1,w,g.H_BOTTOM_LEFT))&&a.line&&!a.isGridLine&&(d=[-1,-2,-2],m.pWa(d,a,p,!1,1)),(c=m.E$a(n+1,o,!1,w,g.H_BOTTOM_RIGHT))&&c.line&&!c.isGridLine&&(d=[-1,-2,-2],m.pWa(d,c,h,!1,1)),(s=m.E$a(n,o+1,!0,x,g.V_RIGHT_TOP))&&s.line&&!s.isGridLine&&(d=[-1,-2,-2],m.pWa(d,s,p,!0,0)),(f=m.E$a(n,o+1,!0,x,g.V_RIGHT_BOTTOM))&&f.line&&!f.isGridLine&&(d=[-1,-2,-2],m.pWa(d,f,h,!1,0)))},t.prototype.pWa=function(t,e,n,o,r){var i,a,s=T.LE(e),l=T.HE(e),u=e.line.uE;s&&(u=3),l&&(u=2),i=t[u-1],n&&n.line&&(a={_orientation:r},o?a.pE=i:a.nE=i,n.line.mE(a))},t.prototype.uF=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h=this,p=h.bF,d=p.length;for(t=0;t<d;t++){for(r=n=(e=p[t]).r,i=n-1,a=(o=e.c)-1,s=o,e.rc>1&&(r+=e.rc-1),e.cc>1&&(s+=e.cc-1),l=!1,u=!1,c=t+1;c<d&&((f=p[c]).c===s+1&&f.r===n&&(u=!0),f.r===r+1&&f.c===o&&(l=!0),!l||!u)&&!(f.r>n+1&&f.c>o+1);c++);l||h.oF(r,a,h.cF,!0),u||h.oF(i,s,h.dF,!1)}},t.prototype.tF=function(){var t,e,n,o,r,i,s,l,u,c,f,h,p,d,g,m,y,v,C=this,b=C.$E,w=C._E,x=b.length,S=w.length,A={},I={};for(t=0;t<x;t++)for(n=b[t],e=0;e<S;e++){if(o=w[e],g=0,m=0,y=C.pF(n,o,C.fF,!0)){if(y.line&&y.line.gIb)continue;g++}else y=C.pF(n,o-1,C.dF,!0);(v=C.pF(n,o,C.eF,!0))?m++:v=C.pF(n-1,o,C.cF,!0),(y||v)&&((r=0===t?a:C.vF(b[t-1],o,!0,I))&&r.line&&!r.isGridLine&&(g++,m++),(i=0===e?a:C.vF(n,w[e-1],!1,A))&&i.line&&!i.isGridLine&&(g++,m++),y&&((s=C.vF(n,o,!1,A))&&s.line&&!s.isGridLine&&g++,t!==x-1&&((u=C.vF(b[t+1],o,!0,I))&&u.line&&!u.isGridLine&&g++),0!==e&&t!==x-1&&((c=C.vF(b[t+1],w[e-1],!1,A))&&c.line&&!c.isGridLine&&g++),t!==x-1&&((f=C.vF(b[t+1],o,!1,A))&&f.line&&!f.isGridLine&&g++),g>0&&(T.GE(y.style)?T.TE(y,r,i,s,u,c,f,!0):T.HE(y.style)||T.SE(y,r,i,s,u,c,f))),v&&((l=C.vF(n,o,!0,I))&&l.line&&!l.isGridLine&&m++,e!==S-1&&((h=C.vF(n,w[e+1],!1,A))&&h.line&&!h.isGridLine&&m++),0!==t&&e!==S-1&&((p=C.vF(b[t-1],w[e+1],!0,I))&&p.line&&!p.isGridLine&&m++),e!==S-1&&((d=C.vF(n,w[e+1],!0,I))&&d.line&&!d.isGridLine&&m++),m>0&&(T.GE(v.style)?T.TE(v,i,r,l,h,p,d,!1):T.HE(v.style)||T.RE(v,i,r,l,h,p,d))))}},t.prototype.F$a=function(t,e,n,o){var r=this,i=this.C$a[t]?this.C$a[t][e]:null,a=n?r.mWa:r.lWa;return i?t===i.row&&e===i.col&&o===d.LEFT_TOP||t===i.row&&e===i.col+i.colCount-1&&o===d.RIGHT_TOP||t===i.row+i.rowCount-1&&e===i.col+i.colCount-1&&o===d.RIGHT_BOTTOM||t===i.row+i.rowCount-1&&e===i.col&&o===d.LEFT_BOTTOM?r.pF(i.row,i.col,a,!1):void 0:r.pF(t,e,a,!1)},t.prototype.tWa=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h,p,g,m=this,y=m.$E,v=m._E,C=y.length,b=v.length;for(t=0;t<C;t++)for(n=y[t],e=0;e<b;e++)o=v[e],(p=m.pF(n,o,m.fF,!0))&&p.line&&p.line._noNeedAdjust||(p&&p.line&&T.LE(p)&&(r=m.F$a(n,o,!1,d.LEFT_TOP),i=m.F$a(n,o,!0,d.LEFT_BOTTOM),a=T.LE(r),s=T.LE(i),l=m.F$a(n,o-1,!1,d.RIGHT_BOTTOM),u=m.F$a(n,o-1,!0,d.RIGHT_TOP),c=T.LE(l),f=T.LE(u),r&&a&&(h={CE:2,_orientation:1,pE:2},p.line.mE(h)),i&&s&&(h={CE:2,_orientation:1,nE:-2},p.line.mE(h)),l&&c&&(h={CE:1,_orientation:1,nE:-2},p.line.mE(h)),u&&f&&(h={CE:1,_orientation:1,pE:2},p.line.mE(h))),(g=m.pF(n,o,m.eF,!0))&&g.line&&T.LE(g)&&(r=m.F$a(n,o,!1,d.LEFT_TOP),i=m.F$a(n,o,!0,d.RIGHT_TOP),a=T.LE(r),s=T.LE(i),l=m.F$a(n-1,o,!1,d.RIGHT_BOTTOM),u=m.F$a(n-1,o,!0,d.LEFT_BOTTOM),c=T.LE(l),f=T.LE(u),r&&a&&(h={CE:2,_orientation:0,pE:2},g.line.mE(h)),i&&s&&(h={CE:2,_orientation:0,nE:-2},g.line.mE(h)),l&&c&&(h={CE:1,_orientation:0,nE:-2},g.line.mE(h)),u&&f&&(h={CE:1,_orientation:0,pE:2},g.line.mE(h))))},t.prototype.vF=function(t,e,n,o){var r,a=o[t];return a||(a=o[t]={}),(r=a[e])===i&&(r=a[e]=this.wF(t,e,n)),r},t.prototype.wF=function(t,e,n){var o,r,s;if(t===i||t<0||e===i||e<0)return a;if(o=this,r=n?o.fF:o.eF,s=o.pF(t,e,r,!0))return s;if(r=n?o.dF:o.cF,n){if(--e<0)return a}else if(--t<0)return a;return(s=o.pF(t,e,r,!0))||a},t.prototype.paint=function(t){var e=this;e.UE&&(e.VE||(e.D$a(),e.rF(),e.qF(),e.mE(),e.VE=!0),t.save(),t.beginPath(),e.jp(t),t.closePath(),t.stroke(),t.restore())},t.prototype.jp=function(t){this.xF(t),this.yF(t)},t.prototype.xF=function(t){var e=this;e._d(t,e.cF),e._d(t,e.dF)},t.prototype.yF=function(t){var e=this;e._d(t,e.eF),e._d(t,e.fF),e._d(t,e.lWa),e._d(t,e.mWa)},t.prototype._d=function(t,e){var n,o,r,i,a,s;for(n in e)if(e[n])for(o in r=e[n])if(r[o])if(i=r[o].line,(a=r[o].splitLines)&&a.length>0)for(s=0;s<a.length;s++)a[s]&&a[s].jp(t);else i&&i.jp(t)},t}(),e.AF=x},"./dist/core/worksheet/worksheet-edit.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/util/domUtil.js"),s=a.GC$,l=n("Common"),u=n("./dist/core/core.enum.js"),c=n("@grapecity/js-calc"),f=!!c,h=i.Ul.Ml,p=i.Ul.rl(),d=l.Common.j.Fa,g=l.Common.CultureManager,m=null,y=void 0,v=i.Ul.K_a,C=new l.Common.ResourceManager(o.SR),b=C.getResource.bind(C),w={startEdit:function(t,e){var n=this;n.EF(n.Ws(),n.Jl,n.Kl,m,m,t,e)},editorStatus:function(){return this.Px||0},isEditing:function(){var t=this.Px;return 1===t||2===t},endEdit:function(t){return this.gv(t)},gv:function(t,e,n,o){var r=this;if(!r.isEditing())return!0;r.suspendPaint();try{return r.Yoa(t,e,n,o)}finally{r.resumePaint()}},Yoa:function(t,e,n,o){var a,l,c,f,p,g,y,v,C,b,w,T,x,S,A=this,I=A.mm,R=A.BF,k=A.name(),M=A.Jl,N=A.Kl,E=A.getCellType(M,N),D={sheet:A,row:M,col:N,sheetArea:3,klb:R&&R.klb};if(E.isImeAware(D)||I.Qq(),R&&R.parentNode){if(c={sheet:A,sheetName:k,row:M,col:N,editor:R,editingText:l=E.getEditorValue(R,D),cancel:!1},A.Wq(i.Events.EditEnd,c),c.cancel&&!o)return;if(A.Wq(i.Events.EditEnding,c),c.cancel&&!o)return;if(p=(f=A.parent)&&f.CF,document.activeElement===(p&&p.qo)&&I.Qq(),M>=0&&N>=0&&(g=R.Ep,y=A.getFormulaInformation&&A.getFormulaInformation(M,N),E.isEditingValueChanged(g,l,D)||1===e||y&&y.isArrayFormula&&1!==e))if(t)E.setEditorValue(R,g,D),E.selectAll(R,D);else if(v=E.DF,d(v)&&(v=!0),C={cmd:"editCell",sheetName:k,row:M,col:N,newValue:l,autoFormat:v,editingFormatter:R.oja},1===e&&(C.ranges=[A.Ix()],C.endEditType=e),null===l||t||A.tables&&A.tables.find&&(A.tables.find(M-1,N)||A.tables.find(M,N-1))&&A.tables.fIb(new i.Range(M,N,1,1),null,l,!0),A.wu().execute(C),2===(a=C.applyResult)&&(E.focus(R,D),!o))return!1;if(A.$l=!0,E.XBb(R,D,A.getCellRect(M,N)),E.isImeAware(D))h.msie&&9===parseFloat(h.version)?I.Qq():s(R.parentNode.parentNode).css({width:0,height:0,overflow:"hidden",border:"none"});else for(b=A.zo(),w=R;w;)w.parentNode===b?b.removeChild(w):w=w.parentNode}return A.Ll=!1,T={sheet:A,sheetName:k,row:M,col:N,editingText:l},x=s.extend({},T),A.Wq(i.Events.EditEnded,T),A.Wq(i.Events.FormulatextboxEditEnded,x),!(!0!==n&&x.ignore&&!o)&&(0!==A.Px&&(S=A.Px,A.Px=0,A.Cu(S,0)),A.ITa.setCellState(M,N,u.CellStatesType.edit,!1,u.SheetArea.viewport),r.Worksheet.ao(A,"endEdit"),A.BF=m,1!==a)},FF:function(t,e,n){var o,r,i,a,s,l,u,c,f=this,h=f.hitTest(e,n);!h||h.cellTypeHitInfo&&(h.cellTypeHitInfo.outlineColumnHitInfo||h.cellTypeHitInfo.cellButtonHitInfo)||(o=h.row,r=h.col,o>=0&&r>=0&&h.rowViewportIndex>=0&&h.colViewportIndex>=0&&!h.resizeInfo&&!h.dragInfo&&o===f.Jl&&r===f.Kl&&(i=f.isEditing(),f.EF(t,o,r),!i&&f.isEditing()&&(a=h.hitTestType,(s=f.getCellType(o,r)).tw&&(l=f.getCellRect(o,r,1===a?-1:y,2===a?-1:y),u=f.getActualStyle(o,r,a),(c=s.h5(e,n,u,l,{sheet:f,row:o,col:r,sheetArea:a}))&&c.isReservedLocation&&s.tw(f,o,r,3)))))},inputFormulaAndSelectFormulaRange:function(t,e,n,o){var a,s,l,u,c,f=this,h=f.options,p=f.getCellRect(t,e),d=f.getActualStyle(t,e),g=f.getCellType(t,e),m=f.mm;m.zt(),a={sheet:f,row:t,col:e,sheetArea:3},(s=m.GF)&&s.firstChild&&(l=s.firstChild.firstChild),l&&(f.BF=l,u=f.am(),g.isImeAware(a)&&m.JF(),g.d5(s,d,p,a),f.KF(g,l,t,e,d,void 0,void 0),g.g5(s,d,p,a),h.allowCellOverflow&&((c=p.clone()).y-=2,c.height+=4,c.x=u.kt,c.width=u.er,f.repaint(c)),r.Worksheet.ao(f,"startEdit",{element:g.getEditingElement()}),f.Px=2,f.Cw.text(o),f.Cw.caret(o.length-1),n&&f.Cw.iIb(3,4),f.Cw.S1(),i.Vl.Zl(f))},EF:function(t,e,n,o,a,l,c,y,v){var C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z;if(s[s.sd]({tc:this.parent}),!(e<0||n<0||(C=this,b=C.name(),w=C.options,C.isEditing()||(T=C.getCellRect(e,n),!T||d(T.width)||d(T.height)||d(T.x)||d(T.y)||T.width<=0||T.height<=0)))){if((x=C.ITa).setCellState(e,n,u.CellStatesType.edit,!0,u.SheetArea.viewport),S=C.getActualStyle(e,n),w.isProtected&&!1!==S.locked)return void x.setCellState(e,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);if(!(A=C.getCellType(e,n)))return void x.setCellState(e,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);if((I=C.mm).zt(),R={sheet:C,row:e,col:n,sheetArea:3},(k=A.isImeAware(R)?I.GF:A.a5(R))&&k.firstChild&&(M=k.firstChild.firstChild),!M)return void x.setCellState(e,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);if(N=C.getActualStyle(e,n),E=!1,O=g.culture(),(N.formatter&&i.util.yIc(N.formatter,O)||N._autoFormatter&&N._autoFormatter.formatCached&&i.util.yIc(N._autoFormatter,O))&&(j=v&&v.keyCode,F=v&&v.code,v&&j&&!v.shiftKey&&(j>=96&&j<=105||j>=48&&j<=57)&&(E=!0),(109===j||107===j||v&&(!v.shiftKey&&189===j||v.shiftKey&&187===j))&&(A.probabilityAddPercent=!0),229===j&&!v.shiftKey&&F.length-F.replace(/[0-9]/,"").length>0&&(E=!0),229===j&&!v.shiftKey&&(F.length-F.replace("Minus","").length>0||F.length-F.replace("Subtract","").length>0||F.length-F.replace("Add","").length>0)&&(A.probabilityAddPercentSpec=!0),229===j&&v.shiftKey&&F.length-F.replace("Equal","").length>0&&(A.probabilityAddPercentSpec=!0),P=k.innerText,h.msie&&(P=P.replace("\r\n","")),_=g.q4(g.culture()).NumberFormat.numberDecimalSeparator,L=RegExp("^[-]?[0-9]+(\\"+_+"[0-9]+)?$"),!v&&P&&L.test(P)&&(D=!0)),C.BF=M,B={sheet:C,sheetName:b,row:e,col:n,cancel:!1},C.Wq(i.Events.EditStarting,B),B.cancel)return p.ipad&&I.Qq(),void x.setCellState(e,n,u.CellStatesType.edit,!1,u.SheetArea.viewport);C.showCell(C.Jl,C.Kl,3,3),C.jIb=!0,G=C.getValue(e,n),H=f&&C.getFormula(e,n),V=C.Px,C.HF||d(G)&&d(H)?C.Px=1:C.Px=2,C.Cu(V,C.Px),z=C.am(),T=C.getCellRect(e,n,o,a),A.isImeAware(R)&&I.JF(),A.d5(k,S,T,R),C.KF(A,M,e,n,S,c,y,E,D),W=C.zo(),A.isImeAware(R)||W.insertBefore(k,m),delete C.jIb,A.g5(k,S,T,R),A.isImeAware(R)&&l||A.focus(M,R),w.allowCellOverflow&&((U=T.clone()).y-=2,U.height+=4,U.x=z.kt,U.width=z.er,C.repaint(U)),r.Worksheet.ao(C,"startEdit",{element:A.getEditingElement()}),!E&&l&&A.selectAll(M,R),E&&(q=window.getSelection(),(Y=document.createRange()).setStart(M,0),q.removeAllRanges(),q.addRange(Y)),D&&(q=window.getSelection(),(X=document.createElement("span")).innerText="%",Y=document.createRange(),C.parent.options.enableFormulaTextbox&&C.parent.options.allowUserEditFormula?(M.firstChild.appendChild(X),Y.setStart(M.firstChild,1)):(M.appendChild(X),Y.setStart(M,1)),q.removeAllRanges(),q.addRange(Y)),i.Vl.Zl(C),Z={sheet:C,sheetName:b,row:e,col:n},C.Wq(i.Events.EditStarted,Z),C.Wq(i.Events.FormulatextboxEditStarted,Z)}},KF:function(t,e,n,o,r,i,a,s,l){var u,c,h,p,g,m=this,y=f&&m.getFormula(n,o,3,!0);y&&(y="="+y),u=y,c={sheet:m,row:n,col:o,sheetArea:3,isImeInput:a},y&&0!==y.length||((y=m.getValue(n,o,3,1))&&y.richText&&(e.klb=!0,y=v(y)),h=m.parent,p=f&&h&&h.options.allowUserEditFormula,"string"==typeof y&&r.quotePrefix||y&&y.length>0&&"="===y[0]&&p?u=y="'"+y:(u=y,y=t.kp(e,r,y,c))),e.Ep=y,d(i)||(y=i),l&&(y=this.kIb(y)),t.setEditorValue(e,y,c,s),m.parent&&m.parent.options.enableAccessibility&&(g=b(),e.setAttribute("aria-label",g.ARIA_Cell+"("+n+","+o+") "+g.ARIA_HasValue+" "+y)),e.LF=u},kIb:function(t){var e,n,o,r,i,a,s,l=g.q4(g.culture()).NumberFormat,u=l.negativeSign,c=l.numberDecimalSeparator;if(t.split("e").length>1)return e=t.split("e")[0],n=t.split("e")[1],e+"e+"+(parseInt(n.split("+")[1],10)+2);if(t.split(c).length>1){for(o=!1,t.charAt(0)===u&&(t=t.substr(1,t.length-1),o=!0),r=(t+="00").indexOf(c),a=(i=(t=(t=t.split(c).join("")).substr(0,r+2)+c+t.substr(r+2,t.length-1)).split(c))[0],s=i[1];a&&"0"===a.charAt(0);)a=a.substr(1,a.length-1);for(;s&&"0"===s.charAt(s.length-1);)s=s.substr(0,s.length-2);return o&&a&&(a=u+a),a&&s?a+c+s:!a&&s?(o?u+"0"+c:"0"+c)+s:a&&!s?a:"0"}return t+"00"}},s.extend(r.Worksheet.prototype,w)},"./dist/core/worksheet/worksheet-event.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st;function lt(t,e,n){var o,r,i,a,s,u,c,f=!1,h=t.am();return e&&(o=gt(e),r=mt(e),(o<0||r<0)&&((i=t.getCellRect(e.row,e.col,o,r))&&i.width>0&&i.height>0&&(a=h.x,s=h.y,(i.x<h.Br+a||i.y<h.Cr+s||i.y>=h.height-h.Bt)&&(u=new l.Rect(i.x-2,i.y-2,i.width+4,i.height+4),void 0,c=o<0&&r<0?h.em():o<0?h.gm(r):h.fm(o),u=u.getIntersectRect(c),n.VF(u.x,u.y,u.width,u.height),f=function(t,e){var n=3;return gt(e)<0&&(n=1),mt(e)<0&&(n=2),!(3===n||!t.vp(e.row,e.col,n,!0))}(t,e))))),f}function ut(t){return t.isEditing()}function ct(t){return t.endEdit()}function ft(t){return t.frozenRowCount()}function ht(t){return t.frozenColumnCount()}function pt(t,e){return t.getRowCount(e)}function dt(t,e){return t.getColumnCount(e)}function gt(t){return t.rowViewportIndex}function mt(t){return t.colViewportIndex}function yt(t){return t.hitTestType}function vt(t){return t.getActiveRowIndex()}function Ct(t){return t.getActiveColumnIndex()}function bt(t){return t.keyCode}function wt(t){return t.ctrlKey}function Tt(t){return t.shiftKey}function xt(t){return t.altKey}function St(t){return t.metaKey}function At(t){return t.colCount}function It(t){return t.rowCount}function Rt(t,e,n){return{action:t,index:e,sheetArea:n}}function kt(t,e,n,o,r,i){var a={sheet:t,sheetName:e,sheetArea:r,row:n,col:o};return i&&(a.cancel=!1),a}function Mt(t,e,n,o,r,i){var a=t.kj,s=kt(a,a.name(),a.Jl,a.Kl,N,!0);return a.Wq(l.Events.LeaveCell,s),!(!s||!0!==s.cancel)||(a.Kr(e,n,o,r,i),a.Wq(l.Events.EnterCell,kt(a,a.name(),e,n)),a.Wq(l.Events.FormulatextboxEnterCell,kt(a,a.name(),e,n)),void(t.cs&&t.cs(e,n)))}function Nt(t,e,n,o,r,i,a){var s,l=t.kj,u=e.call(l,i.sheetArea);return(a&&!l.getRowVisible(i.index,i.sheetArea)||!a&&!l.getColumnVisible(i.index,i.sheetArea))&&(i.index=n.call(t,i.index,i.sheetArea)),(s=o.call(u,i.index))||(s=o.call(u,r)),s}function Et(t,e,n,o,r){var i,a=o?"movingY":"movingX",s=o?"startY":"startX";t[a]=e,t[a]<t[s]&&(t[a]=t[s]),i=o?n.y+n.height:n.x+n.width,t[a]>i&&(t[a]=i),r!==M&&t[a]>t[s]+r&&(t[a]=t[s]+r)}function Dt(t,e){var n=e.row,o=e.rowCount,r=e.col,i=e.colCount,a=t.getColumnCount(),s=t.getRowCount();return i+r>a&&(i=a-r),o+n>s&&(o=s-n),{row:n,col:r,rowCount:o,colCount:i}}function Ot(t,e,n){var o=t.parent.options.rowResizeMode;return n&&0===o&&(o=1),e.action!==$&&1===o&&!function(t,e){var n,o=t.getViewportBottomRow(t.Er(e));if(-1===o&&(o=t.ir()),e<o)for(n=o;n>e;n--)if(0!==t.getRowHeight(n))return!1;return!0}(t,e.index)&&!(!t.getRowResizable(e.index,e.sheetArea)||!t.getRowResizable(e.index+1,e.sheetArea))&&function(t){var e,n,o=t.ITa.getSelections();if(o.length>0)return e=0,n=t.getRowCount(),o.every((function(o){var r,i=Dt(t,o),a=!1;return 1===i.rowCount&&(a=(e+=1)<=1),r=i.row<n,-1!==i.col||a&&r}))}(t)}function jt(t,e,n){var o=t.parent.options.columnResizeMode;return n&&0===o&&(o=1),e.action!==et&&1===o&&!function(t,e){var n,o=t.getViewportRightColumn(t.Fr(e));if(-1===o&&(o=t.dr()),e<o)for(n=o;n>e;n--)if(0!==t.getColumnWidth(n))return!1;return!0}(t,e.index)&&!(!t.getColumnResizable(e.index,e.sheetArea)||!t.getColumnResizable(e.index+1,e.sheetArea))&&function(t){var e,n,o=t.ITa.getSelections();if(o.length>0)return e=0,n=t.getColumnCount(),o.every((function(o){var r,i=Dt(t,o),a=!1;return 1===i.colCount&&(a=(e+=1)<=1),r=i.col<n,-1!==i.row||a&&r}))}(t)}function Ft(t,e,n){var o,r,i,a=n?t.frozenRowCount():t.frozenColumnCount(),s=n?t.lq:t.qq,l=!1,u=s-1;if(a>0&&a<s)for(o=s-1;o>=a;){if(n?t.getRowVisible(o):t.getColumnVisible(o)){if(r=n?t.getRowHeight(o):t.getColumnWidth(o),o===u&&0===r)break;if(r>0){l=!0;break}}else u--;o--}for(i=l?a:e,i--;i>=0;){if(n?t.getRowVisible(i):t.getColumnVisible(i))return i;i--}return-1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/worksheet/worksheet.js"),i=n("Common"),a=n("./dist/core/worksheet/worksheet-model.js"),s=n("./dist/core/util/domUtil.js"),l=n("./dist/core/util/common.js"),u=n("./dist/core/core.enum.js"),c=window,f=document,h=s.GC$.each,p=l.Ul.Ml,d=l.Ul.rl(),g=l.Ul.nl,m=l.Ul.Nl,y=i.Common.u.Kb,v=l.kf,C=i.Common.j.Fa,w="mousedown"+(b={lIb:".handler"}).lIb,T="mouseup"+b.lIb,x="mousemove"+b.lIb,S="mousewheel"+b.lIb,A="DOMMouseScroll"+b.lIb,I="wheel"+b.lIb,R="mouseout"+b.lIb,k="dblclick"+b.lIb,M=null,N=void 0,E=isNaN,D=parseInt,O=Math.max,j=Math.floor,F=Math.min,P=Math.abs,_=Math.ceil,L="function",B="position",G="absolute",H="border",V="overflow",z="top",W="left",U="width",q="height",Y="hidden",X="none",Z="tabindex",Q="gcUIElement",J="corner",$="sizeHiddenRow",K="sizeRow",tt="sizeCol",et="sizeHiddenCol",nt="default",ot=d.iphone||d.ipad||d.android,rt=new i.Common.ResourceManager(o.SR),it=rt.getResource.bind(rt),at=function(){function t(t){var e=this;e.qo=t,e.jI=M,e.kI=M,e.lI=M,e.Fi=M,e.mI=!1,e.nI=!1}return t.prototype.tG=function(t){typeof t===L&&(this.kI=t)},t.prototype.PG=function(t){var e,n=this;E(t)||0===t?n.SG():(n.nI=t>0,t=P(t),e=n.jI,n.jI=t,e!==t&&n.oI())},t.prototype.oI=function(){var t=this;t.$b(),E(t.jI)||(t.lI=c.setInterval((function(){t.pI()}),t.jI))},t.prototype.pI=function(){var t=this,e=t.kI;t.mI=!0,typeof e===L&&(t.Fi=e.call(t.qo,t.nI))},t.prototype.SG=function(){var t=this;t.$b(),t.jI=M,t.lI=M,t.Fi=M,t.mI=!1},t.prototype.$b=function(){var t=this.lI;t&&clearInterval(t)},t.prototype.no=function(){this.SG()},t}(),st=function(){function t(t){this.mIb=0;var e=this;e.WF=0,e.XF=!1,e.Gma=!1,e.gA={},e.kj=t,e.nIb="gcEvent"+t.yn}return t.prototype.no=function(){var t=this;t.YF&&t.YF.no(),t.ZF&&t.ZF.no(),t.$F=M},t.prototype._F=function(){var t=this;return t.YF||(t.YF=new at(t)),t.YF},t.prototype.aG=function(){var t=this;return t.ZF||(t.ZF=new at(t)),t.ZF},t.prototype.Vs=function(){return this.kj.Vs()},t.prototype.bG=function(){var t=s.GC$(this.kj.Ws()).position();return t||(t={top:0,left:0}),t},t.prototype.AD=function(t){var e,n,o,r,i,a,s,u,c,f,h=l.Ul.sl(),d=wt(t),g=h&&!0===d&&0===t.button;return!(2!==t.button&&!g&&(e=this,n=e.kj,e.tC(),p&&p.msie&&t.offsetX!==N&&t.offsetY!==N&&(o=0,r=0,i=n.Xs,t.target!==i&&(a=l.Ul.Z3(t.target,i),o=a.EB,r=a.FB),i&&(s=t.pageX-(t.offsetX+o),u=t.pageY-(t.offsetY+r),i.canvasOffset={top:u,left:s})),c=n.Vs(),f=e.cG(t,t.pageX-c.left,t.pageY-c.top),ut(n)||f||e.zt(),n.dG=!0,1))},t.prototype.tC=function(){var t=this;t.RB||(s.GC$(f).bind("mousemove.gcSheet."+t.nIb,(function(e){t.BD(e)})).bind("mouseup.gcSheet."+t.nIb,(function(e){t.CD(e)})),t.RB=!0)},t.prototype.uC=function(){this.RB&&(this.RB=!1,s.GC$(f).unbind("mousemove.gcSheet."+this.nIb).unbind("mouseup.gcSheet."+this.nIb))},t.prototype.cG=function(t,e,n){var o,i,a,s,u,c,f,h,p,d,g,m=this,y=m.kj,v=y.hitTest(e,n),b=v.row,w=v.col,T=v.dragInfo,x=v.formulaRangeHitInfo,S=v.cellTypeHitInfo,A=v.resizeTableHitInfo,I={hitInfo:v,e:t,r:M};if(r.Worksheet.ao(y,"processMouseDown",I),!I.r&&(e>=(o=y.am()).x&&n>=o.y))if(y.yt=v,m.eG=!0,v.tableSelectInfo&&!y.Cw)this.oIb(v,y);else if(v.resizeInfo){if(!ct(y))return;m.fG(v)}else if(v.dragMergeInfo){if(!ct(y))return;m.Zia&&m.Zia(v)}else if(T&&T.side&&T.side!==J){if(!ct(y))return;m.gG&&m.gG(v),m.lG(t)}else if(T&&T.side===J){if(!ct(y))return;m.hG&&m.hG(v)}else if(v.filterButtonHitInfo)ct(y);else if(x)x.inBorder?m.iG(v):(x.inTopLeft||x.inTopRight||x.inBottomLeft||x.inBottomRight)&&m.jG(v);else if(A)m.pIb&&m.pIb(v);else if(y.Qs(gt(v)<0?-1:b,mt(v)<0?-1:w)){if(v.tableSelectInfo&&y.Cw&&(i=y.Cw,a=this.qgc(v,y),v.tableSelectInfo.tableSelection=a,i.rgc(a)),m.kG&&m.kG(y,v))return;if(s=vt(y),u=Ct(y),S){if(c=y.getCellType(S.row,S.col,yt(v)),S.sheet||(S.sheet=y),m.Sia(c,S)&&(f=S.sheetArea,(C(f)||3===f)&&(b!==s||w!==u))){y.suspendPaint();try{if(!ct(y))return;if(h=kt(y,y.name(),s,u,N,!0),y.Wq(l.Events.LeaveCell,h),h&&!0===h.cancel)return;p=y.ITa.getSelections(),d=y.ITa.getSpan(b,w),g=[new l.Range(d.row,d.col,d.rowCount,d.colCount)],y.Wq(l.Events.FloatingElementSelected,{type:"worksheet"}),y.yu(p,g),y.Sr(b,w,N,N,1),y.Wq(l.Events.EnterCell,kt(y,y.name(),b,w)),y.Wq(l.Events.FormulatextboxEnterCell,kt(y,y.name(),b,w)),y.Au(p),y.Uja=!0,m.cs&&m.cs(b,w)}finally{y.resumePaint()}}c.processCellAndPaddingMouseDown(S)}if(S&&S.isReservedLocation)return!0;m.lG(t),m.Ala(y,v,b,w)}},t.prototype.Ala=function(t,e,n,o){var r,i,a=this;try{if(a.mG=e,ut(t)&&!ct(t))return}finally{a.mG=M}C(n)||C(o)||(3===yt(e)&&a.cs&&a.cs(n,o),t.Wq(l.Events.FloatingElementSelected,{type:"worksheet"}),r=t.ITa.getSelections(),a.nG(e,r),i=t.ITa.getSelections(),t.yu(r,i))},t.prototype.Sia=function(t,e){return t&&e&&e.isReservedLocation&&(!t.activeOnClick||t.activeOnClick())},t.prototype.oG=function(t){var e,n=this.kj;return!n||(e=n.am(),C(t.x)||C(t.y)||C(t.width)||C(t.height)||t.x+t.width>e.pt+e.er+e.js||t.y+t.height>e.qt+e.jr+e.gs)},t.prototype.pG=function(t,e,n,o){var r,i,a,l,u,c,f,h=this.kj;for(i=0,l=(a=t.options).length;i<l;i++)if(a[i].selected){r=o[i].value;break}u=!1,h.options.isProtected&&((c=h.getActualStyle(e,n))&&(u=c.locked)),r===N||u||(f={cmd:"editCell",sheetName:h.name(),row:e,col:n,newValue:r,autoFormat:!0},h.wu().execute(f)),s.GC$(t).hide()},t.prototype.qG=function(){var t,e=this;e.rG&&(3!==(t=e.rG.sG)&&2!==t||e.aG().tG(e.uG),3!==t&&1!==t||e._F().tG(e.vG))},t.prototype.wG=function(){var t=this;t.xG&&t.yG(),t.$ia&&t._ia&&t._ia(),t.zG&&t.AG&&t.AG(),t.BG&&t.CG&&t.CG(),t.DG&&t.EG(),t.FG&&t.GG(),t.HG&&t.IG(),t.qIb&&t.rIb&&t.rIb()},t.prototype.uG=function(t){var e,n,o,r,i,a,s,l,u=this;u.JG()||(e=u.rG,n=u.kj,o=e.KG,r=n.getViewportTopRow(o),i=n.getViewportBottomRow(o),t?i<pt(n)-n.frozenTrailingRowCount()-1?n.mq(n._q(r)):(a=n.Gr(o))&&a.length>0&&(s=n.am(),(l=a[a.length-1]).y+l.height>=s.qt+s.jr&&n.mq(n._q(r))):r>ft(n)&&n.mq(n.gr(r))),u.wG()},t.prototype.vG=function(t){var e,n,o,r,i,a,s,l=this;l.LG()||(e=l.kj,n=l.rG.MG,o=e.getViewportLeftColumn(n),r=e.getViewportRightColumn(n),t?r<dt(e)-e.frozenTrailingColumnCount()-1?e.rq(e.Zq(o)):(i=e.Hr(n))&&i.length>0&&(a=e.am(),(s=i[i.length-1]).x+s.width>=a.pt+a.er&&e.rq(e.Zq(o))):o>ht(e)&&e.rq(e.br(o))),l.wG()},t.prototype.JG=function(){var t,e,n,o,r,i,a=this.kj,s=a.am(),l=ft(a),u=a.frozenTrailingRowCount(),c=this.$F,f=this.rG,h=f.KG;if(0===h){if(c.y>s.qt)return a.mq(a._t()),f.KG=1,!0}else if(1===h){if((t=a.Gr(1))&&t.length>0){if(e=t[0],l>0&&c.y<s.qt&&e.row<=a._t())return f.KG=0,!0;if(e=t[t.length-1],u>0&&c.y>s.ot&&e.row>=a.ir()&&e.y+e.height<=s.ot)return f.KG=2,!0}}else if(2===h&&((t=a.Gr(1))&&t.length>0&&c.y<s.ot)){if((e=t[t.length-1]).y+e.height>s.ot){for(n=s.jr,r=0,i=o=pt(a)-u-1;i>=l;i--)if((r+=a.Sl(i))>n){o=F(i+1,o);break}a.mq(a._q(o-1))}return f.KG=1,!0}return!1},t.prototype.LG=function(){var t,e,n,o,r,i,a=this.kj,s=a.frozenTrailingColumnCount(),l=ht(a),u=a.am(),c=this.$F,f=this.rG,h=f.MG;if(0===h){if(c.x>u.pt)return a.rq(a.$t()),f.MG=1,!0}else if(1===h){if((t=a.Hr(1))&&t.length>0){if(e=t[0],l>0&&c.x<u.pt&&e.col<=a.$t())return f.MG=0,!0;if(e=t[t.length-1],s>0&&c.x>u.lt&&e.col>=a.dr()&&e.x+e.width<=u.lt)return f.MG=2,!0}}else if(2===h&&((t=a.Hr(1))&&t.length>0&&c.x<u.lt)){if((e=t[t.length-1]).x+e.width>u.lt){for(n=u.er,r=0,i=o=dt(a)-s-1;i>=l;i--)if((r+=a.Tl(i))>n){o=F(i+1,o);break}a.rq(a.Zq(o-1))}return f.MG=1,!0}return!1},t.prototype.NG=function(){var t,e,n,o,r,i,a,s,l,c,f,h,p,d,g=this;(g.OG||g.O3||g.lV)&&(e=(t=g.kj).am(),o=(n=g.rG).KG,r=n.MG,i=g.$F,a=M,o>=0&&r>=0?(a=e.Ft(o,r),0===o&&t.lq===t.frozenRowCount()&&(s=e.Ft(1,r),a.height+=s.height),0===r&&t.qq===t.frozenColumnCount()&&(s=e.Ft(o,1),a.width+=s.width)):o>=0?a=e.fm(o):r>=0&&(a=e.gm(r)),a&&(c=(l=t.parent)&&l.options.scrollbarAppearance===u.ScrollbarAppearance.mobile,f=0,h=0,p=!1,d=!1,i.x<=a.x?(f=i.x-a.x,c&&(d=!0)):i.x>=a.x+a.width?(0===(f=i.x-(a.x+a.width))&&(f=50),c&&(d=!0)):c&&i.x===a.x+a.width-1&&(f=50,d=!0),i.y<=a.y?(h=i.y-a.y,c&&(p=!0)):i.y>=a.y+a.height&&(h=i.y-(a.y+a.height),c&&(p=!0)),l&&c&&(p&&(l.St.Jwa(u.ScrollbarState.show),l.ku.Rdc(!0)),d&&(l.Pt.Jwa(u.ScrollbarState.show),l.ku.Rdc(!1))),g._F().PG(g.QG(f)),g.aG().PG(g.QG(h))))},t.prototype.RG=function(){this._F().SG(),this.aG().SG()},t.prototype.fG=function(t){var e,n,o,r,i,s,l=this,u=a.yp.prototype,c=l.kj,f=t.resizeInfo;f.action===K||f.action===$?(e=Nt(l,c.Jt,l.TG,u.findRow,t.row,f,!0),f.startY=e.y):(n=Nt(l,c.Kt,l.UG,u.findCol,t.col,f,!1),f.startX=n.x),o=c.parent,r=t.x,i=t.y,o&&((1!==(s=o.options.showResizeTip)||f.action!==tt&&f.action!==et)&&(2!==s||f.action!==K&&f.action!==$)&&3!==s||(i-30<0?i+=15:i-=30,o.uw(l.VG(),r,i))),l.isResizing=!0,l.OG=!0,l.ctrl&&(l.fCb=!0)},t.prototype.WG=function(){var t,e,n,o=this,r=o.kj,i=r.yt,a=i.resizeInfo,s=o.$F,l=s.x,u=s.y,c=r.am(),f=r.parent,h=a.sheetArea;a&&o.OG&&o.isResizing&&(i.x===l&&i.y===u||(a.action===K||a.action===$?function(t,e,n,o,r){var i,a=e.index,s=t.am();Ot(t,e,r)?(i=t._q(a,n),Et(e,o,s,!0,t.Sl(a,n)+t.Sl(i,n))):Et(e,o,s,!0)}(r,a,h,u,o.fCb):function(t,e,n,o,r){var i,a=e.index,s=t.am();jt(t,e,r)?(i=t.Zq(a,n),Et(e,o,s,!1,t.Tl(a,n)+t.Tl(i,n))):Et(e,o,s,!1)}(r,a,h,l,o.fCb),e=(t=r.yl).bm(),t.Mx(c.x,c.y,c.width,c.height),t.Pw(e),f&&((1!==(n=f.options.showResizeTip)||a.action!==tt&&a.action!==et)&&(2!==n||a.action!==K&&a.action!==$)&&3!==n||f.ww(o.XG(a)))))},t.prototype.YG=function(){var t,e,n,o,r,i,a,l,u,c,f,h,p=this;p.isResizing=!1,p.OG=!1,t=!0,n=(e=p.kj).yt,(o=n.resizeInfo)&&(p.xw(),o.action===K||o.action===$?C(o.movingY)?t=!1:(r=O(0,(o.movingY-o.startY)/e.zoom()),i=[],a="resizeRow",e.tp(o.index)?s.GC$.each(e.ITa.getSelections(),(function(t,n){if(-1===n.col)if(1===o.sheetArea)i.push({firstRow:o.index,lastRow:o.index});else{var r=e.Tq(n);i.push({firstRow:r.row,lastRow:r.row+It(r)-1})}})):i.push({firstRow:o.index,lastRow:o.index}),function(t,e,n,o){return Ot(t,e,o)&&1===n.length&&n[0].firstRow===n[0].lastRow}(e,o,i,p.fCb)&&(a="splitResizeRow"),l=1===o.sheetArea,e.wu().execute({cmd:a,sheetName:e.name(),rows:i,size:r,columnHeader:l})):C(o.movingX)?t=!1:(r=O(0,(o.movingX-o.startX)/e.zoom()),u=[],c="resizeColumn",e.sp(o.index)?s.GC$.each(e.ITa.getSelections(),(function(t,n){if(-1===n.row){var r=e.Tq(n);2===o.sheetArea?u.push({firstCol:o.index,lastCol:o.index}):u.push({firstCol:r.col,lastCol:r.col+At(r)-1})}})):u.push({firstCol:o.index,lastCol:o.index}),function(t,e,n,o){return jt(t,e,o)&&1===n.length&&n[0].firstColumn===n[0].lastColumn}(e,o,u,p.fCb)&&(c="splitResizeColumn"),f=2===o.sheetArea,e.wu().execute({cmd:c,sheetName:e.name(),columns:u,size:r,rowHeader:f})),(h=e.hitTest(p.$F.x,p.$F.y))&&p.Tw(h),t||e.repaint(),p.fCb=!1)},t.prototype.ZG=function(t,e){var n,o,r,i,a,s,l=0,u=0,c=0,f=0,h=this,p=h.kj,d=p.wq,g=ft(p),m=ht(p),y=yt(t);if(h.o4=h.$G=p.ITa.getSelections(),p.isCtrlPressed(y)||h.shift||p.Tr(),0===y){if(!h.shift&&Mt(h,n=g?p.ar():p.lq,m?p.$q():p.qq,1,1,e))return;p.isCtrlPressed(y)||p.Tr(),p.Ur(-1,-1,pt(p),dt(p),!0)}else if(1===y){if(!h.shift&&(n=g?p.ar():p.lq,o=h._G(n,t.col,!1),Mt(h,o.row,o.col,1,mt(t),e)))return;h.shift||p.n_a?(l=F(p.Kl,t.col),f=P(p.Kl-t.col)+1,p.Kx(-1,l,pt(p),f,!0)):p.Ur(-1,p.Kl,pt(p),1,!0)}else if(2===y){if(!h.shift){if(i=m?p.$q():p.qq,o=h._G(t.row,i,!0),r=p.Jl!==o.row,Mt(h,o.row,o.col,gt(t),1,e))return;r&&d&&d.Lx()}h.shift||p.n_a?(u=F(p.Jl,t.row),c=P(p.Jl-t.row)+1,p.Kx(u,-1,c,dt(p),!0)):p.Ur(p.Jl,-1,1,dt(p),!0)}else if(3===y)if(E(t.row)||E(t.col))ut(p)&&(s=p.getCellRect(p.Jl,p.Kl,p.Nr,p.Pr),p.yl.VF(s.x,s.y,s.width,s.height));else{if(!h.shift&&(p.Jl!==t.row||p.Kl!==t.col)){if(r=p.Jl!==t.row,Mt(h,t.row,t.col,gt(t),mt(t),e))return;r&&d&&d.Lx()}h.shift?p.aH(t.row,t.col,!0):(a=p.ITa.getSpan(t.row,t.col),p.n_a||p.Ur(a.row,a.col,It(a),At(a),!0))}},t.prototype.bH=function(t){if(t&&(3!==yt(t)||!E(t.row)&&!E(t.col))){var e=this;e.OG=!0,e.xG=!0,e.rG={KG:gt(t),MG:mt(t),sG:yt(t)},e.qG()}},t.prototype.ayb=function(t,e){var n=this.kj,o=n.getSpan(t,e),r=t,i=e,a=1,s=1,u=n.selectionUnit(),c=!1;return 1===u?(i=-1,s=-1,r=o?o.row:r,a=o?o.rowCount:a):2===u?(r=-1,a=-1,i=o?o.col:i,s=o?o.colCount:s):c=!0,o&&c?o:new l.Range(r,i,a,s)},t.prototype.nG=function(t,e){var n=this,o=n.kj,r=t.row,i=t.col;o.n_a=n.I0a(r,i,e,yt(t))&&o.parent.options.allowUserDeselect,o.n_a&&(o.s_a=o.Jl,o.t_a=o.Kl,o.p_a=n.ayb(r,i)),n.ZG(t),n.bH(t)},t.prototype.I0a=function(t,e,n,o){var r=this.kj;return this.o_a(t,e,n,o)&&2===r.selectionPolicy()},t.prototype.o_a=function(t,e,n,o){var r,i,a,s=this.kj,l=s.getRowCount(),u=s.getColumnCount();if(!s.isCtrlPressed(o))return!1;for(r=!1,i=n.length,a=0;a<i;a++)if(3===o){if(n[a].contains(t,e,1,1)){r=!0;break}}else if(2===o){if(n[a].contains(t,-1,1,u)||n[a].contains(t,0,1,u)){r=!0;break}}else if(1===o&&(n[a].contains(-1,e,l,1)||n[a].contains(0,e,l,1))){r=!0;break}return r},t.prototype.yG=function(){var t,e=this;e.rG&&e.OG&&!0!==e.DA&&(3===(t=e.rG.sG)?e.cH():2===t?e.dH():1===t&&e.eH())},t.prototype.cH=function(){var t,e,n,o,r=this,i=r.kj,a=r.fH(),s=r.gH();if(a>=0&&s>=0&&i.Qs(a,s)){if(r.NG(),1===(t=i.ITa.getSelections()).length&&(e=i.Jx(a,s,i.Jl,i.Kl),n=t[0],!i.n_a&&e.equals(n)))return;i.aH(a,s,!0),o=i.ITa.getSelections(),i.yu(t,o)}},t.prototype.dH=function(){var t,e,n,o,r,i=this,a=i.kj,s=i.fH(!0);if(s>=0&&a.Qs(s,-1)){if(t=F(a.Jl,s),e=O(a.Jl,s)-t+1,-1,n=dt(a),0===a.selectionPolicy())return;2===a.selectionUnit()&&(t=-1,e=-1),o=a.ITa.getSelections(),a.Kx(t,-1,e,n,!0),r=a.ITa.getSelections(),a.yu(o,r)}i.NG()},t.prototype.eH=function(){var t,e,n,o,r,i=this,a=i.kj,s=i.gH(!0);if(s>=0&&a.Qs(-1,s)){if(t=F(a.Kl,s),e=O(a.Kl,s)-t+1,-1,n=pt(a),0===a.selectionPolicy())return;1===a.selectionUnit()&&(t=-1,e=-1),o=a.ITa.getSelections(),a.Kx(-1,t,n,e,!0),r=a.ITa.getSelections(),a.yu(o,r)}i.NG()},t.prototype.hH=function(){var t,e,n,o,r=this;r.rG=M,r.RG(),r.DA=M,r.OG=!1,r.xG=!1,0!==(t=r.kj).ITa.getSelections().length&&(t.n_a&&(t.n_a=!1,e=t.p_a,t.p_a=null,t.u_a(t.ITa.getSelections(),e),delete t.s_a,delete t.t_a),t.Uja?delete t.Uja:((n=!r.$G)||(o=t.ITa.getSelections(),n=r.zu(r.$G,o)),n&&t.Au(r.o4)),r.$G=t.ITa.getSelections())},t.prototype.iH=function(){var t=this.kj,e=function(t,e){var n=t.am();return ft(t)>0&&e<n.nt+n.fs?0:t.frozenTrailingRowCount()>0&&e>n.ot?2:1}(t,this.$F.y),n=this.rG.KG,o=t.Gr(1);return(0===e&&n>0&&o.length>0&&o[0].row>t._t()||2===e&&n<2&&o.length>0&&o[o.length-1].row<t.ir())&&(e=1),e},t.prototype.jH=function(){var t=this.kj,e=function(t,e){var n=t.am();return ht(t)>0&&e<n.kt+n.hs?0:t.frozenTrailingColumnCount()>0&&e>n.lt?2:1}(t,this.$F.x),n=this.rG.MG,o=t.Hr(1);return(0===e&&n>0&&o.length>0&&o[0].col>t.$t()||2===e&&n<2&&o.length>0&&o[o.length-1].col<t.dr())&&(e=1),e},t.prototype.fH=function(t){var e,n,o,r=this.kj,i=this.$F.y,a=this.iH(),s=function(t,e,n){var o=t.Gr(e);return o?o.findNearY(n):M}(r,a,i);if(s){if(e=r.am(),n=s.row,1===a&&i<e.qt){if(n>(o=r._t()))return r._q(n-1)||n;if(n===o&&t)return 0}else if(0===a&&i<e.nt&&t)return 0;return 1===a&&i>e.ot&&n>r.hr()&&r.gr(n)||n}return-1},t.prototype.gH=function(t){var e,n,o,r=this.kj,i=this.$F.x,a=this.jH(),s=function(t,e,n){var o=t.Hr(e);return o?o.findNearX(n):M}(r,a,i);if(s){if(e=r.am(),n=s.col,1===a&&i<e.pt){if(n>(o=r.$t()))return r.Zq(n-1)||n;if(n===o&&t)return 0}else if(0===a&&i<e.kt&&t)return 0;return 1===a&&i>e.lt&&n>r.cr()&&r.br(n)||n}return-1},t.prototype.QG=function(t){var e,n=0;return E(t)||0===t||(e=t<0,n=_(500/P(t)),(n=O(20,10*n))>200&&(n=200),e&&(n=-n)),n},t.prototype.TG=function(t,e){var n=this.kj.gr(t,e);return n!==M?n:t},t.prototype.UG=function(t,e){var n=this.kj.br(t,e);return n!==M?n:t},t.prototype.kH=function(t,e,n){for(var o=this.kj;t>e;)if(t--,o.getRowVisible(t,n))return t;return t},t.prototype.lH=function(t,e,n){for(var o=this.kj;t>e;)if(t--,o.getColumnVisible(t,n))return t;return t},t.prototype.mH=function(t,e,n,o,r){var a,s,l,u,c,f,h,p=M;return function(t){return!t.options.isProtected||t.options.protectionOptions.allowResizeRows}(t)?(a=this,!(s=t.Gr(gt(e),o))||E(e.row)||E(e.col)||(t.getRowVisible(e.row,o)||(e.row=this.TG(e.row,o)),(l=s.findRow(e.row))&&(l.y+l.height-n<=r&&r<=l.y+l.height+n?(p=Rt(K,e.row,o),(u=s[s.length-1].row)>=0&&(c=t.ir(o),p.index===c&&p.index!==u&&l.y+l.height-n/2<=r&&(p=Rt(a.nH(t,u,o),u,o)))):l.y-n<=r&&r<=l.y+n&&i.Common.k.Cb(s,l)>0&&(f=a.kH(e.row,0,o),p=Rt(a.nH(t,f,o),f,o))),!p&&1===gt(e)&&s.length>0&&(l=s[0],O(0,l.y-n)<=r&&r<=l.y+n&&((h=Ft(t,e.row,!0))>=0&&(p=Rt(a.nH(t,h,o),h,o))))),p&&!t.getRowResizable(p.index,o)&&(p=M),p):p},t.prototype.nH=function(t,e,n){var o=t.parent;return o&&1===o.options.resizeZeroIndicator&&t.getRowVisible(e)&&0===t.Yr(e,n)?$:K},t.prototype.oH=function(t,e,n,o,r){var a,s,l,u,c,f,h,p=M;return function(t){return!t.options.isProtected||t.options.protectionOptions.allowResizeColumns}(t)?(a=this,!(s=t.Hr(mt(e),o))||E(e.col)||E(e.row)||(t.getColumnVisible(e.col,o)||(e.col=this.UG(e.col,o)),(l=s.findCol(e.col))&&(l.x+l.width-n<=r&&r<=l.x+l.width+n?(p=Rt(tt,e.col,o),(u=s[s.length-1].col)>=0&&(c=t.dr(o),p.index===c&&p.index!==u&&l.x+l.width-n/2<=r&&(p=Rt(a.pH(t,u,o),u,o)))):l.x-n<=r&&r<=l.x+n&&i.Common.k.Cb(s,l)>0&&(f=a.lH(e.col,0,o),p=Rt(a.pH(t,f,o),f,o))),!p&&1===mt(e)&&s.length>0&&(l=s[0],O(0,l.x-n)<=r&&r<=l.x+n&&((h=Ft(t,e.col,!1))>=0&&(p=Rt(a.pH(t,h,o),h,o))))),p&&!t.getColumnResizable(p.index,o)&&(p=M),p):p},t.prototype.pH=function(t,e,n){var o=t.parent;return o&&1===o.options.resizeZeroIndicator&&t.getColumnVisible(e)&&0===t.$r(e,n)?et:tt},t.prototype.ur=function(t,e,n,o){var r,i,a,s,l,u,c,f=this,h=f.kj,p=h.parent,d=h.options,g=d.colHeaderVisible,m=d.rowHeaderVisible,y=M;return p&&!p.options.allowUserResize||(a=h.am(),gt(t)<0&&mt(t)>=0&&g?(y=f.oH(h,t,o,1,e))||(y=f.mH(h,t,o,1,n)):gt(t)>=0&&mt(t)<0&&m?(y=f.mH(h,t,o,2,n))||(y=f.oH(h,t,o,2,e)):gt(t)<0&&mt(t)<0?h.ir(2)===M&&P(n-a.Cr)<=o?(s=h.Gr(1))&&s.length>0&&((r=s[s.length-1].row)>=0&&h.getRowResizable(r,2)&&(y=Rt(f.nH(h,r,2),r,2))):h.dr(1)===M&&P(e-a.Br)<=o&&((l=h.Hr(1))&&l.length>0&&((i=l[l.length-1].col)>=0&&h.getColumnResizable(i,1)&&(y=Rt(f.pH(h,i,1),i,1)))):gt(t)>=0&&mt(t)>=0&&(r=pt(h,1)-1,i=dt(h,2)-1,u=h.options.sheetAreaOffset.top,c=h.options.sheetAreaOffset.left,r>=0&&0===a.Cr&&u<=n&&n<=o+u&&g?y=Rt(f.nH(h,r,1),r,1):i>=0&&0===a.Br&&c<=e&&e<=o+c&&m&&(y=Rt(f.pH(h,i,2),i,2)))),y},t.prototype.qH=function(t,e,n,o){var r,i,a,s,l=this.kj,u=l.am().Ft(1,1);if(1===e)if((r=l.Hr(e))&&r.length>0){if((i=r[r.length-1]).x+i.width<=n&&n<u.x+u.width)return!0}else if(u.contains(n,o))return!0;if(1===t)if((a=l.Gr(t))&&a.length>0){if((s=a[a.length-1]).y+s.height<=o&&o<u.y+u.height)return!0}else if(u.contains(n,o))return!0;return!1},t.prototype.BD=function(t){var e=this.Vs();this.sH(t,t.pageX-e.left,t.pageY-e.top)},t.prototype.DD=function(){var t,e,n,o,r,i=this.kj,a=i.yt;a&&((t=a.cellTypeHitInfo)&&i.getCellType(t.row,t.col,yt(a)).ZBb(t)),this.OG||(e={x:-1e4,y:-1e4,rowViewportIndex:M,colViewportIndex:M,row:-1,col:-1,resizeInfo:M,hitTestType:M},this.Uw(e),a&&(n=a.row,o=a.col,r=i.getActualStyle(n,o),i.parent&&r&&r.showEllipsis&&i.parent.xw()))},t.prototype.sH=function(t,e,n){var o,r,i,a,s,u,c,f,h,p,d,g=this;return g.$F={e:t,x:e,y:n},o=g.kj,g.eG&&!l.Vl.Wl(o)&&l.Vl.Zl(o),g.eG&&g.OG?void(g.isResizing?g.WG():g.$ia?g._ia&&g._ia():g.zG?g.AG&&g.AG():g.BG?g.CG&&g.CG():g.DG?g.EG():g.FG?g.GG():g.HG?g.IG():g.qIb?g.rIb&&g.rIb():g.xG&&g.yG()):(r=o.hitTest(e,n),g.sIb(o,r,g),void(r&&(0===g.mIb&&r.tableSelectInfo&&g.eG&&g.tIb(o,g,r),i=o.parent,a=r.row,s=r.col,u=o.sr(r.rowViewportIndex,r.colViewportIndex),i&&(c=o.ITa.uIb(a,s,u),f=o.getActualStyle(a,s,u),c&&!1!==f.THb&&u?(h=o.getCellRect(a,s,r.rowViewportIndex,r.colViewportIndex),i.uw(c,h.x+h.width+5,h.y+h.height+5)):(p=i.options.showScrollTip&&(i.St.JB||i.Pt.JB),p||i.xw())),g.Tw(r),i&&i.options.enableAccessibility&&(d=o.cgc(r),i.dgc(d)),g.Uw(r))))},t.prototype.sIb=function(t,e,n){var o,r,i,a,s;1===n.mIb?(o=n.vIb.row,r=n.vIb.col,i=e.col,a=t.getSelections()[0],t.Kx(o,r>i?i:r,a.rowCount,r-i>0?r-i+1:i-r+1,!0)):2===n.mIb&&(o=n.vIb.row,r=n.vIb.col,s=e.row,a=t.getSelections()[0],t.Kx(o>s?s:o,r,o-s>0?o-s+1:s-o+1,a.colCount,!0))},t.prototype.tIb=function(t,e,n){var o,r=t.getActiveRowIndex(),i=t.getActiveColumnIndex();e.vIb={row:r,col:i},"tableColSelect"===(o=n.tableSelectInfo.action)?e.mIb=1:"tableRowSelect"===o&&(e.mIb=2)},t.prototype.Tw=function(t){var e,n,o,r,i,a,s,u,c,f,h,p,d,g,m,y,v=this,C=v.kj,b=C.Ws();b&&(o=!(e=C.yt)||t.row!==e.row||t.col!==e.col||yt(t)!==yt(e)||t.resizeInfo&&!e.resizeInfo||!t.resizeInfo&&e.resizeInfo||t.resizeInfo&&t.resizeInfo.action!==e.resizeInfo.action||t.dragInfo&&!e.dragInfo||!t.dragInfo&&e.dragInfo||t.dragInfo&&t.dragInfo.action!==e.dragInfo.action||t.resizeTableHitInfo&&!e.resizeTableHitInfo,e&&o&&((r=e.cellTypeHitInfo)&&(n=C.getCellType(r.row,r.col,yt(e))).ZBb(r)),i=t.resizeInfo,a=t.dragMergeInfo,s=t.dragInfo,u=t.formulaRangeHitInfo,c=t.cellTypeHitInfo,f=C.yl,h=t.resizeTableHitInfo,(p=t.tableSelectInfo)?"tableRowSelect"===p.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFAAAATQAAABEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUAAACtAAAAkAAAAAsAAAAAAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8AAAD5AAAAngAAAP8AAAD/AAAA/wAAAP8AAAD/AAAA/wAAAPkAAACeAAAAeAAAAHkAAAB5AAAAewAAANcAAAD9AAAAjAAAAA0AAAAAAAAAAAAAAAAAAAAFAAAArQAAAJAAAAALAAAAAAAAAAAAAAAAAAAAAAAAAAUAAABNAAAAEQAAAAAAAAAA4wAAAOEAAAAAAAAAAAAAAAAAAAAAAAAA4QAAAOMAAAA=) 8 4,auto":"tableColSelect"===p.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACAgAAAEAIABIAQAAFgAAACgAAAAIAAAAEAAAAAEAIAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACKAAAAigAAAAgAAAAAAAAAAAAAAAAAAAAHAAAAfAAAAPYAAAD2AAAAewAAAAcAAAAAAAAACAAAAHwAAAD3AAAA/wAAAP8AAAD3AAAAfAAAAAgAAAAVAAAAVwAAAJ8AAAD/AAAA/wAAAJ4AAABXAAAAFQAAAAAAAAAAAAAAYAAAAP8AAAD/AAAAYAAAAAAAAAAAAAAAAAAAAAAAAABgAAAA/wAAAP8AAABgAAAAAAAAAAAAAAAAAAAAAAAAAGAAAAD/AAAA/wAAAGAAAAAAAAAAAAAAAAAAAAAAAAAAXwAAAPwAAAD8AAAAXwAAAAAAAAAAwwAAAIEAAAAAAAAAAAAAAMMAAADDAAAAwwAAAMMAAAA=) 8 4,auto":"tableCornerSelect"===p.action?b.style.cursor="url(data:image/ico;base64,AAABAAEACgoAAAEAIADgAQAAFgAAACgAAAAKAAAAFAAAAAEAIAAAAAAAkAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAkAAACTAAAA/QAAAP8AAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAAAAAAAEwAAAJ8AAAD8AAAA/wAAAP8AAAD/AAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAoAAAA3AAAAP8AAAD/AAAA/wAAAP8AAAAAAAAAAAAAAAAAAAATAAAAngAAAPwAAAD/AAAA/wAAAP8AAAD/AAAAAAAAAAAAAAASAAAAnwAAAP0AAAD/AAAA+gAAANwAAAD6AAAA/wAAAAAAAAASAAAAnwAAAP0AAAD/AAAA/QAAAJ4AAAAlAAAAnwAAAP0AAAAVAAAAngAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAABQAAACTAAAApwAAAP0AAAD/AAAA/QAAAJ8AAAASAAAAAAAAAAAAAAAAAAAACgAAAG0AAADqAAAA/gAAAJ4AAAASAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAAAbQAAAKgAAAAWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAOAAAADwAAAA4AAAAMAAAACAAAAAAQAAAAOAAAAHwAAAD8AAAA==) 10 5,auto":"tableSelect"===p.action?b.style.cursor="move":"default"===p.action&&(b.style.cursor=""):i?i.action===tt?b.style.cursor=l.CursorResource.ResizeCol:i.action===K?b.style.cursor=l.CursorResource.ResizeRow:i.action===et?b.style.cursor=l.CursorResource.ResizeHiddenCol:i.action===$?b.style.cursor=l.CursorResource.ResizeHiddenRow:b.style.cursor=nt:a?a.left||a.right?b.style.cursor="w-resize":(a.top||a.bottom)&&(b.style.cursor="n-resize"):s&&"drag"===s.action?s.side===J?b.style.cursor="crosshair":s.side?b.style.cursor="move":b.style.cursor=nt:u?(u.inBorder?b.style.cursor="move":u.inTopLeft?b.style.cursor="nw-resize":u.inTopRight?b.style.cursor="ne-resize":u.inBottomLeft?b.style.cursor="sw-resize":u.inBottomRight&&(b.style.cursor="se-resize"),d=v.isFormulaRangeHoving,m=(g=v.tH)&&g.paramRange,y=u.paramRange,v.isFormulaRangeHoving=!0,v.tH={paramRange:y},d&&y.index===m.index||f.uH()):h?b.style.cursor="se-resize":(c&&(n=C.getCellType(c.row,c.col,yt(t)),c.sheet=C,o&&n.processMouseEnter(c),n.YBb(c)),!o&&c&&c.isReservedLocation||(b.style.cursor=nt),v.isFormulaRangeHoving&&(v.isFormulaRangeHoving=!1,v.tH=M,f.uH())))},t.prototype.CD=function(t){var e=this,n=e.kj;return e.uC(),!n.dG||(n.dG=!1,e.vH(t),!1)},t.prototype.vH=function(t){var e,n,o,r=this,i=r.kj,a=l.Vl.Xl();r.eG=!1,r.mIb=0,a&&a!==i&&a.endEdit&&(a.Cw&&a.Cw.V4||(a.endEdit(),a.repaint())),l.Vl.Zl(i),r.isResizing?r.YG():r.$ia?r.aja&&r.aja():r.zG?r.wH&&r.wH():r.BG?r.xH&&r.xH():r.DG?r.yH():r.FG?r.zH():r.HG?r.AH():r.qIb?r.wIb&&r.wIb():i.yt&&(n=(e=i.yt).cellTypeHitInfo,!e.filterButtonHitInfo&&!e.resizeInfo&&e.row>=0&&e.col>=0&&(n&&(o=i.getCellType(n.row,n.col,yt(e)),n.sheet||(n.sheet=i),o.XGb(n)),n&&n.isReservedLocation||i.Wq(l.Events.CellClick,kt(i,i.name(),e.row,e.col,yt(e))),r.hH(),i.sgc&&i.tgc&&i.tgc())),r.lG(t)},t.prototype.UF=function(t,e,n){var o,r=this.kj;r.isEditing&&r===l.Vl.Xl()&&(o=r.Ws(),Tt(t)||wt(t)||r.FF(o,e,n))},t.prototype.nm=function(t){var e,n,o,r,i,a,s,u,c,f,h,p,d=this,m=d.kj;if(m){if(e=vt(m),n=Ct(m),o=m.getCellType(e,n),r={isEditing:ut(m),sheet:m,row:e,col:n,sheetArea:3},i={sheet:m,row:e,col:n,sheetArea:3},o&&o.isReservedKey(t,r))return void(ut(m)||o.processKeyDown(t,i));if((a=m.Cw)&&a.BH(t))return;if((s=m.parent&&m.parent.CF)&&s.BH(t,r))return}if(u=!(ut(m)||wt(t)||St(t)||34!==bt(t)&&33!==bt(t)&&37!==bt(t)&&39!==bt(t)&&9!==bt(t)&&13!==bt(t)&&38!==bt(t)&&40!==bt(t)),m.CH&&(m.CH=!1,m.yl.DH()),h=13===(f=bt(t)),p=27===f,m.sgc&&m.ugc&&(h||p)?m.ugc(p):c=d.EH(t),u&&c&&l.Vl.Wl(m)){if(d.Uoa=new Date,d.FH)return d.GH<25&&d.GH++,void g(t);d.FH=!0,d.GH=1,d.HH(t,!0)}},t.prototype.VG=function(){var t,e,n=this.kj,o=n.yt.resizeInfo;return o.action===K||o.action===$?(t=n.getRowHeight(o.index),y(it().Tip_Height,[t])):(e=n.getColumnWidth(o.index),y(it().Tip_Width,[e]))},t.prototype.XG=function(t){var e=this.kj;return t.action===K||t.action===$?y(it().Tip_Height,[O(0,j((t.movingY-t.startY)/e.zoom()))]):y(it().Tip_Width,[O(0,j((t.movingX-t.startX)/e.zoom()))])},t.prototype.HH=function(t,e){var n=this;if(n.FH){if(new Date-n.Uoa>100)return void n.Ux();e||n.EH(t),n.FH&&(n.WF=c.setTimeout((function(){n.HH(t)}),500/n.GH))}},t.prototype.IH=function(t,e){var n,o,r,i=this.kj,a=i.Ws();if(a){i.HF=!0;try{n=ut(i),i.EF&&i.EF(a,i.Jl,i.Kl,M,M,!0,M,e,t),!n&&ut(i)&&(!(o=i.getCellType(i.Jl,i.Kl)).tw||32!==bt(t)||wt(t)||Tt(t)||xt(t)||o.tw(i,i.Jl,i.Kl,3),o.JH&&o.JH(t))}finally{i.HF=!1,(r=i.tu()).UHb&&delete r.UHb}}},t.prototype.EH=function(t){var e,n,o,i,a,l,u,f,h,p,d=this,m=d.kj;if(d.lG(t),ut(m)||27!==bt(t)||xt(t)||wt(t)||Tt(t)||!m.KH||(s.GC$(m.KH).remove(),m.KH=M),e=m.tu(),ut(m)||27!==bt(t)||xt(t)||wt(t)||Tt(t)||!e.UHb||delete e.UHb,ut(m)||34!==bt(t)&&33!==bt(t)&&35!==bt(t)&&36!==bt(t)&&38!==bt(t)&&40!==bt(t)||g(t),ut(m)||37!==bt(t)&&39!==bt(t)||g(t),ut(m)&&wt(t)&&(89===bt(t)||90===bt(t)))return g(t),!1;if(o=(n=m.wu()).getShortcutKey(bt(t),wt(t),Tt(t),xt(t),St(t)),i=n.getCommands(o))for(a=0;a<i.length;a++)if(l={sheetName:m.name()},(u=i[a].execute(m.parent,l))||l.vgc)return u.ignoreCancelDefault||g(t),!0;return f={e:t,r:M},r.Worksheet.ao(m,"processKeyDown",f),!!f.r||(d.LH(t)&&((h=m.Cw)&&h.MH&&h.NH(),ut(m)||((p=c.Yl.Bm(t.target))&&"gcAttachedFormulaTextBox"===p.getAttribute(Q)||d.IH(t))),!1)},t.prototype.Ux=function(){var t=this;t.FH=!1,t.WF>0&&(clearTimeout(t.WF),t.WF=0)},t.prototype.om=function(t){var e,n,o,r,i,a,s,l,u=this;if(u.Ux(),e=u.kj){if(n=vt(e),o=Ct(e),r=e.getCellType(n,o),i={isEditing:ut(e),sheet:e,row:n,col:o,sheetArea:3},a={sheet:e,row:n,col:o,sheetArea:3},r&&r.isReservedKey(t,i))return void(ut(e)||r.processKeyUp(t,a));if((s=e.Cw)&&s.BH(t))return;if((l=e.parent&&e.parent.CF)&&l.BH(t))return}u.lG(t)},t.prototype.pm=function(t){this.IH(t,!0)},t.prototype.LH=function(t){return!(wt(t)||xt(t)||St(t))&&(bt(t)>=65&&bt(t)<=90||bt(t)>=48&&bt(t)<=57||bt(t)>=96&&bt(t)<=105||bt(t)>=186&&bt(t)<=192||bt(t)>=220&&bt(t)<=222||219===bt(t)||bt(t)>=106&&bt(t)<=111||32===bt(t)||61===bt(t)||173===bt(t)||229===bt(t)||0===bt(t)||8===bt(t))},t.prototype.lG=function(t){var e,n,o,r,i,a=this,s=a.kj,u=l.Ul.sl()?St(t):wt(t);a.ctrl=u&&!Tt(t),a.shift=Tt(t)&&!u,s.Hx=!1,9===bt(t)&&((e=s.ITa.getSelections().length)>1?s.Hx=!0:(n=s.Ix())&&e>0&&(s.Hx=!(s.Jl===n.row&&s.Kl===n.col&&s.Lr>=It(n)&&s.Mr>=At(n)))),!0===a.zG&&(o=s.Ix(),r=a.OH,i=a.PH,-1===o.row||-1===o.col?a.OH=Tt(t):a.OH=!1,a.PH=u,r===a.OH&&i===a.PH||s.yl.QH&&s.yl.QH()),a.RH=u},t.prototype.Vx=function(){var t=this;t.shift=!1,t.ctrl=!1,t.kj.Hx=!1,t.zG=!1,t.OH=!1,t.PH=!1,t.RH=!1},t.prototype.Qw=function(t){var e,n,o,r,i,a,l,u,c,f,h,p;t&&t.sheet?(e=t.sheet,n=t.editor,o=t.canvasOffset):n=(e=this.kj).BF,ut(e)&&(r=e.Jl,i=e.Kl,a=e.getCellType(r,i),l=e.am(),u=e.getActualStyle(r,i),c=e.getCellRect(r,i),n&&n.parentNode&&(f=n.parentNode.parentNode,c&&c.width>0&&c.height>0&&c.x>=l.kt&&c.y>=l.nt&&c.x+c.width<=l.lt+l.js&&c.y+c.height<=l.ot+l.gs?(h={sheet:e,row:r,col:i,sheetArea:3,canvasOffset:o},a.g5(f,u,c,h,!0)):s.GC$(f).css({top:-1e4,left:-1e4})),(p=e.Cw)&&p.SH())},t.prototype.TH=function(t,e){var n,o;if(!t)return M;for(n=t.firstChild;n;){if(n.id===e||n.name===e)return n;if(o=this.TH(n,e))return o;n=n.nextSibling}return M},t.prototype.zu=function(t,e){var n,o,r,i=!0;if(t.length===e.length)for(n=0;n<t.length;n++){if(o=t[n],r=e[n],o.row!==r.row||o.col!==r.col||It(o)!==It(r)||At(o)!==At(r)){i=!0;break}i=!1}return i},t.prototype.UH=function(t,e,n,o){var r,i,a,l,u,c,f=this,h=f.kj,d={sheet:h,row:e,col:n,sheetArea:3},g=h.zo(),y=t.isImeAware(d),v=ot?G:"fixed";return o&&f.VH(),y&&!f.GF&&(i=(r=t.a5(d)).style,f.WH||(f.WH={overflow:"visible",border:X,position:G}),f.WH.overflow=i.overflow,f.WH.border=i.border,f.WH.position=i.position,s.GC$(r).css([B,V,z,W,U,q,H],[v,Y,"0px","0px","0px","0px",X]),h.KF&&r.firstChild&&(a=r.firstChild.firstChild,h.KF(t,a,e,n,h.getActualStyle(e,n)),l=t.getEditorValue(a,d),p.safari&&(""===l||C(l))&&t.setEditorValue(a," ",d)),g&&g.insertBefore(r,M),f.GF=r),f.XH||(r=m("div"),s.GC$(r).css([B,V,z,W,U,q],[v,Y,"0px","0px","0px","0px"]),f.XH=r,u=m("textarea"),s.GC$(u).attr(Q,"gcSheetFocusInput").attr(Z,-1).css([B,V,H,"resize"],[G,Y,X,X]),u.value=" ",r.insertBefore(u,M),f.YH=u,c=m("div"),s.GC$(c).css(B,G).css(V,Y).attr(Q,"gcSheetFocusInput").attr(Z,-1),r.insertBefore(c,M),f.ZH=c,g&&g.insertBefore(r,M)),ot&&(f.GF&&f.$H(h,f.GF),f.$H(h,f.XH)),y?f.GF:f.YH},t.prototype.JF=function(){var t=this;t.GF&&t.WH&&s.GC$(t.GF).css(V,t.WH.overflow).css(H,t.WH.border).css(B,t.WH.position)},t.prototype.VH=function(){var t=this;t.GF&&(t.GF.parentElement&&t.GF.parentElement.removeChild(t.GF),t.GF.comboBox&&(t.GF.comboBox=M),t.GF=M)},t.prototype.zt=function(t){l.Vl.Wl(this.kj)||this._H(!0,!0,t)},t.prototype.Cm=function(){var t=this.ZH;t&&t.focus()},t.prototype.Qq=function(){this._H(!0,!0)},t.prototype.aI=function(){this.bI&&(clearTimeout(this.bI),this.bI=M)},t.prototype._H=function(t,e,n){var o,r,i,a,s,u,h,g,m,y,v,C;0===arguments.length&&(t=!0),(o=this).Gma||(o.XF=!1,o.aI(),r=o.kj,i=vt(r),a=Ct(r),s=r.getCellType(i,a),o.UH(s,i,a,e),u={sheet:r,row:i,col:a,sheetArea:3},h=s.isImeAware(u)&&o.GF.firstChild?o.GF.firstChild.firstChild:o.YH,g=h,e&&!p.msie&&s.setImeMode(g,r.getActualStyle(i,a).imeMode,u),f.body.focus(),m=function(){e&&p.msie&&s.setImeMode(g,r.getActualStyle(i,a).imeMode,u),function(){try{s.isImeAware(u)?(s.focus(g,u),s.selectAll(g,u)):(h.focus(),h.select())}catch(t){}}()},y=d,v=p.metroMode||y.ipad||y.iphone||y.android,!r.CH&&!v||!t&&s.isImeAware(u)?!1===r._enhanceIme||n||m():!ut(r)&&v?e&&(C=o.GF&&o.GF.firstChild&&o.GF.firstChild.firstChild,s.setImeMode(C,r.getActualStyle(i,a).imeMode,u)):o.bI=c.setTimeout((function(){o.aI(),ut(r)||!1===r._enhanceIme||n||m()}),200),l.Vl.Wl(r)||l.Vl.Zl(r),o.byb(r)||o.cs&&o.cs(r.Jl,r.Kl))},t.prototype.$H=function(t,e){var n,o,r,i,a,l,u,f=vt(t),h=Ct(t),p=t.Nr,d=t.Pr,g=t.getCellRect(f,h,p,d),m=this,y=t.Vs(),v=m.bG(),C=m.GF,b=0,w=0,T=0,x=0;C&&(r=s.GC$(C),b=parseInt(r.css(z),10),w=parseInt(r.css(W),10),T=parseInt(r.css(q),10),x=parseInt(r.css(U),10)),m.oG(g)?(n=b,o=w):(n=g.y+v.top-2,o=g.x+v.left-2),i=c.pageYOffset-y.top+v.top,a=c.innerHeight+i-T,l=c.pageXOffset-y.left+v.left,u=c.innerWidth+l-x,(E(n)||n<i||n>a)&&(n=i),(E(o)||o<l||o>u)&&(o=l),s.GC$(e).css(z,n).css(W,o)},t.prototype.cI=function(t){var e,n,o,r,i=this;i.aI(),ut(i.kj)||i.XF&&f.activeElement===i.ZH||(e=i.kj,t?(n=t.row,o=t.col):(n=e.Jl,o=e.Kl),r=e.getCellType(n,o),i.UH(r,n,o,!1),i.ZH.focus(),i.XF=!0)},t.prototype.dI=function(t,e){var n=this;n.XF&&(n.XF=!1,!e&&n._H(t))},t.prototype.gx=function(t){var e=this.kj.tu();e&&(e.ska(t),e.M4(),this.Gma=!0,t&&e.N4())},t.prototype.hx=function(){var t=this,e=t.kj.tu();e&&e.ska(""),t.Gma=!1,t._H(!0,!1)},t.prototype.MF=function(){var t,e=this;e.aI(),(t=e.GF)&&(s.GC$(t).remove(),e.GF=N),(t=e.XH)&&(s.GC$(t).remove(),e.YH=N,e.XH=M,e.ZH=M)},t.prototype.uw=function(t,e,n,o){var r=this.kj.parent;r&&r.uw(t,e,n,o)},t.prototype.ww=function(t,e,n,o){var r=this.kj.parent;r&&r.ww(t,e,n,o)},t.prototype.xw=function(){var t=this.kj.parent;t&&t.xw()},t.prototype.Uw=function(t){var e,n,o,r,i,a,s,l;n=(e=this.kj).hCb,o=e.iCb,i=!1,(r=e.yt)||(i=!0),i||t||(i=!0),i||(i=t.col!==r.col||t.row!==r.row||mt(t)!==mt(r)||gt(t)!==gt(r)||yt(t)!==yt(r)||!function(t,e){var n=!1;return t||e?t&&e&&(n=t.action===e.action&&t.index===e.index&&t.sheetArea===e.sheetArea):n=!0,n}(t.resizeInfo,r.resizeInfo)),e.yt=t,i&&(r&&!C(r.hitTestType)&&(e.ITa.setCellState(n,o,u.CellStatesType.hover,!1,r.hitTestType),e.xIb&&e.xIb(u.CellStatesType.hover,n,o,r.hitTestType,r.rowViewportIndex,r.colViewportIndex)),t&&!C(t.hitTestType)&&(e.hCb=t.row,e.iCb=t.col,t.resizeInfo||(e.ITa.setCellState(t.row,t.col,u.CellStatesType.hover,!0,t.hitTestType),e.xIb&&e.xIb(u.CellStatesType.hover,t.row,t.col,t.hitTestType,t.rowViewportIndex,t.colViewportIndex))),e.fI=!0,s=lt(e,r,a=e.yl),l=lt(e,t,a),s=s||l,e.fI=!1,s&&a.im())},t.prototype._G=function(t,e,n){var o=this.gI(t,e,n);return this.hI(o)},t.prototype.gI=function(t,e,n){var o=this.kj.ITa.getSpan(t,e),r=It(o),i=At(o);return 1===r&&1===i||n&&1===r||!n&&1===i?o:(n?e++:t++,this.gI(t,e,n))},t.prototype.hI=function(t){var e,n,o,r=this.kj,i=t.row,a=pt(r);for(e=i;e<a&&!0!==r.getRowVisible(e);e++);for(e<a&&(i=e),n=t.col,o=dt(r),e=n;e<o&&!0!==r.getColumnVisible(e);e++);return e<o&&(n=e),v(i,n,It(t),At(t))},t.prototype.byb=function(t){var e,n,o=t.floatingObjects&&t.floatingObjects.all(),r=t.shapes&&t.shapes.all();if(!C(o))for(e=0;e<o.length;e++)if(o[e].isSelected())return!0;if(!C(r))for(n=0;n<r.length;n++)if(r[n].isSelected())return!0},t}(),e.iI=st,r.Worksheet.$n("eventHandler",{beforeSetHost:function(){this.mm=new st(this)},dispose:function(t){var e,n,o,r,i=this,a=i.mm;a&&(a.uC(),e=a.nIb,s.GC$(i.Ws()).unbind(w+"."+e).unbind(T+"."+e).unbind(x+"."+e).unbind(S+"."+e).unbind(R+"."+e).unbind(k+"."+e),p.mozilla&&(n="onwheel"in document?I:A,s.GC$(i.Ws()).unbind(n+"."+e)),a.no(),a.MF()),(o=i.BF)&&s.GC$(o).remove(),(r=i.NF)&&r.close(),!1!==t.clearCache&&(i.OF=M,i.PF=M,i.QF=M,i.RF=M,i.SF=M,i.TF=M,i.mm=M)},setHost:function(t){var e,n,o,i;t&&(n=(e=this).mm,e.OF=function(t){var o={e:t,r:M};if(r.Worksheet.ao(e,"preProcessMouseDown",o),!o.r)return n.AD(t)},e.PF=function(t){var o={e:t,r:M};r.Worksheet.ao(e,"preProcessMouseMove",o),o.r||n.RB||n.BD(t)},e.QF=function(t){var o={e:t,r:M};if(r.Worksheet.ao(e,"preProcessMouseUp",o),!o.r&&!e.XD){if(n.RB)return;return n.CD(t)}},e.RF=function(t){var n,o,i,a,s,l,u,f,h,d;if(n={e:t=t||c.event,r:M},r.Worksheet.ao(e,"preProcessMouseWheel",n),!n.r)return i=(o=e.parent)&&o.options.scrollByPixel,a=t.detail?t.detail:t.wheelDelta/-40,s=0,"wheel"===t.type?(a=t.deltaY,s=t.deltaX,i||(P(a)>=P(s)?s=0:a=0)):(l=(new Date).valueOf(),u=t.wheelDeltaY,f=t.wheelDeltaX,i||(P(u)>=P(f)?f=0:u=0),h=!e.nka||l-e.nka>200,(p.safari||p.chrome)&&(d=p.safari?-4:-40,C(u)||(h?(a=((a=u/d)>=0?1:-1)*j(P(a)),e.oka=0):(a=u/d,e.oka+=a,a=(a>=0?1:-1)*j(P(e.oka)),e.oka-=a)),C(f)||(h?(s=((s=f/d)>=0?1:-1)*j(P(s)),e.pka=0):(s=f/d,e.pka+=s,s=(s>=0?1:-1)*j(P(e.pka)),e.pka-=s))),e.nka=l),(0!==a||0!==s)&&(!!e.parent.ku.Rw(t,D(a,10)||0,D(s,10)||0)&&void 0)},e.SF=function(t){var o={e:t,r:M};if(r.Worksheet.ao(e,"preProcessMouseOut",o),!o.r)return n.DD(t)},e.TF=function(t){var o,i,a={e:t,r:M};r.Worksheet.ao(e,"preProcessMouseDbClick",a),a.r||(o=e.yt)&&(i=!1,3===yt(o)?function(t,n){var o=e.Vs(),r=n.pageX-o.left,i=n.pageY-o.top,a=e.hitTest(r,i),s=a.dragInfo;a.tableSelectInfo||(s&&t.cyb&&"corner"===s.side?t.cyb():t.UF(n,r,i))}(n,t):i=function(t,e){var n,o,r=t.kj,i=e.resizeInfo;return!!i&&(i.action===K||i.action===$?(n=[],r.tp(i.index)?h(r.ITa.getSelections(),(function(t,e){var o,i;if(-1===e.col)for(o=r.Tq(e),i=0;i<It(o);i++)n.push({row:o.row+i})})):n.push({row:i.index}),r.wu().execute({cmd:"autoFitRow",sheetName:r.name(),rows:n,columnHeader:1===i.sheetArea})):(o=[],r.sp(i.index)?h(r.ITa.getSelections(),(function(t,e){var n,i;if(-1===e.row)for(n=r.Tq(e),i=0;i<At(n);i++)o.push({col:n.col+i})})):o.push({col:i.index}),r.wu().execute({cmd:"autoFitColumn",sheetName:r.name(),columns:o,rowHeader:2===i.sheetArea})),!0)}(n,o),i||e.Wq(l.Events.CellDoubleClick,kt(e,e.name(),o.row,o.col,yt(o))))},o=n.nIb,t.bind(w+"."+o,(function(t){return e.OF(t)})).bind(T+"."+o,(function(t){return e.QF(t)})).bind(x+"."+o,(function(t){return e.PF(t)})).bind(S+"."+o,(function(t){return e.RF(t)})).bind(R+"."+o,(function(t){return e.SF(t)})).bind(k+"."+o,(function(t){return e.TF(t)})),p.mozilla&&(i="onwheel"in document?I:A,t.bind(i+"."+o,(function(t){return e.RF(t)}))))}})},"./dist/core/worksheet/worksheet-formatter.js":function(t,e,n){"use strict";var o,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/util/domUtil.js"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/worksheet/style.js"),a=n("./dist/core/util/common.js"),s=n("Common"),o.GC$.extend(r.Worksheet.prototype,{getFormatter:function(t,e,n){return this.tq(t,e,"formatter",n)},setFormatter:function(t,e,n,o){var r=this.Iq(t,e,o);r||(r=new i.Style),r.formatter=n,this.setStyle(t,e,r,o)}}),r.Worksheet.$n("formatter",{settingText:function(t){var e,n=a.util.tl(t.value),o=s.Formatter&&s.Formatter.GeneralFormatter;o&&n&&(e={},(new o).getPreferredDisplayFormatter(t.value,e),"number"==typeof e.value&&(t.value=e.value))}})},"./dist/core/worksheet/worksheet-json.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S;function A(t,e,n,o){var r,i;if(t.dataTable&&(e.dataTable||(e.dataTable={}),r=t.dataTable[n])){if(e.dataTable[n]||(e.dataTable[n]={}),!(i=r[o]))return;e.dataTable[n][o]||(e.dataTable[n][o]={}),i.formula&&(e.dataTable[n][o].formula=i.formula)}}function I(t,e,n,o){var r,i,a=t.ITa,l=a.XTa(),u=a.XTa(f.SheetArea.colHeader),c=a.YTa(!0),h=a.YTa(!0,f.SheetArea.colHeader),p=a.zl(),d=a.zl(f.SheetArea.colHeader),g=l.getColumnCount();for(b(e.colHeaderData)&&(e.colHeaderData={}),u.setRowCount(n),r=0;r<n;r++)for(u.setNode(r,-1,l.RTa(r,-1)),h.Kp(r,c.Jp(r)),i=o;i<g;i++)u.setNode(r,i,l.RTa(r,i)),A(e.data,e.colHeaderData,r,i);p.getSpans(s.kf(0,0,n,g)).forEach((function(t){d.add(t)})),t.frozenRowCount(0)}function R(t,e,n,o){var r,i,a=t.ITa,l=a.XTa(),u=a.XTa(f.SheetArea.rowHeader),c=a.YTa(!1),h=a.YTa(!1,f.SheetArea.rowHeader),p=a.zl(),d=a.zl(f.SheetArea.rowHeader),g=l.getRowCount();for(b(e.rowHeaderData)&&(e.rowHeaderData={}),u.setColumnCount(n),r=0;r<n;r++)for(u.setNode(-1,r,l.RTa(-1,r)),h.Kp(r,c.Jp(r)),i=o;i<g;i++)u.setNode(i,r,l.RTa(i,r)),A(e.data,e.rowHeaderData,i,r);p.getSpans(s.kf(0,0,g,n)).forEach((function(t){d.add(t)})),t.frozenColumnCount(0)}function k(t,e){switch(t){case"frozenRowCount":case"frozenColCount":case"frozenTrailingRowCount":case"frozenTrailingColCount":case"activeRow":case"activeCol":return 0===e;case"rowCount":return 200===e;case"columnCount":return 20===e;case"zoomFactor":case"rowHeaderColCount":case"colHeaderRowCount":return 1===e;case"visible":return!0===e}return!1}function M(t,e){return m(t)?t:e}function N(t,e,n){m(n)&&e.call(t,n,!1)}function E(t,e,n,o,r){g&&y(g,(function(i,a){var s=a.fromJson;s&&s.call(t,e,n,o,!m(r)||r)}))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/worksheet/style.js"),a=i.Style.kxb,s=n("./dist/core/util/common.js"),l=n("./dist/core/util/theme.js"),u=n("./dist/core/util/domUtil.js"),c=n("./dist/core/worksheet/stylehelper.js"),f=n("./dist/core/core.enum.js"),h=n("@grapecity/js-calc"),p=!!h,d=o.Common.CultureManager,g=r.Worksheet._n,m=s.util.Ol,y=u.GC$.each,v=u.GC$.isEmptyObject,C=o.Common.D,b=o.Common.j.Fa,w="string",T=parseInt,x=isNaN,S=void 0,u.GC$.extend(r.Worksheet.prototype,{qI:function(t,e,n,o){var r;t[e]||(t[e]={}),(r=t[e])[n]||(r[n]={}),r[n].value=o},$ec:function(t,e){var n,o,i,a,s=this,l=s.ITa,u=l.XTa(),c=l.XTa(f.SheetArea.colHeader),h=l.YTa(!0),p=l.YTa(!0,f.SheetArea.colHeader),d=l.zl(),g=l.zl(f.SheetArea.colHeader),m=u.getColumnCount();for(n=0;n<t;n++)for(u.setNode(n,-1,c.RTa(n,-1)),h.Kp(n,p.Jp(n)),o=e;o<m;o++)(i=c.RTa(n,o))||(i={}),i.style=s.getActualStyle(n,o,f.SheetArea.colHeader),u.setNode(n,o,i),(a=s.getFormula(n,o,f.SheetArea.colHeader))&&s.setFormula(n,o,a,f.SheetArea.viewport);g.getSpans().forEach((function(t){d.add(t)})),s.frozenRowCount(t),l.dWa(r.Worksheet.Vp,m,f.SheetArea.colHeader),l.fWa(!1,f.SheetArea.colHeader),l.eWa(f.SheetArea.colHeader),s.Bj(f.SheetArea.colHeader).clearAll()},Zec:function(t,e){var n,o,i,a,s=this,l=s.ITa,u=l.XTa(),c=l.XTa(f.SheetArea.rowHeader),h=l.YTa(!1),p=l.YTa(!1,f.SheetArea.rowHeader),d=l.zl(),g=l.zl(f.SheetArea.rowHeader),m=u.getRowCount();for(n=0;n<t;n++)for(u.setNode(-1,n,c.RTa(-1,n)),h.Kp(n,p.Jp(n)),o=e;o<m;o++)(i=c.RTa(o,n))||(i={}),i.style=s.getActualStyle(o,n,f.SheetArea.rowHeader),u.setNode(o,n,i),(a=s.getFormula(o,n,f.SheetArea.rowHeader))&&s.setFormula(o,n,a,f.SheetArea.viewport);g.getSpans().forEach((function(t){d.add(t)})),s.frozenColumnCount(t),l.dWa(m,r.Worksheet.Tp,f.SheetArea.rowHeader),l.fWa(!1,f.SheetArea.rowHeader),l.eWa(f.SheetArea.rowHeader),s.Bj(f.SheetArea.rowHeader).clearAll()},toJSON:function(t){var e,n,o,i,a,l,u,h,p,d,m,w,T,x,S,A,I,R,M,N,E,D=this,O=t&&t.ignoreStyle;for(w in t&&!t.Yec&&(e=D.getRowCount(f.SheetArea.colHeader),n=D.getColumnCount(f.SheetArea.rowHeader),o=t.rowHeadersAsFrozenColumns,a=t.columnHeadersAsFrozenRows&&e>0,(i=o&&n>0)&&D.addColumns(0,n),a&&D.addRows(0,e,a),i&&D.Zec(n,a?e:0),a&&D.$ec(e,i?n:0)),l=D.getRowCount(),u=D.getColumnCount(),h=D.getRowCount(f.SheetArea.colHeader),p=D.getColumnCount(f.SheetArea.rowHeader),d={name:D.name(),isSelected:D.DHb(),rowCount:l,columnCount:u,activeRow:D.Jl,activeCol:D.Kl,zoomFactor:D.zoom(),rowHeaderColCount:p,colHeaderRowCount:h,visible:D.visible()},O||(d.frozenRowCount=D.frozenRowCount(),d.frozenColCount=D.frozenColumnCount(),d.frozenTrailingRowCount=D.frozenTrailingRowCount(),d.frozenTrailingColCount=D.frozenTrailingColumnCount(),d.theme=D.Pm.toJSON()),m=D.ITa.toJSON(t))d[w]=m[w];for(x in g&&y(g,(function(e,n){n.toJson&&n.toJson.call(D,d,t)})),T={},d)C(d,x)&&(S=d[x],b(S)||k(x,S)||(T[x]=S));if(function(t,e){var n,o,r,i,a,s,l,u,c,f=t.ITa.ZHb.anchors;for(n in f)if(o=+n,r=f[n],i=e[o],r&&i)for(a in r)s=+a,(l=r[a])&&((u=i[s])&&(c={row:l.row,rowCount:l.rowCount,col:l.col,colCount:l.colCount,isDynamicArray:!0},l.isValid||(c.isInvalid=!0),u.arrayInfo=c))}(D,d.data.dataTable),y(D.options,(function(t,e){var n,o,i,a=e;"gridline"===t&&(a={},n=e.color,o=e.showHorizontalGridline,i=e.showVerticalGridline,n&&n!==s.Im.Lm("gc-gridlineColor").borderTopColor&&(a.color=n),!1===o&&(a.showHorizontalGridline=o),!1===i&&(a.showVerticalGridline=i)),"sheetAreaOffset"===t&&(a={},e.left&&(a.left=e.left),e.top&&(a.top=e.top)),"_ps"===t||b(a)||r.Worksheet.Qp[t]===a||"object"==typeof a&&v(a)||(T[t]=a)})),A=[],I=D.Lq){for(R in I)C(I,R)&&((M=I[R])&&(N=M.toJSON(),E=M.font,v(N)||(E&&(N.font=c.To.Jo(E)),A.push(N))));A.length>0&&(T.namedStyles=A)}return T},fromJSON:function(t,e,n,o,s){var u,c,h,g,y,v,b,A,k,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot;if(n&&(u=n.noSchema,c=n.version),t){g=(h=this).ITa,y=o&&o.ignoreStyle,h.T3(),r.Worksheet.ao(h,"preFromJson"),h.suspendPaint(),g.wgc(),g.xgc(),v=d.culture(),d.culture(""),b=M(t.rowCount,r.Worksheet.Rp),A=M(t.columnCount,r.Worksheet.Sp);try{if(h.cq(t.name+"",!0),h.DHb(t.isSelected),h.setRowCount(b),h.setColumnCount(A),h.Lq={},k=t.namedStyles)for(D=0;D<k.length;D++)O=k[D],j=new i.Style,a(O,h),j.fromJSON(O,u,h),h.Kq(j);for(P in F=h.options)if(C(F,P)&&(_=t[P],"protectionOptions"===P?_=_||t.protectionOption:"allowCellOverflow"===P&&(_=m(t[P])?t[P]:!c||c>=11),m(_)))if("object"==typeof _)for(L in _)C(_,L)&&(F[P][L]=_[L]);else"borderWidth"===P?(F.sheetAreaOffset.left=_,F.sheetAreaOffset.top=_):F[P]=_;if(B=M(t.activeRow,h.Jl),G=M(t.activeCol,h.Kl),h.Kr(B,G,S,S,!0),y||(N(h,h.frozenRowCount,t.frozenRowCount),N(h,h.frozenColumnCount,t.frozenColCount),N(h,h.frozenTrailingRowCount,t.frozenTrailingRowCount),N(h,h.frozenTrailingColumnCount,t.frozenTrailingColCount)),!y){if(H=t.colStyles)for(V in H)x(V)||h.setStyle(-1,T(V,10),H[V],f.SheetArea.viewport);if(z=t.rowStyles)for(W in z)x(W)||h.setStyle(T(W,10),-1,z[W],f.SheetArea.viewport)}U=M(t.rowHeaderColCount,r.Worksheet.Tp),q=M(t.colHeaderRowCount,r.Worksheet.Vp),h.setColumnCount(U,f.SheetArea.rowHeader),h.setRowCount(q,f.SheetArea.colHeader),h.XSa(M(t._zoomFactor||t.zoomFactor,h.zoom())),N(h,h.visible,t.visible),Y=h.uja,X={sheet:h,setValidator:function(t,e,n){Y&&Y.vja(t,e,n)},ignoreStyle:y},g.fromJSON(t,u,X),h.defaults=g.defaults,Y&&Y.QV(!0),(Z=t.theme)&&!y&&(typeof(Q=Z)!==w&&m(Q)&&("_themeColor","_name",J=Q.themeColor||Q._themeColor,($=new l.ColorScheme(J.name||J._name)).fromJSON(J,u),Q=new l.Theme(Q.name||Q.Cj,$,Q.headingFont||Q.Vaa,Q.bodyFont||Q.Waa)),h.currentTheme(Q)),E(h,t,u,o,e),K=o&&o.frozenColumnsAsRowHeaders,et=(tt=o&&o.frozenRowsAsColumnHeaders)&&t.frozenRowCount||0,nt=K&&t.frozenColCount||0,tt&&et>0&&I(h,t,et,nt),K&&nt>0&&R(h,t,nt,et),p&&(ot=h.yj(),et>0&&(ot.cDc=et),nt>0&&(ot.dDc=nt)),s||(et>0&&h.deleteRows(0,et),nt>0&&h.deleteColumns(0,nt)),h.clearPendingChanges()}finally{d.culture(v),g.ygc(),h.resumePaint()}}},egc:function(t,e,n,o,s){var u,c,h,g,y,v,b,A,k,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q;if(n&&(u=n.noSchema,c=n.version),t){g=(h=this).ITa,y=o.ignoreStyle,h.T3(),r.Worksheet.ao(h,"preFromJson"),g.wgc(),g.xgc(),v=d.culture(),d.culture(""),M(t.rowCount,r.Worksheet.Rp),M(t.columnCount,r.Worksheet.Sp);try{if(h.Lq={},b=t.namedStyles)for(A=0;A<b.length;A++)k=b[A],D=new i.Style,a(k,h),D.fromJSON(k,u,h),h.Kq(D);for(j in O=h.options)if(C(O,j)&&(F=t[j],"protectionOptions"===j?F=F||t.protectionOption:"allowCellOverflow"===j&&(F=m(t[j])?t[j]:!c||c>=11),m(F)))if("object"==typeof F)for(P in F)C(F,P)&&(O[j][P]=F[P]);else"borderWidth"===j?(O.sheetAreaOffset.left=F,O.sheetAreaOffset.top=F):O[j]=F;if(_=M(t.activeRow,h.Jl),L=M(t.activeCol,h.Kl),h.Kr(_,L,S,S,!0),y||(N(h,h.frozenRowCount,t.frozenRowCount),N(h,h.frozenColumnCount,t.frozenColCount),N(h,h.frozenTrailingRowCount,t.frozenTrailingRowCount),N(h,h.frozenTrailingColumnCount,t.frozenTrailingColCount)),!y){if(B=t.colStyles)for(G in B)x(G)||h.setStyle(-1,T(G,10),B[G],f.SheetArea.viewport);if(H=t.rowStyles)for(V in H)x(V)||h.setStyle(T(V,10),-1,H[V],f.SheetArea.viewport)}z=M(t.rowHeaderColCount,r.Worksheet.Tp),W=M(t.colHeaderRowCount,r.Worksheet.Vp),h.setColumnCount(z,f.SheetArea.rowHeader),h.setRowCount(W,f.SheetArea.colHeader),h.XSa(M(t._zoomFactor||t.zoomFactor,h.zoom())),N(h,h.visible,t.visible),U=h.uja,q={sheet:h,setValidator:function(t,e,n){U&&U.vja(t,e,n)},ignoreStyle:y,incrementalLoading:o.incrementalLoading,incrementLoadTask:o.incrementLoadTask},g.fromJSON(t,u,q,(function(){var n,r,i,a,c,f,C,b,T;h.defaults=g.defaults,U&&U.QV(!0),(n=t.theme)&&!y&&(typeof(r=n)!==w&&m(r)&&("_themeColor","_name",i=r.themeColor||r._themeColor,(a=new l.ColorScheme(i.name||i._name)).fromJSON(i,u),r=new l.Theme(r.name||r.Cj,a,r.headingFont||r.Vaa,r.bodyFont||r.Waa)),h.currentTheme(r)),E(h,t,u,o,e),c=o&&o.frozenColumnsAsRowHeaders,C=(f=o&&o.frozenRowsAsColumnHeaders)&&t.frozenRowCount||0,b=c&&t.frozenColCount||0,f&&C>0&&I(h,t,C,b),c&&b>0&&R(h,t,b,C),p&&(T=h.yj(),C>0&&(T.cDc=C),b>0&&(T.dDc=b)),s||(C>0&&h.deleteRows(0,C),b>0&&h.deleteColumns(0,b)),h.clearPendingChanges(),d.culture(v),g.ygc(),h.loaded=!0}))}finally{}}}})},"./dist/core/worksheet/worksheet-model.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),$=this&&this.__rest||function(t,e){var n,o,r={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]]);return r};function K(t,e){return D(t)?e:t}function tt(t,e){return t.hasOwnProperty(e)}function et(t){return t.rowCount}function nt(t){return t.colCount}function ot(t,e,n,o){var r=n;Object.defineProperty(t,e,{get:function(){return r},set:function(t){var n=r;r=t,o(this,t,e,n)}})}function rt(t,e){t.cache={},e&&e.forEach((function(e){it(t,e)}))}function it(t,e){var n,o;if(t.Ef=x(t.Ef,e.row+et(e)-1),t.Ff=x(t.Ff,e.col+nt(e)-1),!t.suspendUpdatingCache)for(n=0;n<e.rowCount;n++)for(o=0;o<e.colCount;o++)t.cache[e.row+n+"_"+(e.col+o)]=e}function at(t,e){var n,o;if(!t.suspendUpdatingCache)for(n=0;n<e.rowCount;n++)for(o=0;o<e.colCount;o++)t.cache[e.row+n+"_"+(e.col+o)]=C}function st(t,e,n){var o,r,i,a,l=s.kf(-1,-1,-1,-1);return t&&(o=t.col,i=-1===(r=t.row),a=-1===o,l.row=i?0:r,l.rowCount=i?e:et(t),l.col=a?0:o,l.colCount=a?n:nt(t)),l}function lt(t,e,n,o,r){var i,a,s=t.length;for(a=0;a<s;a++)if(i=t[a],D(e)||D(n)?D(e)?D(n)?D(o)?i.containsY(r):i.containsX(o):i.col===n:i.row===e:i.contains(e,n))return i;return v}function ut(t,e,n){var o=v,r=t.length,i=!D(e);return r>0&&((o=i?t.findX(e):t.findY(n))||(o=i&&e<t[0].x||!i&&n<t[0].y?t[0]:t[r-1])),o}function ct(t,e,n,o,r,i,a,s){var l,u,c,f,h,p,d,g,m,y,v,C=r&&r.incrementLoadTask;if(C&&!C.isTerminated){for(l=C.isBusyFunc,u=a=a||0,c=!1,30,f=new Date;u<n;){if(h=e[u])for(p=0;p<o;p++)(d=h[p])&&(c=!0,pt(d,t.RTa(u,p,!0),i,u,p,r));if(u++,l&&l())break;if(new Date-f>30)break}if(c){if(g=r&&r.sheet,0!==a&&g.parent.getActiveSheet()===g)for(m=a;m<u;m++)if(g.as.viewport[1].findRow(m)){g.repaint();break}(y=r&&r.incrementalLoading)&&y.loading&&(y.loadStatus.valuesLoad+=u-a,v=function(t,e){var n=t.valuesLoad/t.total;return e?.4*n+.1:.3*n+.1}(y.loadStatus,r.doNotRecalculateAfterLoad),y.loading(v))}u<n?r.incrementLoadTask.pushTask(ct,[t,e,n,o,r,i,u,s]):s&&r.incrementLoadTask.pushTask(s,[])}}function ft(t,e,n,o,r,i,a,s){n>=0&&o>=0?(i[n]||(i[n]={}),i[n][o]=r):n>=0&&-1===o&&t>=0&&-1===e?a[n]=r:o>=0&&-1===n&&e>=0&&-1===t&&(s[o]=r)}function ht(t,e,n,o,r,i,a){if(n>=0&&o>=0){i[n]||(i[n]={}),i[n].rs="e";var s=i[n];s.originalItem=a,s[o]=r}}function pt(t,e,n,o,i,s){var u,c,f,h,d,g,m,y,w,T,x;t&&((u=t.value)!==C&&((u=u)!==v&&(u._calcError||u._error&&!D(u._code))&&((c=p&&a.CalcError.parse(u._calcError||u._error))!==C&&(u=c=j(c))),e.value=u),f=t.style,h=s&&s.sheet,f===C||s.ignoreStyle||(d=v,typeof f===b?(e.style=f,d=h&&(h.Mq(f,!1)||h.parent&&h.parent.Mq(f,!1))):f&&((d=new r.Style).fromJSON(f,n),d.name=C,e.style=d),d&&d.validator&&s&&s.setValidator&&s.setValidator(o,i,d.validator)),(g=t.visualState)!==C&&(e.visualState=g),(m=t.bindingPath)!==C&&(e.bindingPath=m),(y=t.tag)!==C&&(typeof(w=y.typeName)===b&&((T=l.getTypeFromString(w))&&((y=new T).fromJSON&&y.fromJSON(t.tag))),e.tag=y),(x=t.hyperlink)!==C&&(e.hyperlink=P(x)))}function dt(t,e){for(var n,o,r,i,a,s=e[0],l=t,u=0;u<s.length-1;u++){if(D(l))return;l=(n=s[u])===A?l.Ap:l[n]}l[s[u]]=e[1],o=s[s.length-1],i=s[s.length-2],a=s[1],"size"===o?r=s[0]===R?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth:"visible"===o&&(r=s[0]===R?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible),D(r)||t.zgc({type:r,index:i,sheetArea:a})}function gt(t,e,n){var o=t.WTa>0?[["selectionModel"],C]:C;t.selectionModel.setProperty(e,n,o),o&&t.zTa.push(o)}function mt(t,e,n,o,r){void 0===r&&(r=!1);var i=t[e];return r?void(i&&delete i[n]):(i||(i=t[e]={}),void(i[n]=o))}function yt(t,e,n,o){mt(t,e,n,{value:o})}function vt(t,e,n,o,r,i){mt(t,e,n,{value:o,oldValue:r,isAnchorCell:i})}function Ct(t,e,n,o){var r,i=t[e],a=i&&i[n];return a?a.value:(yt(t,e,n,r=o.getValue(e,n)),r)}function bt(t,e){return[t,e].join(",")}function wt(t,e){-1===t.indexOf(e)&&t.push(e)}function Tt(t,e){var n,o=Array(e);for(n=0;n<e;n++)o[n]=t;return o}function xt(t,e,n){var o=t[e];return o&&o[n]}function St(t,e){var n=e.split(",").map((function(t){return+t})),o=n[0],r=n[1],i=t[o];return i&&i[r]}function At(t,e,n,o){var r=t[e];r&&delete r[n],o&&g(r)&&delete t[e]}function It(t,e,n,o,r){var i,s,l,u,c,f,h,p,d=t.XTa(3),g=t.ZHb,m=g.anchors,y=[];for(i in m)if(m.hasOwnProperty(i)&&(s=m[i]))for(l in s)s.hasOwnProperty(l)&&((u=s[l])&&(c=u.row,f=u.col,h=u.rowCount,p=u.colCount,(r?c+h:f+p)>=e&&(u.isValid&&d.yIb(u),(r?c:f)<e&&y.push(u))));y.length&&a.markAnchorCellDirty(y,t.kj.Bj(),g)}function Rt(t){return t?t.filter((function(t){return!t.isAutoMerge})):t}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/worksheet/style.js"),i=n("Common"),a=n("@grapecity/js-calc"),s=n("./dist/core/util/common.js"),l=n("./dist/core/util/common.js"),u=n("./dist/core/util/domUtil.js"),c=n("./dist/core/core.enum.js"),f=n("@grapecity/js-calc"),h=n("./dist/core/celltype/celltype.ns.js"),p=!!f,d=u.GC$.each,g=u.GC$.isEmptyObject,m=u.GC$.extend,y=RegExp("^\\d*(\\.\\d+)?\\*$"),v=null,C=void 0,b="string",w=Math.min,T=Math.floor,x=Math.max,S=Math.ceil,A="dirtyNodes",I="undo",R="rowInfos",k="colInfos",M="default_size",N=i.Common.A,E=i.Common.B,D=i.Common.j.Fa,O=s.util.K_a,j=s.util.n0a,F=s.util.lHb,P=i.Common.j.C4,_=new i.Common.ResourceManager(o.SR),L=_.getResource.bind(_),B=function(){function t(){ot(this,"spans",[],rt),this.Ff=-1,this.Ef=-1,this.cache={},this.suspendUpdatingCache=!1}return t.prototype.find=function(t,e){return this.cache[t+"_"+e]||v},t.prototype.get=function(t,e){return this.find(t,e)||s.kf(t,e,1,1)},t.prototype.remove=function(t,e){var n=this.spans.indexOf(t);n>=0?(e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),this.removeSpan(n,1)):e&&(e.length=0)},t.prototype.removeSpan=function(t,e){for(var n=0;n<e;n++)at(this,this.spans[t+n]);this.spans.splice(t,e)},t.prototype.update=function(t,e){var n=this;at(n,n.spans[t]),n.spans[t]=e,it(n,e)},t.prototype.add=function(t,e){e&&(e[0].push("spans"),e[1]=[].concat(this.spans)),it(this,t),this.spans.push(t)},t.prototype.Zz=function(t,e,n,o,r,i,a){var l,u,c,f,h,p,d,g=this,m=!1;for(a&&(l=[].concat(g.spans)),u=g.spans.length,d=[],p=0;p<u;p++)h=(c=g.spans[p]).col,f=c.row,(-1===t||t<=f&&f<t+r)&&(-1===e||e<=h&&h<e+i)?(d.push(s.kf(-1===t?f:n+f-t,-1===e?h:o+h-e,et(c),nt(c))),m=!0):(-1===t||n<=f&&f<n+r)&&(-1===e||o<=h&&h<o+i)&&(g.removeSpan(p,1),p--,u--,m=!0);for(p=0;p<d.length;p++){if(c=d[p],!g.LTa(g.spans,0,g.spans.length,c))throw Error(L().Exp_OverlappingSpans);g.add(c)}a&&(m?(a[0].push("spans"),a[1]=l):a.length=0)},t.prototype.LTa=function(t,e,n,o){for(var r=e;r<n&&r<t.length;r++)if(t[r].intersect(o.row,o.col,et(o),nt(o)))return!1;return!0},t.prototype.getSpans=function(t){var e,n,o,r=this.spans;if(!t)return[].concat(r);for(e=[],n=0;n<r.length;n++)(o=r[n]).intersect(t.row,t.col,et(t),nt(t))&&e.push(o);return e},t.prototype.qu=function(t,e,n,o){var r,i,a=this.spans;for(r=0;r<a.length;r++)if((i=a[r]).intersect(t,e,n,o)&&(-1!==t&&(i.row<t||i.row+et(i)>t+n)||-1!==e&&(i.col<e||i.col+nt(i)>e+o)))return!0;return!1},t.prototype.MTa=function(t,e,n,o){var r,i,a=!1,s=this.spans;for(r=0,i=s.length;r<i;r++){if(t>=0||e>=0)for(;r<i&&!s[r].intersect(t,e,n,o);)r++;if(r<i){a=!0;break}}return a},t.prototype.$b=function(t,e,n,o,r){var i,a,s,l,u,c=this.spans,f=!1;for(r&&(i=[].concat(c)),a=0;a<c.length;a++)l=(s=c[a]).row,u=s.col,(-1===t||t<=l&&l<t+n)&&(-1===e||e<=u&&u<e+o)&&(this.removeSpan(a,1),a--,f=!0);r&&(f?(r[0].push("spans"),r[1]=i):r.length=0)},t.prototype.aB=function(t,e,n,o,r,i,a){var l,u,c,f,h,p,d,g,m,y=this,v=!1;for(a&&(l=[].concat(y.spans)),u=[],c=[],f=y.spans.length,g=0;g<f;g++)p=(h=y.spans[g]).row,d=h.col,(-1===t||t<=p&&p<t+r)&&(-1===e||e<=d&&d<e+i)?(m=s.kf(-1===t?p:n+p-t,-1===e?d:o+d-e,et(h),nt(h)),c.push(m),v=!0):(-1===t||n<=p&&p<n+r)&&(-1===e||o<=d&&d<o+i)?v=!0:u.push(h);if(v){if(c.length>0)for(g=0;g<c.length;g++){if(m=c[g],!y.LTa(u,0,u.length,m))throw Error(L().Exp_OverlappingSpans);u.push(m)}for(y.spans.length=0,y.cache={},g=0;g<u.length;g++)y.add(u[g]);a&&(a[0].push("spans"),a[1]=l)}else a&&(a.length=0)},t.prototype.NTa=function(t,e,n){var o,r,i,a,l,u,c,f,h,p=this,d=p.spans;for(p.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(d)),i=d.length,a=0;a<i;a++)u=(l=d[a]).row,c=l.col,f=et(l),h=nt(l),u>=t?(p.update(a,s.kf(u+e,c,f,h)),o=!0):t<u+f&&(p.update(a,s.kf(u,c,f+e,h)),o=!0);p.suspendUpdatingCache=!1,o&&rt(p,d),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},t.prototype.OTa=function(t,e,n){var o,r,i,a,l,u,c,f,h,p=this,d=p.spans;for(p.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(d)),i=d.length,a=0;a<i;a++)u=(l=d[a]).row,c=l.col,f=et(l),h=nt(l),c>=t?(p.update(a,s.kf(u,c+e,f,h)),o=!0):t<c+h&&(p.update(a,s.kf(u,c,f,h+e)),o=!0);p.suspendUpdatingCache=!1,o&&rt(p,d),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},t.prototype.PTa=function(t,e,n){var o,r,i,a,l,u,c,f,h,p,d,g,m=this,y=m.spans;for(m.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(y)),i=[],a=y.length,l=0;l<a;l++)c=(u=y[l]).row,f=u.col,h=et(u),p=nt(u),c>=t?c<t+e?c+h<=t+e?(i.push(l),o=!0):(m.update(l,s.kf(t,f,c+h-(t+e),p)),o=!0):(m.update(l,s.kf(c-e,f,h,p)),o=!0):t<c+h&&(d=s.kf(c,f,h-w(c+h-t,e),p),m.update(l,d),1===d.rowCount&&1===d.colCount&&i.push(l),o=!0);for(l=i.length-1;l>=0;l--)g=i[l],m.removeSpan(g,1);m.suspendUpdatingCache=!1,o&&rt(m,y),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},t.prototype.QTa=function(t,e,n){var o,r,i,a,l,u,c,f,h,p,d,g,m=this,y=m.spans;for(m.suspendUpdatingCache=!0,o=!1,n&&(r=[].concat(y)),i=[],a=y.length,l=0;l<a;l++)c=(u=y[l]).row,f=u.col,h=et(u),p=nt(u),f>=t?f<t+e?f+p<=t+e?(i.push(l),o=!0):(m.update(l,s.kf(c,t,h,f+p-(t+e))),o=!0):(m.update(l,s.kf(c,f-e,h,p)),o=!0):t<f+p&&(d=s.kf(c,f,h,p-w(f+p-t,e)),m.update(l,d),1===d.rowCount&&1===d.colCount&&i.push(l),o=!0);for(l=i.length-1;l>=0;l--)g=i[l],m.removeSpan(g,1);m.suspendUpdatingCache=!1,o&&rt(m,y),n&&(o?(n[0].push("spans"),n[1]=r):n.length=0)},t.prototype.toJSON=function(){var t=[].concat(this.spans);return 0===t.length?C:t},t.prototype.fromJSON=function(t){var e,n,o;if(t)for(this.spans=[],e=t,n=0;n<e.length;n++)o=e[n],this.add(s.kf(o.row,o.col,et(o),nt(o)))},t}(),(G=function(){function t(){Array.apply(this,arguments)}return t.prototype.pop=function(){return v},t.prototype.push=function(t){return 0},t.prototype.splice=function(t,e){var n,o=[];for(n=2;n<arguments.length;n++)o[n-2]=arguments[n];return v},t.prototype.slice=function(t,e){return null},t}()).prototype=[],H=function(t){function e(){var e=t.call(this)||this;return e.headingOverflowlayouts=v,e.trailingOverflowLayouts=v,e}return J(e,t),e.prototype.find=function(t){var e,n,o=this.length,r=[];for(n=0;n<o;n++)(e=this[n]).contains(t)&&r.push(e);return r},e}(G),e.np=H,V=function(){function t(t,e,n,o,r,i,a,s){var l=this;l.column=t,l.startColumn=e,l.endColumn=n,l.valueWidth=o,l.columnWidth=r,l.backgroundWidth=i,l.backgroundLeftWidth=a,l.backgroundRightWidth=s}return t.prototype.contains=function(t){return t>=this.startColumn&&t<=this.endColumn},t}(),e.op=V,z=function(){function t(){this.selections=[],this.selectionPolicy=2,this.selectionUnit=0}return t.prototype.getProperty=function(t){return this[t]},t.prototype.setProperty=function(t,e,n){n&&(n[0].push(t),n[1]=this[t]),this[t]=e},t.prototype.clear=function(t){t&&(t.push(["selections",this.get()]),t.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=[],this.activeSelectedRangeIndex=-1},t.prototype.add=function(t,e,n,o,r){r&&(r.push(["selections",this.get()]),r.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex]));var i=this,a=i.selectionPolicy,l=i.selectionUnit;0===a?(n=w(n,1),o=w(o,1),i.clear()):1===a&&i.clear(),1===l?(e=-1,o=-1):2===l&&(t=-1,n=-1),i.selections.push(s.kf(t,e,n,o)),i.activeSelectedRangeIndex=i.selections.length-1},t.prototype.get=function(){return[].concat(this.selections)},t.prototype.set=function(t,e){e&&(e.push(["selections",this.get()]),e.push(["activeSelectedRangeIndex",this.activeSelectedRangeIndex])),this.selections=t,this.activeSelectedRangeIndex>=t.length&&(this.activeSelectedRangeIndex=0)},t.prototype.toJSON=function(){var t,e=this,n={},o=e.selectionPolicy,r=e.selectionUnit,i=e.activeSelectedRangeIndex,a=e.selections.length;for(2!==o&&(n.selectionPolicy=o),0!==r&&(n.selectionUnit=r),0!==i&&(n.activeSelectedRangeIndex=i),n.length=a,t=0;t<a;t++)n[t]=e.selections[t];return g(n)?C:n},t.prototype.fromJSON=function(t){var e,n,o,r,i,a;if(t){for((e=this).clear(),n=t.selectionPolicy,o=t.selectionUnit,r=t.length,D(r)&&(r=1),i=0;i<r;i++)a=t[i],e.selections.push(s.kf(a?a.row:0,a?a.col:0,a?et(a):1,a?nt(a):1));e.activeSelectedRangeIndex=t.activeSelectedRangeIndex||0,D(n)||(e.selectionPolicy=n),D(o)||(e.selectionUnit=o)}},t.prototype.sp=function(t){var e,n,o,r=this.selections;for(e=0;e<r.length;e++)if(o=-1===(n=r[e]).col?0:n.col,-1===n.row&&t>=o&&t<o+nt(n))return!0;return!1},t.prototype.tp=function(t){var e,n,o,r=this.selections;for(e=0;e<r.length;e++)if(o=-1===(n=r[e]).row?0:n.row,-1===n.col&&t>=o&&t<o+et(n))return!0;return!1},t.prototype.vp=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d=!1,g=this.selections,m=i?1:0;for(a=0,s=g.length;a<s&&(c=(u=st(l=g[a],o,r)).row,f=u.col,h=c-m<=t&&t<c+et(u)+m,p=f-m<=e&&e<f+nt(u)+m,3===n||D(n)?d=h&&p:2===n?d=h:1===n?d=p:0===n&&(d=-1===l.row&&-1===l.col),!d);a++);return d},t.prototype.wp=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g=this.selections,m=!1;for(i=0;i<g.length&&(s=(a=g[i]).row,l=a.col,u=et(a),c=nt(a),f=-1===l,h=-1===s,D(n)||3===n||(2===n?(p=h?0:s,m=f&&t>=p&&t<p+u):1===n?(d=f?0:l,m=h&&e>=d&&e<d+c):0===n&&(m=h&&f&&u===o&&c===r),!m));i++);return m},t}(),W=function(t){function e(){return t.call(this)||this}return J(e,t),e.prototype.findCell=function(t,e){var n,o,r=this.length;for(o=0;o<r;o++)if((n=this[o]).contains(t,e))return n;return v},e.prototype.findRow=function(t){var e,n,o=this.length;for(n=0;n<o;n++)if((e=this[n]).row===t)return e;return v},e.prototype.findCol=function(t){var e,n,o=this.length;for(n=0;n<o;n++)if((e=this[n]).col===t)return e;return v},e.prototype.findX=function(t){return lt(this,C,C,t)},e.prototype.findY=function(t){return lt(this,C,C,C,t)},e.prototype.findNearX=function(t){return ut(this,t)},e.prototype.findNearY=function(t){return ut(this,C,t)},e}(G),e.yp=W,U=function(){function t(t,e,n,o,r,i,a,s,l){var u=this;u.rowCount=a,u.colCount=s,u.row=t,u.col=e,u.x=n,u.y=o,u.width=r,u.height=i,u.isAutoMerge=l}return t.prototype.contains=function(t,e){var n=this;return t<n.row+et(n)&&n.row<=t&&e<n.col+nt(n)&&n.col<=e},t.prototype.intersect=function(t){var e=this;return(e.x<0||t.x<e.x+e.width&&e.x<t.x+t.width)&&(e.y<0||t.y<e.y+e.height&&e.y<t.y+t.height)},t.prototype.containsX=function(t){return this.x<=t&&t<this.x+this.width},t.prototype.containsY=function(t){return this.y<=t&&t<this.y+this.height},t}(),e.zp=U,q=function(){function t(t,e){var n=this;n.Xj=t,n.OZ=e,n.ad()}return t.prototype.ad=function(){var t=this;t.dataTable={},t.rowDataArray=[],t.columnDataArray=[],t.defaultDataNode=v,t.Ap={},t.gga=0,t.Ff=-1,t.Ef=-1},t.prototype.getRowCount=function(){return this.Xj},t.prototype.getColumnCount=function(){return this.OZ},t.prototype.setRowCount=function(t){this.Xj=t},t.prototype.setColumnCount=function(t){this.OZ=t},t.prototype.Cp=function(t,e,n,o){var r,i,a,s,l=this.Ap;this.gga>0||t>=0&&e>=0&&(o&&(o.type="updateDirty",o.row=t,o.col=e,l[t]?l[t][e]||(o.isEmptyCol=!0):o.isEmptyRow=!0),l[t]||(l[t]={}),(r=l[t])[e]||(r[e]={}),i=r[e],"n"!==r.rs&&(r.rs="e"),a=n.Dp,s=n.Ep,D(a)||(o&&(o.originalItem=r.originalItem),r.originalItem=a),D(s)||(o&&(o.oldValue=i.oldValue),i.oldValue=s))},t.prototype.gWa=function(t){var e=this.Ap,n=t.row,o=t.col;t.isEmptyRow&&e?delete e[n]:t.isEmptyCol&&e[n]?delete e[n][o]:(t.hasOwnProperty("originalItem")&&(D(t.originalItem)&&!D(e[n].originalItem)?delete e[n].originalItem:e[n].originalItem=t.originalItem),t.hasOwnProperty("oldValue")&&(D(t.oldValue)&&!D(e[n][o].oldValue)?delete e[n][o].oldValue:e[n][o].oldValue=t.oldValue))},t.prototype.getValue=function(t,e,n){var o=this.RTa(t,e);return o&&!D(o.value)?1!==n?O(o.value):D(o.value.richText)?o.value:m(!0,{},o.value):v},t.prototype.setValue=function(t,e,n,o,r){var i,a=this.RTa(t,e,!0,o?o[0]:C);!a||D(a.value)&&D(n)||a.value===n?o&&(o.length=0):(i=a.value,a.value=n,this.Cp(t,e,{Ep:i},r),o&&(o[0].push("value"),o[1]=i))},t.prototype.getStyle=function(t,e,n){var o=this.RTa(t,e),r=o&&o.style;return r&&n&&r.clone&&(r=r.clone(!0)),r},t.prototype.setStyle=function(t,e,n,o){var r,i=this.RTa(t,e,!0,o?o[0]:C);i&&i.style!==n?(r=i.style,i.style=n,o&&(o[0].push("style"),o[1]=r)):o&&(o.length=0)},t.prototype.getCellState=function(t,e){var n=this.RTa(t,e);return n?n.cellState:v},t.prototype.setCellState=function(t,e,n,o){var r,i,a=this.getCellState(t,e)||0;0!==(r=o?a|n:a&~n)?(i=this.RTa(t,e,!0,C,!0))&&(i.cellState=r):((i=this.RTa(t,e))&&delete i.cellState,g(i)&&(At(this.dataTable,t,e),g(this.dataTable[t])&&delete this.dataTable[t]))},t.prototype.getValueForKey=function(t,e,n){var o=this.RTa(t,e);return o&&o[n]},t.prototype.setValueForKey=function(t,e,n,o,r){var i,a=this.RTa(t,e,!0,r?r[0]:C);a&&a[n]!==o?(i=a[n],a[n]=o,r&&(r[0].push(n),r[1]=i)):r&&(r.length=0)},t.prototype.NTa=function(t,e,n){var o,r=this,i=r.Xj,a=r.dataTable,s=r.Ap;if(0<=t&&t<=i&&e>=0&&(N(a,i,t,e),N(r.rowDataArray,i,t,e),N(s,i,t,e),r.Xj+=e,!n))for(o=0;o<e;o++)a[t+o]={rs:"n"},s[t+o]={rs:"n"}},t.prototype.STa=function(t,e,n){var o,r,i=this,a=i.Xj;if(0<=t&&t<a&&e>0){if(t+e>a&&(e=a-t),n)for(o=0;o<e;o++)r=t+o,n.push([["dataTable",r],i.dataTable[r]]),n.push([["rowDataArray",r],i.rowDataArray[r]]),n.push([[A,r],i.Ap[r]]);E(i.dataTable,a,t,e),E(i.rowDataArray,a,t,e),E(i.Ap,a,t,e),i.Xj-=e}},t.prototype.OTa=function(t,e){var n,o,r=this,i=r.OZ;if(0<=t&&t<=i&&e>=0){for(n=0;n<r.Xj;n++)(o=r.dataTable[n])&&t<i&&N(o,i,t,e);N(r.columnDataArray,i,t,e),r.OZ+=e}},t.prototype.TTa=function(t,e,n){var o,r,i,a,s,l,u=this,c=u.OZ;if(0<=t&&t<c&&e>0){for(o=0;o<u.Xj;o++)if(r=u.dataTable[o]){if(n)for(i=0;i<e;i++)a=t+i,n.push([["dataTable",o,a],r[a]]);E(r,c,t,e)}if(n)for(s=0;s<e;s++)l=t+s,n.push([["columnDataArray",l],u.columnDataArray[l]]);E(u.columnDataArray,c,t,e),t+e>c&&(e=c-t),u.OZ-=e}},t.prototype.RTa=function(t,e,n,o,r){var i,a=this,s=a.dataTable,l=a.columnDataArray,u=a.rowDataArray,c=v;return t<a.Xj&&e<a.OZ&&(t>=0&&e>=0?(i=s[t],n&&(i||(i=s[t]={}),!r&&t>a.Ef&&(a.Ef=t)),i&&(c=i[e],n&&(c||(c=i[e]={}),!r&&a.Ff<e&&(a.Ff=e))),o&&o.push("dataTable",t,e)):-1===t&&e>=0?(c=l[e],n&&(c||(c=l[e]={}),!r&&a.Ff<e&&(a.Ff=e)),o&&o.push("columnDataArray",e)):t>=0&&-1===e?(c=u[t],n&&(c||(c=u[t]={}),!r&&a.Ef<t&&(a.Ef=t)),o&&o.push("rowDataArray",t)):-1===t&&-1===e&&(c=a.defaultDataNode,n&&!c&&(c=a.defaultDataNode={}),o&&o.push("defaultDataNode"))),c},t.prototype.setNode=function(t,e,n){var o,r=this,i=r.dataTable,a=r.columnDataArray,s=r.rowDataArray;t<r.Xj&&e<r.OZ&&(t>=0&&e>=0?((o=i[t])||(o=i[t]={}),o[e]=n):-1===t&&e>=0?a[e]=n:-1===e&&t>=0&&(s[t]=n))},t.prototype._f=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y;r&&(i=[],a=[]),l=(s=this).dataTable,u=s.rowDataArray,c=s.columnDataArray,f=s.Ap,h=s.RTa(t,e,C,i),p=f[t]&&f[t][e],d=f[t]&&f[t].originalItem,g=s.RTa(n,o,C,a),m=f[n]&&f[n][o],y=f[n]&&f[n].originalItem,r&&(r.push([i,h]),r.push([a,g])),h?ft(t,e,n,o,h,l,u,c):g&&ft(t,e,n,o,v,l,u,c),g?ft(n,o,t,e,g,l,u,c):h&&ft(n,o,t,e,v,l,u,c),p?ht(0,0,n,o,p,f,d):m&&ht(0,0,n,o,v,f,d),m?ht(0,0,t,e,m,f,y):p&&ht(0,0,t,e,v,f,y)},t.prototype.Yea=function(t){t++;for(var e=this.Xj,n=this.dataTable;t>=0&&t<e&&!n[t];)t++;return t<e?t:-1},t.prototype.Hl=function(t,e){var n=this,o=v,r=n.OZ;if(t>=0&&t<n.Xj&&(o=n.dataTable[t]),o){for(e++;e>=0&&e<r&&!o[e];)e++;if(e<r)return e}return-1},t.prototype.yIb=function(t){var e,n,o,r,i,a=t.row,s=t.col,l=t.rowCount,u=t.colCount;for(e=a,n=0;n<l;n++,e++)for(o=s,r=0;r<u;r++,o++)(i=this.RTa(e,o))&&(i.value=v)},t.prototype._Sb=function(t,e,n){var o=n&&n.getFormatter(t,e);return!!F(o)&&o},t.prototype.clear=function(t,e,n,o,r,a,s){var l,u,c,f,h,p,d,g=this,m=g.Xj,y=g.OZ,b=[],T=!!s,x=[];if(t>=0&&e>=0){if(n=w(n,m-t),o=w(o,y-e),n>0&&o>0)for(c=t;c<t+n;c++)if(!a||i.Common.k.Cb(a,c)<0)for(u=e;u<e+o;u++)T&&(f=[]),(l=g.RTa(c,u,C,f))&&(b.push(l),T&&x.push(f),(1&r)>0&&!D(l.value)&&(h=void 0,T&&(h={}),g.Cp(c,u,{Ep:l.value},h),h&&s.push(h)))}else if(t>=0&&-1===e){if((n=w(n,m-t))>0)for(c=t;c<t+n;c++)T&&(f=[]),(l=g.RTa(c,-1,C,f))&&(b.push(l),T&&x.push(f))}else if(-1===t&&e>=0){if((o=w(o,y-e))>0)for(u=e;u<e+o;u++)T&&(f=[]),(l=g.RTa(-1,u,C,f))&&(b.push(l),T&&x.push(f))}else-1===t&&-1===e&&(T&&(f=[]),(l=g.RTa(-1,-1,C,f))&&(b.push(l),T&&x.push(f)));for(p=function(t){if(l=b[t]){var e=T?[]:C;(8&r)>0&&(e&&e.push(["tag",l.tag]),l.tag=v),(2&r)>0&&(e&&e.push(["style",l.style]),l.style=v),(1&r)>0&&(e&&e.push(["value",l.value]),l.value=v),(16&r)>0&&(e&&e.push(["sparkline",l.sparkline]),l.sparkline=v),(64&r)>0&&(e&&e.push(["bindingPath",l.bindingPath]),l.bindingPath=v),(256&r)>0&&(e&&e.push(["hyperlink",l.hyperlink]),l.hyperlink=v),(4&r)>0&&(e&&e.push(["comment",l.comment]),l.comment=v),T&&e.forEach((function(e){var n=[].concat(x[t]);n.push(e[0]),e[0]=n,s.push(e)}))}},d=0;d<b.length;d++)p(d)},t.prototype.toJSON=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d,m,y,b,w,T,x,S,A,I,R,k,M=n&&n.parent&&!g(n.parent.QHb);function N(t,o,r,i,a,s){var l,u,c,f,h,p,d,g,m;return r?(l={},u=r.value,D(u)||(l.value=u),e&&e.saveAsView&&(c=void 0,s?c=s:M&&(c=n&&n.getFormatter(t,o)),F(c)&&(f=n.aHb(t,o,c,u),D(f)||(l.value=f))),e&&e.ignoreStyle||("string"==typeof(h=r.style)?l.style=h:h&&((p=h.toJSON(i,a))&&(p.name=C,l.style=p))),d=r.bindingPath,D(d)||(l.bindingPath=d),g=r.tag,D(g)||(l.tag=g),m=r.hyperlink,D(m)||(l.hyperlink=P(m)),l):v}if(r={},i={},a=(o=this).Xj,s=o.OZ,l=o.dataTable,u=o.rowDataArray,c=o.columnDataArray,e&&e.saveAsView)for(p=0;p<a;){for(d={},m=!1,y=l[p],b=0;b<s;)w={},y&&y[b]||c[b]?w=N(p,b,o.RTa(p,b,!0)):3===t&&M&&((T=this._Sb(p,b,n))&&(w=N(p,b,o.RTa(p,b,!0),3,!1,T))),g(w)||(d[b]=w,m=!0),b++;m&&(i[p]=d),p++}else for(f=o.Yea(-1);f>=0;){for(d={},m=!1,h=o.Hl(f,-1);h>=0;)(x=o.RTa(f,h))&&(w=N(f,h,x),g(w)||(d[h]=w,m=!0)),h=o.Hl(f,h);m&&(i[f]=d),f=o.Yea(f)}for(g(i)||(r.dataTable=i),S=[],f=0;f<a;f++)tt(u,f)&&u[f]&&(A=N(f,-1,u[f]),g(A)||(S[f]=A));for(S.length>0&&(r.rowDataArray=S),I=[],h=0;h<s;h++)tt(c,h)&&c[h]&&(R=N(-1,h,c[h]),g(R)||(I[h]=R));return I.length>0&&(r.columnDataArray=I),k=N(-1,-1,o.defaultDataNode,t,!0),g(k)||(r.defaultDataNode=k),r},t.prototype.fromJSON=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d=n&&n.incrementalLoading;if(t){if((i=this).ad(),i.gga++,a=t.dataTable,u=i.Xj,c=i.OZ,a?d&&3===o?ct(i,a,u,c,n,e,C,r):function(t,e,n,o,r,i){var a,s,l,u;for(a=0;a<n;a++)if(s=e[a])for(l=0;l<o;l++)(u=s[l])&&pt(u,t.RTa(a,l,!0),i,a,l,r)}(i,a,u,c,n,e):d&&r&&setTimeout(r,0),f=t.rowDataArray||t.Hf)for(s=0;s<u;s++)tt(f,s)&&f[s]&&pt(f[s],i.RTa(s,-1,!0),e,s,-1,n);if(h=t.columnDataArray||t.If)for(l=0;l<c;l++)tt(h,l)&&h[l]&&pt(h[l],i.RTa(-1,l,!0),e,-1,l,n);(p=t.defaultDataNode||t.Jf)&&pt(p,i.RTa(-1,-1,!0),e,-1,-1,n),i.gga--}else d&&r&&setTimeout(r,0)},t}(),Y=function(){function t(){this.infos=[]}return t.prototype.uL=function(t,e){var n=this.infos,o=n.length;0<=t&&t<=o&&e>0&&N(n,o,t,e)},t.prototype.UTa=function(t,e,n){var o,r,i=this.infos,a=i.length;if(0<=t&&t<a&&e>0){if(e=w(e,a-t),n)for(o=0;o<e;o++)r=t+o,n.push([["infos",r],i[r]]);E(i,a,t,e)}},t.prototype.VTa=function(){return this.infos.length},t.prototype.Hp=function(){return this.infos},t.prototype.Jp=function(t){return this.infos[t]},t.prototype.Kp=function(t,e,n){var o=this.infos[t];this.infos[t]=e,n&&(n[0].push("infos",t),n[1]=o)},t.prototype.getSize=function(t){var e=this.infos[t],n=v;return e&&(!1===e.visible?n=0:"number"==typeof e.size&&(n=T(e.size))),n},t.prototype.getActualSize=function(t){var e=this.infos[t];return e?T(e.size):v},t.prototype.setSize=function(t,e,n){var o,r=this.infos,i=r[t];i||(i=r[t]={}),(o=i.size)!==e&&(i.size=e),n&&(n[0].push("infos",t,"size"),n[1]=o)},t.prototype.getStarSize=function(t){var e=this.infos[t];return e?e.starSize:C},t.prototype.setStarSize=function(t,e,n){var o,r=this.infos,i=this.infos[t];i||(i=r[t]={}),o=i.starSize,D(e)&&D(o)||(o!==e&&(D(e)?delete i.starSize:i.starSize=e),n&&(n[0].push("infos",t,"starSize"),n[1]=o))},t.prototype.toJSON=function(t){var e,n,o,r,i,a,s,u,c=this.infos,f=[];if(t&&t.ignoreStarSize)for(e=0;e<c.length;e++)D(c[e])||(o=(n=c[e]).cellType,r=$(n,["cellType"]),f[e]=P(r),o&&(o.toJSON&&(o=o.toJSON()),i=h._o,a=o.typeName,(s=i[o.type]||i[a]||l.getTypeFromString(a))&&((u=new s).fromJSON(o,t),f[e].cellType=u)),delete f[e].starSize);else for(e=0;e<c.length;e++)D(c[e])||(f[e]=c[e]);return f.length>0?f:C},t.prototype.fromJSON=function(t){t&&(this.infos=t)},t}(),X=Y.prototype,d({visible:!0,resizable:!0,pageBreak:!1},(function(t,e){var n=t[0].toUpperCase()+t.substr(1);X["get"+n]=function(n){var o=e,r=this.infos[n];return r&&!D(r[t])&&(o=r[t]),o},X["set"+n]=function(e,n,o){var r,i=this.infos,a=i[e];a||(a=i[e]={}),(r=a[t])!==n&&(a[t]=n),o&&(o[0].push("infos",e,t),o[1]=r)}})),Z=function(){function t(t){this.modelManager=t,this.anchors={},this.cells={},this.invalidAnchors={}}return t.prototype.no=function(){this.modelManager=v},t.prototype.getAnchorCell=function(t,e){return xt(this.anchors,t,e)},t.prototype.getAnchorItem=function(t,e){return xt(this.cells,t,e)},t.prototype.getAnchorInfo=function(t,e,n){var o,r,i,a,s=this,l=s.anchors,u=s.getAnchorCell(t,e);if(u)return u;if(o=s.getAnchorItem(t,e))for(i in r=o.anchorRefs)if(r[i]&&(a=St(l,i),n||a.isValid))return a},t.prototype.isCellHasItsOwnValue=function(t,e,n){var o,r,i,a,s=this.getAnchorItem(t,e);if(s){if(!D(s.value)||s.AIb)return!0;for(i in o=s.anchorRefs,r=this.anchors,o)if(n!==i&&o[i]&&((a=St(r,i))&&a.isValid))return!0}return!1},t.prototype.removeRef=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d,m,y,C=this.cells,b=e.isValid,w=e.row,T=e.col,x=e.rowCount,S=e.colCount,A=1;for(a=0,s=w;a<x;a++,s++){for(l=T+A;A<S;A++,l++){if(c=(u=xt(C,s,l))&&u.anchorRefs,f=!0,b){if(h=t.getValue(s,l),p=u&&u.value,D(p)){if(m=!(d=u&&u.AIb)||d===n,c)for(y in c)if(y!==n&&c[y]){f=!1;break}m?vt(o,s,l,v,h,e.row===s&&e.col===l):p=h}r&&yt(r,s,l,p)}c&&(delete c[n],f&&i&&g(c)&&At(C,s,l,!0))}A=0}},t.prototype.BIb=function(t,e,n,o,r){var i,a,l,u=t.getRowCount(),c=t.getColumnCount();return!(e+o>u||n+r>c||o*r>5e5||(i=t.getSheet(),a=s.kf(e,n,o,r),i.ITa.getSpans(a).length||(l=i.tables,l&&l.rn&&l.rn(e,n,o,r))))},t.prototype.setArray=function(t,e,n,o,r,i){var s,l,u,c,f,h,d,g,m,y,C,b,w,T,x,S,A,I,R=this,k=bt(e,n),M=R.anchors,N=xt(M,e,n),E=R.cells;if(N&&!i)return[N,(s=R.updateItem(t,e,n))[0],s[1]];if(l={},u={},c=!1,N&&N.isValid&&(c=!0,R.removeRef(t,N,k,l,u,!0)),f=N,mt(M,e,n,N={row:e,col:n,rowCount:o,colCount:r,values:i,isValid:!1}),h=t.getCalcService().CIb,N.CIb=h,d=f&&f.CIb===h&&(o!==f.rowCount||r!==f.colCount),(g=t.q$a)&&xt(R.invalidAnchors,e,n))vt(l,e,n,p&&a.Errors.Spill,v,N.row===e&&N.col===n),R.DIb(e,n,o,r,E,g,u,t,k,!0);else if(i){if(m=Ct(u,e,n,t),(y=!d&&R.BIb(t,e,n,o,r))&&(R.DIb(e,n,o,r,E,g,u,t,k),!g))for(C=1,b=0,w=e;b<o;b++,w++){for(T=n+C;C<r;C++,T++)if(x=Ct(u,w,T,t),!D(x)&&R.isCellHasItsOwnValue(w,T,k)){if(y=!1,!c)break;mt(l,w,T,x,!0)}if(!c&&!y)break;C=0}if(y)for(b=0,w=e;b<o;b++,w++)for(S=i[b],C=0,T=n;C<r;C++,T++)x=Ct(u,w,T,t),I=A=S[C],D(A)?I=0:p&&(a.Convert.Ca(A)||a.Convert.Fh(A))&&(I=1===A.getRowCount()&&1===A.getColumnCount()?a.Convert.Ca(A)?A.getValue(0,0):A.getValue(0,0,0):a.Errors.Calc),vt(l,w,T,I,x,N.row===w&&N.col===T),(b||C)&&(xt(E,w,T).AIb=k);else vt(l,e,n,p&&a.Errors.Spill,m,N.row===e&&N.col===n);N.isValid=y,f&&y!==f.isValid&&R.modelManager.EIb(e,n,!y)}return[N,l,[f]]},t.prototype.DIb=function(t,e,n,o,r,i,a,s,l,u){var c,f,h,p,d=1;for(c=0;c<n;c++){for(f=t+c;d<o;d++)h=e+d,(p=!u&&xt(r,f,h))||(p={anchorRefs:{}},i&&!u||(p.value=Ct(a,f,h,s)),mt(r,f,h,p)),p.anchorRefs[l]=!0;d=0}},t.prototype.updateItem=function(t,e,n,o,r,i){var a,s,l,u,c,f,h;if(void 0===r&&(r={}),void 0===i&&(i=[]),a=bt(e,n),(u=xt(l=(s=this).anchors,e,n))&&(s.removeRef(t,u,a,r,C,!0),At(r,e,n),At(l,e,n,!0)),c=xt(s.cells,e,n))for(h in s.modelManager.FIb(e,n,c.value),c.value=o,delete c.AIb,f=c.anchorRefs)f[h]&&wt(i,St(l,h));if(u||c)return[u&&r,i]},t.prototype.GIb=function(t,e){mt(this.invalidAnchors,t,e,!0)},t.prototype.HIb=function(){this.invalidAnchors={}},t.prototype.IIb=function(t,e,n){var o,r,i,a,s,l,u,c=this,f=c.anchors,h=[];for(o in f)if(f.hasOwnProperty(o))for(s in i=(r=+o)>=e,a=f[o])a.hasOwnProperty(s)&&(l=+s,i||(i=(u=a[s])&&u.rowCount+r>=e),i&&h.push([r,l]));h.length&&h.forEach((function(e){c.updateItem(t,e[0],e[1],C)}))},t.prototype.NTa=function(t,e,n){this.IIb(t,e,n)},t.prototype.PTa=function(t,e,n){this.IIb(t,e,n)},t.prototype.JIb=function(t,e){var n,o,r,i,a,s,l,u=this,c=u.anchors,f=[];for(n in c)if(c.hasOwnProperty(n))for(i in o=+n,r=c[n])r.hasOwnProperty(i)&&((s=(a=+i)>=e)||(s=(l=r[i])&&l.colCount+a>=e),s&&f.push([o,a]));f.length&&f.forEach((function(e){u.updateItem(t,e[0],e[1],C)}))},t.prototype.OTa=function(t,e,n){this.JIb(t,e)},t.prototype.QTa=function(t,e,n){this.JIb(t,e)},t}(),e.KIb=Z,e.clearSpillValuesOnAddRemove=It,Q=function(){function t(e,n,o,r,i,a){var s,l,u,c;function f(t,e,n,o){s.WTa>0&&s.zTa.push([["defaults",n],o]),s.kj.$p()}this.LIb=[],(s=this).kj=e,s.sheetModels=[C,new q(r,o),new q(n,i),new q(n,o)],(l=s.rowInfos=[])[0]=l[1]=new Y,l[2]=l[3]=new Y,(u=s.colInfos=[])[0]=u[2]=new Y,u[1]=u[3]=new Y,s.spanModels=[C,new B,new B,new B],s.selectionModel=new z,s.ZHb=new Z(s),s.name=a||"",s.isSelected=!1,s.zoomFactor=1,ot(c=s.defaults={},"rowHeight",20,f),ot(c,"colWidth",62,f),ot(c,"rowHeaderColWidth",40,f),ot(c,"colHeaderRowHeight",20,f),ot(c,"_isExcelDefaultColumnWidth",!1,f),s.WTa=0,t.ao(this,"init"),s.Agc(n,o)}return t.prototype.Agc=function(t,e){this.zgc({type:c.AxisInfoChangeType.setRowCount,count:t}),this.zgc({type:c.AxisInfoChangeType.setColumnCount,count:e})},t.prototype.zgc=function(t){var e,n,o,r,i,a,s,l,u,f,h,p,d,g=this,m=g.kj,y=t.type,v=t.sheetArea;if((void 0===v?c.SheetArea.viewport:v)===c.SheetArea.viewport){if(D(g.Bgc)&&(g.Bgc=[]),D(g.Cgc)&&(g.Cgc=[]),g.Dgc)return void g.Egc(t);switch(e=g.Bgc,n=g.Cgc,y){case c.AxisInfoChangeType.setRowCount:if((i=(o=t.count)-(r=e.length))>0)for(a=Tt(M,i),s=0;s<a.length;s++)e.splice(r+s,0,a[s]);else e.length=o;break;case c.AxisInfoChangeType.setColumnCount:if((i=(o=t.count)-(r=n.length))>0)for(a=Tt(M,i),s=0;s<a.length;s++)n.splice(r+s,0,a[s]);else n.length=o;break;case c.AxisInfoChangeType.addRows:for(l=t.index,o=t.count,u=Tt(M,o),s=0;s<u.length;s++)e.splice(l+s,0,u[s]);break;case c.AxisInfoChangeType.deleteRows:l=t.index,o=t.count,e.splice(l,o);break;case c.AxisInfoChangeType.addColumns:for(l=t.index,o=t.count,u=Tt(M,o),s=0;s<u.length;s++)n.splice(l+s,0,u[s]);break;case c.AxisInfoChangeType.deleteColumns:l=t.index,o=t.count,n.splice(l,o);break;case c.AxisInfoChangeType.setRowHeight:case c.AxisInfoChangeType.setRowVisible:l=t.index,f=t.value,e[l]=f;break;case c.AxisInfoChangeType.setColumnWidth:case c.AxisInfoChangeType.setColumnVisible:l=t.index,f=t.value,n[l]=f;break;case c.AxisInfoChangeType.filterRows:for(p=0,d=h=t.index;p<d.length;p++)l=d[p],f=m.getRowHeight(l),e[l]=f;break;case c.AxisInfoChangeType.outlineExpandRows:for(h=t.index,s=0;s<h.length;s++)l=h[s],f=m.getRowHeight(l),e[l]=f;break;case c.AxisInfoChangeType.outlineExpandColumns:for(h=t.index,s=0;s<h.length;s++)l=h[s],f=m.getColumnWidth(l),n[l]=f}}},t.prototype.Fgc=function(t){if(this.Bgc){var e=this.Bgc[t];return e===M?this.defaults.rowHeight:e}},t.prototype.Ggc=function(t){if(this.Cgc){var e=this.Cgc[t];return e===M?this.defaults.colWidth:e}},t.prototype.wgc=function(){this.Dgc=[]},t.prototype.ygc=function(){var t,e,n,o=this,r=o.Dgc;if(o.Dgc=v,r)for(t=0,e=r;t<e.length;t++)n=e[t],o.zgc(n)},t.prototype.Egc=function(t){this.Dgc&&this.Dgc.push(t)},t.prototype.xgc=function(){this.Bgc=v,this.Cgc=v},t.prototype.no=function(e){if(!1!==e){var n=this;n.kj=v,n.sheetModels=v,n.ZHb&&(n.ZHb.no(),n.ZHb=v),n.xgc()}t.ao(this,"dispose",{clearCache:e})},t.prototype.addRows=function(e,n,o,r){var i,a=this;a.WTa>0&&(i={row:e,rowCount:n,type:"addRows"},a.zTa.push(i)),a.XTa(3).NTa(e,n,r),a.XTa(2).NTa(e,n,r),a.zl(3).NTa(e,n),a.zl(2).NTa(e,n),a.YTa(!0,3).uL(e,n),p&&a.ZHb.NTa(a.kj.yj(),e,n),o||t.ao(a,"addRows",{row:e,rowCount:n,changes:a.zTa}),a.zgc({type:c.AxisInfoChangeType.addRows,index:e,count:n})},t.prototype.ZTa=function(e){var n=this,o=e.row,r=e.rowCount;It(n,o,0,0,!0),n.deleteRows(o,r,!0),t.ao(n,"undoAddRows",{row:o,rowCount:r})},t.prototype.deleteRows=function(e,n,o){var r,i,a,s,l,u,f,h,d,g=this;if(g.WTa>0&&(i=[],a=[],s=[["spanModels",3],C],l=[["spanModels",2],C],u=[],r={row:e,rowCount:n,type:"deleteRows"},g.zTa.push(r)),g.XTa(3).STa(e,n,i),g.XTa(2).STa(e,n,a),g.zl(3).PTa(e,n,s),g.zl(2).PTa(e,n,l),g.YTa(!0,3).UTa(e,n,u),p&&g.ZHb.PTa(g.kj.yj(),e,n),o||t.ao(g,"deleteRows",{row:e,rowCount:n,changes:g.zTa}),r){for(f=r.changes=[],h=["sheetModels",3],d=0;d<i.length;d++)i[d][0]=h.concat(i[d][0]),f.push(i[d]);for(h=["sheetModels",2],d=0;d<a.length;d++)a[d][0]=h.concat(a[d][0]),f.push(a[d]);for(s.length>0&&f.push(s),l.length>0&&f.push(l),h=[R,3],d=0;d<u.length;d++)u[d][0]=h.concat(u[d][0]),f.push(u[d])}g.zgc({type:c.AxisInfoChangeType.deleteRows,index:e,count:n})},t.prototype.$Ta=function(t){var e,n,o,r=this,i=t.row,a=t.rowCount;for(It(r,i,0,0,!0),r.addRows(i,a,!0,!0),n=(e=t.changes).length-1;n>=0;n--)dt(r,e[n]);(o=r.kj&&r.kj.Ts)&&o.splice(o.length-a,a)},t.prototype.addColumns=function(e,n,o){var r,i=this;i.WTa>0&&(r={col:e,colCount:n,type:"addColumns"},i.zTa.push(r)),i.XTa(3).OTa(e,n),i.XTa(1).OTa(e,n),i.zl(3).OTa(e,n),i.zl(1).OTa(e,n),i.YTa(!1,3).uL(e,n),p&&i.ZHb.OTa(i.kj.yj(),e,n),o||t.ao(i,"addColumns",{col:e,colCount:n,changes:i.zTa}),i.zgc({type:c.AxisInfoChangeType.addColumns,index:e,count:n})},t.prototype._Ta=function(t){var e=t.col,n=t.colCount;It(this,e,0,0,!1),this.deleteColumns(e,n,!0)},t.prototype.deleteColumns=function(e,n,o){var r,i,a,s,l,u,f,h,d,g=this;if(g.WTa>0&&(i=[],a=[],s=[["spanModels",3],C],l=[["spanModels",1],C],u=[],r={col:e,colCount:n,type:"deleteColumns"},g.zTa.push(r)),g.XTa(3).TTa(e,n,i),g.XTa(1).TTa(e,n,a),g.zl(3).QTa(e,n,s),g.zl(1).QTa(e,n,l),g.YTa(!1,3).UTa(e,n,u),p&&g.ZHb.QTa(g.kj.yj(),e,n),o||t.ao(g,"deleteColumns",{col:e,colCount:n,changes:g.zTa}),r){for(f=r.changes=[],h=["sheetModels",3],d=0;d<i.length;d++)i[d][0]=h.concat(i[d][0]),f.push(i[d]);for(h=["sheetModels",1],d=0;d<a.length;d++)a[d][0]=h.concat(a[d][0]),f.push(a[d]);for(s.length>0&&f.push(s),l.length>0&&f.push(l),h=[k,3],d=0;d<u.length;d++)u[d][0]=h.concat(u[d][0]),f.push(u[d])}g.zgc({type:c.AxisInfoChangeType.deleteColumns,index:e,count:n})},t.prototype.aUa=function(t){var e,n,o=this,r=t.col,i=t.colCount;for(It(o,r,0,0,!1),o.addColumns(r,i,!0),n=(e=t.changes).length-1;n>=0;n--)dt(o,e[n])},t.prototype.getRowCount=function(t){return this.XTa(t).getRowCount()},t.prototype.setRowCount=function(t,e,n){var o=this,r=o.getRowCount(e);o.WTa>0&&o.zTa.push({oldRowCount:r,sheetArea:e,type:"setRowCount"}),3===e||2===e?(r>t&&o.deleteRows(t,r-t,n),o.XTa(3).setRowCount(t),o.XTa(2).setRowCount(t)):1===e&&(r>t&&o.YTa(!0,e).UTa(t,r-t),o.XTa(e).setRowCount(t)),o.zgc({type:c.AxisInfoChangeType.setRowCount,count:t,sheetArea:e})},t.prototype.bUa=function(t){this.setRowCount(t.oldRowCount,t.sheetArea,!0)},t.prototype.getColumnCount=function(t){return this.XTa(t).getColumnCount()},t.prototype.setColumnCount=function(t,e,n){var o=this,r=o.getColumnCount(e);o.WTa>0&&o.zTa.push({oldColCount:r,sheetArea:e,type:"setColumnCount"}),3===e||1===e?(r>t&&o.deleteColumns(t,r-t,n),o.XTa(3).setColumnCount(t),o.XTa(1).setColumnCount(t)):2===e&&(r>t&&o.YTa(!1,e).UTa(t,r-t),o.XTa(e).setColumnCount(t)),o.zgc({type:c.AxisInfoChangeType.setColumnCount,count:t,sheetArea:e})},t.prototype.cUa=function(t){this.setColumnCount(t.oldColCount,t.sheetArea,!0)},t.prototype.getLastNonNullRow=function(t,e){var n=e?0:this.YTa(!0,t).VTa()-1;return x(this.XTa(t).Ef,this.zl(t).Ef,n)},t.prototype.getLastNonNullCol=function(t,e){var n=e?0:this.YTa(!1,t).VTa()-1;return x(this.XTa(t).Ff,this.zl(t).Ff,n)},t.prototype.$Gb=function(){var t=this,e=t.kj,n=0!==e.Dr().height&&t._Gb(!0,e.defaults.rowHeight),o=0!==e.Dr().width&&t._Gb(!1,e.defaults.colWidth);function r(t,n){var o,r,i,a,s=n.length;for(o=0;o<s;o++)r=n[o][0],i=n[o][1],(a=n[o][2])!==i&&(t?e.kq(r,3,"height",i,a):e.pq(r,3,"width",i,a))}n&&r(!0,n),o&&r(!1,o)},t.prototype._Gb=function(t,e){var n,o,r,i,a,s,l,u,f,h,p,d,g,m,v,C,b,w,x=this,A=x.kj,I=[],R=A.zoom(),k=t?A.getRowCount():A.getColumnCount(),M=x.YTa(t,3),N=0,E=0;if(A.Gt&&(E=t?A.Gt().height:A.Gt().width),t){if(A.options.colHeaderVisible)for(o=0;o<A.getRowCount(1);o++)N+=S(R*A.getRowHeight(o,1));n=A.Dr().height-A.options.sheetAreaOffset.top-E-N}else{if(A.options.rowHeaderVisible)for(o=0;o<A.getColumnCount(2);o++)N+=S(R*A.getColumnWidth(o,2));n=A.Dr().width-A.options.sheetAreaOffset.left-E-N}for(r=[],i=[],a=[],s=0,l=t?A.getRowVisible:A.getColumnVisible,o=0;o<k;o++)if(u=l.call(A,o),f=A.ITa.getSize(t,3,o),h=A.ITa.getStarSize(t,3,o),y.test(h))p="*"===h?1:parseFloat(h.replace("*","")),u&&p>0?(s+=p,r.push(o),i.push(p),a.push(f)):I.push([o,0,f]);else if(f="number"==typeof f?Math.floor(f):e,u&&(n-=S(R*f))<1)return;if(!(s+I.length===0||n<1)){for(d=r.length,o=0;o<d-1;o++)if(g=n/s/R,p=i[o],f=T(g*p),m=S(R*f),I.push([r[o],f,a[o]]),n-=m,s-=p,m<1||n<1)return;for(v=S((n-1e-4)/R),I.push([r[d-1],v,a[d-1]]),o=0;o<I.length;o++)C=I[o][0],b=I[o][1],M.setSize(C,b),w=t?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,x.zgc({type:w,index:C});return I}},t.prototype.setCellState=function(t,e,n,o,r){var i=this.XTa(r);i&&i.setCellState(t,e,n,o)},t.prototype.toJSON=function(t){var e,n,o,r=this,i={};return i.data=r.XTa(3).toJSON(3,t,r.kj),i.rowHeaderData=r.XTa(2).toJSON(2,t),i.colHeaderData=r.XTa(1).toJSON(1,t),i.rows=r.YTa(!0,3).toJSON(t),i.columns=r.YTa(!1,3).toJSON(t),i.rowHeaderColInfos=r.YTa(!1,2).toJSON(t),i.colHeaderRowInfos=r.YTa(!0,1).toJSON(t),e=r.kj,i.leftCellIndex=e.getViewportLeftColumn(1),i.topCellIndex=e.getViewportTopRow(1),t&&t.ignoreStyle||(i.spans=Rt(r.zl(3).toJSON()),i.rowHeaderSpan=Rt(r.zl(2).toJSON()),i.colHeaderSpan=Rt(r.zl(1).toJSON())),i.selections=r.selectionModel.toJSON(),i.tag=r.getValueForKey(-1,-1,"tag",3),20===(o={colHeaderRowHeight:(n=r.defaults).colHeaderRowHeight,colWidth:n.colWidth,rowHeaderColWidth:n.rowHeaderColWidth,rowHeight:n.rowHeight,_isExcelDefaultColumnWidth:n._isExcelDefaultColumnWidth}).rowHeight&&62===o.colWidth&&40===o.rowHeaderColWidth&&20===o.colHeaderRowHeight||(i.defaults=o),i},t.prototype.fromJSON=function(t,e,n,o){var r,i,a,s,u,f,h,p,d,g,m,y=this;if(y.XTa(3).fromJSON(t.data,e,n,3,o),y.XTa(2).fromJSON(t.rowHeaderData,e,n),y.XTa(1).fromJSON(t.colHeaderData,e,n),y.kj.showCell(t.topCellIndex||0,t.leftCellIndex||0,c.VerticalPosition.top,c.HorizontalPosition.left),y.YTa(!0,3).fromJSON(t.rows),y.YTa(!1,3).fromJSON(t.columns),y.YTa(!1,2).fromJSON(t.rowHeaderColInfos),y.YTa(!0,1).fromJSON(t.colHeaderRowInfos),t&&t.rows)for(r=0,i=Object.keys(t.rows);r<i.length;r++)a=i[r],s=t.rows[a],D(s)||y.zgc({type:c.AxisInfoChangeType.setRowHeight,index:+a});if(t&&t.columns)for(u=0,f=Object.keys(t.columns);u<f.length;u++)a=f[u],s=t.columns[a],D(s)||y.zgc({type:c.AxisInfoChangeType.setColumnWidth,index:+a});n&&n.ignoreStyle||(y.zl(3).fromJSON(t.spans),y.zl(2).fromJSON(t.rowHeaderSpan),y.zl(1).fromJSON(t.colHeaderSpan)),y.selectionModel.fromJSON(t.selections),(h=t.tag)!==C&&(typeof(p=h.typeName)===b&&((d=l.getTypeFromString(p))&&((h=new d).fromJSON&&h.fromJSON(t.tag))),y.do("setValueForKey",-1,-1,"tag",h,3)),(g=t.defaults)!==C&&((m=y.defaults).colHeaderRowHeight=K(g.colHeaderRowHeight,20),m.colWidth=K(g.colWidth,62),m.rowHeaderColWidth=K(g.rowHeaderColWidth,40),m.rowHeight=K(g.rowHeight,20),m._isExcelDefaultColumnWidth=g._isExcelDefaultColumnWidth)},t.prototype.startTransaction=function(){0===this.WTa&&(this.zTa=[],!this.kj.isEventSuspended()&&(this.zTa.events=[]),t.ao(this,"startTransaction"));this.WTa++},t.prototype.endTransaction=function(){var e,n;return this.WTa--,0===this.WTa?(t.ao(this,"endTransaction"),e=this.zTa,this.zTa=C,(n=e.events)&&0===n.length&&delete e.events,e):[]},t.prototype.dUa=function(){var t=this.zTa;if(t)return t.calc||(t.calc=[]),t.calc},t.prototype.EIb=function(t,e,n){var o=this.zTa;o&&o.push({type:"setIsValid",value:[t,e,n]})},t.prototype.FIb=function(t,e,n){var o=this.zTa;o&&o.push({type:"dirtyItem",value:[t,e,n]})},t.prototype.MIb=function(t){var e,n,o=t.value;o&&((e=this.ZHb.getAnchorCell(o[0],o[1]))&&(n=o[2],e.isValid=n))},t.prototype.NIb=function(t){var e,n,o,r,i=t.value;i&&(e=i[0],n=i[1],o=i[2],(r=this.ZHb.getAnchorItem(e,n))&&(r.value=o))},t.prototype.undo=function(e){var n,o,r,i,a,s,l,u,c=[],f=e&&e.events;for(f&&this.YVa(f,!0),n=e.length-1;n>=0;n--)(r=(o=e[n]).type)?"addRows"===r?this.ZTa(o):"addColumns"===r?this._Ta(o):"deleteRows"===r?this.$Ta(o):"deleteColumns"===r?this.aUa(o):"setRowCount"===r?this.bUa(o):"setColumnCount"===r?this.cUa(o):"setZoomFactor"===r?this.fUa(o.value):"updateDirty"===r?(this.gWa(o),c.push(o)):"setName"===r?this.pZa(o.value):"sortRange"===r?this.yxb(o):"setIsValid"===r?this.MIb(o):"dirtyItem"===r&&this.NIb(o):dt(this,o);(i=this.kj).Oq={},i.Jq(),(a=c.length>0)&&((s=i.Wu)&&s.suspend(),c.forEach((function(t){i.eyb(t.row,t.col,3,!1)}))),(l=e&&e.uVa)&&l.length>0&&(t.ao(this,I,{uVa:l}),delete e.uVa),(u=e&&e.calc)&&u.length&&i.gUa(u),t.ao(this,I,e),a&&(s&&s.resume(!1),i.fyb()),f&&this.YVa(f,!1)},t.prototype.do=function(t){var e,n,o,r=[];for(e=1;e<arguments.length;e++)r[e-1]=arguments[e];n=this,t&&((o=n[t])&&o.apply(n,r))},t.prototype.XTa=function(t){return D(t)&&(t=3),this.sheetModels[t]},t.prototype.dWa=function(t,e,n){D(n)&&(n=3),this.sheetModels[n]=new q(t,e)},t.prototype.ZVa=function(t){var e=this.zTa,n=e&&e.events;n&&n.push(t)},t.prototype.YVa=function(t,e){var n,o,r,i,a=this.kj;for(a.OIb=!0,n=t.length-1;n>=0;n--)i=void 0,"cellChanged"!==(r=(o=t[n])[0])||e?"rowChanged"!==r||e?"columnChanged"!==r||e?"zoomChanged"!==r||e?"rowChanging"===r&&e?i=a.pCb:"columnChanging"===r&&e?i=a.qCb:"tableRowsChanged"!==r||e?"tableColumnsChanged"!==r||e?"rangeChanged"!==r||e||(i=a.RIb):i=a.QIb:i=a.PIb:i=a.gyb:i=a.pq:i=a.kq:i=a.Bq,i&&([].splice.call(t,n,1),i.apply(a,[].slice.call(o,1)));a.OIb=!1},t.prototype.getValue=function(e,n,o,r,i){if(D(o)&&(o=3),!r){var a={row:e,col:n,sheetArea:o,isValueGet:!1,value:C};if(t.ao(this,"getValue",a,(function(){return a.isValueGet})),a.isValueGet)return a.value}return this.XTa(o).getValue(e,n,i)},t.prototype.setValue=function(e,n,o,r,i,a,s){var l,u,c,f,h,d,g,m,y;D(r)&&(r=3),c=(u=this).kj,(f=!a&&!c.isEventSuspended())&&(l=c.getValue(e,n,r,1)),h=!1,p&&c.getCalcService().allowDynamicArray&&!u.SIb&&3===r&&(u.LIb.push(u.ZHb.updateItem(c.yj(),e,n,o)),h=!0),d=!1,i||(g={row:e,col:n,value:o,sheetArea:r,isValueSet:!1,changes:u.zTa},t.ao(u,"setValue",g,(function(){return g.isValueSet})),d=g.isValueSet),d||(m=void 0,y=void 0,u.WTa>0&&!s&&(m=[["sheetModels",r],C],y={sheetArea:r}),u.XTa(r).setValue(e,n,o,m,y),m&&m.length>0&&u.zTa.push(m),y&&y.type&&u.zTa.push(y),c.fyb()),f&&l!==o&&c.Bq("value",e,n,r,l,o),h&&u.applyDynamicChanges()},t.prototype.applyDynamicChanges=function(){var t,e,n,o,r,i=this,s=i.LIb,l=i.kj;if(!i.SIb&&s.length){for(i.SIb=!0,t=l.yj(),e=l.Bj(),n=0,o=s;n<o.length;n++)(r=o[n])&&(a.setSpillValues(r[0],t),a.markAnchorCellDirty(r[1],e,i.ZHb));s.length=0,i.SIb=!1}},t.prototype.getDynamicArrayInfo=function(t,e){return this.ZHb.getAnchorInfo(t,e)},t.prototype.getStyle=function(t,e,n){return this.XTa(n).getStyle(t,e,this.WTa>0)},t.prototype.setStyle=function(t,e,n,o){D(o)&&(o=3);var r=this.WTa>0?[["sheetModels",o],C]:C;this.XTa(o).setStyle(t,e,n,r),r&&r.length>0&&this.zTa.push(r)},t.prototype.getValueForKey=function(t,e,n,o){return this.XTa(o).getValueForKey(t,e,n)},t.prototype.setValueForKey=function(t,e,n,o,r){D(r)&&(r=3);var i=this.WTa>0?[["sheetModels",r],C]:C;this.XTa(r).setValueForKey(t,e,n,o,i),i&&i.length>0&&this.zTa.push(i)},t.prototype.clear=function(e,n,o,r,i,a,s){var l,u,c,f,h,d,g,m,y,b,w,T,x,S;if(D(s)&&(s=3),l=this.WTa>0?[]:C,u=this,c=!1,p&&!u.SIb&&3===s){for(f=u.kj.yj(),h=u.LIb,d=u.ZHb,g={},m=[],y=0;y<o;y++)for(b=0;b<r;b++)d.updateItem(f,e+y,n+b,v,g,m);h.push([g,m]),c=!0}if(this.XTa(s).clear(e,n,o,r,i,a,l),t.ao(this,"clear",{row:e,col:n,rowCount:o,colCount:r,type:i,ignoredRowList:a,sheetArea:s,changes:this.zTa}),l)for(w=["sheetModels",s],T=0,x=l.length;T<x;T++)(S=l[T])[0]=w.concat(S[0]),this.zTa.push(S);c&&this.applyDynamicChanges()},t.prototype.swapNode=function(t,e,n,o,r){var i,a,s,l,u;if(D(r)&&(r=3),i=this.WTa>0?[]:C,this.XTa(r)._f(t,e,n,o,i),i)for(a=["sheetModels",r],s=0,l=i.length;s<l;s++)(u=i[s])[0]=a.concat(u[0]),this.zTa.push(u)},t.prototype.Cp=function(t,e,n,o){var r;this.WTa>0&&(r={sheetArea:o},D(o)&&(r.sheetArea=3)),this.XTa(o).Cp(t,e,n,r),r&&this.zTa.push(r)},t.prototype.gWa=function(t){this.XTa(t.sheetArea).gWa(t)},t.prototype.hUa=function(t){return this.XTa(t).Ap},t.prototype.iUa=function(t){this.XTa(t).Ap={}},t.prototype.Lec=function(t,e,n,o){var r,i,a,s=this.hUa();if(s)for(r in s)tt(s,r)&&(i=s[r],a=parseInt(r,10),i&&"n"===i.rs&&(t||e&&n<=a&&a<n+o)&&(s[r]={}))},t.prototype.Mec=function(e,n,o,r,i){var a,s,l,u,c,f,h=this.hUa(),p=this.kj,m=p.tables;if(!g(h)){if(a=[],n>=0)for(s=n;s<n+r;s++)a.push(s);else for(l in h)tt(h,l)&&a.push(parseInt(l,10));u=[],c=[],m&&(u=m.Nec(n,o,r,i),c=m.Oec(n,o,r,i),u.length>0&&t.ao(this,"clearPendingChanges",{tableList:u})),d(a,(function(t,n){var r,a,s;if((f=h[n])&&"e"===f.rs)if(r=c.length,e)if(m&&0!==r&&m.Pec(c,n,-1))for(a=p.getColumnCount(),s=0;s<a;s++)m&&0!==r&&m.Pec(c,n,s)||f[s]&&delete f[s];else h[n]={};else for(s=o;s<o+i;s++)m&&0!==r&&m.Pec(c,n,s)||f[s]&&delete f[s]}))}},t.prototype.Qec=function(){var t,e=this.hUa();for(t in e)tt(e,t)&&"e"===e[t].rs&&(e[t]={})},t.prototype.jUa=function(t){this.XTa(t).gga++},t.prototype.kUa=function(t){var e=this.XTa(t);e.gga--,e.gga<0&&(e.gga=0)},t.prototype.getName=function(){return this.name||""},t.prototype.setName=function(t){var e=this;e.WTa>0&&e.zTa.push({type:"setName",value:e.name}),e.name=t},t.prototype.TIb=function(){return this.isSelected},t.prototype.CHb=function(t){this.isSelected=t},t.prototype.pZa=function(t){this.kj.name(t)},t.prototype.yxb=function(t){var e,n=[];e=t.byRows?t.row:t.column,t.array.map((function(t,o){n[t-e]=o+e})),this.kj.sortRange(t.row,t.column,t.rowCount,t.columnCount,t.byRows,t.sortInfo,v,n)},t.prototype.getZoomFactor=function(){return this.zoomFactor},t.prototype.setZoomFactor=function(t){var e=this;e.WTa>0&&e.zTa.push({type:"setZoomFactor",value:e.zoomFactor}),e.zoomFactor=t},t.prototype.fUa=function(t){this.kj.zoom(t)},t.prototype.zl=function(t){return D(t)&&(t=3),this.spanModels[t]},t.prototype.eWa=function(t){D(t)&&(t=3),this.spanModels[t]=new B},t.prototype.getSpans=function(t,e,n){var o=this.zl(e).getSpans(t);return n&&(o=o.filter((function(t){return!t.isAutoMerge}))),o},t.prototype.getSpan=function(t,e,n){return this.zl(n).get(t,e)},t.prototype.uIb=function(t,e,n){var o,r;return D(n)&&(n=3),(o=this.XTa(n))&&o.RTa?(r=o.RTa(t,e))&&r.tipContent?r.tipContent:null:null},t.prototype.qHb=function(t,e,n,o){D(o)&&(o=3);var r=this.XTa(o).RTa(t,e);!n&&r?delete r.tipContent:n&&r?r.tipContent=n:n&&!r&&((r=this.XTa(o).RTa(t,e,!0)).tipContent=n)},t.prototype.MTa=function(t,e,n,o,r){return this.zl(r).MTa(t,e,n,o)},t.prototype.qu=function(t,e,n,o,r){return this.zl(r).qu(t,e,n,o)},t.prototype.findSpan=function(t,e,n){return this.zl(n).find(t,e)},t.prototype.removeSpan=function(t,e){D(e)&&(e=3);var n=this.WTa>0?[["spanModels",e],C]:C;this.zl(e).remove(t,n),n&&n.length>0&&this.zTa.push(n)},t.prototype.addSpan=function(t,e){D(e)&&(e=3);var n=this.WTa>0?[["spanModels",e],C]:C;this.zl(e).add(t,n),n&&n.length>0&&this.zTa.push(n)},t.prototype.clearSpan=function(t,e,n,o,r){D(r)&&(r=3);var i=this.WTa>0?[["spanModels",r],C]:C;this.zl(r).$b(t,e,n,o,i),i&&i.length>0&&this.zTa.push(i)},t.prototype.moveSpan=function(t,e,n,o,r,i,a){D(a)&&(a=3);var s=this.WTa>0?[["spanModels",a],C]:C;this.zl(a).aB(t,e,n,o,r,i,s),s&&s.length>0&&this.zTa.push(s)},t.prototype.copySpan=function(t,e,n,o,r,i,a){D(a)&&(a=3);var s=this.WTa>0?[["spanModels",a],C]:C;this.zl(a).Zz(t,e,n,o,r,i,s),s&&s.length>0&&this.zTa.push(s)},t.prototype.addSelection=function(t,e,n,o){var r,i,a=this.WTa>0?[]:C;if(this.selectionModel.add(t,e,n,o,a),a)for(r=0;r<a.length;r++)(i=a[r])[0]=["selectionModel"].concat(i[0]),this.zTa.push(i)},t.prototype.getSelections=function(){return this.selectionModel.get()},t.prototype.setSelections=function(t){var e,n,o=this.WTa>0?[]:C;if(this.selectionModel.set(t,o),o)for(e=0;e<o.length;e++)(n=o[e])[0]=["selectionModel"].concat(n[0]),this.zTa.push(n)},t.prototype.clearSelection=function(){var t,e,n=this.WTa>0?[]:C;if(this.selectionModel.clear(n),n)for(t=0;t<n.length;t++)(e=n[t])[0]=["selectionModel"].concat(e[0]),this.zTa.push(e)},t.prototype.getActiveSelectedRangeIndex=function(){return this.selectionModel.getProperty("activeSelectedRangeIndex")},t.prototype.setActiveSelectedRangeIndex=function(t){var e=this.WTa>0?[["selectionModel"],C]:C;this.selectionModel.setProperty("activeSelectedRangeIndex",t,e),e&&this.zTa.push(e)},t.prototype.getSelectionPolicy=function(){return this.selectionModel.getProperty("selectionPolicy")},t.prototype.setSelectionPolicy=function(t){gt(this,"selectionPolicy",t)},t.prototype.getSelectionUnit=function(){return this.selectionModel.getProperty("selectionUnit")},t.prototype.setSelectionUnit=function(t){gt(this,"selectionUnit",t)},t.prototype.sp=function(t){return this.selectionModel.sp(t)},t.prototype.tp=function(t){return this.selectionModel.tp(t)},t.prototype.vp=function(t,e,n,o,r,i){return this.selectionModel.vp(t,e,n,o,r,i)},t.prototype.wp=function(t,e,n,o,r){return this.selectionModel.wp(t,e,n,o,r)},t.prototype.YTa=function(t,e){return D(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]},t.prototype.fWa=function(t,e){D(e)&&(e=3),(t?this.rowInfos:this.colInfos)[e]=new Y},t.prototype.getPageBreak=function(t,e,n){return this.YTa(t,e).getPageBreak(n)},t.prototype.setPageBreak=function(t,e,n,o){var r;D(e)&&(e=3),r=this.WTa>0?[[t?R:k,e],C]:C,this.YTa(t,e).setPageBreak(n,o,r),r&&this.zTa.push(r)},t.prototype.getVisible=function(t,e,n){return this.YTa(t,e).getVisible(n)},t.prototype.setVisible=function(t,e,n,o){var r,i,a=this;D(e)&&(e=3),r=a.WTa>0?[[t?R:k,e],C]:C,a.YTa(t,e).setVisible(n,o,r),r&&a.zTa.push(r),i=t?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible,a.zgc({type:i,index:n,sheetArea:e})},t.prototype.getResizable=function(t,e,n){return this.YTa(t,e).getResizable(n)},t.prototype.setResizable=function(t,e,n,o){var r;D(e)&&(e=3),r=this.WTa>0?[[t?R:k,e],C]:C,this.YTa(t,e).setResizable(n,o,r),r&&this.zTa.push(r)},t.prototype.getSize=function(t,e,n){return this.YTa(t,e).getSize(n)},t.prototype.getStarSize=function(t,e,n){return this.YTa(t,e).getStarSize(n)},t.prototype.getActualSize=function(t,e,n){return this.YTa(t,e).getActualSize(n)},t.prototype.setSize=function(t,e,n,o){var r,i,a=this;D(e)&&(e=3),r=a.WTa>0?[[t?R:k,e],C]:C,a.YTa(t,e).setSize(n,o,r),r&&a.zTa.push(r),a.setStarSize(t,e,n,v),i=t?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,a.zgc({type:i,index:n,value:o,sheetArea:e})},t.prototype.setStarSize=function(t,e,n,o){var r;D(e)&&(e=3),r=this.WTa>0?[[t?R:k,e],C]:C,this.YTa(t,e).setStarSize(n,o,r),r&&!D(r[1])&&this.zTa.push(r)},t.prototype.VTa=function(t,e){return this.YTa(t,e).VTa()},t.prototype.Hp=function(t,e){return this.YTa(t,e).Hp()},t.prototype.Jp=function(t,e,n){return this.YTa(t,e).Jp(n)},t.prototype.setItem=function(t,e,n,o){var r,i,a=this;D(e)&&(e=3),r=a.WTa>0?[[t?R:k,e],C]:C,a.YTa(t,e).Kp(n,o,r),o&&(D(o.size)||(i=t?c.AxisInfoChangeType.setRowHeight:c.AxisInfoChangeType.setColumnWidth,a.zgc({type:i,index:n,value:o.size,sheetArea:e})),D(o.visible)||(i=t?c.AxisInfoChangeType.setRowVisible:c.AxisInfoChangeType.setColumnVisible,a.zgc({type:i,index:n,sheetArea:e}))),r&&a.zTa.push(r)},t}(),e.lUa=Q,s.Zn(Q)},"./dist/core/worksheet/worksheet-render.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y;function X(t){return t.height}function Z(t){return t.width}function Q(t,e,n,o,r,i,a){t.beginPath(),t.lineWidth=e,t.strokeStyle=n,t.moveTo(o,r),t.lineTo(i,a),t.stroke()}function J(t,e){var n,o,r=0;return"string"==typeof t&&(1===(o=(n=t.split(" ",4)).length)?r=2*M(n[0]):2===o||3===o?r=2*M(n[1]):4===o&&(r=M(n[1])+M(n[3]))),r*e}function $(t,e,n,o,r,a,s){var l,u,c,f,h,d,g,y=r.zoom(),v=n.font,b=n.textIndent,w=n.textOrientation,T=n.isVerticalText,I=n.textIndent&&0!==n.textIndent,R=0!==w&&!m(w);return v=v?C(v,y).font:o,f=0,h=t,t&&h.richText?f=function(t,e,n){return function(t,e,n){var o,r,i,a,s;for(o=0,r=t;o<r.length;o++)i=r[o],void 0,i.style=i.style||{},s=i.style,a=s.font?C(s.font,n).font:e,s.font=a}(t,e,n),i.Vn.R_a(t,e,1)}(h.richText,v,y):t&&R&&!T&&!I?(l=x(w*Math.PI/180),u=S(l),c=A(l),n.wordWrap?(d=r.ss.Sl(a),f=i.Vn.mHb(a,s,u,c,e,v,d)):(g=p(v),f=i.Vn.Xn(e,v)*c+g*u)):f=i.Vn.Xn(e,v),(f+=function(t,e,n,o){if(!m(n)&&!m(o)&&t.outlineColumn){var r=t.outlineColumn.LRa(n,o);if(r)return r}return e?8*e:0}(r,b,a,s)+2)+J(n.cellPadding,y)}function K(t,e,n){if(t&&-90<=t&&t<=90)return R(n/I(x(t*Math.PI/180)))+e+4}function tt(t,e,n,o,r,i,a,l,c){var f,h,p,d,g,v,C,w,T,x,S,A,I,R,k;if(y(r.data)&&t.parent&&t.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(f=t.ss,h=Z(r),p=Z(r),g=r.style,C=r.text,x=g.watermark,S=g.wordWrap,A=g.textOrientation,I=t.options.allowCellOverflow,e.findCell(i,a))return b;if(g.cellButtons&&g.cellButtons.length>0)return b;if(!(g.cellType||n).allowOverflow||!C&&!x||!A&&S&&t.parent&&t.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(C||(C=x),!I&&!A)return b;if((w=$(r.data,C,g,o,t,i,a))<=p)return b;for(R=a,k=a,v=a+(c?1:-1);(c?v<=l:v>=l)&&!e.findCell(i,v)&&(T=f.Ym(i,v),d=f.zHb(i,v,3,1,T),T.textOrientation||m(d))&&!T.watermark&&!(T.cellType&&"1"!==T.cellType.typeName||T.cellButtons&&T.cellButtons.length>0)&&(c?k=v:R=v,!(w<=(p+=f._m(v))));v+=c?1:-1);return c&&k===a||!c&&R===a?b:new s.op(a,R,k,w,h,p,c?-1:p,c?p:-1)}function et(t){var e=t.parent,n={nps:!0};return r.Worksheet.ao(t,"needPaintSelection",n),(i.Vl.Wl(t)||e&&!e.options.hideSelection)&&n.nps}function nt(t){var e=t.parent;return e&&e.options.backColor||"white"}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/worksheet/worksheet.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/stylehelper.js"),s=n("./dist/core/worksheet/worksheet-model.js"),l=n("./dist/core/worksheet/worksheet-border.js"),u=n("./dist/core/core.enum.js"),c=function(t){return t.getSparkline},f=o.Common.k,h=i.Ul.ol,p=i.Ul.fp,d=i.Ul.lZa,g=i.Ul.lHb,m=o.Common.j.Fa,y=i.Ul.Fxb,v=a.Ho,C=a.To.No,b=null,w=Math.min,T=Math.max,x=Math.abs,S=Math.sin,A=Math.cos,I=Math.tan,R=Math.floor,k=Math.round,M=parseInt,N="black",E="transparent",D="rowHeader",O="columnHeader",j=function(){function t(t,e,n){var o=this;o.kj=t,o.pJ=t.Hr(n),o.qJ=t.Ir(e,n,u.SheetArea.viewport,!0),o.yI=C(t.yl.Bl(),t.zoom()).font,o.Rq=t.Al(),o.rJ={}}return t.prototype.nJ=function(t,e){var n,o,r,a,l,c,f,p,d,g,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j=this,F=j.rJ[t];if(F)return F;if(o=(n=j.kj).ss,a=(r=j.pJ).length,T=new s.np,e||(e=i.Vn.bm()),a>0){for(T.headingOverflowlayouts=j.sJ(t,e),S=r[0].col,A=r[a-1].col,I=0;I<a;I++)Z(p=r[I])<=0||(d=p.col,g=o.Ym(t,d),y=o.zHb(t,d,3,1),l=g.textOrientation,c=g.isVerticalText,f=g.textIndent&&0!==g.textIndent,R=g&&(g.borderLeft||g.borderTop||g.borderRight||g.borderBottom),m(y)&&!g.watermark||g.shrinkToFit||!l&&g.wordWrap&&n.parent&&n.parent.options.numbersFitMode===u.NumbersFitMode.mask||c||((k=n.conditionalFormats)&&(N=(M=k.oRa(n,t,d,y)).dataBar,E=M.iconSet,N&&N.showBarOnly||E&&E.showIconOnly)||(v=o._m(d),C=o.Sl(t),D=g.cellType||j.Rq,O={},w=i.mn.vn(n,g,y,O,{row:t,col:d,sheet:n}),O&&O.content&&O.content.length>0&&!g.shrinkToFit&&l&&(w=D.sHb(e,O.content,C-4,g.font)),3===(b=g.hAlign)&&(b=h(b,y,g.formatter,l)),R&&l&&!c&&!f?0>l&&l>-90?(x=j.UIb({data:y,style:g,width:v,text:w},t,d,S))&&T.push(x):0<l&&l<90&&((x=j.UIb({data:y,style:g,width:v,text:w},t,d,A,!0))&&T.push(x)):0===b?(x=j.tJ({data:y,style:g,width:v,text:w},t,d,A))&&T.push(x):2===b?(x=j.uJ({data:y,style:g,width:v,text:w},t,d,S))&&T.push(x):1===b&&((x=j.vJ({data:y,style:g,width:v,text:w},t,d,S,A))&&T.push(x)))));T.trailingOverflowLayouts=j.wJ(t,e)}return j.rJ[t]=T,T},t.prototype.tJ=function(t,e,n,o){var r=this;return tt(r.kj,r.qJ,r.Rq,r.yI,t,e,n,o,!0)},t.prototype.uJ=function(t,e,n,o){var r=this;return tt(r.kj,r.qJ,r.Rq,r.yI,t,e,n,o)},t.prototype.UIb=function(t,e,n,o,r){var i,a,l,u,c,f=this,h=f.kj,p=f.qJ,d=f.Rq,g=f.yI,m=h.ss,y=Z(t),v=Z(t),C=t.style,w=t.text,T=C.watermark,x=C.wordWrap,S=C.textOrientation,A=C&&(C.borderLeft||C.borderTop||C.borderRight||C.borderBottom),I=C.isVerticalText,R=C.textIndent&&0!==C.textIndent,k=h.options.allowCellOverflow;if(p.findCell(e,n))return b;if(C.cellButtons&&C.cellButtons.length>0)return b;if(!(C.cellType||d).allowOverflow||!w&&!T||!S&&x)return b;if(w||(w=T),!k&&!S)return b;if((a=!A||I||R?$(t.data,w,C,g,h,e,n):K(S,m._m(n),m.Sl(e)))<=v)return b;for(u=n,c=n,i=n+(r?1:-1);!(!(r?i<=o:i>=o)||p.findCell(e,i)||(l=m.Ym(e,i),l.watermark)||l.cellType&&"1"!==l.cellType.typeName||l.cellButtons&&l.cellButtons.length>0||(r?c=i:u=i,v+=m._m(i),a<=v));i+=r?1:-1);return r&&c===n||!r&&u===n?b:new s.op(n,u,c,a,y,v,r?-1:v,r?v:-1)},t.prototype.vJ=function(t,e,n,o,r){var i,a,l,c,f,h,p,d,g,v,C,w,T,x,S,A,I,R,k,M;if(y(t.data)&&this.kj.parent&&this.kj.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(l=(a=(i=this).kj).ss,c=i.qJ,f=Z(t),h=Z(t),d=t.style,v=t.text,T=d.textOrientation,x=d.watermark,S=d.wordWrap,A=a.options.allowCellOverflow,c.findCell(e,n))return b;if(d.cellButtons&&d.cellButtons.length>0)return b;if(!(d.cellType||i.Rq).allowOverflow||!v&&!x||!T&&S&&a.parent&&a.parent.options.numbersFitMode!==u.NumbersFitMode.overflow)return b;if(v||(v=x),!A&&!T)return b;if((C=$(t.data,v,d,i.yI,a,e,n))<=h)return b;for(I=n,R=h/2,g=n-1;g>=o&&!c.findCell(e,g)&&(w=l.Ym(e,g),p=l.zHb(e,g,3,1,w),w.textOrientation||m(p))&&!w.watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&w.cellButtons.length>0)&&(I=g,!(C/2<=(R+=l._m(g))));g--);for(k=n,M=h/2,g=n+1;g<=r&&!c.findCell(e,g)&&(w=l.Ym(e,g),p=l.zHb(e,g,3,1,w),w.textOrientation||m(p))&&!w.watermark&&!(w.cellType&&"1"!==w.cellType.typeName||w.cellButtons&&w.cellButtons.length>0)&&(k=g,!(C/2<=(M+=l._m(g))));g++);return I===k?b:new s.op(n,I,k,C,f,R+M,R,M)},t.prototype.sJ=function(t,e){var n,o,r,a,s,l,c,f,p,d,g,y,v=this,C=v.kj,b=C.ss,w=v.pJ,T=w[0].col,x=w[w.length-1].col,S=C.ITa,A=[];for(y=1;y<100;y++){if((l=T-y)<0)return A;if(S.findSpan(t,l)||C.mJb&&C.mJb.oJb(t,l,u.SheetArea.viewport))return A;o=b.zHb(t,l,3,1),(r=b._m(l))>0&&!m(o)&&(3===(s=(n=b.Ym(t,l)).hAlign)&&(s=h(s,o,void 0,n.textOrientation)),a=b.Sl(t),d=n.cellType||v.Rq,g={},f=i.mn.vn(C,n,o,g,{row:t,col:l,sheet:C}),g&&g.content&&g.content.length>0&&!n.shrinkToFit&&n.textOrientation&&(f=d.sHb(e,g.content,a-4,n.font)),p={data:o,style:n,width:r,text:f},0<n.textOrientation&&n.textOrientation<90?c=v.UIb(p,t,l,x,!0):0===s?c=v.tJ(p,t,l,x):1===s&&(c=v.vJ(p,t,l,T,x)),c&&c.endColumn>=T&&A.push(c))}return A},t.prototype.wJ=function(t,e){var n,o,r,a,s,l,c,f,p,d,g,y,v=this,C=v.kj,b=C.ss,w=v.pJ,T=w[0].col,x=w[w.length-1].col,S=C.ITa,A=C.getColumnCount(),I=[];for(y=1;y<100;y++){if((f=x+y)>=A)return I;if(S.findSpan(t,f)||C.mJb&&C.mJb.oJb(t,f,u.SheetArea.viewport))return I;o=b.zHb(t,f,3,1),(r=b._m(f))>0&&!m(o)&&(3===(s=(n=b.Ym(t,f)).hAlign)&&(s=h(s,o,void 0,n.textOrientation)),a=b.Sl(t),l=n.cellType||v.Rq,c={},d=i.mn.vn(C,n,o,c,{row:t,col:f,sheet:C}),c&&c.content&&c.content.length>0&&!n.shrinkToFit&&n.textOrientation&&(d=l.sHb(e,c.content,a-4,n.font)),g={data:o,style:n,width:r,text:d},0>n.textOrientation&&n.textOrientation>-90?p=v.UIb(g,t,f,T,!1):2===s?p=v.uJ(g,t,f,T):1===s&&(p=v.vJ(g,t,f,T,x)),p&&p.startColumn<=x&&I.push(p))}return I},t}(),e.xJ=j,e.needPaintSelection=et,F=function(){function t(t){this.kj=t}return t.prototype.bm=function(){var t=this.kj,e=b,n=t.Ws();return n&&n.getContext&&(e=n.getContext("2d")),e},t.prototype.vI=function(){var t,e=this,n=e.kj,o=n.Dr(),r=n.Xs,a=Z(r),s=X(r),l=e.wI;return l&&Z(l)===a&&X(l)===s||(l&&i.En.Qn(n,l),e.wI=l=i.Ul.Nl("canvas"),l.getContext&&(e.xI=l.getContext("2d"),i.En.Kn(l,b,n),i.En.Pn(l,Z(o),X(o)))),(t=e.xI)&&(t.beginPath(),d(t,e.Cl(e.Bl())),t.name="bufferContext"),t},t.prototype.Bl=function(){return this.yI||(this.yI=v+" "+this.kj.currentTheme().bodyFont()),this.yI},t.prototype.us=function(){this.yI=b},t.prototype.zI=function(t){var e=this.kj,n=e.parent,o=n?n.options.grayAreaBackColor||i.Im.Mm("gc-grayArea").backgroundColor:"gray",r=i.Rm.Om(e,o);return t?((n?n.options.backgroundImage:b)&&(r=E),r):r},t.prototype.Cl=function(t){var e=this.kj.zoom();return 1===e?t:C(t,e).font},t.prototype.Mx=function(t,e,n,o,r){var a,s,l,u,c,f=this,h=f.wI,p=f.bm();n<=0||o<=0||!h||!p||(r||(r=f.kj.Dr()),a=i.En.Ln(h),s=i.En.Mn(h),1!==a&&(t*=a,e*=s,n*=a,o*=s,r=new i.Rect(r.x*a,r.y*s,Z(r)*a,X(r)*s)),(l=r.getIntersect(t,e,n,o))&&(l.round(),t=l.x,e=l.y,n=Z(l),o=X(l),(u=Z(h))&&t+n>u&&((t=u-n)<0&&(n+=t,t=0)),(c=X(h))&&e+o>c&&((e=c-o)<0&&(o+=e,e=0)),i.Bn.Cn(p,1,1),p.clearRect(t,e,n,o),p.drawImage(h,t,e,n,o,t,e,n,o),i.Bn.Cn(p,a,s)))},t.prototype.dm=function(t,e){t&&this.Mx(t.x,t.y,Z(t),X(t),e)},t.prototype.Ow=function(t,e,n,o,r,a){var s,l,u,c,f,h,p,d,g,m,y,v,C,b;if(n>0&&o>0)try{l=(s=this).kj,u=s.bm(),c=l.Ws(),f=s.vI(),h=s.wI,p=r,d=a,g=n,m=o,y=i.En.Ln(c),v=i.En.Mn(c),t=k(t*y),e=k(e*v),n=k(n*y),o=k(o*v),p=k(p*y),d=k(d*v),g=k(g*y),m=k(m*v),C=Z(h),b=X(h),C&&t+n>C&&((t=C-n)<0&&(n+=t,t=0)),b&&e+o>b&&((e=b-o)<0&&(o+=e,e=0)),C&&p+g>C&&((p=C-g)<0&&(g+=p,p=0)),b&&d+m>b&&((d=b-m)<0&&(m+=d,d=0)),i.Bn.Cn(u,1,1),i.Bn.Cn(f,1,1),u.clearRect(p,d,g,m),u.drawImage(h,t,e,n,o,p,d,g,m),f.clearRect(p,d,g,m),f.drawImage(c,p,d,g,m,p,d,g,m),i.Bn.Cn(u,y,v),i.Bn.Cn(f,y,v)}catch(t){}},t.prototype.im=function(t,e,n,o){var r,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,x,S,A,I,R=this;if(n||(n=R.bm()),r=!1,a=R.kj,s=i.kf(-1,-1,-1,-1),l=a.Hx,u=a.ITa,t&&(s=a.options.allowCellOverflow?i.kf(t.row,0,t.rowCount,a.getColumnCount()):i.kf(t.row,t.col,t.rowCount,t.colCount),!l)){if(s.col>=0){for(f=s.col,h=s.col+s.colCount-1,p=a.getRowCount(1),d=0;d<p;d++)(c=u.findSpan(d,s.col,1))?f=w(c.col,f):a.p_a&&(f=w(a.p_a.col,f)),(c=u.findSpan(d,s.col+s.colCount-1,1))?h=T(c.col+c.colCount-1,h):a.p_a&&(h=T(a.p_a.col+a.p_a.colCount-1,h));s.col=f,s.colCount=h-f+1}if(s.row>=0){for(g=s.row,m=s.row+s.rowCount-1,y=a.getColumnCount(2),v=0;v<y;v++)(c=u.findSpan(s.row,v,2))?g=w(c.row,g):a.p_a&&(g=w(a.p_a.row,g)),(c=u.findSpan(s.row+s.rowCount-1,v,2))?m=T(c.row+c.rowCount-1,m):a.p_a&&(m=T(a.p_a.row+a.p_a.rowCount-1,m));s.row=g,s.rowCount=m-g+1}}if(C=a.cm(s),a.cellStates&&a.cellStates.hasIntersectInSeletionState(s.row,s.col,s.rowCount,s.colCount)&&a.repaint(C),b=Z(C),x=X(C),S=C.x,A=C.y,b>=0||x>=0){if(C.x-=9,C.y-=9,C.width+=18,C.height+=30,e&&!(C=C.getIntersectRect(e)))return;I=a.am(),x>0&&!l&&(a.$l=!0,R.jp(n,new i.Rect(I.x,T(I.nt,A),I.Br,x),o)),b>0&&!l&&(a.$l=!0,R.jp(n,new i.Rect(T(I.kt,S),I.y,b,I.Cr),o)),-1!==s.row||-1!==s.col||l||(a.$l=!0,R.jp(n,I.em(),o)),b>0&&x>0&&R.jp(n,C,o),r=!0}return r},t.prototype.VF=function(t,e,n,o,r){var a,s=this,l=s.kj;l.Xq<=0&&((a=s.bm())&&(r||(l.$l=!0),s.jp(a,new i.Rect(t,e,n,o))))},t.prototype.repaint=function(t){var e,n=this,o=n.kj;o.Xq>0||(e=n.bm())&&(o.$l=!0,n.jp(e,t))},t.prototype.jp=function(t,e,n){var o=this;t&&o.kj.Xq<=0&&(n||o._l(t,e),o.Pw(t,e))},t.prototype._l=function(t,e,n){var o,r,a,s=this,l=s.kj;t&&l.Xq<=0&&(r=(o=s.vI())||t,a=l.Dr(),e||(e=a),e&&e.round(),n&&n.round(),l.$l&&(l.$l=!1,o&&(o.clearRect(e.x,e.y,Z(e),X(e)),n&&o.clearRect(n.x,n.y,Z(n),X(n)),i.Bn.Dn(o,-a.x,-a.y)),s.AI(r,e),n&&s.AI(r,n),o&&i.Bn.Dn(o,a.x,a.y)),o&&(s.dm(e),n&&s.dm(n)))},t.prototype.Pw=function(t,e){var n,o,i,a,s,l=this,u=l.kj,c=u.CH;if(t&&!(u.Xq>0)&&(e&&e.round(),n=u.am(),r.Worksheet.ao(u,"beforePaintAdornment",{ctx:t,clipRect:e}),!u.fI)){if(c){for(o=n.em(),l.dm(o),a=0;a<=2;a++)(o=n.fm(a))&&0!==Z(o)&&0!==X(o)&&l.dm(o);for(s=0;s<=2;s++)(o=n.gm(s))&&0!==Z(o)&&0!==X(o)&&l.dm(o)}for(a=0;a<=2;a++)for(s=0;s<=2;s++)(o=n.Ft(a,s))&&0!==Z(o)&&0!==X(o)&&(i=e,(c&&(1!==a||1!==s)||u.parent&&u.parent.options.allowUserDragMerge)&&(l.dm(o),i=o),i&&!o.intersectRect(i)||l.BI(t,a,s,i));l.CI(t),r.Worksheet.ao(u,"paintAdornment",{ctx:t,clipRect:e})}},t.prototype.dD=function(t,e){var n=this.kj,o=n.parent,r=o?o.options:{},a=nt(n),s=i.Rm.Om(n,a);r.backgroundImage&&(s=E),t.save(),t.fillStyle=s,t.fillRect(e.x,e.y,Z(e),X(e)),t.restore()},t.prototype.z0a=function(t){var e=this.kj;return 0===e.am().Cr&&t===e.ar(3)},t.prototype.A0a=function(t){var e=this.kj;return 0===e.am().Br&&t===e.$q(3)},t.prototype.DI=function(t,e,n){var o,r,i,a,s,l,u,c=this,f=c.kj,h=f.options,p=f.am(),d=h.sheetAreaOffset.top,g=h.sheetAreaOffset.left,m=0!==p.Cr,y=0!==p.Br,v=f.Gt&&f.Gt()||{x:h.sheetAreaOffset.left,y:h.sheetAreaOffset.top,width:0,height:0},C=0===v.width,b=0===v.height;for(r=0;r<=2;r++)(a=p.gm(r))&&(m&&b&&(a.y=a.y-d,a.height=a.height+d,!y&&C&&(a.x=a.x-g,a.width=a.width+g)),(i=e?a.getIntersectRect(e):a)&&c.EI(t,r,i,n));for(o=0;o<=2;o++)for((s=p.fm(o))&&(y&&C&&(s.x=s.x-g,s.width=s.width+g,!m&&b&&(s.y=s.y-d,s.height=s.height+d)),(i=e?s.getIntersectRect(e):s)&&c.FI(t,o,i,n)),r=0;r<=2;r++)l=p.Ft(o,r),c.z0a(f.jCb(o))&&b&&(l.y=l.y-d,l.height=l.height+d),c.A0a(f.kCb(r))&&C&&(l.x=l.x-g,l.width=l.width+g),l&&((i=e?l.getIntersectRect(e):l)&&c.GI(t,o,r,i,n));(u=p.em())&&((i=e?u.getIntersectRect(e):u)&&c.HI(t,i,n))},t.prototype.II=function(t){var e,n,o,r,i,a=this,s=a.kj,l=s.am(),u=l.zr,c=l.Ar,f=l.lt,h=l.ot,p=Z(l),d=X(l),g=l.qt,m=l.pt,y=0,v=s.Gr(1);v.length>0?(y=n=(e=v[v.length-1]).y+X(e),n<h&&(t.fillStyle=a.zI(!1),t.fillRect(u,n,p,h-n))):0===v.length&&(t.fillStyle=a.zI(!1),t.fillRect(u,g,p,h-g),y=g),(o=s.Hr(1)).length>0?(i=(r=o[o.length-1]).x+Z(r))<f&&(t.fillStyle=a.zI(!1),t.fillRect(i,c,f-i,y),t.fillRect(i,h,f-i,d-h)):0===o.length&&(t.fillStyle=a.zI(!1),t.fillRect(m,c,f-m,y),t.fillRect(m,h,f-m,d-y))},t.prototype.B0a=function(t,e){var n=this,o=n.kj,r=n.zI(!1),i=o.options,a=i.sheetAreaOffset.left,s=i.sheetAreaOffset.top,l=e.x,u=e.y,c=Z(e),f=X(e);t.save(),a>0&&Q(t,a,r,l+a/2,s>0?u+s:u,l+a/2,u+T(0,f)),s>0&&Q(t,s,r,a>0?l+a:l,u+s/2,l+T(0,c),u+s/2),a>0&&s>0&&(t.fillStyle=n.zI(!1),t.fillRect(l,u,a,s)),t.beginPath(),t.restore()},t.prototype.AI=function(t,e){var n,o=this,i=o.kj;!t||i.Xq>0||(n=i.Dr(),t.save(),e?t.rect(e.x,e.y,Z(e),X(e)):t.rect(n.x,n.y,Z(n),X(n)),t.clip(),t.beginPath(),o.dD(t,n),r.Worksheet.ao(i,"paint",{ctx:t,clipRect:e}),o.B0a(t,n),o.DI(t,e,!1),o.II(t),o.KI(t),r.Worksheet.ao(i,"paintSheetEnd",{ctx:t,clipRect:e}),t.beginPath(),t.restore())},t.prototype.LI=function(t,e){var n,o,r=this,a=r.kj;t&&(n=a.Dr(),t.save(),o=e||new i.Rect(n.x,n.y,Z(n),X(n)),t.rect(o.x,o.y,Z(o),X(o)),t.clip(),t.beginPath(),r.dD(t,n),r.DI(t,o,!0),t.beginPath(),t.restore())},t.prototype.CI=function(t){var e,n,o,r,i,a,s,l,u,c=this.kj,f=c.mm,h=c.yt;if(f&&f.isResizing&&h&&(s=h.resizeInfo)){if(l=c.am(),u=N,t.save(),t.strokeStyle!==u&&(t.strokeStyle=u),1!==t.lineWidth&&(t.lineWidth=1),t.beginPath(),"sizeRow"===s.action||"sizeHiddenRow"===s.action)for(n=T(0,s.startY-.5),r=s.movingY-.5,i=l.x+Z(l),e=l.x;e<i;e+=2)t.moveTo(e,n),t.lineTo(e+1,n),t.moveTo(e,r),t.lineTo(e+1,r);else for(e=T(0,s.startX-.5),o=s.movingX-.5,a=l.y+X(l),n=l.y;n<a;n+=2)t.moveTo(e,n),t.lineTo(e,n+1),t.moveTo(o,n),t.lineTo(o,n+1);t.stroke(),t.beginPath(),t.restore()}},t.prototype.HI=function(t,e,n){var o,r,i,a,s,u,c,f=this.kj;t.beginPath(),r=(o=f.am().em()).x,i=o.y,a=Z(o),s=X(o),u=f.getActualStyle(-1,-1,0),this.SI(t,[{data:b,row:-1,col:-1,x:r,y:i,width:a,height:s,style:u.clone()}],0,n),(c=new l.AF(f,f.Gr(0,0),f.Hr(0,0),0)).jF(0,0,r,i,a,s),c.paint(t)},t.prototype.KI=function(t){var e,n,o,r,a,s,l,u,c,f=this.kj,h=f.frozenRowCount(),p=f.frozenColumnCount(),d=f.frozenTrailingRowCount(),g=f.frozenTrailingColumnCount();(h||p||d||g)&&(n=(e=f.am()).pt,o=e.qt,r=e.lt,a=e.ot,s=e.x,l=e.y,u=Z(e),c=X(e),t.save(),t.strokeStyle=i.Rm.Om(f,f.options.frozenlineColor),t.lineWidth=1,t.beginPath(),p&&(t.moveTo(n-.5,l),t.lineTo(n-.5,l+c)),h&&(t.moveTo(s,o-.5),t.lineTo(s+u,o-.5)),g&&(t.moveTo(r-.5,l),t.lineTo(r-.5,l+c)),d&&(t.moveTo(s,a-.5),t.lineTo(s+u,a-.5)),t.stroke(),t.restore())},t.prototype.EI=function(t,e,n,o){this.TI(t,-1,e,1,n,o)},t.prototype.FI=function(t,e,n,o){this.TI(t,e,-1,2,n,o)},t.prototype.GI=function(t,e,n,o,r){var i,a,s,l=this.kj.et;l&&((i=l.getCalcService())&&i.calcOnDemand&&((a=l.xf).clearValueCache&&a.clearValueCache())),this.TI(t,e,n,3,o,r),(s=this.kj.at)&&s.UI(t,o,e,n)},t.prototype.VIb=function(t,e,n,o,r){var a,s,l,u=this.kj,c=u.getRangeRect(e,n,i.kf(r.row,r.col,r.rowCount,r.colCount));(c=c.getIntersectRect(u.am().Ft(e,n)))&&(c.round(),a=r.isValid,t.save(),t.lineWidth=1,t.strokeStyle="mediumblue",a||t.setLineDash([6,2]),s=c.x+.5,l=c.y+.5,t.strokeRect(s,l,Z(c),X(c)),t.beginPath(),t.restore())},t.prototype.BI=function(t,e,n,o){var r,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,E,D,O,j=this,F=j.kj;if(et(F)){if(!F.addSelection)return;if(l=F.ITa,u=F.mm,f=(c=l.getSelections()).length,!(o=j.VI(e,n,o)))return;if(h=i.Im.Lm("gc-selection"),(p=M(h.zIndex))>2007&&j.WI(t,e,n,o),(d=l.WIb=l.ZHb.getAnchorInfo(F.getActiveRowIndex(),F.getActiveColumnIndex()))&&j.VIb(t,e,n,o,d),y=void 0,(m=(g=j.XI(e,n,c,o)).length)<=0)return;for(v=j.XI(e,n,[F.p_a],o)[0],C=!1,b=void 0,b=0;b<m;b++)if(y=g[b],!o.containsRect(y)){C=!0;break}if(v&&!o.containsRect(v)&&(C=!0),t.save(),C&&(t.rect(o.x,o.y,Z(o),X(o)),t.clip()),t.beginPath(),m>0)for(s=i.Rm.Om(F,F.getSelectionBackColor()),t.fillStyle!==s&&(t.fillStyle=s),r=0,a=0,p>2007&&(r=1,a=-3),b=0;b<m;b++)y=g[b],t.fillRect(y.x+r,y.y+r,Z(y)+a,X(y)+a);F.sgc||(w=F.Jl,T=F.Kl,v&&(w=F.s_a,T=F.t_a),S=void 0,A=void 0,I=void 0,R=void 0,(x=F.getCellRect(w,T,e,n))&&x.intersectRect(o)&&(S=x.x,A=x.y,I=Z(x),R=X(x),r=1,a=-2,p>2007&&(r=0,a=0),j.Mx(S+r,A+r,I+a,R+a),f>1&&(t.strokeStyle=N,t.lineWidth=1,t.strokeRect(S+1.5,A+1.5,I-4,R-4)))),t.restore(),t.save(),t.beginPath(),1===f&&(u&&u.BG&&u.ZI&&u.ZI()&&!u.$I&&(k=u._I&&u._I(),D=Z(E=F.getRangeRect(e,n,k)),O=X(E),E&&D>0&&O>0&&(t.fillStyle=h&&h.color,t.fillRect(E.x,E.y,D,O))),y&&Z(y)>=0&&X(y)>=0&&(j.YI(o,F,e,n,p),j.aJ(t,e,n,y,o,c[0]))),v&&(t.save(),C&&(t.rect(o.x,o.y,Z(o),X(o)),t.clip()),t.beginPath(),t.fillStyle="rgba(255,255,255,0.4)",t.fillRect(v.x+r,v.y+r,Z(v)+a,X(v)+a),t.fillStyle=s,t.strokeStyle="rgb(124,124,124)",t.lineWidth=1,t.strokeRect(v.x-.5,v.y-.5,Z(v),X(v)),t.restore()),t.beginPath(),t.restore()}},t.prototype.YI=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m=e.frozenTrailingRowCount(),y=e.frozenTrailingColumnCount(),v=e.getSelections(),C=e.am(),b=e.getRowCount()-m-1,w=e.getColumnCount()-y-1,T=e.Hr(1,3),x=e.Gr(1,3);1===v.length&&r>2007&&(i=e.frozenRowCount(),a=e.frozenColumnCount(),l=(s=v[0]).row,u=s.col,c=s.rowCount,f=s.colCount,i>0&&(l>=i&&e.gr(l)<i?(t.y-=2,t.height+=2):l+c<=i&&e._q(l+c-1)===e.lq&&(t.height+=2)),a>0&&(u>=a&&e.br(u)<a?(t.x-=2,t.width+=2):u+f<=a&&e.Zq(u+f-1)===e.qq&&(t.width+=2)),0===l&&0===u&&(t.x-=2,t.y-=2,t.width+=2,t.height+=2),-1===l&&(l=0,c=e.getRowCount()),-1===u&&(u=0,f=e.getColumnCount()),h=!1,p=!1,d=x.findRow(b),g=T.findCol(w),d&&d.y+X(d)<C.qt+C.jr&&(h=!0),g&&g.x+Z(g)<C.pt+C.er&&(p=!0),h&&l+c-1===b&&(t.height+=2),p&&u+f-1===w&&(t.width+=2))},t.prototype.WI=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E=this,D=E.kj,O=D.ITa.getSelections(),j=D.am(),F=j.kt,P=j.nt,_=O.length,L=0!==j.Cr,B=0!==j.Br;if(!(_<=0)){if(i=(r=O[0]).row,a=r.rowCount,s=r.col,l=r.colCount,-1===i&&(i=0),-1===s&&(s=0),-1===a&&(a=D.getRowCount()),-1===l&&(l=D.getColumnCount()),t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=D.getSelectionBorderColor(),u=o.x,c=o.y,f=Z(o),h=X(o),p=D.frozenRowCount(),L&&(1!==_||0!==p||D.lq<=i||D.lq>=i+a))for(g=0,m=(d=E.bJ(n)).length;g<m;g++)v=0,C=0,b=(y=d[g]).x,w=y.x+Z(y),y.x<u+f&&u<y.x+Z(y)&&(1===_&&(0===p&&D.lq===i||p>0&&0===i)&&(v=-1,C=1),y.x<u&&(v=0,b=u),y.x+Z(y)>u+f&&(C=0,w=u+f),t.moveTo(b+v-1,P-1),t.lineTo(w+C,P-1),t.stroke());if(T=D.frozenColumnCount(),B&&(1!==_||0!==T||D.qq<=s||D.qq>=s+l))for(S=0,A=(x=E.cJ(e)).length;S<A;S++)R=0,k=0,M=(I=x[S]).y,N=I.y+X(I),I.y<c+h&&c<I.y+X(I)&&(1===_&&(0===T&&D.qq===s||T>0&&0===s)&&(R=-1,k=1),I.y<c&&(R=0,M=c),I.y+X(I)>c+h&&(k=0,N=c+h),t.moveTo(F-1,M+R-1),t.lineTo(F-1,N+k),t.stroke());t.beginPath(),t.restore()}},t.prototype.bJ=function(t){var e,n,o,r,a,s,l,u,c,f,h,p=this.kj,d=p.ITa.getSelections(),g=d.length,m=p.Hr(t),y=[];for(e=0;e<g;e++)(n=d[e])&&(-1===(o=n.col)?(r=p.Hr(0,3),a=p.Hr(1,3),s=p.Hr(2,3),l=-1,u=-1,r.length>0&&(l=r[0].x,u=r[r.length-1].x+r[r.length-1].width-l,y.push(new i.Rect(l,-1,u,-1))),a.length>0&&(l=a[0].x,u=a[a.length-1].x+a[a.length-1].width-l,y.push(new i.Rect(l,-1,u,-1))),s.length>0&&(l=s[0].x,u=s[s.length-1].x+s[s.length-1].width-l,y.push(new i.Rect(l,-1,u,-1)))):m&&(c=m.findCol(o),f=m.findCol(o+n.colCount-1),(c||f)&&((h=new i.Rect(-1,-1,-1,-1)).x=c?c.x:m[0].x,h.width=f?f.x+Z(f)-h.x:m[m.length-1].x+m[m.length-1].width-h.x,y.push(h))));return y},t.prototype.cJ=function(t){var e,n,o,r,a,s,l,u,c,f,h,p=this.kj,d=p.ITa.getSelections(),g=d.length,m=p.Gr(t),y=[];for(e=0;e<g;e++)(n=d[e])&&(-1===(o=n.row)?(r=p.Gr(0,3),a=p.Gr(1,3),s=p.Gr(2,3),l=-1,u=-1,r.length>0&&(l=r[0].y,u=r[r.length-1].y+r[r.length-1].height-l,y.push(new i.Rect(-1,l,-1,u))),a.length>0&&(l=a[0].y,u=a[a.length-1].y+a[a.length-1].height-l,y.push(new i.Rect(-1,l,-1,u))),s.length>0&&(l=s[0].y,u=s[s.length-1].y+s[s.length-1].height-l,y.push(new i.Rect(-1,l,-1,u)))):m&&(c=m.findRow(o),f=m.findRow(o+n.rowCount-1),(c||f)&&((h=new i.Rect(-1,-1,-1,-1)).y=c?c.y:m[0].y,h.height=f?f.y+X(f)-h.y:m[m.length-1].y+m[m.length-1].height-h.y,y.push(h))));return y},t.prototype.aJ=function(t,e,n,o,r,a){var s,l=this,u=l.kj,c=u.parent,f=u.mm,h=o.x,p=o.y,d=Z(o),g=X(o),m=u.getViewportTopRow(e),y=u.getViewportLeftColumn(n),v=u.getViewportBottomRow(e),C=u.getViewportRightColumn(n),b=0,w=0,T=u.am(),x=0!==T.Cr;0!==T.Br||a.col!==y&&-1!==a.col||(b=2),x||a.row!==m&&-1!==a.row||(w=2),a.row+a.rowCount===v+1&&(r.height=r.height+1),a.col+a.colCount===C+1&&(r.width=r.width+1),d>=0&&g>=0&&(!r||o.intersect(r.x-1,r.y-1,Z(r)+2,X(r)+2))&&(t.save(),r&&!r.containsRect(o)&&(t.rect(r.x-b,r.y-w,Z(r),X(r)),t.clip()),t.beginPath(),t.strokeStyle=i.Rm.Om(u,u.getSelectionBorderColor()),t.lineWidth=2,d>0&&g>0?(f&&f.BG?2===(s=f.dJ)?(t.moveTo(h+.5,p-.5),t.lineTo(h+d-1,p-.5)):3===s?(t.moveTo(h+.5,p+g-.5),t.lineTo(h+d-1,p+g-.5)):0===s?(t.moveTo(h-.5,p+.5),t.lineTo(h-.5,p+g-1)):1===s&&(t.moveTo(h+d-.5,p+.5),t.lineTo(h+d-.5,p+g-1)):(c&&c.Vv)>2007?t.rect(h-1,p-1,d+1,g+1):t.rect(h-.5,p-.5,d,g),t.stroke(),c&&c.options.allowUserDragFill&&l.eJ&&l.eJ(t,e,n,o,r)):0!==d&&0!==g||t.strokeRect(h-1,p-1,d+1,g+1),t.beginPath(),t.restore())},t.prototype.VI=function(t,e,n){var o,r,i,a,s=this.kj,l=s.am(),u=l.Ft(t,e);return 1===e&&((r=(o=s.Hr(e)).length>0?o[o.length-1]:b)&&(u.width=w(Z(u),r.x+Z(r)-l.pt))),1===t&&((a=(i=s.Gr(t)).length>0?i[i.length-1]:b)&&(u.height=w(X(u),a.y+X(a)-l.qt))),n?n.getIntersect(u.x,u.y,Z(u),X(u)):u},t.prototype.XI=function(t,e,n,o){var r,i,a,s,l=this.kj,u=l.ITa,c=n.length,f=[];for(s=0;s<c;s++)(i=n[s])&&((r=u.findSpan(i.row,i.col))&&r.containsRange(i)&&(i=r),(a=l.getRangeRect(t,e,i))&&a.x<=o.x+Z(o)&&a.y<=o.y+X(o)&&o.x<=a.x+Z(a)&&o.y<=a.y+X(a)&&f.push(a));return f},t.prototype.fJ=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p;if(t.save(),o=e.x,r=e.y,i=Z(e),a=X(e),s=[6,6],t.setLineDash)t.beginPath(),t.lineWidth=2,t.strokeStyle=n,t.setLineDash(s),t.rect(o,r,i-1,a-1),t.stroke();else{for(t.beginPath(),t.lineWidth=2,t.strokeStyle=n,l=s[0],u=s[1],c=void 0,f=void 0,h=void 0,p=void 0,c=o,f=r,h=i;h>0;)if(h>=l+u)t.moveTo(c,f),t.lineTo(c+l,f),c=c+l+u,h=h-l-u;else{if(h>=l){t.moveTo(c,f),t.lineTo(c+l,f),h=h-l-u;break}if(h>0){t.moveTo(c,f),t.lineTo(c+h,f),h=h-l-u;break}}for(c=o+i-1,f=r+1,p=a-1,h<0&&((h=x(h))>u&&(t.moveTo(c,f-2),t.lineTo(c,f+(h-u))),f+=h,p-=h);p>0;)p>=l+u?(t.moveTo(c,f),t.lineTo(c,f+l),f=f+l+u,p=p-l-u):p>=l?(t.moveTo(c,f),t.lineTo(c,f+l),p=p-l-u):p>0&&(t.moveTo(c,f),t.lineTo(c,f+p),p=p-l-u);for(c=o+i-2,f=r+a-1,h=i-1,p<0&&((p=x(p))>u&&(t.moveTo(c+2,f),t.lineTo(c-(p-u),f)),c-=p,h-=p);h>0;)if(h>=l+u)t.moveTo(c,f),t.lineTo(c-l,f),c=c-l-u,h=h-l-u;else{if(h>=l){t.moveTo(c,f),t.lineTo(c-l,f),h=h-l-u;break}if(h>0){t.moveTo(c,f),t.lineTo(c-h,f),h=h-l-u;break}}for(c=o,f=r+a-2,p=a-1,h<0&&((h=x(h))>u&&(t.moveTo(c,f+2),t.lineTo(c,f-(h-u))),f-=h,p-=h);p>0;)p>=l+u?(t.moveTo(c,f),t.lineTo(c,f-l),f=f-l-u,p=p-l-u):p>=l?(t.moveTo(c,f),f-l===r?t.lineTo(c,f-l-1):t.lineTo(c,f-l),p=p-l-u):p>0&&(f>r&&(t.moveTo(c,f),t.lineTo(c,f-p)),p=p-l-u);t.stroke()}t.beginPath(),t.restore()},t.prototype.XIb=function(t,e,n,o,r,i,a){var s,l,u,c,f;0!==e.length&&(s=e[0].col-1,l=e[e.length-1].col+1,u=n.zHb(o.row,s,a,1),r&&s>=0&&i.isValid&&!i.isValid(o.row,s,u)&&t.push({style:i.getDataValidator(o.row,s).highlightStyle(),x:e[0].x-i.getColumnWidth(s),y:o.y,width:i.getColumnWidth(s),height:o.height}),c=n.zHb(o.row,l,a,1),r&&i.isValid&&!i.isValid(o.row,l,c)&&(f=e[e.length-1],t.push({style:i.getDataValidator(o.row,l).highlightStyle(),x:f.x+f.width,y:o.y,width:i.getColumnWidth(l),height:o.height})))},t.prototype.YIb=function(t,e,n){var o,r,i,a,s=e.ss,l=t.row,u=t.col,c={},f={},h=[],p=t.rowCount,d=t.colCount;for(o=0;o<d;o++)f[o]=e.Tl(o+u,n);for(r=0;r<p;r++){for(c[r]=e.Sl(r+l,n),i=[],a=0;a<d;a++)i.push(s.Ym(l+r,u+a,n));h.push(i)}return{rowSizes:c,colSizes:f,styleList:h}},t.prototype.TI=function(t,e,o,i,a,s){var u,h,p,d,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,F,P,_,L,B,G,H,V,z,W,U,q,Y,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt;if(m(i)&&(i=3),p=(h=(u=this).kj).parent,d=h.am().Ft(e,o),y=p&&p.options.resizeZeroIndicator,v=h.Gr(e,i),C=h.Hr(o,i),b=h.options.sheetAreaOffset,w=h.Gt&&h.Gt()||{x:b.left,y:b.top,width:0,height:0},T=v.length,x=C.length,!(T<0||x<0)){for(A=(S=h.Ir(e,o,i,!0)).length>0,M=h.ss,D=0,O=0,F=0,P=0,B=new l.AF(h,v,C,i),G=[],H=[],V=[],z=[],W=!s&&3===i&&p&&p.options.highlightInvalidData,t.save(),t.beginPath(),U=[],q=-1,Y=-1,Q=h.ar(3),J=h.$q(3),K=0===($=h.am()).Cr&&0===w.height,tt=0===$.Br&&0===w.width,et=!!c(this.kj),nt=n("SheetsCalc"),ot=h.getActiveRowIndex(),rt=h.getActiveColumnIndex(),it=this.ZIb(i,h,ot,rt),at=0;at<T;at++)for(I=v[at],u.XIb(z,C,M,I,W,h,i),st=0;st<x;st++)if(R=C[st],(k=A&&S.findCell(I.row,R.col))?(N=k.row,E=k.col,D=k.x,O=k.y,F=Z(k),P=X(k),k.isAutoMerge&&(D=(lt=u.$Ib(k,e,o,i)).x,O=lt.y,F=lt.width,P=lt.height),k.spanSizeInfo||(k.spanSizeInfo=u.YIb(k,h,i))):(N=I.row,E=R.col,D=R.x,O=I.y,F=Z(R),P=X(I)),1===y&&(-1===e&&h.getColumnVisible(E)&&0===h.$r(E)&&((Y<0||Y!==E-1)&&U.push({x1:D,y1:O,x2:D,y2:O+P,horizontal:!1}),Y=E),-1===o&&h.getRowVisible(N)&&0===h.Yr(N)&&((q<0||q!==N-1)&&U.push({x1:D,y1:O,x2:D+F,y2:O,horizontal:!0}),q=N)),!(a&&(D+F<=a.x||D>=a.x+Z(a)||O+P<=a.y||O>=a.y+X(a))||0===F||0===P||(ut=!1,k&&f.Bb(G,k)))){if(ct=!1,_=M.zHb(N,E,i,1),ft=h.jZ&&h.jZ(),it&&0===N&&E>=it.dj&&it.cj+it.Xj>h.lq&&E<it.dj+it.OZ){if(_=h.getCell(it.cj,E).text()+"",ut=!0,ct=it.filterButtonVisible(),ft)for(ht=0;ht<ft.length;ht++)if(ft[ht].col===E&&ft[ht].rowFilter.sj===it){this._Ib(ft[ht],1,0,!0);break}}else if(ft&&ft.length>0)for(pt=ft[0].rowFilter&&ft[0].rowFilter.sj,ht=ft.length-1;ht>=0;ht--)if(ft[ht].tableColumnHeaderFilter&&ft[ht].col===E){this._Ib(ft[ht],3,pt.cj,!1);break}L=M.Ym(N,E,i),W&&h.isValid&&!h.isValid(N,E,_)&&z.push({style:h.getDataValidator(N,E).highlightStyle(),x:D,y:O,width:F,height:P}),3===i&&(dt=L.formatter,nt&&!s&&dt&&g(dt)&&((gt=h.parent&&h.parent.aJb(dt))&&(mt=gt.getExpression(),_=nt.evaluateExpression(h,mt,N,E)))),B.jF(N,E,D,O,F,P,L,k,N===Q&&K,E===J&&tt,_),ut&&(L.hAlign=0),H.push({data:_,row:N,col:E,x:D,y:O,width:F,sparkline:et&&h.getSparkline(N,E),height:P,style:L,cellLayout:k,tableFilter:ct}),k&&G.push(k)}if(H.length>0){if(3===i&&h.options.allowCellOverflow&&(yt=M.Sm(e,o,(function(){return new j(h,e,o)})),(V=u.hJ(t,yt,H,B)).length>0)){for(vt=a.x,Ct=a.x+a.width,at=0;at<V.length;at++)(bt=V[at])&&(wt=bt.row,Tt=bt.col,(xt=bt.cellOverflowLayout&&bt.cellOverflowLayout.layout)&&((St=xt.x)<vt&&(vt=St),(At=St+xt.width)>Ct&&(Ct=At)),B.jF(wt,Tt,bt.x,bt.y,bt.width,bt.height,bt.style,bt.cellLayout,wt===Q&&K,Tt===J&&tt,bt.data));H=H.concat(V),a.x=vt,a.width=Ct-vt,!s&&d&&(a=a?d.getIntersectRect(a):d)}a&&(It=h.printInfo&&h.printInfo(),s&&It&&(It.columnStart()>0||It.rowStart()>0)&&!It.showBorder()?t.rect(a.x-(It.columnStart()>0?2:0),a.y-(It.rowStart()>0?2:0),Z(a)+(It.columnStart()>0?4:0),X(a)+(It.rowStart()>0?4:0)):t.rect(a.x,a.y,Z(a),X(a)),t.clip()),u.SI(t,H,i,s)}r.Worksheet.ao(h,"paintViewport",{ctx:t,rowViewportIndex:e,colViewportIndex:o,sheetArea:i,clipRect:a,isPrinting:s}),B.paint(t),U.length>0&&u.iJ(t,U,1,3),z.length>0&&(Rt=d.getIntersectRect(a),t.rect(Rt.x,Rt.y,Z(Rt),X(Rt)),t.clip(),u.jJ(t,z)),t.restore()}},t.prototype._Ib=function(t,e,n,o){t.sheetArea=e,t.row=n,t.tableColumnHeaderFilter=o},t.prototype.ZIb=function(t,e,n,o){if(e.tables&&1===t&&0===e.frozenRowCount()&&0===e.frozenColumnCount()){var r=e.tables.find(n,o);if(r&&r.MZ&&r.cj<e.lq)return r}return null},t.prototype.$Ib=function(t,e,n,o){var r,a,s,l,u,c,f,h,p,d=t.row,g=t.col,m=t.x,y=t.y,v=t.width,C=t.height,b=this.kj,w=b.am();return 1!==e||3!==o&&2!==o||(r=w.fm(e),a=b.frozenRowCount(),s=b.getRowCount(o)-b.frozenTrailingRowCount()-1,y<(l=r.y)&&a<=d&&d<=s&&(C-=l-y,y=l),y+C>l+(u=r.height)&&a<=d+t.rowCount-1&&d+t.rowCount-1<=s&&(C-=y+C-(l+u))),1!==n||3!==o&&1!==o||(r=w.gm(n),c=b.frozenColumnCount(),f=b.getColumnCount(o)-b.frozenTrailingColumnCount()-1,m<(h=r.x)&&c<=g&&g<=f&&(v-=h-m,m=h),m+v>h+(p=r.width)&&c<=g+t.colCount-1&&g+t.colCount-1<=f&&(v-=m+v-(h+p))),new i.Rect(m,y,v,C)},t.prototype.iJ=function(t,e,n,o){var r,i,a,s,l,u,c,f;if(0!==e.length)for(r=0,i=e.length;r<i;r++)s=(a=e[r]).x1,l=a.y1,u=a.x2,c=a.y2,f=a.horizontal,t.beginPath(),t.save(),t.lineWidth=n,t.strokeStyle=this.kJ(t,f,s,l,u,c),t.fillStyle=this.lJ(t,f,s,l,u,c),f?(-3,1,-1,-2,t.fillRect(s,l+-3,u-s-1,o+2*n),l+=.5,c+=.5,t.moveTo(s+-1,l+-3),t.lineTo(u+-2,c+-3),t.moveTo(s+-1,l+1),t.lineTo(u+-2,c+1)):(-3,1,0,-1,t.fillRect(s+-3,l+0,o+2*n,c-l-1),s+=.5,u+=.5,t.moveTo(s+-3,l+0),t.lineTo(u+-3,c+-1),t.moveTo(s+1,l+0),t.lineTo(u+1,c+-1)),t.stroke(),t.restore()},t.prototype.lJ=function(t,e,n,o,r,a){var s,l,u,c,f,h=e?D:O,p=i.Im.Km(0,"gc-"+h+"-normal"),d=p&&p.backgroundColor,g=p&&p.backgroundImage;if(!e&&g&&-1!==g.indexOf("linear-gradient"))for(l=i.Ul.wl(g),s=t.createLinearGradient(n,o,r,a),u=0,c=l.length;u<c;u++)f=l[u],s.addColorStop(f.point,f.color);else d&&(s=d);return s},t.prototype.kJ=function(t,e,n,o,r,a){var s=t.createLinearGradient(n,o,r,a),l=e?D:O,u=i.Im.Km(0,"gc-"+l+"-normal");return e?(s.addColorStop(0,u.borderTopColor),s.addColorStop(1,u.borderBottomColor)):(s.addColorStop(0,u.borderLeftColor),s.addColorStop(1,u.borderRightColor)),s},t.prototype.jJ=function(t,e){var n,o,r,i,a,s,l,u,c,f=this.kj.vu();if(e)for(n=e.length,o=0;o<n;o++)i=(r=e[o]).x,a=r.y,s=r.width,l=r.height,0===(c=(u=r.style).type)&&this.hyb(t,i,a,s,l,u),1===c&&this.iyb(t,i,a,s,l,u),2===c&&this.jyb(t,i,a,s,l,u,f)},t.prototype.hyb=function(t,e,n,o,r,i){var a=i.color,s=e-4,l=n-4,u=o+8,c=r+8,f=.5522848,h=u/2*f,p=c/2*f,d=s+u,g=l+c,m=s+u/2,y=l+c/2;t.save(),t.lineWidth=2,t.strokeStyle=a,t.beginPath(),t.moveTo(s,y),t.bezierCurveTo(s,y-p,m-h,l,m,l),t.bezierCurveTo(m+h,l,d,y-p,d,y),t.bezierCurveTo(d,y+p,m+h,g,m,g),t.bezierCurveTo(m-h,g,s,y+p,s,y),t.closePath(),t.stroke(),t.restore()},t.prototype.iyb=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d;e-=.5,n-=.5,h=Math.min(o/2,r/2),p=i.color,d=i.position,t.save(),t.lineWidth=2,t.strokeStyle=p,t.beginPath(),t.rect(e,n,o,r),t.stroke(),t.restore(),t.save(),t.beginPath(),0===d?(l=e,u=(s=n)+h,c=(a=e)+h,f=s):2===d?(l=a=e+o,u=(s=n+r)-h,c=a-h,f=s):3===d?(l=e,u=(s=n+r)-h,c=(a=e)+h,f=s):1===d&&(l=a=e+o,u=(s=n)+h,c=a-h,f=s),t.moveTo(a,s),t.lineTo(l,u),t.lineTo(c,f),t.fillStyle=p,t.fill(),t.closePath(),t.restore()},t.prototype.jyb=function(t,e,n,o,r,i,a){var s,l,u,c,f,h,p;if(e-=.5,n-=.5,s=this.kj.zoom(),15,15,c=i.image,f=i.position,3,h=i.color,t.save(),t.beginPath(),t.lineWidth=2,t.strokeStyle=h,t.rect(e,n,o,r),t.stroke(),c&&"none"!==c&&a){4===f?l=e-18:5===f&&(l=e+o+3);try{a.ko(c)?(p=a.lo(c),u=n+r/2-7.5,t.drawImage(p,l,u,15,15)):a.fo(c)}catch(t){}}else 4===f?l=e-18*s:5===f&&(l=e+o+3*s),u=n+r/2-15*s/2,t.translate(l,u),t.scale(.015*s,.015*s),t.beginPath(),t.moveTo(512,0),t.bezierCurveTo(229.248,0,0,229.184,0,512),t.bezierCurveTo(0,794.816,229.248,1024,512,1024),t.bezierCurveTo(794.752,1024,1024,794.752,1024,512),t.bezierCurveTo(1024,229.24800000000005,794.752,0,512,0),t.closePath(),t.moveTo(783.488,692.992),t.lineTo(692.9920000000001,783.4879999999999),t.lineTo(512,602.496),t.lineTo(331.00800000000004,783.4879999999999),t.lineTo(240.51200000000006,692.992),t.lineTo(421.504,512),t.lineTo(240.512,330.944),t.lineTo(331.008,240.44800000000004),t.lineTo(512,421.44),t.lineTo(692.992,240.384),t.lineTo(783.4879999999999,330.88),t.lineTo(602.496,512),t.lineTo(783.488,692.992),t.closePath(),t.fillStyle=h,t.fill(),t.stroke();t.restore()},t.prototype.SI=function(t,e,n,o,a,s,l){var u,f,h,g,m,y,v,w,T,x,S,A,I,R,k,M,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,Q,J,$,K,tt;for(void 0===s&&(s=0),void 0===l&&(l=0),h=3===n,g=(f=(u=this).kj).zoom(),m=C(u.Bl(),g),y=f.getDefaultStyle(n),v=f.Al(n),w=u.kj.conditionalFormats,T=nt(f),x=f.$q(2),S=f.ar(1),A=a?a.vu():f.vu(),t.save(),t.beginPath(),t.fillStyle=y&&y.foreColor||N,d(t,m.font),t.textAlign=h?"right":"center",k=e.length,U=[],Y={sheet:f,row:-1,col:-1,fontInfo:b,lineHeight:-1,imageLoader:A,conditionalFormats:w,sheetArea:n,parentBackColor:T},I=0;I<k;I++)D=(M=e[I]).data,G=M.tableFilter,O=M.row,j=M.col,F=M.x,P=M.y,_=Z(M),L=X(M),B=M.style,H=M.cellOverflowLayout,z=B.font?C(B.font,g):m,B.font=z.font,_>0&&L>0&&(E=B.cellType||v,F--,P--,_++,L++,h?Y.sparkline=M.sparkline:(V=o?0:u.mJ(O,j,n),Y.visualState=V),W=p(z.font),Y.lineHeight=W,Y.row=O+s,Y.col=j+l,Y.fontInfo=z,Y.cellOverflowLayout=H,Y.needTopGridline=1===n&&O===S||0===n,Y.needLeftGridline=2===n&&j===x||0===n,Y.isPrinting=o,E.jp(t,D,F,P,_,L,B,Y,G),H&&!Y.showBarIconOnly&&(Q=new i.Rect(F,P,_,L),J=E.Ama?E.Ama(t,Q,B,Y):Q,U.push({cellType:E,data:D,x:J.x,y:J.y,width:J.width,height:J.height,style:B,richText:void 0,options:{sheet:f,row:O,col:j,fontInfo:z,lineHeight:W,cellOverflowLayout:H,parentBackColor:T,imageLoader:A}})));if((k=U.length)>0)for($=f.isEditing(),K=f.Jl,tt=f.Kl,R=0;R<k;R++)D=(q=U[R]).data,Y=q.options,$&&Y.row===K&&Y.col===tt||(c(this.kj)&&D&&"SparklineExValue"===D.typeName||u.BWa(t,q));for(t.restore(),k=e.length,I=0;I<k;I++)M=e[I],r.Worksheet.ao(f,"paintCell",{ctx:t,sheetArea:n,cell:M,isPrinting:o})},t.prototype.BWa=function(t,e){var n,o,r=e.cellType,a=e.data,s=e.x,l=e.y,u=Z(e),c=X(e),f=e.style,h=e.options,p=h.cellOverflowLayout;p&&r.uxb&&(n=p.layout,o=new i.Rect(n?n.x:s,n?n.y:l,n?n.width:u,n?n.height:c),r.uxb(t,o,h,a)),r.paintValue&&r.paintValue(t,a,s,l,u,c,f,h)},t.prototype.mJ=function(t,e,n){var o=this.kj,r=0;return et(o)&&(3===n||m(n)?!o.isEditing()&&o.wt(t,e)?r=3:o.vp(t,e,n)&&(r=2):(o.vp(t,e,n)&&(r=1,o.wp(t,e,n)&&(r=2)),o.xt(t,e,n)&&(r=4))),r},t.prototype.hJ=function(t,e,n,o){var r,a,s,l,u,c,f,h,p,d,g,m,y,v,C,w,T,x,S=this.kj,A=S.ss,I=n.length,R=[],k={},M=[],N=function(T){var x,I,N,E,D,O,j,F,P,_,L,B,G,H,V;if(r=n[T],l=r.row,u=r.col,c=r.y,h=X(r),y=e.nJ(l,t),v=y.headingOverflowlayouts,C=y.trailingOverflowLayouts,!k[l]){for(x={},I=0,N=y;I<N.length;I++)E=N[I],x[E.column]=!1;v&&v.forEach((function(t){x[t.column]=!1})),C&&C.forEach((function(t){x[t.column]=!1})),k[l]=x}for(D=k[l],w=y.find(u),O=0;O<w.length;O++)if(j=w[O]){if(F=S.getCellRect(l,j.column,b,b,!0),!D[j.column]){if(P=j.column,(s=A.Ym(l,P)).showEllipsis)continue;a=A.zHb(l,P,3,1,s),f=j.columnWidth,p=j.backgroundWidth,d=j.backgroundLeftWidth<0?F.x:j.backgroundRightWidth<0?F.x+Z(F)-p:F.x+Z(F)/2-j.backgroundLeftWidth,m={data:a,row:l,col:P,x:F.x,y:c,width:f,height:h,cellOverflowLayout:j,style:s},R.push(m),j.layout=new i.Rect(d,c,p,h),s=A.Ym(l,P),o.gF(l,P,j,s,F.x,c,f,h),D[j.column]=!0}j.column===u&&D[j.column]&&M.push(T)}if(v)for(_=0;_<v.length;_++)if((L=v[_])&&!D[L.column]&&L.contains(r.col)){if(u=L.column,(s=A.Ym(l,u)).showEllipsis)continue;a=A.zHb(l,u,3,1,s),f=L.columnWidth,p=L.backgroundWidth,B=S.getCellRect(l,L.endColumn,b,b,!0),d=B.x+Z(B)-p,m={data:a,row:l,col:u,x:d,y:c,width:f,height:h,style:s,cellOverflowLayout:L},R.push(m),L.layout=new i.Rect(d,c,p,h),D[L.column]=!0,o.gF(l,u,L,s,d,c,f,h)}if(C)for(G=0;G<C.length;G++)if((H=C[G])&&!D[H.column]&&H.contains(r.col)){if(u=H.column,(s=A.Ym(l,u)).showEllipsis)continue;a=A.zHb(l,u,3,1,s),f=H.columnWidth,p=H.backgroundWidth,V=S.getCellRect(l,H.startColumn,b,b,!0),d=V.x,g=V.x+p-f,m={data:a,row:l,col:u,x:g,y:c,width:f,height:h,style:s,cellOverflowLayout:H},R.push(m),H.layout=new i.Rect(d,c,p,h),o.gF(l,u,H,s,d,c,f,h),D[H.column]=!0}};for(T=0;T<I;T++)N(T);if(M.length>0)for(x=M.length-1;x>=0;x--)n.splice(M[x],1);return R.length>0&&R.sort((function(t,e){var n=t.row,o=e.row,r=t.col,i=e.col;return n!==o?n-o:r!==i?r-i:void 0})),R},t}(),e.oJ=F,P=".cutCopyIndicator",_=i.Events.CellChanged,L=i.Events.ClipboardChanged,B=i.Events.ValueChanged,G=i.Events.ColumnChanged,H=i.Events.RowChanged,V=i.Events.RangeChanged,z=i.Events.ClipboardPasting,W=i.Events.ClipboardPasted,U=i.Events.DragMerging,q=i.Events.FloatingElementSelected,Y=function(){function t(t){var e=this;e.yJ=!1,e.zJ=!1,e.kj=t,e.AJ()}return t.prototype.jx=function(t){var e=this;return 0===arguments.length?e.zJ:void(e.zJ=t)},t.prototype.BJ=function(t,e){var n,o=this;return 0===arguments.length?o.yJ:void((o.yJ!==t||t||e)&&(o.yJ=t,n=o.kj,n&&(n.$p(),m(o.Lfc)||clearTimeout(o.Lfc),o.Lfc=setTimeout((function(){if(!o.yJ){var t=n.tu();t&&t.hZ(e)}o.Lfc=b})))))},t.prototype.AJ=function(){var t=this,e=t.kj,n=!1;function o(){t.yJ&&t.BJ(!1)}function r(t,e){"resizable"!==t&&t!==e&&"isVisible"!==t&&o()}e.Fu(L+P,(function(){t.BJ(!0)})),e.Fu(B+P,o),e.Fu(_+P,o),e.Fu(G+P,(function(t,e){r(e.propertyName,"width")})),e.Fu(H+P,(function(t,e){r(e.propertyName,"height")})),e.Fu(V+P,o),e.Fu(z+P,(function(){n=t.BJ()})),e.Fu(W+P,(function(e,o){var r,i,a,s=o.cellRange,l=o.sheet.tu(),u=l.n5,c=n;if(s&&u&&l.PA){if(t.jx()){for(i=0,a=u;i<a.length;i++)if(a[i].intersect(s.row,s.col,s.rowCount,s.colCount)){c=!1;break}}else c=!1,r=!0;t.BJ(c,r)}})),e.Fu(U+P,o),e.Fu(q+P,(function(t,n){"worksheet"!==n.type&&(e.endEdit(),i.Vl.kmb(e))}))},t.prototype.UI=function(t,e,n,o){var r,a,s,l,u,c,f,h,p,d,g,y,v;if(this.yJ&&(a=(r=this.kj).yl,l=(s=r.parent)?s.options:{},c=(u=r.tu()).n5,f=l.cutCopyIndicatorVisible,m(f)&&(f=!0),h=i.Rm.Om(r,l.cutCopyIndicatorBorderColor||"blue"),f&&u.PA===r&&c&&(p=a.VI(n,o,b),(d=a.XI(n,o,c,e))&&p))){for(t.save(),t.rect(p.x,p.y,Z(p),X(p)),t.clip(),g=0,y=d;g<y.length;g++)v=y[g],a.fJ(t,v,h);t.beginPath(),t.restore()}},t.prototype.rI=function(){this.BJ(!1)},t.prototype.sI=function(){this.BJ(!1)},t.prototype.tI=function(){this.BJ(!1)},t.prototype.uI=function(){this.BJ(!1)},t.prototype.ky=function(){this.BJ(!1)},t.prototype.no=function(){var t=this.kj;t.Gu(_+P),t.Gu(L+P),t.Gu(B+P),t.Gu(G+P),t.Gu(H+P),t.Gu(V+P),t.Gu(z+P),t.Gu(W+P),t.Gu(U+P),t.Gu(q+P)},t}(),e.CJ=Y,r.Worksheet.$n("render",{init:function(){var t=this;t.yl=new F(t),t.at=new Y(t)},dispose:function(t){var e,n=this;!1!==t.clearCache&&(n.yl&&(n.yl.kj=b,n.yl=b),(e=n.at)&&(e.no(),n.at=b))},onLayoutChanged:function(t){var e,n=this.at;n&&("addRows"===(e=t.changeType)?n.rI():"deleteRows"===e?n.sI():"addColumns"===e?n.tI():"deleteColumns"===e&&n.uI())}})},"./dist/core/worksheet/worksheet-selection.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p;function d(t,e){return t.getColumnCount(e)}function g(t,e){return t.getRowCount(e)}function m(t){return t.rowCount}function y(t){return t.colCount}function v(t,e,n){var o,r,i=[],a=t.length;for(r=0;r<a;r++)o=t[r],r===e?i=i.concat(n):i.push(o);return i}function C(t,e,n){for(var o=n-1;o>=0;o--)if(t.getColumnVisible(e+o))return e+o;return e+n-1}function b(t,e,n){for(var o=n-1;o>=0;o--)if(t.getRowVisible(e+o))return e+o;return e+n-1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/worksheet/worksheet.js"),r=n("./dist/core/util/common.js"),i=n("Common"),a=n("./dist/core/util/domUtil.js"),s=n("./dist/core/core.enum.js"),l=i.Common.j.Fa,u=i.Common.k.ac,c=null,f=Math.max,h=Math.min,p="gc-selection",a.GC$.extend(o.Worksheet.prototype,{addSelection:function(t,e,n,o){var i,a,s=this,l=t,c=e,f=n,h=o;-1!==l&&-1!==c&&((i=s.ITa.getSpans())&&u(i)>0&&(l=(a=s.su(i,r.kf(t,e,n,o))).row,c=a.col,f=m(a),h=y(a))),s.ITa.do("addSelection",l,c,f,h),s.$p()},setSelection:function(t,e,n,o){this.DJ(t,e,n,o,2)},DJ:function(t,e,n,o,i){var a,s,l,u=this,c=g(u),h=d(u);t>=c&&(t=c-1),e>=h&&(e=h-1),a=f(0,t),s=f(0,e),u.Tr(),l=2===i?r.Vl.Wl(u):1===i,u.Kr(a,s,u.Er(a),u.Fr(s),!l),u.addSelection(t,e,n,o)},getSelections:function(){return this.ITa.getSelections()},clearSelection:function(){var t=this;t.Tr(),t.Kr(0,0),o.Worksheet.ao(t,"clearSelection"),t.$p()},Tr:function(){this.ITa.do("clearSelection")},Qs:function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p=this,m=p.options,y=m.protectionOptions,v=!1!==y.allowSelectLockedCells,C=!1!==y.allowSelectUnlockedCells;if(!m.isProtected||v&&C)return!0;if(!v&&!C)return!1;if(r=e<0,i=t<0,v===(o=n?n.locked:p.tq(t,e,"locked"))&&(i||r)){for(a=i?g(p):1,t=i?0:t,s=r?d(p):1,e=r?0:e,l=p.ITa,u=t+a-1,c=e+s-1,f=void 0,h=void 0,f=t;f<=u;f++)for(h=e;h<=c;h++)if((n=l.getStyle(f,h))&&v!==n.locked)return!1;if(i)for(f=t;f<=u;f++)if((n=l.getStyle(f,-1))&&v!==n.locked)return!1;if(r)for(h=e;h<=c;h++)if((n=l.getStyle(-1,h))&&v!==n.locked)return!1}return v===o},SZa:function(t,e,n,o){var r,i;for(e=e<0?0:e,r=t=t<0?0:t;r<t+n;r++)for(i=e;i<e+o;i++)if(this.tq(r,i,"locked"))return!0},ZZa:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].col)return!1;return!0},$Za:function(){var t,e=this.getSelections();for(t=0;t<e.length;t++)if(-1!==e[t].row)return!1;return!0},selectionPolicy:function(t){var e=this,n=e.ITa;return 0===arguments.length?n.getSelectionPolicy():(n.do("setSelectionPolicy",t),e)},selectionUnit:function(t){var e=this,n=e.ITa;return 0===arguments.length?n.getSelectionUnit():(n.do("setSelectionUnit",t),e)},getSelectionBackColor:function(){return this.options.selectionBackColor||r.Im.Lm(p).backgroundColor},getSelectionBorderColor:function(){return this.options.selectionBorderColor||r.Im.Lm(p).borderTopColor},m_a:function(t){return t?void(this.options.m_a=t):this.options.m_a},EJ:function(){var t,e,n=this,o=n.ITa.getSelections();u(o)>0&&(t={selections:o},0!==(e=n.ITa.getActiveSelectedRangeIndex())&&(t.activeSelectedRangeIndex=e),n.FJ=t,n.Tr(),n.yl.im())},GJ:function(){var t=this,e=t.FJ,n=e&&e.selections;n&&(t.ITa.do("setSelections",n),t.ITa.do("setActiveSelectedRangeIndex",e.activeSelectedRangeIndex||0))},Ax:function(t,e,n){var o,r,i,a=this,s=a.HJ(t,e,n,a.Rr||0);s&&(o=s.row,r=s.col,i=s.leadingCellCol,a.IJ(o,r)&&(a.Qr=o,a.Rr=i,a.Jr(o,r)))},HJ:function(t,e,n,o){var r,i,a=this,s=g(a),u=d(a),f=t;return 0===f&&!n||0===s||0===u?c:(i=a.JJ(f,o),n||a.KJ(i),f=i.r,r=i.c,f<0&&n&&(((r=a.br(r))<0||l(r))&&(r=a.br(u)),o=r,f=(i=a.JJ(s,r)).r,(r=i.c)===e&&f<=t)?c:{row:f,col:r,leadingCellCol:o})},Bx:function(t,e,n){var o,r,i,a=this,s=a.LJ(t,e,n,a.Rr||0);!s||s.row===t&&s.col===e||(o=s.row,r=s.col,i=s.leadingCellCol,a.IJ(o,r)&&(a.Qr=o,a.Rr=i,a.Jr(o,r)))},LJ:function(t,e,n,o){var r,i,a=this,s=g(a),u=d(a),c=t;if((c!==s-1||n)&&0!==s&&0!==u&&(i=a.MJ(c,o),n||a.KJ(i),c=i.r,r=i.c,!(c===s&&n&&(r=a.Zq(r),(r>=u||l(r))&&(r=a.Zq(-1)),o=r,i=a.MJ(-1,r),c=i.r,r=i.c,r===e&&c>=t))))return{row:c,col:r,leadingCellCol:o}},Dx:function(){var t,e,n=this,o=n.NJ();o&&(t=o.row,e=o.col,n.Qr=t,n.Rr=e,n.Jr(t,e))},NJ:function(){var t,e,n,o,r=this,i=r.ir(),a=r.dr(),s=a;if(!i&&!s)return c;if(n=!1!==(e=(t=r.options).protectionOptions).allowSelectLockedCells,o=!1!==e.allowSelectUnlockedCells,!t.isProtected||n&&o)return{row:i,col:s};if(!n&&!o)return c;for(;i!==c&&i>=0;i=r.gr(i))for(s=a;s!==c&&s>=0;s=r.br(s))if(n===r.tq(i,s,"locked"))return{row:i,col:s};return c},Cx:function(){var t,e,n=this,o=n.OJ();o&&(t=o.row,e=o.col,n.Qr=t,n.Rr=e,n.Jr(t,e))},OJ:function(){var t,e,n,o,r=this,i=r._q(r.frozenRowCount()-1),a=r.Zq(r.frozenColumnCount()-1),s=a,l=r.ir(),u=r.dr();if(i===c||s===c)return c;if(n=!1!==(e=(t=r.options).protectionOptions).allowSelectLockedCells,o=!1!==e.allowSelectUnlockedCells,!t.isProtected||n&&o)return{row:i,col:s};if(!n&&!o)return c;for(;i!==c&&i<=l;i=r._q(i))for(s=a;s!==c&&s<=u;s=r.Zq(s))if(n===r.tq(i,s,"locked"))return{row:i,col:s};return c},zx:function(t,e,n){var o,r,i,a,s=this,l=s.tables;n?(o=l&&l.bJb(t,e))||(o=s.iy(t,e,n,s.Qr||0)):o=s.iy(t,e,n,s.Qr||0),o&&(r=o.row,i=o.col,a=o.leadingCellRow,s.IJ(r,i)&&(s.Qr=a,s.Rr=i,s.Jr(r,i)))},iy:function(t,e,n,o){var r,i,a,s=this,u=g(s),f=d(s),h=e;if(0===h&&!n||0===u||0===f)return c;for(i=s.PJ(o,h),a=o,n||s.KJ(i),r=i.r,h=i.c;h<0&&n;){if(((r=s.gr(r,3,!0))<0||l(r))&&(r=s.gr(u,3,!0)),o=r,r=(i=s.PJ(o,f)).r,h=i.c,r===t&&h<e)return c;if(r===t&&h===e){if(o===a)return c;r=(i=s.PJ(o,h)).r,h=i.c}}return{row:r,col:h,leadingCellRow:o}},KJ:function(t){var e,n=this,o=!1;t.r<0?t.r=n.ar():t.r>=g(n)&&(t.r=n.ir(),o=!0),t.c<0?t.c=n.$q():t.c>=d(n)&&(t.c=n.dr(),o=!0),o&&((e=n.ITa.getSpan(t.r,t.c)).row!==t.r&&(t.r=e.row),e.col!==t.c&&(t.c=e.col))},Fx:function(t,e){for(var n,o,r=this,i=r.ITa,a=i.getActiveSelectedRangeIndex(),s=-1,l=r.Tq(r.Ix()),u=l.row,c=l.col,f=l.col+y(l)-1,h=t,p=e;h=(n=r.QJ(h,p)).r,!((p=n.c)>=c);){if(s===a&&h===t&&p<=e)return;--h>=u?p=f+1:(o=r.Tq(r.Ix(3)),s=i.getActiveSelectedRangeIndex(),u=o.row,c=o.col,f=o.col+y(o)-1,h=o.row+m(o)-1,p=o.col+y(o))}h>=0&&(r.Jr(h,p),r.Qr=h,r.Rr=p)},Gx:function(t,e){for(var n,o,r=this,i=r.ITa,a=i.getActiveSelectedRangeIndex(),s=-1,l=r.Tq(r.Ix()),u=l.col,c=l.row+m(l)-1,f=l.col+y(l)-1,h=t,p=e;h=(n=r.RJ(h,p)).r,!((p=n.c)<=f);){if(s===a&&h===t&&p>=e)return;++h<=c?p=u-1:(o=r.Tq(r.Ix(4)),s=i.getActiveSelectedRangeIndex(),u=o.col,c=o.row+m(o)-1,f=o.col+y(o)-1,h=o.row,p=o.col-1)}h>=0&&(r.Jr(h,p),r.Qr=h,r.Rr=p)},Rs:function(t,e,n){var o,r,i,a,s=this,l=s.tables;n?(o=l&&l.cJb(t,e))||(o=s.hy(t,e,n,s.Qr||0)):o=s.hy(t,e,n,s.Qr||0),!o||o.row===t&&o.col===e||(r=o.row,i=o.col,a=o.leadingCellRow,s.IJ(r,i)&&(s.Qr=a,s.Rr=i,s.Jr(r,i)))},hy:function(t,e,n,o){var r,i,a,s=this,u=g(s),f=d(s),h=e;if(h===f-1&&!n||0===u||0===f)return c;for(i=s.SJ(o,h),a=o,n||s.KJ(i),r=i.r,h=i.c;h===f&&n;){if(!(t!==u-1||t!==r||s.getRowVisible(r,3)&&s.Sl(r,3)>0))return c;if(((r=s._q(r,3,!0))>=u||l(r))&&(r=s._q(-1,3,!0)),o=r,r=(i=s.SJ(o,-1)).r,h=i.c,r===t&&h>e)return c;if(r===t&&h===e){if(o===a)return c;r=(i=s.SJ(o,h)).r,h=i.c}}return{row:r,col:h,leadingCellRow:o}},PJ:function(t,e){for(var n,o,i,a=e;a>=0&&(n=t,!(--a<0));)if((o=this.ITa.getSpans(r.kf(n,a,1,1)))&&u(o)>0&&(a>=(i=o[0]).col&&(a=i.col,n=i.row)),this.IJ(n,a))return{r:n,c:a};return{r:n,c:a}},QJ:function(t,e){for(var n,o,r=this;e>=0&&!(--e<0);){if(n=r.ITa.findSpan(t,e)){if(!((o=r.Ix()).row<=n.row&&n.row+m(n)<=o.row+m(o)&&o.col<=n.col&&n.col+y(n)<=o.col+y(o)))continue;if(n.row!==t||n.col!==e)continue;e>=n.col&&(e=n.col,t=n.row)}if(r.IJ(t,e))return{r:t,c:e}}return{r:t,c:e}},SJ:function(t,e){for(var n,o,i,a,s=this,l=d(s),c=e;c<l&&(n=t,!((c=(o=s.ITa.getSpan(n,c)).col+y(o))>=l));)if((i=s.ITa.getSpans(r.kf(n,c,1,1)))&&u(i)>0&&(c>(a=i[0]).col?c=f(c,a.col+y(a)):n=a.row),s.IJ(n,c))return{r:n,c:c};return{r:n,c:c}},RJ:function(t,e){for(var n,o,r,i=this,a=i.ITa,s=d(i);e<s&&!((e=(n=a.getSpan(t,e)).col+y(n))>=s);){if(o=a.findSpan(t,e)){if(!((r=i.Ix()).row<=o.row&&o.row+m(o)<=r.row+m(r)&&r.col<=o.col&&o.col+y(o)<=r.col+y(r)))continue;if(o.row!==t||o.col!==e)continue;e>o.col?e=f(e,o.col+y(o)):t=o.row}if(i.IJ(t,e))return{r:t,c:e}}return{r:t,c:e}},IJ:function(t,e){var n,o,r=this;return!!r.Qs(t,e)&&(n=t>=0&&t<g(r)&&e>=0&&e<d(r)&&r.getRowVisible(t)&&r.getColumnVisible(e)&&r.Sl(t)>0&&r.Tl(e)>0,o=!!r.Tx,!0===n&&!0===o&&(!1===r.tq(t,e,"tabStop")&&(n=!1)),n)},JJ:function(t,e){for(var n,o;t>=0&&!(--t<0);)if((n=this.ITa.getSpans(r.kf(t,e,1,1)))&&u(n)>0&&(t>=(o=n[0]).row&&(t=o.row,e=o.col)),this.IJ(t,e))return{r:t,c:e};return{r:t,c:e}},MJ:function(t,e){for(var n,o,i,a=this,s=g(a);t<s&&!((t=(n=a.ITa.getSpan(t,e)).row+m(n))>=s);)if((o=a.ITa.getSpans(r.kf(t,e,1,1)))&&u(o)>0&&(t>(i=o[0]).row?t=f(t,i.row+m(i)):e=i.col),a.IJ(t,e))return{r:t,c:e};return{r:t,c:e}},Ur:function(t,e,n,o,r){var i=this;i.ITa.do("addSelection",t,e,n,o),r&&i.Xq<=0&&i.yl.im()},aH:function(t,e,n){var o=this,r=o.Jx(t,e,o.Jl,o.Kl),i=r.row,a=r.col,s=m(r),l=y(r),u=o.selectionPolicy(),c=o.selectionUnit();0!==u&&(1===u&&o.ITa.do("clearSelection"),1===c?(a=-1,l=-1):2===c&&(i=-1,s=-1),o.Kx(i,a,s,l,n))},Jx:function(t,e,n,o,i){var a,s,c,f,h,p=this;return l(n)&&(n=p.Jl),l(o)&&(o=p.Kl),s=(a=p.ITa).getSpan(n,o),c=a.getSpan(t,e),i&&s.equals(c)?new r.Range(s.row,s.col,1,1):(f=s.union(c),(h=p.ITa.getSpans())&&u(h)>0&&(f=p.TJ(h,f)),f)},Kx:function(t,e,n,o,i){var a,s,l,c,f,h,p=this,d=p.ITa,g=p.Ix();if(u(d.getSelections())>0?(s=r.kf(t,e,n,o),p.n_a?(a=p.p_a,p.p_a=s):((l=d.getSelections())[d.getActiveSelectedRangeIndex()]=s,d.do("setSelections",l))):p.n_a||d.do("addSelection",t,e,n,o),i&&p.Xq<=0){if(c=p.Ix(),!p.n_a&&c.row===g.row&&c.col===g.col&&m(c)===m(g)&&y(c)===y(g))return;f=p.yl,p.n_a&&(h=p.p_a,a&&a.containsRange(h)?h=a:a&&(h=a.union(h)),g=(h=h.union(r.kf(p.getActiveRowIndex(),p.getActiveColumnIndex(),1,1))).union(g),c=h.union(c)),g.containsRange(c)?f.im(g):c.containsRange(g)?f.im(c):(f.im(g),f.im(c),f.im(p.p_a))}},kyb:function(t){var e=[];return t&&(e=this.ITa.getSpans(t)),e},lyb:function(t,e){var n,o=t.row,r=t.col,i=t.rowCount,a=t.colCount,s=e.row,l=e.col,u=e.rowCount,c=e.colCount,f=o+i,h=r+a,p=s+u,d=l+c,g=!1,m=!1;return t.intersect(s,l,u,c)&&(g=n=o>s||r>l||f<p||h<d,m=!n),e.myb=e.myb||m,g},nyb:function(t,e,n,o){var r,i=[],a=[];for(r=0;r<t.length;r++)a=this.oyb(t[r],e,n,o),i=i.concat(a);return i},oyb:function(t,e,n,o){var r,i,a,s,l,u=[],c=e.length;for(u.push(t),s=c-1;s>=0;s--)for(i=e[s],l=0;l<u.length;)r=u[l],this.lyb(r,i)?(u=v(u,l,a=this.v_a(r,i,n,o)),l+=a.length):l++;return u},pyb:function(t,e){var n=e.row,o=e.col,r=e.rowCount,i=e.colCount;return t.intersect(n,o,r,i)},qyb:function(t,e){var n,o,r=[];for(o=t.length-1;o>=0;o--)n=t[o],this.pyb(n,e)||r.push(n);return r},ryb:function(t){var e=!1,n=this.ITa.getSpans(t);return 1===n.length&&(e=t.equals(n[0])),e},syb:function(t,e){var n,o,r,i=t,a=e.length,s=i.length,l=!0;for(o=a-1;o>=0;o--){for(n=e[o],r=s-1;r>=0;r--)if(i[r].equals(n)){l=!1;break}l&&i.push(n)}return i},tyb:function(t){var e,n,o,r,i=[];for(n=t.length-1;n>=0;n--)(e=t[n]).myb&&(delete e.myb,i.push(n));for(o=i.length,r=0;r<o;r++)t.splice(i[r],1)},v_a:function(t,e,n,o){var i,a,s,l,u,c,f,h,p,d,g,m,y;return e=this.Tq(e),i=[],a=t.getIntersect(e,n,o),t&&a?(s=t.row>=0?t.row:0,l=t.col>=0?t.col:0,u=t.rowCount,c=t.colCount,f=a.row,h=a.col,p=a.rowCount,g=l+c,y=h+a.colCount,(d=s+u)-(m=f+p)>0&&i.push(r.kf(m,l,d-m,c)),g-y>0&&i.push(r.kf(f,y,p,g-y)),h-l>0&&i.push(r.kf(f,l,p,h-l)),f-s>0&&i.push(r.kf(s,l,f-s,c))):i.push(t),i},u_a:function(t,e){var n,o,r,i,a,s,l,c,f,h,p=[],d=this.getRowCount(3),g=this.getColumnCount(3),m=this.deselectIgnoreSpan();if(t&&t.length>0){for(o=[],r=[],i=[],a=void 0,s=void 0,n=!1,l=t.length-1;l>=0;l--)a=t[l],m||!this.ryb(a)||this.pyb(a,e)?(o=this.v_a(a,e,d,g),m||(s=this.kyb(a)).length>0&&(o=this.nyb(o,s,d,g),i=this.qyb(s,e),r=this.syb(r,i),this.tyb(r)),c=u(o),!n&&c>0&&(this.setSelection(o[c-1].row,o[c-1].col,1,1),n=!0),p=o.concat(p)):r=this.syb(r,[a]);m||(p=r.concat(p))}for(this.Tr(),f=p.length,this.suspendPaint(),h=0;h<f;h++)this.addSelection(p[h].row,p[h].col,p[h].rowCount,p[h].colCount);n||this.setActiveCell(this.Jl,this.Kl),this.resumePaint()},Sx:function(t,e){var n,o,r,i,a,s,l,c,f,h=this,p=h.ITa.getSelections();if(!(u(p)<=0)&&(n=h.Ix(),o=h.UJ(n,t,e))){if(r=o.row,i=o.col,a=m(o),s=y(o),l=h.selectionPolicy(),c=h.selectionUnit(),0===l)return;1===l&&h.ITa.do("clearSelection"),1===c?(i=-1,s=-1):2===c&&(r=-1,a=-1),h.Kx(r,i,a,s,!0),f=h.ITa.getSelections(),h.mm.zu(p,f)&&(h.yu(p,f),h.Au(p))}},UJ:function(t,e,n,o,r){var i=this,a=i.Tq(t),s=c;return 37===e?s=n?i.VJ(a,!1,o,r):i.WJ(a,o,r):39===e?s=n?i.XJ(a,!1,o,r):i.YJ(a,o,r):38===e?s=n?i.ZJ(a,!1,o,r):i.$J(a,o,r):40===e?s=n?i._J(a,!1,o,r):i.aK(a,o,r):36===e?s=n?i.bK(a,o,r):i.cK(a,o,r):35===e?s=n?i.dK(a,o,r):i.eK(a,o,r):33===e?s=i.fK(a,o,r):34===e&&(s=i.gK(a,o,r)),s&&(t.row<0&&(s.row=-1,s.rowCount=i.getRowCount()),t.col<0&&(s.col=-1,s.colCount=i.getColumnCount())),s},WJ:function(t,e,n){for(var o,i,a,s,l,u,p,d,g=this,v=t.row,C=t.col,w=m(t),T=y(t),x=C+T-1,S=b(g,v,w);x>0;)if(x--,g.IJ(S,x)&&(o=g.Jx(S,x,e,n),i=h(v,o.row),a=h(C,o.col),l=f(v+w-1,o.row+m(o)-1)-i+1,u=(s=h(C+T-1,o.col+y(o)-1))-a+1,i!==v||a!==C||l!==w||u!==T))return p=g.qq,C<(d=g.Kl)?a<=p&&g.rq(a):C===d&&s<=p&&g.rq(s),g.parent&&g.parent.options.scrollByPixel&&a===p&&0!==g.eCb&&g.rq(a,0),r.kf(i,a,l,u);return c},VJ:function(t,e,n,o){var i,a,s,u,c,p=this,d=t.row,g=t.col,v=p.frozenColumnCount(),C=v?p.Zq(v-1):p.$q(),b=e?C:p.$q();if(!l(b))return(v<=0||e)&&p.rq(b),i=p.Jx(d,b,n,o),a=h(d,i.row),s=h(g,i.col),u=f(d+m(t)-1,i.row+m(i)-1)-a+1,c=h(g+y(t)-1,i.col+y(i)-1)-s+1,r.kf(a,s,u,c)},lCb:function(t){var e,n,o,r,i,a=this;if(a.parent&&a.parent.options.scrollByPixel){for(o=a.ss,r=a.Fr(t),i=a.getViewportWidth(r);0<=t&&!((i-=o._m(t))<0);t--);e=t,n=i}else e=a.ks(t,2),n=0;return{dj:e,UP:n}},YJ:function(t,e,n){for(var o,i,a,s,l,u,p,g,v,C=this,w=t.row,T=t.col,x=m(t),S=y(t),A=T,I=d(C)-1,R=b(C,w,x);A<I;)if(A++,C.IJ(R,A)&&(o=C.Jx(R,A,e,n),i=h(w,o.row),a=f(T,o.col),l=f(w+x-1,o.row+m(o)-1)-i+1,u=(s=f(T+S-1,o.col+y(o)-1))-a+1,i!==w||a!==T||l!==x||u!==S))return p=C.Aw(),T<(g=C.Kl)?a>=p&&(v=C.lCb(a),C.rq(v.dj,v.UP)):T===g&&s>=p&&(v=C.lCb(s),C.rq(v.dj,v.UP)),r.kf(i,a,l,u);return c},XJ:function(t,e,n,o){var i,a,s,u,c,p,d=this,g=t.row,v=t.col,C=d.lr();if(!l(C))return d.rq(C),i=d.dr(),e||(i+=d.frozenTrailingColumnCount()),a=d.Jx(g,i,n,o),s=h(g,a.row),u=f(v,a.col),c=f(g+m(t)-1,a.row+m(a)-1)-s+1,p=f(v+y(t)-1,a.col+y(a)-1)-u+1,r.kf(s,u,c,p)},$J:function(t,e,n){for(var o,i,a,s,l,u,p,d,g=this,v=t.row,b=t.col,w=m(t),T=y(t),x=v+w-1,S=C(g,b,T);x>0;)if(x--,g.IJ(x,S)&&(o=g.Jx(x,S,e,n),i=h(v,o.row),a=h(b,o.col),l=(s=h(v+w-1,o.row+m(o)-1))-i+1,u=f(b+T-1,o.col+y(o)-1)-a+1,i!==v||a!==b||l!==w||u!==T))return p=g.lq,v<(d=g.Jl)?i<=p&&g.mq(i):v===d&&s<=p&&g.mq(s),g.parent&&g.parent.options.scrollByPixel&&i===p&&0!==g.cCb&&g.mq(i,0),r.kf(i,a,l,u);return c},ZJ:function(t,e,n,o){var i,a,s,u,c,p=this,d=t.row,g=t.col,v=p.frozenRowCount(),C=v?p._q(v-1):p.ar(),b=e?C:p.ar();if(!l(b))return(v<=0||e)&&p.mq(b),i=p.Jx(b,g,n,o),a=h(d,i.row),s=h(g,i.col),u=h(d+m(t)-1,i.row+m(i)-1)-a+1,c=f(g+y(t)-1,i.col+y(i)-1)-s+1,r.kf(a,s,u,c)},mCb:function(t){var e,n,o,r,i,a=this;if(a.parent&&a.parent.options.scrollByPixel){for(o=a.ss,r=a.Er(t),i=a.getViewportHeight(r);0<=t&&!((i-=o.Sl(t))<0);t--);e=t,n=i}else e=a.ms(t,2),n=0;return{cj:e,UP:n}},aK:function(t,e,n){for(var o,i,a,s,l,u,p,d,v,b=this,w=t.row,T=t.col,x=m(t),S=y(t),A=w,I=g(b)-1,R=C(b,T,S);A<I;)if(A++,b.IJ(A,R)&&(o=b.Jx(A,R,e,n),i=f(w,o.row),a=h(T,o.col),l=(s=f(w+x-1,o.row+m(o)-1))-i+1,u=f(T+S-1,o.col+y(o)-1)-a+1,i!==w||a!==T||l!==x||u!==S))return p=b.Fw(),w<(d=b.Jl)?i>=p&&(v=b.mCb(i),b.mq(v.cj,v.UP)):w===d&&s>=p&&(v=b.mCb(s),b.mq(v.cj,v.UP)),r.kf(i,a,l,u);return c},_J:function(t,e,n,o){var i,a,s,u,c,p,d=this,g=t.row,v=t.col,C=d.kr();if(!l(C))return d.mq(C),i=d.ir(),e||(i+=d.frozenTrailingRowCount()),a=d.Jx(i,v,n,o),s=f(g,a.row),u=h(v,a.col),c=f(g+m(t)-1,a.row+m(a)-1)-s+1,p=f(v+y(t)-1,a.col+y(a)-1)-u+1,r.kf(s,u,c,p)},cK:function(t,e,n){for(var o,i,a,s,l,u=this,p=t.row,d=t.col,g=m(t),v=y(t),C=u.frozenColumnCount()-1,b=u.Kl,w=p+g-1;C<b;)if(C++,u.IJ(w,C)){if(d<=C&&d+v-1===u.Kl)break;return o=u.Jx(w,C,e,n),i=h(p,o.row),a=h(d,o.col),s=f(p+g-1,o.row+m(o)-1)-i+1,l=h(d+v-1,o.col+y(o)-1)-a+1,u.rq(u.$q()),r.kf(i,a,s,l)}return c},bK:function(t,e,n){return t=this.VJ(t,!0,e,n),this.ZJ(t,!0,e,n)},eK:function(t,e,n){for(var o,i,a,s,l,u=this,p=t.row,g=t.col,v=m(t),C=y(t),b=d(u),w=u.Kl,T=p+v-1;b>w;)if(b--,u.IJ(T,b)){if(g+C-1>=b&&g===u.Kl)break;return o=u.Jx(T,b,e,n),i=h(p,o.row),a=f(g,o.col),s=f(p+v-1,o.row+m(o)-1)-i+1,l=f(g+C-1,o.col+y(o)-1)-a+1,u.rq(u.lr()),r.kf(i,a,s,l)}return c},dK:function(t,e,n){return t=this.XJ(t,!0,e,n),this._J(t,!0,e,n)},fK:function(t,e,n){var o,i,a,s,p,d,g,v=this,C=t.row,b=t.col,w=m(t),T=v.Ew();return l(T)?c:(o=v.Gr(1),i=-1,v.mq(T)?i=v._q(C+w-1-u(o)):v.frozenRowCount()<=0&&(i=v.ar()),i<v.lq?i=v.lq:i>=v.Fw()&&(i=v.gr(v.Fw())),a=v.Jx(i,b,e,n),s=h(C,a.row),p=h(b,a.col),d=h(C+w-1,a.row+m(a)-1)-s+1,g=f(b+y(t)-1,a.col+y(a)-1)-p+1,r.kf(s,p,d,g))},gK:function(t,e,n){var o,i,a,s,p,d,g,v=this,C=t.row,b=t.col,w=m(t),T=v.$x();return l(T)?c:(o=v.Gr(1),v.mq(T),(i=v.gr(C+w-1+u(o)))<v.lq?i=v.lq:i>=v.Fw()&&(i=v.lq>=v.kr()?v.Fw():v.gr(v.Fw())),a=v.Jx(i,b,e,n),s=f(C,a.row),p=h(b,a.col),d=f(C+w-1,a.row+m(a)-1)-s+1,g=f(b+y(t)-1,a.col+y(a)-1)-p+1,r.kf(s,p,d,g))},Ew:function(){var t,e,n,o,r,i=this,a=i.Gr(1);if(!a||u(a)<=0)return c;for(e=(t=i.frozenRowCount())?i._q(t-1):i.ar(),n=0,o=i.lq,r=i.am();o>e&&(o--,!((n+=i.Sl(o))>r.jr)););return o},zw:function(){var t,e,n,o,r,i=this,a=i.Hr(1);if(!a||u(a)<=0)return c;for(e=(t=i.frozenColumnCount())?i.Zq(t-1):i.$q(),n=0,o=i.qq,r=i.am();o>e&&(o--,!((n+=i.Tl(o))>r.er)););return o},$x:function(){var t,e=this.Gr(1),n=u(e);return e&&n>0?(t=e[n-1].row,this.ir()<=t?this.lq:t):c},kr:function(){var t,e,n,o,r,i,a=this;if(a.ir()===a.Fw()&&(t=a.am(),e=a.Gr(1),n=u(e),e&&n>=1&&(o=e[n-1]).y+o.height<=t.qt+t.jr))return a.lq;r=a.lq;try{return a.lq=a.ir(),i=a.Ew(),i=a._q(i)}catch(t){}finally{a.lq=r}},lr:function(){var t,e,n,o,r,i,a=this;if(a.dr()===a.Aw()&&(t=a.am(),e=a.Hr(1),n=u(e),e&&n>=1&&(o=e[n-1]).x+o.width<=t.pt+t.width))return a.qq;for(t=a.am(),r=0,i=a.dr();i>0&&!((r+=a.Tl(i))>t.er);)i--;return i>0&&(i=a.Zq(i)),i},Fw:function(){var t=this.Gr(1),e=u(t);return t&&e>0?t[e-1].row:c},Aw:function(){var t=this.Hr(1),e=u(t);return t&&e>0?t[e-1].col:c},hr:function(){var t,e,n=this.Gr(1),o=u(n);return n&&o>0?(t=this.am(),n[e=o-1].y+n[e].height<=t.qt+t.jr?n[e].row:n[f(e-1,0)].row):c},cr:function(){var t,e,n=this.Hr(1),o=u(n);return n&&o>0?(t=this.am(),n[e=o-1].x+n[e].width<=t.pt+t.er?n[e].col:n[f(e-1,0)].col):c},ir:function(t){l(t)&&(t=3);var e=g(this,t);return 3!==t&&2!==t||(e-=this.frozenTrailingRowCount()),this.gr(e,t)},dr:function(t){l(t)&&(t=3);var e=d(this,t);return 3!==t&&1!==t||(e-=this.frozenTrailingColumnCount()),this.br(e,t)},TJ:function(t,e){var n,o,r;if(t)for(n=0,o=u(t);n<o;n++)if(r=t[n],e.intersect(r.row,r.col,m(r),y(r)))return t.splice(n,1),n--,this.TJ(t,e.union(r));return e},Ix:function(t){var e,n=this.ITa,o=u(n.getSelections()),i=r.kf(-1,-1,0,0);return o<=0||(e=n.getActiveSelectedRangeIndex(),3===t?(--e<0&&(e=o-1),n.do("setActiveSelectedRangeIndex",e)):4===t&&(++e>=o&&(e=0),n.do("setActiveSelectedRangeIndex",e)),(e=n.getActiveSelectedRangeIndex())>=0&&(i=n.getSelections()[e])),i}}),o.Worksheet.$n("selection",{init:function(){this.ITa.do("addSelection",0,0,1,1),this.ITa.setCellState(0,0,s.CellStatesType.active,!0,s.SheetArea.viewport)}})},"./dist/core/worksheet/worksheet-sort.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function C(t,e,n){for(var o=t[n-e];o<n;)o=t[o-e];return o}function b(t){return"object"==typeof t?JSON.stringify(t):o.Common.pc.bc(o.Common.pc.ec(t))}function w(t,e){return t instanceof Date&&e instanceof Date?h(t)===h(e):typeof t===m&&typeof e===m?t.toLowerCase()===e.toLowerCase():t===e}function T(t,e,n,o){var r,i;return d(t)||(r=o?t.backColor:t.foreColor,d(r)||(r=b(r))),d(e)||(i=o?e.backColor:e.foreColor,d(i)||(i=b(i))),(r=r||"")===(i=i||"")?0:r===n?1:i===n?-1:0}function x(t,e){var n,o,r,i,a;return t instanceof Date&&(t=h(t)),e instanceof Date&&(e=h(e)),r=(n=typeof t)===m,i=(o=typeof e)===m,a=o===y,n===o||n!==y&&!a?!(n!==g||!i)||(!r||o!==g)&&(r&&i?t.toLowerCase()>e.toLowerCase():t>e):a}function S(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,g,m,v,C,b=r,S=t,A=e;if(b)for(s=0;s<b.length&&(b[s]&&(l=b[s].ascending,0<=(u=b[s].index)&&(c=void 0,f=void 0,h=o?S:u,p=o?u:S,g=o?A:u,m=o?u:A,i?(c=i[h][p],f=i[g][m]):(c=n.getValue(h,p),f=n.getValue(g,m)),b[s].compareFunction?(a=b[s].compareFunction(c,f),l||(a*=-1)):d(b[s].color)?(v=d(c)||""===c||typeof c===y&&isNaN(c),C=d(f)||""===f||typeof f===y&&isNaN(f),v||C?v&&C?a=0:v&&!C?a=1:!v&&C&&(a=-1):a=w(c,f)?0:x(c,f)?l?1:-1:l?-1:1):(void 0,void 0,a=T(n.getActualStyle(h,p,3,!1,!1,!0),n.getActualStyle(g,m,3,!1,!1,!0),b[s].color,b[s].isBackColor),l||(a*=-1)))),0===a);s++);return a}function A(t,e,n,o,r){var i,a,s,l,u,c,f,h=t.length;if(h<=1)return t;for(a=t[i=Math.floor(h/2)],s=[],l=[],u=[],c=0;c<h;c++)i!==c?(f=S(t[c],a,e,n,o,r))<0?s.push(t[c]):f>0?l.push(t[c]):u.push(t[c]):u.push(t[c]);return A(s,e,n,o,r).concat(u,A(l,e,n,o,r))}function I(t,e,n,o,r,i,a){var s,l,u=e?t.rowOutlines:t.columnOutlines,c=[],f=[];if(e){for(s=i;s<i+a;s++)t.Ps(s)||t.rowOutlines&&t.rowOutlines.isCollapsed(s)||(t.getRowVisible(s,3,!0)?0===t.getRowHeight(s)&&(c.push(s),t.setRowHeight(s,t.defaults.rowHeight)):(f.push(s),t.setRowVisible(s,!0)));for(u.nec(n.groupSwap,n.array,r.start),s=0;s<f.length;s++)l=p.Cb(o,f[s])+i,t.setRowVisible(l,!1);for(s=0;s<c.length;s++)l=p.Cb(o,c[s])+i,t.setRowHeight(l,0)}else{for(s=i;s<i+a;s++)t.columnOutlines&&t.columnOutlines.isCollapsed(s)||(t.getColumnVisible(s,3)?0===t.getColumnWidth(s)&&(c.push(s),t.setColumnWidth(s,t.defaults.colWidth)):(f.push(s),t.setColumnVisible(s,!0)));for(u.nec(n.groupSwap,n.array,r.start),s=0;s<f.length;s++)l=p.Cb(o,f[s])+i,t.setColumnVisible(l,!1);for(s=0;s<c.length;s++)l=p.Cb(o,c[s])+i,t.setColumnWidth(l,0)}}function R(t,e,n){var o=t.qg(e,n,!1);o&&o.hasListeners()&&o.Yg()}function k(t,e,o,r){var i,a,s=n("SheetsCalc");s&&(i=s.CalcOperatorAdjustor.zj(t.xf,t.xf,t.Kf(e,o),e,o,0,0),t.Rf(e,o,i,r),(a=t.qg(e,o,!!i))&&a.og())}function M(t,e,n,o,r,i,a,s,l,u,c,f){var h,p,d,g,m,y,v,b,w,T,x,S=t.ITa,A=S.Ky,I=A&&A.sV.length>0,M=i?e:n,N=i?e+o:n+r,E=i?n:e,D=i?n+r:e+o;for(T=M;T<N;T++)if(T!==(w=C(s,M,T)))for(i?(h=T,d=w):(p=T,g=w),x=E;x<D;x++)i?(p=x,g=x):(h=x,d=x),a&&(m=l[h][p],y=l[d][g]),I&&(v=A.get(h,p),b=A.get(d,g)),c&&f&&(R(c,h,p),R(c,d,g),c._f(h,p,d,g),k(c,h,p),k(c,d,g)),S.do("swapNode",h,p,d,g),t.uja&&t.wja(h,p,d,g),I&&A.qUa(v,h,p,b,d,g),a&&(l[h][p]=y,l[d][g]=m),u.push({row:h,col:p}),u.push({row:d,col:g})}function N(t,e,n,o,r,i,s,u,c,f,h){var p,d,g,m,y,C,b,w=[],T=t.ITa.WTa;if(T>0&&e&&(t.ITa.WTa=0,[].push.apply(t.ITa.zTa,[{row:n,column:o,rowCount:r,columnCount:i,byRows:s,sortInfo:u,type:"sortRange",array:f.concat([])}])),p=l&&t.Bj(),d=l&&t.yj(),M(t,n,o,r,i,s,c,f,h,w,p,d),c)for(g=n;g<n+r;g++)for(m=o;m<o+i;m++)t.setValue(g,m,h[g][m]);if(p){for(y=n;y<n+r;y++)for(C=o;C<o+i;C++)(b=p.Kf(y,C))&&p.fg(y,C,b,v);t.getCalcService().recalcRange(d,n,o,r,i)}return a.Worksheet.ao(t,"sortRangeChanged",{column:o,columnCount:i}),T>0&&(t.ITa.WTa=T),w}function E(t,e,n,o,r,i,a,s,u,c){var f,h,p,d,g,m;t.suspendPaint(),t.suspendEvent(),l&&t.suspendCalcService();try{if(c)for(h=[],p=e;p<e+o;p++)for(h[p]=[],d=n;d<n+r;d++)h[p][d]=t.getValue(p,d);return g=void 0,m=void 0,u?g=u:0===s.groupSort?g=(m=function(t,e,n,o,r,i,a,s,l){var u,c,f,h,p,d=i?o:r,g=i?e:n,m=[];for(u=0;u<d;u++)m[u]=g+u;for(c=s.ignoreHidden?function(t,e,n){var o,r,i=[];if(e)for(o=n.length-1;o>=0;o--)r=n[o],0===t.getRowHeight(r)&&(n.splice(o,1),i.push({mi:o,Qb:r}));else for(o=n.length-1;o>=0;o--)r=n[o],0===t.getColumnWidth(r)&&(n.splice(o,1),i.push({mi:o,Qb:r}));return i}(t,i,m):[],f=m.concat([]),h=!1,m=A(m,t,i,a,l),p=0;p<m.length;p++)if(m[p]!==f[p]){h=!0;break}return function(t,e){var n,o;for(n=t.length-1;n>=0;n--)o=t[n],e.splice(o.mi,0,o.Qb)}(c,m),{array:m,isChanged:h}}(t,e,n,o,r,i,a,s,h)).array:(m=function(t,e,n,o,r,i,a,s,l){var u,c,f,h,p=i?o:r,d=i?e:n,g=i?t.rowOutlines:t.columnOutlines,m=g.kec(d,p),y=g.lec(m,s.groupSort);if(!y){for(u=[],c=0;c<p;c++)u.push(d+c);y=[u]}for(c=0;c<y.length;c++)y[c]=A(y[c],t,i,a,l);return h=(f=g.mec(y,m,s.groupSort)).array,f.isChanged&&I(t,i,f,h,m,d,p),{array:h,isChanged:f.isChanged}}(t,e,n,o,r,i,a,s,h),g=m.array),!!g&&(f=N(t,m&&m.isChanged,e,n,o,r,i,a,c,g,h),!0)}finally{l&&t.resumeCalcService(!1),t.resumeEvent(),t.resumePaint(),t.Bu(e,n,o,r,f,4,v,v,v,!!u)}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/core/util/domUtil.js"),i=n("./dist/core/util/common.js"),a=n("./dist/core/worksheet/worksheet.js"),s=n("@grapecity/js-calc"),l=!!s,u=n("./dist/core/core.ns.js"),c=new o.Common.ResourceManager(u.SR),f=c.getResource.bind(c),h=o.Common.l.Ra,p=o.Common.k,d=o.Common.j.Fa,g="boolean",m="string",y="number",v=void 0,r.GC$.extend(a.Worksheet.prototype,{sortRange:function(t,e,n,o,r,a,s,u,c){var h,p,d,g,m,y,v,C,b,w,T=this,x=T.getRowCount(),S=T.getColumnCount();if(-1===t&&(t=0),-1===n&&(n=x),-1===e&&(e=0),-1===o&&(o=S),t<0||t>=x||e<0||e>=S||n<0||t+n>x||o<0||e+o>S||!a)return!1;if(s=T.oec(i.kf(t,e,n,o),r,s),h=r?n:o,p=r?t:e,d=r?T.rowOutlines:T.columnOutlines,!u&&s.groupSort>0){if(!d)return!1;g=d.kec(p,h),r?(n=g.count,t=g.start):(o=g.count,e=g.start)}return l&&!T.Vq(t,e,n,o,!1)?(c&&T.Os(7,f().Exp_InvalidSortArrayFormulaInRange),!1):(m=T.ITa.getSpans(i.kf(t,e,n,o)))&&m.length>0?(c&&T.Os(7,f().Exp_InvalidSortSpanInRange),!1):!(y=T.tables)||(C=1===(v=y.s$(t,e,n,o)).length&&v[0].dataRange().equals(i.kf(t,e,n,o)),v.length<=0||C)?((w=E(T,t,e,n,o,r,a,s,u,(b=T.wq)&&b.Ou||C&&v[0]&&v[0].LZ()))&&0!==s.groupSort&&T.xr&&T.xr.reFilter(),w):(c&&T.Os(7,f().Exp_InvalidSortPartTableOrMultiTableInRange),!1)},oec:function(t,e,n){var o,r=this,i=r.Tq(t),a=e?i.rowCount:i.colCount,s=e?i.row:i.col,l=e?r.rowOutlines:r.columnOutlines;return d(n)&&(n={}),r.outlineColumn&&r.outlineColumn.ZQa()&&e&&(o=r.outlineColumn.YQa.columnIndex,i.col<=o&&o<=i.col+i.colCount||(n.groupSort=0)),d(n.groupSort)&&(d(n.ignoreHidden)?n.groupSort=l&&l.pec(s,a)?1:0:n.groupSort=0),0===n.groupSort?n.ignoreHidden=!!d(n.ignoreHidden)||n.ignoreHidden:n.ignoreHidden=!1,n},hK:function(){var t=this.options;return!t.isProtected||t.protectionOptions.allowSort},wja:function(t,e,n,o){var r=this,i=r.getDataValidator(t,e),a=r.getDataValidator(n,o);r.setDataValidator(t,e,a),r.setDataValidator(n,o,i)}})},"./dist/core/worksheet/worksheet-static.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m;function y(t,e){return t.getRowCount(e)}function v(t,e){return t.getColumnCount(e)}function C(t,e,n){return t.$r(e,n)}function b(t,e,n){return t.Yr(e,n)}function w(t,e,n,o){t.setColumnWidth(e,n,o)}function T(t,e,n,o){t.setRowHeight(e,n,o)}function x(t,e,n,o){return t.getActualStyle(e,n,o)}function S(t,e){return t.getDefaultStyle(e)}function A(t,e,n){t.setDefaultStyle(e,n)}function I(t,e,n,o,r){t.Pq(e,n,o,r)}function R(t,e,n,o){throw Error(i.Common.u.Kb(m().Exp_InvalidAndSpace,[t,e,n,o]))}function k(t,e,n){return e&&n.Ps&&n.Ps(t)}function M(t,e,n,o,r,i,a,s,l){var u,c,f,h,d,g,C,b;if(!t)throw Error(m().Exp_SrcIsNull);if(!o)throw Error(m().Exp_DestIsNull);u=y(t),c=v(t),f=y(o),h=v(o),(e<-1||e>=u)&&R("from row index",e,"-1",u-1),(n<-1||n>=c)&&R("from column index",n,"-1",c-1),(r<-1||r>=f)&&R("to row index",r,"-1",f-1),(i<-1||i>=h)&&R("to column index",i,"-1",h-1),d=n,n<0&&(d=0,s=c),g=i<0?0:i,(s<1||d+s>c||g+s>h)&&R("column count",s,"1",p(c-d,h-g)),C=e,e<0&&(C=0,a=u),b=r<0?0:r,(a<1||C+a>u||b+a>f)&&R("row count",a,"1",p(u-C,f-b))}function N(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||u(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var e,n,o;for(n in e=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(n)&&(o=t[n],t.hasOwnProperty(n)&&e[n]!==o&&(e[n]="object"==typeof o?N(o):o));return e.toString=t.toString,e.valueOf=t.valueOf,e}function E(t,e,n,o,i,a,s,l,u){var c,f,p,d,g,m,y,v,C,b=t.getSpans(h,u),w=o.getSpans(h,u),T=[];if(b)for(c=0;c<b.length;c++)p=(f=b[c]).row,d=f.col,g=f.rowCount,m=f.colCount,-1===e?n<=d&&d+m<=n+l&&T.push(r.kf(p,a+d-n,g,m)):-1===n?e<=p&&p+g<=e+s&&T.push(r.kf(i+p-e,d,g,m)):e<=p&&p<e+s&&n<=d&&d<n+l&&T.push(r.kf(i+p-e,a+d-n,g,m));if(w)for(c=0;c<w.length;c++)p=(f=w[c]).row,void 0,y=(d=f.col)>=a&&d<a+l,v=p>=i&&p<i+s,(-1===e?y:-1===n?v:v&&y)&&((C=o.findSpan(p,d,u))&&C.row===p&&C.col===d&&o.do("removeSpan",C,u));for(c=0;c<T.length;c++)o.do("addSpan",T[c],u)}function D(t,e,n,o,r,i,a,s,l){var u,c=t.conditionalFormats,f=o.conditionalFormats,h=z(t,o);c&&f&&!t.dJb&&(u=c.XA(e,n,f,r,i,a,s,h),l&&c.YA(e,n,a,s,u,h))}function O(t,e,n,o,r,i,a,s,l,u){var c=!(t===o&&t.name()===o.name()),f=t.ITa,h=f.zl(u);c?(E(f,e,n,o.ITa,r,i,a,s,u),l&&h&&f.do("clearSpan",e,n,a,s,u)):l?f.do("moveSpan",e,n,r,i,a,s,u):f.do("copySpan",e,n,r,i,a,s,u)}function j(t,e,n,o,r,i,a,s,l){var u=e,c=n;u<0&&(u=0,a=p(y(t),y(o))),r<0&&(r=0),c<0&&(c=0,s=p(v(t),v(o))),i<0&&(i=0),e<0&&O(t,-1,c,o,-1,i,-1,s,l,1),n<0&&O(t,u,-1,o,r,-1,a,-1,l,2),O(t,u,c,o,r,i,a,s,l)}function F(t,e,n,o,r,i,a){var s,l,c,d,g,m,S,A;for(e<0&&(e=0,r=p(v(t),v(n))),o<0&&(o=0),1,s=0;s<r;s++)(64&i)>0&&(l=C(t,s+e),u(l)||(a&&w(t,s+e,t.defaults.colWidth),w(n,s+o,l)),c=t.getColumnVisible(s+e),u(c)||(a&&t.setColumnVisible(s+e,!0),n.setColumnVisible(s+o,c)),(d=x(t,-1,s+e))?(I(n,-1,s+o,d.clone()),a&&I(t,-1,s+e,f)):I(n,-1,s+o,f),(d=x(t,-1,s+e,1))?(I(n,-1,s+o,d.clone(),1),a&&I(t,-1,s+e,f,1)):I(n,-1,s+o,f,1)),(128&i)>0&&(g=t.getTag(-1,s+e),u(g)||(a&&t.setTag(-1,s+e,h),n.setTag(-1,s+o,g)));for(m=p(y(t,1),y(n,1)),S=0;S<m;S++)A=b(t,S,1),u(A)||(a&&T(t,S,t.defaults.colHeaderRowHeight,1),T(n,S,A,1))}function P(t,e,n,o,r,i,a,s){var l,c,d,g,m,S,A,R;for(e<0&&(e=0,r=p(y(t),y(n))),o<0&&(o=0),2,l=0;l<r;l++)!s&&k(o+l,a,n)||((64&i)>0&&(c=b(t,l+e),u(c)||(s&&T(t,l+e,t.defaults.rowHeight),T(n,l+o,c)),d=t.getRowVisible(l+e),u(d)||(s&&t.setRowVisible(l+e,!0),n.setRowVisible(l+o,d)),(g=x(t,l+e,-1))?(I(n,l+o,-1,g.clone()),s&&I(t,l+e,-1,f)):I(n,l+o,-1,f),(g=x(t,l+e,-1,2))?(I(n,l+o,-1,g.clone(),2),s&&I(t,l+e,-1,f,2)):I(n,l+o,-1,f,2)),(128&i)>0&&(m=t.getTag(l+e,-1),u(m)||(s&&t.setTag(l+e,-1,h),n.setTag(l+o,-1,m))));for(S=p(v(t,2),v(n,2)),A=0;A<S;A++)R=C(t,A,2),u(R)||(s&&w(t,A,t.defaults.rowHeaderColWidth,2),w(n,A,R,2))}function _(t,e,n,o){var r,i,a;t===e&&t.name()===e.name()||((64&n)>0&&(r=S(t),A(e,o?r:r.clone()),r=S(t,1),A(e,o?r:r.clone(),1),r=S(t,2),A(e,o?r:r.clone(),2),o&&(A(t,f),A(t,f,1),A(t,f,2))),i=e.defaults,a=t.defaults,i.colWidth=a.colWidth,i.rowHeight=a.rowHeight,i.rowHeaderColWidth=a.rowHeaderColWidth,i.colHeaderRowHeight=a.colHeaderRowHeight,o&&(a.colWidth=62,a.rowHeight=20,a.rowHeaderColWidth=40,a.colHeaderRowHeight=20))}function L(t,e,n,o,i,a,s,l,c,f,h,d){var g,m,C,b,w,T,x,S,A,I,R,M,E,D,O,j,F=!(t===o&&t.name()===o.name());if(2==(2&f)&&e<0)if(x=n,S=a,g=p(y(t,1),y(o,1)),m=l,n<0&&(x=0,m=v(t)),a<0&&(S=0),F)for(C=0;C<g;C++)for(b=0;b<m;b++)d(o,C,S+b,N(T=h(t,C,x+b,1)),1);else{for(w=new r.KTa,C=0;C<g;C++)for(b=0;b<m;b++)T=h(t,C,x+b,1),u(T)||w.set(C,b,N(T));for(C=0;C<g;C++)for(b=0;b<m;b++)d(o,C,S+b,w.get(C,b),1)}if(1==(1&f)&&n<0)if(A=e,I=i,g=s,m=p(v(t,2),v(o,2)),e<0&&(A=0,g=y(t)),i<0&&(I=0),F)for(C=0;C<g;C++)for(b=0;b<m;b++)d(o,I+C,b,N(T=h(t,A+C,b,2)),2);else{for(w=new r.KTa,C=0;C<g;C++)for(b=0;b<m;b++)T=h(t,A+C,b,2),u(T)||w.set(C,b,N(T));for(C=0;C<g;C++)for(b=0;b<m;b++)d(o,I+C,b,w.get(C,b),2)}if(R=e,M=n,E=i,D=a,O=s,j=l,e<0&&(R=0,O=p(y(t),y(o))),n<0&&(M=0,j=p(v(t),v(o))),i<0&&(E=0),a<0&&(D=0),F){for(C=0;C<O;C++)if(!k(E+C,c,o))for(b=0;b<j;b++)d(o,E+C,D+b,N(T=h(t,R+C,M+b,3)),3)}else{w=new r.KTa;try{for(C=0;C<O;C++)for(b=0;b<j;b++)T=h(t,R+C,M+b,3),u(T)||w.set(C,b,N(T));for(C=0;C<O;C++)if(!k(E+C,c,o))for(b=0;b<j;b++)d(o,E+C,D+b,w.get(C,b),3)}catch(t){}}}function B(t,e,n,o,i,a,s,l,c,h,p,d){var g;p&&(g=r.kf(e,n,s,l)),L(t,e,n,o,i,a,s,l,c,h,(function(t,e,n,o){var r,i,a,s,l,c,h,m,v=3===o,C=t.ITa,b={};return v?(i=(p||d)&&C.getDynamicArrayInfo(e,n))&&i.isValid?(r=f,p&&(b[a=function(t){return[t.row,t.col].join(",")}(i)]||(b[a]=i,s=i.row,l=i.col,g.contains(s,l,1,1)&&C.XTa(3).yIb(i)))):r=t.getValue(e,n,o,1):(r=C.getValue(e,n,o,!0,1),1===o&&u(r)&&((c=t.wq)&&c.Ou&&(h=C.Jp(!1,3,n),m=t.options.colHeaderAutoTextIndex,h&&(m>=0&&e===m||-1===m&&e===y(t,o)-1)&&(r=h.displayName||h.name)))),p&&(v?t.uq(e,n,f,o,!1):t.ITa.do("setValue",e,n,f,o,!0,!0)),r}),(function(t,e,n,o,r){u(o)?t.uq(e,n,f,r,!1):t.uq(e,n,o,r,!1)}))}function G(t,e,n){var o,r,i,a=t.Tq(e),s=a.row,l=a.col,u=a.rowCount,c=a.colCount;for(o=0;o<u;o++)for(r=n[s+o]=n[s+o]||{},i=0;i<c;i++)r[l+i]=!0}function H(t,e,n,o,i,a,s,l,c,p,d){var g,m,y,v,C,b,w={};if(t.tables)for(g=r.kf(e,n,s,l),m=r.kf(i,a,s,l),v=void 0,C=0,b=(y=t.tables.all()).length;C<b;C++)v=y[C].range(),g.containsRange(v)?G(t,v,w):v.containsRange(g)&&v.containsRange(m)?G(t,g,w):v.intersect(g.row,g.col,g.rowCount,g.colCount)&&v.containsRange(m)&&G(t,v.getIntersect(g),w);L(t,e,n,o,i,a,s,l,c,p,(function(t,e,n,o){var r=(3===o||u(o))&&w[e]&&w[e][n],i=t.Dq(e,n,o,h,h,h,h,r);return d&&I(t,e,n,f,o),i}),(function(t,e,n,o,r){I(t,e,n,o,r)}))}function V(t,e,n,o,r,i,a,s,l,u){var c,h,p,d=t.uja.Dja;for(c in d)(h=d[c])&&((p=h.condition())&&p.initExpression());L(t,e,n,o,r,i,a,s,l,0,(function(e,n,r){var i=e.getDataValidator(n,r,3);return i&&(u&&e.setDataValidator(n,r,f),z(t,o)&&(i.Nja=!0)),i}),(function(e,n,r,i){e.setDataValidator(n,r,i),z(t,o)&&i&&delete i.Nja}))}function z(t,e){return t===e&&t.name()===e.name()}function W(t,e,n,o,r,i,a,s,l,u){L(t,e,n,o,r,i,a,s,l,0,(function(t,e,n){var o=t.ITa.Ky,r=o&&o.get(e,n);return r&&u&&o.remove(e,n),r}),(function(t,e,n,o){var r=t.ITa.Ky;r&&r.Cz(e,n,o)}))}function U(t,e,n,o,r,i,a,s,l,c,f){L(t,e,n,o,r,i,a,s,l,c,(function(t,e,n,o){var r=t.getTag(e,n,o);return!u(r)&&f&&t.setTag(e,n,h),r}),(function(t,e,n,r,i){o.setTag(e,n,r,i)}))}function q(t,e,n,o,r,i,a,s,l,u){var c=[],h=[];return L(t,e,n,o,r,i,a,s,l,0,(function(o,r,i){var a=o.getBindingPath&&o.getBindingPath(r,i);return a&&c.push({row:r-d(0,e),col:i-d(0,n),value:o.getValue(r,i)}),u&&t.setBindingPath&&t.setBindingPath(r,i,f),a}),(function(t,e,n,o){h.push({sheet:t,r:e,c:n,value:o})})),{savedValues:c,bindingPathInfos:h}}function Y(t){t.forEach((function(t){var e=t.sheet,n=t.r,o=t.c,r=t.value;e.setBindingPath&&e.setBindingPath(n,o,r)}))}function X(t,e,n,o,r,i,a,s,l,c,f){L(t,e,n,o,r,i,a,s,l,c,(function(t,e,n,o){var r=t.getHyperlink&&t.getHyperlink(e,n,o);return!u(r)&&f&&t.setHyperlink&&t.setHyperlink(e,n,h),r}),(function(t,e,n,r,i){o.setHyperlink&&o.setHyperlink(e,n,r,i)}))}function Z(t,e,o,r,i,a,s,l){var u,f,h,p,d,g,m,y,v,C=n("SheetsCalc");if(C){if(u=C.uyb,p=t.ITa.dUa(),!t.parent||!t.parent.sheets)return void((d=t.getCustomNames())&&c(d,(function(n,c){f=c.getExpression(),(h=u(t,t,e,o,r,i,a,s,l,f))!==f&&c.fg(h,p)})));for(g=t.parent.sheets,(m=t.parent.getCustomNames())&&c(m,(function(n,c){f=c.getExpression(),(h=u(null,t,e,o,r,i,a,s,l,f))!==f&&c.fg(h,p)})),y=function(n){var d=g[n].getCustomNames();d&&c(d,(function(c,d){f=d.getExpression(),(h=u(g[n],t,e,o,r,i,a,s,l,f))!==f&&d.fg(h,p)}))},v=0;v<g.length;v++)y(v)}}function Q(t,e,o,i,a,u,c,h,g,m,C,b){var w,T,x,S,A,I,R,N,E,O,L,G,z,Q,J,$,K,tt,et,nt,ot,rt;if(M(t,e,o,i,a,u,c,h),b&&e<0)for(T=o,x=h,o<0&&(T=0,x=p(v(t),v(i))),S=u,u<0&&(S=0),w=!0,A=0;A<x;A++)I=t.ITa.Jp(!1,3,T+A),R=t.ITa.Jp(!1,3,S+A),N=I&&I.name,E=R&&R.name,I&&R&&N&&E||(w=!1),(R=l.GC$.extend(!0,{},i.ITa.Jp(!1,3,S+A)||{})).displayName=I&&I.displayName,R.name=I&&I.name,i.ITa.do("setItem",!1,3,S+A,R);(64&g)>0&&(H(t,e,o,i,a,u,c,h,m,C,b),t.dJb||t.uja&&V(t,e,o,i,a,u,c,h,m,b)),(512&g)>0&&D(t,e,o,i,a,u,c,h,b),(1&g)>0&&(2&g)>0&&((L=t.tables)&&(O=L.dB(r.kf(d(0,e),d(0,o),e<0?p(y(t),y(i)):c,o<0?p(v(t),v(i)):h),b))),(G=s)&&(t.suspendCalcService(),i.suspendCalcService()),z=[],Q=f,J=[],(256&g)>0&&(z=(Q=q(t,e,o,i,a,u,c,h,m,b)).savedValues,J=Q.bindingPathInfos);try{if((1&g)>0&&!w){if(B(t,e,o,i,a,u,c,h,m,C,b,(2&g)>0),Y(J),s&&0==(2&g)&&i.clearFormula(a,u,c,h,(function(t,e){return!m||!t.Ps||!t.Ps(e)})),(256&g)>0)for($=z.length,K=a<0?0:a,tt=u<0?0:u,et=0;et<$;et++)nt=z[et],!b&&k(K+nt.row,m,i)||i.setValue(K+nt.row,tt+nt.col,nt.value)}else Y(J);ot=i.tables,(1&g)>0&&(2&g)>0&&ot&&ot.eB(O,d(0,e),d(0,o),d(0,a),d(0,u),b),s&&(b?(Z(t,e,o,i,a,u,c,h),(2&g)>0&&function(t,e,o,r,i,a,s,l){var u=n("SheetsCalc");u&&u.CalcOperatorAdjustor.moveFormula(t,e,o,r,i,a,s,l)}(t,e,o,i,a,u,c,h)):(2&g)>0&&((rt=n("SheetsCalc"))&&rt.vyb(t,e,o,i,a,u,c,h,m)),(1&g)>0&&(2&g)>0&&ot&&ot.R3(O))}finally{G&&(t.resumeCalcService(!1),i.resumeCalcService(!1))}if((4&g)>0&&W(t,e,o,i,a,u,c,h,m,b),(128&g)>0&&U(t,e,o,i,a,u,c,h,m,C,b),(1024&g)>0&&X(t,e,o,i,a,u,c,h,m,C,b),(16&g)>0&&function(t,e,n,o,r,i,a,s,l){var u;e<0&&(e=0,a=p(y(t),y(o))),r<0&&(r=0),n<0&&(n=0,s=p(v(t),v(o))),i<0&&(i=0),!(t===o&&t.name()===o.name())?(u=o.ZA)&&(l?t.ZA.count()>0&&u.$A(t,e,n,r,i,a,s):u._A(t,e,n,r,i,a,s)):(u=t.ZA)&&(l?u.count()>0&&u.aB(e,n,r,i,a,s):u.Zz(e,n,r,i,a,s))}(t,e,o,i,a,u,c,h,b),(8&g)>0&&(e<0&&function(t,e,n,o,r,i){var a,s;e<0&&(e=0,r=p(v(t),v(n))),o<0&&(o=0),a=t.columnOutlines,s=n.columnOutlines,!(t===n&&t.name()===n.name())?a&&s&&s.bB(a,e,o,r,i):a&&a.cB(e,o,r,i)}(t,o,i,u,h,b),o<0&&function(t,e,n,o,r,i){var a,s,l;e<0&&(e=0,r=p(y(t),y(n))),o<0&&(o=0),a=!(t===n&&t.name()===n.name()),s=t.rowOutlines,l=n.rowOutlines,a?s&&l&&l.bB(s,e,o,r,i):s&&s.cB(e,o,r,i)}(t,e,i,a,c,b)),(32&g)>0&&(b||1!==c||1!==h)&&j(t,e,o,i,a,u,c,h,b),e<0&&a<=0&&F(t,o,i,u,h,g,b),o<0&&u<=0&&P(t,e,i,a,c,g,m,b),e<0&&a<=0&&o<0&&u<=0&&_(t,i,g,b),b&&e<0)for(T=o,x=h,o<0&&(T=0,x=p(v(t),v(i))),A=0;A<x;A++)t.getDataColumnName&&t.getDataColumnName(T+A)&&t.ITa.do("setItem",!1,3,T+A,f)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/util/common.js"),i=n("Common"),a=n("@grapecity/js-calc"),s=!!a,l=n("./dist/core/util/domUtil.js"),u=i.Common.j.Fa,c=l.GC$.each,f=null,h=void 0,p=Math.min,d=Math.max,g=new i.Common.ResourceManager(o.SR),m=g.getResource.bind(g),e.staticMembers={copyTo:function(t,e,n,o,r,i,a,s,l,u,c){Q(t,e,n,o,r,i,a,s,l,u,c,!1)},moveTo:function(t,e,n,o,r,i,a,s,l){Q(t,e,n,o,r,i,a,s,l,h,3,!0)}}},"./dist/core/worksheet/worksheet-ui.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(t){return"number"==typeof t}function C(t){return"string"==typeof t}function b(t){return Math.abs(t)}function w(t,e){var n=t,o=e;return function(t){var e,r,i=this,a=i.sheet,s=i.row,l=i.col,u=i.sheetArea;if(0===arguments.length)return n.call(a,s,l,u);if(s>=0&&l>=0)for(e=s;e<s+i.rowCount;e++)for(r=l;r<l+i.colCount;r++)T(a,e,r,u)&&o.call(a,e,r,t,u);return i}}function T(t,e,n,o){var r=t.getRowCount(o),i=t.getColumnCount(o);return n<0&&0<=e&&e<r||e<0&&0<=n&&n<i||0<=e&&e<r&&0<=n&&n<i}function x(t,e,n,o,i,a){if(T(t,e,n,a)){var s=t.Iq(e,n,a);s||(s=new r.Style),"font"===o&&function(t,e,n){var o,r,i,a;g(e.themeFont)||(o=h(),r=o.style,i=e.font,r.font=i,a=i&&r.fontFamily,r.font=n,(n&&r.fontFamily)!==a&&(e.themeFont=p))}(0,s,i),s[o]=i,t.setStyle(e,n,s,a)}}function S(t){return(t=t.replace(/[^\:]+\!/g,"")).replace(/\$/g,"")}function A(t){var e,n,o,r,i,a,s,l,u,c,f,h,p=t.split(":"),g=p[0],m=p[1],y=/([A-Z]+)(\d+)?(\D+)?/;if(isNaN(+g)){if((o=g.match(y))[3])return d;e=o[1],n=o[2]}else n=g;if(g&&!m){if(e&&n)return[r=I(n),R(e),1,1]}else if(g&&m){if(i=void 0,a=void 0,isNaN(+m)){if((s=m.match(y))[3])return d;i=s[1],a=s[2]}else a=m;if(!e&&n&&!i&&a)return l=I(n),u=I(a),[r=Math.min(l,u),-1,c=b(l-u)+1,-1];if(e&&!n&&i&&!a)return f=R(e),h=R(i),[-1,Math.min(f,h),-1,b(f-h)+1];if(e&&n&&i&&a)return l=I(n),u=I(a),f=R(e),h=R(i),r=Math.min(l,u),c=b(l-u)+1,[r,Math.min(f,h),c,b(f-h)+1]}return d}function I(t){return function(t){return parseInt(t,10)}(t)-1}function R(t){var e,n,o=0,r=t.length;for(e=0;e<r;e++)n=t[e].charCodeAt(0)-64,o+=Math.pow(26,r-e-1)*n;return o-1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/worksheet/worksheet.js"),r=n("./dist/core/worksheet/style.js"),i=n("./dist/core/util/domUtil.js"),a=n("./dist/core/util/common.js"),s=n("Common"),l=n("./dist/core/core.enum.js"),u=n("@grapecity/js-calc"),c=n("./dist/core/worksheet/clipboardhelper.js"),f=!!u,h=a.util.tt,p=void 0,d=null,g=s.Common.j.Fa,m=o.Worksheet.prototype,y=function(){function t(t,e,n,o,r,i){var a=this;e<0&&(e=o=-1),n<0&&(n=r=-1),a.sheet=t,a.row=e,a.rowCount=g(o)?1:o,a.col=n,a.colCount=g(r)?1:r,a.sheetArea=g(i)?3:i}return t.prototype.tag=function(t){var e,n,o=this,r=o.sheet,i=o.row,a=o.col,s=o.rowCount,l=o.colCount,u=o.sheetArea;if(0===arguments.length)return r.getTag(i,a,u);if(i>=0&&a>=0)for(e=i;e<i+s;e++)for(n=a;n<a+l;n++)r.setTag(e,n,t,u);else if(i>=0)for(e=i;e<i+s;e++)r.setTag(e,-1,t,u);else if(a>=0)for(n=a;n<a+l;n++)r.setTag(-1,n,t,u);return o},t.prototype.width=function(t){var e,n=this,o=n.sheet,r=n.row,i=n.col,a=n.sheetArea;if(0!==arguments.length){if(r<0)for(e=0;e<n.colCount;e++)o.setColumnWidth(e+i,t,a);return n}if(r<0)return o.getColumnWidth(i,a)},t.prototype.height=function(t){var e,n=this,o=n.sheet,r=n.row,i=n.col,a=n.sheetArea;if(0!==arguments.length){if(i<0)for(e=0;e<n.rowCount;e++)o.setRowHeight(e+r,t,a);return n}if(i<0)return o.getRowHeight(r,a)},t.prototype.visible=function(t){var e,n,o=this,r=o.sheet,i=o.row,a=o.col,s=o.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(e=0;e<o.rowCount;e++)r.setRowVisible(e+i,t,s);else if(a>=0&&i<0)for(n=0;n<o.colCount;n++)r.setColumnVisible(n+a,t,s);return o}return a<0&&i>=0?r.getRowVisible(i,s):a>=0&&i<0?r.getColumnVisible(a,s):void 0},t.prototype.resizable=function(t){var e,n,o=this,r=o.sheet,i=o.row,a=o.col,s=o.sheetArea;if(0!==arguments.length){if(a<0&&i>=0)for(e=0;e<o.rowCount;e++)r.setRowResizable(e+i,t,s);else if(a>=0&&i<0)for(n=0;n<o.colCount;n++)r.setColumnResizable(n+a,t,s);return o}return a<0&&i>=0?r.getRowResizable(i,s):a>=0&&i<0?r.getColumnResizable(a,s):void 0},t.prototype.tq=function(t){var e=this;return e.sheet.tq(e.row,e.col,t,e.sheetArea)},t.prototype._w=function(t,e){var n,o,r=this,i=r.sheet,a=r.row,s=r.col,l=r.rowCount,u=r.colCount,c=r.sheetArea;if(a>=0&&s>=0)for(n=a;n<a+l;n++)for(o=s;o<s+u;o++)x(i,n,o,t,e,c);else if(a>=0)for(o=-1,n=a;n<a+l;n++)x(i,n,o,t,e,c);else if(s>=0)for(n=-1,o=s;o<s+u;o++)x(i,n,o,t,e,c);return r},t.prototype.clear=function(t){var e=this;e.sheet.clear(e.row,e.col,e.rowCount,e.colCount,e.sheetArea,t)},t.prototype.setBorder=function(t,e){var n,o,r,i,s,l,u,c,f,h,p,d=this,g=d.sheet,m=d.sheetArea;g.suspendPaint();try{if(n=new a.Range(d.row,d.col,d.rowCount,d.colCount),r=(o=g.Tq(n,m)).row,i=o.col,s=o.rowCount,l=o.colCount,u=void 0,c=void 0,f=e.all,h=e.outline,p=e.inside,e.left||f||h)for(u=0;u<s;u++)g.getCell(r+u,i,m).borderLeft(t);if(e.top||f||h)for(c=0;c<l;c++)g.getCell(r,i+c,m).borderTop(t);if(e.right||f||h)for(u=0;u<s;u++)g.getCell(r+u,i+l-1,m).borderRight(t);if(e.bottom||f||h)for(c=0;c<l;c++)g.getCell(r+s-1,i+c,m).borderBottom(t);if(e.diagonalUp)for(u=0;u<s;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).diagonalUp(t);if(e.diagonalDown)for(u=0;u<s;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).diagonalDown(t);if(e.innerHorizontal||f||p)for(u=0;u<s-1;u++)for(c=0;c<l;c++)g.getCell(r+u,i+c,m).borderBottom(t),g.getCell(r+u+1,i+c,m).borderTop(t);if(e.innerVertical||f||p)for(c=0;c<l-1;c++)for(u=0;u<s;u++)g.getCell(r+u,i+c,m).borderRight(t),g.getCell(r+u,i+c+1,m).borderLeft(t)}finally{g.resumePaint()}},t.prototype.toHtml=function(t,e){void 0===t&&(t=l.HeaderOptions.noHeaders),void 0===e&&(e=!0);var n=this;return n.sheetArea===l.SheetArea.corner?"":c.S4.Q4(n.sheet,t,n.row,n.rowCount,n.col,n.colCount,n.sheetArea,e,[],[],!0,!0,e,!0)},t.Pl=w,t}(),e.CellRange=y,y.prototype.value=w(m.getValue,m.setValue),y.prototype.text=w(m.getText,m.setText),y.prototype.formula=w((function(t,e){return f&&this.getFormula(t,e)}),(function(t,e,n,o){f&&this.setFormula(t,e,n,o)})),y.prototype.styleName=w(m.getStyleName,m.setStyleName),i.GC$.each(["backColor","foreColor","hAlign","vAlign","themeFont","font","formatter","borderLeft","borderTop","borderRight","borderBottom","diagonalDown","diagonalUp","locked","textIndent","wordWrap","showEllipsis","shrinkToFit","backgroundImage","backgroundImageLayout","cellType","tabStop","textDecoration","imeMode","watermark","cellPadding","labelOptions","quotePrefix","isVerticalText","cellButtons","dropDowns","textOrientation"],(function(t,e){y.prototype[e]=function(t){return 0===arguments.length?this.tq(e):this._w(e,t)}})),e.Hgc=A,e.Igc=R,i.GC$.extend(m,{getRange:function(){var t,e,o,r,i,a,s,l,u=arguments[0];if(C(u)){if(a=u.toUpperCase(),this.parent&&1===this.parent.options.referenceStyle)return d;if(i=arguments[1],(a=S(a)).split(",").length>1)return d;if(f){if(!(s=n("SheetsCalc").formulaToRange(this,a,p,p,i)))return d;t=s.row,e=s.col,o=s.rowCount,r=s.colCount}else{if(!(l=A(a)))return d;t=l[0],e=l[1],o=l[2],r=l[3]}}else v(u)&&(t=u,e=arguments[1],o=arguments[2],r=arguments[3],i=arguments[4]);return new y(this,t,e,o,r,i)},getCell:function(t,e,n){return g(e)&&(e=-1),new y(this,t,e,1,1,n)}})},"./dist/core/worksheet/worksheet.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st;function lt(t,e){var n,o,r,i,a=[],s=t.ITa.hUa();if(s)for(n in s)if(M(s,n)&&((o=s[n])&&(e||"n"!==o.rs||(r={row:+n,item:t.getDataItem&&t.getDataItem(+n)},a.push(r)),e&&"e"===o.rs)))for(i in o)if(!P(i)&&o[i]){(r={row:+n,item:t.getDataItem&&t.getDataItem(+n)}).originalItem=o.originalItem,a.push(r);break}return a}function ut(t,e,n){var o,r=0;for(o=e;o<=n;o++)r+=t._m(o);return r}function ct(t,e,n){var o,r=0;for(o=e;o<=n;o++)r+=t.Sl(o);return r}function ft(t){return t.getColumnCount()}function ht(t){return t.getRowCount()}function pt(t){return t.frozenTrailingColumnCount()}function dt(t){return t.frozenTrailingRowCount()}function gt(t){return t.frozenColumnCount()}function mt(t){return t.frozenRowCount()}function yt(t,e){var n=r.util.Pxb(t.font),o=r.util.Pxb(e.font);return n.fontStyle+" "+n.fontWeight+" "+o.fontSize+" "+o.fontFamily}function vt(t,e,n){Object.defineProperty(t,e,{get:function(){return this["_"+e]},set:function(t){var o=this["_"+e];o!==t&&(this["_"+e]=t,n&&n(e,t,o))}})}function Ct(t,e,n,o){return{row:e,col:n,newValue:t.getValue(e,n),oldValue:o}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/core/core.ns.js"),r=n("./dist/core/util/common.js"),i=n("./dist/core/util/imageLoader.js"),a=n("./dist/core/util/tasks.js"),s=n("./dist/core/worksheet/style.js"),l=n("./dist/core/worksheet/worksheet-model.js"),u=n("./dist/core/util/domUtil.js"),c=n("./dist/core/celltype/textcelltype.js"),f=n("@grapecity/js-calc"),h=n("./dist/core/celltype/headercelltype.js"),p=n("./dist/core/core.enum.js"),d=n("Common"),g=n("@grapecity/js-calc"),m=!!g,v=n("./dist/core/util/theme.js"),C=n("./dist/core/worksheet/stylehelper.js"),b=r.util.n0a,w=r.util.lHb,T=d.Common.j.Fa,x=r.util.Nl,S=r.util.Pl,A=r.util.Ql,I=r.util.bq,R=u.GC$.each,k=u.GC$.isEmptyObject,M=d.Common.D,N=r.util.x0a,E=r.util.w0a,D=RegExp("^\\d*(\\.\\d+)?\\*$"),O=document,j=parseInt,F=parseFloat,P=isNaN,_=null,L=void 0,B=Math.min,G=Math.max,H=Math.floor,V=Math.ceil,z="undefined",W="string",U="width",q="height",Y="tag",X="onLayoutChanged",Z="onPaintSuspend",Q="isVisible",J="starSize",$="resizable",K=".gcSheet",tt=".gcSheetInternal",et={backColor:!0,foreColor:!0,font:!0,borderLeft:!0,borderTop:!0,borderRight:!0,borderBottom:!0,textDecoration:!0,cellType:!0,formatter:!0},nt=new d.Common.ResourceManager(o.SR),ot=nt.getResource.bind(nt),function(t){t[t.dirty=1]="dirty",t[t.insert=2]="insert",t[t.delete=4]="delete"}(rt=e.ClearPendingChangeType||(e.ClearPendingChangeType={})),function(t){t[t.setFormula=0]="setFormula",t[t.copyPaste=1]="copyPaste",t[t.dragFill=2]="dragFill",t[t.dragDrop=3]="dragDrop",t[t.changePartOfArrayFornula=4]="changePartOfArrayFornula",t[t.changeSheetName=5]="changeSheetName",t[t.table=6]="table",t[t.hideSheet=7]="hideSheet"}(e.InvalidType||(e.InvalidType={})),it={rowHeaderVisible:!0,colHeaderVisible:!0,clipBoardOptions:0,frozenlineColor:"black",rowHeaderAutoText:1,colHeaderAutoText:2,rowHeaderAutoTextIndex:-1,colHeaderAutoTextIndex:-1,sheetTabColor:_,selectionBackColor:_,selectionBorderColor:_,allowCellOverflow:!0,showFormulas:!1,isProtected:!1,protectionOptions:{},gridline:{},sheetAreaOffset:{left:0,top:0}},at=function(){function t(e){var n=this;n.yn=t.Np,t.Np++,n.options=A(it,(function(t,e,o){n.Op(t,e,o)})),n.ad(e),n.fgc=new a.Tasks((function(){return this.tasks.pop()}),(function(){var t=n.parent;return t&&t.ku.Gw||n.mm.OG||n.mm.xG||n.mm.eG}))}return t.prototype.Op=function(e,n,o){var r,i,a,s,l=this,u=l.parent;switch(e){case"allowCellOverflow":case"showFormulas":case"colHeaderAutoText":case"colHeaderAutoTextIndex":case"colHeaderVisible":case"frozenlineColor":case"rowHeaderAutoText":case"rowHeaderAutoTextIndex":case"rowHeaderVisible":case"selectionBackColor":case"selectionBorderColor":l.$p();break;case"sheetAreaOffset":r=function(t,e){e<0&&(l.options.sheetAreaOffset[t]=0),l.$p()},i=l.options.sheetAreaOffset,["left","top"].forEach((function(t){var e=n[t];vt(i,t,r),i[t]=e}));break;case"gridline":a=function(){l.$p()},s=l.options.gridline,["color","showHorizontalGridline","showVerticalGridline"].forEach((function(t){var e=n[t];vt(s,t,a),s[t]=e}));break;case"isProtected":n&&u&&u.undoManager().PY((function(t){return t.sheetId!==l.yn})),l._p(),t.ao(l,"onProtectChanged"),l.$p();break;case"protectionOptions":l._p(),t.ao(l,"onProtectChanged");break;case"sheetTabColor":u&&u.aq()}},t.prototype.name=function(t){var e=this,n=e.parent;if(0===arguments.length)return e.ITa?e.ITa.getName():"";if(!I(t,n?n.sheets:null,e))throw ot().Exp_NotSupported;return e.cq(t),n&&n.aq(),e},t.prototype.isSelected=function(t){return this.DHb(t)},t.prototype.DHb=function(t,e){var n,o,i=this,a=i.parent,s=!!i.ITa&&i.ITa.TIb();return T(t)?s:(t!==s&&(n=i.name(),o=void 0,e&&(o={oldValue:s,newValue:t,sheetName:n,propertyName:"isSelected",cancel:!1,sheetIndex:i.parent.getSheetIndex(n)},i.parent.Wq(r.Events.SheetChanging,o)),(!e||o&&!1===o.cancel)&&(i.ITa.CHb(t),a&&a.hq&&a.hq.repaint(),e&&i.parent.Wq(r.Events.SheetChanged,{oldValue:s,newValue:t,sheetName:n,propertyName:"isSelected",sheetIndex:i.parent.getSheetIndex(n)}))),i)},t.prototype.cq=function(e,n){var o=this,r=o.name();n||t.ao(o,"beforeSetName",{oldName:r,newName:e}),this.ITa.do("setName",e),n||t.ao(o,"setName",{oldName:r,newName:e})},t.prototype.addRows=function(e,n,o){var r,i,a,s;if(!(n<=0)){i=ht(r=this),(e<0||e>i)&&(e=i),0===r.ITa.WTa&&r.parent&&r.parent.pv.clear(),r.suspendPaint();try{if(r.eJb(!1),a={changeType:"addingRows",row:e,rowCount:n,canAdd:!0},t.ao(r,X,a),!a.canAdd)return;T(a.newRow)||(e=a.newRow),s="addRows",r.pCb(e,3,s,n,i),this.ITa.do("addRows",e,n),r.jq=!0,t.ao(r,X,{changeType:s,row:e,oldValue:i,rowCount:n,rowExpand:o}),t.ao(r,X,{changeType:"addRows2",row:e,oldValue:i,rowCount:n}),r.tables&&r.tables.Cec(!0,e),r.kq(e,3,s,n,i)}finally{r.eJb(!0),r.resumePaint()}}},t.prototype.eJb=function(t){var e=this,n=e.Jl,o=e.Kl;e.ITa.setCellState(n,o,p.CellStatesType.active,t,p.SheetArea.viewport)},t.prototype.deleteRows=function(e,n){var o,r,i,a,s,l,u,c=this,f=ht(c);if(!(0>e||e>=f||n<=0)){0===c.ITa.WTa&&c.parent&&c.parent.pv.clear(),c.suspendPaint();try{if(c.eJb(!1),o={changeType:"deletingRows",row:e,rowCount:n,canDelete:!0},t.ao(c,X,o),!o.canDelete)return;if(r="deleteRows",c.pCb(e,3,r,n,f),c.RIb(e,n,0,this.getColumnCount()),c.ITa.do("deleteRows",e,n),(i=c.lq)>=0){for(a=-1,s=mt(c),l=i;l>=s;l--)if(c.getRowVisible(l)&&c.Sl(l)>0){a=l;break}-1===a&&(a=0),i!==a&&c.mq(a)}u=f,c.getActiveRowIndex()>=u&&c.setActiveCell(u-1,c.getActiveColumnIndex()),c.jq=!0,t.ao(c,X,{changeType:r,row:e,oldValue:f,rowCount:n}),c.tables&&c.tables.Cec(!0,e),c.kq(e,3,r,n,f)}finally{c.eJb(!0),c.resumePaint()}}},t.prototype.addColumns=function(e,n){var o,r,i,a;n<=0||(r=ft(o=this),(e<0||e>r)&&(e=r),0===o.ITa.WTa&&o.parent&&o.parent.pv.clear(),i={changeType:"addingColumns",col:e,colCount:n,canAdd:!0},t.ao(o,X,i),i.canAdd&&(o.eJb(!1),a="addColumns",o.qCb(e,3,a,n,r),o.ITa.do("addColumns",e,n),o.oq=!0,t.ao(o,X,{changeType:a,col:e,oldValue:r,colCount:n}),t.ao(o,X,{changeType:"addColumns2",col:e,oldValue:r,colCount:n}),o.tables&&o.tables.Cec(!1,e),o.pq(e,3,a,n,r),o.eJb(!0),o.$p()))},t.prototype.deleteColumns=function(e,n){var o,r,i,a,s,l,u,c=this,f=ft(c);if(!(0>e||e>=f||n<=0)&&(0===c.ITa.WTa&&c.parent&&c.parent.pv.clear(),o={changeType:"deletingColumns",col:e,colCount:n,canDelete:!0},t.ao(c,X,o),o.canDelete)){if(c.eJb(!1),r="deleteColumns",c.RIb(0,this.getRowCount(),e,n),c.qCb(e,3,r,n,f),c.ITa.do("deleteColumns",e,n),(i=c.qq)>=0){for(a=-1,s=gt(c),l=i;l>=s;l--)if(c.getColumnVisible(l)&&c.Tl(l)>0){a=l;break}-1===a&&(a=0),i!==a&&c.rq(a)}u=f,c.getActiveColumnIndex()>=u&&c.setActiveCell(c.getActiveRowIndex(),u-1),c.oq=!0,t.ao(c,X,{changeType:r,col:e,oldValue:f,colCount:n}),t.ao(c,X,{changeType:"deleteColumns2",col:e,oldValue:f,colCount:n}),c.tables&&c.tables.Cec(!1,e),c.pq(e,3,r,n,f),c.eJb(!0),c.$p()}},t.prototype.getRowCount=function(t){return 0===t?0:this.ITa.getRowCount(t)},t.prototype.getColumnCount=function(t){return 0===t?0:this.ITa.getColumnCount(t)},t.prototype.setRowCount=function(e,n){var o;T(n)&&(n=3),o={changeType:"settingRowCount",rowCount:e,sheetArea:n,canSet:!0},t.ao(this,X,o),o.canSet&&this.setRowCountCore(e,n)},t.prototype.setRowCountCore=function(e,n){var o,r;e=j(e,10),P(e)||(T(n)&&(n=3),r=(o=this).getRowCount(n),e<0||e===r||(3===n||2===n?(o.ITa.do("setRowCount",e,n),mt(o)>e&&o.frozenRowCount(e)):1===n&&o.ITa.do("setRowCount",e,n),t.ao(o,X,{changeType:"setRowCount",rowCount:e,sheetArea:n}),o.jq=!0,o.Jl>=e&&(3===n||2===n)&&o.setActiveCell(e-1,o.getActiveColumnIndex()),o.$p(),o.clearPendingChanges()))},t.prototype.setColumnCount=function(e,n){var o,r;e=j(e,10),P(e)||(r=(o=this).getColumnCount(n),e<0||e===r||(T(n)&&(n=3),3===n||1===n?(o.ITa.do("setColumnCount",e,n),gt(o)>e&&o.frozenColumnCount(e)):2===n&&o.ITa.do("setColumnCount",e,n),t.ao(o,X,{changeType:"setColumnCount",colCount:e,sheetArea:n}),o.oq=!0,o.Kl>=e&&(3===n||1===n)&&o.setActiveCell(o.getActiveRowIndex(),e-1),o.$p(),o.clearPendingChanges()))},t.prototype.aHb=function(t,e,o){var r,i,a=this;return y||(y=n("SheetsCalc")),y&&((r="string"==typeof o&&a.parent&&a.parent.aJb(o))&&-1!==t&&-1!==e)?(i=r.getExpression(),y.evaluateExpression(a,i,t,e)):L},t.prototype.xHb=function(t,e,n){var o,r=this;if(r.options.showFormulas&&3===n){if(o=r.getFormula(t,e))return"="!==o[0]&&(o="="+o),o;if(r.ITa&&r.ITa.ZHb&&r.ITa.ZHb.getAnchorInfo(t,e))return""}},t.prototype.getText=function(t,e,n){var o,r,i,a,s,l,u;return T(n)&&(n=3),r=(o=this).xHb(t,e,n),T(r)?(i=o.getCellType(t,e,n),a=o.getValue(t,e,n),(s=o.tq(t,e,"formatter",n))||(s=o.tq(t,e,"_autoFormatter",n)),l={},u=o.tq(t,e,"quotePrefix",n),(a=i.format(a,s,l,{sheet:o,row:t,col:e,sheetArea:n,quotePrefix:u}))&&"string"==typeof a&&(a=a.replace(/\r\n?/g,"\n")),a):r},t.prototype.setText=function(e,n,o,r){var i,a,s,l,u,c,f=this;T(r)&&(r=3),i=o,a={value:o},t.ao(f,"settingText",a),s=o=a.value,l=f.getCellType(e,n,r),u=f.getFormatter&&f.getFormatter(e,n,r),l&&u&&!w(u)&&(c={sheet:f,row:e,col:n,sheetArea:r},s=l.parse(i,u,c),s=T(s)?o:s),f.uq(e,n,s,r),f.$p()},t.prototype.getValue=function(t,e,n,o){var i,a,s,l,u,c,f,h,p,d,g,m;return 0===n?_:(T(n)&&(n=3),a=(i=this).options,l=(s=i.ITa).getRowCount(n),u=s.getColumnCount(n),c=i.vq(s,t,e,n,o),1===n?T(c)&&((h=i.wq)&&h.Ou&&(p=i.ITa.Jp(!1,3,e),d=a.colHeaderAutoTextIndex,p&&(d>=0&&t===d||-1===d&&t===l-1)&&(c=p.displayName||p.name)),T(c)&&(((f=a.colHeaderAutoTextIndex)<0||f>=l)&&(f=l-1),t===f&&(2===(g=a.colHeaderAutoText)?c=r.util.xq(e+1):1===g&&(c=e+1)))):2===n&&T(c)&&(((f=a.rowHeaderAutoTextIndex)<0||f>=u)&&(f=u-1),e===f&&(2===(m=a.rowHeaderAutoText)?c=r.util.xq(t+1):1===m&&(c=t+1))),c)},t.prototype.setValue=function(t,e,n,o,r){var i,a;this.uq(t,e,n,o,r),(i=this.parent)?(a=i.getActiveSheet())&&a.$p():this.$p()},t.prototype.eyb=function(t,e,n,o){var r=this;!o&&m&&r.zq(t,e,n),r.t4&&r.t4(t,e,1,1,n)},t.prototype.fyb=function(){var t=this.conditionalFormats;t&&t.Nm()},t.prototype.uq=function(t,e,n,o,r){var i,a,s,l;0!==o&&(T(o)&&(o=3),s=(a=(i=this).ITa).getRowCount(o),l=a.getColumnCount(o),t<0||t>=s||e<0||e>=l||(n=N(n),n=b(n),a.do("setValue",t,e,n,o),i.eyb(t,e,o,r),i.fyb()))},t.prototype.AHb=function(t,e,n,o,r,i){var a;return function(t,e,n,o,r){if((-1!==e||-1!==n)&&(T(r)&&(r=3),3===r)){var i=t.tables&&t.tables.find(e,n);i&&i.NZ&&e===i.footerIndex()&&at.ao(t,"composeTableFooterList",{table:i,row:e,col:n,style:o})}}(this,t,e,a=this.getActualStyle(t,e,n,o,r,i),n),a},t.prototype.getActualStyle=function(t,e,n,o,r,i){var a,l,u,c,f,h,p,d,g,m,y,v,C,b,w,x,S,A,I,R,k,M,N,E,D,O;if(T(n)&&(n=3),0===n)return new s.Style;if(-1===t&&-1===e)return this.getDefaultStyle(n);if(p=(a=this).Cq,x="__spreadJSDefault",S="__undefined",c=(A=this.ITa).getStyle(t,e,n),f=A.getStyle(t,-1,n),h=A.getStyle(-1,e,n),f=f||_,h=h||_,C=S,(c=c||_)&&(C=c.charAt?c:x+c.yn),b=S,f&&(b=f.charAt?f:x+f.yn),w=S,h&&(w=h.charAt?h:x+h.yn),d=(v=p[n])[C],I=a.tables,R=3===n&&I&&!i?I.find(t,e):_,k=3===n&&a.pivotTables&&a.pivotTables.Wic(t,e),R||k||(d||(d=v[C]={}),(m=d[b])?y=m[w]:m=d[b]={}),y||(u=a.Dq(t,e,n,c,f,h,R,L,i,k)),3!==n||o||(y||(M=u.formatter)&&M.hasFormatedColor&&M.hasFormatedColor()&&!i&&(N={value:_},M.format(a.getValue(t,e),N),N.value&&((l=new s.Style).foreColor=N.value)),(E=a.conditionalFormats)&&(l=E.Eq(l,t,e,n))),l)g=y||u,l.Yo(g),l&&l.font&&g&&g.font&&l.font!==g.font&&(l.font=yt(l,g)),u=l;else if(y)return a.cellStates&&!o&&((D=a.cellStates.getStyle(t,e,n,_,y.locked))&&(D.Yo(y),(y=D).Zo(a.Pm))),r?y:y.clone(!0);return T(u.locked)&&(u.locked=!0),u=u.Zo(a.Pm),l||R||k||(m[w]=u.clone(!0)),a.cellStates&&!o&&((O=a.cellStates.getStyle(t,e,n,_,u.locked))&&(O.Yo(u),u=(u=O).Zo(a.Pm))),u},t.prototype.tq=function(t,e,n,o){var r,i,a,l,u,c,f,h,p,d,g,m,y,v,C;if(0===o)return L;for(T(o)&&(o=3),u=(r=this).ITa,f=!1,3===o&&("foreColor"===n&&((p=r.tq(t,e,"formatter",o))&&p.hasFormatedColor&&p.hasFormatedColor()&&(d={value:_},p.format(r.getValue(t,e),d),d.value&&(c=d.value,f=!0))),(g=r.conditionalFormats)&&g.count()>0&&(f=(m=g.Fq(t,e,n,o)).v5,c=m.Fi)),y=0;!f&&y<=4;)if(0===y?i=u.getStyle(t,e,o):1===y?(v=r.tables,(C=3===o&&v?v.find(t,e):_)&&et[n]&&(i=C.Gq(t,e,n))):i=2===y?u.getStyle(t,-1,o):3===y?u.getStyle(-1,e,o):r.getDefaultStyle(o),y++,i&&i.charAt&&typeof i===W&&(i=r.Hq(i)),i){if("font"===n&&i.themeFont&&!h&&(h=i.themeFont),i[n]!==L){c=i[n],f=!0;break}for(a=i.parentName;a&&(l=r.Hq(a));){if(l[n]!==L){c=l[n],f=!0;break}a=l.parentName}}return"locked"===n?!!T(c)||c:f||h?("foreColor"!==n&&"backColor"!==n&&"font"!==n&&"borderLeft"!==n&&"borderTop"!==n&&"borderRight"!==n&&"borderBottom"!==n||((i=new s.Style)[n]=c,"font"===n&&h&&(i.themeFont=h),i.Zo(r.Pm),c=i[n]),c):L},t.prototype.getStyle=function(t,e,n){return this.Iq(t,e,n,!0)},t.prototype.Iq=function(t,e,n,o){var r,i,a;if(T(n)&&(n=3),0!==n){if((r=this.ITa.getStyle(t,e,n))instanceof s.Style)return o&&this.Jq(),r;if(typeof r===W&&((i=this.Hq(r))!==_&&i!==L))return(a=new s.Style).Yo(i,!1),o&&this.Jq(),a}return _},t.prototype.addNamedStyle=function(t){this.Kq(t),this.$p()},t.prototype.Kq=function(t){if(t){if(!t.name)throw Error(ot().Exp_EmptyNamedStyle);var e=t.name.toUpperCase();this.Lq[e]=t}},t.prototype.getNamedStyle=function(t){return this.Mq(t,!0)},t.prototype.Mq=function(t,e){var n,o=this.Lq;return o&&t?((n=o[t=t.toUpperCase()])&&e&&this.Jq(),n):_},t.prototype.Jq=function(){this.Cq=[{},{},{},{}]},t.prototype.removeNamedStyle=function(t){var e,n=this.Lq;n&&t&&(t=t.toUpperCase(),M(n,t)&&((e=n[t].formatter)&&"string"==typeof e&&this.parent.QHb[e]&&this.parent.RHb(e),delete n[t],this.Jq(),this.$p()))},t.prototype.getNamedStyles=function(){var t=[],e=this.Lq;return e&&R(e,(function(e,n){t.push(n)})),this.Jq(),t},t.prototype.setStyle=function(t,e,n,o){var r,i;T(o)&&(o=3),n&&n.backColor&&"object"==typeof n.backColor&&C.To.processStops(n.backColor),(r=this).Nq(t,e,n,o),-1===t&&-1===e&&(r.Oq[o]=_),-1!==t&&-1!==e||(i=n&&n.validator)&&i.condition()&&4===i.condition().conType()&&i.condition().getExpected(this,t<0?0:t,e<0?0:e),r.Jq(),r.$p()},t.prototype.Pq=function(t,e,n,o){var r,i,a=this;a.options.isProtected?(r=a.getStyle(t,e,o),i=void 0,n?(i=r?r.locked:L,n.locked!==i&&(n.locked=i),a.setStyle(t,e,n,o)):r&&((i=r.locked)!==L&&((n=new s.Style).locked=i),a.setStyle(t,e,n,o))):a.setStyle(t,e,n,o)},t.prototype.getStyleName=function(t,e,n){var o=this.Aj(t,e,n);return o instanceof s.Style?o.name:o},t.prototype.setStyleName=function(t,e,n,o){typeof n===W&&(this.Nq(t,e,n,o),this.$p())},t.prototype.Aj=function(t,e,n){var o;return T(n)&&(n=3),0!==n&&(o=this.ITa.getStyle(t,e,n)),o||_},t.prototype.Nq=function(t,e,n,o){var i,a,s,l,u,c,f,h,p,d,g;if(T(o)&&(o=3),0!==o){if(a=(i=this).Aj(t,e,o),l=(s=i.ITa).getRowCount(o),u=s.getColumnCount(o),t<-1||t>=l||e<-1||e>=u)return;c=n,f=s.getStyle(t,e,o),typeof c===W&&(c=i.Hq(c)),(h=c&&c.formatter)&&w(h)&&i.fJb(t,e,h),s.do("setStyle",t,e,n,o),p=a&&a.cellType&&a.cellType.typeName||_,d=n&&n.cellType&&n.cellType.typeName||_,t===i.Jl&&e===i.Kl&&p!==d&&r.Vl.Wl(i)&&i.mm.Qq(),g="[styleinfo]",-1!==t&&-1!==e?i.Bq(g,t,e,o,f,n):-1!==t&&-1===e?i.kq(t,o,g,n,f):-1===t&&-1!==e&&i.pq(e,o,g,n,f)}},t.prototype.fJb=function(t,e,o){var r,i,a,s,l,u,c,h=this;if(y||(y=n("SheetsCalc")),y){if(-1===t&&(t=0),-1===e&&(e=0),r=h.getCell(t,e,3),i=y.rangeToFormula(r,t,e,3),"="===(a=o.trim()).charAt(0)&&a.indexOf("@")>=0&&(a=a.replace(/@/g,i)),a.indexOf("{{")>=0&&a.indexOf("}}")>=0){for(""===(s=a.split(/{{|}}/))[0]&&s.shift(),""===s[s.length-1]&&s.pop(),l=0;l<s.length;l++)-1===s[l].indexOf("=")?s[l]='"'+s[l]+'"':(s[l].indexOf("@")>=0&&(s[l]=s[l].replace(/@/g,i)),(u=y.evaluateFormula(h,s[l]))instanceof f.CalcError?s[l]='"'+u+'"':s[l]=s[l].replace(/=/g,""));a="=CONCAT("+s.join(",")+")"}(c=h.parent).aJb(o)||c.Yu(c.QHb,o,a,t,e,!0,"")}},t.prototype.getDefaultStyle=function(t){var e,n,o,r,i,a,l;return T(t)&&(t=3),(o=(n=(e=this).Oq)[t])?o:0!==t?(typeof(i=(r=e.ITa).getStyle(-1,-1,t))===W&&(i=e.Hq(i)),i||(i=new s.Style,r.do("setStyle",-1,-1,i,t)),a=1===t||2===t,typeof(i=i).hAlign===z&&(i.hAlign=a?1:3),typeof i.vAlign===z&&(i.vAlign=a?1:0),typeof i.imeMode===z&&(i.imeMode=1),i.font||typeof i.themeFont!==z||(i.themeFont="Body"),n[t]=i,i):((l=new s.Style).locked=!0,n[t]=l,l)},t.prototype.setDefaultStyle=function(t,e){T(e)&&(e=3);var n=this;0!==e&&n.ITa.do("setStyle",-1,-1,t,e),n.Oq[e]=_,n.Jq(),n.$p()},t.prototype.Hq=function(t){var e,n=this.Mq(t,!1);return n||((e=this.parent)?e.Mq(t,!1):_)},t.prototype.Dq=function(t,e,n,o,r,i,a,l,u,c){var f,h,p,d,g,m,y,v,C,b,w;if(T(n)&&(n=3),f=this,h=new s.Style,g=!1,0!==n){if(m=f.ITa,y=f.tables,v=m.getRowCount(n),C=m.getColumnCount(n),b=void 0,0<=t&&t<v&&0<=e&&e<C&&((b=o!==L?o:m.getStyle(t,e,n))&&b.charAt&&(b=f.Hq(b)),b))for(h.Yo(b,!0,10),g=!0,d=b.parentName;d&&(p=f.Hq(d));)h.Yo(p,!1,10,!0),d=p.parentName;if(l)return h;if(a!==L||u||(a=3===n&&y?y.find(t,e):_),c===L&&3===n&&f.pivotTables&&(c=f.pivotTables.Wic(t,e)||_),a&&!u&&(a.Yo(t,e,h),g=!0),c&&(c.Yo(t,e,h),g=!0),0<=t&&t<v&&((b=r!==L?r:m.getStyle(t,-1,n))&&b.charAt&&(b=f.Hq(b)),b))for(h.Yo(b,!g,30),g=!0,d=b.parentName;d&&(p=f.Hq(d));)h.Yo(p,!1,30,!0),d=p.parentName;if(0<=e&&e<C&&((b=i!==L?i:m.getStyle(-1,e,n))&&b.charAt&&(b=f.Hq(b)),b))for(h.Yo(b,!g,40),g=!0,d=b.parentName;d&&(p=f.Hq(d));)h.Yo(p,!1,40,!0),d=p.parentName}if((w=f.getDefaultStyle(n))&&w.charAt&&(w=f.Hq(w)),w)for(h.Yo(w,!g,50),d=w.parentName;d&&(p=f.Hq(d));)h.Yo(p,!1,50,!0),d=p.parentName;return h},t.prototype.getCellType=function(t,e,n){return this.tq(t,e,"cellType",n)||this.Al(n)},t.prototype.Al=function(t){T(t)&&(t=3);var e=this.Rq;return e||(e=this.Rq=new c.Text),3===t?e:1===t?new h.ColumnHeader:2===t?new h.RowHeader:0===t?new h.Corner:e},t.prototype.setCellType=function(t,e,n,o){var r=this.Iq(t,e,o);r||(r=new s.Style),r.cellType=n,this.setStyle(t,e,r,o)},t.prototype.Sq=function(t,e,n,o,i){var a,s,l,u,c,f,h=this;if(T(i)&&(i=3),(a=h.ITa).do("clearSpan",t,e,n,o,i),s=r.kf(t,e,n,o),l=h.Tq(s,i),u=h.Fia(l,i),a.do("addSpan",u,i),3===i){for(c=h.getSelections(),f=0;f<c.length;f++)c[f].intersect(t,e,n,o)&&(c[f]=c[f].union(s));a.do("setSelections",c)}h.$p()},t.prototype.Fia=function(t,e){var n=this.getRowCount(e),o=this.getColumnCount(e),i=t.row,a=t.col,s=t.rowCount,l=t.colCount;return i+s>n&&(s=n-i),a+l>o&&(l=o-a),r.kf(i,a,s,l)},t.prototype.addSpan=function(e,n,o,r,i){var a,s,l,u,c=this;if((1!==o||1!==r)&&0!==i&&(a=c.getRowCount(i),s=c.getColumnCount(i),!(e>=a||n>=s||e<-1||n<-1)&&(l=!0,m&&(3===i||T(i))&&(l=c.Vq(e,n,o,r,!1)),l))){if(c.ITa.qu(e,n,o,r,i))throw Error(ot().Exp_InvalidRange);c.wyb&&c.wyb(e,n,o,r),c.Sq(e,n,o,r,i),u={sheet:c,row:e,col:n,rowCount:o,colCount:r,sheetArea:i,changeType:"addSpan"},t.ao(c,X,u),c.Wq("spanChanged",u)}},t.prototype.removeSpan=function(e,n,o){var r,i,a,s=this;T(o)&&(o=3),(i=(r=s.ITa).findSpan(e,n,o))&&i.row===e&&i.col===n&&r.do("removeSpan",i,o),a={sheet:s,row:e,col:n,sheetArea:o,changeType:"removeSpan"},t.ao(s,X,a),s.Wq("spanChanged",a),s.$p()},t.prototype.getSpans=function(t,e){return 0===e?[]:this.ITa.getSpans(t,e,!0)},t.prototype.getSpan=function(t,e,n){return 0===n?_:this.ITa.findSpan(t,e,n)},t.prototype.repaint=function(t){this.Xq<=0&&this.yl&&this.yl.repaint(t)},t.prototype.Yq=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,d,g,m,y,v=this,C=v.parent,b=C&&C.options.scrollbarAppearance===p.ScrollbarAppearance.mobile,w=!1,T=!1,x=C&&C.options.scrollByPixel,S=mt(v),A=gt(v),I=A?v.Zq(A-1):v.$q(),R=S?v._q(S-1):v.ar();if(e<v.qq&&e>=I?(w=!0,v.rq(v.br(e+1),0)):x&&e===v.qq&&0!==v.eCb&&(w=!0,v.rq(e,0)),e>v.cr()&&e<=v.dr()){for(n=0,o=e,r=v.am(),(i=v.ITa.findSpan(t,o))&&(o=i.col+i.colCount-1);o>v.qq&&!((n+=v.Tl(o))>r.er);)o--;a=void 0,s=void 0,x?(o===v.qq&&n<r.er&&(n+=v.Tl(o)),a=o,s=r.er-n):(a=v.Zq(o),s=0),w=!0,v.rq(a,s)}if(t<v.lq&&t>=R?(T=!0,v.mq(v.gr(t+1),0)):x&&t===v.lq&&0!==v.cCb&&(T=!0,v.mq(t,0)),t>v.hr()&&t<=v.ir()){for(l=0,u=t,(c=v.ITa.findSpan(u,e))&&(u=c.row+c.rowCount-1),f=v.am();u>v.lq&&!((l+=v.Sl(u))>f.jr);)u--;h=void 0,d=void 0,x?(u===v.lq&&l<f.jr&&(l+=v.Sl(u)),h=u,d=f.jr-l):(h=v._q(u),d=0),T=!0,v.mq(h,d)}x||e!==v.dr()||v.rq(v.lr(),0),b&&(g=C.St,m=C.Pt,y=C.ku,T&&(g.Jwa(p.ScrollbarState.show),y.Rdc(!0)),w&&(m.Jwa(p.ScrollbarState.show),y.Rdc(!1)))},t.prototype.hitTest=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k=this;if(k.am(),r={x:t,y:e},i=k.rowOutlines,a=k.columnOutlines,i&&(s=i.hitTest(k,t,e)),!s&&a&&(s=a.hitTest(k,t,e)),s)r.outlineHitInfo=s;else{if(l=k.nr(e),u=k.or(t),r.rowViewportIndex=l,r.colViewportIndex=u,r.row=k.pr(e,l),r.col=k.qr(t,u),l>=0&&l<=2&&u>=0&&((c=k.rr(l,u,L,r.row,r.col))&&!0!==n&&(r.row=c.row,r.col=c.col)),r.hitTestType=k.sr(l,u),f=k.mm,p=(h=k.xr)&&h.hitTest(r,t,e),g=void 0,(d=k.tables)&&(g=-1===r.rowViewportIndex?d&&d.find(k.getActiveRowIndex(),k.getActiveColumnIndex()):d.find(r.row,r.col)),p||(p=(m=g&&g.xr)&&m.hitTest(r,t,e)),y=d&&!p&&d.gJb(t,e,r))return r.tableSelectInfo=y,y.table&&y.table.xr&&(r.filterButtonHitInfo=p),r;(v=f.Yia&&f.Yia(r,t,e))?r.dragMergeInfo=v:(C=f.tr&&f.tr(r,t,e))?r.dragInfo=C:(b=f.ur(r,t,e,5))?r.resizeInfo=b:(w=f.vr?f.vr(r,t,e):_)?r.formulaRangeHitInfo=w:(x=(T=k.ITa.Ky)&&T.hitTest(t,e))?r.commentHitInfo=x:(A=(S=k.wr)&&S.hitTest(t,e,o),I=void 0,k.shapes&&(I=k.shapes.hitTest(t,e)),I?r.shapeHitInfo=I:A?r.floatingObjectHitInfo=A:p?r.filterButtonHitInfo=p:(R=g&&!g.hJb()&&f.iJb&&f.iJb(r,g))?r.resizeTableHitInfo=R:r.cellTypeHitInfo=k.yr(r,t,e))}return r},t.prototype.getCellRect=function(t,e,n,o,i){var a,s,l,u,c,f,h=3;return-1===n?h=1:-1===o&&(h=2),s=(a=this).am(),-1===n&&-1===o?new r.Rect(s.zr,s.Ar,s.Br,s.Cr):(l=a.Dr(),T(n)&&(n=a.Er(t)),T(o)&&(o=a.Fr(e)),u=a.Gr(n,h).findRow(t),c=a.Hr(o,h).findCol(e),(f=a.Ir(n,o,h,i).findCell(t,e))?new r.Rect(f.x-l.x,f.y-l.y,f.width,f.height):u&&c?new r.Rect(c.x-l.x,u.y-l.y,c.width,u.height):new r.Rect)},t.prototype.Jr=function(t,e,n){var o,i,a,s,l=this,u=l.mm,c=!1,f=l.Jl,h=l.Kl;T(t)||(l.Jl=t,c=!0),T(e)||(l.Kl=e,c=!0),l.ITa.setCellState(f,h,p.CellStatesType.active,!1,p.SheetArea.viewport),l.xIb&&l.xIb(p.CellStatesType.active,f,h,p.SheetArea.viewport),l.ITa.setCellState(t,e,p.CellStatesType.active,!0,p.SheetArea.viewport),l.xIb&&l.xIb(p.CellStatesType.active,t,e,p.SheetArea.viewport),!n&&u&&c&&(u.Qq(),(i=(o=l.ITa).getDynamicArrayInfo(t,e))!==(a=o.WIb)&&(o.WIb=i,l.Xq<=0&&(s=void 0,i&&a?s=r.getUnionRange(i,a):(i=i||a,s=r.kf(i.row,i.col,i.rowCount,i.colCount)),l.yl.im(s))))},t.prototype.gCb=function(t,e,n,o,r){var i=t.getCellRect(e,n,o,r),a=i.x,s=i.y,l=i.width,u=i.height;return i.x=a-2,i.y=s-2,i.width=l+4,i.height=u+4,i},t.prototype.Kr=function(t,e,n,o,i){var a,s=this,l=s.Jl,u=s.Kl,c=s.ITa,f=c.getSpan(t,e);s.Lr=f.rowCount,s.Mr=f.colCount,s.Xq<=0&&(a=c.getSpan(l,u),s.yl.im(r.kf(l,u,a.rowCount,a.colCount))),s.Nr=n,s.Pr=o,s.Jr(t,e,i),s.Qr=t,s.Rr=e},t.prototype.setActiveCell=function(t,e,n,o){this.Sr(t,e,n,o,2)},t.prototype.Sr=function(t,e,n,o,i){var a,s,l=this,u=ht(l),c=ft(l);t<0?t=0:t>=u&&(t=u-1),e<0?e=0:e>=c&&(e=c-1),l.Tr(),a=2===i?r.Vl.Wl(l):1===i,l.Kr(t,e,n,o,!a),s=l.ITa.getSpan(t,e),l.Ur(s.row,s.col,s.rowCount,s.colCount),l.$p()},t.prototype.getActiveRowIndex=function(){return this.Jl},t.prototype.getActiveColumnIndex=function(){return this.Kl},t.prototype.getRowResizable=function(t,e){return this.ITa.getResizable(!0,e,t)},t.prototype.setRowResizable=function(t,e,n){this.Vr(t,e,$,!0,n)},t.prototype.Vr=function(t,e,n,o,r){T(r)&&(r=3),n!==q&&n!==U||!D.test(e)||(n=J);var i,a=this,s=a.ITa;switch(n){case $:i=s.getResizable(o,r,t);break;case"pageBreak":i=s.getPageBreak(o,r,t);break;case Q:i=s.getVisible(o,r,t);break;case q:i=s.getSize(o,r,t);break;case U:i=s.getSize(o,r,t)}switch(o?a.pCb(t,r,n,e,i):a.qCb(t,r,n,e,i),n){case $:s.do("setResizable",o,r,t,e);break;case"pageBreak":s.do("setPageBreak",o,r,t,e);break;case Q:s.do("setVisible",o,r,t,e),o&&m&&3===r&&i!==e&&a.recalcRows([t]);break;case q:s.do("setSize",o,r,t,e),!m||3!==r||i===e||0!==i&&0!==e||a.recalcRows([t]);break;case U:s.do("setSize",o,r,t,e),!m||3!==r||i===e||0!==i&&0!==e||a.recalcCols([t]);break;case J:s.do("setStarSize",o,r,t,e)}o?a.kq(t,r,n,e,i):a.pq(t,r,n,e,i)},t.prototype.getColumnResizable=function(t,e){return this.ITa.getResizable(!1,e,t)},t.prototype.setColumnResizable=function(t,e,n){this.Vr(t,e,$,!1,n)},t.prototype.getRowHeight=function(t,e,n){var o,r,i,a,s,l,u=this;if(T(e)&&(e=3),n)return u.ITa.getStarSize(!0,e,t);if(3===e||2===e){if(o=u.getRowCount(e),t<0||t>=o)return 0;for(r=u.Wr,i=0;i<r.length;i++)if(!r[i].Xr(t))return 0}return s=(a=u.defaults).rowHeight,1===e&&(s=a.colHeaderRowHeight),(l=u.ITa.getSize(!0,e,t))||0===l?l:H(s)},t.prototype.Yr=function(t,e){var n,o,r;return T(e)&&(e=3),this,o=(n=this.defaults).rowHeight,1===e&&(o=n.colHeaderRowHeight),(r=this.ITa.getActualSize(!0,e,t))||0===r?r:H(o)},t.prototype.setRowHeight=function(t,e,n){this.Vr(t,e,q,!0,n),this.jq=!0,this.$p()},t.prototype.getRowVisible=function(t,e,n){var o,r;if(T(e)&&(e=3),!n&&(3===e||2===e))for(o=this.Wr,r=0;r<o.length;r++)if(!o[r].Xr(t))return!1;return this.ITa.getVisible(!0,e,t)},t.prototype.setRowVisible=function(t,e,n){var o=this;o.Vr(t,e,Q,!0,n),o.jq=!0,o.$p()},t.prototype.getColumnWidth=function(t,e,n){var o,r,i,a,s,l,u=this;if(T(e)&&(e=3),n)return u.ITa.getStarSize(!1,e,t);if(r=(o=u.defaults).colWidth,2===e&&(r=o.rowHeaderColWidth),3===e||1===e){if(i=u.getColumnCount(e),t<0||t>=i)return 0;for(a=u.Zr,s=0;s<a.length;s++)if(!a[s].Xr(t))return 0}return(l=this.ITa.getSize(!1,e,t))||0===l?l:H(r)},t.prototype.$r=function(t,e){var n,o,r;return T(e)&&(e=3),this,o=(n=this.defaults).colWidth,2===e&&(o=n.rowHeaderColWidth),(r=this.ITa.getActualSize(!1,e,t))||0===r?r:H(o)},t.prototype.setColumnWidth=function(t,e,n){this.Vr(t,e,U,!1,n),this.oq=!0,this.$p()},t.prototype.getColumnVisible=function(t,e){var n,o;if(T(e)&&(e=3),3===e||1===e)for(n=this.Zr,o=0;o<n.length;o++)if(!n[o].Xr(t))return!1;return this.ITa.getVisible(!1,e,t)},t.prototype.setColumnVisible=function(t,e,n){var o=this;o.Vr(t,e,Q,!1,n),o.oq=!0,o.$p()},t.prototype.zoom=function(t){var e,n=this;return 0===arguments.length?n.ITa.getZoomFactor():(t=F(t),!P(t)&&isFinite(t)&&(t>4?t=4:t<.25&&(t=.25),e=n.ITa.getZoomFactor(),n.XSa(t),n.eCb=n.eCb/e*t,n.cCb=n.cCb/e*t,n.oq=!0,n.jq=!0,n.$p()),n)},t.prototype.XSa=function(e){this.ITa.do("setZoomFactor",e),t.ao(this,X,{changeType:"zoomSheet"})},t.prototype.x6a=function(){var t=this;t._r=_,t.as={colHeader:_,viewport:_},t.bs={rowHeader:_,viewport:_}},t.prototype.invalidateLayout=function(){var e,n,o=this,i=o.mm;o.ITa.$Gb(),o.x6a(),t.ao(o,"beforeLayoutChanged",{changeType:"invalidateLayout"}),o.oq&&(o.ds(),o.oq=!1),o.jq&&(o.es(),o.jq=!1),o.x6a(),t.ao(o,X,{changeType:"invalidateLayout"}),i&&i.cs&&r.Vl.Wl(o)&&!i.byb(o)&&i.cs(o.Jl,o.Kl),o.$l=!0,(e=o.parent)&&e.options.enableAccessibility&&(n=o.cgc(),e.dgc(n))},t.prototype.$p=function(){var t=this;t.Xq<=0&&(t.invalidateLayout(),t.repaint())},t.prototype.getViewportHeight=function(t){var e=this.am();return 0===t?e.fs:1===t?e.jr:2===t?e.gs:0},t.prototype.getViewportWidth=function(t){var e=this.am();return 0===t?e.hs:1===t?e.er:2===t?e.js:0},t.prototype.getViewportTopRow=function(t){var e=this,n=mt(e);return 0===t?0:1===t?G(n,e.lq):2===t?G(n,ht(e)-dt(e)):-1},t.prototype.getViewportBottomRow=function(t){var e,n,o,r,i,a,s=this;if(2===t)return ht(s)-1;for(e=s.getViewportTopRow(t),n=s.getViewportHeight(t),o=1===t?s.cCb:0,r=0,i=ht(s)-dt(s),0===t&&(i=B(mt(s),i)),a=e;a<i&&o<n;a++,r++)o+=s.Sl(a);return e+r-1},t.prototype.jCb=function(t){var e,n=this,o=n.getViewportTopRow(t),r=n.getViewportBottomRow(t);for(e=o;e<r+1;e++)if(e>-1&&n.getRowVisible(e,3)&&n.Sl(e,3)>0)return e;return-1},t.prototype.getViewportLeftColumn=function(t){var e=this,n=gt(e);return 0===t?0:1===t?G(n,e.qq):2===t?G(n,ft(e)-pt(e)):-1},t.prototype.getViewportRightColumn=function(t){var e,n,o,r,i,a,s=this;if(2===t)return ft(s)-1;for(e=s.getViewportLeftColumn(t),n=s.getViewportWidth(t),o=0,r=1===t?s.eCb:0,i=ft(s)-pt(s),0===t&&(i=B(gt(s),i)),a=e;a<i&&r<n;a++,o++)r+=s.Tl(a);return e+o-1},t.prototype.kCb=function(t){var e,n=this,o=n.getViewportLeftColumn(t),r=n.getViewportRightColumn(t);for(e=o;e<r+1;e++)if(e>-1&&n.getColumnVisible(e,3)&&n.Tl(e,3)>0)return e;return-1},t.prototype.showCell=function(t,e,n,o){var r,i,a,s,l,u,c=this;t<0||t>=ht(c)||e<0||e>=ft(c)||(r=c.Fr(e),i=c.Er(t),a=c.getViewportTopRow(i),s=c.getViewportLeftColumn(r),1===r&&(e=c.ks(e,o)),1===i&&(t=c.ms(t,n)),l=!1,1===i&&t!==a&&(t=B(t,c.ns()),c.lq=t,c.cCb=0,c.os(),l=!0),1===r&&e!==s&&(e=B(e,c.ps()),c.qq=e,c.eCb=0,c.qs(),l=!0),l&&((u=c.parent)&&!u.options.scrollbarShowMax&&(c.oq=!0,c.jq=!0),c.$p()))},t.prototype.Er=function(t){var e=this,n=1;return t<mt(e)?n=0:t>=ht(e)-dt(e)&&(n=2),n},t.prototype.Fr=function(t){var e=this,n=1;return t<gt(e)?n=0:t>=ft(e)-pt(e)&&(n=2),n},t.prototype.ks=function(t,e){var n,o=this,r=o.ss,i=o.Fr(t),a=o.getViewportLeftColumn(i);if(0!==e)if(1===e)for(n=H((o.getViewportWidth(i)-r._m(t))/2);0<t&&!((n-=r._m(t-1))<0);t--);else if(2===e)for(n=o.getViewportWidth(i)-r._m(t);0<t&&!((n-=r._m(t-1))<0);t--);else if(3===e&&t>=a)for(n=o.getViewportWidth(i)-r._m(t);a<t&&!((n-=r._m(t-1))<0);t--);return t},t.prototype.ms=function(t,e){var n,o=this,r=o.ss,i=o.Er(t),a=o.getViewportTopRow(i);if(0!==e)if(1===e)for(n=H((o.getViewportHeight(i)-r.Sl(t))/2);0<t&&!((n-=r.Sl(t-1))<0);t--);else if(2===e)for(n=o.getViewportHeight(i)-r.Sl(t);0<t&&!((n-=r.Sl(t-1))<0);t--);else if(3===e&&!(t<a||-1===a))for(n=o.getViewportHeight(i)-r.Sl(t);a<t&&!((n-=r.Sl(t-1))<0);t--);return t},t.prototype.showColumn=function(t,e){this.showCell(this.lq,t,0,e)},t.prototype.showRow=function(t,e){this.showCell(t,this.qq,e,0)},t.prototype.suspendEvent=function(){this.jm++},t.prototype.resumeEvent=function(){this.jm--,this.jm<0&&(this.jm=0)},t.prototype.isEventSuspended=function(){return this.jm>0},t.prototype.currentTheme=function(t){var e=this;return 0===arguments.length?(e.Pm||e.ts(),e.Pm):(typeof t===W&&(t=v.Themes[t]?v.Themes[t]:new v.Theme(t)),e.Pm=t,e.yl.us(),e.Jq(),e.$p(),e)},t.prototype.P3=function(){var t=r.Im.Lm(""),e=j(t.zIndex),n=v.Themes.Office2007;return e>2007&&(n=v.Themes.Office),n},t.prototype.ts=function(){this.Pm=this.P3(),this.Jq()},t.prototype.reset=function(){this.vs(),this.$p()},t.prototype.vs=function(){var e,n,o=this,i=o.DHb();o.Pp(),o.Nr=0,o.Pr=0,o.T3(),o._r=_,o.as={colHeader:_,viewport:_},o.bs={rowHeader:_,viewport:_},o.lq=0,o.cCb=0,o.qq=0,o.eCb=0,o.frozenRowCount(0),o.frozenColumnCount(0),o.frozenTrailingRowCount(0),o.frozenTrailingColumnCount(0),t.ao(o,"beforeSetHost"),(e=o.parent)&&((n=e.getActiveSheet())&&o.name()===n.name()&&o.ws(e.xs)),o.Cq=[{},{},{},{}],o.ss=new r.ln(o),o.Oq={},m&&o.resetCalc(),o.ITa=new l.lUa(o,t.Rp,t.Sp,t.Vp,t.Tp,o.name()),o.defaults=o.ITa.defaults,o.DHb(i),o.ts(),o.Lq={},o.oq=!0,o.jq=!0,o.parent&&o.parent.xD?o.Xq=o.parent.xD:o.Xq=0,o.parent&&o.parent.jm?o.jm=o.parent.jm:o.jm=0,o.gga=0,o.Js=!1,o.Ks=_,o.Wr=[],o.Zr=[],o.OIb=!1,t.ao(o,"init")},t.prototype.T3=function(){var t=this;R(it,(function(e,n){if(!T(n)){var o=n;"gridline"===e?o={color:r.Im.Lm("gc-gridlineColor").borderTopColor,showVerticalGridline:!0,showHorizontalGridline:!0}:"object"==typeof o&&(o=u.GC$.extend({},n)),t.options[e]=o}}))},t.prototype.Ls=function(e){var n,o=this;for(o.parent=e,n=o.Xq;n<e.xD;n++)o.suspendPaint();o.jm=e.jm,t.ao(o,"attach",e)},t.prototype.jJb=function(t,e){return t.row===e.row&&t.col===e.col&&t.rowCount===e.rowCount&&t.colCount===e.colCount},t.prototype.kJb=function(t,e,n,o,r){var i,a,s=this.Ms(e,n,o,r).ranges;for(i=0;i<s.length;i++)for(a=0;a<t.length;a++)if(this.jJb(t[i],s[a]))return!0;return!1},t.prototype.lJb=function(t,e,n,o,r){var i,a=!1;return void 0!==r?0===r?(i=this.Ms(t,e,n,this.getColumnCount()-e).ranges).length>0&&(t-1>0&&(a=this.kJb(i,t-1,e,1,this.getColumnCount()-e)),a||(a=this.kJb(i,t+n,e,1,this.getColumnCount()-e)),a||(a=this.kJb(i,t,e,n,1))):(i=this.Ms(t,e,this.getRowCount()-t,o).ranges).length>0&&(t-1>0&&(a=this.kJb(i,t-1,e,this.getRowCount()-t,1)),a||(a=this.kJb(i,t+n,e,this.getRowCount()-t,1)),a||(a=this.kJb(i,t,e,1,o))):a=!0,a},t.prototype.Y3=function(t,e,n,o,i,a,s,l){var u,c=this;return!s&&c.options.isProtected&&c.ou(r.kf(t,e,n,o))?(i&&c.Os(1,i),!1):(u=this.lJb(t,e,n,o,l),!(m&&u&&!c.Vq(t,e,n,o)&&(a&&c.Os(1,a),1)))},t.prototype.clear=function(t,e,n,o,r,i){0!==r&&this.cg(t,e,n,o,r,i)},t.prototype.cg=function(e,n,o,r,i,a,s,l){var u,c,f,h,p,d,g,y,v,C,b,w,x,S,A=this,I=m;try{if(I&&A.suspendCalcService(),A.suspendPaint(),u=A.defaults,c=void 0,f=void 0,h=void 0,p=void 0,3,T(i)||3===i){if(I&&!A.Vq(e,n,o,r))return!1;if(1&a&&A.getDataSource&&A.getDataSource()){for(A.suspendEvent(),c=e;c<e+o;c++)if(!(s&&A.Ps&&A.Ps(c)))for(f=n;f<n+r;f++)A.setValue(c,f,_,i);A.resumeEvent()}}for(d={changeType:"clear",row:e,col:n,rowCount:o,colCount:r,sheetArea:i,type:a,ignoreTable:l},t.ao(A,X,d),g=A.ITa,y=I&&A.Bj(),c=-1===e?0:e,v=-1===e?g.getRowCount(i):o,f=-1===n?0:n,C=-1===n?g.getColumnCount(i):r,b=[],w=c;w<v+c;w++)s&&A.Ps&&A.Ps(w)&&b.push(w);if(g.do("clear",c,f,v,C,a,b,i),y&&1&a&&(y.Sg(c,f,v,C),y.clear(c,f,v,C,g.dUa())),8&a&&!(e>=0&&n>=0))if(n>=0)for(p=0;p<C;p++)A.setTag(-1,f+p,_,i);else if(e>=0)for(h=0;h<v;h++)s&&A.Ps&&A.Ps(c+h)||A.setTag(c+h,-1,_,i);else A.setTag(-1,-1,_,i);if(256&a&&!(e>=0&&n>=0))if(n>=0)for(p=0;p<C;p++)A.setHyperlink(-1,f+p,_,i);else if(e>=0)for(h=0;h<v;h++)s&&A.Ps&&A.Ps(c+h)||A.setHyperlink(-1,-1,_);if(2&a&&!(e>=0&&n>=0))if(n>=0)for(p=0;p<C;p++)A.setStyle(-1,f+p,_,i);else if(e>=0)for(h=0;h<v;h++)s&&A.Ps&&A.Ps(c+h)||A.setStyle(c+h,-1,_,i);else A.setStyle(-1,-1,_,i);if(32&a){if(e<0)for(p=0;p<C;p++)A.setColumnVisible(f+p,!0,i),A.setColumnResizable(f+p,!0,i),A.setColumnWidth(f+p,2===i?u.rowHeaderColWidth:u.colWidth,i);if(n<0)for(h=0;h<v;h++)s&&A.Ps&&A.Ps(c+h)||(A.setRowVisible(c+h,!0,i),A.setRowResizable(c+h,!0,i),A.setRowHeight(c+h,1===i?u.colHeaderRowHeight:u.rowHeight,i))}for((T(i)||3===i)&&I&&1==(1&a)&&((x=A.Bj())&&x.Ag(e,n,o,r)),S=[],h=0;h<v;h++)for(p=0;p<C;p++)S.push({row:c+h,col:f+p});A.Bu(e,n,v,C,S,2,i)}finally{A.resumePaint(),I&&A.resumeCalcService(!1)}},t.prototype._p=function(){var t,e,n,o,r=this,i=r.options,a=i.protectionOptions;i.isProtected&&a&&(t=a.allowSelectLockedCells,e=a.allowSelectUnlockedCells,(!1===t&&!1!==e||!1!==t&&!1===e)&&(n=r.Jl,o=r.Kl,r.Qs(n,o)||(r.Tr(),r.Rs(n,o,!0),r.Ss(4,n,o))))},t.prototype.setArray=function(t,e,n,o){var r,i,a,s,l=this,c=m;if(o=c&&o,r=ht(l),i=ft(l),n&&0<=t&&t<r&&0<=e&&e<i){c&&l.suspendCalcService(),l.suspendPaint();try{R(n,(function(n,c){u.GC$.isArray(c)?R(c,(function(u,c){s=e+u,(a=t+n)<r&&s<i&&(o?l.setFormula(a,s,c):l.setValue(a,s,c,3,!0))})):(s=e,(a=t+n)<r&&s<i&&(o?l.setFormula(a,s,c):l.setValue(a,s,c,3,!0)))}))}finally{c&&l.resumeCalcService(),l.resumePaint()}}},t.prototype.getArray=function(t,e,n,o,r){var i,a,s=this,l=[],u=ht(s),c=ft(s);if(r=r&&m,0<=t&&t<u&&0<=e&&e<c)for(t+n>u&&(n=u-t),e+o>c&&(o=c-e),i=0;i<n;i++)for(l[i]=[],a=0;a<o;a++)l[i][a]=r?s.getFormula(t+i,e+a):s.getValue(t+i,e+a);return l},t.prototype.setTag=function(t,e,n,o){var r,i,a,s,l,u;if(T(o)&&(o=3),r=this,0!==o){if(a=(i=r.ITa).getRowCount(o),s=i.getColumnCount(o),t<-1||t>=a||e<-1||e>=s)return;n=N(n),l=void 0,(u=r.jm>0)||(l=r.getTag(t,e,o)),i.do("setValueForKey",t,e,Y,n,o),u||l===n||(-1!==t&&-1!==e?r.Bq(Y,t,e,o,l,n):-1!==t&&-1===e?r.kq(t,o,Y,n,l):-1===t&&-1!==e&&r.pq(e,o,Y,n,l))}},t.prototype.getTag=function(t,e,n){var o;return T(n)&&(n=3),0!==n?(o=this.ITa.getValueForKey(t,e,Y,n),E(o)):_},t.prototype.tag=function(t){var e,n=this;return 0===arguments.length?(e=n.ITa.getValueForKey(-1,-1,Y,3),E(e)):(n.ITa.do("setValueForKey",-1,-1,Y,N(t),3),n)},t.prototype.getParent=function(){return this.parent},t.prototype.getDirtyRows=function(){return lt(this,!0)},t.prototype.getInsertRows=function(){return lt(this,!1)},t.prototype.getDeletedRows=function(){var t=[],e=this.Ts;return e&&R(e,(function(e,n){n&&!u.GC$.isFunction(n)&&t.push({row:n.row,originalItem:n.data})})),t},t.prototype.hasPendingChanges=function(){var t,e=this.Ts;return!!(e&&e.length>0)||(t=this.ITa.hUa(),!k(t))},t.prototype.clearPendingChanges=function(e){var n,o,r,i,a,s=this;return T(e)||k(e)?(s.ITa.iUa(),s.Ts=[],void t.ao(s,"clearPendingChanges")):(n=e.row,o=e.col,r=e.rowCount,i=e.colCount,(1&(a=(a=e.clearType)||rt.dirty))===rt.dirty&&s.Rec(n,o,r,i),(2&a)===rt.insert&&s.Sec(n,o,r,i),void((4&a)===rt.delete&&s.Tec(n,o,r,i)))},t.prototype.Rec=function(e,n,o,r){var i=this,a=i.ITa,s=i.Uec(e,n,o,r),l=i.Vec(n,r);s?(a.Qec(),t.ao(i,"clearPendingChanges")):a.Mec(l,e,n,o,r)},t.prototype.Sec=function(t,e,n,o){var r=this,i=r.ITa,a=r.Uec(t,e,n,o),s=r.Vec(e,o);i.Lec(a,s,t,n)},t.prototype.Tec=function(t,e,n,o){var r,i,a,s=this;if(s.Uec(t,e,n,o))s.Ts=[];else if(s.Vec(e,o)&&(r=s.Ts))for(i=[],R(r,(function(e,o){if(o){var r=o.row;t<=r&&r<t+n&&i.push(e)}})),a=i.length-1;a>=0;a--)s.Ts.splice(i[a],1)},t.prototype.Vec=function(t,e){return T(t)||-1===t||0===t&&this.getColumnCount()===e},t.prototype.Wec=function(t,e){return T(t)||-1===t||0===t&&e===this.getRowCount()},t.prototype.Uec=function(t,e,n,o){return this.Vec(t,n)&&this.Vec(e,o)},t.prototype.getDirtyCells=function(t,e,n,o){var r,i,a,s,l,u,c,f=this;if(T(t)&&(t=-1),T(e)&&(e=-1),(T(n)||n<=0)&&(n=1),(T(o)||o<=0)&&(o=1),r=[],i=f.ITa.hUa(),!k(i)){if(a=[],t>=0)for(s=t;s<t+n;s++)a.push(s);else for(l in i)M(i,l)&&a.push(j(l));R(a,(function(t,n){var a,s;if((u=i[n])&&"e"===u.rs)if(e>=0)for(a=e;a<e+o;a++)(c=u[a])&&r.push(Ct(f,n,a,c.oldValue));else for(s in u)P(s)||(c=u[s])&&r.push(Ct(f,n,j(s),c.oldValue))}))}return r},t.prototype.suspendDirty=function(){this.gga++,this.ITa.jUa()},t.prototype.resumeDirty=function(){var t=this;t.gga--,t.gga<0&&(t.gga=0),t.ITa.kUa()},t.prototype.isDirtySuspended=function(){return this.gga>0},t.prototype.ad=function(t){this.Us(new r.Rect(0,0,0,0)),this.vs(),this.cq(t)},t.prototype.Vs=function(){var t,e=this.Ws(),n={top:0,left:0};return e&&e.parentElement&&((n=u.GC$(e).offset())&&(n.top+=O.body.clientTop||0,n.left+=O.body.clientLeft||0)),(t=e&&e.canvasOffset)&&(n=t),n},t.prototype.ws=function(e){var n,o,i;e&&((n=this).Js=!1,n.Xs&&n.no(!1),o=x("canvas"),i=n.parent&&n.parent.options.enableAccessibility?"":ot().NeedCanvasSupport,u.GC$(o).attr("id",e.getAttribute("id")+"_vp").attr("gcUIElement","gcWorksheetCanvas").html(i).appendTo(e),r.En.Kn(o,_,n),n.Xs=o,n.fq(),n.repaint(),n.parent&&n.parent.Ys(),t.ao(n,"setHost",u.GC$(o)))},t.prototype.Jgc=function(t,e,n,o,r,i,a,s,l){var u,c,f=this;for(u=n;u<o;u++)c=f.getText(e,u,l),t.push('"'+c+'"');for(u=r;u<i;u++)c=f.getText(e,u,l),t.push('"'+c+'"');for(u=a;u<s;u++)c=f.getText(e,u,l),t.push('"'+c+'"')},t.prototype.Kgc=function(){var t,e,n,o,r,i=this,a=i.getViewportTopRow(1),s=i.getViewportBottomRow(1),l=i.getViewportLeftColumn(1),u=s-a+1,c=i.getViewportRightColumn(1)-l+1,f=i.getRowCount(p.SheetArea.colHeader),h=i.getColumnCount(p.SheetArea.rowHeader),d=i.frozenColumnCount(),g=i.frozenTrailingColumnCount(),m=i.getColumnCount(),y=i.frozenRowCount(),v=i.frozenTrailingRowCount(),C=i.getRowCount(),b=[];for(t=0;t<f;t++)e=[],i.Jgc(e,t,0,d,l,l+c,m-g,m,p.SheetArea.colHeader),b.push(e.join(","));for(t=0;t<y;t++){for(n=[],o=0;o<h;o++)r=i.getText(t,o,p.SheetArea.rowHeader),n.push('"'+r+'"');i.Jgc(n,t,0,d,l,l+c,m-g,m),b.push(n.join(","))}for(t=a;t<a+u;t++){for(n=[],o=0;o<h;o++)r=i.getText(t,o,p.SheetArea.rowHeader),n.push('"'+r+'"');i.Jgc(n,t,0,d,l,l+c,m-g,m),b.push(n.join(","))}for(t=C-v;t<C;t++){for(n=[],o=0;o<h;o++)r=i.getText(t,o,p.SheetArea.rowHeader),n.push('"'+r+'"');i.Jgc(n,t,0,d,l,l+c,m-g,m),b.push(n.join(","))}return b.join(";")},t.prototype.cgc=function(t){var e,n,o,i,a,s=this;return r.util.sl()?s.Kgc():(e=s.Jl,n=s.Kl,o=p.SheetArea.viewport,!t||T(t.row)||T(t.col)||(e=t.row,n=t.col,o=t.hitTestType),i=ot(),a="",o===p.SheetArea.rowHeader?a=i.ARIA_RowHeader+" ":o===p.SheetArea.colHeader&&(a=i.ARIA_ColumnHeader+" "),a+i.ARIA_Cell+"("+e+","+n+") "+i.ARIA_HasValue+" "+s.getText(e,n,o))},t.prototype.fq=function(){var t,e,n,o,i,a,s,l,c=this,f=c.Ws();f&&f.parentNode&&(e=(t=getComputedStyle(f.parentNode)).width,n=t.height,(o=e.indexOf("px"))>0&&(e=e.substring(0,o)),(o=n.indexOf("px"))>0&&(n=n.substring(0,o)),i=j(e),a=j(n),P(i)&&(i=u.GC$(f.parentNode).width()),P(a)&&(a=u.GC$(f.parentNode).height()),0!==i&&0!==a&&(s=G(i,0),l=G(a,0),f.style.display="none",f.style.display="",f.width=s,f.height=l,f.style.width=s+"px",f.style.height=l+"px",s=f.clientWidth||f.width,l=f.clientHeight||f.height,c.Zs.width=s,c.Zs.height=l,r.En.Pn(f,s,l),c.invalidateLayout()))},t.prototype.no=function(e,n){var o,i,a,s=this;!0!==s.Js&&(r.En.Sn(s),s.isEditing&&s.isEditing()&&s.Yoa(),t.ao(s,"dispose",{clearCache:e,isSheetDestroy:!0,hasActiveSheet:n}),(o=s.Xs)&&((i=o.parentNode)&&i.removeChild(o),s.Xs=_),s.$s(),s.ITa&&s.ITa.no(e),!1!==e&&(s.Js=!0,(a=s.at)&&a.no(),s.parent=_,s.ITa=_,s.ss&&(s.ss.no(),s.ss=_),s.bt&&(s.bt.no(),s.bt=_),r.Vl.Wl(s)&&r.Vl.Zl(_,!0),s.uu&&(s.uu=_),s.Wr=_,s.Zr=_))},t.prototype.$s=function(){var t=this.dt;t&&(u.GC$(t).remove(),this.dt=L)},t.prototype.vq=function(t,e,n,o,r){var i,a,s,l;return T(o)&&(o=3),3===o&&this.jIb&&((i=t.getDynamicArrayInfo(e,n))&&i.isValid&&(e!==i.row||n!==i.col))?_:(a=this.et,!this.loading&&a&&(a.getCalcService().calcOnDemand&&3===o&&((s=a.qg(e,n))&&!0===s.$l&&(s.$l=!1,delete s.dh,delete s.eh,a.recalculateCell(e,n),this.yj().zIc()))),l=t.getValue(e,n,o,this.loading,r),l=E(l))},t.prototype.Tq=function(t,e){var n,o,i,a,s;return T(e)&&(e=3),n=r.kf(-1,-1,-1,-1),t&&(this,o=t.row,i=t.col,a=t.rowCount,s=t.colCount,-1===i&&(i=0,s=this.getColumnCount(e)),-1===o&&(o=0,a=this.getRowCount(e)),n.col=i,n.row=o,n.colCount=s,n.rowCount=a),n},t.prototype.getRangeRect=function(t,e,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b=new r.Rect(-1,-1,-1,-1),w=this,T=w.am();if(0===T.width||0===T.height)return b;if(o=w.it(e),i=w.jt(t),!o||0===o.length||!i||0===i.length)return b;return a=w.Tq(n),s=w.ss,l=a.row,u=a.row+a.rowCount-1,c=a.col,f=a.col+a.colCount-1,h=mt(w),p=ht(w)-dt(w)-1,d=gt(w),g=ft(w)-pt(w)-1,m=o[0].col,y=o[o.length-1].col,v=i[0].row,C=i[i.length-1].row,c<m&&(c=function(t,e){for(;t>e;)if(t--,w.getColumnVisible(t))return t;return t}(m,c)),f>y&&(f=function(t,e){for(;t<e;)if(t++,w.getColumnVisible(t))return t;return t}(y,f)),l<v&&(l=function(t,e){for(;t>e;)if(t--,w.getRowVisible(t))return t;return t}(v,l)),u>C&&(u=function(t,e){for(;t<e;)if(t++,w.getRowVisible(t))return t;return t}(C,u)),f<c||u<l||(0===e?c<d&&(b.x=T.kt+ut(s,0,c-1),b.width=ut(s,c,f)):1===e?c<=g&&f>=d&&(b.x=c<m?o[0].x-ut(s,c,m-1):o[0].x+ut(s,m,c-1),b.width=ut(s,c,f)):2===e&&f>g&&(b.x=c<m?T.lt-ut(s,c,m-1):T.lt+ut(s,m,c-1),b.width=ut(s,c,f)),0===t?l<h&&(b.y=T.nt+ct(s,0,l-1),b.height=ct(s,l,u)):1===t?l<=p&&u>=h&&(b.y=l<v?i[0].y-ct(s,l,v-1):i[0].y+ct(s,v,l-1),b.height=ct(s,l,u)):2===t&&u>p&&(b.y=l<v?T.ot-ct(s,l,v-1):T.ot+ct(s,v,l-1),b.height=ct(s,l,u))),b},t.prototype.isintersectWithArrayFormula=function(t){var e,n,o=this.Bj();if(o)for(e=t.row;e<t.row+t.rowCount;e++)for(n=t.col;n<t.col+t.colCount;n++)if(o.dg(e,n,1,1))return!0;return!1},t.prototype.cm=function(t){var e,n,o,i,a,s,l,u,c,f,h,p,d,g,m=this,y=new r.Rect(-1,-1,-1,-1),v=m.am();if(0===v.width||0===v.height)return y;if(e=m.Tq(t),n=gt(m),o=mt(m),i=pt(m),a=dt(m),s=m.ss,l=e.row,u=e.row+e.rowCount-1,c=e.col,f=e.col+e.colCount-1,h=ht(m),p=ft(m),c<n)y.x=v.kt+ut(s,0,c-1),y.width=ut(s,c,B(f,n-1)),n<=f&&f<p-i?(d=m.it(1))&&d.length>0&&(y.width+=ut(s,d[0].col,B(f,d[d.length-1].col))+m.eCb):f>=p-i&&((d=m.it(2))&&d.length>0&&(y.width=d[0].x-y.x,y.width+=ut(s,p-i,B(f,p-1))));else if(c<p-i){if(!(d=m.it(1))||0===d.length||c>d[d.length-1].col||f<d[0].col)return y;y.x=v.pt+ut(s,d[0].col,c-1)+m.eCb,n<=f&&f<p-i?y.width=ut(s,G(c,d[0].col),B(f,d[d.length-1].col)):f>=p-i&&((d=m.it(2))&&d.length>0&&(y.width=d[0].x-y.x,y.width+=ut(s,p-i,B(f,p-1))))}else c<p&&((d=m.it(2))&&d.length>0&&(y.x=v.lt+ut(s,d[0].col,c-1),y.width=ut(s,c,B(f,p-1))));if(l<o)y.y=v.nt+ct(s,0,l-1),y.height=ct(s,l,B(u,o-1)),o<=u&&u<h-a?(g=m.jt(1))&&g.length>0&&(y.height+=ct(s,g[0].row,B(u,g[g.length-1].row))+m.cCb):u>=h-a&&((g=m.jt(2))&&g.length>0&&(y.height=g[0].y-y.y,y.height+=ct(s,h-a,B(u,h-1))));else if(l<h-a){if(!(g=m.jt(1))||0===g.length||l>g[g.length-1].row||u<g[0].row)return y;y.y=v.qt+ct(s,g[0].row,l-1)+m.cCb,o<=u&&u<h-a?y.height=ct(s,G(l,g[0].row),B(u,g[g.length-1].row)):u>=h-a&&((g=m.jt(2))&&g.length>0&&(y.height=g[0].y-y.y,y.height+=ct(s,h-a,B(u,h-1))))}else l<h&&((g=m.jt(2))&&g.length>0&&(y.y=v.ot+ct(s,g[0].row,l-1),y.height+=ct(s,l,B(u,h-1))));return y},t.prototype.Ws=function(){return this.Xs},t.prototype.rt=function(t,e){return this.dp(t,e)+1},t.prototype.dp=function(t,e){var n,o=this.yl;return n=e||o.Cl(o.Bl()),r.Vn.Xn(t,n)},t.prototype.or=function(t){var e=this.am(),n=_;return e.zr<t&&t<e.zr+e.Br?n=-1:e.kt<t&&t<e.kt+e.hs?n=0:e.pt<t&&t<e.pt+e.er?n=1:e.lt<t&&t<e.lt+e.js&&(n=2),n},t.prototype.nr=function(t){var e=this.am(),n=_;return e.Ar<t&&t<e.Ar+e.Cr?n=-1:e.nt<t&&t<e.nt+e.fs?n=0:e.qt<t&&t<e.qt+e.jr?n=1:e.ot<t&&t<e.ot+e.gs&&(n=2),n},t.prototype.pr=function(t,e){var n,o;if((n=-1===e?this.ut():this.jt(e))&&(o=n.findY(t)))return o.row},t.prototype.qr=function(t,e){var n,o;if((n=-1===e?this.vt():this.it(e))&&(o=n.findX(t)))return o.col},t.prototype.wt=function(t,e){var n=this;return n.Jl<=t&&t<n.Jl+n.Lr&&n.Kl<=e&&e<n.Kl+n.Mr},t.prototype.sp=function(t){return this.ITa.sp(t)},t.prototype.tp=function(t){return this.ITa.tp(t)},t.prototype.vp=function(t,e,n,o){var r=ht(this),i=ft(this);return this.ITa.vp(t,e,n,r,i,o)},t.prototype.wp=function(t,e,n){var o=ht(this),r=ft(this);return this.ITa.wp(t,e,n,o,r)},t.prototype.xt=function(t,e,n){var o,r,i,a,s,l,u=this,c=u.yt;if(c&&!c.resizeInfo&&!T(n)){if(a=c.hitTestType,s=c.row,l=c.col,1===n)return o=!1,(r=u.ITa.findSpan(s,l,1))&&(o=r.contains(t,e,1,1)),i=t===s&&e===l||o,a===n&&i;if(2===n)return o=!1,(r=u.ITa.findSpan(s,l,2))&&(o=r.contains(t,e,1,1)),i=t===s&&e===l||o,a===n&&i;if(3===n)return a===n&&t===s&&e===l;if(0===n)return a===n}return!1},t.prototype.sr=function(t,e){return t>=0&&t<=2&&e>=0?3:t>=0&&t<=2&&e<0?2:t<0&&e>=0?1:t<0&&e<0?0:_},t.prototype.zt=function(t){var e=this.mm;e&&e.zt(t)},t.prototype.zo=function(){var t,e=this.parent,n=e&&e.qo;return n||(n=(t=this.Xs)&&t.parentElement),n},t.prototype.Pp=function(){var t=this;t.Jl=0,t.Kl=0,t.Lr=1,t.Mr=1,t.Qr=0,t.Rr=0},t.prototype.Sl=function(t,e,n){var o,r=this,i=r.ITa,a=r.zoom();return e===p.SheetArea.viewport?(o=i.Fgc(t),T(o)&&(o=r.getRowHeight(t,e))):o=r.getRowHeight(t,e),1!==a&&(o*=a),n?o:V(o)},t.prototype.Tl=function(t,e,n){var o,r=this,i=r.ITa,a=r.zoom();return e===p.SheetArea.viewport?(o=i.Ggc(t),T(o)&&(o=r.getColumnWidth(t,e))):o=r.getColumnWidth(t,e),1!==a&&(o*=a),n?o:V(o)},t.prototype.At=function(){var t,e,n,o,i,a,s,l,u,c=this,f=c.Dr(),h=c.options,p=h.sheetAreaOffset.left,d=h.sheetAreaOffset.top,g=new r.Rect(f.x+p,f.y+d,G(0,f.width-p),G(0,f.height-d)),m=g.width,y=g.height,v={x:g.x,y:g.y,width:g.width,height:g.height,Br:0,Cr:0,hs:0,fs:0,js:0,gs:0,Bt:0,Ct:0,Dt:0,Et:0,kt:0,nt:0,lt:0,ot:0,pt:0,qt:0,jr:0,er:0,zr:0,Ar:0,em:function(){var t=this;return new r.Rect(t.x,t.y,t.Br,t.Cr)},gm:function(t){var e=this;return 0===t?new r.Rect(e.kt,e.y,e.hs,e.Cr):1===t?new r.Rect(e.pt,e.y,e.er,e.Cr):2===t?new r.Rect(e.lt,e.y,e.js,e.Cr):_},fm:function(t){var e=this;return 0===t?new r.Rect(e.x,e.nt,e.Br,e.fs):1===t?new r.Rect(e.x,e.qt,e.Br,e.jr):2===t?new r.Rect(e.x,e.ot,e.Br,e.gs):_},Ft:function(t,e){var n=this;if(0===t){if(0===e)return new r.Rect(n.kt,n.nt,n.hs,n.fs);if(1===e)return new r.Rect(n.pt,n.nt,n.er,n.fs);if(2===e)return new r.Rect(n.lt,n.nt,n.js,n.fs)}else if(1===t){if(0===e)return new r.Rect(n.kt,n.qt,n.hs,n.jr);if(1===e)return new r.Rect(n.pt,n.qt,n.er,n.jr);if(2===e)return new r.Rect(n.lt,n.qt,n.js,n.jr)}else if(2===t){if(0===e)return new r.Rect(n.kt,n.ot,n.hs,n.gs);if(1===e)return new r.Rect(n.pt,n.ot,n.er,n.gs);if(2===e)return new r.Rect(n.lt,n.ot,n.js,n.gs)}return _}};if(c.Gt&&(0,(t=c.Gt()).width>0&&(v.x+=t.width+0,m-=t.width+0),t.height>0&&(v.y+=t.height+0,y-=t.height+0)),h.rowHeaderVisible)for(i=c.getColumnCount(2),o=0;o<i;o++)v.Br+=c.Tl(o,2);if(h.colHeaderVisible)for(n=c.getRowCount(1),e=0;e<n;e++)v.Cr+=c.Sl(e,1);if((a=gt(c))>0)for(i=ft(c),o=0;o<a&&o<i;o++)c.getColumnVisible(o)&&(v.hs+=c.Tl(o));if((s=mt(c))>0)for(n=ht(c),e=0;e<s&&e<n;e++)c.getRowVisible(e)&&(v.fs+=c.Sl(e));if((l=pt(c))>0)for(i=ft(c),o=G(a,i-l);o<i;o++)v.js+=c.Tl(o);if((u=dt(c))>0)for(n=ht(c),e=G(s,n-u);e<n;e++)v.gs+=c.Sl(e);return m-=v.Br,y-=v.Cr,m-=v.hs,y-=v.fs,m-=v.js,y-=v.gs,y-=v.Bt,v.er=G(0,m),v.jr=G(0,y),v.zr=v.x,v.Ar=v.y,v.kt=v.zr+v.Br,v.nt=v.Ar+v.Cr,v.pt=v.kt+v.hs,v.qt=v.nt+v.fs,v.lt=v.pt+v.er,v.ot=v.qt+v.jr,v.Dt=v.zr,v.Et=v.y+v.height-v.Bt,v},t.prototype.am=function(){var t=this;return t._r||(t._r=t.At()),t._r},t.prototype.Hr=function(t,e){return T(e)||3===e||1===e?this.it(t):2===e?this.vt():_},t.prototype.vt=function(){var t=this;return t.bs.rowHeader||(t.bs.rowHeader=t.Ht()),t.bs.rowHeader},t.prototype.it=function(t){var e=this;return e.bs.viewport||(e.bs.viewport={}),e.bs.viewport[t]||(e.bs.viewport[t]=e.It(t)),e.bs.viewport[t]},t.prototype.Ht=function(){var t,e,n=new l.yp,o=this.am().zr,r=this.getColumnCount(2);for(e=0;e<r;e++)t=this.Tl(e,2),n.push(new l.zp(-1,e,o,-1,t,-1)),o+=t;return n},t.prototype.It=function(t){var e,n,o,r,i,a=this,s=new l.yp,u=a.am(),c=ft(a),f=a.ss,h=gt(a),p=pt(a);if(0===t)for(n=u.kt,c=B(h,c),e=0;e<c;e++)o=f._m(e),s.push(new l.zp(-1,e,n,-1,o,-1)),n+=o;else if(1===t)for(r=a.eCb,n=u.pt+r,c-=p,i=u.er-r,e=G(h,a.qq);i>0&&e<c;e++)o=f._m(e),s.push(new l.zp(-1,e,n,-1,o,-1)),n+=o,i-=o;else if(2===t)for(n=u.lt,e=G(h,c-p);e<c;e++)o=f._m(e),s.push(new l.zp(-1,e,n,-1,o,-1)),n+=o;return s},t.prototype.Gr=function(t,e){return T(e)||3===e||2===e?this.jt(t):1===e?this.ut():_},t.prototype.Jt=function(t){var e,n,o=new l.yp;for(e=0;e<3;e++)(n=this.Gr(e,t))&&n.length>0&&(o=u.GC$.merge(o,n));return o},t.prototype.Kt=function(t){var e,n,o=new l.yp;for(e=0;e<3;e++)(n=this.Hr(e,t))&&n.length>0&&(o=u.GC$.merge(o,n));return o},t.prototype.ut=function(){var t=this;return t.as.colHeader||(t.as.colHeader=t.Lt()),t.as.colHeader},t.prototype.jt=function(t){var e=this;return e.as.viewport||(e.as.viewport={}),e.as.viewport[t]||(e.as.viewport[t]=e.Mt(t)),e.as.viewport[t]},t.prototype.Lt=function(){var t,e,n=new l.yp,o=this.am().Ar,r=this.getRowCount(1);for(e=0;e<r;e++)t=this.Sl(e,1),n.push(new l.zp(e,-1,-1,o,-1,t)),o+=t;return n},t.prototype.Mt=function(t){var e,n,o,r,i,a=this,s=new l.yp,u=mt(a),c=dt(a),f=a.am(),h=ht(a),p=a.ss;if(0===t)for(n=f.nt,h=B(u,h),e=0;e<h;e++)o=p.Sl(e),s.push(new l.zp(e,-1,-1,n,-1,o)),n+=o;else if(1===t)for(r=a.cCb,n=f.qt+r,h-=c,i=f.jr-r,e=G(u,a.lq);i>0&&e<h;e++)o=p.Sl(e),s.push(new l.zp(e,-1,-1,n,-1,o)),n+=o,i-=o;else if(2===t)for(n=f.ot,e=G(u,h-c);e<h;e++)o=p.Sl(e),s.push(new l.zp(e,-1,-1,n,-1,o)),n+=o;return s},t.prototype.Ir=function(t,e,n,o){var i,a,s,u,c,f,h=this,p=h.getRowCount(n),d=h.getColumnCount(n),g=h.Gr(t,n),m=h.Hr(e,n),y=new l.yp;return g&&g.length>0&&m&&m.length>0&&(i=g[0].row,a=m[0].col,s=g[g.length-1].row,u=m[m.length-1].col,c=h.ITa.getSpans(r.kf(i,a,s-i+1,u-a+1),n),o&&h.mJb&&(f=h.mJb.nJb(n),c=c.concat(f)),c.length>0&&h.Nt(c,i,a,s,u,y,p,d,n,g,m)),y},t.prototype.rr=function(t,e,n,o,r){var i,a,s,u,c=this,f=c.getRowCount(n),h=c.getColumnCount(n),p=c.Gr(t,n),d=c.Hr(e,n),g=new l.yp;return p&&p.length>0&&d&&d.length>0?(i=p[0].row,a=d[0].col,(s=c.getSpan(o,r,n))&&((u=[]).push(s),c.Nt(u,i,a,s.row+s.rowCount,s.col+s.colCount,g,f,h,n,p,d)),g.length>0?g[0]:_):_},t.prototype.Nt=function(t,e,n,o,r,i,a,s,u,c,f){var h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D=t.length;if(!(D<=0)){for(h=this,d=o+1,g=r+1,m=[],y=[],v=[],C=[],b=0,w=0,p=e-1;p>=0;p--)m[p]=h.Sl(p,u),w-=m[p],C[p]=w;for(w=0,p=e;p<d;p++)C[p]=w,m[p]=h.Sl(p,u),w+=m[p];for(p=n-1;p>=0;p--)y[p]=h.Tl(p,u),b-=y[p],v[p]=b;for(b=0,p=n;p<g;p++)v[p]=b,y[p]=h.Tl(p,u),b+=y[p];for(T=0;T<D;T++)if((x=t[T]).intersect(e,n,o-e+1,r-n+1)){if((S=x.row+x.rowCount)>d){for(p=d;p<S;p++)m.push(h.Sl(p,u)),C.push(C[p-1]+m[p]);d=S}if((A=x.col+x.colCount)>g){for(p=g;p<A;p++)y.push(h.Tl(p,u)),v.push(v[p-1]+y[p]);g=A}for(I=v[x.col],R=C[x.row],k=0,M=0,N=void 0,E=void 0,E=x.col;E<x.col+x.colCount&&E<s;E++)k+=y[E];for(N=x.row;N<x.row+x.rowCount&&N<a;N++)M+=m[N];i.push(new l.zp(x.row,x.col,f[0].x+I,c[0].y+R,k,M,x.rowCount,x.colCount,x.isAutoMerge))}}},t.prototype.qs=function(){var t,e,n=this,o=n.parent,r=n.Ot(n.qq),i=n.eCb;-1!==r&&r!==n.qq&&(n.qq=r),(t=o&&o.Pt)&&(e=t.QB===p.ScrollType.pixels?n.jgc(r)-i:n.Qt(r),t.value(e))},t.prototype.os=function(){var t,e,n=this,o=n.parent,r=n.Rt(n.lq),i=n.cCb;-1!==r&&r!==n.lq&&(n.lq=r),(t=o&&o.St)&&(e=t.QB===p.ScrollType.pixels?n.kgc(r)-i:n.Tt(r),t.value(e))},t.prototype.ds=function(){var t,e=this,n=e.parent;n&&n.Pt&&(t=n.options.scrollByPixel,n.Pt.QB=t?p.ScrollType.pixels:p.ScrollType.continuous),n&&n.Ut&&(n.options.scrollbarAppearance===p.ScrollbarAppearance.mobile&&n.hec(),n.options.scrollIgnoreHidden&&(e.Vt=e.Wt(!0)),n.Ut())},t.prototype.es=function(){var t,e=this,n=e.parent;n&&n.St&&(t=n.options.scrollByPixel,n.St.QB=t?p.ScrollType.pixels:p.ScrollType.continuous),n&&n.Xt&&(n.options.scrollbarAppearance===p.ScrollbarAppearance.mobile&&n.hec(),n.options.scrollIgnoreHidden&&(e.Yt=e.Zt(!0)),n.Xt())},t.prototype.$t=function(){var t=this,e=gt(t);return e>0?t.Zq(e-1):t.$q()},t.prototype._t=function(){var t=this,e=mt(t);return e>0?t._q(e-1):t.ar()},t.prototype.$q=function(t){return this.Zq(-1,t)},t.prototype.Zq=function(t,e,n){for(var o=this,r=o.getColumnCount(e),i=n?r-1:r-1-pt(o);t<i;)if(t++,o.getColumnVisible(t,e)&&o.Tl(t,e)>0)return t;return _},t.prototype.br=function(t,e){for(var n=this,o=gt(n);t>o;)if(t--,n.getColumnVisible(t,e)&&n.Tl(t,e)>0)return t;return _},t.prototype.ar=function(t){return this._q(-1,t)},t.prototype._q=function(t,e,n){for(var o=this,r=o.getRowCount(e),i=n?r-1:r-1-dt(o);t<i;)if(t++,o.getRowVisible(t,e)&&o.Sl(t,e)>0)return t;return _},t.prototype.gr=function(t,e,n){for(var o=this,r=n?0:mt(o);t>r;)if(t--,o.getRowVisible(t,e)&&o.Sl(t,e)>0)return t;return _},t.prototype.au=function(){this.jq=!0,this.os()},t.prototype.bu=function(){this.oq=!0,this.qs()},t.prototype.kgc=function(t){var e,n=this,o=mt(n),r=o+(ht(n)-dt(n)-o)-1,i=0;if(t<=o)return i;for(t>r&&(t=r),e=o;e<t;e++)i+=n.Sl(e);return i},t.prototype.jgc=function(t){var e,n=this,o=gt(n),r=o+(ft(n)-pt(n)-o)-1,i=0;if(t<=o)return i;for(t>r&&(t=r),e=o;e<t;e++)i+=n.Tl(e);return i},t.prototype.Tt=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Zt().visibleIndex[t]:t},t.prototype.cu=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Zt().originalIndex[t]:t},t.prototype.Qt=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Wt().visibleIndex[t]:t},t.prototype.du=function(t){var e=this.parent;return e&&e.options.scrollIgnoreHidden?this.Wt().originalIndex[t]:t},t.prototype.Wt=function(t){var e,n,o,r,i,a,s,l=this;if(l.Vt&&!t)return l.Vt;if(o=(n=e=gt(l))+(ft(l)-pt(l)-e)-1,r=l.ss,i={visibleIndex:{},originalIndex:{}},o-n+1<=0)return i;for(a=0,s=n;s<=o;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,r._m(s)>0&&a++;for(s--,a--;r._m(s)<=0&&s>=n;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},t.prototype.Zt=function(t){var e,n,o,r,i,a,s,l=this;if(l.Yt&&!t)return l.Yt;if(o=(n=e=mt(l))+(ht(l)-dt(l)-e)-1,r=l.ss,i={visibleIndex:{},originalIndex:{}},o-n+1<=0)return i;for(a=0,s=n;s<=o;s++)i.originalIndex[a]=s,i.visibleIndex[s]=a,r.Sl(s)>0&&a++;for(s--,a--;r.Sl(s)<=0&&s>=n;)i.originalIndex[a]=s,i.visibleIndex[s]=a,s--;return i},t.prototype.Rt=function(t,e){var n,o=this,r=mt(o),i=ht(o)-dt(o)-1;if(e){if(t>i&&(t=i),(n=o.gr(t+1))!==_&&n>=r)return n}else if(t<r&&(t=r),(n=o._q(t-1))!==_&&n<=i)return n;return-1},t.prototype.Ot=function(t,e){var n,o=this,r=gt(o),i=ft(o)-pt(o)-1;if(e){if(t>i&&(t=i),(n=o.br(t+1))!==_&&n>=r)return n}else if(t<r&&(t=r),(n=o.Zq(t-1))!==_&&n<=i)return n;return-1},t.prototype.eu=function(t,e,n){var o,r,i,a,s;if(n<e)return n;for(o=0,r=this.ss,i=n,a=n;a>=e;a--)if(!((s=r.Sl(a))<=0)){if((o+=s)>t)break;i=a}return i},t.prototype.LHb=function(t,e,n){var o,r,i=0,a=n,s=0;for(o=n;o>=e;o--)if(!((r=this.Sl(o))<=0)&&(a=o,(i+=r)>=t)){s=t-i;break}return{cj:a,UP:s}},t.prototype.fu=function(t,e,n){var o,r,i,a,s;if(n<e)return n;for(o=0,r=this.ss,i=n,a=n;a>=e;a--)if(!((s=r._m(a))<=0)){if((o+=s)>t)break;i=a}return i},t.prototype.MHb=function(t,e,n){var o,r,i=0,a=n,s=0;for(o=n;o>=e;o--)if(!((r=this.Tl(o))<=0)&&(a=o,(i+=r)>=t)){s=t-i;break}return{dj:a,UP:s}},t.prototype.gu=function(){var t,e,n,o=this.am(),r=this.Hr(1,3),i=0,a=0;if(r)for(t=0;t<r.length;t++)i+=e=r[t].width,e>0&&a++;return 0===(n=i/(a=0===a?1:a))?1:H(o.er/n)},t.prototype.hu=function(){var t,e,n,o=this.am(),r=this.Gr(1,3),i=0,a=0;if(r)for(t=0;t<r.length;t++)i+=e=r[t].height,e>0&&a++;return 0===(n=i/(a=0===a?1:a))?1:H(o.jr/n)},t.prototype.ns=function(t){var e,n,o,r,i,a,s;return T(t)&&(t=3),n=(e=this).parent,o=mt(e),r=dt(e),n&&n.options.scrollbarMaxAlign?(i=e.am(),e.eu(i.jr,o,ht(e)-r-1)):(a=e.getRowCount(t),3!==t&&2!==t||(a-=r),(s=e.gr(a,t))===_&&(s=o),s)},t.prototype.ps=function(t){var e,n,o,r,i,a;return T(t)&&(t=3),n=(e=this).parent,o=gt(e),n&&n.options.scrollbarMaxAlign?(r=e.am(),e.fu(r.er,o,ft(e)-pt(e)-1)):(i=e.getColumnCount(t),3!==t&&1!==t||(i-=pt(e)),(a=e.br(i,t))===_&&(a=o),a)},t.prototype.iu=function(){var e,n,o,r,i=this,a=mt(i),s=gt(i),l=ht(i)-dt(i)-1,u=ft(i)-pt(i)-1,c=i.ITa,f=c.getLastNonNullRow(3);return f>a&&(a=f),(e=c.getLastNonNullCol(3))>s&&(s=e),(n=c.getLastNonNullRow(2))>a&&(a=n),(o=c.getLastNonNullCol(1))>s&&(s=o),(r=t._n)&&R(r,(function(t,e){var n,o=e.lastNonNullRowAndCol;o&&(n=o.call(i),a=G(a,n.lastNonNullRow),s=G(s,n.lastNonNullCol))})),a>l&&(a=l),s>u&&(s=u),{lastNonNullRow:a,lastNonNullCol:s}},t.prototype.mq=function(t,e,n){var o,r=this,i=r.lq,a=r.cCb,s=r.ns();i>=r.getRowCount()&&t>s&&(t=s),t>=r._t()&&t<=s&&(n||t!==i||e!==a)&&((o=r.parent)&&(o.ku.ju(t,e||0,n),r.os()),o&&!o.options.scrollbarShowMax&&r.es())},t.prototype.rq=function(t,e,n){var o,r=this,i=r.qq,a=r.eCb,s=r.ps();i>=r.getColumnCount()&&t>s&&(t=s),t>=r.$t()&&t<=s&&(n||t!==i||e!==a)&&((o=r.parent)&&(o.ku.lu(t,e||0,n),r.qs()),o&&!o.options.scrollbarShowMax&&r.ds())},t.prototype.yr=function(t,e,n){var o,r,i,a,s,l,u,c=this,f=t.row,h=t.col,p=t.hitTestType;return T(f)||T(h)?_:((o=c.getSpan(f,h,p))&&(f=o.row,h=o.col),c.mJb&&((r=c.mJb.oJb(f,h,p))&&(f=r.row,h=r.col)),i=c.AHb(f,h,p),a=1===p?-1:L,s=2===p?-1:L,l=c.getCellRect(f,h,a,s,!0),u={sheet:c,row:f,col:h,sheetArea:p},(i.cellType||c.Al(p)).h5(e,n,i,l,u))},t.prototype.mu=function(){this.unbindAll(),this.nu()},t.prototype.ou=function(t){var e,n,o,r,i,a=this.Tq(t),s=a.row,l=a.col,u=s+a.rowCount,c=l+a.colCount;for(e=s;e<u;e++)for(n=l;n<c;n++)if(r=(o=this.getSpan(e,n))?o.row:e,i=o?o.col:n,!0===this.getActualStyle(r,i).locked)return!0;return!1},t.prototype.pu=function(t,e,n,o,r,i){if(-1<=t&&t<r&&-1<=e&&e<i){if(-1===t&&-1===e)return!0;if(-1===t){if(0!==o&&e+o<=i)return!0}else if(-1===e){if(0!==n&&t+n<=r)return!0}else if(0!==o&&e+o<=i&&0!==n&&t+n<=r)return!0}return!1},t.prototype.qu=function(t,e,n,o){var r,i,a,s=this;return!(t<0&&e<0)&&(t<0&&((r=s.ITa.zl(1))&&r.spans&&r.spans.length>0)?s.ITa.qu(-1,e,-1,o,1):e<0&&((i=s.ITa.zl(2))&&i.spans&&i.spans.length>0)?s.ITa.qu(t,-1,n,-1,2):!!((a=s.ITa.zl(3))&&a.spans&&a.spans.length>0)&&s.ITa.qu(t,e,n,o,3))},t.prototype.suspendPaint=function(){var e=this,n=e.Xq;e.Xq++,0===n&&t.ao(e,Z,{suspend:!0})},t.prototype.resumePaint=function(){var e,n=this;n.Xq--,n.Xq<=0&&(n.Xq=0,t.ao(n,Z,{suspend:!1}),(e=n.parent)&&e.getActiveSheet()!==n||n.$p())},t.prototype.isPaintSuspended=function(){return this.Xq>0},t.prototype.su=function(t,e){var n,o,r=t&&t.length;for(n=0;n<r;n++)if(o=t[n],e.intersect(o.row,o.col,o.rowCount,o.colCount))return t.splice(n,1),this.su(t,e.union(o));return e},t.prototype.getClipboardHelperObj=function(){var t=this.tu();return{isCutting:t.G4,ranges:t.n5,showInsertCopyPasteCells:t.UHb}},t.prototype.tu=function(){var t=this,e=t.parent;return t.uu||(t.uu=e&&e.uu),t.uu},t.prototype.vu=function(){if(!this.bt){var t=this;t.bt=new i.oo((function(){t.bt&&t.repaint()}))}return this.bt},t.prototype.wu=function(){var t=this.parent;if(t)return t.commandManager()},t.prototype.Os=function(t,e){this.Wq(r.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:t,message:e})},t.prototype.Bq=function(t,e,n,o,i,a){var s;0===this.jm&&(s={sheet:this,sheetName:this.name(),row:e,col:n,sheetArea:o,propertyName:t,oldValue:i,newValue:a,isUndo:this.OIb},this.Wq(r.Events.CellChanged,s),this.ITa.ZVa(["cellChanged",t,e,n,o,a,i]))},t.prototype.xu=function(t,e,n,o){this.Wq(r.Events.ValueChanged,{sheet:this,sheetName:this.name(),row:t,col:e,oldValue:n,newValue:o})},t.prototype.qCb=function(t,e,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:n,newValue:o,oldValue:i},"addColumns"!==n&&"deleteColums"!==n||(a.count=o),this.Wq(r.Events.ColumnChanging,a),this.ITa.ZVa(["columnChanging",t,e,n,i,o]))},t.prototype.pq=function(t,e,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),col:t,sheetArea:e,propertyName:n,newValue:o,oldValue:i,isUndo:this.OIb},"addColumns"!==n&&"deleteColumns"!==n||(a.count=o),this.Wq(r.Events.ColumnChanged,a),this.ITa.ZVa(["columnChanged",t,e,n,i,o]))},t.prototype.RIb=function(t,e,n,o){var i,a,s,l=[];if(this.tables){for(i=this.tables.pJb(t,e,n,o),a=0;a<i.length;a++)l.push(i[a].name());l.length>0&&(s={isUndo:this.OIb,sheet:this,sheetName:this.name(),row:t,col:n,rowCount:e,colCount:o,tableNames:l,action:2},this.Wq(r.Events.RangeChanged,s),this.ITa.ZVa(["rangeChanged",t,e,n,o]))}},t.prototype.pCb=function(t,e,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:n,newValue:o,oldValue:i},"addRows"!==n&&"deleteRows"!==n||(a.count=o),this.Wq(r.Events.RowChanging,a),this.ITa.ZVa(["rowChanging",t,e,n,i,o]))},t.prototype.kq=function(t,e,n,o,i){var a;0===this.jm&&(a={sheet:this,sheetName:this.name(),row:t,sheetArea:e,propertyName:n,newValue:o,oldValue:i,isUndo:this.OIb},"addRows"!==n&&"deleteRows"!==n||(a.count=o),this.Wq(r.Events.RowChanged,a),this.ITa.ZVa(["rowChanged",t,e,n,i,o]))},t.prototype.gyb=function(t,e){e!==t&&(this.Wq(r.Events.ViewZoomed,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:e}),this.Wq(r.Events.UserZooming,{sheet:this,sheetName:this.name(),oldZoomFactor:t,newZoomFactor:e}))},t.prototype.yu=function(t,e){return!(this.n_a||!this.mm.zu(t,e)||(this.Wq(r.Events.SelectionChanging,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:e}),0))},t.prototype.Au=function(t){this.Wq(r.Events.SelectionChanged,{sheet:this,sheetName:this.name(),oldSelections:t,newSelections:this.getSelections()})},t.prototype.Bu=function(t,e,n,o,i,a,s,l,u,c){var f={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:n,colCount:o,changedCells:i,action:a},h={sheet:this,sheetName:this.name(),row:t,col:e,rowCount:n,colCount:o,changedCells:i,isUndo:!!c,action:a};s&&(f.sheetArea=s,h.sheetArea=s),l&&(f.value=l),i&&i.length>0&&(u&&u.length>0&&(h.tableNames=u),this.Wq(r.Events.RangeChanged,h),this.Wq(r.Events.FormulatextboxRangeChanged,f))},t.prototype.Cu=function(t,e){var n={sheet:this,sheetName:this.name(),oldStatus:t,newStatus:e};this.Wq(r.Events.EditorStatusChanged,n)},t.prototype.Du=function(){return this.b4||(this.b4=u.GC$(x("input"))),this.b4},t.prototype.bind=function(t,e,n){this.Du().bind(t+K,e,n)},t.prototype.unbind=function(t,e){this.Du().unbind(t+K,e)},t.prototype.Wq=function(t,e,n){this.updateEventsData&&this.updateEventsData(t,e),(0===this.jm||n)&&this.Du().trigger(t,e)},t.prototype.unbindAll=function(){this.unbind(K)},t.prototype.Fu=function(t,e,n){t.indexOf(".")>=0?this.bind(t,e,n):this.bind(t+tt,e,n)},t.prototype.Gu=function(t,e){t.indexOf(".")>=0?this.unbind(t,e):this.unbind(t+tt,e)},t.prototype.nu=function(){this.unbind(tt)},t.prototype.Dr=function(){var t=this.Zs;return new r.Rect(t.x,t.y,t.width,t.height)},t.prototype.Us=function(t){this.Zs=new r.Rect(t.x,t.y,t.width,t.height)},t.prototype.scroll=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p=this,d=p.parent;d&&(o=(n=d.options).scrollByPixel,r=n.scrollPixel,i=d.ku,a=n.scrollbarShowMax,s=n.showHorizontalScrollbar,l=n.showVerticalScrollbar,0!==e&&(c=(u=i._Bb(p,Math.round(e)/r)).dj,f=o?u.UP:0,c===p.qq&&f===p.eCb||(i.lu(c,f),s&&(p.qs(),a||(p.oq=!0)))),0!==t&&(c=(h=i.aCb(p,Math.round(t)/r)).cj,f=o?h.UP:0,c===p.lq&&f===p.cCb||(i.ju(c,f),l&&(p.os(),a||(p.jq=!0)))))},t.prototype.isCtrlPressed=function(t){return this.mm&&this.mm.ctrl},t.prototype.deselectIgnoreSpan=function(){return!1},t.Np=1,t.Qp=it,t.Rp=200,t.Sp=20,t.Tp=1,t.Vp=1,t}(),e.Worksheet=at,r.Zn(at),(st=at.prototype).visible=S("visible",!0,(function(t){var e,n=this,o=n.parent,r=o.sheets,i=r.length,a=u.GC$.inArray(n,r),s=o.getActiveSheetIndex();if(t)s<0?(o.dq(a,1),o.hq&&o.hq.gq<0&&(o.hq.gq=a)):o.aq();else if(a===s){for(e=a+1;e<i&&!r[e].visible();)e++;if(e>=i)for(e=a-1;e>=0&&!r[e].visible();)e--;o.hq&&e<o.hq.gq&&(o.hq.gq=e),e<0?(n.no(!1),o.eq=e,o.fq()):o.dq(e,1)}else o.aq()})),st.frozenColumnCount=S("frozenColumnCount",0,(function(t){var e=this;e.qq<t?e.qq=t:""!==t&&0!==t&&null!==t||(e.qq=0),e.oq=!0,e.$p()}),(function(t){return t>=0})),st.frozenRowCount=S("frozenRowCount",0,(function(t){var e=this;e.lq<t?e.lq=t:""!==t&&0!==t&&null!==t||(e.lq=0),e.jq=!0,e.$p()}),(function(t){return t>=0})),st.frozenTrailingRowCount=S("frozenTrailingRowCount",0,(function(){this.jq=!0,this.$p()}),(function(t){return t>=0})),st.frozenTrailingColumnCount=S("frozenTrailingColumnCount",0,(function(){this.oq=!0,this.$p()}),(function(t){return t>=0}))},"./dist/plugins/autoMerge/autoMerge.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function y(t,e,n){return n+"_"+t+"_"+e}function v(t,e,n){return e===t||(e===o.SheetArea.viewport?n&&t===o.SheetArea.rowHeader||!n&&t===o.SheetArea.colHeader:e===o.SheetArea.rowHeader?n&&t===o.SheetArea.viewport:e===o.SheetArea.colHeader&&!n&&t===o.SheetArea.viewport)}function C(t,e,n){t.clearSpan(e.row,e.col,e.rowCount,e.colCount,n)}function b(t,e,n,r){var i,a,s,u,c,d,g,m={},y=[],v=n.row,C=n.row+n.rowCount-1,b=n.col,T=n.col+n.colCount-1;for(i=b;i<=T;i++)if(t.getColumnVisible(i,r)&&!(t.getColumnWidth(i,r)<=0)){for(a=e===l.restricted&&i>b,s=void 0,u=v;u<=C;)if(!t.getRowVisible(u,r)||t.getRowHeight(u,r)<=0)u++;else{if((c=t._q(u,r,!0))===p||c>C)break;if(S(t,u,i,c,i,r)){if(a&&!w(t,m,u,i,c,i,r)){s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h),u=c;continue}g=c-u+1,s?s.rowCount+=g-1:s=o.kf(u,i,g,1)}else s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h);u=c}s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h)}return{cache:m,spans:y}}function w(t,e,n,o,r,i,a){var s=e[y(n,t.br(o,a),a)];return s&&s.sheetArea===a&&s.row<=n&&r<=s.row+s.rowCount-1}function T(t,e,n,r){var i,a,s,u,c,d,g,m={},y=[],v=n.row,C=n.row+n.rowCount-1,b=n.col,w=n.col+n.colCount-1;for(i=v;i<=C;i++)if(t.getRowVisible(i,r)&&!(t.getRowHeight(i,r)<=0)){for(a=e===l.restricted&&i>v,s=void 0,u=b;u<=w;)if(!t.getColumnVisible(u,r)||t.getColumnWidth(u,r)<=0)u++;else{if((c=t.Zq(u,r,!0))===p||c>w)break;if(S(t,i,u,i,c,r)){if(a&&!x(t,m,i,u,i,c,r)){s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h),u=c;continue}g=c-u+1,s?s.colCount+=g-1:s=o.kf(i,u,1,g)}else s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h);u=c}s&&(d=new f(s,r),y.push(d),R(m,s,d),s=h)}return{cache:m,spans:y}}function x(t,e,n,o,r,i,a){var s=e[y(t.gr(n,a),o,a)];return s&&s.sheetArea===a&&s.col<=o&&i<=s.col+s.colCount-1}function S(t,e,n,o,r,i){var a=t.ITa,s=t.getText(e,n,i),l=t.getText(o,r,i);return""!==s&&""!==l&&s===l&&!a.findSpan(e,n,i)&&!a.findSpan(o,r,i)}function A(t,e,n,r){var i,a,s,l,u,c,h,d=b(t,e,n,r),g=d.cache,m=d.spans,v=n.row,C=n.row+n.rowCount-1,w=n.col,T=n.col+n.colCount-1;for(i=v;i<=C;i++)if(t.getRowVisible(i,r)&&!(t.getRowHeight(i,r)<=0))for(a=w;a<=T;a++)if(t.getColumnVisible(a,r)&&!(t.getColumnWidth(a,r)<=0)){if((s=t.Zq(a,r,!0))===p||s>T)break;S(t,i,a,i,s,r)&&(l=g[y(i,a,r)],u=g[y(i,s,r)],l&&u?l.row===i&&u.row===i&&l.rowCount===u.rowCount&&(l.colCount+=s-a,I(m,u),R(g,u,l)):l?1===l.rowCount&&(l.colCount+=s-a,R(g,new o.Range(i,s,1,1),l)):u?1===u.rowCount&&(u.col=a,u.colCount+=s-a,R(g,new o.Range(i,a,1,1),u)):(c=new o.Range(i,a,1,s-a+1),h=new f(c,r),m.push(h),R(g,c,h)))}return{cache:g,spans:m}}function I(t,e){var n,o;for(n=0;n<t.length;n++)if((o=t[n]).sheetArea===e.sheetArea&&o.equals(e)){t.splice(n,1);break}}function R(t,e,n){var o,r,i=n.sheetArea;for(o=0;o<e.rowCount;o++)for(r=0;r<e.colCount;r++)t[y(e.row+o,e.col+r,i)]=n}function k(t,e,n,r){var i,a,s,l,u,c,h,d=T(t,e,n,r),g=d.cache,m=d.spans,v=n.row,C=n.row+n.rowCount-1,b=n.col,w=n.col+n.colCount-1;for(i=b;i<=w;i++)if(t.getColumnVisible(i,r)&&!(t.getColumnWidth(i,r)<=0))for(a=v;a<=C;a++)if(t.getRowVisible(a,r)&&!(t.getRowHeight(a,r)<=0)){if((s=t._q(a,r,!0))===p||s>C)break;S(t,a,i,s,i,r)&&(l=g[y(a,i,r)],u=g[y(s,i,r)],l&&u?l.col===i&&u.col===i&&l.colCount===u.colCount&&(l.rowCount+=s-a,I(m,u),R(g,u,l)):l?1===l.colCount&&(l.rowCount+=s-a,R(g,new o.Range(s,i,1,1),l)):u?1===u.colCount&&(u.row=a,u.rowCount+=s-a,R(g,new o.Range(a,i,1,1),u)):(c=new o.Range(a,i,s-a+1,1),h=new f(c,r),m.push(h),R(g,c,h)))}return{cache:g,spans:m}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/autoMerge/autoMerge.res.en.js"),e.SR={en:i},a=new r.Common.ResourceManager(e.SR),s=a.getResource.bind(a),function(t){t[t.free=0]="free",t[t.restricted=1]="restricted"}(l=e.AutoMergeMode||(e.AutoMergeMode={})),function(t){t[t.none=0]="none",t[t.column=1]="column",t[t.row=2]="row",t[t.columnRow=3]="columnRow",t[t.rowColumn=4]="rowColumn"}(u=e.AutoMergeDirection||(e.AutoMergeDirection={})),function(t){t[t.source=0]="source",t[t.merged=1]="merged"}(c=e.SelectionMode||(e.SelectionMode={})),f=function(t){function e(e,n){var o=t.call(this,e.row,e.col,e.rowCount,e.colCount)||this;return o.sheetArea=n,o.isAutoMerge=!0,o}return m(e,t),e}(o.Range),h=void 0,p=null,d=function(){function t(t){this.kj=t,this.qJb=[],this.xn={},this.Ny=[]}return t.prototype.no=function(){this.kj=p},t.prototype.add=function(t,e,n,r,i){var a,l,u;for(void 0===r&&(r=o.SheetArea.viewport),void 0===i&&(i=c.source),a=0,l=this.all();a<l.length;a++)if((u=l[a]).sheetArea===r&&u.range.intersect(t.row,t.col,t.rowCount,t.colCount))throw Error(s().Exp_RangeIsIntersected);this.qJb.push({range:t,direction:e,mode:n,sheetArea:r,selectionMode:i})},t.prototype.remove=function(t,e){var n,r,i,a;for(void 0===e&&(e=o.SheetArea.viewport),n=this.qJb,r=this.kj.ITa,i=0;i<n.length;i++)if((a=n[i]).sheetArea===e&&a.range.equals(t)){C(r,t,e),n.splice(i,1);break}},t.prototype.clear=function(){var t,e,n=this.qJb,o=this.kj.ITa;for(t=0;t<n.length;t++)C(o,(e=n[t]).range,e.sheetArea);this.qJb=[],this.xn={},this.Ny=[]},t.prototype.all=function(){return this.qJb},t.prototype.mgc=function(t){return this.qJb.some((function(e){return e.range.containsRange(t)}))},t.prototype.RUa=function(t){this.qJb=t,this.rJb()},t.prototype.oJb=function(t,e,n){void 0===n&&(n=o.SheetArea.viewport);var r=this.xn[y(t,e,n)];return r?o.kf(r.row,r.col,r.rowCount,r.colCount):p},t.prototype.nJb=function(t){return void 0===t&&(t=o.SheetArea.viewport),this.Ny.filter((function(e){return e.sheetArea===t}))},t.prototype.rJb=function(){var t,e,n,r,i,a,s;for(this.xn={},this.Ny=[],t=this.qJb,e=this.kj,n=e.ITa,r=function(t){var r,a=t.direction,s=t.mode,l=t.sheetArea,f=function(t,e,n){var r,i,a,s,l,u,c,f,h,p;return n===o.SheetArea.viewport&&!t.options.allowCellOverflow&&(r=e.row,i=e.col,a=e.rowCount,s=e.colCount,l=t.frozenRowCount(),u=t.frozenColumnCount(),c=t.frozenTrailingRowCount(),f=t.frozenTrailingColumnCount(),h=t.getRowCount(),p=t.getColumnCount(),(0===l||-1!==r&&l<=r)&&(0===u||-1!==i&&u<=i)&&(0===c||-1!==r&&r+a<=h-c)&&(0===f||-1!==i&&i+s<=p-f))?(-1===i&&(i=t.getViewportLeftColumn(1),s=t.getViewportRightColumn(1)-i+1),-1===r&&(r=t.getViewportTopRow(1),a=t.getViewportBottomRow(1)-r+1),o.kf(r,i,a,s)):t.Tq(e,n)}(e,t.range,l),h=t.selectionMode===c.merged;h&&C(n,f,l),r=void 0,a===u.column?r=b(e,s,f,l):a===u.row?r=T(e,s,f,l):a===u.columnRow?r=A(e,s,f,l):a===u.rowColumn&&(r=k(e,s,f,l)),r&&(o.GC$.extend(i.xn,r.cache),i.Ny=i.Ny.concat(r.spans),h&&r.spans.forEach((function(t){n.addSpan(t,l)})))},i=this,a=0,s=t;a<s.length;a++)r(s[a])},t.prototype.rI=function(t,e,n){var r,i,a,s,l;if(void 0===n&&(n=o.SheetArea.viewport),!(t<0||e<=0))for(r=0,i=this.qJb;r<i.length;r++)v((a=i[r]).sheetArea,n,!0)&&(t<=(l=(s=a.range).row)?s.row+=e:l<t&&t<l+s.rowCount&&(s.rowCount+=e))},t.prototype.tI=function(t,e,n){var r,i,a,s,l;if(void 0===n&&(n=o.SheetArea.viewport),!(t<0||e<=0))for(r=0,i=this.qJb;r<i.length;r++)v((a=i[r]).sheetArea,n,!1)&&(t<=(l=(s=a.range).col)?s.col+=e:l<t&&t<l+s.colCount&&(s.colCount+=e))},t.prototype.GR=function(t,e,n){var r,i,a,s,l,u,c,f,h;if(void 0===n&&(n=o.SheetArea.viewport),!(t<0||e<=0)){for(r=this.qJb,i=[],a=0;a<r.length;a++)v((s=r[a]).sheetArea,n,!0)&&(u=(l=s.range).row,c=l.rowCount,t<u?((f=t+e-u)<=0?u-=e:(u-=f,l.rowCount-=f),u<0&&(l.rowCount+=u,u=0),l.row=u):u<=t&&t<u+c&&(l.rowCount-=Math.min(e,u+c-t)),0===l.rowCount&&i.push(a));for(h=i.length-1;h>=0;h--)r.splice(i[h],1)}},t.prototype.HR=function(t,e,n){var r,i,a,s,l,u,c,f,h;if(void 0===n&&(n=o.SheetArea.viewport),!(t<0||e<=0)){for(r=this.qJb,i=[],a=0;a<r.length;a++)v((s=r[a]).sheetArea,n,!1)&&(u=(l=s.range).col,c=l.colCount,t<u?((f=t+e-u)<=0?u-=e:(u-=f,l.colCount-=f),u<0&&(l.colCount+=u,u=0),l.col=u):u<=t&&t<u+c&&(l.colCount-=Math.min(e,u+c-t)),0===l.colCount&&i.push(a));for(h=i.length-1;h>=0;h--)r.splice(i[h],1)}},t.prototype.sJb=function(t,e){var n,r,i;for(void 0===e&&(e=o.SheetArea.viewport),r=(n=this.qJb).length-1;r>=0;r--)-1!==(i=n[r].range).row&&v(n[r].sheetArea,e,!0)&&(i.row>t-1?n.splice(r,1):i.row+i.rowCount-1>t-1&&(i.rowCount=t-1-i.row+1))},t.prototype.tJb=function(t,e){var n,r,i;for(void 0===e&&(e=o.SheetArea.viewport),r=(n=this.qJb).length-1;r>=0;r--)-1!==(i=n[r].range).col&&v(n[r].sheetArea,e,!1)&&(i.col>t-1?n.splice(r,1):i.col+i.colCount-1>t-1&&(i.colCount=t-1-i.col+1))},t.prototype.toJSON=function(){return this.qJb.map((function(t){var e=t.range;return{range:{row:e.row,col:e.col,rowCount:e.rowCount,colCount:e.colCount},direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}}))},t.prototype.fromJSON=function(t){var e,n,r,i,a,s;if(t)for(e=this.qJb,n=0,r=t;n<r.length;n++)a=(i=r[n]).range,(s=i.selectionMode)===h&&(s=c.source),e.push({range:o.kf(a.row,a.col,a.rowCount,a.colCount),direction:i.direction,mode:i.mode,sheetArea:i.sheetArea,selectionMode:s})},t}(),o.GC$.extend(o.lUa.prototype,{uJb:function(){var t=this.zTa;t&&!t.vJb&&(t.vJb=this.mJb.all().map((function(t){var e=t.range;return{range:o.kf(e.row,e.col,e.rowCount,e.colCount),direction:t.direction,mode:t.mode,sheetArea:t.sheetArea,selectionMode:t.selectionMode}})))},wJb:function(t){t&&this.mJb.RUa(t)},xJb:function(t,e){this.uJb(),this.mJb.rI(t,e)},yJb:function(t,e){this.uJb(),this.mJb.GR(t,e)},zJb:function(t,e){this.uJb(),this.mJb.tI(t,e)},AJb:function(t,e){this.uJb(),this.mJb.HR(t,e)},BJb:function(t,e){this.uJb(),this.mJb.sJb(t,e)},CJb:function(t,e){this.uJb(),this.mJb.tJb(t,e)}}),g="autoMerge",o.lUa.$n(g,{init:function(){this.mJb=new d(this.kj)},undo:function(t){var e=t.vJb;e&&this.wJb(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.mJb&&(e.mJb.no(),e.mJb=p)}}),o.Worksheet.$n(g,{init:function(){var t=this,e=t.mJb=t.ITa.mJb;t.unbind(o.Events.TopRowChanged+"."+g),t.unbind(o.Events.LeftColumnChanged+"."+g),t.bind(o.Events.TopRowChanged+"."+g,(function(){var n,r,i,a,s,l,u,c,f=e.all();if(f.length>0)for(n=t.frozenColumnCount(),r=t.getColumnCount()-t.frozenTrailingColumnCount()-1,i=0,a=f;i<a.length;i++)l=(s=a[i]).sheetArea,u=s.range,l===o.SheetArea.viewport?((-1===u.col||u.col<n)&&t.repaint(t.getRangeRect(1,0,u)),(-1===u.col||u.col<=r&&u.col+u.colCount>=n)&&t.repaint(t.getRangeRect(1,1,u)),(-1===u.col||u.col+u.colCount>r)&&t.repaint(t.getRangeRect(1,2,u))):l===o.SheetArea.rowHeader&&(c=t.am(),t.repaint(c.fm(1)))})),t.bind(o.Events.LeftColumnChanged+"."+g,(function(){var n,r,i,a,s,l,u,c,f=e.all();if(f.length>0)for(n=t.frozenRowCount(),r=t.getRowCount()-t.frozenTrailingRowCount()-1,i=0,a=f;i<a.length;i++)l=(s=a[i]).sheetArea,u=s.range,l===o.SheetArea.viewport?((-1===u.row||u.row<n)&&t.repaint(t.getRangeRect(0,1,u)),(-1===u.row||u.row<=r&&u.row+u.rowCount>=n)&&t.repaint(t.getRangeRect(1,1,u)),(-1===u.row||u.row+u.rowCount>r)&&t.repaint(t.getRangeRect(2,1,u))):l===o.SheetArea.colHeader&&(c=t.am(),t.repaint(c.gm(1)))}))},dispose:function(t){!1!==t.clearCache&&(this.mJb=p,this.unbind(o.Events.TopRowChanged+"."+g),this.unbind(o.Events.LeftColumnChanged+"."+g))},onLayoutChanged:function(t){var e=t.changeType,n=t.row,o=t.rowCount,r=t.col,i=t.colCount,a=t.sheetArea,s=this.ITa;"addRows"===e?s.xJb(n,o):"deleteRows"===e?s.yJb(n,o):"addColumns"===e?s.zJb(r,i):"deleteColumns"===e?s.AJb(r,i):"setRowCount"===e?s.BJb(o,a):"setColumnCount"===e&&s.CJb(i,a),"invalidateLayout"===e&&this.Xq<=0&&this.mJb.rJb()},toJson:function(t,e){var n,r,i;e&&e.ignoreStyle||(t.autoMergeRangeInfos=this.mJb.toJSON(),e&&e.includeAutoMergedCells&&((n=this.mJb.nJb(o.SheetArea.viewport)).length>0&&(t.spans?t.spans=t.spans.concat(n):t.spans=n),(r=this.mJb.nJb(o.SheetArea.rowHeader)).length>0&&(t.rowHeaderSpan?t.rowHeaderSpan=t.rowHeaderSpan.concat(r):t.rowHeaderSpan=r),(i=this.mJb.nJb(o.SheetArea.colHeader)).length>0&&(t.colHeaderSpan?t.colHeaderSpan=t.colHeaderSpan.concat(i):t.colHeaderSpan=i)))},fromJson:function(t,e,n){n&&n.ignoreStyle||this.mJb.fromJSON(t.autoMergeRangeInfos)}}),o.GC$.extend(o.Worksheet.prototype,{autoMerge:function(t,e,n,r,i){void 0===e&&(e=u.column),void 0===n&&(n=l.free),void 0===r&&(r=o.SheetArea.viewport),void 0===i&&(i=c.source);var a=this.mJb;return 0===arguments.length?a.all():void(t&&(this.ITa.uJb(),e===u.none?a.remove(t,r):a.add(t,e,n,r,i),this.$p()))}})},"./dist/plugins/autoMerge/autoMerge.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_RangeIsIntersected="The range should not intersect with exsit ranges."},"./dist/plugins/cellState/cellStateManager.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d=this&&this.__assign||function(){return(d=Object.assign||function(t){var e,n,o,r;for(n=1,o=arguments.length;n<o;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},g=this&&this.__rest||function(t,e){var n,o,r={};for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&(r[n[o]]=t[n[o]]);return r};function m(t){var e=t.row,n=t.col,o=t.rowCount,i=t.colCount;return new r.Range(e,n,o,i)}function y(t){var e,n,o,r,i,a,s=[];for(n=0,o=t.length;n<o;n++)r=(e=t[n]).style,a={range:{row:(i=e.range).row,col:i.col,colCount:i.colCount,rowCount:i.rowCount},style:r.toJSON()},s.push(a);return s}function v(t,e,n,o){var i,a,s,l,u,c,f,h,p,d,g;for(s=0,l=e.length;s<l;s++)c=(u=(a=e[s]).range).row,f=u.col,h=u.rowCount,p=u.colCount,d=a.style,(g=new r.Style).fromJSON(d,n,o),i={style:g,range:new r.Range(c,f,h,p)},t.push(i)}function C(t,e,n){return n.contains(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=o.Common.j.Fa,a=r.GC$.extend,s=void 0,l="cellState",u=[r.CellStatesType.readonly,r.CellStatesType.invalid,r.CellStatesType.dirty,r.CellStatesType.selected,r.CellStatesType.active,r.CellStatesType.hover,r.CellStatesType.edit],c=function(){function t(t,e){this.kj=t,this.io=e,this.xn=[];for(var n=1;n<=3;n++)this.sCb(n)}return t.prototype.sCb=function(t){this.xn[t]=[]},t.prototype.tCb=function(t){return this.xn[t]},t.prototype.uCb=function(t,e){this.xn[e]=t},t.prototype.DJb=function(t,e){var n,o;for(n=0,o=t.length;n<o;n++)if(t[n].range.equals(e))return n;return-1},t.prototype.Fb=function(t,e){var n,o=this.tCb(e),r=this.DJb(o,t);r>-1&&(n=o[r],this.EJb(r,n.range,n.style,o),o.splice(r,1))},t.prototype.Sb=function(t,e,n){var o=this,r=o.tCb(n),i=o.DJb(r,t),a={range:t,style:e};o.vCb({index:i,cache:r,range:t,style:e}),-1===i?r.push(a):r[i]=a},t.prototype.zR=function(t){var e=this.tCb(t),n=this.io;return e.map((function(t){var e=t.range,o=t.style;return{range:m(e),style:o.clone(),state:n}}))},t.prototype.Gq=function(t,e,n){var o,r,i,a=this.tCb(n),s=[];for(r=a.length,i=0;i<r;i++)C(t,e,(o=a[i]).range)&&s.push(o);return s.length>0?s:null},t.prototype.FJb=function(t,e,n){var o,r,i=this.tCb(n);if(i&&i.length>0)for(o=0,r=i;o<r.length;o++)if(C(t,e,r[o].range))return!0;return!1},t.prototype.wCb=function(t,e,n,o,a,s){var l,u,c=this,f=c.kj,h=c.tCb(a);if(h&&0===h.length)return!1;if(c.io===r.CellStatesType.dirty&&(i(o)||(o&c.io)>0))return f.GJb(e,n,a);if(c.io===r.CellStatesType.selected&&(i(o)||(o&c.io)>0)){for(l=0,u=c.kj.getSelections();l<u.length;l++)if(C(e,n,u[l]))return!0;return!1}return c.io===r.CellStatesType.invalid?!(!f.isValid||!(i(o)||(o&c.io)>0)||f.isValid(e,n,f.getValue(e,n,a))):c.io===r.CellStatesType.readonly?s&&c.kj.options.isProtected:(c.io&t)>0},t.prototype.xCb=function(t,e){var n=this.tCb(e);this.yCb({cache:n,sheetArea:e,collection:this}),this.uCb(function(t,e,n){var o=[],r=t.getRowCount(3),i=t.getColumnCount(3);return e.forEach((function(e){o=o.concat(function(t,e,n,o,r,i){return t.v_a(n,o,r,i).map((function(t){return{range:t,style:e}}))}(t,e.style,e.range,n,r,i))})),o}(this.kj,n,t),e)},t.prototype.toJSON=function(){var t,e,n={};for(e=0;e<=3;e++)(t=this.tCb(e))&&t.length>0&&(n[e]=y(t));return n},t.prototype.fromJSON=function(t,e,n){var o,r,i=this;for(i.xn=[],o=1;o<=3;o++)i.sCb(o);for(r in t)t.hasOwnProperty(r)&&v(i.tCb(r),t[r],e,n)},t.prototype.zCb=function(t){var e=g(t,[]);this.kj.ITa.ACb(d({type:"rangeChange"},e))},t.prototype.vCb=function(t){var e=t.index,n=t.cache,o=t.range,r=t.style,i=this.kj.ITa;-1!==e&&(r=n[e].style),i.ACb({type:"add",index:e,cache:n,range:o,style:r})},t.prototype.EJb=function(t,e,n,o){this.kj.ITa.ACb({type:"remove",index:t,range:e,style:n,cache:o})},t.prototype.yCb=function(t){var e=g(t,[]);this.kj.ITa.ACb(d({type:"clear"},e))},t.prototype.rI=function(t,e){var n,o,r=this;for(o=0;o<=3;o++)(n=r.tCb(o))&&n.length>0&&n.forEach((function(n){var o=n.range,i=o.row,a=o.rowCount;t<=i?(o.row=i+e,r.zCb({range:o,row:i})):i<t&&t<i+a&&(o.rowCount=o.rowCount+e,r.zCb({range:o,rowCount:a}))}))},t.prototype.GR=function(t,e){var n,o,r=this;for(o=0;o<=3;o++)(n=r.tCb(o))&&n.length>0&&n.forEach((function(n){var o,i=n.range,a=i.row,s=i.rowCount;t<a?((o=t+e-a)<=0?a-=e:(a-=o,i.rowCount-=o),a<0&&(i.rowCount=s+a,a=0),i.row=a,r.zCb({range:i,row:a,rowCount:s})):a<=t&&t<a+s&&(i.rowCount=i.rowCount-Math.min(e,a+s-t),r.zCb({range:i,rowCount:s}))}))},t.prototype.tI=function(t,e){var n,o,r=this;for(o=0;o<=3;o++)(n=r.tCb(o))&&n.length>0&&n.forEach((function(n){var o=n.range,i=o.col,a=o.colCount;t<=i?(o.col=i+e,r.zCb({range:o,col:i})):i<t&&t<i+o.colCount&&(o.colCount=a+e,r.zCb({range:o,colCount:a}))}))},t.prototype.HR=function(t,e){var n,o,r=this;for(o=0;o<=3;o++)(n=r.tCb(o))&&n.length>0&&n.forEach((function(n){var o,i=n.range,a=i.col,s=i.colCount;t<a?((o=t+e-a)<=0?a-=e:(a-=o,i.colCount-=o),a<0&&(i.colCount+=a,a=0),i.col=a,r.zCb({range:i,col:a,colCount:s})):a<=t&&t<a+s&&(i.colCount-=Math.min(e,a+s-t),r.zCb({range:i,colCount:s}))}))},t.prototype.BCb=function(){this.xn=[],this.kj=null},t}(),f=function(){function t(t){this.kj=t,this.CCb={}}return t.prototype.getCollection=function(t,e){var n=this;return!n.CCb[t]&&e&&(n.CCb[t]=new c(n.kj,t)),n.CCb[t]},t.prototype.hasIntersectInSeletionState=function(t,e,n,o){var i,a,s,l=this.CCb[r.CellStatesType.selected];if(l&&((i=l.tCb(r.SheetArea.viewport))&&i.length>0))for(a=0,s=i;a<s.length;a++)if(s[a].range.intersect(t,e,n,o))return!0;return!1},t.prototype.getState=function(t,e,n){return this.kj.ITa.XTa(n).getCellState(t,e)||0},t.prototype.remove=function(t,e,n){void 0===n&&(n=r.SheetArea.viewport),this.CCb[e].Fb(t,n)},t.prototype.all=function(t,e){var n,o;if(void 0===e&&(e=r.SheetArea.viewport),n=[],i(t))for(o in this.CCb)this.CCb.hasOwnProperty(o)&&(n=n.concat(this.CCb[o].zR(e)));else n=this.CCb[t].zR(e);return n},t.prototype.add=function(t,e,n,o){var a,l;if(r.CellStatesType[e]===s)throw Error("Unmatched Cell State Type");i(o)&&(o=3),this.getCollection(e,!0).Sb(m(t),n,o),a=this.kj,o===r.SheetArea.viewport?a.repaint(a.cm(t)):(l=a.am(),o===r.SheetArea.colHeader&&a.repaint(new r.Rect(l.pt,l.Ar,l.er,l.Cr)),o===r.SheetArea.rowHeader&&a.repaint(new r.Rect(l.zr,l.qt,l.Br,l.jr)))},t.prototype.clear=function(t,e){this.DCb(t,e)},t.prototype.DCb=function(t,e){for(var n in this.CCb)this.CCb.hasOwnProperty(n)&&this.CCb[n].xCb(t,e)},t.prototype.HJb=function(t,e,n,o,r,i){var a=this.kj,s=this.CCb[t];s&&s.FJb(e,n,o)&&-1!==r&&-1!==i&&a.repaint(a.gCb(a,e,n,r,i))},t.prototype.getStyle=function(t,e,n,o,a){var l,c,f,h,p,d,g,m,y;if(i(n)&&(n=3),l=new r.Style,c=[],(p=i(o)?this.getState(t,e,n):this.getState(t,e,n)&o)!==s&&null!==p){for(d=0,g=u;d<g.length;d++)m=g[d],(h=this.CCb[m])&&h.wCb(p,t,e,o,n,a)&&((f=h.Gq(t,e,n))&&f.length>0&&(c=c.concat(f)));if(c.length>0){for(y=c.length-1;y>=0;y--)l.Yo(c[y].style);return l}}return null},t.prototype.destory=function(){for(var t in this.CCb)this.CCb.hasOwnProperty(t)&&this.CCb[t].BCb();delete this.CCb,delete this.kj},t.prototype.toJSON=function(){var t,e,n={};for(e in this.CCb)this.CCb.hasOwnProperty(e)&&(t=this.CCb[e],n[e]=t.toJSON());return n},t.prototype.fromJSON=function(t,e,n){var o,r;for(o in t)t.hasOwnProperty(o)&&(r=parseInt(o,10),this.getCollection(r,!0).fromJSON(t[r],e,n))},t.prototype.rI=function(t,e){for(var n in this.CCb)this.CCb.hasOwnProperty(n)&&this.CCb[n].rI(t,e)},t.prototype.GR=function(t,e){for(var n in this.CCb)this.CCb.hasOwnProperty(n)&&this.CCb[n].GR(t,e)},t.prototype.tI=function(t,e){for(var n in this.CCb)this.CCb.hasOwnProperty(n)&&this.CCb[n].tI(t,e)},t.prototype.HR=function(t,e){for(var n in this.CCb)this.CCb.hasOwnProperty(n)&&this.CCb[n].HR(t,e)},t}(),e.CellStateManager=f,h={init:function(){this.cellStates=new f(this)},dispose:function(t){var e=this;e.cellStates&&!1!==t.clearCache&&(e.cellStates.destory(),e.cellStates=null)},onLayoutChanged:function(t){var e,n,o=t.changeType,i=t.row,a=t.rowCount,s=t.col,l=t.colCount,u=t.sheetArea,c=this.cellStates;if("addRows"===o)c.rI(i,a);else if("deleteRows"===o)c.GR(i,a);else if("addColumns"===o)c.tI(s,l);else if("deleteColumns"===o)c.HR(s,l);else if("clear"===o&&(3===u&&2==(2&t.type)&&c.DCb(new r.Range(i,s,a,l),u),3===u&&1==(1&t.type)))for(e=i;e<i+a;e++)for(n=s;n<s+l;n++)this.ITa.XTa(u).setCellState(e,n,r.CellStatesType.invalid,!1)},toJson:function(t,e){(!e||e&&!e.ignoreStyle)&&(t.cellStates=this.cellStates.toJSON())},fromJson:function(t,e,n){var o=this,r=n&&!n.ignoreStyle||!n;t&&t.cellStates&&r&&(o.cellStates=new f(o),o.cellStates.fromJSON(t.cellStates,e,n))}},p={xIb:function(t,e,n,o,r,i){o&&o<=3&&o>0&&this.cellStates.HJb(t,e,n,o,r,i)},GJb:function(t,e,n){var o=this.ITa.hUa(n);return o&&o[t]&&o[t][e]}},a(r.Worksheet.prototype,p),r.Worksheet.$n(l,h),a(r.lUa.prototype,{ACb:function(t){var e,n=this.zTa;n&&(e=void 0,(e=n.ECb?n.ECb:[]).push(t),n.ECb=e)},FCb:function(t){var e=this;t&&t.length>0&&t.forEach((function(t){var n=t.type,o=g(t,["type"]);switch(n){case"rangeChange":e.GCb(d({},o));break;case"add":e.HCb(d({},o));break;case"clear":e.ICb(d({},o));break;case"remove":e.IJb(d({},o))}}))},ICb:function(t){var e=t.cache,n=t.sheetArea;t.collection.uCb(e,n)},IJb:function(t){var e=t.cache,n=t.range,o=t.style,r=t.index;e.splice(r,0,{range:n,style:o})},HCb:function(t){var e,n=t.cache,o=t.range,r=t.style,i=t.index;-1===i?(n.forEach((function(t,n){var i=t.range,a=t.style;i===o&&a===r&&(e=n)})),n.splice(e,1)):n[i].style=r},GCb:function(t){var e=t.range,n=t.row,o=t.col,r=t.rowCount,i=t.colCount;n!==s&&(e.row=n),o!==s&&(e.col=o),r!==s&&(e.rowCount=r),i!==s&&(e.colCount=i)}}),r.lUa.$n(l,{undo:function(t){var e=t.ECb;e&&this.FCb(e)}})},"./dist/plugins/cellState/cellstate.entry.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n("./dist/plugins/cellState/cellStateManager.js"))},"./dist/plugins/celltype/buttoncelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function b(t,e,n,o){var r,i=t.ITa;i&&(i.do("setValueForKey",e,n,d,p,o),(r=i.getValueForKey(e,n,g,o))&&(clearTimeout(r),i.do("setValueForKey",e,n,g,p,o)))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=r.Events.SelectionChanged,a=o.Common.j.Fa,s=r.Ul.nl,l=r.CellTypes.Context,u=r.CellTypes.Text,c=r.CellTypes.Base,f=r.GC$,h=f.each,p=void 0,d="_isFirstMouseUp",g="_mouseupToken",m=".buttonCellType",y={marginTop:2,marginRight:2,marginBottom:2,marginLeft:2,text:"",buttonBackColor:null,buttonState:0},v=function(t){function e(){var e,n=t.call(this)||this;return n.typeName="6",e=n,h(y,(function(t,n){e["_"+t]=n})),n}return C(e,t),e.prototype.paintValue=function(t,e,n,o,i,a,s,l){var c,f,h,p,d,g,m,y,v,C,b;t&&(f=(c=this)._marginLeft,h=c._marginTop,p=n+f,d=o+h,g=i-f-c._marginRight,m=a-h-c._marginBottom,g-2>0&&m-2>0&&(p+g>n&&p<n+i&&d+m>o&&d<o+a)&&(t.save(),(p<n||p+g>n+i||d<o||d+m>o+a)&&(t.rect(n,o,i,a),t.clip()),t.beginPath(),y="#707070",t.strokeStyle!==y&&(t.strokeStyle=y),t.strokeRect(p+.5,d+.5,g-1,m-1),v=void 0,C=c._buttonState,b=c._text,2===C?v="#34B4E3":(v=c._buttonBackColor)||(v={degree:90,stops:[{position:0,color:"#F6FAFB"},{position:.125,color:"#F6FAFB"},{position:1,color:"#D2DBEB"}]}),t.fillStyle!==v&&(t.fillStyle=v),r.To.setFillStyle(t,v,n,o,i,a,(function(){t.fillRect(p+1,d+1,g-2,m-2)})),t.restore(),b&&u.prototype.paintValue.call(c,t,b,p,d,g,m,s,l)))},e.prototype.getText=function(t,e){return t},e.prototype.tw=function(t,e,n,o){var r=t.parent;r&&r.tw(t,e,n,o)},e.prototype.getHitInfo=function(t,e,n,o,r){var i,s,l,u,c,f,h=this;return r&&(i=r.sheetArea,(a(i)||3===i)&&o)?(s=o.x+h._marginLeft,l=o.x+o.width-h._marginRight,u=o.y+h._marginTop,c=o.y+o.height-h._marginBottom,f={x:t,y:e,row:r.row,col:r.col,cellRect:o,sheetArea:i,sheet:r.sheet,cellStyle:n},s<=t&&t<=l&&u<=e&&e<=c&&(f.isReservedLocation=!0),f):null},e.prototype.processMouseDown=function(t){var e=this,n=t&&t.sheet;return!(!n||!t.isReservedLocation||e.uK||(e.uK=!0,e._buttonState=2,n.repaint(t.cellRect),0))},e.prototype.processMouseUp=function(t){var e,n,o,r,i=this,a=t&&t.sheet;if(i.uK&&a&&t.isReservedLocation){if(i._buttonState=0,a.repaint(t.cellRect),i.uK=!1,e=t.row,n=t.col,o=t.sheetArea,!a.ITa.getValueForKey(e,n,d,o))return i.tw(a,e,n,o),a.ITa.do("setValueForKey",e,n,d,!0,o),r=setTimeout((function(){b(a,e,n,o)}),250),a.ITa.do("setValueForKey",e,n,g,r,o),!0;b(a,e,n,o)}return!1},e.prototype.processMouseLeave=function(t){var e=this,n=t&&t.sheet;n&&e.uK&&(e._buttonState=0,n.repaint(t.cellRect),e.uK=!1)},e.prototype.processKeyDown=function(t,e){var n,o=e.sheet,r=this;return!(!o||r.vK||(n=o.getCellRect(e.row,e.col),r._buttonState=2,o.repaint(n),o.Fu(i+m,(function(){o.Gu(i+m),r.vK=!1,r._buttonState=0,o.repaint(n)})),r.vK=!0,0))},e.prototype.processKeyUp=function(t,e){var n,o,r,a=e.sheet,s=this;return!(!a||!s.vK||(n=e.row,o=e.col,r=a.getCellRect(n,o),s._buttonState=0,a.repaint(r),a.Gu(i+m),s.tw(a,n,o,e.sheetArea),s.vK=!1,0))},e.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},e.prototype.getAutoFitWidth=function(t,e,n,o,r){var i=this;return l.cp(t,i._text,n,o,r)+i._marginLeft+i._marginRight},e.prototype.getAutoFitHeight=function(t,e,n,o,r){var i=this;return l.ep(t,i._text,n,o,r)+i._marginTop+i._marginBottom},e.prototype.JH=function(t){this.isReservedKey(t)&&s(t)},e.prototype.isImeAware=function(t){return!1},e.prototype.toJSON=function(){var t,e=this,n={typeName:e.typeName};return h(y,(function(o,r){"buttonState"!==o&&((t=e["_"+o])!==r&&(n[o]=t))})),n},e.prototype.fromJSON=function(t){var e=this;h(y,(function(n){var o=t[n];a(o)||(e["_"+n]=o)}))},e.prototype.a5=function(t){},e.prototype.gQa=function(){},e}(c),e.Button=v,h(y,(function(t){v.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}})),r.CellTypes._o[6]=v},"./dist/plugins/celltype/cellbuttons.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E;function D(t){switch(t){case x:return o.ButtonPosition.left;case S:return o.ButtonPosition.right;case A:return o.ButtonPosition.leftOfText;case I:return o.ButtonPosition.rightOfText}}function O(t){switch(t){case o.ButtonPosition.left:return x;case o.ButtonPosition.right:return S;case o.ButtonPosition.leftOfText:return A;case o.ButtonPosition.rightOfText:return I}}function j(t){var e,n,o=t.split(" ");for(n=0;n<o.length;n++)if(o[n].indexOf(v)>=0){e=o[n];break}switch(e){case C:return x;case b:return S;case w:return A;case T:return I}}function F(t){switch(t){case x:return C;case S:return b;case A:return w;case I:return T}}function P(t,e,n,o){var r,i=t.ITa;i&&(i.do("setValueForKey",e,n,h,s,o),(r=i.getValueForKey(e,n,p,o))&&(clearTimeout(r),i.do("setValueForKey",e,n,p,s,o)))}function _(t,e,n){var r,i;switch(n){case N.topLeft:return new o.Rect(t.x,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.topCenter:return r=(t.width-e.width)/2,r=Math.max(0,r),new o.Rect(t.x+r,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.topRight:return r=t.width-e.width,r=Math.max(0,r),new o.Rect(t.x+r,t.y,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.MiddleLeft:return i=(t.height-e.height)/2,i=Math.max(0,i),new o.Rect(t.x,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.MiddleCenter:return r=(t.width-e.width)/2,r=Math.max(0,r),i=(t.height-e.height)/2,i=Math.max(0,i),new o.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.MiddleRight:return r=t.width-e.width,r=Math.max(0,r),i=(t.height-e.height)/2,i=Math.max(0,i),new o.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.bottomLeft:return i=t.height-e.height,i=Math.max(0,i),new o.Rect(t.x,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.bottomCenter:return r=(t.width-e.width)/2,r=Math.max(0,r),i=t.height-e.height,i=Math.max(0,i),new o.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height));case N.bottomRight:return r=t.width-e.width,r=Math.max(0,r),i=t.height-e.height,i=Math.max(0,i),new o.Rect(t.x+r,t.y+i,Math.min(e.width,t.width),Math.min(e.height,t.height))}}function L(t,e,n){var o,r=[];for(o=0;o<t.length;o++)r.push({width:K(t[o].button,e,n),height:tt(t[o].button,n)});return r}function B(t,e,n,o,r,a){var s,l,u,c,f=[],h=[];for(s=0;s<t.length;s++)l=e[t[s].index],i(l)?h.push(t[s]):f.push(l);for(u=V(f),s=0;s<h.length;s++)c=K(h[s].button,n,o),(!a||u.width+c<=a.width)&&(u.width+=c);return u.height=u.height?u.height:a?a.height:0,u}function G(t,e,n,r,s,l,u,c,f,h,p,d){var g,m,y,v,A,I,R,k,M,N=et(e,n,u,c,!0,[t]);if(N.length>0){switch(X(N,e),t){case o.ButtonPosition.left:g=C;break;case o.ButtonPosition.right:g=b;break;case o.ButtonPosition.leftOfText:g=w;break;case o.ButtonPosition.rightOfText:g=T;break;default:return}switch(m=B(N,h,s,r,0,l),y="0",v=a(),(o.Ul.Ml.mozilla||v>1)&&(y="1px"),A=m.width,I=m.height,R=O(t),i(f.canvasSizes)&&(f.canvasSizes={}),(k=f.canvasSizes)[R]={width:A,height:I},M=H(g,A,I,{width:A+"px",height:I+"px",display:"block",position:"absolute",bottom:y,overflow:"hidden",paddingTop:"0"}),t){case o.ButtonPosition.left:M.style.left="0";break;case o.ButtonPosition.right:M.style.right="0";break;case o.ButtonPosition.leftOfText:M.style.left=k[x].width+"px";break;case o.ButtonPosition.rightOfText:M.style.right=k[S].width+"px";break;default:return}p.appendChild(M)}}function H(t,e,n,o){var r,i=document.createElement("canvas");for(r in i.className=t+" "+y,o)o.hasOwnProperty(r)&&(i.style[r]=o[r]);return i.width=e,i.height=n,i}function V(t){var e,n,r,i,a;if(t.length<=0)return new o.Rect(0,0,0,0);for(e=t[0].x,n=t[0].y,r=t[0].x+t[0].width,i=t[0].y+t[0].height,a=1;a<t.length;a++)e=Math.min(e,t[a].x),n=Math.min(n,t[a].y),r=Math.max(r,t[a].x+t[a].width),i=Math.max(i,t[a].y+t[a].height);return new o.Rect(e,n,r-e,i-n)}function z(t,e,n,r,a,s,l,u){var c,f,h,p,d,g;if(!i(t))for(i(u[n])&&(u[n]={}),X(e,r.sheet),c=t.getContext("2d"),f=B(e,l,a,r),c.setTransform(parseFloat(t.style.width)/f.width,0,0,parseFloat(t.style.height)/f.height,0,0),h=0,0,p=new o.Rect(0,0,parseFloat(t.style.width),parseFloat(t.style.height)),d=0;d<e.length&&(g=Q(c,h,0,K(e[d].button,a,r),r.sheet.getRowHeight(r.row),e[d].button,a,r,s,u[n],e[d].index,p),!i(g));d++)h+=g.width}function W(t,e,n,r,a,s,l,u,c,f,h,p){var d,g,m,y,v,R,k,M=et(e,n,l,u,!0,[t]);if(M.length>0){switch(d=void 0,g=void 0,t){case o.ButtonPosition.left:d=C,g=x;break;case o.ButtonPosition.right:d=b,g=S;break;case o.ButtonPosition.leftOfText:d=w,g=A;break;case o.ButtonPosition.rightOfText:d=T,g=I;break;default:return}if(m=p.querySelector("."+d),i(m))return;switch(y=parseFloat(m.style.width),v=s.options.contentRect,R=s.options.leftExternalRect,k=s.options.rightExternalRect,t){case o.ButtonPosition.left:v.x+=y,v.width-=y;break;case o.ButtonPosition.right:v.width-=y;break;case o.ButtonPosition.leftOfText:R.width+=y;break;case o.ButtonPosition.rightOfText:k.width+=y}z(m,M,g,r,a,c,f,h),function(t,e,n,o,r,a){var s,l,u,c,f;i(a.eventListeners)&&(a.eventListeners={}),i(a.eventListeners[e])&&(a.eventListeners[e]={}),l=(s=a.eventListeners[e]).mouseDownListener=function(i){at(it({x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,t)},t.addEventListener("mousedown",l),u=s.mouseUpListener=function(i){st(it({x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,t)},t.addEventListener("mouseup",u),c=s.mouseMoveListener=function(i){lt(it({x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:e},!0),!0,t)},t.addEventListener("mousemove",c),f=s.mouseLeaveListener=function(i){var a={x:i.offsetX,y:i.offsetY,context:n,cellRect:r,cellStyle:o,buttonArea:e};a.x<0&&(a.x=0),a.x>=parseFloat(t.style.width)&&(a.x=parseFloat(t.style.width)-1),ut(it(a,!0),!0,t)},t.addEventListener("mouseleave",f)}(m,g,r,a,s.options.cellRect,c)}}function U(t,e,n,r,i,a,s){var l,u,c,f,h,p,d=et(e,n,r,i,!0,[t]);if(d&&d.length>0)switch(l=O(t),u=a[l]&&a[l].width||0,c=s.contentContainer,f=s.contentRect,h=s.leftExternalRect,p=s.rightExternalRect,t){case o.ButtonPosition.left:q(c,"left",u),f.x+=u,f.width-=u;break;case o.ButtonPosition.leftOfText:q(c,"left",u),h.width+=u;break;case o.ButtonPosition.right:f.width-=u;break;case o.ButtonPosition.rightOfText:p.width+=u;break;default:return}}function q(t,e,n){var o=0;t.style[e]&&(o=function(t){return+t.replace("px","")||0}(t.style[e])),o+=n,t.style[e]=o-1+"px"}function Y(t,e){i(e.mouseDownListener)||t.removeEventListener("mousedown",e.mouseDownListener),i(e.mouseUpListener)||t.removeEventListener("mouseup",e.mouseUpListener),i(e.mouseMoveListener)||t.removeEventListener("mousemove",e.mouseMoveListener),i(e.mouseLeaveListener)||t.removeEventListener("mouseleave",e.mouseLeaveListener)}function X(t,e){var n,o,r=e.vu();for(n=0;n<t.length;n++)(o=pt(t[n].button))&&r.fo(o)}function Z(t,e,n,r,a,s,l){var u,c,f,h,p,d,g;if(t&&!(e.length<=0)){if(a=ft(a),X(e,u=s.sheet),c=function(t,e,n){switch(n){case o.ButtonPosition.leftOfText:return new o.Rect(t.x,t.y,e.x-t.x,t.height);case o.ButtonPosition.rightOfText:return new o.Rect(e.x+e.width,t.y,t.x+t.width-e.x-e.width,t.height)}}(n,r,l?o.ButtonPosition.leftOfText:o.ButtonPosition.rightOfText),t.save(),t.rect(c.x,c.y,c.width,c.height),t.clip(),t.beginPath(),f=rt(u,s.row,s.col,s.sheetArea),h=ft(a),i(f.layout)&&(f.layout={}),l)for(p=c.x+c.width,d=e.length-1;d>=0&&(g=Q(t,p-=K(e[d].button,h,s),n.y,K(e[d].button,h,s),c.height,e[d].button,h,s,f,f.layout,e[d].index,n),!i(g));d--);else for(p=c.x,d=0;d<e.length&&(g=Q(t,p,n.y,K(e[d].button,h,s),c.height,e[d].button,h,s,f,f.layout,e[d].index,n),!i(g));d++)p+=g.width;t.restore()}}function Q(t,e,n,r,a,s,l,u,c,f,h,p){var d,g=0;if(c.buttonDownIndex===h?g=2:c.buttonHoverIndex===h&&(g=3),d=function(t,e,n,r,i){if(!(t+n<i.x||t>i.x+i.width||e+r<i.y||e>i.y+i.height))return t+n>i.x+i.width&&(n=i.x+i.width-t),e+r>i.y+i.height&&(r=i.y+i.height-e),t<i.x&&(t=i.x),e<i.y&&(e=i.y),new o.Rect(t,e,n,r)}(e,n,r,a,p),!i(d))return J(t,d.x,d.y,d.width,d.height,s,l,u,g,p),f[h]=new o.Rect(d.x,d.y,d.width,d.height),f[h]}function J(t,e,n,r,a,u,c,h,p,d){var y,v,C,b,w,T,x,S,A,I,R,k,M,E,D,O,j,F,P;t.save(),t.beginPath(),y=u.useButtonStyle,v=h.sheet.zoom(),e+=C=y?2*v:0,n+=C,r-=2*C,a-=2*C,b="#707070",t.strokeStyle!==b&&(t.strokeStyle=b),y&&t.strokeRect(e+.5,n+.5,r-1,a-1),u.buttonBackColor?w=u.buttonBackColor:y?!1===u.enabled?w="#e6e6e6":2===p?w="#34B4E3":3===p||h.visualState===o.VisualState.hover?w=f:((T=t.createLinearGradient(e+r/2,n,e+r/2,n+a)).addColorStop(.125,"#F6FAFB"),T.addColorStop(1,"#D2DBEB"),w=T):(w="white",3===p&&(u.enabled||i(u.enabled))&&(w=f)),(x=c.font)&&t.font!==x&&(t.font=x),t.fillStyle!==w&&(t.fillStyle=w),e+=1,n+=1,r-=2,a-=2,t.rect(e,n,r,a),t.clip(),t.beginPath(),t.fillRect(e,n,r,a),S=new o.Rect(e,n,r,a),A=new o.Rect(e,n,r,a),I=0*v,R=pt(u),u.caption&&R&&(k=(m.cp(l,u.caption,c,v,h)+4)*v,M=nt(u)*v,E=new o.Rect(0,0,k+M+I,a),D=_(new o.Rect(e,n,r,a),E,N.MiddleCenter),u.captionAlign===o.CaptionAlignment.left?(A=new o.Rect(D.x,n,k,a),S=D.x+k+I<e+r-2?new o.Rect(D.x+k+I,n,Math.max(0,M),a):new o.Rect(0,0,0,0)):(S=new o.Rect(D.x,n,Math.min(M,r),a),A=D.x+M+I<e+r-2?new o.Rect(D.x+M+I,n,Math.min(r-2-M-I,k),a):new o.Rect(0,0,0,0))),u.caption&&(O=(m.cp(l,u.caption,c,v,h)+4)*v,j=(m.ep(l,u.caption,c,v,h)+4)*v,F=_(A,new o.Rect(0,0,O,j),N.MiddleCenter),P=new g,c=c.clone(),!1===u.enabled&&(c.foreColor="#CACACA"),c.cellButtons=s,P.paintValue(t,u.caption,F.x,F.y-2,F.width,F.height,c,h)),R&&$(t,u,S.x,S.y,S.width,S.height,R,h,d),t.restore()}function $(t,e,n,r,i,a,s,l,u){var c,f,h,p,d,g,m,y,v,C,b;t.save(),t.rect(n+2,r+2,i-4,a-4),t.clip(),t.beginPath(),(c=l.sheet.vu()).ko(s)?c.bgc(s)&&(f=l.sheet.zoom(),h=new o.Rect(n,r,i,a),p=nt(e)-2,d=ot(e)-2,g=_(h,new o.Rect(0,0,p*f,d*f),N.MiddleCenter),y=(m=c.lo(s)).width,v=m.height,o.Ul.Ml.msie&&e.imageType&&(e.imageType===o.ButtonImageType.custom?(k[s]||(m.style.position="absolute",m.style.left="-10000px",m.style.top="-100000px",document.body.appendChild(m),k[s]={width:m.width,height:m.height},document.body.removeChild(m)),y=k[s].width,v=k[s].height):(y=12,v=12)),u&&o.Ul.Ml.msie&&g.x+g.width>u.x+u.width?(C=u.x+u.width-g.x)>0&&(b=y/(p*f),t.drawImage(m,0,0,C*b,v,g.x,g.y,C,d*f)):t.drawImage(m,0,0,y,v,g.x,g.y,p*f,d*f)):c.fo(s),t.restore()}function K(t,e,n,o){var r,a,s,c,f;return void 0===o&&(o=!0),r=n.sheet.zoom(),a=7,i(t.width)?(s=m.cp(l,t.caption,e,r,n),c=t.useButtonStyle,pt(t)&&(s=nt(t)+s,a=(c?a:0)+0),o?(s+a+7)*r:s+a+7):(f=u(1,t.width),isNaN(f)&&(f=1),o?f*r:f)}function tt(t,e,n){var o,r,i,a;return void 0===n&&(n=!0),o=e.sheet.zoom(),r=e.sheet.getRowHeight(e.row),i=t.imageSize?t.imageSize.height:l,a=u(1,i||r),isNaN(a)&&(a=1),n?a*o:a}function et(t,e,n,r,a,s){var l,u,c,f,h=[];if(!e||0===e.length)return[];for(l=!1,u=t.ITa.getValueForKey(n,r,d),t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===r&&!0!==u&&(l=!0),c=0;c<e.length;c++)for(f=0;f<s.length;f++)(e[c].position===s[f]||i(e[c].position)&&s[f]===o.ButtonPosition.right)&&(e[c].visibility===o.ButtonVisibility.onEditing&&a||e[c].visibility!==o.ButtonVisibility.onEditing&&l||e[c].visibility===o.ButtonVisibility.always||i(e[c].visibility))&&h.push({index:c,button:e[c]});return h}function nt(t){var e;return t.imageSize&&("string"==typeof t.imageSize.width&&(e=c(t.imageSize.width)),"number"==typeof t.imageSize.width&&(e=t.imageSize.width)),(e===l||isNaN(e)||e<0)&&(e=16),e}function ot(t){var e;return t.imageSize&&("string"==typeof t.imageSize.height&&(e=c(t.imageSize.height)),"number"==typeof t.imageSize.height&&(e=t.imageSize.height)),(e===l||isNaN(e)||e<0)&&(e=16),e}function rt(t,e,n,r,i){var a,s={isMouseDownReservedLocation:!1};return r===o.SheetArea.corner?s:((a=t.ITa.getValueForKey(e,n,R,r))||i||function(t,e,n,o,r){t.ITa.setValueForKey(e,n,R,r,o)}(t,e,n,r,a=s),a)}function it(t,e){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w;if(void 0===e&&(e=!1),n=t.context.row,r=t.context.col,i=t.cellRect,a=t.cellStyle,s=t.context,u=(l={x:t.x,y:t.y,row:n,col:r,cellRect:i,cellStyle:a,sheetArea:t.context.sheetArea,sheet:t.context.sheet,context:s}).sheet,!1!==t.cellStyle.locked&&u.options.isProtected)return null;if(c=rt(u,l.row,l.col,l.sheetArea,!0),f=t.cellStyle.cellButtons,!c||!f||f.length<=0)return null;if(h=c.layout,e&&(h=c.editorLayout[t.buttonArea]),!h)return null;for(m in p=-1,d=l.x,g=l.y,h)if(h.hasOwnProperty(m)&&h[m].contains(d,g)){p=+m;break}return-1!==p?l.cellButtonHitInfo={hitButtonIndex:p,buttonConfig:f[p],buttonArea:t.buttonArea}:(y=u.getCellType(l.row,l.col))&&(v=B(et(u,f,n,r,e,[o.ButtonPosition.left]),h,a,s),C=B(et(u,f,n,r,e,[o.ButtonPosition.right]),h,a,s),b=new o.Rect(i.x+v.width,i.y,i.width-v.width-C.width,i.height),(w=y.getHitInfo(l.x,l.y,a,b,s))&&w.isReservedLocation&&(l.isReservedLocation=!0)),l}function at(t,e,n){var r,a,s,u,c,f,h,p,d,g,m,y,v,C;return void 0===e&&(e=!1),!(!t||!t.cellButtonHitInfo)&&(r=t.sheet,a=t.row,s=t.col,u=t.sheetArea,a===r.Jl&&s===r.Kl||u!==o.SheetArea.viewport||r.endEdit()?(c=rt(r,a,s,t.sheetArea),t.cellButtonHitInfo&&(h=t.cellButtonHitInfo.hitButtonIndex,f=t.cellButtonHitInfo.buttonConfig),!!(r&&!c.isMouseDownReservedLocation&&f&&(f.enabled||i(f.enabled))&&h>=0)&&(c.buttonDownIndex=h,c.isMouseDownReservedLocation=!0,h>=0&&f.command&&(p=f.command,e||r.getActiveRowIndex()===a&&r.getActiveColumnIndex()===s||r.DJ(a,s,1,1,2),"string"==typeof p?r.getParent().commandManager().execute({cmd:p,row:a,col:s,sheetName:r.name(),sheetArea:t.sheetArea}):"function"==typeof p&&p.call(l,r,a,s,t.sheetArea)),e&&n?(d=t.cellStyle,g=c.layout,m=t.context,y=c.editorLayout,v=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,C=d.cellButtons,v&&z(n,et(r,C,a,s,!0,[D(v)]),v,m,d,c,g,y)):r.repaint(t.cellRect),!0)):void 0)}function st(t,e,n){var o,r,i,a,s,l,u,c,f,d,g,m;if(void 0===e&&(e=!1),t){if(o=t&&t.sheet,r=t.row,i=t.col,(a=rt(o,t.row,t.col,t.sheetArea)).isMouseDownReservedLocation&&o){if(e&&a.buttonDownIndex>=0&&n&&(a.buttonDownIndex=-1,s=t.cellStyle,l=a.layout,u=t.context,c=a.editorLayout,f=t.cellButtonHitInfo&&t.cellButtonHitInfo.buttonArea,d=s.cellButtons,f&&z(n,et(o,d,r,i,!0,[D(f)]),f,u,s,a,l,c)),a.buttonDownIndex=-1,e||o.repaint(t.cellRect),a.isMouseDownReservedLocation=!1,g=t.sheetArea,!o.ITa.getValueForKey(r,i,h,g))return function(t,e,n,o){var r=t.parent;r&&r.tw(t,e,n,o)}(o,r,i,g),o.ITa.do("setValueForKey",r,i,h,!0,g),m=setTimeout((function(){P(o,r,i,g)}),250),o.ITa.do("setValueForKey",r,i,p,m,g),!0;P(o,r,i,g)}return!1}}function lt(t,e,n){var o,r,i,a,s,l,u,c,f,h;if(void 0===e&&(e=!1),t)return r=rt(o=t&&t.sheet,t.row,t.col,t.sheetArea),i=-1,t.cellButtonHitInfo&&(i=t.cellButtonHitInfo.hitButtonIndex),i!==r.buttonHoverIndex?(r.buttonHoverIndex=i,e?(a=t.cellStyle,s=r.layout,l=t.context,u=r.editorLayout,c=a.cellButtons,f=t.row,h=t.col,n&&ct(c,o,f,h,n.parentElement,l,a,r,s,u)):o.repaint(t.cellRect),!0):void 0}function ut(t,e,n){var o,r,i,a,s,l,u,c,f;void 0===e&&(e=!1),t&&t.cellButtonHitInfo&&(r=rt(o=t&&t.sheet,t.row,t.col,t.sheetArea),e?(r.buttonHoverIndex=-1,t.cellButtonHitInfo.hitButtonIndex>=0&&(i=t.cellStyle,a=r.layout,s=t.context,l=r.editorLayout,u=i.cellButtons,c=t.row,f=t.col,n&&ct(u,o,c,f,n.parentElement,s,i,r,a,l))):(o&&(r.buttonHoverIndex=-1),o.repaint(t.cellRect)))}function ct(t,e,n,o,r,i,a,s,l,u){var c,f;for(c=0;c<M.length;c++)f=O(M[c]),z(r.querySelector("."+F(f)),et(e,t,n,o,!0,[D(f)]),f,i,a,s,l,u)}function ft(t){var e=t.clone();return e.hAlign=o.HorizontalAlign.left,e.vAlign=o.VerticalAlign.center,e.wordWrap=!1,e.isVerticalText=!1,e.shrinkToFit=!1,e.formatter="General",e.textIndent=0,e}function ht(t,e,n,o,r){var i,a=t.AHb(e,n,r);if(a&&a.cellButtons&&a.cellButtons.length>0&&a.cellButtons.filter((function(t){return 1===t.visibility})).length>0){o&&t.ITa.do("setValueForKey",e,n,d,!0,r);try{i=t.getCellRect(e,n,1===r?-1:void 0,2===r?-1:void 0),t.repaint(i)}finally{o&&t.ITa.do("setValueForKey",e,n,d,s,r)}}}function pt(t){var e,n=null,r=t.imageType;if(i(t.imageType))return null;switch(e=t.enabled||i(t.enabled),r){case o.ButtonImageType.dropdown:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZHJvcGRvd248L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZHJvcGRvd24iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iMyA0IDEwIDQgNi41IDkiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.left:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bGVmdDwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJsZWZ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cG9seWdvbiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case o.ButtonImageType.right:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmlnaHQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0icmlnaHQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNi4wMDAwMDAsIDYuNTAwMDAwKSBzY2FsZSgtMSwgMSkgdHJhbnNsYXRlKC02LjAwMDAwMCwgLTYuNTAwMDAwKSAiIHBvaW50cz0iNS4zNTE1MjcxMiA2LjUgOCA5LjI4ODYzMDM2IDcuMzI0MzU0MDMgMTAgNCA2LjUgNy4zMjQzNTQwMyAzIDggMy43MTEzNjk2NCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case o.ButtonImageType.clear:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2xlYXI8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iY2xlYXIiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIGZpbGwtcnVsZT0ibm9uemVybyIgcG9pbnRzPSI4Ljg3NTQ2MzkgMyAxMCA0LjEyNDUzNjEgNy42MjQ1MzYxIDYuNSAxMCA4Ljg3NTQ2MzkgOC44NzU0NjM5IDEwIDYuNSA3LjYyNDUzNjEgNC4xMjQ1MzYxIDEwIDMgOC44NzU0NjM5IDUuMzc1NDYzOSA2LjUgMyA0LjEyNDUzNjEgNC4xMjQ1MzYxIDMgNi41IDUuMzc1NDYzOSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case o.ButtonImageType.calcel:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+Y2FuY2VsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9ImNhbmNlbCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTYsMSBDOC43NjE0MzE3MSwxIDExLDMuMjM4NTgxMzIgMTEsNiBDMTEsOC43NjE0MzE3MSA4Ljc2MTQzMTcxLDExLjAwMDAxMyA2LjAwMDAwNjUyLDExLjAwMDAxMyBDMy4yMzg1ODEzMiwxMS4wMDAwMTMgMSw4Ljc2MTQ0NDc0IDEsNiBDMSwzLjIzODU2ODI5IDMuMjM4NTgxMzIsMSA2LDEgWiBNOC41MTgwNTU5NiwzLjQ4MTk0NDA0IEM4LjI1MTg4NTYxLDMuMjE1NzczNyA3LjgyMDMzODIyLDMuMjE1NzczNyA3LjU1NDE2Nzg4LDMuNDgxOTQ0MDQgTDYsNS4wMzYxMTE5MiBMNC40NDU4MzIxMiwzLjQ4MTk0NDA0IEM0LjE3OTY2MTc4LDMuMjE1NzczNyAzLjc0ODExNDM5LDMuMjE1NzczNyAzLjQ4MTk0NDA0LDMuNDgxOTQ0MDQgQzMuMjE1NzczNywzLjc0ODExNDM5IDMuMjE1NzczNyw0LjE3OTY2MTc4IDMuNDgxOTQ0MDQsNC40NDU4MzIxMiBMNS4wMzYxMTE5Miw2IEwzLjQ4MTk0NDA0LDcuNTU0MTY3ODggQzMuMjE1NzczNyw3LjgyMDMzODIyIDMuMjE1NzczNyw4LjI1MTg4NTYxIDMuNDgxOTQ0MDQsOC41MTgwNTU5NiBDMy43NDgxMTQzOSw4Ljc4NDIyNjMgNC4xNzk2NjE3OCw4Ljc4NDIyNjMgNC40NDU4MzIxMiw4LjUxODA1NTk2IEw2LDYuOTYzODg4MDggTDcuNTU0MTY3ODgsOC41MTgwNTU5NiBDNy44MjAzMzgyMiw4Ljc4NDIyNjMgOC4yNTE4ODU2MSw4Ljc4NDIyNjMgOC41MTgwNTU5Niw4LjUxODA1NTk2IEM4Ljc4NDIyNjMsOC4yNTE4ODU2MSA4Ljc4NDIyNjMsNy44MjAzMzgyMiA4LjUxODA1NTk2LDcuNTU0MTY3ODggTDYuOTYzODg4MDgsNiBMOC41MTgwNTU5Niw0LjQ0NTgzMjEyIEM4Ljc4NDIyNjMsNC4xNzk2NjE3OCA4Ljc4NDIyNjMsMy43NDgxMTQzOSA4LjUxODA1NTk2LDMuNDgxOTQ0MDQgWiIgaWQ9IuW9oueKtue7k+WQiCIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.ok:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+b2s8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ib2siIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik01LjY3NjUyMjQsMTAgQzUuNjc2NTIyNCwxMCA2LjkxNzAzMjUzLDcuMzM0ODI5MDcgOC40MTk2ODA3OSw1LjMyNjE2ODAyIEM5LjU4MDA5Mzk2LDMuNzc2MzU0NDYgMTEsMi43MTg3NTQxMSAxMSwyLjcxODc1NDExIEwxMC41MTYxMDg0LDIgQzEwLjUxNjEwODQsMiA4Ljk2NzEyNTYsMi43MDIwNjg3NSA3LjU3NzY3MjIzLDQuMDUwMzc0NDYgQzYuMTY4MzYwMTEsNS40MTcyOTA3NiA1LjM0NDg4MTIxLDYuOTQ2NTczNSA1LjM0NDg4MTIxLDYuOTQ2NTczNSBMMy4yOTc0Mzg1Niw1LjAxMTcxMzA5IEwyLDYuNDYwMTI1OTcgTDUuNjc2NTE5ODEsOS45OTk5ODc0NyBMNS42NzY1MTk4MSw5Ljk5OTk4NzQ3IEw1LjY3NjUyMjQsMTAgWiIgaWQ9Ik9LIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.plus:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiM2RTZFNkUiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cGx1czwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJwbHVzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNSw1IEw1LDMgTDcsMyBMNyw1IEw5LDUgTDksNyBMNyw3IEw3LDkgTDUsOSBMNSw3IEwzLDcgTDMsNSBMNSw1IFoiIGZpbGw9IiNDQUNBQ0EiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.minus:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiM2RTZFNkUiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+bWludXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ibWludXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxyZWN0IGZpbGw9IiNDQUNBQ0EiIHg9IjMiIHk9IjUiIHdpZHRoPSI2IiBoZWlnaHQ9IjIiPjwvcmVjdD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.redo:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+cmVkbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJyZWRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYuMDAwMDAwLCA2LjAwMDAwMCkgc2NhbGUoLTEsIDEpIHRyYW5zbGF0ZSgtNi4wMDAwMDAsIC02LjAwMDAwMCkgIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.undo:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjNkU2RTZFIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+dW5kbzwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxnIGlkPSJ1bmRvIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNNi43NDY0OTIwNSwzLjc5NjM1NTEyIEM4LjUzNjk1MDQyLDMuNzk2MzU1MTIgMTAsNS4xNzQ5NDI4NyAxMCw2Ljg5NzczMTcxIEMxMCw4LjYyMDUyMDU0IDguNTM2OTUwNDIsMTAgNi43NDY0OTIwNSwxMCBMNS4zMzQ4OTI0MiwxMCBDNS4xOTczODA3MywxMCA1LjExMTMxODk5LDkuOTAxOTExNjEgNS4xMTEzMTg5OSw5Ljc2OTkzODE0IEw1LjExMTMxODk5LDkuMjQ0NzE5MzkgQzUuMTExMzE4OTksOS4xMTM2Mzc2MyA1LjIxNDIxODksOC45OTg2MDY3IDUuMzUyNjY2MDQsOC45OTg2MDY3IEw2Ljc0NzQyNzUsOC45OTg2MDY3IEM3Ljk3MDA2NTQ4LDguOTk4NjA2NyA4Ljk1MTM1NjQxLDguMDYzMjAwMTMgOC45NTEzNTY0MSw2Ljg5NzczMTcxIEM4Ljk1MTM1NjQxLDUuNzMyMjYzMjggNy45NjkxMzAwMyw0Ljc5Nzc0ODQzIDYuNzQ2NDkyMDUsNC43OTc3NDg0MyBMNC4zNTM2MDE1LDQuNzk3NzQ4NDMgQzQuMzUzNjAxNSw0Ljc5Nzc0ODQzIDQuMjE2MDg5OCw0Ljc5Nzc0ODQzIDQuMTY0NjM5ODUsNC44MTM3OTkyNSBDNC4wMjcxMjgxNiw0Ljg3OTc4NTk5IDQuMDYxNzM5OTQsNC45Nzc4NzQzOCA0LjE4MTQ3ODAyLDUuMDkyOTA1MzEgTDUuMDI1MjU3MjUsNS44OTcyMzAxMiBDNS4xMjgxNTcxNiw1Ljk5NTMxODUxIDUuMTExMzE4OTksNi4xNDMzNDI4MSA1LjAwODQxOTA4LDYuMjQxNDMxMiBMNC42Mjk1NjAzNCw2LjYwMjU3NDgyIEM0LjUyNjY2MDQzLDYuNzAwNjYzMjEgNC40MDU5ODY5LDYuNzAwNjYzMjEgNC4zMDIxNTE1NCw2LjYxODYyNTY1IEwyLjA2NDU0NjMsNC40ODU2NDkgQzEuOTc4NDg0NTcsNC40MDM2MTE0NCAxLjk3ODQ4NDU3LDQuMjcyNTI5NjggMi4wNjQ1NDYzLDQuMTkwNDkyMTEgTDQuMjg1MzEzMzgsMi4wNzM1NjYyOSBDNC4zODgyMTMyOCwxLjk3NTQ3NzkgNC41NjAzMzY3NiwxLjk3NTQ3NzkgNC42NDYzOTg1LDIuMDczNTY2MjkgTDUuMDA3NDgzNjMsMi40MTc3NjczNyBDNS4xMTAzODM1NCwyLjUxNTg1NTc3IDUuMTEwMzgzNTQsMi42Nzk5MzA4OSA1LjAwNzQ4MzYzLDIuNzYxOTY4NDYgTDQuMTYzNzA0NCwzLjU2NjI5MzI2IEM0LjA2MDgwNDQ5LDMuNjY0MzgxNjUgNC4wNjA4MDQ0OSwzLjc3OTQxMjU4IDQuMjMyOTI3OTcsMy43Nzk0MTI1OCBMNC4zNTM2MDE1LDMuNzc5NDEyNTggTDYuNzQ2NDkyMDUsMy43OTYzNTUxMiBaIiBmaWxsPSIjQ0FDQUNBIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.search:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iIzZFNkU2RSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VhcmNoPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlYXJjaCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTcuNDQ1MzczOTYsNi43MzgyNjcxOCBMMTAuMDM1NTMzOSw5LjMyODQyNzEyIEw5LjMyODQyNzEyLDEwLjAzNTUzMzkgTDYuNzM4MjY3MTgsNy40NDUzNzM5NiBDNi4yNDc4NTc3NCw3Ljc5NDYwNDUyIDUuNjQ3OTE1MjIsOCA1LDggQzMuMzQzMTQ1NzUsOCAyLDYuNjU2ODU0MjUgMiw1IEMyLDMuMzQzMTQ1NzUgMy4zNDMxNDU3NSwyIDUsMiBDNi42NTY4NTQyNSwyIDgsMy4zNDMxNDU3NSA4LDUgQzgsNS42NDc5MTUyMiA3Ljc5NDYwNDUyLDYuMjQ3ODU3NzQgNy40NDUzNzM5Niw2LjczODI2NzE4IFogTTUuMDAwNTI2MTYsMyBDMy44OTYyNTEzMSwzIDMuMDAxMDUyNDgsMy44OTU0MzQ1NiAzLDUgQzMuMDAxMTYyODYsNi4xMDM2NzQ4NCAzLjg5NTAyNzk5LDYuOTk4MjUxNzQgNS4wMDA1MjYxNiw3IEM2LjEwNDgwMTAxLDcgNi45OTk5OTk4Myw2LjEwNDU2NTQ0IDcsNSBDNywzLjg5NTQzNDU2IDYuMTA0ODAxMDEsMy4wMDAwMDAxNyA1LjAwMDUyNjE2LDMgWiIgZmlsbD0iI0NBQ0FDQSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.separator:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c2VwYXJhdG9yPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNlcGFyYXRvciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTExLDQgTDEwLDQgTDEwLDggTDExLDggTDExLDkgTDksOSBMOSwzIEwxMSwzIEwxMSw0IFogTTIsNCBMMiwzIEw0LDMgTDQsOSBMMiw5IEwyLDggTDMsOCBMMyw0IEwyLDQgWiBNNiwxIEw3LDEgTDcsMTEgTDYsMTEgTDYsMSBaIiBpZD0i5b2i54q257uT5ZCIIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.spinLeft:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiM2RTZFNkUiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbmxlZnQ8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0ic3BpbmxlZnQiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwb2x5Z29uIGZpbGw9IiNDQUNBQ0EiIHBvaW50cz0iOCAzIDQgNi41IDggMTAiPjwvcG9seWdvbj4KICAgIDwvZz4KPC9zdmc+";break;case o.ButtonImageType.spinRight:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iIzZFNkU2RSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+c3BpbnJpZ2h0PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9InNwaW5yaWdodCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gZmlsbD0iI0NBQ0FDQSIgcG9pbnRzPSI0IDMgOCA2LjUgNCAxMCI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=";break;case o.ButtonImageType.ellipsis:n=e?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjNkU2RTZFIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDU1ICg3ODA3NikgLSBodHRwczovL3NrZXRjaGFwcC5jb20gLS0+CiAgICA8dGl0bGU+ZWxsaXBzaXM8L3RpdGxlPgogICAgPGRlc2M+Q3JlYXRlZCB3aXRoIFNrZXRjaC48L2Rlc2M+CiAgICA8ZyBpZD0iZWxsaXBzaXMiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0yLDcgQzEuNDQ3NzE1MjUsNyAxLDYuNTUyMjg0NzUgMSw2IEMxLDUuNDQ3NzE1MjUgMS40NDc3MTUyNSw1IDIsNSBDMi41NTIyODQ3NSw1IDMsNS40NDc3MTUyNSAzLDYgQzMsNi41NTIyODQ3NSAyLjU1MjI4NDc1LDcgMiw3IFogTTYsNyBDNS40NDc3MTUyNSw3IDUsNi41NTIyODQ3NSA1LDYgQzUsNS40NDc3MTUyNSA1LjQ0NzcxNTI1LDUgNiw1IEM2LjU1MjI4NDc1LDUgNyw1LjQ0NzcxNTI1IDcsNiBDNyw2LjU1MjI4NDc1IDYuNTUyMjg0NzUsNyA2LDcgWiBNMTAsNyBDOS40NDc3MTUyNSw3IDksNi41NTIyODQ3NSA5LDYgQzksNS40NDc3MTUyNSA5LjQ0NzcxNTI1LDUgMTAsNSBDMTAuNTUyMjg0Nyw1IDExLDUuNDQ3NzE1MjUgMTEsNiBDMTEsNi41NTIyODQ3NSAxMC41NTIyODQ3LDcgMTAsNyBaIiBmaWxsPSIjQ0FDQUNBIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==";break;case o.ButtonImageType.expand:n=e?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogIzZlNmU2ZTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJjb2xsYXBzZSIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCI+CiAgICAgICAgPHJlY3QgeD0iMCIgeT0iMCIgd2lkdGg9IjEycHgiIGhlaWdodD0iMTJweCIgcng9IjRweCIgcnk9IjRweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsgZmlsbDogbm9uZTsiLz4KICAgICAgICA8bGluZSB4MT0iMnB4IiB5MT0iNnB4IiB4Mj0iMTBweCIgeTI9IjZweCIgc3R5bGU9InN0cm9rZTogI2NhY2FjYTsgc3Ryb2tlLXdpZHRoOjFweDsiLz4KICAgIDwvc3ZnPg==";break;case o.ButtonImageType.collapse:n=e?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICM2ZTZlNmU7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=":"data:image/svg+xml;PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGlkPSJleHBhbmQiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiPgogICAgICAgIDxyZWN0IHg9IjAiIHk9IjAiIHdpZHRoPSIxMnB4IiBoZWlnaHQ9IjEycHgiIHJ4PSI0cHgiIHJ5PSI0cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7IGZpbGw6IG5vbmU7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjJweCIgeTE9IjZweCIgeDI9IjEwcHgiIHkyPSI2cHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICAgICAgPGxpbmUgeDE9IjZweCIgeTE9IjJweCIgeDI9IjZweCIgeTI9IjEwcHgiIHN0eWxlPSJzdHJva2U6ICNjYWNhY2E7IHN0cm9rZS13aWR0aDoxcHg7Ii8+CiAgICA8L3N2Zz4=";break;case o.ButtonImageType.custom:n=t.imageSrc}return n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=r.Common.j.Fa,o.To.No,o.Ul.fp,a=o.En.npb,s=void 0,l=null,u=Math.max,c=parseInt,f="lightgray",h="_isFirstMouseUp",p="_mouseupToken",d="_leaveCell",g=o.CellTypes.Base,m=o.CellTypes.Context,y="gc-cell-button-canvas",C=(v="gc-editor-")+"left-cellbuttons",b=v+"right-cellbuttons",w=v+"left-of-text-cellbuttons",T=v+"right-of-text-cellbuttons",x="leftButtonArea",S="rightButtonArea",A="leftOfTextButtonArea",I="rightOfTextButtonArea",R="_cellButtonParam",k={},o.GC$,M=[o.ButtonPosition.left,o.ButtonPosition.right,o.ButtonPosition.leftOfText,o.ButtonPosition.rightOfText],function(t){t[t.topLeft=0]="topLeft",t[t.topCenter=1]="topCenter",t[t.topRight=2]="topRight",t[t.MiddleLeft=3]="MiddleLeft",t[t.MiddleCenter=4]="MiddleCenter",t[t.MiddleRight=5]="MiddleRight",t[t.bottomLeft=6]="bottomLeft",t[t.bottomCenter=7]="bottomCenter",t[t.bottomRight=8]="bottomRight"}(N||(N={})),o.CellTypes.Base.$n("cellButton",{beforePaintLabel:function(t){var e,n,r,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b=t.options.context,w=t.options.style;if(!b.cellOverflowLayout&&w.cellButtons&&w.cellButtons.length>0&&(e=t.options.context.sheet,n=b.row,r=b.col,(a=et(e,w.cellButtons,n,r,!1,[o.ButtonPosition.left,o.ButtonPosition.right]))&&a.length>0)){if(s=ft(w),X(a,e),!(l=t.ctx))return;for(u=t.options.rect,l.save(),l.rect(u.x,u.y,u.width,u.height),l.clip(),l.beginPath(),c=u.x,f=u.x+u.width,h=rt(e,b.row,b.col,b.sheetArea),i(h.layout)&&(h.layout={}),p=h.layout,d=et(e,w.cellButtons,n,r,!1,[o.ButtonPosition.left]),g=0;g<d.length&&(m=Q(l,c,u.y,K(d[g].button,s,b),u.height,d[g].button,s,b,h,p,d[g].index,u),!i(m));g++)c+=m.width;for(y=c,c=f,g=(v=et(e,w.cellButtons,n,r,!1,[o.ButtonPosition.right])).length-1;g>=0&&(m=Q(l,c-=C=K(v[g].button,s,b),u.y,C,u.height,v[g].button,s,b,h,p,v[g].index,u),!i(m));g--);l.restore(),u.x=y,u.width=c-y}},beforePaintText:function(t){var e,n,r,i,a=t.context,s=t.style;!a.cellOverflowLayout&&s.cellButtons&&s.cellButtons.length>0&&(e=t.context.sheet,n=a.row,r=a.col,(i=t.externals).left=i.left.concat(L(et(e,s.cellButtons,n,r,!1,[o.ButtonPosition.leftOfText]),s,a)),i.right=i.right.concat(L(et(e,s.cellButtons,n,r,!1,[o.ButtonPosition.rightOfText]),s,a)))},beforeFillTextArea:function(t){var e,n,r,i,a=t.style,s=a.cellButtons;a.cellButtons&&a.cellButtons.length>0&&(e=t.ctx,n=t.availRect,r=t.textRect,Z(e,et((i=t.context).sheet,s,i.row,i.col,!1,[o.ButtonPosition.leftOfText]),n,r,a,i,!0))},afterFillTextArea:function(t){var e,n,r,i,a=t.style,s=a.cellButtons;a.cellButtons&&a.cellButtons.length>0&&(e=t.ctx,n=t.availRect,r=t.textRect,Z(e,et((i=t.context).sheet,s,i.row,i.col,!1,[o.ButtonPosition.rightOfText]),n,r,a,i,!1))},onCreateCellEditor:function(t){var e,n,r,a,s,l,u,c,f,h,p,d,g,m=t.options.dom;if(m&&m.children&&((e=m.children[0])&&e.children&&e.children[0])){if(r=(n=t.context).sheet,a=n.row,s=n.col,l=t.options.cellStyle,i(l)&&(l=r.getActualStyle(a,s)),u=l.cellButtons,i(u)||u&&u.length<=0)return;for(c=t.options.cellRect,f=new o.Rect(c.x,c.y,c.width,c.height),h=rt(r,a,s,n.sheetArea),i(h.layout)&&(h.layout={}),p=h.layout,d=!1,g=0;g<u.length;g++)u[g].position!==o.ButtonPosition.leftOfText&&u[g].position!==o.ButtonPosition.rightOfText||(d=!0);for(d&&(e.style.overflow="hidden"),g=0;g<M.length;g++)G(M[g],r,u,n,l,f,a,s,h,p,m)}},onActivateCellEditor:function(t){var e,n,o,r,a,s,l=t.context,u=l.sheet,c=l.row,f=l.col,h=t.options.cellStyle,p=h.cellButtons;if(!(i(p)||p.length<=0))for(e=rt(u,c,f,l.sheetArea),i(e.editorLayout)&&(e.editorLayout={}),n=e.layout,o=e.editorLayout,r=ft(h),a=t.options.dom,s=0;s<M.length;s++)W(M[s],u,p,l,r,t,c,f,e,n,o,a)},onDeactivateCellEditor:function(t){var e,n,o,r,a,s,l=t.context,u=l.sheet,c=l.row,f=l.col,h=u.getActualStyle(c,f,l.sheetArea).cellButtons;if(h&&h.length>0)for(n=(e=rt(l.sheet,c,f,l.sheetArea)).eventListeners,o=t.options.dom.querySelectorAll("."+y),r=0;r<o.length;r++)s=j((a=o[r]).className),i(s)||i(n)||i(n[s])||(Y(a,n[s]),delete e.eventListeners[s])},onUpdateContainer:function(t){var e,n=t.context,o=n.sheet,r=n.row,a=n.col,s=rt(n.sheet,r,a,n.sheetArea).canvasSizes,l=t.cellStyle.cellButtons;if(!(i(l)||l.length<=0))for(t.context.preventOverflow=!0,e=0;e<M.length;e++)U(M[e],o,l,r,a,s,t)},getCellButtonHitInfo:function(t){t.paddingHitInfo=it(t)},processMouseDownOnCellPadding:function(t){at(t)},processMouseUpOnCellPadding:function(t){st(t)},processMouseMoveOnCellPadding:function(t){lt(t)},processMouseLeaveOnCellPadding:function(t){ut(t)},getCellButtonAutoHeight:function(t){var e,n,r=t.context.sheet,i=t.context.row,a=t.context.col,s=t.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(e=et(r,s.cellButtons,i,a,!1,[o.ButtonPosition.left,o.ButtonPosition.right]),n=0,e.forEach((function(e){var o=m.ep(l,e.button.caption,s,r.zoom(),t.context)-2;pt(e.button)&&(o=u(o,nt(e.button))),n=u(o,n)})),t.value=n+2)},getCellButtonAutoWidth:function(t){var e,n,r=t.context.sheet,i=t.context.row,a=t.context.col,s=t.cellStyle;s.cellButtons&&0!==s.cellButtons.length&&(e=et(r,s.cellButtons,i,a,!1,[o.ButtonPosition.left,o.ButtonPosition.right]),n=0,e.forEach((function(e){n+=K(e.button,s,t.context,!1)})),t.value=n)}}),E="cellButtons",o.Worksheet.$n(E,{setHost:function(){var t=this;t.bind(o.Events.EnterCell+"."+E,(function(e,n){ht(t,n.row,n.col,!1,n.sheetArea)})),t.bind(o.Events.LeaveCell+"."+E,(function(e,n){ht(t,n.row,n.col,!0,n.sheetArea)})),t.bind(o.Events.TopRowChanged+"."+E,(function(e,n){ht(t,n.row,n.col,!0,n.sheetArea)}))},dispose:function(t){var e=this;e.unbind(o.Events.EnterCell+"."+E),e.unbind(o.Events.LeaveCell+"."+E),e.unbind(o.Events.TopRowChanged+"."+E)},processMouseDown:function(t){var e=t.hitInfo.cellTypeHitInfo;e&&e.cellButtonHitInfo&&at(e)&&(t.r=!0)}})},"./dist/plugins/celltype/celltypes.entry.js":function(t,e,n){"use strict";var o,r,i,a,s;function l(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),r=(o=n("Core")).CellTypes.Base,i=o.CellTypes.Context,a=o.CellTypes.EditorType,s=o.CellTypes._o,e.Base=r,e.Context=i,e.EditorType=a,e._o=s,e.vHb=o.CellTypes.vHb,e.wHb=o.CellTypes.wHb,Object.defineProperty(e,"Corner",{set:function(t){t!==e.vHb.Corner&&(e.vHb.Corner=t)},get:function(){return e.vHb.Corner}}),Object.defineProperty(e,"ColumnHeader",{set:function(t){t!==e.vHb.ColumnHeader&&(e.vHb.ColumnHeader=t)},get:function(){return e.vHb.ColumnHeader}}),Object.defineProperty(e,"RowHeader",{set:function(t){t!==e.vHb.RowHeader&&(e.vHb.RowHeader=t)},get:function(){return e.vHb.RowHeader}}),Object.defineProperty(e,"Text",{set:function(t){t!==e.wHb.Text&&(e.wHb.Text=t)},get:function(){return e.wHb.Text}}),l(n("./dist/plugins/celltype/checkboxcelltype.js")),l(n("./dist/plugins/celltype/buttoncelltype.js")),l(n("./dist/plugins/celltype/hyperlinkcelltype.js")),l(n("./dist/plugins/celltype/comboboxcelltype.js")),n("./dist/plugins/celltype/cellbuttons.js"),l(n("./dist/plugins/celltype/editor/colorpicker.js")),l(n("./dist/plugins/celltype/editor/timepicker.js")),l(n("./dist/plugins/celltype/editor/calendar.js")),l(n("./dist/plugins/celltype/editor/calculator.js")),l(n("./dist/plugins/celltype/editor/monthPicker.js")),l(n("./dist/plugins/celltype/editor/listControl.js")),l(n("./dist/plugins/celltype/dropdown-action.js")),l(n("./dist/plugins/celltype/radiochecklistcelltype.js")),l(n("./dist/plugins/celltype/celltypes.ns.js")),l(n("./dist/plugins/celltype/rangecelltype.js"))},"./dist/plugins/celltype/celltypes.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/celltype/celltypes.res.en.js");e.SR={en:o}},"./dist/plugins/celltype/celltypes.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OK="OK",e.Cancel="Cancel",e.Calendar_ShortWeeks_1="MON",e.Calendar_ShortWeeks_2="TUE",e.Calendar_ShortWeeks_3="WED",e.Calendar_ShortWeeks_4="THU",e.Calendar_ShortWeeks_5="FRI",e.Calendar_ShortWeeks_6="SAT",e.Calendar_ShortWeeks_7="SUN",e.Calendar_Weeks_1="Monday",e.Calendar_Weeks_2="Tuesday",e.Calendar_Weeks_3="Wednesday",e.Calendar_Weeks_4="Thursday",e.Calendar_Weeks_5="Friday",e.Calendar_Weeks_6="Saturday",e.Calendar_Weeks_7="Sunday",e.Calendar_ShortMonths_1="JAN",e.Calendar_ShortMonths_2="FEB",e.Calendar_ShortMonths_3="MAR",e.Calendar_ShortMonths_4="APR",e.Calendar_ShortMonths_5="MAY",e.Calendar_ShortMonths_6="JUN",e.Calendar_ShortMonths_7="JUL",e.Calendar_ShortMonths_8="AUG",e.Calendar_ShortMonths_9="SEP",e.Calendar_ShortMonths_10="OCT",e.Calendar_ShortMonths_11="NOV",e.Calendar_ShortMonths_12="DEC",e.Calendar_Months_1="JANUARY",e.Calendar_Months_2="FEBRUARY",e.Calendar_Months_3="MARCH",e.Calendar_Months_4="APRIL",e.Calendar_Months_5="MAY",e.Calendar_Months_6="JUNE",e.Calendar_Months_7="JULY",e.Calendar_Months_8="AUGUST",e.Calendar_Months_9="SEPTEMBER",e.Calendar_Months_10="OCTOBER",e.Calendar_Months_11="NOVEMBER",e.Calendar_Months_12="DECEMBER",e.Calendar_Time_AM="AM",e.Calendar_Time_PM="PM",e.Calendar_EraName_1="M",e.Calendar_EraName_2="T",e.Calendar_EraName_3="S",e.Calendar_EraName_4="H",e.Calendar_FirstYear="1",e.Calendar_Today="Today",e.Calendar_LastMonth="Go to previous month",e.Calendar_NextMonth="Go to next month",e.Calendar_LastYear="Go to previous year",e.Calendar_NextYear="Go to next year",e.Calendar_LastTenYear="Go to previous ten years",e.Calendar_NextTenYear="Go to next ten years",e.Quarter_Format_1="Q1",e.Quarter_Format_2="Q2",e.Quarter_Format_3="Q3",e.Quarter_Format_4="Q4",e.ThemeColor="Theme Colors",e.StandardColor="Standard Colors",e.Calculator_DivideByZeroInfo="Cannot divide by zero.",e.Calculator_InvalidInputInfo="Invalid Input.",e.Calculator_SqrtParameterException="Invalid input for function.",e.Calculator_OverFlowInfo="Arithmetic operation resulted in an overflow.",e.MultiColumn_InvalidDataSource="Invalid data source. The formula should return an array."},"./dist/plugins/celltype/checkboxcelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function D(t,e,n,o){var r,i=t.ITa;i&&(i.do("setValueForKey",e,n,I,g,o),(r=i.getValueForKey(e,n,R,o))&&(clearTimeout(r),i.do("setValueForKey",e,n,R,g,o)))}function O(t){return 5*t}function j(t,e,n,o,r){var i=O(r),a=e.hAlign,s=n.x-1,l=n.width+1,u=0,c=0;return 0===t||1===t?(c=s+i,1===a?c=s+l/2-6:2===a&&(c=s+l-i-k)):2===t?(u=k+o,c=s+i+o,1===a?c=s+l/2-u/2+o:2===a&&(c=s+l-i-u+o)):(u=k+o,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)),c-s}function F(t,e,n,o,r){var i=O(r),a=e.vAlign,s=n.y-1,l=n.height+1,u=0,c=0;return 0===t?(u=k+o,c=s+i+o,1===a?c=s+l/2-u/2+o:2===a&&(c=s+l-i-u+o)):1===t?(u=k+o,c=s+i,1===a?c=s+l/2-u/2:2===a&&(c=s+l-i-u)):(c=s+i,1===a?c=s+l/2-6:2===a&&(c=s+l-i-k)),c-s}function P(t,e,n,o,r){var i=e.getValue(n,o,r),a=t.rK(i),s={cmd:"editCell",sheetName:e.name(),row:n,col:o,newValue:a,autoFormat:!0};e.wu().execute(s),t.tw(e,n,o,r)}function _(t,e,n,o,r){var i=r&&r.sheet,a=t.getEditorValue(e,r);t.setEditorValue(e,a,r),t.updateEditor(e,n,o,r),t.tw(i,i.Jl,i.Kl,r.sheetArea)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=r.Ul.Nl,a=o.Common.j.Fa,s=r.Ul.fp,l=r.Ul.nl,u=r.CellTypes.Context,c=r.CellTypes.Base,f=r.GC$,h=f.each,p=r.Ul.hZa,d=null,g=void 0,m=Math.max,y=parseInt,v="position",C="absolute",b="font",w="left",T="right",x="alphabetic",S=".gcEditingInput",A="green",I="_isFirstMouseUp",R="_mouseupToken",function(t){t[t.top=0]="top",t[t.bottom=1]="bottom",t[t.left=2]="left",t[t.right=3]="right"}(e.CheckBoxTextAlign||(e.CheckBoxTextAlign={})),k=12,M={caption:"",textTrue:"",textIndeterminate:"",textFalse:"",textAlign:3,isThreeState:!1},N=function(t){function e(){var e,n=t.call(this)||this;return n.typeName="5",e=n,h(M,(function(t,n){e["_"+t]=n})),n}return E(e,t),e.prototype.paintValue=function(t,e,n,o,i,l,u,c){var f,h,p,d,g,m,v,C,b,S,I,R,k,M,N,E,D,O,P;t&&(t.save(),t.rect(n,o,i,l),t.clip(),t.beginPath(),f=u.hAlign,h=u.font,p=u.foreColor,g=(d=this)._textAlign,m=d.getText(e,c),v=0,C=0,(b=c.sheet)&&(v=b.dp(m,h),C=s(h),m&&(C*=m.split(/\r\n|\r|\n/).length)),S=b.zoom(),++n,++o,--i,--l,6,I=new r.Rect(n,o,i,l),R=y(""+(n+j(g,u,I,v,S))),k=y(""+(o+F(g,u,I,C,S))),M=w,N=R+1,1===f?(M="center",N+=6):2===f&&(M=T,N+=12),h&&t.font!==h&&r.Ul.lZa(t,h),p&&(t.fillStyle=p),E=u.textDecoration,P=C/2-(D=parseInt(c.fontInfo.fontSize,10))/2+(O=D>8?Math.floor((D-8)/5+2):1)-1,t.textBaseline!==x&&(t.textBaseline=x),2===g?(t.textAlign=T,t.fillText(m,R+1-2,k+6+C/2-P),E&&d.ip(t,E,R+1-2,k+6+C/2-P,v,D,O)):0===g&&(t.textAlign=M,t.fillText(m,N,k-2-P),E&&d.ip(t,E,N,k-2-P,v,C)),t.save(),t.strokeStyle="black",t.strokeRect(R+.5,k+.5,12.05,12.05),t.fillStyle="white",t.fillRect(R+1,k+1,11,11),d._isThreeState&&a(e)?(t.beginPath(),t.fillStyle=A,t.rect(R+3,k+3,7,7),t.fill()):1==!!e&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(R+3,k+6),t.lineTo(R+6,k+12-3.5),t.lineTo(R+12-1.5,k+3),t.stroke()),t.restore(),p&&(t.fillStyle=p),3===g?(t.textAlign=w,t.fillText(m,R+1+12+2,k+6+C/2-P),E&&d.ip(t,E,R+1+12+2,k+6+C/2-P,v,D,O)):1===g&&(t.textAlign=M,t.fillText(m,N,k+12+2+C-P),E&&d.ip(t,E,N,k+12+2+C-P,v,D,O)),t.restore())},e.prototype.getText=function(t,e){return this.sK(t)},e.prototype.focus=function(t,e){t&&t.parentNode.focus()},e.prototype.createEditorElement=function(t,e){var n,o,a,s,l=t&&t.sheet&&t.sheet.parent&&t.sheet.parent.qo,u=r.Ul.vl(l)+1e3;return f(e).css("z-index",u).attr("tabindex",1).attr("gcUIElement","gcEditingInput"),(n=f(e.firstChild)).css("overflow","hidden"),(o=f(i("input"))).attr("type","checkbox"),o.attr("class","gc-checkbox-cell-type-input"),n.append(o),(a=f(i("span"))).css(v,C).css(b,p("normal 11pt calibri")).css("cursor","default").css("white-space","nowrap"),n.append(a),(s=f(i("div"))).css(v,C).css("background-color",A).css("width",7).css("height",7),n.append(s),d},e.prototype.rK=function(t){return this._isThreeState?!a(t)&&(1!=!!t||d):!t},e.prototype.setEditorValue=function(t,e,n){var o,r,i,s,l,u,c,h;t&&(r=(o=t.parentNode.children)[0],i=o[1],s=o[2],r&&i&&s&&(l=this,c=void 0,h=void 0,(u=n&&n.sheet)&&u.HF||(h=l.rK(e)),l._isThreeState?a(h)?(c=!1,f(s).show()):(c=!!h,f(s).hide()):c=!!h,r.checked=c,f(i).text(l.sK(h))))},e.prototype.getEditorValue=function(t,e){if(t){var n=t.parentNode.children,o=n[0],r=n[1],i=n[2];if(o&&r&&i&&(!this._isThreeState||!f(i).isVisible()))return o.checked}return d},e.prototype.tw=function(t,e,n,o){var r=t.parent;r&&r.tw(t,e,n,o)},e.prototype.activateEditor=function(t,e,n,o){var r,i,a=o&&o.sheet;t&&a&&(r=f(t.parentNode.parentNode),i=this,r.bind("mousedown"+S,(function(t){l(t)})),r.bind("mouseup"+S,(function(){_(i,t,e,n,o)})),r.bind("keydown"+S,(function(t){var e=t.keyCode;if(!t.ctrlKey&&!t.shiftKey&&!t.altKey){if(32===e)return i.tK=!0,l(t),!1;8===e&&l(t)}})),r.bind("keyup"+S,(function(r){!i.tK||32!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey||(i.tK=!1,_(i,t,e,n,o))})),f(t).bind("click",(function(t){l(t)})))},e.prototype.updateEditor=function(t,e,n,o){var r,i,a,l,u,c,h,d,g,m,y,v,C,T,x,S,A,I,R,M,N,E,D,O,P,_,L,B,G=o&&o.sheet;t&&G&&(r=G.yl,l=(a=(i=t.parentNode).children)[0],u=a[1],c=a[2],l&&u&&c&&(f(i).width(n.width).height(n.height),d=(h=f(u)).text(),g=e.foreColor,m=e.font,y=e.hAlign,v=e.textDecoration,g&&h.css("color",g),C=void 0,C=m||r.Bl(),(T=G.zoom())>1&&(C=r.Cl(C)),h.css(b,p(C)),x=G.rt(d,C),S=s(C),d&&(S*=d.split(/\r\n|\r|\n/).length),R=j(I=(A=this)._textAlign,e,n,x,T),M=F(I,e,n,S,T),f(l).css("margin-left",R).css("margin-top",M),N=l.offsetLeft,E=l.offsetTop,D=l.offsetWidth,O=l.offsetHeight,P=0,_=0,0===I?(P=N,1===y?P=N+6-x/2:2===y&&(P=N+k-x),_=E-S):1===I?(P=N,1===y?P=N+6-x/2:2===y&&(P=N+k-x),_=E+O):2===I?(P=N-x-2,_=E+6-S/2):(P=N+D+2,_=E+6-S/2),h.css(w,P).css("top",_),A._isThreeState?(L=N+(D-c.offsetWidth)/2,B=E+(O-c.offsetHeight)/2,f(c).css(w,L).css("top",B).toggle().toggle()):f(c).hide(),v&&A.lp(h,v)))},e.prototype.sK=function(t){var e=this,n=e._caption;return e._isThreeState&&a(t)?e._textIndeterminate||n:1==!!t?e._textTrue||n:e._textFalse||n},e.prototype.getHitInfo=function(t,e,n,o,r){if(r){var i=r.sheetArea;if(a(i)||3===i)return{x:t,y:e,row:r.row,col:r.col,cellRect:o,sheetArea:3,isReservedLocation:!0,sheet:r.sheet,cellStyle:n}}return d},e.prototype.processMouseDown=function(t){return!!t&&void(t.isReservedLocation&&(this.uK=!0))},e.prototype.processMouseUp=function(t){var e,n,o,r,i=this,a=t&&t.sheet;if(a&&i.uK&&t.isReservedLocation){if(i.uK=!1,e=t.row,n=t.col,o=t.sheetArea,!a.ITa.getValueForKey(e,n,I,o))return P(i,a,e,n,o),a.ITa.do("setValueForKey",e,n,I,!0,o),r=setTimeout((function(){D(a,e,n,o)}),250),a.ITa.do("setValueForKey",e,n,R,r,o),!0;D(a,e,n,o)}return!1},e.prototype.processMouseLeave=function(t){return!!t&&void(this.uK=!1)},e.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},e.prototype.processKeyUp=function(t,e){return P(this,e.sheet,e.row,e.col,e.sheetArea),!0},e.prototype.getAutoFitWidth=function(t,e,n,o,r){var i=this._textAlign,a=u.cp(t,this.sK(t),n,o,r);return 0===i||1===i?a=m(a,k):a+=k,a+5+2},e.prototype.getAutoFitHeight=function(t,e,n,o,r){var i=this._textAlign,a=u.ep(t,this.sK(t),n,o,r);return 0===i||1===i?a+=k:a=m(a,k),a+5},e.prototype.JH=function(t){this.isReservedKey(t)&&l(t)},e.prototype.isImeAware=function(t){return!1},e.prototype.gQa=function(){},e.prototype.toJSON=function(){var t,e=this,n={typeName:e.typeName};return h(M,(function(o,r){(t=e["_"+o])!==r&&(n[o]=t)})),n},e.prototype.fromJSON=function(t){var e=this;h(M,(function(n){var o=t[n];a(o)||(e["_"+n]=o)}))},e}(c),e.CheckBox=N,h(M,(function(t){N.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}})),r.CellTypes._o[5]=N},"./dist/plugins/celltype/comboboxcelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function nt(t,e){t.appendChild(e)}function ot(t,e){t.removeChild(e)}function rt(t){return t&&t.parentNode.parentNode.comboBox}function it(t){c(t).css("margin",0).css("overflow","hidden").css("resize",N).css(x,S).css("padding","1px 0px 0px 1px").css(O,N).css(P,G).css("white-space","nowrap").css(j,B).css(Y,N).attr(k,"gcComboBoxEditor").attr(M,-1)}function at(t,e){return t.hasOwnProperty(e)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=r.CellTypes.Base,a=r.Ul.Nl,s=o.Common.j.Fa,l=r.Ul,u=l.nl,c=r.GC$,f=c.each,h=l.hZa,p=l.Fxb,d=document,g=null,m=void 0,y=Math.max,v=parseInt,C="click",b="keydown",w="mouseover",T="mouseout",x="position",S="absolute",A="font",I="left",R="top",k="gcUIElement",M="tabindex",N="none",E="width",D="height",O="outline",j="box-sizing",F="color",P="background-color",_="z-index",L="display",B="content-box",G="white",H="black",V="title",z="div",W="span",U="text",q="value",Y="border",X=l.K_a,function(t){t[t.text=0]="text",t[t.index=1]="index",t[t.value=2]="value"}(e.EditorValueType||(e.EditorValueType={})),Z=17,Q="EndEdit.gcEditingInput",J="#1E90FF",$={editorValueType:0,items:g,itemHeight:22,editable:!1,maxDropDownItems:20},K=function(){function t(t,e,n,o,i,l){var u,f,h,p,d,g,v,A,F=this;F.KK=t,u=t.firstChild,c(t).bind(b,(function(t){F.LK(t)})).css(_,l||0).css(I,e).css(R,n).css(E,o).css(D,i).css("overflow","visible").attr(k,"gcComboBox"),f=y(0,o-Z),F._editable=!1,F.MK=h=a(z),F.NK=p=a("textarea"),F.PK=h,nt(u,h),it(h),it(p),c(p).bind("keyup",(function(){var t,e=F.PK.value;F._text=e,t=F.QK(e),F.editorValue(t),F.RK(e),F.SK()})).bind(w,(function(){F.TK()})).bind(T,(function(){F.SK()})),c(h).bind(C,(function(){F.IK?F.Wq(Q,{isMouse:!0}):F.UK()})).bind(w,(function(){F.TK()})).bind(T,(function(){F.SK()})),F.VK(0,0,f,i),nt(u,d=F.WK=a(z)),c(d).css(Y,N).css(x,S).css(P,G).css(j,B).attr(k,"gcDropDownButton").bind(C,(function(){var t;!s(F.JK)&&(t=F.JK,F.JK=m,(new Date).valueOf()-t<100)||(F.IK?F.Wq(Q,{isMouse:!0}):F.UK())})),g=a("canvas"),F.Xs=g,F.XK(f,0,o-f,i),nt(d,g),nt(u,v=F.YK=a(z)),F.ZK=!1,c(v).css(x,S).css(Y,"1px solid").css(P,G).css(_,l||0).css(O,N).css(L,N).css("cursor","default").css(j,B).attr(k,"gcDropDownWindow").attr(M,-1).css(E,o-0).css(D,i),F.$K(0,i-0),F._K=0,nt(v,A=F.aL=a(z)),F.bL=new r.IB(v,A),F._itemHeight=22,F.cL=20,F.dL=-1,F._editorValueType=0,F._items=[]}return t.prototype.getComboBox=function(){return this.KK},t.prototype.dispose=function(){var t=this;c(t.KK).unbind(b),c(t.NK).unbind("keyup").unbind(w).unbind(T),c(t.MK).unbind(C).unbind(w).unbind(T),c(t.WK).unbind(C),c(t.aL).find("div").forEach((function(t){c(t).unbind(w).unbind(T).unbind(C)})),t.bL.dispose()},t.prototype.updateLocationAndSize=function(t,e,n,o){var r=this,i=y(0,n-Z);r.VK(0,0,i,o),r.XK(i,0,n-i,o),r.$K(0,o-0),r.listWidth(n-0),r.eL()},t.prototype.updateStyle=function(t,e,n){var o=this;n=h(n),t=t||m,c(o.PK).css(P,t).css(F,e).css(A,n),c(o.WK).css(P,t).css(F,e).css(A,n),c(o.YK).css(P,t).css(F,e).css(A,n),c(o.KK).css(P,"transparent")},t.prototype.updateImeMode=function(t){c(this.PK).css("ime-mode",t)},t.prototype.editorValueType=function(t){return 0===arguments.length?this._editorValueType:(this._editorValueType=t,this)},t.prototype.editorValue=function(t){var e,n=this;return 0===arguments.length?n.fL:(t!==n.fL&&(n.fL=t,e=n.gL(t),n.text(e),n.RK(e,!0)),n)},t.prototype.gL=function(t){var e,n,o,r,i=this,a=i._items,l=a.length,u=i._editorValueType;if(i.HK=!0,1===u)(e=(n=a[t])&&at(n,U)?n.text:n)===m&&(e=t,i.HK=!1);else if(0===u){for(e=t,r=0;r<l&&!((n=a[r])&&at(n,U)&&n.text===t||n===t);r++);r>=l&&(i.HK=!1)}else if(2===u){for(o=0;o<l;o++)if((n=a[o])&&at(n,q)&&n.value===t){e=n.text;break}o>=l&&(e=t,i.HK=!1)}return s(t)&&(e=""),e},t.prototype.QK=function(t){var e,n,o,r=this._items,i=r.length,a=this._editorValueType,s=t;if(1===a)for(n=0;n<i;n++)((e=r[n])&&at(e,U)&&e.text===t||e===t)&&(s=n);else if(2===a)for(o=0;o<i;o++)(e=r[o])&&at(e,U)&&e.text===t?s=e.value:e===t&&(s=m);return s},t.prototype.RK=function(t,e){var n,o,r,i,a;if(t){for(r=(o=this._items).length,n=0;n<r&&(void 0,a=at(i=o[n],U)?i.text:i,(e?a:(""+a).substr(0,t.length))!==t);n++);n>=r&&(n=-1)}else n=-1;this.hL(n)},t.prototype.SK=function(){c(this.PK).removeAttr(V)},t.prototype.TK=function(){var t=this,e=t.Xn(t._text),n=c(t.PK);e>n.width()+1?n.attr(V,t._text):n.removeAttr(V)},t.prototype.VK=function(t,e,n,o){n-=0,o-=0,c(this.PK).css(I,t).css(R,e).css(E,n-1).css(D,o-1)},t.prototype.editable=function(t){var e,n,o,r,i,a=this;return 0===arguments.length?a._editable:a._editable!==t?(a._editable=t,e=a.KK.firstChild,n=a.PK,o=c(n),r={left:v(o.css(I)),top:v(o.css(R)),width:v(o.css(E)),height:v(o.css(D))},i={backColor:o.css(P),foreColor:o.css(F),font:n.style.font},ot(e,n),a.PK=t?a.NK:a.MK,nt(e,a.PK),c(a.PK).css(P,i.backColor).css(F,i.foreColor).css(A,i.font),a.VK(r.left,r.top,r.width,r.height),a):void 0},t.prototype.text=function(t){var e=this,n=e.PK;return 0===arguments.length?e._text:void(t!==e._text&&(e._text=t,e._editable?n.value=t:n.textContent=t))},t.prototype.focus=function(){var t=this.PK;t.focus(),this._editable&&(t.selectionStart=t.value.length)},t.prototype.selectAll=function(){this._editable&&this.PK.select()},t.prototype.XK=function(t,e,n,o){var r,i,a,s;n-=0,o-=0,r=this.Xs,c(this.WK).css(I,t).css(R,e).css(E,n).css(D,o),c(r).attr(E,n).attr(D,o),i=r.width,a=r.height,(s=r.getContext("2d")).beginPath(),s.lineWidth=2,s.fillStyle=H,s.moveTo(i-Z+4,(a-2)/2-2.5),s.lineTo(i-Z+7,(a-2)/2+3.5),s.lineTo(i-Z+10,(a-2)/2-2.5),s.fill()},t.prototype.showDropDownList=function(){var t=this,e=t.bL;t.ZK=!0,c(t.YK).bind(b,(function(e){t.LK(e)})).show(),t.iL=!1,t.jL(),t.eL(),t.iL&&(e.lB(c(t.aL.children).height()),e.ew(!1)),t.kL(J),t.lL(t.dL),t.focus()},t.prototype.closeDropDownList=function(){var t=this;t.ZK=!1,c(t.YK).unbind(b).hide(),t.kL(""),t.focus()},t.prototype.UK=function(){this.ZK?this.closeDropDownList():this.showDropDownList()},t.prototype.listWidth=function(t){var e=this,n=c(e.YK);return 0===arguments.length?n.width():void(t>0&&(n.width(t),e.bL.ew(!1)))},t.prototype.listHeight=function(t){var e=this,n=c(e.YK);return 0===arguments.length?n.height():void(t>0&&(n.height(t),e.bL.ew(!1)))},t.prototype.$K=function(t,e){c(this.YK).css(I,t).css(R,e)},t.prototype.items=function(t){var e,n,o,r,i,a=this;if(0===arguments.length)return a._items;if(t){for(a._items=t,e=a.aL,n=void 0,c(e).find("div").forEach((function(t){c(t).unbind(w).unbind(T).unbind(C)})),n=e.firstChild;n;)ot(e,n),n=e.firstChild;for(a._K=0,o=0,r=t.length;o<r;o++)i=t[o],a.mL(at(i,U)?i.text:i);return a}},t.prototype.mL=function(t){var e=this,n=a(z),o=a(W);o.textContent=""+t,o.style.paddingLeft="1px",nt(n,o),nt(e.aL,n),e._K++,c(n).bind(C,(function(){var t=c(n).index();e.selectedIndex(t),e.closeDropDownList(),e.Wq(Q,{isMouse:!0})})).bind(w,(function(){var t=c(n);n.oldBackColor=t.css(P),t.css(P,"lightgrey")})).bind(T,(function(){c(n).css(P,n.oldBackColor||"")}))},t.prototype.nL=function(){var t=this;t.Po=a(W),c(t.Po).css(L,N).css(A,t.YK.style.font).appendTo(d.body)},t.prototype.oL=function(){ot(d.body,this.Po)},t.prototype.pL=function(t){return this.Po.textContent=t,c(this.Po).width()+2+1},t.prototype.kL=function(t){var e=this,n=e.dL;0<=n&&n<e._K&&c(e.aL.children[n]).css(P,t)},t.prototype.LK=function(t){var e,n,o,r=this,i=t.keyCode,a=t.which;t.ctrlKey||t.shiftKey||t.altKey||t.metaKey||(37===a||39===a)&&r.editable()||(e=r._K,n=r.dL,o=0,38===a||40===a?(n>=0&&n<e&&(o=n+(38===a?-1:1)),o>=0&&o<e&&r.selectedIndex(o),r.ZK&&r.lL(o),u(t)):13===a||37===a||39===a||9===a?(r.selectedIndex(r.dL),r.closeDropDownList(),r.Wq(Q,{keyCode:i}),u(t)):27===a&&(r.closeDropDownList(),r.Wq(Q,{keyCode:i}),u(t)))},t.prototype.getSelectedValue=function(t,e,n){var o,r=e[t];return s(r)||(1===n?o=t:0===n?o=at(r,U)?r.text:r:2===n&&at(r,q)&&(o=r.value)),o},t.prototype.hL=function(t){var e=this;e.kL(""),e.dL=t,e.kL(J),e.lL(t)},t.prototype.selectedIndex=function(t){var e,n=this;return 0===arguments.length?n.dL:void(0<=t&&t<n._K&&(n.hL(t),e=n.getSelectedValue(n.dL,n._items,n._editorValueType),s(e)||n.editorValue(e)))},t.prototype.itemCountPerPage=function(t){return 0===arguments.length?this.cL:void(t>0&&(this.cL=t))},t.prototype.Xn=function(t){this.nL();var e=this.pL(t);return this.oL(),e},t.prototype.itemHeight=function(t){return 0===arguments.length?this._itemHeight:void(t>0&&(this._itemHeight=t))},t.prototype.jL=function(){var t,e,n,o,r,i=this;i.nL(),t=i._items[0],e=y(i._itemHeight,c(i.Po).text(s(t)?"":t).height()),c(i.aL.children).css(D,e),(o=i._K)<=(r=i.cL)?n=o*e:(n=r*e,i.iL=!0),i.listHeight(n),i.oL()},t.prototype.eL=function(){var t,e,n,o,r,i,a=this;if(a.nL(),t=0,n=a._items)for(o=0,r=n.length;o<r;o++)i=n[o],t<(e=a.pL(at(i,U)?i.text:i))&&(t=e);a.oL(),a.listWidth()<t+18&&a.listWidth(t+18)},t.prototype.lL=function(t){if(t>=0&&t<this._K){var e=this.aL.children[t];this.bL.BB(e)}},t.prototype.bind=function(t,e,n){c(this.KK).bind(t,e,n)},t.prototype.unbind=function(t,e){c(this.KK).unbind(t,e)},t.prototype.Wq=function(t,e){c(this.KK).trigger(t,e)},t}(),tt=function(t){function e(){var e,n=t.call(this)||this;return n.typeName="7",n.DF=!1,n.GK=!1,e=n,f($,(function(t,n){"items"===t&&(n=[]),e["_"+t]=n})),n}return et(e,t),e.prototype.isReservedKey=function(t,e){return this.GK},e.prototype.paintValue=function(t,e,n,o,i,a,s,l){var u,c,f,h,d,g,m,v,C=l.sheet,b=C.zoom?C.zoom():1,w=Z,T=y(0,i-w-1);3===s.hAlign&&(s.hAlign=0),s.wordWrap&&(s.wordWrap=!1),T>0&&a>0&&(u={},c=void 0,l.quotePrefix=s.quotePrefix,f=s.formatter&&"General"!==s.formatter,h=s._autoFormatter&&s._autoFormatter.formatCached&&"General"!==s._autoFormatter.formatCached,void 0,g=this.getItemValue(e),d=f?s.formatter:h?s._autoFormatter:r.CellTypes.Context.Ixb(t,g,T+1,s,b),(c=this.format(X(e),d,u,l))&&(m=s.isVerticalText,p(g)&&!m&&!0!==s.shrinkToFit&&(c!==(v=r.CellTypes.Context.Lxb(t,c,T+1,s,b))&&(delete u.content,s.textIndent=0),c=v),this.paintText(t,this.getText(e,l),n,o,T,a,s,l,c,u))),t.save(),(w>i||w>a)&&(t.rect(n,o,i,a),t.clip()),t.beginPath(),t.lineWidth=2,t.fillStyle=H,t.moveTo(n+i-w+3,o+(a-2)/2-2.5),t.lineTo(n+i-w+6,o+(a-2)/2+3.5),t.lineTo(n+i-w+9,o+(a-2)/2-2.5),t.fill(),t.restore()},e.prototype.getText=function(t,e){return t},e.prototype.createEditorElement=function(t,e){var n,o=t&&t.sheet,r=o&&o.parent,i=r&&r.qo,a=l.vl(i)+1e3,s=o.defaults,u=this,c=new K(e,0,0,s.colWidth,s.rowHeight,a);return c.editorValueType(u._editorValueType),c.items(u._items),c.itemHeight(u._itemHeight),c.itemCountPerPage(u._maxDropDownItems),c.editable(u._editable),n=c.getComboBox(),Object.defineProperty(n,"comboBox",{get:function(){return this.ixb},set:function(t){this.ixb!==t&&(this.ixb&&this.ixb.dispose(),this.ixb=t)}}),n.comboBox=c,g},e.prototype.getEditorValue=function(t,e){var n=rt(t);return n&&(this.DF=!n.HK),n&&n.editorValue()},e.prototype.setEditorValue=function(t,e,n){var o=rt(t);o&&o.editorValue(e)},e.prototype.focus=function(t,e){var n=rt(t);n&&n.focus()},e.prototype.selectAll=function(t,e){var n=rt(t);n&&n.selectAll()},e.prototype.activateEditor=function(t,e,n,o){var r=this,i=o.sheet,a=rt(t);a&&(a.editorValueType(r._editorValueType),a.items(r._items),a.itemHeight(r._itemHeight),a.itemCountPerPage(r._maxDropDownItems),a.editable(r._editable),a.bind(Q,(function(t,e){var n,o,r,s,l,u=e.keyCode;if(u){if(o=(n=i.wu()).getShortcutKey(u,!1,!1,!1,!1),r=n.getCommands(o))for(s=0,l=r.length;s<l;s++)if("navigationLeft"!==r[s].Cj&&"navigationRight"!==r[s].Cj||(i.Px=1),r[s].execute(i.parent,{sheetName:i.name()}))return!0}else e.isMouse&&a.IK&&i.endEdit()}))),r.GK=!0},e.prototype.deactivateEditor=function(t,e){if(t){var n=rt(t);n&&(n.unbind(Q),n.closeDropDownList(),n.IK=!1)}this.GK=!1},e.prototype.updateImeMode=function(t,e){if(this.isImeAware()){var n=rt(t);n&&n.updateImeMode(e)}},e.prototype.updateEditor=function(t,e,n,o){var r,i,a=t&&o&&o.sheet;a&&(r=rt(t),e&&r&&(i=a.yl,r.updateStyle(e.backColor,e.foreColor,i.Cl(e.font||i.Bl()))),n&&r&&r.updateLocationAndSize(n.x,n.y,n.width,n.height))},e.prototype.format=function(t,e,n,o){var r;return s(t)?"":(this,r=this.getItemValue(t),i.prototype.format.call(this,r||t,e,n))},e.prototype.getItemValue=function(t){var e,n,o,r,i=this._editorValueType,a=this._items;if(a)if(n=a.length,1===i){if(0<=(o=v(t))&&o<n&&((e=a[o])!==m&&e!==g))return at(e,U)?e.text:e}else if(2===i)for(r=0;r<n;r++)if((e=a[r])&&at(e,q)&&e.value===t)return e.text},e.prototype.parse=function(t,e,n){var o,r,a,s=this,l=s._editorValueType,u=s._items,c=i.prototype.parse.call(s,t,e);if(u){if(a=u.length,0===l)return c;if(1===l){for(r=0;r<a;r++)if((o=u[r])&&at(o,U)&&o.text===c||o===c)return r}else if(2===l)for(r=0;r<a;r++)if((o=u[r])&&at(o,U)&&o.text===c)return o.value}return c},e.prototype.getHitInfo=function(t,e,n,o,r){var i,a,l,u,c,f;return r?(i=r.sheetArea,a=r.sheet,(s(i)||3===i)&&o&&(l=function(t){var e,n,o,r,i=["0","0","0","0"];return"string"==typeof t&&(e=t.split(" ",4),n=e.length,o=void 0,r=void 0,1===n?(o=e[0],i=[o,o,o,o]):2===n?(o=e[0],r=e[1],i=[o,r,o,r]):3===n?(r=e[1],i=[e[0],r,e[2],r]):4===n&&(i=[e[0],e[1],e[2],e[3]])),i}(n.cellPadding),u=parseInt(l[1],10)||0,c=o.x+o.width-u,f={x:t,y:e,row:r.row,col:r.col,cellStyle:n,cellRect:o,sheetArea:i,sheet:a},c-Z<=t&&t<c)?(f.isReservedLocation=!0,f):g):g},e.prototype.processMouseDown=function(t){var e,n=t.sheet,o=t.sheetArea;(s(o)||3===o)&&t.isReservedLocation&&n&&(t.row===n.Jl&&t.col===n.Kl||n.setActiveCell(t.row,t.col),n.startEdit(),(e=rt(n.BF))&&(l.Ml.mozilla&&(e.JK=(new Date).valueOf()),e.showDropDownList(),e.IK=!0))},e.prototype.getAutoFitWidth=function(t,e,n,o,i){return n&&n.wordWrap&&(n.wordWrap=!1),r.CellTypes.Context.cp(t,e,n,o,i)+Z},e.prototype.getAutoFitHeight=function(t,e,n,o,i){return n&&n.wordWrap&&(n.wordWrap=!1),r.CellTypes.Context.ep(t,e,n,o,i)},e.prototype.isImeAware=function(t){return!0},e.prototype.gQa=function(){},e.prototype.toJSON=function(){var t,e=this,n={typeName:e.typeName};return f($,(function(o,r){t=e["_"+o],("items"===o?t&&t.length>0:t!==r)&&(n[o]=t)})),n},e.prototype.fromJSON=function(t){var e=this;f($,(function(n){var o=t[n];s(o)||(e["_"+n]=o)}))},e}(i),e.ComboBox=tt,f($,(function(t){tt.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}})),r.CellTypes._o[7]=tt},"./dist/plugins/celltype/dropdown-action.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O;function j(t,e){return E.createElement(t,e)}function F(t){return{canUndo:!1,execute:function(e,n,c){var h,p,y,v,b,w,E,D,O,F=e.getSheetFromName(n.sheetName);if(!F||e.getActiveSheet().name()!==n.sheetName)return!1;if(h=n.row,p=n.col,(m.isNullOrUndefined(h)||m.isNullOrUndefined(p))&&(h=F.getActiveRowIndex(),p=F.getActiveColumnIndex()),y=n.sheetArea,m.isNullOrUndefined(y)&&(y=3),h<0||h>=F.getRowCount(y)||p<0||p>=F.getColumnCount(y))return!1;switch(F.showCell(h,p,o.VerticalPosition.nearest,o.HorizontalPosition.nearest),v=1===y?-1:void 0,b=2===y?-1:void 0,w=F.getCellRect(h,p,v,b),E=j("div"),D=function(t,e,n,o){var r,i;return t.isEditing()?(r=t.getCellType(e,n),i={sheet:t,row:e,col:n,sheetArea:o},r.getEditorValue(t.BF,i)):t.getValue(e,n,o)}(F,h,p,y),(m.isNullOrUndefined(n.row)||m.isNullOrUndefined(n.col))&&(n.row=F.getActiveRowIndex(),n.col=F.getActiveColumnIndex()),t){case T:O=new u.ColorPicker(E);break;case x:D=P(D,"date"),O=new f.Calendar(E);break;case S:D=P(D,"date"),O=new s.TimePicker(E);break;case A:D=""+(D=P(D,"number")),O=new r.Calculator(E);break;case I:D=P(D,"date"),O=new l.MonthPicker(E);break;case R:(O=new i.List(E)).formula=F.getFormula(n.row,n.col);break;case k:D=P(D,"number"),O=new a.Slider(E);break;case M:O=new d.WorkFlow(E),"string"!=typeof D&&D!==C&&(D=""+D);break;case N:O=new g.MultiColumn(E,C,F)}return B(O,t,D,w,F,n),!0}}}function P(t,e){return"date"===e?"string"==typeof t?(t=v.Qa(t))===C&&(t=new Date):t instanceof Date||(t=new Date):"number"===e&&("string"==typeof t?t=y.Qa(t):"number"!=typeof t&&(t=0)),t}function _(t,e,n,r){var i,a,s,l,u,c,f=n.row,h=n.col;(m.isNullOrUndefined(f)||m.isNullOrUndefined(h))&&(f=t.getActiveRowIndex(),h=t.getActiveColumnIndex()),i=n.sheetArea,m.isNullOrUndefined(i)&&(i=3),e&&e.submitCommand?"string"==typeof e.submitCommand?t.getParent().commandManager().execute({cmd:e.submitCommand,sheetName:t.name(),row:f,col:h,newValue:r.value}):"function"==typeof e.submitCommand&&((a={}).row=n.row,a.col=n.col,a.sheetArea=i,e.submitCommand.call(null,t,r.value,a)):(t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:f,col:h,newValue:r.text,autoFormat:!r.noAutoFormat,sheetArea:i,isUndo:!1}),t.isEditing()&&t.Kl===h&&t.Jl===f&&(s=t.getCellType(f,h),l={sheet:t,row:f,col:h,sheetArea:o.SheetArea.viewport},u=t.AHb(f,h,i),c=t.getCellRect(f,h),t.BF.LF=r.value,s.updateEditor(t.BF,u,c,l),s.setEditorValue(t.BF,r.text,l)))}function L(t){var e=-1;switch(t){case T:e=o.DropDownType.colorPicker;break;case x:e=o.DropDownType.dateTimePicker;break;case S:e=o.DropDownType.timePicker;break;case A:e=o.DropDownType.calculator;break;case I:e=o.DropDownType.monthPicker;break;case R:e=o.DropDownType.list;break;case k:e=o.DropDownType.slider;break;case M:e=o.DropDownType.workflowList;break;case N:e=o.DropDownType.multiColumn}return e}function B(t,e,n,o,r,i){var a,s,l,u,f,h,d,g,m,y,v,C,b;w.Gm(),a=r.zo(),l=i.row,u=i.col,f=i.sheetArea,h=r.AHb(l,u,f),d=L(e),(y=(g=h.dropDowns)&&g.length>0)&&((v=g.filter((function(t){return t.type===d}))[0])&&(void 0!==v.option&&null!==v.option&&(s=v.option),m=v)),t.setOptions(s),t.setValue(n),C=a.getBoundingClientRect(),b=new c.Rectangle(o.x+C.left,o.y+C.top,o.width,o.height),D=new c.PopupControl(t.getContainer(),b,{align:c.DropDownAlignment.Far,hostElement:a}),y&&t.SDc(),D.open(),t.scrollToSelect(),y&&t.refresh(),t.on(p.BaseDropdown.Event_ValueChanged,(function(t){t.notCloseDropDown||D.close(),function(t,e){return!0!==e.notSubmit&&(3===t.sheetArea||t.cmd!==A||!isNaN(e.value))}(i,t)&&_(r,m,i,t)})),t.getContainer().addEventListener("contextmenu",(function(t){t.stopPropagation(),t.preventDefault()})),D.on("close",(function(){(function(t,e,n,o,r){var i,a=e.cellButtons;t&&a&&a.length>0&&((i=t.ITa.getValueForKey(n,o,"_cellButtonParam",r))&&i.isMouseDownReservedLocation&&(i.buttonDownIndex=-1,i.isMouseDownReservedLocation=!1,t.repaint(t.getCellRect(n,o))))})(r,h,l,u,f),t&&t.dispose(),D=null,w.Hm()}))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),e.commands=o.Commands,r=n("./dist/plugins/celltype/editor/calculator.js"),i=n("./dist/plugins/celltype/editor/listControl.js"),a=n("./dist/plugins/celltype/editor/slider.js"),s=n("./dist/plugins/celltype/editor/timepicker.js"),l=n("./dist/plugins/celltype/editor/monthPicker.js"),u=n("./dist/plugins/celltype/editor/colorpicker.js"),c=n("./dist/plugins/celltype/editor/popupControl.js"),f=n("./dist/plugins/celltype/editor/calendar.js"),h=n("Common"),p=n("./dist/plugins/celltype/editor/baseControl.js"),d=n("./dist/plugins/celltype/editor/workflowPicker.js"),g=n("./dist/plugins/celltype/editor/multiColumnPicker.js"),m=n("./node_modules/util/util.js"),y=h.Common.o,v=h.Common.l,C=null,b=window,w=b.Yl,T="openColorPicker",x="openDateTimePicker",S="openTimePicker",A="openCalculator",I="openMonthPicker",R="openList",k="openSlider",M="openWorkflowList",N="openMultiColumn",E=document,o.Commands[T]=F(T),o.Commands[x]=F(x),o.Commands[S]=F(S),o.Commands[A]=F(A),o.Commands[I]=F(I),o.Commands[R]=F(R),o.Commands[k]=F(k),o.Commands[M]=F(M),o.Commands[N]=F(N),O={init:function(){this.commandManager().register(T,o.Commands[T]),this.commandManager().register(x,o.Commands[x]),this.commandManager().register(S,o.Commands[S]),this.commandManager().register(A,o.Commands[A]),this.commandManager().register(I,o.Commands[I]),this.commandManager().register(R,o.Commands[R]),this.commandManager().register(k,o.Commands[k]),this.commandManager().register(M,o.Commands[M]),this.commandManager().register(N,o.Commands[N])}},o.Workbook.$n("registerOpendropdownCommand",O),o.Worksheet.$n("registerOpendropdownCommand",{preProcessMouseWheel:function(t){D&&!this.sgc&&(t.r=!0)}})},"./dist/plugins/celltype/editor/baseControl.js":function(t,e,n){"use strict";var o,r,i,a=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),r=function(t){function e(e){var n=t.call(this)||this;return n.xo=e,n}return a(e,t),e.prototype.init=function(t,e,n){this.qo=this.xo.querySelector("."+e),this.qo?this.RemoveChilds(this.qo):(this.qo=this.CreateElement(t,e,n),this.xo.appendChild(this.qo))},e.prototype.GetContainer=function(){return this.xo},e.prototype.RemoveChilds=function(t){for(;t.firstChild;)t.removeChild(t.firstChild)},e.prototype.CreateElement=function(t,e,n,o){var r,i=document.createElement(t);if(e&&(i.className=e),n)for(r in n)n[r]&&i.setAttribute(r,n[r]);return o&&o.appendChild(i),i},e}((o=n("./dist/plugins/celltype/editor/eventbase.js")).EventBase),e.BaseControl=r,i=function(t){function e(e){var n=t.call(this)||this;return n.qo=e,n}return a(e,t),e.prototype.updateStyle=function(t,e,n){},e.prototype.scrollToSelect=function(){},e.prototype.getContainer=function(){return this.qo},e.prototype.refresh=function(){},e.prototype.SDc=function(){},e.prototype.dispose=function(){},e.Event_ValueChanged="ValueChangedEvent",e}(o.EventBase),e.BaseDropdown=i},"./dist/plugins/celltype/editor/baseSpreadPicker.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function h(t,e,n){var o={sheet:t};i.isNullOrUndefined(n)||(o.isEsc=n),t.Wq(e,o)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("Core"),i=n("./node_modules/util/util.js"),a=Math.min,s=Math.max,l=null,u=".baseSpreadNS",c=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.setOptions(n),r.Lgc=o,r}return f(e,t),e.prototype.setOptions=function(t){var e,n;this.$z=t,t&&(e=this.qo,(n=document.createElement("div")).setAttribute("class","gc-base-spread-div"),e.appendChild(n),this.Mgc=n,this.Ngc=this.Ogc(n))},e.prototype.setValue=function(t){var e;this.$z&&(e=this.Ngc,setTimeout((function(){window.Yl.Hm(),e&&e.focus(!0)}),1e3))},e.prototype.SDc=function(){var t,e,n,o,a,s=this;s.Mgc&&(t=s.qo,(e=s.$z)&&(n=e.width,o=e.height),a=s.mAa(),i.isNullOrUndefined(n)&&(n=a.width),i.isNullOrUndefined(o)&&(o=a.height),r.GC$(t).width(n).height(o))},e.prototype.refresh=function(){this.Ngc&&this.Ngc.refresh()},e.prototype.dispose=function(){var t=this;t.Lgc&&(t.Lgc.zt(),t.Lgc=l),t.Mgc&&(t.Mgc=l),t.Ngc&&(t.Ngc.unbind(r.Events.DropdownSpreadMouseClick+u),t.Ngc.unbind(r.Events.DropdownSpreadKeyboardEnter+u),t.Ngc.no(),t.Ngc=l)},e.prototype.mAa=function(){var t,e,n,o,r,i,l,u=this.Ngc,c=u.getActiveSheet(),f=c.getColumnCount(),h=0;for(t=0;t<f;t++)h+=c.getColumnWidth(t,3);return e=h,n=c.getRowCount(3)+c.getRowCount(1),o=c.getRowHeight(0,3)*n,e<800?u.options.showHorizontalScrollbar=!1:(r=0,u.Pt&&(r=u.Pt._v()),o+=r),o<400?u.options.showVerticalScrollbar=!1:(i=0,(l=u.St)&&(i=l.wDc(!1)||l.Vo()),e+=i),{width:a(e,800),height:a(s(o,100),400)}},e.prototype.Ogc=function(t){var e,n,o=new r.Workbook(t,{sheetCount:1});return o.jDc=!0,(e=o.options).allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserResize=!1,e.allowUserZoom=!1,e.tabStripVisible=!1,e.allowContextMenu=!1,e.allowUserDeselect=!1,e.scrollbarMaxAlign=!0,o.getActiveSheet().sgc=!0,n=this,o.bind(r.Events.DropdownSpreadMouseClick+u,(function(t,e){n.submitData(e)})),o.bind(r.Events.DropdownSpreadKeyboardEnter+u,(function(t,e){n.submitData(e)})),o},e.prototype.submitData=function(t){},e}(o.BaseDropdown),e.BaseSpreadPicker=c,r.GC$.extend(r.Worksheet.prototype,{tgc:function(){h(this,r.Events.DropdownSpreadMouseClick)},ugc:function(t){h(this,r.Events.DropdownSpreadKeyboardEnter,t)}})},"./dist/plugins/celltype/editor/calculator.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/celltypes.ns.js"),i=n("Common"),a=n("Core"),s=new i.Common.ResourceManager(r.SR),l=s.getResource.bind(s),u=Math.floor,c=Math.abs,f=Math.pow,h=Math.round,p=Math.sqrt,d=Math.max,g=["0","1","2","3","4","5","6","7","8","9","+/-",".","+","-","*","/","SQRT","%","1/x","=","MC","MR","MS","M+","BS","CE","C","POW"],(m=function(){function t(){}return t.Init=function(){t.GetBrowserType();var e=void 0!==t.edge;t.IsIE=void 0!==t.ie||e},t.GetBrowserType=function(){try{var e=navigator.userAgent.toLowerCase();window.ActiveXObject?t.ie=e.match(/msie ([\d.]+)/)[1]:-1!==e.indexOf("edge")?t.edge=e.match(/edge\/([\d.]+)/)[1]:-1!==e.indexOf("firefox")&&(t.firefox=e.match(/firefox\/([\d.]+)/)[1]),-1!==e.indexOf("rv:")&&-1===e.indexOf("firefox")&&(t.ie=e.match(/rv:([\d.]+)/)[1])}catch(t){}},t}()).Init(),y=function(){function t(){}return t.IsErrorText=function(t){return t===l().Calculator_DivideByZeroInfo||t===l().Calculator_InvalidInputInfo||t===l().Calculator_SqrtParameterException||t===l().Calculator_OverFlowInfo},t}(),e.CalculatorErrorInfo=y,v=function(){function t(){}return t.IsDotContained=function(t){return-1!==(t+"").indexOf(".")},t.GetDotPosition=function(t){var e=t+"",n=0,o=0;for(o=e.length;o>0;o--){if("."===e.substring(o-1,o))return n;n++}return 0===o?0:n},t.FormatOutput=function(e){var n,o;if(null==e)return null;if(0,o=(n=e+"").length,t.IsDotContained(n))for(;"0"===n.substring(o-1,o)&&""!==n&&-1===n.indexOf("e");)n=n.substring(0,o-1),o--;return n},t.FormatResult=function(e){var n,o,r,i,a,s,u;return isNaN(e)&&(e=0),n=e+"",o="",e<0&&(o="-",n=n.substring(1,n.length)),r=n.length,i="",-1!==(a=n.indexOf("e"))&&(i=n.substring(a,r),r=(n=n.substring(0,a)).length),t.IsDotContained(n)&&r>16&&(s=0,parseFloat(n)>1?(s=t.GetDotPosition(n)-(r-16),n=(""+n).substring(0,17)):(s=t.GetDotPosition(n)-(r-17),n=(""+n).substring(0,18)),n=s>0?""+h(parseFloat(n)*f(10,s))/f(10,s):""+h(parseFloat(n))),r=n.length,!t.IsDotContained(n)&&r>15&&(s=r-15,n=""+h(parseFloat(n)/f(10,s))*f(10,s)),n=o+n+i,u=parseFloat(n),t.IsOverFlow(""+u)?l().Calculator_OverFlowInfo:u},t.SingleMathOperation=function(e,n){var o,r=parseFloat(e);if(isNaN(r)&&(r=0),"SQRT"===n){if(r<0)return l().Calculator_InvalidInputInfo;r=p(r)}if("POW"===n&&(r=f(r,2)),"1/x"===n){if(0===r)return l().Calculator_DivideByZeroInfo;o=t.GetDotPosition(""+r),r=f(10,o)/(f(10,o)*r)}return t.FormatResult(r)},t.DoubleMathOperation=function(e,n,o){var r,i,a,s,u=parseFloat(e),c=parseFloat(n);if(t.IsDotContained(""+u)||t.IsDotContained(""+c)){if(i=0,a=0,t.IsDotContained(""+u)&&(i=t.GetDotPosition(""+u)),t.IsDotContained(""+c)&&(a=t.GetDotPosition(""+c)),s=d(i,a),"+"===o&&(r=((u*=f(10,s))+(c*=f(10,s)))/f(10,s)),"-"===o&&(r=((u*=f(10,s))-(c*=f(10,s)))/f(10,s)),"*"===o&&(r=(u*=f(10,i))*(c*=f(10,a))/f(10,i+a)),"/"===o){if(u*=f(10,s),0===(c*=f(10,s)))return l().Calculator_DivideByZeroInfo;r=u/c}"%"===o&&(r=(u*=f(10,i))*(c*=f(10,a))/f(10,i+a+2))}else{if("+"===o&&(r=u+c),"-"===o&&(r=u-c),"*"===o&&(r=u*c),"/"===o){if(0===c)return l().Calculator_DivideByZeroInfo;r=u/c}"%"===o&&(r=u*c/100)}return t.FormatResult(r)},t.IsOverFlow=function(t){var e=parseFloat(t);if(0!==e){if(e>79e27)return!0;if(e<1e-28&&e>-1e-28)return!0;if(e<-79e27)return!0}return!1},t}(),C=function(){function t(t,e,n,o,r,i,a,s,l,u,c){var f=this;f.Fi=t,f.XHa=e,f.YHa=n,f.JCb=o,f.KCb=r,f.Jb=i,f.LCb=a,f.MCb=s,f.NCb=l,f.OCb=u,f.PCb=c,f.QCb=g}return t.prototype.RCb=function(){var t=this;t.Fi="",t.XHa=null,t.YHa=null,t.JCb=null,t.KCb=0,t.MCb=!1,t.NCb=!1},t.prototype.Click=function(t){var e,n=this;return t>=0&&t<=11&&(n.OCb&&(n.SCb(t),n.OCb=!1),n.TCb(t),10!==t&&(n.PCb="ClickNumericButton")),(t>=12&&t<=19||27===t)&&(n.OCb?(n.SCb(t),n.OCb=!1):(n.UCb(t),n.PCb="ClickMathButton")),24===t&&(n.OCb&&(n.SCb(t),n.OCb=!1),n.VCb()),25!==t&&26!==t||(n.SCb(t),n.OCb=!1),n.OCb?null:((e={}).outputText=n.WCb(),y.IsErrorText(n.Fi)&&(n.OCb=!0),e.result=void 0===n.Fi||null===n.Fi?"":n.Fi,e.x=n.XHa,e.y=n.YHa,e.operation=n.JCb,e.token=n.KCb,e.count=n.Jb,e.memoryNumber=n.LCb,e.isBSCanUse=n.MCb,e.isEqualClicked=n.NCb,e.isOperationInvalid=n.OCb,e.lastOperation=n.PCb,e)},t.prototype.TCb=function(t){var e=this;if(null!==e.Fi&&void 0!==e.Fi||(e.Fi=""),!(e.Jb>14&&10!==t))switch(11!==t&&10!==t&&(0!==t||e.Fi+""!="0"&&""!==e.Fi)&&e.Jb++,10!==t&&(e.MCb=!0),e.KCb){case 0:t>=0&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0!==t?e.Fi=""+t:"0"!==e.Fi&&(e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):e.Fi-0>0?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0."),""===e.Fi||v.IsDotContained(e.Fi)?""!==e.Fi&&v.IsDotContained(e.Fi)||(e.Fi="0."):e.Fi=e.Fi+"."),e.KCb=1;break;case 1:t>=0&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0===t||("0"===e.Fi&&0!==t?e.Fi=""+t:e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):e.Fi-0>0?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb?e.Fi="0.":v.IsDotContained(e.Fi)||(""===e.Fi?e.Fi="0.":e.Fi=e.Fi+".")),e.NCb||(e.YHa=e.Fi);break;case 2:t>=0&&t<=9&&(e.Fi="",e.Fi=e.Fi+t),11===t&&(e.Fi="0."),10===t&&(e.Fi="0"),e.KCb=3,e.YHa=e.Fi;break;case 3:t>=0&&t<=9&&("ClickNumericButton"!==e.PCb&&void 0!==e.PCb&&null!==e.PCb&&(e.Fi="0"),"0"===e.Fi&&0===t||("0"===e.Fi&&0!==t?e.Fi=""+t:e.Fi=e.Fi+""+t)),10===t&&(-1===(""+e.Fi).indexOf("e")?""!==e.Fi&&"0"!==e.Fi&&(-1===(""+e.Fi).indexOf("-")?e.Fi="-"+e.Fi:e.Fi=(""+e.Fi).substring(1,(""+e.Fi).length)):e.Fi-0>0?e.Fi="-"+e.Fi:e.Fi=e.Fi.substring(1,e.Fi.length)),11===t&&("ClickNumericButton"!==e.PCb&&null!==e.PCb?e.Fi="0.":v.IsDotContained(e.Fi)||(""===e.Fi?e.Fi="0.":e.Fi=e.Fi+".")),e.YHa=e.Fi}},t.prototype.UCb=function(t){var e=this;switch(e.Jb=0,e.MCb=!1,e.NCb&&(e.NCb=!1),e.Fi=v.FormatOutput(e.Fi),e.KCb){case 0:""===e.Fi&&(e.Fi=0),(t>=16&&t<=18&&17!==t||27===t)&&(e.Fi=""+v.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi),e.KCb=1),t>=12&&t<=15&&(e.JCb=t,e.XHa=e.Fi,e.KCb=2),17===t&&e.RCb();break;case 1:(t>=16&&t<=18&&17!==t||27===t)&&(e.Fi=""+v.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(null!==e.JCb&&void 0!==e.JCb&&null!==e.YHa&&void 0!==e.YHa?e.YHa=e.Fi:e.XHa=e.Fi)),19===t&&(null!==e.JCb&&void 0!==e.JCb&&null!==e.YHa&&void 0!==e.YHa?(e.Fi=""+v.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi)):"-0."===e.Fi&&(e.Fi="0."),e.NCb=!0,e.MCb=!1),t>=12&&t<=15&&(e.JCb=t,e.XHa=e.Fi,e.KCb=2),17===t&&(null!==e.JCb&&void 0!==e.JCb?(e.YHa=e.Fi,e.Fi=""+v.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[17]),e.YHa=e.Fi):e.RCb());break;case 2:(t>=16&&t<=18&&17!==t||27===t)&&(e.Fi=""+v.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.KCb=3,e.YHa=e.Fi)),19===t&&(e.YHa=e.XHa,e.Fi=""+v.DoubleMathOperation(""+e.XHa,""+e.XHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.KCb=1,e.MCb=!1),e.NCb=!0),t>=12&&t<=15&&(e.JCb=t,e.YHa=e.Fi),17===t&&(e.Fi=v.DoubleMathOperation(""+e.XHa,""+e.XHa,e.QCb[17]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi,e.KCb=3));break;case 3:t>=16&&t<=18&&17!==t&&(e.Fi=""+v.SingleMathOperation(e.Fi,e.QCb[t]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi)),t>=12&&t<=15&&(e.YHa=e.Fi,e.Fi=""+v.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.YHa=null,e.JCb=t,e.KCb=2)),17===t&&(e.Fi=v.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[17]),y.IsErrorText(e.Fi)||(e.YHa=e.Fi)),19===t&&(e.YHa=e.Fi,e.Fi=""+v.DoubleMathOperation(""+e.XHa,""+e.YHa,e.QCb[e.JCb]),y.IsErrorText(e.Fi)||(e.XHa=e.Fi,e.KCb=1,e.MCb=!1),e.NCb=!0)}e.Fi+=""},t.prototype.VCb=function(){var t,e=this;if(e.Jb>0&&e.Jb--,(0===e.KCb||1===e.KCb||3===e.KCb)&&!0===e.MCb)switch(e.Fi+="",0,t=e.Fi.length,t>0&&(e.Fi=e.Fi.substring(0,t-1)),"-0"===e.Fi&&(e.Fi="0"),"-"===e.Fi&&(e.Fi=""),""===e.Fi&&(e.MCb=!1),e.KCb){case 0:case 1:e.XHa=e.Fi;break;case 3:e.YHa=e.Fi}},t.prototype.SCb=function(t){var e=this;e.Jb=0,e.MCb=!1,e.Fi="",25===t&&(1===e.KCb&&(null===e.JCb||void 0===e.JCb||e.NCb||(e.YHa=0)),2===e.KCb&&(e.KCb=3)),26===t&&e.RCb()},t.prototype.WCb=function(){var t=this;return""===t.Fi||null===t.Fi||void 0===t.Fi?"0":t.Fi},t.prototype.XCb=function(t){var e=t.keyCode;switch(t.shiftKey&&(e|=65536),t.ctrlKey&&(e|=131072),t.altKey&&(e|=262144),e){case 131138:case 131140:case 131141:case 131144:case 131145:case 131148:case 131150:case 131154:case 131159:case 131188:case 262181:case 262183:case 117:case 65657:case 131081:case 196617:case 9:case 65545:case 121:case 123:return null;case 48:case 96:return 0;case 49:case 97:return 1;case 50:case 98:return 2;case 51:case 99:return 3;case 52:case 100:return 4;case 53:case 101:return 5;case 54:case 102:return 6;case 55:case 103:return 7;case 56:case 104:return 8;case 57:case 105:return 9;case 120:return 10;case 190:case 188:case 110:return 11;case 65723:case 107:return 12;case 65643:if(!m.IsIE)return 12;break;case 189:case 109:return 13;case 65592:case 106:case 65722:return 14;case 191:case 111:return 15;case 65586:case 192:return 16;case 65589:return 17;case 82:return 18;case 13:return 19;case 393292:return 20;case 393298:return 21;case 393293:return 22;case 393296:return 23;case 8:return 24;case 46:return 25;case 27:case 131118:return 26;default:return 61===e&&m.firefox||187===e&&!m.firefox?19:-1}},t}(),b=function(t){function e(e){var n=t.call(this,e)||this,o=n;return o.qo=document.createElement("div"),o.qo.classList.add("gc-calculator-container"),o.qo.innerHTML='\n<div class="gc-calculator">\n    <header class="gc-top-part">\n        <div class="gc-screen">\n            <div class="gc-main-screen">\n                <input class="gc-main" value="" type="text" disabled readonly="readonly"></div>\n        </div>\n    </header>\n    <section class="gc-bottom-part">\n        <div class="gc-features">\n            <div class="gc-sub-menu">\n                <div class="gc-row">\n                    <div class="percentage button image icon-group1" data-value="%" role="button">\n                        <img class="icon icons8-Percentage" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABK0lEQVRYR+2WYQ3CMBCFvznAAgrAAeAAHOAACYADHCABJIACcAA4wAHkkpYM6K7XZs3+rAnZYNf169u7Nyo6HlXH69MD9ArEFJgDK2AKnICtO2re3bk5D2AMPLViDUAWPwQmzxQIWfDi5iyAY6zLNIArMHK73gDyWQNnp0jo3qLSJFLzNU8DeLnKek3oN3/DJbB3X4bAPbZ7ud4WwAC4AXIUn4haptEWQJLx6mRtACQbzwrgTShyellDJkw2nhXA0oZZxrMCSJ0EkCjgW0vOZccyso2XApCTeEnpGYviJoAm41kemzmItN03GS85PXMU0IyXmp7J/4hixisOEEu8ogCWxCsKYEk8a3p+DG41oTXxirRhzHi/7aql519rWxUwvdtzinqAXoHOFXgD+J9gIZOwvCMAAAAASUVORK5CYII="></div>\n                    <div class="sqrt button image icon-group1" data-value="sqrt" role="button">\n                        <img class="icon icons8-Square-Root" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABP0lEQVRYR+3V4S0FQRQF4O9VgApQATrQASpABXSAClABOqCCRwWoABWgAnKTnWSzeV5mdkf2z55fm83sPWfPuXfuzMiYjcxvEjA5UNuBd6z/0dgLuWoK2MV8yVT9u4BbHOIC57njXcuBVXw2pJuIKLJQS8ARbvCA/Szm5lAtAS/YwjEiimzUELCNZ3wjoihCDQFXOME1TovYqbILvrCCHUQURRjqQGq+V0QUxVgm4KdVLcYqxquLe+z1ab5UKFdAnO92+AbemkJriCiKkRNBsrnrQjTcJe4QZ3ohR0AUTkum7UJ6d4CIohdyBXRdSIvnAxFFb+QKaLsQfxzXbfHiWaSyREBy4bEZubj1ihbPUAFBGLnHpRN4QkQxCCUOBFHs+bOGsXjxDHUgvk8upOdBfx8flzowmLBbYBIwOTC6A7+1/zEhMa617wAAAABJRU5ErkJggg=="></div>\n                    <div class="sqr button icon-group1" data-value="pow" role="button">\n                        <span class="x-sign">\n                            <sub>x</sub></span>\n                        <span>\n                            <sup>2</sup></span>\n                    </div>\n                    <div class="fraction button icon-group1" data-value="1/x" role="button">\n                        <span>\n                            <sup>1</sup></span>\n                        <span>&frasl;</span>\n                        <span class="x-sign">\n                            <sub>\n                                <em>x</em></sub>\n                        </span>\n                    </div>\n                </div>\n            </div>\n            <div class="gc-main-menu">\n                <div class="gc-row">\n                    <div class="clear-entry button icon-group1" data-value="CE" role="button">CE</div>\n                    <div class="clear button icon-group1" data-value="C" role="button">C</div>\n                    <div class="clear-element button image icon-group1" data-value="BS" role="button">BS</div>\n                    <div class="divide button image operation icon-group1" data-value="/" role="button">\n                        <img class="icon icons8-Divide" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAo0lEQVRYR+2VSxGDMBRFTxTUAkioklrAQSVAHSChjmqhdYCDMm8mCz7DIp/yurisQ+6Zk5u8gPMXnPMRgAyUGBiBWyzxE3jkFDoXwMLvm0ADGFIhcgEm4AJcY+ALeAOtJ8AHaM4CMNW95xFYtkF0ixImn7/9m9uBVNOH6wVwZOBbzfF6o13e3wL8SMB+W5WwxICmoaahpmGVx6rkGgpABqoYmAH2Lh4hfK3KfwAAAABJRU5ErkJggg=="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="7">7</div>\n                    <div class="button number icon-group2" role="button" data-value="8">8</div>\n                    <div class="button number icon-group2" role="button" data-value="9">9</div>\n                    <div class="multiply button image operation icon-group1" data-value="*" role="button">\n                        <img class="icon icons8-Multiply" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABBUlEQVRYR+2W6w3CMAyErxuwCYwAG7AJjAATMQKMUDZhBHQSQaFqYp8DqpDSn2nj+3J+NAMWfoaF9dEBugN/4cAewA3AQ+yYFYADgHNtn+UAxS8ARgA7AYLiVwCbF8CpBGEBMBBPvxYgcvE7gG0N3AIguAIhiTO4B8ALIYsrABZESFwFKEFwPRWcmfNpMXpTkO+b1gTfsdpl8YgDCSSH4FpIvBUg2c446px4OxpNQZ5zBlPmxEcZqABz1c6A6rAKOVBrNWVYhRzw9HkIwpMCj/hcd7gK0wJQxEMQFkD6Hat9nqeD94Hw75inarmQHGviLYNIvByVP7dS8DWh6I2oA3QHfu7AEzfHWCF+OOmJAAAAAElFTkSuQmCC"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="4">4</div>\n                    <div class="button number icon-group2" role="button" data-value="5">5</div>\n                    <div class="button number icon-group2" role="button" data-value="6">6</div>\n                    <div class="minus button image operation icon-group1" data-value="-" role="button">\n                        <img class="icon icons8-Minus-Math-" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAARElEQVRYR+3V0Q0AMAQFQPYfuh1A+ql8nAF4LhIZw5XD80MAAgQIECCwVuA0fcmy8EtgPEATQG279gYIECBAgACBbwIXi38CITaYSB4AAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button number icon-group2" role="button" data-value="1">1</div>\n                    <div class="button number icon-group2" role="button" data-value="2">2</div>\n                    <div class="button number icon-group2" role="button" data-value="3">3</div>\n                    <div class="plus button image operation icon-group1" data-value="+" role="button">\n                        <img class="icon icons8-Plus-Math" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAWUlEQVRYR+2WMQoAIAgA9f+PrsWmEMQSEa7Z8rzEUmle2pxfABhvYFkPpQtJb7TEAGAAAxgoM3AO/v1YXoPPm4TtANHKy64AAAxgAANjDERB3bjXXzEA8w1s3k4WIU0YaEoAAAAASUVORK5CYII="></div>\n                </div>\n                <div class="gc-row">\n                    <div class="plus-minus button image icon-group1" data-value="+/-" role="button">\n                        <img class="icon icons8-Plus-Minus" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAYUlEQVRYR+2VMQ4AIAgD4f+P1gUdCakx1VB3pL0UcCM/J/c3CfiewIgMwUbgwmgsASLQg8ByiW7tdNIqY0gXkDnvkQEREIGnCaDLaddVFtFxk+wDCagQoN8CugCFUASuEpjXIBIhP3OSdgAAAABJRU5ErkJggg=="></div>\n                    <div class="button number icon-group2" role="button" data-value="0">0</div>\n                    <div class="dot button icon-group1" data-value="." role="button">.</div>\n                    <div class="equal button image operation icon-group1" data-value="=" role="button">\n                        <img class="icon icons8-Equal-Sign" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAQ0lEQVRYR+3U0Q0AMAQFQPYfuh1A+ikkPQMgF0/GcOXw/LAAAQIECLwETtOLLvPWLtAEUNs6wrUCUiAFBAgQIPCPwAX8vwQhcNJI5wAAAABJRU5ErkJggg==" width="32" height="32"></div>\n                </div>\n                <div class="gc-row">\n                    <div class="button okbtn icon-group1" role="button">OK</div>\n                </div>\n            </div>\n        </div>\n    </section>\n</div>\n',o.qo.querySelector(".okbtn").textContent=l().OK,e.appendChild(n.qo),o.YCb(),o.ZCb(),o.$Cb(),o._Cb(),o.aDb("0"),n}return w(e,t),e.prototype.setValue=function(t){var e,n=this;t=n.bDb(t);try{if(!n.Na(t))throw Error(l().Calculator_InvalidInputInfo);t=""===t?"0":t,n.Fi=n.cDb(t),n._text=n.dDb(t),n.XHa=parseFloat(n.Fi),n.YHa=null,n.JCb=null,n.KCb=0,n.Jb=n.eDb(parseFloat(n.Fi)),n.Jb>0?n.MCb=!0:n.MCb=!1,n.NCb=!1,n.OCb=!1,n.PCb=null}catch(t){n._text=l().Calculator_InvalidInputInfo,n.Fi="",n.XHa=null,n.YHa=null,n.OCb=!0}return n.fDb(n.OCb),n.aDb(n._text),(e={}).outputText=n._text,e.result=n.Fi,e.x=n.XHa,e.y=n.YHa,e.operation=n.JCb,e.token=n.KCb,e.count=n.Jb,e.memoryNumber=n.LCb,e.isBSCanUse=n.MCb,e.isEqualClicked=n.NCb,e.isOperationInvalid=n.OCb,e.lastOperation=n.PCb,n.gDb=new C(n.Fi,n.XHa,n.YHa,n.JCb,n.KCb,n.Jb,n.LCb,n.MCb,n.NCb,n.OCb,n.PCb),n},e.prototype.setOptions=function(){},e.prototype.scrollToSelect=function(){var t=this.qo.querySelector(".gc-main-screen .gc-main");this.kDb(t)},e.prototype.YCb=function(){var t=this;t.hDb="0",t._text=t.hDb,t.Fi="",t.XHa=0,t.YHa=0,t.JCb=null,t.KCb=0,t.Jb=0,t.LCb=null,t.MCb=!1,t.NCb=!1,t.OCb=!1,t.PCb=null},e.prototype.ZCb=function(){var t=this;t.gDb=new C(this.Fi,t.XHa,t.YHa,t.JCb,t.KCb,t.Jb,t.LCb,t.MCb,t.NCb,t.OCb,t.PCb)},e.prototype.$Cb=function(){this.fDb(this.OCb)},e.prototype._Cb=function(){var t=this,n=this,r=n.qo;r.addEventListener("click",(function(i){for(var a,s,l=i.srcElement||i.target;l&&!l.classList.contains("button");)l=l.parentElement;l&&(l.getAttribute("data-value")?(a=l.getAttribute("data-value"),s=e.iDb(a),r.focus(),-1!==s&&n.jDb(s)):l.classList.contains("okbtn")&&("ClickNumericButton"===n.PCb&&n.jDb(19),t.fire(o.BaseDropdown.Event_ValueChanged,{value:n._text,text:n._text})))})),r.addEventListener("keydown",(function(t){!0!==n.XCb(t)&&(t.preventDefault(),t.stopPropagation())})),r.addEventListener("contextmenu",(function(t){t.preventDefault(),t.stopPropagation()}))},e.prototype.aDb=function(t){var e=this.qo.querySelector(".gc-main-screen .gc-main"),n=e.value;null!=n&&(""+n).replace(/\r\n/g,"\n")!==(""+t).replace(/\r\n/g,"\n")&&(e.value=t,this.kDb(e))},e.prototype.kDb=function(t){var e=this;if(null!==e.lDb&&void 0!==e.lDb||(e.lDb=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0)),e.mDb(t))for(;e.mDb(t);)e.nDb(t);else e.oDb(t)},e.prototype.mDb=function(t){var e,n;return t.scrollWidth>t.clientWidth||!(!a.Ul.Ml.edge&&!a.Ul.Ml.msie)&&!(t.clientWidth<=0)&&(n=(e=window.getComputedStyle(t)).fontWeight+" "+e.fontSize+" "+e.fontFamily,a.Vn.Xn(t.value,n)+40>t.clientWidth)},e.prototype.nDb=function(t){var e=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);t.style.fontSize=e-1+"px"},e.prototype.oDb=function(t){for(var e=this,n=parseInt(window.getComputedStyle(t)["font-size"].replace("px",""),0);!e.mDb(t)&&n<e.lDb;)if(++n,t.style.fontSize=n+"px",e.mDb(t)){for(;e.mDb(t);)e.nDb(t);break}},e.prototype.bDb=function(t){if(void 0===t||"string"!=typeof t&&!(t instanceof String))throw Error(t+" type is not a string.");return null!=t||(t=""),""+t},e.prototype.pDb=function(t,e){var n,o,r,i;if(0===e.length)return"";for(n="",o=0,r=0,o=0;o<e.length;o++){for(i=!1,r=0;r<t.length;r++)e.substring(o,o+1)===t.substring(r,r+1)&&(i=!0);!0===i&&(n+=e.substring(o,o+1))}return n},e.prototype.Na=function(t){if(this.pDb("-.0123456789",t)!==t)return!1;var e=t.indexOf("-");return(-1===e||0===e)&&t.indexOf("-")===t.lastIndexOf("-")&&t.indexOf(".")===t.lastIndexOf(".")},e.prototype.cDb=function(t){var e,n,o,r,i,a=parseFloat(t),s=!1;if(a<0&&(s=!0),e=c(a),n=u(e),o=v.GetDotPosition(""+e),r=(e*f(10,o)-n*f(10,o))/f(10,o),n>999999999999999)throw Error(l().Calculator_InvalidInputInfo);if(999999999999999===n){if(0===r)return n;throw Error(l().Calculator_InvalidInputInfo)}return i=0===n?15:15-(""+n).length,r=h(r*f(10,i))/f(10,i),o=v.GetDotPosition(""+r),e=(n*f(10,o)+r*f(10,o))/f(10,o),n=u(e),o=v.GetDotPosition(""+e),0===(r=(e*f(10,o)-n*f(10,o))/f(10,o))&&(e=n),s?"-"+e:""+e},e.prototype.dDb=function(t){var e=""+t;return""===e&&(e="0"),e},e.prototype.eDb=function(t){var e=c(t),n=u(e),o=v.GetDotPosition(""+e),r=(e*f(10,o)-n*f(10,o))/f(10,o);return(0===n?0:(""+n).length)+(0===r?0:o)},e.prototype.fDb=function(t){for(var e=10;e<=18;e++)this.qDb(e,t);this.qDb(27,t)},e.prototype.qDb=function(t,e){var n=g[t],o=this.qo.querySelector('[data-value="'+n.toLowerCase()+'"]');o&&(e?o.classList.add("disabled"):o.classList.remove("disabled"))},e.iDb=function(t){var e=-1;switch(t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":e=parseInt(t,10);break;case"+/-":e=10;break;case".":e=11;break;case"+":e=12;break;case"-":e=13;break;case"*":e=14;break;case"/":e=15;break;case"sqrt":e=16;break;case"%":e=17;break;case"1/x":e=18;break;case"=":e=19;break;case"MC":e=20;break;case"MR":e=21;break;case"MS":e=22;break;case"M+":e=23;break;case"BS":e=24;break;case"CE":e=25;break;case"C":e=26;break;case"pow":e=27;break;default:e=-1}return e},e.prototype.jDb=function(t){var e=this,n=e.gDb.Click(t);null!=n&&(null!==n.result&&void 0!==n.result&&(e.Fi=n.result),null!==n.outputText&&void 0!==n.outputText&&(e.hDb=n.outputText,e._text=e.hDb,e.aDb(e.hDb)),null!==n.isOperationInvalid&&void 0!==n.isOperationInvalid&&n.isOperationInvalid!==e.OCb&&(e.OCb=n.isOperationInvalid,e.fDb(e.OCb)),n.memoryNumber!==e.LCb&&(e.LCb=n.memoryNumber),n.lastOperation!==e.PCb&&(e.PCb=n.lastOperation))},e.prototype.XCb=function(t){var e=this.gDb.XCb(t);return null==e||-1!==e&&void this.jDb(e)},e}(o.BaseDropdown),e.Calculator=b},"./dist/plugins/celltype/editor/calendar.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function et(t){return f.createElement(t)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/eventbase.js"),r=n("./dist/plugins/celltype/editor/timepicker.js"),i=n("./dist/plugins/celltype/editor/baseControl.js"),a=n("./dist/plugins/celltype/celltypes.ns.js"),s=n("Common"),l=n("Core"),u=new s.Common.ResourceManager(a.SR),c=u.getResource.bind(u),f=document,h="gc-content-container",p="gc-header-container",d="gc-header-title",g="gc-year-page",m="gc-month-page",y="gc-day-page",v="gc-left-arrow",C="gc-right-arrow",b="gc-is-focused",w="gc-cl-is-selected",T="gc-cl-disabled-text",x="gc-cl-select-container",S="gc-focus-part-indicator",A="gc-cl-datepicker",I="gc-cl-dropdown",R="gc-cl-datepicker-filter",k="gc-cl-datepicker-filter-month",M="gc-cl-grid-align-spread",N="gc-cl-align-middle",E="gc-cl-button-icon-container",D="gc-cl-datepicker-month",O="gc-cl-day",j="gc-cl-grow",F="gc-cl-grid",P="gc-cl-button",_="year-index",L="month-index",B="week-index",G="day-index",function(t){t[t.Date=1]="Date",t[t.Time=2]="Time"}(H||(H={})),V=function(){function t(){}return t.initResource=function(){t.resource={shortWeeks:[c().Calendar_ShortWeeks_1,c().Calendar_ShortWeeks_2,c().Calendar_ShortWeeks_3,c().Calendar_ShortWeeks_4,c().Calendar_ShortWeeks_5,c().Calendar_ShortWeeks_6,c().Calendar_ShortWeeks_7],shortMonths:[c().Calendar_ShortMonths_1,c().Calendar_ShortMonths_2,c().Calendar_ShortMonths_3,c().Calendar_ShortMonths_4,c().Calendar_ShortMonths_5,c().Calendar_ShortMonths_6,c().Calendar_ShortMonths_7,c().Calendar_ShortMonths_8,c().Calendar_ShortMonths_9,c().Calendar_ShortMonths_10,c().Calendar_ShortMonths_11,c().Calendar_ShortMonths_12],weeks:[c().Calendar_Weeks_7,c().Calendar_Weeks_1,c().Calendar_Weeks_2,c().Calendar_Weeks_3,c().Calendar_Weeks_4,c().Calendar_Weeks_5,c().Calendar_Weeks_6],months:[c().Calendar_Months_1,c().Calendar_Months_2,c().Calendar_Months_3,c().Calendar_Months_4,c().Calendar_Months_5,c().Calendar_Months_6,c().Calendar_Months_7,c().Calendar_Months_8,c().Calendar_Months_9,c().Calendar_Months_10,c().Calendar_Months_11,c().Calendar_Months_12],timePrefix:[c().Calendar_Time_AM,c().Calendar_Time_PM],eraNames:[c().Calendar_EraName_1,c().Calendar_EraName_2,c().Calendar_EraName_3,c().Calendar_EraName_4],earFirstYear:c().Calendar_FirstYear,today:c().Calendar_Today,lastMonth:c().Calendar_LastMonth,nextMonth:c().Calendar_NextMonth,lastYear:c().Calendar_LastYear,nextYear:c().Calendar_NextYear,lastTenYears:c().Calendar_LastTenYear,nextTenYears:c().Calendar_NextTenYear}},t.resource={shortWeeks:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],shortMonths:["Jan","Feb","Mar","Api","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weeks:["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],months:["January","February","March","Apirl","May","June","July","August","September","October","November","December"],timePrefix:["AM","PM"],eraNames:["M","T","S","H"],earFirstYear:"1",today:"Today",lastMonth:"Go to previous month",nextMonth:"Go to next month",lastYear:"Go to previous year",nextYear:"Go to next year",lastTenYears:"Go to previous ten years",nextTenYears:"Go to next ten years"},t}(),z=function(){this.yearTds=[]},W=function(){this.monthTds=[]},U=function(){this.weekThs=[],this.dayTds=[]},q=function(){this.calendarYearSection=new z,this.calendarMonthSection=new W,this.calendarDaySection=new U,this.timeItemLIs=[]},Y=function(){function t(){}return t.dateEqual=function(t,e,n){if(!t&&!e)return!0;if(!t)return!1;if(!e)return!1;try{return n?t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes()&&t.getSeconds()===e.getSeconds():t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}catch(t){return!1}},t.getMonthMaxDay=function(t,e){return-1!==[1,3,5,7,8,10,12].indexOf(e)?31:-1!==[4,6,9,11].indexOf(e)?30:t%4==0&&t%100!=0?29:28},t.isValidEraDate=function(t){return!(t<this.eraMin||t>this.eraMax)},t.addMilliseconds=function(t,e){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return n.setMilliseconds(n.getMilliseconds()+e),new Date(n.valueOf())},t.getEraDate=function(e){var n,o={era:-1,eraYear:-1};if(!t.isValidEraDate(e))return o;for(n=0;n<t.eraCount;n++)if(e<(n+1!==t.eraCount?t.eraDates[n+1]:t.addMilliseconds(t.eraMax,1))){o.era=n,o.eraYear=e.getFullYear()-t.eraDates[n].getFullYear()+1;break}return o},t.getEraYearString=function(e){var n=new Date(e,5,30),o=t.getEraDate(n);return-1===o.era||-1===o.eraYear?""+e:e+"å¹´"},t.getShortEraYearString=function(e){var n,o=new Date(e,11,31),r=t.getEraDate(o);return-1===r.era||-1===r.eraYear?"":(n=1===r.eraYear?V.resource.earFirstYear:r.eraYear,V.resource.eraNames[r.era]+n+"å¹´")},t.getDateLocaleLabel=function(t){var e=t.getHours(),n=t.getMinutes();return(e<12?V.resource.timePrefix[0]:V.resource.timePrefix[1])+" "+(0===e||12===e?"12":""+e%12)+":"+(n<10?"0"+n:""+n)},t.eraCount=4,t.eraMax=new Date(2087,11,31,23,59,59),t.eraMin=new Date(1868,8,8),t.eraDates=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8)],t}(),X=function(){function t(t,e,n,o){this.year=t,this.selected=!!e,this.disabled=!!n,this.focused=!!o}return t.prototype.getLabel=function(){return""+this.year},t}(),Z=function(){function t(t,e,n,o){this.month=t,this.selected=!!e,this.disabled=!!n,this.focused=!!o}return t.prototype.getLabel=function(){return V.resource.shortMonths[this.month]},t}(),Q=function(){function t(t,e,n,o){this.date=t,this.selected=!!e,this.disabled=!!n,this.focused=!!o}return t.prototype.getLabel=function(){return""+this.date.getDate()},t}(),J=function(){function t(t){this.owner=t,this.calendarPage=l.CalendarPage.month,this.oldSelectedData=null,this.selectedDate=new Date,this.focusDate=new Date(this.selectedDate.valueOf()),this.focusDateTimeIndex=-1,V.initResource()}return t.getMonthName=function(t){return V.resource.months[t]},t.getShortMonthName=function(t){return V.resource.shortMonths[t]},t.prototype.updateDayItems=function(){var t,e,n,o,r,i,a;for(this.dayItems=[],t=this.focusDate.getFullYear(),e=this.focusDate.getMonth(),r=o=((n=new Date(t,e,1).getDay()-this.owner.rDb)<0?n+7:n)%7;r>0;r--)(i=new Date(t,e,1)).setDate(i.getDate()-r),a=new Q(i,!1,!0,!1),this.dayItems.push(a);for(r=1;r<=42-o;r++)i=new Date(t,e,r),a=new Q(i),i.getMonth()!==e&&(a.disabled=!0),Y.dateEqual(i,this.selectedDate)&&(a.selected=!0),Y.dateEqual(i,this.selectedDate)&&(a.selected=!0),Y.dateEqual(i,this.focusDate)&&(a.focused=!0),this.dayItems.push(a)},t.prototype.updateMonthItems=function(){var t,e,n=this.selectedDate,o=this.focusDate;for(this.monthItems=[],t=0;t<12;t++)(e=new Z(t)).selected=n&&n.getMonth()===t&&n.getFullYear()===o.getFullYear(),e.focused=o&&o.getMonth()===t,this.monthItems.push(e)},t.prototype.updateYearItems=function(){var t,e;for(this.yearItems=[],t=this.focusDateYearRangeStart-1;t<=this.focusDateYearRangeEnd+1;t++)(e=new X(t)).selected=this.selectedDate&&this.selectedDate.getFullYear()===t,e.focused=this.focusDate&&this.focusDate.getFullYear()===t,e.disabled=t<this.focusDateYearRangeStart||t>this.focusDateYearRangeEnd,this.yearItems.push(e)},t.prototype.updateYearRange=function(){this.focusDateYearRangeStart=10*Math.floor(this.focusDate.getFullYear()/10),this.focusDateYearRangeEnd=this.focusDateYearRangeStart+9},t.prototype.getShortWeekName=function(t){return V.resource.shortWeeks[t=(this.owner.rDb+t-1)%7]},t.prototype.getCurrentMonthName=function(){var e=this.focusDate.getMonth();return t.getMonthName(e)},t}(),$=function(t){function e(e){var n=t.call(this)||this;return n.sDb=40,n.tDb=100,n.uDb=!1,n.tc=e,n}return tt(e,t),Object.defineProperty(e.prototype,"host",{get:function(){return this.tc.getContainer()},enumerable:!0,configurable:!0}),e.prototype.createCalendarDom=function(){var t,e,n,o,r,i,a,s=this.tc;this.vDb=new q,(t=et("div")).tabIndex=0,t.classList.add("gc-calendar-container"),s.JK?t.classList.add("gc-date-time-container"):t.classList.add("gc-date-container"),e=et("table"),n=et("tr"),(o=et("td")).classList.add("gc-content-td-date"),s.JK&&o.classList.add("gc-content-td-time"),o.appendChild(this.wDb()),n.appendChild(o),e.appendChild(n),t.appendChild(e),s.JK&&(r=et("tr"),i=et("td"),o.appendChild(this.xDb()),o.appendChild(this.yDb()),i.appendChild(this.zDb()),i.appendChild(this.ADb()),r.appendChild(i),e.appendChild(r)),this.vDb.outterContainerDiv=t,(a=this.host)&&(a.innerHTML="",a.appendChild(t))},e.prototype.ADb=function(){var t,e=et("div");return e.classList.add("gc-ok-button-container"),(t=et("button")).textContent="OK",t.className=P+" gc-cl-button-brand gc-uiButton",e.appendChild(t),this.vDb.okButton=t,e},e.prototype.xDb=function(){var t=et("div");return t.classList.add("gc-date-time-vertical-partline"),t},e.prototype.zDb=function(){var t=et("div");return t.classList.add("gc-date-time-horizontal-partline"),t},e.prototype.wDb=function(){var t=et("div");return t.className="gc-date-part-container "+A+" "+I,t.tabIndex=0,t.appendChild(this.BDb()),t.appendChild(this.CDb()),t.appendChild(this.DDb()),this.vDb.dateContainerDiv=t,t},e.prototype.BDb=function(){var t=et("div");return t.classList.add(g),t.appendChild(this.EDb()),t.appendChild(this.FDb()),t},e.prototype.EDb=function(){var t,e,n,o,r,i,a,s=et("div");return s.className=p+" "+R+" "+F,(t=et("div")).className=k+" "+F+" "+M+" "+j,et("div").classList.add(N),(e=et("button")).className=P+" "+E,e.title=c().Calendar_LastTenYear,(n=et("div")).classList.add(v),e.appendChild(n),(o=et("span")).classList.add(N),(r=et("button")).className=P+" "+E,r.title=c().Calendar_NextTenYear,(i=et("div")).classList.add(C),r.appendChild(i),t.appendChild(e),t.appendChild(o),t.appendChild(r),(a=this.vDb.calendarYearSection).headerDiv=s,a.lastYearRangeButton=e,a.focusDateYearRangeName=o,a.nextYearRangeButton=r,s.appendChild(t),s},e.prototype.FDb=function(){var t,e=et("table");return e.className=h+" "+D,(t=et("div")).appendChild(e),this.vDb.calendarYearSection.currentYearRangeTable=e,this.GDb(),t},e.prototype.GDb=function(){var t,e,n,o,r,i=this.vDb.calendarYearSection,a=et("tbody");for(t=0;t<3;t++){for(e=et("tr"),n=0;n<4;n++)(o=et("td")).setAttribute(_,""+(4*t+n)),(r=et("span")).classList.add(O),r.setAttribute(_,""+(4*t+n)),r.innerText=""+(4*t+n+1),o.appendChild(r),e.appendChild(o),i.yearTds.push(o);a.appendChild(e)}i.currentYearRangeTable.appendChild(a)},e.prototype.CDb=function(){var t=et("div");return t.classList.add(m),t.appendChild(this.HDb()),t.appendChild(this.IDb()),t},e.prototype.HDb=function(){var t,e,n,o,r,i,a,s=et("div");return s.className=p+" "+R+" "+F,(t=et("div")).className=k+" "+F+" "+M+" "+j,et("div").classList.add(N),(e=et("button")).className=P+" "+E,e.title=c().Calendar_LastYear,(n=et("div")).classList.add(v),e.appendChild(n),(o=et("span")).className=d+" "+N,(r=et("button")).className=P+" "+E,r.title=c().Calendar_NextYear,(i=et("div")).classList.add(C),r.appendChild(i),t.appendChild(e),t.appendChild(o),t.appendChild(r),(a=this.vDb.calendarMonthSection).headerDiv=s,a.lastYearButton=e,a.currentYearName=o,a.nextYearButton=r,s.appendChild(t),s},e.prototype.IDb=function(){var t,e=et("table");return e.className=h+" "+D,(t=et("div")).appendChild(e),this.vDb.calendarMonthSection.currentYearTable=e,this.JDb(),t},e.prototype.JDb=function(){var t,e,n,o,r,i=this.vDb.calendarMonthSection,a=et("tbody");for(t=0;t<3;t++){for(e=et("tr"),n=0;n<4;n++)(o=et("td")).setAttribute(L,""+(4*t+n+1)),(r=et("span")).classList.add(O),r.setAttribute(L,""+(4*t+n+1)),r.innerText=""+(4*t+n+1),o.appendChild(r),e.appendChild(o),i.monthTds.push(o);a.appendChild(e)}i.currentYearTable.appendChild(a)},e.prototype.DDb=function(){var t=et("div");return t.classList.add(y),t.appendChild(this.KDb()),t.appendChild(this.LDb()),t.appendChild(this.MDb()),t.appendChild(this.NDb()),t},e.prototype.KDb=function(){var t,e,n,o,r,i,a,s,l,u,f,h,g,m,y,b=et("div");for(b.className=p+" "+R+" "+F,(t=et("div")).className=k+" "+F+" "+M+" "+j,et("div").classList.add(N),(e=et("button")).className=P+" "+E,e.title=c().Calendar_LastMonth,(n=et("div")).classList.add(v),e.appendChild(n),(o=et("span")).className=d+" "+N,(r=et("button")).className=P+" "+E,r.title=c().Calendar_NextMonth,(i=et("div")).classList.add(C),r.appendChild(i),t.appendChild(e),t.appendChild(o),t.appendChild(r),(a=et("div")).className="gc-year-select-div gc-cl-shrink-none",(s=et("div")).classList.add(x),(l=et("select")).classList.add("gc-cl-select"),f=(u=new Date).getFullYear()-this.tDb,h=u.getFullYear()+this.sDb,g=f;g<=h;g++)(m=et("option")).text=""+g,m.value=""+g,l.options.add(m);return et("div").classList.add(x),s.appendChild(l),a.appendChild(s),b.appendChild(a),b.appendChild(t),(y=this.vDb.calendarDaySection).headerDiv=b,y.lastMonthButton=e,y.currentMonthName=o,y.nextMonthButton=r,y.yearSelect=l,b},e.prototype.LDb=function(){var t,e,n,o,r,i,a=et("div");for(a.className="gc-week-container "+R+" "+F,(t=et("table")).className=h+" "+D,e=et("thead"),n=et("tr"),o=0;o<7;o++)(r=et("th")).setAttribute(B,""+o),(i=et("span")).classList.add("gc-cl-week"),i.setAttribute(B,""+o),i.innerText=this.tc.aT.getShortWeekName(o),r.appendChild(i),n.appendChild(r),this.vDb.calendarDaySection.weekThs.push(r);return e.appendChild(n),t.appendChild(e),a.appendChild(t),a},e.prototype.MDb=function(){var t,e,n,o,r,i,a=this.vDb.calendarDaySection,s=et("div"),l=et("div"),u=et("table");for(u.className=h+" "+D,t=et("tbody"),e=0;e<6;e++){for(n=et("tr"),o=0;o<7;o++)(r=et("td")).setAttribute(G,""+(7*e+o)),(i=et("span")).classList.add(O),i.setAttribute(G,""+(7*e+o)),r.appendChild(i),n.appendChild(r),a.dayTds.push(r);t.appendChild(n)}return u.appendChild(t),l.appendChild(u),s.appendChild(l),a.dayContentTable=u,s},e.prototype.NDb=function(){var t,e,n,o,r,i=et("div");return i.classList.add("gc-today-container"),(t=et("table")).classList.add(h),e=et("tbody"),n=et("tr"),o=et("td"),(r=et("a")).href="javascript:void(0);",r.className="gc-cl-show-inline-block gc-cl-p-bottom-x-small",r.innerText=V.resource.today,o.appendChild(r),n.appendChild(o),e.appendChild(n),t.appendChild(e),i.appendChild(t),this.vDb.calendarDaySection.todayTd=o,this.vDb.calendarDaySection.todayTable=t,i},e.prototype.yDb=function(){var t=this,e=et("div");return e.className="gc-time-part-container "+A+" "+I,e.tabIndex=0,this.vDb.timeContainerDiv=e,this.ODb=new r.TimePicker(e),this.ODb.setOptions({step:{minute:30},height:260}),this.ODb.on(i.BaseDropdown.Event_ValueChanged,(function(e){t.PDb(e)})),e},e.prototype.updateCalendarDom=function(){this.QDb(),this.tc.JK&&this.RDb()},e.prototype.QDb=function(){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.SDb();break;case l.CalendarPage.month:this.TDb();break;case l.CalendarPage.day:this.UDb()}},e.prototype.VDb=function(){var t,e,n,o,r,i=this.tc.aT,a=this.vDb.calendarDaySection,s=!1;for(a.currentMonthName.innerText=i.getCurrentMonthName(),t=i.focusDate.getFullYear(),e=a.yearSelect,n=0;n<e.options.length;n++)if(""+t===e.options[n].value){e.selectedIndex=n,s=!0;break}o=this.sDb+this.tDb+1,s?e.options[o]&&e.selectedIndex<=o-1&&e.options[o].remove():((r=et("option")).text=""+t,r.value=""+t,e.options[o]=r,e.selectedIndex=o)},e.prototype.SDb=function(){var t,e,n,o,r,i,a,s,l=this.tc.aT,u=this.vDb.calendarYearSection;for(l.updateYearItems(),u.focusDateYearRangeName.innerText=l.focusDateYearRangeStart+" - "+l.focusDateYearRangeEnd,t=u.yearTds,e=l.yearItems,n=0;n<3;n++)for(o=0;o<4;o++)i=e[r=4*n+o],(s=(a=t[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(T):a.classList.remove(T),i.selected?a.classList.add(w):a.classList.remove(w),i.focused?s.classList.add(b):s.classList.remove(b)},e.prototype.TDb=function(){var t,e,n,o,r,i,a,s,l,u=this.tc.aT,c=this.vDb.calendarMonthSection;for(u.updateMonthItems(),t=u.focusDate.getFullYear(),e=u.monthItems,n=c.monthTds,c.currentYearName.innerText=""+t,o=0;o<3;o++)for(r=0;r<4;r++)a=e[i=4*o+r],(l=(s=n[i]).querySelector("span")).innerText=a.getLabel(),a.selected?s.classList.add(w):s.classList.remove(w),a.focused?l.classList.add(b):l.classList.remove(b)},e.prototype.UDb=function(){this.VDb(),this.WDb()},e.prototype.WDb=function(){var t,e,n,o,r,i,a,s,l=this.tc.aT;for(l.updateDayItems(),t=l.dayItems,e=this.vDb.calendarDaySection.dayTds,n=0;n<6;n++)for(o=0;o<7;o++)i=t[r=7*n+o],(s=(a=e[r]).querySelector("span")).innerText=i.getLabel(),i.disabled?a.classList.add(T):a.classList.remove(T),i.focused?s.classList.add(b):s.classList.remove(b),i.selected?a.classList.add(w):a.classList.remove(w)},e.prototype.RDb=function(){this.ODb.setValue(this.tc.aT.selectedDate)},e.prototype.attachEvent=function(){this.XDb(),this.attachDateEvent(),this.tc.JK&&this.attachTimeEvent()},e.prototype.XDb=function(){var t=this;this.vDb.outterContainerDiv.addEventListener("keydown",(function(e){t.YDb(e)}))},e.prototype.YDb=function(t){return 9===t.keyCode?(this.tc.JK&&(this.tc.aT.calendarActivePart===H.Date?this.setCalendarActivePart(H.Time):this.setCalendarActivePart(H.Date)),void t.preventDefault()):void(this.tc.aT.calendarActivePart===H.Date&&this.ZDb(t))},e.prototype.ZDb=function(t){switch(this.tc.aT.calendarPage){case l.CalendarPage.year:this.$Db(t);break;case l.CalendarPage.month:this._Db(t);break;case l.CalendarPage.day:this.aEb(t)}},e.prototype.$Db=function(t){var e=this.tc.aT,n=e.focusDate;switch(t.keyCode){case 13:e.selectedDate=new Date(n.valueOf()),this.showCalendarPage(l.CalendarPage.month);break;case 32:e.selectedDate=new Date(n.valueOf());break;case 37:this.bEb();break;case 39:this.cEb();break;case 38:this.bEb(4);break;case 40:t.ctrlKey||t.metaKey?this.dEb():this.cEb(4);break;case 36:n.setFullYear(e.focusDateYearRangeStart);break;case 35:n.setFullYear(e.focusDateYearRangeEnd);break;case 33:this.eEb();break;case 34:this.fEb()}e.updateYearRange(),this.QDb()},e.prototype._Db=function(t){var e=this.tc.aT,n=e.focusDate;switch(t.keyCode){case 13:e.selectedDate=new Date(n.valueOf()),this.showCalendarPage(l.CalendarPage.day);break;case 32:e.selectedDate=new Date(n.valueOf());break;case 37:this.gEb();break;case 39:this.hEb();break;case 38:t.ctrlKey||t.metaKey?this.iEb():this.gEb(4);break;case 40:t.ctrlKey||t.metaKey?this.jEb():this.hEb(4);break;case 36:n.setMonth(0);break;case 35:n.setMonth(11);break;case 33:this.bEb();break;case 34:this.cEb()}this.QDb()},e.prototype.aEb=function(t){var e=this.tc.aT,n=e.focusDate,o=n.getFullYear(),r=n.getMonth(),i=n.getDate(),a=Y.getMonthMaxDay(o,r+1);switch(t.keyCode){case 13:return e.selectedDate=new Date(n.valueOf()),void this.lEb();case 32:e.selectedDate=new Date(n.valueOf());break;case 37:n.setDate(i-1);break;case 39:n.setDate(i+1);break;case 38:n.setDate(i-7);break;case 40:n.setDate(i+7);break;case 36:n.setDate(1);break;case 35:n.setDate(a);break;case 33:t.shiftKey?this.gEb(12):this.gEb();break;case 34:t.shiftKey?this.hEb(12):this.hEb()}e.selectedDate=new Date(n.valueOf()),this.QDb()},e.prototype.attachDateEvent=function(){var t=this;this.vDb.dateContainerDiv.addEventListener("click",(function(e){var n=e.target;(!n||n!==t.vDb.calendarDaySection.yearSelect&&n.parentElement!==t.vDb.calendarDaySection.yearSelect)&&t.setCalendarActivePart(H.Date)})),this.attachYearEvent(),this.attachMonthEvent(),this.attachDayEvent()},e.prototype.attachYearEvent=function(){var t=this;this.vDb.calendarYearSection.lastYearRangeButton.addEventListener("click",(function(e){t.eEb(),t.QDb()})),this.vDb.calendarYearSection.nextYearRangeButton.addEventListener("click",(function(e){t.fEb(),t.QDb()})),this.vDb.calendarYearSection.currentYearRangeTable.addEventListener("click",(function(e){t.mEb(e)}))},e.prototype.eEb=function(){var t=this.tc.aT;t.focusDateYearRangeStart-=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()-10)},e.prototype.fEb=function(){var t=this.tc.aT;t.focusDateYearRangeStart+=10,t.focusDateYearRangeEnd=t.focusDateYearRangeStart+9,t.focusDate.setFullYear(t.focusDate.getFullYear()+10)},e.prototype.dEb=function(){this.showCalendarPage(l.CalendarPage.month)},e.prototype.mEb=function(t){var e,n,o=t.srcElement||t.target;o&&(e=+o.getAttribute(_),n=this.tc.aT.yearItems[e],this.tc.aT.focusDate.setFullYear(n.year),this.dEb())},e.prototype.attachMonthEvent=function(){var t=this;this.vDb.calendarMonthSection.lastYearButton.addEventListener("click",(function(e){t.bEb(),t.QDb()})),this.vDb.calendarMonthSection.nextYearButton.addEventListener("click",(function(e){t.cEb(),t.QDb()})),this.vDb.calendarMonthSection.currentYearName.addEventListener("click",(function(e){t.iEb()})),this.vDb.calendarMonthSection.currentYearTable.addEventListener("click",(function(e){t.nEb(e)}))},e.prototype.bEb=function(t){var e=t||1,n=Math.max(this.tc.aT.focusDate.getFullYear()-e,0);this.tc.aT.focusDate.setFullYear(n)},e.prototype.cEb=function(t){var e=t||1,n=Math.min(this.tc.aT.focusDate.getFullYear()+e,9999);this.tc.aT.focusDate.setFullYear(n)},e.prototype.iEb=function(){this.tc.aT.updateYearRange(),this.showCalendarPage(l.CalendarPage.year)},e.prototype.jEb=function(){this.showCalendarPage(l.CalendarPage.day)},e.prototype.nEb=function(t){var e,n=t.srcElement||t.target;n&&(e=+n.getAttribute(L),this.tc.aT.focusDate.setMonth(e-1),this.jEb())},e.prototype.attachDayEvent=function(){var t=this,e=this.vDb.calendarDaySection;e.lastMonthButton.addEventListener("click",(function(e){t.gEb(),t.uDb||t.QDb()})),e.nextMonthButton.addEventListener("click",(function(e){t.hEb(),t.uDb||t.QDb()})),e.currentMonthName.addEventListener("click",(function(e){t.oEb()})),e.todayTable.addEventListener("click",(function(e){t.pEb()})),e.dayContentTable.addEventListener("click",(function(e){t.qEb(e)})),e.yearSelect.addEventListener("change",(function(e){t.rEb(e)})),this.vDb.calendarDaySection.yearSelect.addEventListener("keydown",(function(t){t.stopPropagation()}))},e.prototype.gEb=function(t){var e,n,o=this.tc.aT,r=t||1,i=o.focusDate.getFullYear(),a=o.focusDate.getMonth()-r,s=o.focusDate.getDate();a<0&&(a+=12,i-=1),e=Y.getMonthMaxDay(i,a+1),n=new Date(i,a,Math.min(s,e)),o.focusDate=n},e.prototype.hEb=function(t){var e,n,o=this.tc.aT,r=t||1,i=o.focusDate.getFullYear(),a=o.focusDate.getMonth()+r,s=o.focusDate.getDate();a>11&&(a-=12,i+=1),e=Y.getMonthMaxDay(i,a+1),n=new Date(i,a,Math.min(s,e),o.focusDate.getHours(),o.focusDate.getMinutes(),o.focusDate.getSeconds()),o.focusDate=n},e.prototype.oEb=function(){this.showCalendarPage(l.CalendarPage.month)},e.prototype.qEb=function(t){var e,n,o,r,i=this.tc.aT,a=t.srcElement||t.target;a&&(e=a.getAttribute(G),n=i.dayItems[+e].date,r=(o=i.selectedDate)?new Date(o.valueOf()):new Date,i.selectedDate=new Date(n.getFullYear(),n.getMonth(),n.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()),i.focusDate=new Date(i.selectedDate.valueOf()),this.QDb(),this.tc.JK||this.lEb()),this.vDb.dateContainerDiv.focus()},e.prototype.pEb=function(){var t=this.tc,e=t.aT.selectedDate,n=e?new Date(e.valueOf()):null,o=new Date;n&&(o.setHours(n.getHours()),o.setMinutes(n.getMinutes()),o.setSeconds(0)),t.aT.selectedDate=o,t.aT.focusDate=new Date(o.valueOf()),this.QDb(),t.JK||this.lEb()},e.prototype.rEb=function(t){var e=t.srcElement||t.target;e&&(this.tc.aT.focusDate.setFullYear(+e.value),this.updateCalendarDom())},e.prototype.attachTimeEvent=function(){var t=this;this.vDb.timeContainerDiv.addEventListener("click",(function(e){t.setCalendarActivePart(H.Time)})),this.vDb.okButton.addEventListener("click",(function(e){t.lEb()}))},e.prototype.PDb=function(t){var e=this.tc.aT,n=e.selectedDate?new Date(e.selectedDate.valueOf()):new Date,o=t.value;n.setHours(o.getHours()),n.setMinutes(o.getMinutes()),n.setSeconds(o.getSeconds()),e.selectedDate=n,e.focusDate=new Date(n.valueOf())},e.prototype.lEb=function(){var t=this.tc.aT;this.fire(i.BaseDropdown.Event_ValueChanged,{oldValue:t.oldSelectedData,newValue:t.selectedDate}),t.oldSelectedData=t.selectedDate},e.prototype.showCalendarPage=function(t){var e=this.host.querySelector("."+g),n=this.host.querySelector("."+m),o=this.host.querySelector("."+y);switch(e.style.display="none",n.style.display="none",o.style.display="none",t){case l.CalendarPage.year:e.style.display="";break;case l.CalendarPage.month:n.style.display="";break;case l.CalendarPage.day:o.style.display=""}this.tc.aT.calendarPage=t,this.updateCalendarDom()},e.prototype.setCalendarActivePart=function(t){switch(this.tc.aT.calendarActivePart=t,this.vDb.dateContainerDiv.classList.remove(S),this.tc.JK&&this.vDb.timeContainerDiv.classList.remove(S),t){case H.Date:this.tc.JK&&this.vDb.dateContainerDiv.classList.add(S),this.vDb.outterContainerDiv.focus();break;case H.Time:this.tc.JK&&this.vDb.timeContainerDiv.classList.add(S),this.vDb.outterContainerDiv.focus()}},e.Event_GetHost="GetHost",e}(o.EventBase),K=function(t){function e(e,n){var o=t.call(this,e)||this;return o.rDb=7,o.JK=!0,o.aT=new J(o),o.yl=new $(o),o.yl.on(i.BaseDropdown.Event_ValueChanged,(function(t){var e=s.Common.CultureManager.q4().DateTimeFormat,n=new s.Formatter.GeneralFormatter(e.shortDatePattern+" h:mm:ss").format(t.newValue);o.fire(i.BaseDropdown.Event_ValueChanged,{text:n,value:t.newValue})})),o.yl.on($.Event_GetHost,(function(t){t.host=o.qo})),o.yl.createCalendarDom(),o.yl.attachEvent(),o.setValue(new Date),o.yl.showCalendarPage(l.CalendarPage.day),o.yl.setCalendarActivePart(H.Date),n&&o.setOptions(n),o}return tt(e,t),e.prototype.setOptions=function(t){var e,n;t&&(t.showTime||(this.JK=t.showTime,this.yl.createCalendarDom(),this.yl.attachEvent()),e=t&&t.calendarPage?t.calendarPage:l.CalendarPage.day,(n=t&&t.startDay?t.startDay:l.CalendarStartDay.saturday)!==this.rDb&&(this.rDb=n,this.qo.innerHTML="",this.yl.createCalendarDom(),this.yl.attachEvent()),this.yl.showCalendarPage(e),this.yl.setCalendarActivePart(H.Date))},e.prototype.setValue=function(t){var e=this.aT;e.selectedDate=t,e.oldSelectedData=new Date(t.valueOf()),e.focusDate=new Date(t.valueOf()),e.updateYearRange()},e.prototype.scrollToSelect=function(){this.yl.updateCalendarDom()},e}(i.BaseDropdown),e.Calendar=K},"./dist/plugins/celltype/editor/colorpicker.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/listControl.js"),r=n("Core"),i=n("./dist/plugins/celltype/editor/baseControl.js"),a=n("./dist/plugins/celltype/celltypes.ns.js"),s=n("Common"),l=s.Common.j.Fa,u="group-name",c=new s.Common.ResourceManager(a.SR),f=c.getResource.bind(c),h=function(t){function e(e,n){var o=t.call(this,e)||this;return o.ad(),o.setOptions(n),o}return p(e,t),e.prototype.setOptions=function(t){if(t){if(this.options=this.options||{},!l(t.colorBlockSize)){var e=parseInt(t.colorBlockSize,10);!isNaN(e)&&e>=0&&(this.options.colorBlockSize=t.colorBlockSize)}l(t.groups)||(this.options.groups=t.groups),this.VF()}else this.VF()},e.prototype.setValue=function(t){l(t)||(this.BYa=t,this.sEb=null,this.VF())},e.prototype.ad=function(){var t,n=this,o=e.DefaultColorGroup(),r=[];for(t=0;t<o.length;t++)r.push({name:o[t].name,colors:o[t].colors,needScaleColor:o[t].needScaleColor});this.options={colorBlockSize:e.DefaultCellWidth,groups:r},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-color-picker-outer-div"),this.tEb.addEventListener("click",(function(t){n.uEb(t)})),this.qo.appendChild(this.tEb)},e.prototype.VF=function(){this.tEb.innerHTML="",new o.List(this.tEb,this.vEb()),this.wEb()},e.prototype.wEb=function(){var t,e,n,o=this.tEb.querySelectorAll(".gc-color-picker-color-cell");if(o.length>0)for(t=0;t<o.length;t++)o[t].classList.remove("selected"),e=o[t].getAttribute("color"),n=o[t].getAttribute(u),this.BYa===e&&(!this.sEb||this.sEb&&this.sEb===n)&&o[t].classList.add("selected")},e.prototype.xEb=function(){var t,e,n,o,r=0,i=this.options.groups;for(t=0;t<i.length;t++)for(e=i[t],n=0;n<e.colors.length;n++)o=e.colors[n],r=Math.max(r,o.length);return r},e.prototype.vEb=function(){var t,n,o,r=[],i=this.options.colorBlockSize||e.DefaultCellWidth,a=this.xEb(),s=this.options.groups;for(t=0;t<s.length;t++)n=this.yEb(s[t],i,a),r.push(n),s[t].needScaleColor&&(o=this.zEb(s[t].colors[0]),r.push(this.yEb(o,i,a)));return{items:r}},e.prototype.zEb=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d={},g=[];g.length=5,e=[-5,-15,-25,-35,-50],n=[-10,-25,-50,-75,-90],o=[80,60,40,-25,-50],r=document.createElement("span"),i=t.length,r.style.display="none",document.body.appendChild(r);try{for(a=0;a<i;a++)for(l=(s=this.AEb(t[a],r))[0],u=s[1],c=s[2],f=this.BEb(l,u,c),h=0;h<5;h++)g[h]||((p=[]).length=i,g[h]=p),g[h][a]=1===f?this.CEb(l,u,c,e[h]):f>=.8?this.CEb(l,u,c,n[h]):0===f?this.CEb(l,u,c,Math.abs(e[5-h-1])):f<=.2?this.CEb(l,u,c,Math.abs(n[5-h-1])):this.CEb(l,u,c,o[h]);d.colors=g}finally{document.body.removeChild(r)}return d},e.prototype.AEb=function(t,e){var n;return e.style.color=t,n=window.getComputedStyle(e).color.replace(/(?:\(|\)|rgba|RGBA|rgb|RGB)*/g,"").split(","),[parseInt(n[0],10),parseInt(n[1],10),parseInt(n[2],10)]},e.prototype.CEb=function(t,e,n,o){var r,i,a;return o/=100,r=this.DEb(t,e,n),i=parseInt(""+(o>0?(240-r.luminosity)*o:r.luminosity*o),10),a=this.EEb(r.hue,r.luminosity+i,r.saturation),this.FEb(a.r,a.g,a.b)},e.prototype.GEb=function(t){var e=t.toString(16);return 1===e.length?"0"+e:e},e.prototype.FEb=function(t,e,n){return"#"+this.GEb(t)+this.GEb(e)+this.GEb(n)},e.prototype.EEb=function(t,e,n){var o,r,i,a,s;return 0===n?o=r=i=parseInt(""+255*e/240,10):(void 0,void 0,a=2*e-(s=e<=120?(e*(240+n)+120)/240:e+n-(e*n+120)/240),o=parseInt(""+(255*this.fc(a,s,t+80)+120)/240,10),r=parseInt(""+(255*this.fc(a,s,t)+120)/240,10),i=parseInt(""+(255*this.fc(a,s,t-80)+120)/240,10)),{a:255,r:o,g:r,b:i}},e.prototype.fc=function(t,e,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?t+((e-t)*n+20)/40:n<120?e:n<160?t+((e-t)*(160-n)+20)/40:t},e.prototype.BEb=function(t,e,n){return this.DEb(t,e,n).luminosity/240},e.prototype.DEb=function(t,e,n){var o,r,i,a,s,l=Math.max(Math.max(t,e),n),u=Math.min(Math.min(t,e),n),c=l+u,f=parseInt(""+(240*c+255)/510,10),h=l-u;return 0===h?(o=0,r=160):(o=f<=120?parseInt(""+(240*h+c/2)/c,10):parseInt(""+(240*h+(510-c)/2)/(510-c),10),i=(40*(l-t)+h/2)/h,a=(40*(l-e)+h/2)/h,s=(40*(l-n)+h/2)/h,(r=t===l?parseInt(""+(s-a),10):e===l?parseInt(""+(80+i-s),10):parseInt(""+(160+a-i),10))<0&&(r+=240),r>240&&(r-=240)),{luminosity:f,saturation:o,hue:r}},e.prototype.yEb=function(t,e,n){var o=this,i={items:function(){var r,i,a,s,l,c=document.createElement("div");for(c.classList.add("gc-color-picker-group-row"),c.style.width=(e+7)*n+"px",r=0;r<t.colors.length;r++){for((i=document.createElement("div")).classList.add("gc-color-picker-color-row"),a=t.colors[r],s=0;s<a.length;s++)(l=document.createElement("div")).setAttribute(u,t.name),l.setAttribute("color",a[s]),l.style.backgroundColor=a[s],l.style.width=e+"px",l.style.height=e+"px",l.classList.add("gc-color-picker-color-cell"),o.BYa===a[s]&&o.sEb===t.name&&l.classList.add("selected"),i.appendChild(l);c.appendChild(i)}return c},layout:{direction:r.LayoutDirection.horizontal,displayAs:r.LayoutDisplayAs.inline}};return t.name&&(i.text=t.name),i},e.prototype.uEb=function(t){var e,n,o=t.srcElement||t.target;o&&(e=o.getAttribute("color"),n=o.getAttribute(u),e&&n&&(this.BYa=e,this.sEb=n,this.HEb(e),this.wEb()))},e.prototype.HEb=function(t){this.fire(i.BaseDropdown.Event_ValueChanged,{value:t,text:t})},e.DefaultCellWidth=10,e.DefaultColorGroup=function(){return[{name:f().ThemeColor,colors:[["#ffffff","#000000","#e7e6e6","#44546a","#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]],needScaleColor:!0},{name:f().StandardColor,colors:[["#C00000","#FF0000","#FFC000","#FFFF00","#92D050","#00B050","#00B0F0","#0070C0","#002060","#7030A0"]]}]},e}(i.BaseDropdown),e.ColorPicker=h},"./dist/plugins/celltype/editor/eventbase.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){this.IEb={}}return t.prototype.on=function(t,e){var n=this.IEb[t];null!=n||(n=this.IEb[t]=[]),n.push(e)},t.prototype.off=function(t,e){var n,o;if(t){if(null==(n=this.IEb[t]))return;e?(o=n.indexOf(e),n.splice(o,1)):n=[],this.IEb[t]=n}else this.IEb={}},t.prototype.fire=function(t,e){var n=this,o=this.IEb[t];null!=o&&o.forEach((function(t){try{t.call(n,e)}catch(t){}}))},t}();e.EventBase=o},"./dist/plugins/celltype/editor/listControl.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function b(t){return u.createElement(t)}function w(t,e){return t.substring(0,e)+t.substring(e+1,t.length)}function T(t,e){if(i.Common.k.Bb(t,e))return!0;if(i.Common.l.Ska(e))for(var n=0;n<t.length;n++)if(t[n]-e==0)return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/popupControl.js"),r=n("./dist/plugins/celltype/editor/baseControl.js"),i=n("Common"),a=n("Core"),s=i.Common.j.Fa,l=i.Common.k.Cb,u=document,c=function(){function t(){this.JEb=new WeakMap}return t.prototype.set=function(t,e,n){var o=this.JEb.get(t);o||this.JEb.set(t,o={}),o[e]=n},t.prototype.get=function(t,e){var n=this.JEb.get(t);return n&&n[e]},t.prototype.clear=function(){this.JEb=new WeakMap},t}(),f="gc-list-control-container",h="gc-list-control-item",p="gc-list-control-hassubitem",d="gc-list-control-selected-item",g="gc-list-control-subitem",m="hide-children",y="gc-list-control-tree-content",v=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.qo=b("div"),r.qo.classList.add("gc-list-control"),e.appendChild(r.qo),r.xn=new c,r.JJb=o&&o.JJb||{Qb:void 0},r.bHb={items:[],doms:[]},r.setOptions(n),r}return C(e,t),e.prototype.setOptions=function(t){s(t)||(this.$z=function t(e){if(e.hasOwnProperty("items"))t(e.items);else if(Array.isArray(e))for(var n=0;n<e.length;n++)e[n].hasOwnProperty("items")?t(e[n]):e[n].hasOwnProperty("text")&&!e[n].hasOwnProperty("value")&&(e[n].value=e[n].text);return e}(t),this.qo.innerHTML="",this.yl())},e.prototype.setValue=function(t){if(this.$z&&this.$z.multiSelect)if("string"==typeof t)t=function(t){var e,n,o,r,i;if(s(t)||0===t.length)return[];for(e=[],n=0,o=0;o<t.length;o++)"\\"===(r=t.charAt(o))?","!==(i=t.charAt(o+1))&&"\\"!==i||(t=w(t,o)):","===r&&(e.push(t.substring(n,o)),n=o+1);return e.push(t.substring(n,t.length)),e}(t);else if(s(t))t=[];else if(i.Common.j.Ca(t)){if(1!==this.$z.valueType){t=t.slice(0);for(var e=0;e<t.length;e++)t[e]=""+t[e]}}else t=[t];this.JJb.Qb=t,this.KEb()},e.prototype.scrollToSelect=function(){},e.prototype.updateStyle=function(t,e,n){this.qo.style.font=n},e.prototype.yl=function(){var t=b("div");t.classList.add(f),this.SXa(t,this.$z),this.qo.appendChild(t),this.LXa()},e.prototype.SXa=function(t,e){if(e&&(this.LEb(t,e.layout),e.items))if(Array.isArray(e.items))this.MEb(t,e.items);else{var n=e.items();n instanceof HTMLElement&&(t.appendChild(n),t.classList.add(h),this.LEb(n,e.layout))}},e.prototype.LEb=function(t,e){e&&e.direction===a.LayoutDirection.horizontal?t.classList.add("gc-list-alignment-horizontal"):t.classList.add("gc-list-alignment-vertical")},e.prototype.MEb=function(t,e){var n,o,r,i,l,u,c,f,d,v,C=e.some((function(t){return!!t.icon}));for(n=0;n<e.length;n++)e[n].items?(o=e[n]).layout&&o.layout.displayAs===a.LayoutDisplayAs.inline?((r=b("div")).classList.add("gc-list-control-group"),(i=b("span")).innerText=o.text,(s(o.text)||""===o.text)&&i.classList.add(m),i.classList.add("gc-list-control-group-text"),r.appendChild(i),Array.isArray(o.items)?this.SXa(r,o):(l=o.items())instanceof HTMLElement&&((u=b("div")).classList.add(h),this.LEb(l,o.layout),u.appendChild(l),r.appendChild(u)),t.appendChild(r)):o.layout&&o.layout.displayAs===a.LayoutDisplayAs.tree?((c=b("div")).classList.add("gc-list-control-tree"),(f=b("div")).classList.add(h),f.classList.add(p),(i=b("span")).innerText=o.text,i.classList.add("gc-list-control-tree-text"),f.appendChild(i),o.layout.collapsible&&((d=b("span")).classList.add(g),f.appendChild(d),this.NEb(f)),c.appendChild(f),(v=b("div")).classList.add(y),Array.isArray(o.items)?this.SXa(v,o):(l=o.items())instanceof HTMLElement&&((u=b("div")).classList.add(h),this.LEb(l,o.layout),u.appendChild(l),v.appendChild(u)),c.appendChild(v),t.appendChild(c)):this.OEb(t,e[n],!1,!0):this.OEb(t,e[n],C)},e.prototype.OEb=function(t,e,n,o){var r,i,a,u,c,f,d;void 0===o&&(o=!1),(r=b("div")).classList.add(h),"-"===e.text?(r.classList.add("gc-list-control-noitem"),(i=b("div")).classList.add("gc-list-control-listseparator"),r.appendChild(i)):(n&&((a=b("div")).classList.add("gc-list-control-item-icon"),e.icon?a.style.backgroundImage="url("+e.icon+")":a.classList.add("gc-list-control-emptyicon"),r.appendChild(a)),(u=b("span")).classList.add("gc-list-control-item-text"),u.innerText=e.text,s(e.text)&&(u.innerText=s(e.value)?"":e.value),r.appendChild(u),c=s(e.value)?null:e.value,(f=l(this.bHb.items,c))<0&&(f=this.bHb.items.length,this.bHb.doms.push([]),this.bHb.items.push(c)),this.bHb.doms[f].push(r),this.xn.set(r,"items",e),o&&((d=b("span")).classList.add(g),r.classList.add(p),this.xn.set(r,"sub-items",e),r.appendChild(d),this.PEb(r))),t.appendChild(r)},e.prototype.CHb=function(t,e){var n,o=this.bHb.doms[t];if(e)for(n=0;n<o.length;n++)o[n].classList.contains(p)||o[n].classList.add(d);else for(n=0;n<o.length;n++)o[n].classList.contains(d)&&o[n].classList.remove(d)},e.prototype.KEb=function(){var t,e,n,o=this,r=o.$z;for(s(o.formula)?r&&r.multiSelect?t=o.JJb.Qb:t=[o.JJb.Qb]:t=["="+o.formula],e=0;e<o.bHb.items.length;e++)n=o.bHb.items[e],r&&r.multiSelect&&1!==r.valueType&&(n=""+n),T(t,n)?o.CHb(e,!0):o.CHb(e,!1)},e.prototype.LXa=function(){var t=this;this.qo.querySelector("."+f).addEventListener("click",(function(e){var n,o,a,l,u=t.QEb(e.target,"."+h);if(u){if(u.classList.contains(p))return void t.KJb(e);n=t.xn.get(u,"items"),o=t.$z,!n&&i.Common.j.Aa(o&&o.onItemSelected)&&(n={value:o.onItemSelected(e)}),s(n)||(a=n.value,o&&o.multiSelect&&(l=(l=t.JJb.Qb).slice(0),o.multiSelect&&1!==o.valueType&&(a=""+a),T(l,a)?function(t,e){var n,o=i.Common.l.Ska(e);for(n=t.length-1;n>=0;n--)(t[n]===e||o&&t[n]-e==0)&&t.splice(n,1)}(l,a):i.Common.k.Sb(l,a),t.JJb.Qb=a=l,t.KEb(),1!==o.valueType&&(a=function(t){var e,n,o=[];for(e=0;e<t.length;e++)(n=t[e])&&"string"==typeof n&&(n=n.replace(/\\/g,"\\\\").replace(/,/g,"\\,")),o[e]=n;return o.join(",")}(a))),t.fire(r.BaseDropdown.Event_ValueChanged,{value:a,text:a,notCloseDropDown:o&&o.multiSelect,noAutoFormat:!0}))}}))},e.prototype.QEb=function(t,e){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;n>=0&&e.item(n)!==this;)--n;return n>-1});for(var n=t;n&&!n.matches(e);)n=n.parentElement;return n},e.prototype.KJb=function(t){var n,i,a,s,l,u=this,c=this.QEb(t.target,"."+h);c.classList.contains(p)&&((n=this.xn.get(c,"sub-items"))&&n.items&&(i=b("div"),a=this.$z,n.multiSelect=a&&a.multiSelect,n.valueType=a&&a.valueType,n.onItemSelected=a&&a.onItemSelected,(s=new e(i,n,this)).KEb(),(l=new o.PopupControl(i,c,{align:o.DropDownAlignment.Near,hostElement:c,direction:o.DropDownDirection.Right})).open(),i.parentElement.style.top="0",s.on(r.BaseDropdown.Event_ValueChanged,(function(t){u.fire(r.BaseDropdown.Event_ValueChanged,t),u.$z&&u.$z.multiSelect?u.KEb():l.close()})),this.xn.set(c,"sub-items-popup",l),t.stopPropagation(),t.preventDefault()))},e.prototype.PEb=function(t){var e=this;t.addEventListener("mouseenter",(function(t){e.KJb(t)})),t.addEventListener("mouseleave",(function(t){var n,o=t.target;o.classList.contains(p)&&((n=e.xn.get(o,"sub-items-popup"))&&(n.close(),e.xn.set(o,"sub-items-pop",void 0)))}))},e.prototype.NEb=function(t){var e=this;t.addEventListener("click",(function(t){var n=t.target,o=e.QEb(n,"."+p);o&&(o.parentElement.querySelector("."+y)&&(o.parentElement.classList.contains(m)?o.parentElement.classList.remove(m):o.parentElement.classList.add(m),t.stopPropagation(),t.preventDefault()))}))},e}(r.BaseDropdown),e.List=v},"./dist/plugins/celltype/editor/monthPicker.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function y(t){return u.createElement(t)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/celltypes.ns.js"),i=n("Common"),a=i.Common.j.Fa,s=new i.Common.ResourceManager(r.SR),l=s.getResource.bind(s),u=document,c="gc-month-picker-month-item",f="gc-month-picker-qtr-item",h="selected",p="data-month",d="data-qtr",g=function(t){function e(e,n){var o=t.call(this,e)||this;return o.setOptions(n),o.LXa(),o}return m(e,t),e.prototype.setOptions=function(t){var e,n,o,r=this,i=new Date,s={startYear:i.getFullYear()-10,stopYear:i.getFullYear(),height:300};t&&(a(t.startYear)||(e=parseInt(t.startYear,10),isNaN(e)||(s.startYear=e)),!a(t.stopYear)&&t.stopYear>0&&(n=parseInt(t.stopYear,10),isNaN(n)||(s.stopYear=n)),s.stopYear<s.startYear&&(s.stopYear=t.startYear),a(t.height)||(o=parseInt(t.height,10),isNaN(o)||(s.height=o))),s.height=Math.max(1,s.height),r.$z=s,r.qo.innerHTML="",r.REb()},e.prototype.setValue=function(t){var e,n,o,r=this;t&&(e=t.getMonth()+1,n=t.getFullYear()),"number"==typeof e&&((o=r.qo.querySelector("["+p+"='"+n+"-"+e+"']"))&&(o.classList.add(h),r.SEb&&r.SEb.classList.remove(h),r.SEb=o))},e.prototype.scrollToSelect=function(){var t,e=this.SEb;e&&(t=e.offsetTop,this.qo.scrollTop=t)},e.prototype.TEb=function(t,e){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(t){for(var e=(this.document||this.ownerDocument).querySelectorAll(t),n=e.length;n>=0&&e.item(n)!==this;)--n;return n>-1});for(var n=t;n&&!n.matches(e);)n=n.parentElement;return n},e.prototype.LXa=function(){var t=this;this.qo.addEventListener("click",(function(e){var n,r,a,s,l,u,g=t,m=g.TEb(e.target,"."+c+",."+f);m&&(m.getAttribute(d)||(m.classList.add(h),g.SEb&&g.SEb.classList.remove(h),g.SEb=m,n=null,null,r=null,m.getAttribute(p)&&(n=+(a=m.getAttribute(p).split("-"))[1],r=+a[0]),s=new Date(r,n-1,1,0,0,0,0),l=i.Common.CultureManager.q4().DateTimeFormat,u=new i.Formatter.GeneralFormatter(l.shortDatePattern).format(s),g.fire(o.BaseDropdown.Event_ValueChanged,{text:u,value:s})))}))},e.prototype.REb=function(){var t,e,n,o,r=this;for(this.$z.height>=0?r.qo.style.maxHeight=this.$z.height+"px":r.qo.style.height="auto",r.qo.classList.add("gc-month-picker-container"),t=r.$z.startYear;t<=r.$z.stopYear;t++)e=document.createElement("div"),r.UEb(e),(n=document.createElement("div")).classList.add("gc-month-picker-year-container"),r.VEb(t,n),(o=document.createElement("div")).classList.add("gc-month-picker-month-container"),r.WEb(t,1,o),r.WEb(t,2,o),r.WEb(t,3,o),r.WEb(t,4,o),e.appendChild(n),e.appendChild(o),this.qo.appendChild(e)},e.prototype.UEb=function(t){var e=y("div");e.classList.add("gc-month-picker-separator"),t.appendChild(e)},e.prototype.VEb=function(t,e){var n=y("div");n.classList.add("gc-month-picker-year-item"),n.innerText=""+t,e.appendChild(n)},e.prototype.WEb=function(t,e,n){var o=document.createElement("div"),r=y("div"),i=y("div"),a=y("div"),s=y("div");switch(r.classList.add(c),i.classList.add(c),a.classList.add(c),s.classList.add(f),e){case 1:r.innerText=l().Calendar_ShortMonths_1,r.setAttribute(p,t+"-1"),i.innerText=l().Calendar_ShortMonths_2,i.setAttribute(p,t+"-2"),a.innerText=l().Calendar_ShortMonths_3,a.setAttribute(p,t+"-3"),s.innerText=l().Quarter_Format_1,s.setAttribute(d,t+"-1");break;case 2:r.innerText=l().Calendar_ShortMonths_4,r.setAttribute(p,t+"-4"),i.innerText=l().Calendar_ShortMonths_5,i.setAttribute(p,t+"-5"),a.innerText=l().Calendar_ShortMonths_6,a.setAttribute(p,t+"-6"),s.innerText=l().Quarter_Format_2,s.setAttribute(d,t+"-2");break;case 3:r.innerText=l().Calendar_ShortMonths_7,r.setAttribute(p,t+"-7"),i.innerText=l().Calendar_ShortMonths_8,i.setAttribute(p,t+"-8"),a.innerText=l().Calendar_ShortMonths_9,a.setAttribute(p,t+"-9"),s.innerText=l().Quarter_Format_3,s.setAttribute(d,t+"-3");break;case 4:r.innerText=l().Calendar_ShortMonths_10,r.setAttribute(p,t+"-10"),i.innerText=l().Calendar_ShortMonths_11,i.setAttribute(p,t+"-11"),a.innerText=l().Calendar_ShortMonths_12,a.setAttribute(p,t+"-12"),s.innerText=l().Quarter_Format_4,s.setAttribute(d,t+"-4")}o.appendChild(r),o.appendChild(i),o.appendChild(a),o.appendChild(s),n.appendChild(o),e<4&&this.UEb(n)},e}(o.BaseDropdown),e.MonthPicker=g},"./dist/plugins/celltype/editor/multiColumnPicker.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("SheetsCalc"),i=n("@grapecity/js-calc"),a=n("@grapecity/js-calc"),s=n("Common"),l=n("./dist/plugins/celltype/editor/baseControl.js"),u=n("./dist/plugins/celltype/editor/baseSpreadPicker.js"),c=n("./node_modules/util/util.js"),f=n("./dist/plugins/celltype/celltypes.ns.js"),h=new s.Common.ResourceManager(f.SR),p=h.getResource.bind(h),d=!!i,g=function(t){function e(e,n,o){return t.call(this,e,n,o)||this}return m(e,t),e.prototype.setOptions=function(e){var n,r,i,a,s,l,u;if(t.prototype.setOptions.call(this,e),(n=this).$z=e,e&&(r=n.Ngc,i=e.dataSource,a=e.bindingInfos,s=r.getActiveSheet(),i)){l=!0,function(t){t.suspendPaint(),t.suspendEvent(),t.suspendCalcService()}(s),s.options.isProtected=!0,s.options.rowHeaderVisible=!1,s.selectionPolicy(o.SelectionPolicy.single),s.selectionUnit(o.SelectionUnit.row);try{n.Rgc(s,i,a)}catch(t){l=!1,n.dispose()}finally{l&&s&&((u=new o.Style).THb=!1,s.setStyle(-1,-1,u,o.SheetArea.viewport),function(t){t.resumeCalcService(),t.resumeEvent(),t.resumePaint()}(s))}}},e.prototype.setValue=function(e){var n,o,r=this;r.$z&&(t.prototype.setValue.call(this,e),n=r.Ngc.getActiveSheet(),o=r.Sgc(e),n.setSelection(o,-1,1,-1))},e.prototype.dispose=function(){t.prototype.dispose.call(this)},e.prototype.Rgc=function(t,e,n){if(e){var o=this.Ugc(e);o&&(t.setDataSource(function(t,e){var n,o,r,i,a,s=t[0],l=[];if(c.isArray(s))for(n=t,o=function(t,e){var n=[];return e&&e.length>0?e.forEach((function(t){n.push(t.name)})):n=t.shift(),n}(t,e),r=function(t,e){var r=n[t],i={};o.forEach((function(t,e){i[t]=r[e]})),l.push(i)},i=0,a=n.length;i<a;i++)r(i);else l=t;return l}(o,n)),n&&t.bindColumns(n))}},e.prototype.Ugc=function(t){var e,n,i,s,l,u=t,f=this.Lgc;if(c.isString(u)){if(d){if(n=r.formulaToExpression(f,u),i=f.getCalcService().Hg(f.yj(),n,a.pf(0,0),!0),s=!1,l=void 0,(a.Convert.Fh(i)||a.Convert.Ca(i))&&((l=a.Convert.Ph(i,0,!1,!1,!1)).isError||l.isConvertError||(s=!0)),!s)throw Error(p().MultiColumn_InvalidDataSource);e=l}}else u instanceof o.Range?e=f.getArray(u.row,u.col,u.rowCount,u.colCount):c.isArray(u)&&(e=u);return e},e.prototype.Sgc=function(t){var e,n,o,r,i,a,s,l,u,c,f=0;if(t)for(this,e=this.Ngc.getActiveSheet(),o=(n=Object.keys(t)).length,i=(r=e.getDataSource()).length,a=!1,s=0;s<i;s++){for(l=r[s],u=0;u<o;u++){if(l[c=n[u]]!==t[c]){a=!1;break}a=!0}if(a){f=s;break}}return f},e.prototype.submitData=function(t){var e,n,o,r=t.sheet;t.isEsc?e={notSubmit:!0}:(n=r.getSelections()[0].row)>-1&&(e={value:o=r.getDataItem(n),text:o}),c.isNullOrUndefined(e)||this.fire(l.BaseDropdown.Event_ValueChanged,e)},e}(u.BaseSpreadPicker),e.MultiColumn=g},"./dist/plugins/celltype/editor/popupControl.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),function(t){t[t.Down=0]="Down",t[t.Up=1]="Up",t[t.Left=2]="Left",t[t.Right=3]="Right"}(r=e.DropDownDirection||(e.DropDownDirection={})),function(t){t[t.Near=0]="Near",t[t.Center=1]="Center",t[t.Far=2]="Far"}(i=e.DropDownAlignment||(e.DropDownAlignment={})),function(t){t[t.None=0]="None",t[t.Flip=1]="Flip",t[t.Slide=2]="Slide"}(a=e.DropDownAdjustment||(e.DropDownAdjustment={})),s=function(){function t(t,e,n,o){this.XHa=t,this.YHa=e,this.Vo=n,this._v=o}return t.CreateFromDom=function(e){return new t(e.left,e.top,e.width,e.height)},Object.defineProperty(t.prototype,"x",{get:function(){return this.XHa},set:function(t){this.XHa=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.YHa},set:function(t){this.YHa=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._v},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){return this.XHa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){return this.XHa+this.Vo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"top",{get:function(){return this.YHa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bottom",{get:function(){return this.YHa+this._v},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Location",{get:function(){return{X:this.XHa,Y:this.YHa}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Size",{get:function(){return{width:this.Vo,height:this._v}},enumerable:!0,configurable:!0}),t.prototype.Offset=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t];1===e.length&&"number"==typeof e[0].X&&"number"==typeof e[0].X?(this.XHa+=e[0].X,this.YHa+=e[0].Y):2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&(this.XHa+=e[0],this.YHa+=e[1])},t}(),e.Rectangle=s,l="ribbon-dropdowngroup-popup",u=function(t){function e(e,n,o){var s=t.call(this,null)||this;return s.sourceElement=e,s.target=n,s.defaultOption={closeAfterResize:!0,closeAfterClickOutside:!0,direction:r.Down,align:i.Near,horAdj:a.Flip|a.Slide,verAdj:a.Flip|a.Slide},s.globalMousedownEventHandler=function(t){var e;if(s.cXa){for(e=t.target;e&&e!==s.sourceElement;)e=e.parentElement;e||(s.close(),t.stopPropagation(),t.preventDefault())}},s.windowResizeEventHandler=function(){s.cXa&&s.close()},s.$z=s.defaultOption,s.cXa=!1,o&&s.mergeOption(o),s.XEb=null===s.$z.hostElement||void 0===s.$z.hostElement||!(s.$z.hostElement instanceof HTMLElement),s}return c(e,t),e.prototype.open=function(){this.cXa||(this.beforeOpen(),this.render(),this.clearPosition(),this.calcPosition(),this.cXa=!0,this.sourceElement.tabIndex=-1,this.sourceElement.style.cssText+="outline:none",this.sourceElement.focus())},e.prototype.beforeOpen=function(){this.bindEvent()},e.prototype.dispose=function(){var t=this;this.$z.closeAfterResize&&document.removeEventListener("resize",this.windowResizeEventHandler),this.$z.closeAfterClickOutside&&(document.removeEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(e){document.removeEventListener(e,t.globalMousedownEventHandler,!0)}))),this.XEb?(this.sourceElement.classList.remove(l),this.sourceElement.style.display=this.YEb,this.sourceElement.style.position=this.xC):this.ZEb&&(this.$z.hostElement.removeChild(this.ZEb),this.ZEb=null)},e.prototype.close=function(){this.cXa&&(this.cXa=!1,this.dispose(),this.fire("close"))},e.prototype.mergeOption=function(t){for(var e in t)void 0!==t[e]&&(this.$z[e]=t[e])},e.prototype.clearPosition=function(){this.$Eb.style.top=this.$Eb.style.bottom=this.$Eb.style.left=this.$Eb.style.right=""},e.prototype.calcPosition=function(){var t,e,n,o,r,i,a,l,u;t=this.target instanceof s?this.target:s.CreateFromDom(this.target.getBoundingClientRect()),e=new s(0,0,window.innerWidth,window.innerHeight),n=this.calculateDropDownLocation(e,t,{width:this.sourceElement.offsetWidth,height:this.sourceElement.offsetHeight},this.$z.direction,this.$z.align,this.$z.horAdj,this.$z.verAdj),r=(o=this.$Eb.offsetParent).getBoundingClientRect(),i=o===document.body,a=document.documentElement,l=(window.pageXOffset||a.scrollLeft)-(a.clientLeft||0),u=(window.pageYOffset||a.scrollTop)-(a.clientTop||0),this.$Eb.style.left=n.X-(i?-l:r.left)+"px",this.$Eb.style.top=n.Y-(i?-u:r.top)+"px"},e.prototype.calculateDropDownLocation=function(t,e,n,o,l,u,c){var f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I={X:t.x,Y:t.y};switch(t.Offset(-I.X,-I.Y),e.Offset(-I.X,-I.Y),f=e.left,h=e.right,p=e.top,d=e.bottom,g=p,m=t.height-d,y=f,v=t.width-h,C=(c&a.Flip)===a.Flip,b=(u&a.Flip)===a.Flip,w=(c&a.Slide)===a.Slide,T=(u&a.Slide)===a.Slide,o){case r.Up:n.height>g&&C&&(o=r.Down);break;case r.Down:n.height>m&&C&&(o=r.Up);break;case r.Left:n.width>y&&b&&(o=r.Right);break;case r.Right:n.width>v&&b&&(o=r.Left)}switch(x=0,S=0,o){case r.Up:S=p-n.height;break;case r.Down:S=d;break;case r.Left:x=f-n.width;break;case r.Right:x=h}return o===r.Up||o===r.Down?l===i.Near?x=f:l===i.Center?x=f-(n.width-e.width)/2:l===i.Far&&(x=h-n.width):o!==r.Right&&o!==r.Left||(l===i.Near?S=p:l===i.Center?S=p-(n.height-e.height)/2:l===i.Far&&(S=d-n.height)),A=new s(x,S,n.width,n.height),T&&(A.width>t.width?A.x=0:(A.x=Math.max(A.x,0),A.x=Math.min(A.x,t.width-A.width))),w&&(A.height>t.height?A.y=0:(A.y=Math.max(A.y,0),A.y=Math.min(A.y,t.height-A.height))),A.Offset(I),A.Location},e.prototype.render=function(){this.XEb?(this.xC=this.sourceElement.style.position,this.sourceElement.style.position="absolute",this.YEb=this.sourceElement.style.display,this.sourceElement.style.display="",this.sourceElement.style.zIndex="10000",this.sourceElement.classList.add(l),this.$Eb=this.sourceElement):(this.ZEb=document.createElement("div"),this.ZEb.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.ZEb.classList.add(l),this.ZEb.appendChild(this.sourceElement),this.$z.hostElement.appendChild(this.ZEb),this.$Eb=this.ZEb)},e.prototype.bindEvent=function(){var t=this;this.$z.closeAfterClickOutside&&(document.addEventListener("mousedown",this.globalMousedownEventHandler,!0),"touchstart MSPointerDown pointerdown".split(" ").forEach((function(e){document.addEventListener(e,t.globalMousedownEventHandler,!0)}))),this.$z.closeAfterResize&&document.addEventListener("resize",this.windowResizeEventHandler)},e}(o.BaseControl),e.PopupControl=u},"./dist/plugins/celltype/editor/slider.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function v(t){var e=function(t){var e=t.toExponential().match(/\d(?:\.(\d*))?e([+-]\d+)/);return t.toFixed(Math.max(0,(e[1]||"").length-parseInt(e[2],10)))}(t||0),n=0;return e.indexOf(".")>=0&&(n=e.length-e.indexOf(".")-1),n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("Common"),i=n("Core"),a=r.Common.j.Fa,s=r.Common.u.Ob,l=null,u=function(){function t(){}return t.isEmpty=function(t){return void 0===t||t===l||""===t||Array.isArray(t)&&0===t.length},t.isEmptyObject=function(t){var e,n=!0;for(e in t)if(e){n=!1;break}return n},t.pauseEvent=function(t){t.stopPropagation(),t.preventDefault()},t.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},t.allKeys=function(e){var n,o=[];if(!t.isObject(e))return[];for(n in e)e.hasOwnProperty(n)&&o.push(n);return o},t.parseStyleObject=function(e){var n,o,r,i,a,s;if(!t.isObject(e))return"";for(n="",r=0,i=(o=t.allKeys(e)).length;r<i;r++)s=e[a=o[r]],n+=a.replace(/([A-Z])/g,"-$1").toLowerCase()+": "+s+"; ";return n.trim()},t.extend=function(e,n,o){var r,i,a,s,l;for(void 0===o&&(o={}),r=t.allKeys(e),a=0,s=(i=t.allKeys(n)).length;a<s;a++)o[l=i[a]]=n[l];for(a=0,s=r.length;a<s;a++)void 0===o[l=r[a]]&&(o[l]=e[l]);return o},t.noop=function(){},t.measureWidth=function(t,e){var n=0,o=document.createElement("span");o.classList.add(e);try{o.innerText=t,o.style.display="none",document.body.appendChild(o),n=i.GC$(o).width()}finally{document.body.removeChild(o)}return n},t}(),c=function(){function t(t,e){this.xo=e,this.vFb={},this.vFb=u.extend(this.vFb,t)}return t.prototype.render=function(){var t,e;return this.vFb.included?(t=this.wFb(),(e=this.xo.querySelector("."+this.vFb.className))===l&&((e=document.createElement("div")).classList.add(""+this.vFb.className),this.xo.appendChild(e)),void e.setAttribute("style",u.parseStyleObject(t))):l},t.prototype.setLength=function(t){this.vFb.length=t,this.render()},t.prototype.wFb=function(){return this.vFb.direction===i.LayoutDirection.vertical?{bottom:this.vFb.offset+"%",height:this.vFb.length+"%"}:{left:this.vFb.offset+"%",width:this.vFb.length+"%"}},t}(),f=function(){function t(t,e){this.xo=e,this.xFb={},this.xFb=u.extend(this.xFb,t)}return t.prototype.render=function(){var t,e,n,o,r=this.xo.querySelector("."+this.xFb.className);if(r===l){for((r=document.createElement("div")).className=""+this.xFb.className,e=0,n=(t=this.yFb()).length;e<n;e++)o=this.zFb(t[e]),r.appendChild(o);this.xo.appendChild(r)}},t.prototype.zFb=function(t){var e=document.createElement("span"),n=this.xFb.max-this.xFb.min,o=Math.abs(t-this.xFb.min)/n*100+"%",r=this.xFb.direction===i.LayoutDirection.vertical?{bottom:o}:{left:o};return e.classList.add(this.xFb.prefixCls+"-dot"),e.setAttribute("style",u.parseStyleObject(r)),e.setAttribute("key",""+t),e},t.prototype.yFb=function(){var t,e,n=Object.keys(this.xFb.marks).map((function(t){return+t}));if(n.sort((function(t,e){return t-e})),t=n,this.xFb.dots)for(e=this.xFb.min;e<=this.xFb.max;e+=this.xFb.step)-1===t.indexOf(e)&&t.push(e);return t},t}(),h=function(){function t(t,e){this.xo=t,this.AFb={},this.exb="",this.AFb=u.extend(this.AFb,e),this.exb='\n        <div class="'+this.AFb.prefixCls+"-tooltip "+this.AFb.prefixCls+'-tooltip-placement-top">\n            <div class="'+this.AFb.prefixCls+'-tooltip-content">\n                <div class="'+this.AFb.prefixCls+'-tooltip-arrow"></div>\n                <div class="'+this.AFb.prefixCls+'-tooltip-inner">{{value}}</div>\n            </div>\n        </div>\n        '}return t.prototype.render=function(t,e){var n,o,i,a,l;this.AFb.offset=t,n=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip"),o=new r.Formatter.GeneralFormatter(this.AFb.formatString).format(e),u.isEmpty(n)&&(i=s(o),this.exb=this.exb.replace(/{{value}}/,i),(a=document.createElement("div")).innerHTML=this.exb,this.xo.appendChild(a.firstElementChild),n=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip")),n.querySelector("."+this.AFb.prefixCls+"-tooltip-inner").textContent=o,l=this.BFb(o),n.setAttribute("style",u.parseStyleObject(l)),this.AFb.tooltipVisible?this.show():this.hide()},t.prototype.show=function(){var t=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");u.isEmpty(t)||(t.style.display="inline-block")},t.prototype.hide=function(){var t=this.xo.querySelector("."+this.AFb.prefixCls+"-tooltip");u.isEmpty(t)||(t.style.display="none")},t.prototype.BFb=function(t){var e=u.measureWidth(t,this.AFb.prefixCls+"-tooltip");return e=0===e?12:e/2+4,this.AFb.direction===i.LayoutDirection.vertical?{left:"-"+e+"px",bottom:"calc("+this.AFb.offset+"% + 10px)"}:{top:"-28px",left:"calc("+this.AFb.offset+"% - "+(e+4)+"px)"}},t}(),p=function(){function t(t,e){this.xo=e,this.CFb={},this.DFb=!1,this.EFb=l,this.CFb=u.extend(this.CFb,t),this.EFb=new h(this.xo,this.FFb())}return t.prototype.render=function(){var t,e=this,n=this.GFb(),o=this.BFb(),r=this.CFb.tabIndex||0;(this.CFb.disabled||r===l)&&(r=l),(t=this.xo.querySelector("."+this.CFb.className))===l&&((t=document.createElement("div")).className=n,this.xo.appendChild(t),t.setAttribute("role","slider"),t.setAttribute("aria-valuemin",""+this.CFb.min),t.setAttribute("aria-valuemax",""+this.CFb.max),t.setAttribute("aria-valuenow",""+this.CFb.value),t.setAttribute("aria-disabled",this.CFb.disabled+""),t.addEventListener("blur",(function(){e.HFb(!1)})),t.addEventListener("mouseenter",(function(){e.EFb.show()})),t.addEventListener("keydown",(function(){e.HFb(!1)})),t.addEventListener("mousedown",(function(){t.focus(),e.EFb.show()})),document.addEventListener("mouseup",(function(){document.activeElement===t&&(e.HFb(!0),e.EFb.hide())}))),t.tabIndex=r,t.setAttribute("style",u.parseStyleObject(o))},t.prototype.setOffset=function(t,e){this.CFb.offset=t,this.render(),this.EFb.render(t,e)},t.prototype.HFb=function(t){this.DFb=t},t.prototype.GFb=function(){return this.DFb?this.CFb.className+" "+this.CFb.prefixCls+"-handle-click-focused":""+this.CFb.className},t.prototype.BFb=function(){return this.CFb.direction===i.LayoutDirection.vertical?{bottom:this.CFb.offset+"%"}:{left:this.CFb.offset+"%"}},t.prototype.FFb=function(){return{prefixCls:"gc-slider",tooltipVisible:this.CFb.tooltipVisible,direction:this.CFb.direction,offset:this.CFb.offset,formatString:this.CFb.formatString}},t}(),d=function(){function t(t,e){this.xo=e,this.IFb={},this.IFb=u.extend(this.IFb,t)}return t.prototype.render=function(){var t,e,n,o,r,i=this.xo.querySelector("."+this.IFb.className);if(i===l){for((i=document.createElement("div")).className=""+this.IFb.className,t=this.JFb(),this.LJb(t),e=0,n=t.length;e<n;e++)o=t[e],(r=this.KFb(o))!==l&&i.appendChild(r);this.xo.appendChild(i)}},t.prototype.LJb=function(t){var e,n,o,r;for(this.MJb=0,e=1,n=t.length;e<n;e++)(o=this.IFb.marks[t[0]])&&(r=u.measureWidth(o.label,this.IFb.className+"-text"),(!this.MJb||this.MJb<r)&&(this.MJb=r))},Object.defineProperty(t.prototype,"maxWidth",{get:function(){return this.MJb},enumerable:!0,configurable:!0}),t.prototype.JFb=function(){return u.allKeys(this.IFb.marks).sort((function(t,e){return t-e}))},t.prototype.KFb=function(t){var e,n,o,r,i=this,a=this.IFb.marks[t],c=u.isObject(a)?a.label:a;return u.isEmptyObject(c)?l:(e=this.IFb.className+"-text",n=this.LFb(t),o=u.extend(n,a.style),(r=document.createElement("span")).classList.add(e),r.setAttribute("style",u.parseStyleObject(o)),r.setAttribute("key",""+t),r.addEventListener("mousedown",(function(e){i.IFb.onClickLabel(e,t)})),r.innerHTML=s(c),r)},t.prototype.LFb=function(t){var e=this.IFb.max-this.IFb.min;return this.IFb.direction===i.LayoutDirection.vertical?{"margin-bottom":"-50%",bottom:(t-this.IFb.min)/e*100+"%"}:{left:(t-this.IFb.min)/e*100+"%",transform:"translateX(-50%)"}},t}(),g=function(){function t(t,e,n,o){this.xo=t,this.MFb=e,this.NFb=n,this.$z=o,this.Tyb=l,this.OFb=l,this.Tyb=new f(this.PFb(),this.xo),this.OFb=new d(this.QFb(),this.xo)}return t.prototype.render=function(){var t=document.createElement("div");t.className=this.$z.prefixCls+"-rail",this.xo.appendChild(t),this.MFb.render(),this.Tyb.render(),this.NFb.render(),this.OFb.render(),this.OFb.maxWidth&&this.$z.direction===i.LayoutDirection.vertical&&(this.xo.style.paddingRight=this.OFb.maxWidth+"px")},t.prototype.calcValueByPosition=function(t){var e=t-this.RFb();return this.trimAlignValue(this.SFb(e))},t.prototype.trimAlignValue=function(t){return u.isEmpty(t)?l:this.TFb(t)},t.prototype.calcOffset=function(){return 100*(Math.max(this.$z.value-this.$z.min,0)/(this.$z.max-this.$z.min))},t.prototype.getKeyboardValueMutator=function(t){var e=this;switch(t.keyCode){case 38:case 39:return function(t){return e.calculateNextValue("increase",t)};case 40:case 37:return function(t){return e.calculateNextValue("decrease",t)};case 35:return function(t){return e.$z.max};case 36:return function(t){return e.$z.min}}},t.prototype.calculateNextValue=function(t,e){var n={increase:function(t,e){return t+e},decrease:function(t,e){return t-e}},o=Object.keys(this.$z.marks).indexOf(e+""),r=n[t](o,1),i=Object.keys(this.$z.marks)[r];return this.$z.step?n[t](e,this.$z.step):!u.isEmptyObject(this.$z.marks)&&this.$z.marks[i]?this.$z.marks[i]:e},t.prototype.TFb=function(t){var e=isFinite(this.UFb(t))?this.UFb(t):0;return this.$z.step===l?e:parseFloat(e.toFixed(this.Yrb()))},t.prototype.Yrb=function(){var t,e;if(a(this.$z.precision)){for(e in t=Math.max(v(this.$z.max),v(this.$z.min),v(this.$z.step)),this.$z.marks)t=Math.max(v(parseFloat(e)),t);this.$z.precision=t}return this.$z.precision},t.prototype.UFb=function(t){var e,n,o,r,i=Object.keys(this.$z.marks).map(parseFloat);return this.$z.step!==l&&(e=Math.ceil((this.$z.max-this.$z.min)/this.$z.step),n=Math.min((t-this.$z.min)/this.$z.step,e),o=Math.round(n)*this.$z.step+this.$z.min,i.push(Math.min(o,this.$z.max))),r=i.map((function(e){return Math.abs(t-e)})),i[r.indexOf(Math.min.apply(Math,r))]},t.prototype.PFb=function(){return{prefixCls:this.$z.prefixCls,className:this.$z.prefixCls+"-step",direction:this.$z.direction,marks:this.$z.marks,dots:this.$z.dots,step:this.$z.step,included:this.$z.included,max:this.$z.max,min:this.$z.min}},t.prototype.QFb=function(){var t=this;return{className:this.$z.prefixCls+"-mark",onClickLabel:this.$z.disabled?u.noop:function(e,n){t.VFb(e,n)},direction:this.$z.direction,marks:this.$z.marks,included:this.$z.included,max:this.$z.max,min:this.$z.min}},t.prototype.VFb=function(t,e){},t.prototype.RFb=function(){var t=this.xo.getBoundingClientRect();return this.$z.direction===i.LayoutDirection.vertical?t.top:t.left},t.prototype.WFb=function(){var t=this.xo.getBoundingClientRect();return this.$z.direction===i.LayoutDirection.vertical?t.height:t.width},t.prototype.SFb=function(t){var e=this.$z.min,n=this.$z.max,o=Math.abs(Math.max(t,0)/this.WFb());return this.$z.direction===i.LayoutDirection.vertical&&(o=Math.max(1-o,0)),o*(n-e)+e},t}(),m=function(t){function e(e,n){var r=t.call(this,e)||this;return r.MFb=l,r.NFb=l,r.XFb=l,r.YFb=function(t){u.pauseEvent(t),0===t.button&&(document.addEventListener("mouseup",r.ZFb,!1),document.addEventListener("pointerup",r.ZFb,!1),document.addEventListener("MSPointerUp",r.ZFb,!1),document.addEventListener("mousemove",r._Fb,!1),document.addEventListener("pointermove",r._Fb,!1),document.addEventListener("MSPointerMove",r._Fb,!1),r._Fb(t))},r._Fb=function(t){u.pauseEvent(t);var e=r.aGb(t);r.bGb!==e&&(r.setValue(e),r.$Fb.onChange(e))},r.ZFb=function(t){r._Fb(t),document.removeEventListener("mousemove",r._Fb),document.removeEventListener("mouseup",r.ZFb),document.removeEventListener("pointermove",r._Fb),document.removeEventListener("pointerup",r.ZFb),document.removeEventListener("MSPointerMove",r._Fb),document.removeEventListener("MSPointerUp",r.ZFb);var e=r.aGb(t);r.bGb=e,r.$Fb.onAfterChange(r.$Fb.value),r.fire(o.BaseDropdown.Event_ValueChanged,{value:e,text:""+e,notCloseDropDown:!0}),u.pauseEvent(t)},r.cGb=function(t){u.pauseEvent(t);var e=t.target||t.srcElement;document.addEventListener("touchend",r.dGb,!1),e.classList.contains(r.$Fb.prefixCls+"-handle")?document.addEventListener("touchmove",r.eGb,!1):r.eGb(t)},r.eGb=function(t){var e,n;u.pauseEvent(t),e=t.targetTouches[0],n=r.aGb(e),r.bGb!==n&&(r.setValue(n),r.$Fb.onChange(n))},r.dGb=function(t){var e,n;document.removeEventListener("touchmove",r.eGb),document.removeEventListener("touchend",r.dGb),e=t.changedTouches[0],n=r.aGb(e),r.bGb=n,r.$Fb.onAfterChange(r.$Fb.value),r.fire(o.BaseDropdown.Event_ValueChanged,{value:n,text:""+n,notCloseDropDown:!0}),u.pauseEvent(t)},r.init(n),r}return y(e,t),e.prototype.setValue=function(t){if(!this.$Fb.disabled){var e=parseFloat(t);isNaN(e)?e=this.$Fb.min:(e=Math.max(this.$Fb.min,e),e=Math.min(this.$Fb.max,e)),this.$Fb.value=e,this.bGb=this.$Fb.value,this.MFb.setLength(this.calcOffset()),this.NFb.setOffset(this.calcOffset(),e)}},e.prototype.calcOffset=function(){var t=Math.max(this.$Fb.value-this.$Fb.min,0)/(this.$Fb.max-this.$Fb.min);return 100*(t=Math.min(t,1))},e.prototype.setOptions=function(t){this.init(t)},e.prototype.init=function(t){var e,n;this.fGb(t),this.gGb(),this.qo.innerHTML="",(e=document.createElement("div")).className="gc-slider-container",this.qo.appendChild(e),this.$Fb.direction===i.LayoutDirection.vertical?(e.classList.add(this.$Fb.prefixCls+"-vertical"),e.style.height=this.$Fb.height+"px"):e.style.width=this.$Fb.width+"px",(n=document.createElement("div")).className=this.GFb(),e.appendChild(n),this.MFb=new c(this.hGb(),n),this.NFb=new p(this.iGb(),n),this.XFb=new g(n,this.MFb,this.NFb,this.jGb()),this.XFb.render(),this.QQ(n)},e.prototype.QQ=function(t){var e=this;this.$Fb.disabled||(t.addEventListener("mousedown",this.YFb),t.addEventListener("pointerdown",this.YFb),t.addEventListener("MSPointerDown",this.YFb),t.addEventListener("touchstart",this.cGb),t.addEventListener("keyup",(function(t){var n,r,i;if(u.pauseEvent(t),n=e.XFb.getKeyboardValueMutator(t),!u.isEmpty(n)){if(r=n(e.$Fb.value),(i=e.XFb.trimAlignValue(r))===e.$Fb.value)return;e.setValue(i),e.$Fb.onChange(i),e.$Fb.onAfterChange(i),e.fire(o.BaseDropdown.Event_ValueChanged,{value:i,text:""+i,notCloseDropDown:!0})}})))},e.prototype.aGb=function(t){return this.$Fb.direction===i.LayoutDirection.vertical?this.XFb.calcValueByPosition(t.clientY):this.XFb.calcValueByPosition(t.clientX)},e.prototype.sYa=function(){var t=function(t){};return{prefixCls:"gc-slider",dots:!1,range:!1,disabled:!1,max:100,min:0,step:1,value:0,direction:i.LayoutDirection.horizontal,included:!0,width:350,height:350,marks:{},tooltipVisible:!1,onChange:t,onAfterChange:t,formatString:"General"}},e.prototype.gGb=function(){(u.isEmpty(this.$Fb)||u.isEmptyObject(this.$Fb))&&(this.$Fb={}),this.$Fb=u.extend(this.sYa(),this.$Fb)},e.prototype.fGb=function(t){var e=this;t&&(a(t.scaleVisible)||(this.$Fb.dots=t.scaleVisible),a(t.direction)||(this.$Fb.direction=t.direction),a(t.formatString)||(this.$Fb.formatString=t.formatString),this.kGb(t.min,"min"),this.kGb(t.max,"max"),this.kGb(t.step,"step"),this.kGb(t.width,"width"),this.kGb(t.height,"height"),this.$Fb.step<=0&&(this.$Fb.step=1),this.$Fb.min>this.$Fb.max&&(this.$Fb.max=this.$Fb.min),a(t.tooltipVisible)||(this.$Fb.tooltipVisible=t.tooltipVisible),this.$Fb.marks={},t.marks&&t.marks.forEach((function(t){var n,o=parseFloat(t);isNaN(o)||o>=e.$Fb.min&&o<=e.$Fb.max&&(n=new r.Formatter.GeneralFormatter(e.$Fb.formatString),e.$Fb.marks[o]={label:n.format(o)})})))},e.prototype.kGb=function(t,e){if(!a(t)){var n=parseFloat(t);isNaN(n)||(this.$Fb[e]=n)}},e.prototype.hGb=function(){return{className:this.$Fb.prefixCls+"-track",included:this.$Fb.included,direction:this.$Fb.direction,offset:0,length:0}},e.prototype.iGb=function(){return{prefixCls:this.$Fb.prefixCls,className:this.$Fb.prefixCls+"-handle",direction:this.$Fb.direction,disabled:this.$Fb.disabled,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,offset:0,tabIndex:0,tooltipVisible:this.$Fb.tooltipVisible,formatString:this.$Fb.formatString}},e.prototype.jGb=function(){return{prefixCls:this.$Fb.prefixCls,min:this.$Fb.min,max:this.$Fb.max,value:this.$Fb.value,disabled:this.$Fb.disabled,direction:this.$Fb.direction,dots:this.$Fb.dots,step:this.$Fb.step,included:this.$Fb.included,marks:this.$Fb.marks}},e.prototype.GFb=function(){var t=""+this.$Fb.prefixCls;return this.$Fb.direction===i.LayoutDirection.vertical&&(t+="  "+this.$Fb.prefixCls+"-vertical"),u.isEmptyObject(this.$Fb.marks)||(t+=" "+this.$Fb.prefixCls+"-with-marks"),this.$Fb.disabled&&(t+=" "+this.$Fb.prefixCls+"-disabled"),t},e}(o.BaseDropdown),e.Slider=m},"./dist/plugins/celltype/editor/timepicker.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/listControl.js"),r=n("./dist/plugins/celltype/editor/baseControl.js"),i="undefined",a=n("Common"),s=a.Common.j.Fa,l=function(t){function e(e,n){var o=t.call(this,e)||this;return o.ad(),o.setOptions(n),o}return u(e,t),e.prototype.setOptions=function(t){var e,n,o,r;return t?(null!==(e=this.pGb(t.min))&&(this.$z.min=e),null!==(n=this.pGb(t.max))&&(this.$z.max=n),null!==(o=this.pGb(t.step))&&(this.$z.step=o),s(t.formatString)||(this.$z.formatString=t.formatString),s(t.height)||(r=parseInt(t.height,10),isNaN(r)||(this.$z.height=r)),this.$z.height=Math.max(1,this.$z.height),void this.VF()):void this.VF()},e.prototype.setValue=function(t){void 0!==t&&(this.KEb={hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()},this.cHb=t,this.wEb(),this.scrollToSelect())},e.prototype.scrollToSelect=function(){var t,e=this.tEb.querySelector(".selected");null!==e&&(t=e.offsetTop,this.xo.scrollTop=t)},e.prototype.ad=function(){var t=this;this.$z={min:{},max:{hour:23,minute:59,second:59},step:{hour:1},formatString:"hh:mm",height:200},this.tEb=document.createElement("div"),this.tEb.classList.add("gc-time-picker-outer-div"),this.tEb.addEventListener("click",(function(e){t.uEb(e)})),this.qo.appendChild(this.tEb)},e.prototype.pGb=function(t){var e,n,o,r=null;return s(t)||(r={},s(t.hour)||(e=parseInt(t.hour,10),isNaN(e)||(r.hour=e)),s(t.minute)||(n=parseInt(t.minute,10),isNaN(n)||(r.minute=n)),s(t.second)||(o=parseInt(t.second,10),isNaN(o)||(r.second=o))),r},e.prototype.VF=function(){this.tEb.innerHTML="",new o.List(this.tEb,this.qGb()),this.wEb()},e.prototype.wEb=function(){var t,e,n,o,r=this.tEb.querySelectorAll(".gc-time-picker-li");if(r.length>0)for(t=0;t<r.length;t++)r[t].classList.remove("selected"),e=+r[t].getAttribute("hour"),n=+r[t].getAttribute("minute"),o=+r[t].getAttribute("second"),this.rGb(this.KEb,{hour:e,minute:n,second:o})&&r[t].classList.add("selected")},e.prototype.qGb=function(){var t=this;return{items:function(){var e,n,o=t.sGb(),r=document.createElement("div");for(r.classList.add("gc-time-picker-container"),t.xo=r,t.$z.height<0?r.style.height="auto":r.style.maxHeight=t.$z.height+"px",(e=document.createElement("ul")).classList.add("gc-time-picker-ul"),n=0;n<o.length;n++)e.appendChild(t.tGb(o[n]));return 24*o.length>t.$z.height&&t.$z.height>=0?r.style.overflowY="scroll":r.style.overflowY="hidden",r.appendChild(e),r}}},e.prototype.tGb=function(t){var e=document.createElement("li");return e.classList.add("gc-time-picker-li"),e.setAttribute("hour",""+t.hour),e.setAttribute("minute",""+t.minute),e.setAttribute("second",""+t.second),e.innerText=this.uGb(t),e},e.prototype.sGb=function(){for(var t=this.vGb(this.$z.min),e=this.vGb(this.$z.max),n=[];t<=e;)n.push({hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds()}),t=this.wGb(t,this.$z.step);return n},e.prototype.wGb=function(t,e){return typeof e.hour!==i&&t.setHours(t.getHours()+e.hour),typeof e.minute!==i&&t.setMinutes(t.getMinutes()+e.minute),typeof e.second!==i&&t.setSeconds(t.getSeconds()+e.second),t},e.prototype.uGb=function(t){var e,n=new Date;return n.setHours(t.hour),n.setMinutes(t.minute),n.setSeconds(t.second),(e=new a.Formatter.GeneralFormatter(this.$z.formatString).format(n))&&""!==e&&null!==e?e:this.xGb(n)},e.prototype.xGb=function(t){var e=t.getHours(),n=t.getMinutes();return(e<12?"AM":"PM")+" "+(0===e||12===e?"12":""+e%12)+":"+(n<10?"0"+n:""+n)},e.prototype.vGb=function(t){var e=new Date;return e.setHours(t.hour||0),e.setMinutes(t.minute||0),e.setSeconds(t.second||0),e},e.prototype.rGb=function(t,e){return!(!t||!e)&&(t=this.yGb(t),e=this.yGb(e),t.hour===e.hour&&t.minute===e.minute&&t.second===e.second)},e.prototype.yGb=function(t){return{hour:t.hour||0,minute:t.minute||0,second:t.second||0}},e.prototype.uEb=function(t){var e,n,o,i,s,l,u=t.target;u&&(e=+u.getAttribute("hour"),n=+u.getAttribute("minute"),o=+u.getAttribute("second"),(i=this.cHb||new Date).setHours(e),i.setMinutes(n),i.setSeconds(o),i.setMilliseconds(0),s=a.Common.CultureManager.q4().DateTimeFormat," h:mm:ss",l=new a.Formatter.GeneralFormatter(s.shortDatePattern+" h:mm:ss").format(i),this.fire(r.BaseDropdown.Event_ValueChanged,{value:i,text:l}),this.KEb={hour:e,minute:n,second:o},this.wEb())},e}(r.BaseDropdown),e.TimePicker=l},"./dist/plugins/celltype/editor/workflowPicker.js":function(t,e,n){"use strict";var o,r,i,a,s,l=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/celltype/editor/baseControl.js"),r=n("./dist/plugins/celltype/editor/listControl.js"),i=n("Common"),a=i.Common.j.Fa,s=function(t){function e(e,n){var i=t.call(this,e)||this;return i.FP=new r.List(e),i.FP.on(o.BaseDropdown.Event_ValueChanged,(function(t){i.fire(o.BaseDropdown.Event_ValueChanged,t)})),i.setOptions(n),i}return l(e,t),e.prototype.setOptions=function(t){this.$z=t},e.prototype.setValue=function(t){if(this.$z){var e=function(t,e){var n,o,r={items:[]},i=t.items,s=i.filter((function(t){return t.value===e}))[0];if(a(s)&&i&&i.length>0)r.items.push({text:i[0].value,value:i[0].value});else if(s&&s.transitions&&s.transitions.length>0)for(n=function(t){var e,n=s.transitions[t];"number"==typeof n&&i[n]&&(n=i[n].value),(e=i.filter((function(t){return t.value===n}))[0])&&r.items.push({text:e.value,value:e.value})},o=0;o<s.transitions.length;o++)n(o);return r}(this.$z,t);this.FP.setOptions(e)}},e.prototype.updateStyle=function(t,e,n){this.FP.updateStyle(t,e,n)},e}(o.BaseDropdown),e.WorkFlow=s},"./dist/plugins/celltype/hyperlinkcelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function R(t,e,n,o,r,i){var a=0,s=0,l=t.width,u=t.height;return a=i=i||0,1===o?a=(l-e)/2:2===o&&(a=l-e-i),1===r?s=(u-n)/2:2===r&&(s=u-n),{x:a,y:s}}function k(t,e,n,o){var r=N(t,n),i=r.width;return i+=1==(1!==e&&!u(o))?o:0,r.width=i,r}function M(t,e,n,o,r,i){var a=N(t,o),s=R(r,a.width,a.height,e,n,i);return a.x=s.x,a.y=s.y,a}function N(t,e){var n=f(e);return{x:0,y:0,width:Math.max(0,r.Vn.Xn(t,e,!0)),height:t.split(/\r\n|\r|\n/).length*n}}function E(t,e,n,o,i,a){var s,l,c,f,h,p,d,g,m,y,C,b=i.sheet,w=b.yl;if(u(n))return!1;if(a||(s=b.getValue(i.row,i.col,i.sheetArea),u(s)||(a=s+"")),!a)return!1;for(o=n.cellType.f5(o,n),a=a.replace(/\s+/g," "),l=n&&n.font?n.font:w.Bl(),l=w.Cl(l),c=[a],f=D(n),n.wordWrap&&(a=(c=r.Vn.Wn(a,o.width-3-f,l)).join("\r\n")),h=M(a,n.hAlign,n.vAlign,l,o,f),p=o.y+h.y,d=0;d<c.length;d++)if(g=M(c[d],n.hAlign,n.vAlign,l,o,f),m=o.x+g.x,y=v(m+g.width,o.x+o.width),p=v((C=p)+g.height,o.y+o.height),m<=t&&t<y&&C<=e&&e<p)return!0;return!1}function D(t){return 8*(t.textIndent||0)}function O(t,e,n,o,i){var s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T=o&&o.sheet;if(T){if(u=T.yl,c=e.font||u.Bl(),n>1&&(c=u.Cl(c)),f=D(e),e.wordWrap||i){if(e.wordWrap){if(h=o.row,p=o.col,d=o.sheetArea,g=0,m=T.ITa.findSpan(h,p,d)){if(m.row>=h&&m.rowCount<=1&&m.col>=p&&p===m.col&&(g=T.Tl(p),m.colCount>1))for(y=p+1;y<p+m.colCount;y++)g+=T.Tl(y)}else g=T.Tl(p);if(s=a(e,1),(l=a(e,3))>0&&(g-=l),s>0&&(g-=s),v=r.Vn.Wn(t,g-3-f,c),i&&t.split(/\r\n|\r|\n/).length>1){for(C=0,b=0;b<v.length;b++)C=Math.max(C,k(v[b],e.hAlign,c,D(e)).width);return C}i||(t=v.join("\r\n"))}}else t=t.replace(/\s+/g," ");return w=k(t,e.hAlign,c,D(e)),i?w.width:w.height}return 0}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),i=(r=n("Core")).CellTypes.Context,a=i.u5,s=r.CellTypes.Base,l=r.Ul.Nl,u=o.Common.j.Fa,c=o.Common.u.BIc,f=r.Ul.fp,h=r.Ul.Ml,p=h.mozilla,d=r.GC$,g=d.each,m=null,y=Math.max,v=Math.min,C=Math.floor,b=window.open,w="left",T="default",x="hyperlinkInfo",function(t){t[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top"}(e.HyperLinkTargetType||(e.HyperLinkTargetType={})),S={linkColor:"#0066cc",visitedLinkColor:"#3399ff",text:"",linkToolTip:"",target:0,activeOnClick:!0},A=function(t){function e(){var e,n=t.call(this)||this;return n.typeName="8",e=n,n.yn=n.wK(),g(S,(function(t,n){e["_"+t]=n})),n._onAction=function(t){var e=t&&t.sheet,n=t.row,o=t.col,r=t.sheetArea,i=e.getValue(n,o,r),a=function(t){return["_blank","_self","_parent","_top"][t]}(this._target);i&&b(c(i),a)},n}return I(e,t),e.prototype.wK=function(){var t,e;return u(this.yn)&&(this.yn="0"),e="id_"+(t=parseInt(this.yn,10)),t++,this.yn=t+"",e},e.prototype.Eka=function(t,e,n,o,r,i,a,s,l,u){var c,f,d,g,m,y,v,b,T,x=1,S=w,A=a.hAlign,I=a.vAlign,R=s.lineHeight,k=l.length;for(x+=e,1===A?(x=r/2,S="center"):2===A&&(x=r-1,x-=e,S="right"),t.textAlign!==S&&(t.textAlign=S),c=1,f="alphabetic",c+=R-(m=R/2-(d=parseInt(s.fontInfo.fontSize,10))/2+(g=d>8?C((d-8)/5+2):1)-1),1===I?R<i&&(c=p?(i-u)/2+1:h.msie?(i-u)/2+.5:(i-u)/2,C(c)!==c&&(c+=.5),c+=R/2-m):2===I&&(c=i-u-2.5-m),t.textBaseline!==f&&(t.textBaseline=f),y=o+c,v=0;v<k;v++)t.fillText(l[v],n+x,y),b=t.measureText(l[v]).width,(T=a.textDecoration)&&this.ip(t,T,n+x,y,b,d,g),y+=R},e.prototype.Fka=function(t,e,n,o,i,a,s,l,u){var c,f,h,p,d,g,m,v=s.hAlign,b=s.vAlign,w=l.lineHeight,T=u.length,x=0,S=0,A=0,I=0;for(2!==v&&(A=1),2===s.vAlign&&(I=-2.5),I-=y(0,Math.round(w/9)-1),t.strokeStyle!==t.fillStyle&&(t.strokeStyle=t.fillStyle),d=l.fontInfo.fontSize,g=C((d-12)/21+1),t.lineWidth=g,t.beginPath(),m=0;m<T;m++)c=t.measureText(u[m]).width,h=(f=A+n+(p=R(new r.Rect(n,o,i,a),c,w*T,v,b,e)).x)+c,x=I+o+p.y+w,C(x)===x&&(x+=.5),S=x,t.moveTo(f,x),t.lineTo(h,S),t.stroke(),I+=w},e.prototype.paintValue=function(t,e,n,o,i,a,s,l){var c,f,h,p,d,g,m,y,v,C,b,w,T,S,A,I,R=this;if(t&&(c=R.getText(e,l),!u(c))){for(f=(c+="").split(/\r\n|\r|\n/),h=0;h<f.length;)f[h]=f[h].replace(/\s+/g," "),h++;c=f.join("\r\n"),p=!1,d=l.sheet.ITa,g=l.row,m=l.col,y=l.sheetArea,(v=d.getValueForKey(g,m,x,y))&&(R.yn===v.id?p=v.visited:d.do("setValueForKey",g,m,x,void 0,y)),t.save(),t.beginPath(),(C=p?R._visitedLinkColor:R._linkColor)&&t.fillStyle!==C&&(t.fillStyle=C),(b=s.font)&&t.font!==b&&r.Ul.lZa(t,b),w=D(s),l.sheet.outlineColumn&&l.sheet.outlineColumn.XQa(l.col)&&(w=0),T=[],S=0,A=0,s.wordWrap?(I=i-3-w,I-=1,(S=(T=r.Vn.Wn(c,I,b)).length)>1&&0!==s.vAlign&&(A=(S-1)*l.lineHeight)):T.push(c),t.rect(n,o,i,a),t.clip(),t.beginPath(),R.Eka(t,w,n,o,i,a,s,l,T,A),R.Fka(t,w,n,o,i,a,s,l,T),t.restore()}},e.prototype.getText=function(t,e){return this._text||t},e.prototype.tw=function(t,e,n,o){if(!t.HF){var r=t.parent;r&&r.tw(t,e,n,o)}},e.prototype.getHitInfo=function(t,e,n,o,r){var i;return r&&(i=r.sheetArea,(u(i)||3===i)&&n&&o)?{x:t,y:e,row:r.row,col:r.col,cellStyle:n,cellRect:o,sheetArea:i,isFocusAware:!0,sheet:r.sheet,isReservedLocation:E(t,e,n,o,r,this._text)}:m},e.prototype.processMouseDown=function(t){var e=t&&t.sheet;e&&!e.isEditing()&&t.isReservedLocation&&(this.AK=!0)},e.prototype.processMouseUp=function(t){var e,n=t&&t.sheet;n&&!n.isEditing()&&(e=this,t.isReservedLocation&&e.AK&&e.Eia(t),e.AK=!1)},e.prototype.processMouseMove=function(t){var e,n=t.row,o=t.col,r=t.sheet;!r||r.isEditing()&&r.getActiveRowIndex()===n&&r.getActiveColumnIndex()===o||(e=r.Ws(),t.isReservedLocation?e&&(this.BK(r,t),e.style.cursor="pointer"):(this.CK(r),e&&(e.style.cursor=T)))},e.prototype.processMouseLeave=function(t){var e,n=t.sheet;this.AK=!1,this.CK(n),n&&((e=n.Ws())&&(e.style.cursor=T))},e.prototype.BK=function(t,e){var n,o,r,i,a,s,l=this;l._linkToolTip&&(n=l.DK(),(o=d(n)).text(l._linkToolTip),i=(r=t.mm.bG()).left+e.x,a=r.top+e.y+20,0===o.parent().length&&((s=t&&t.zo())&&s.insertBefore(n,m),o.css("top",a).css(w,i)))},e.prototype.CK=function(t){var e,n=this;n.EK&&((e=t&&t.zo())&&n.EK.parentElement===e&&function(t,e){t.removeChild(e)}(e,n.EK),n.EK=m)},e.prototype.DK=function(){var t,e=this;return e.EK||(t=l("div"),d(t).css("position","absolute").css("margin",0).css("padding",2).css("border","1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("box-sizing","content-box").css("background-color","white").css("font","9pt Arial"),e.EK=t),e.EK},e.prototype.isReservedKey=function(t,e){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},e.prototype.processKeyUp=function(t,e){return!!e.sheet&&(this.Eia(e),!0)},e.prototype.getAutoFitWidth=function(t,e,n,o,r){return O(this._text||t,n,o,r,!0)},e.prototype.getAutoFitHeight=function(t,e,n,o,r){return O(this._text||t,n,o,r)},e.prototype.isImeAware=function(t){return!1},e.prototype.Eia=function(t){var e=t&&t.sheet,n=this,o=t.row,r=t.col,i=t.sheetArea;n.onClickAction().call(this,t),e.ITa.do("setValueForKey",o,r,x,{id:n.yn,visited:!0},i),e.repaint(e.getCellRect(o,r)),n.tw(e,o,r,i)},e.prototype.onClickAction=function(t){return 0===arguments.length?this._onAction:(t&&(this._onAction=t),this)},e.prototype.toJSON=function(){var t,e=this,n={typeName:e.typeName};return g(S,(function(o,r){(t=e["_"+o])!==r&&(n[o]=t)})),n},e.prototype.fromJSON=function(t){var e=this;g(S,(function(n){var o=t[n];u(o)||(e["_"+n]=o)}))},e.prototype.a5=function(t){},e.prototype.gQa=function(){var t,n=this,o=new e;return g(S,(function(e,r){(t=n["_"+e])!==r&&(o["_"+e]=t)})),o._onAction=n._onAction,o},e}(s),e.HyperLink=A,g(S,(function(t){A.prototype[t]=function(e){return 0===arguments.length?this["_"+t]:(this["_"+t]=e,this)}})),r.CellTypes._o[8]=A},"./dist/plugins/celltype/radiochecklistcelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function D(t,e){return t.hasOwnProperty(e)}function O(t,e){return t instanceof Date&&e instanceof Date?a(t)===a(e):!p(t)&&!p(e)&&t.toString&&e.toString?""+t==""+e:t===e}function j(t,e,n,o,r){var i=e.zoom(),a=t.icon_size*i,s=_(t,n),u=l(s,a),c=o;return t._items.length<o&&(c=t._items.length),u*c+t._itemSpacing.vertical*i*(c-1)}function F(t,e,n,o,r){var i=t.icon_size*e.zoom(),a=t.defaultPadding*e.zoom(),s=P(t,e,n,o,r),l=0;return s.forEach((function(t){l+=t})),l+=r*(i+a)+(r-1)*t._itemSpacing.horizontal*e.zoom()}function P(t,e,n,o,r){var i,a,l,u,c,f=[];for(i=0;i<t._items.length;i++)a=D(t._items[i],C)?t._items[i].text:t._items[i],l=e.dp(a,n.font),(u=t.dHb()).hasMagin&&(l=l+u.paddingLeft+u.paddingRight),c=s(i%r),t._direction===T.vertical&&(c=s(i/o)),f[c]===h?f[c]=l:f[c]=Math.max(f[c],l);return f}function _(t,e){var n=v(e.font),o=t.dHb();return o.hasMagin&&(n=n+o.paddingTop+o.paddingBottom),n}function L(t,e,n,o){var r=H(t)*n,i=r;return 1===t.hAlign?i=(e.width-o)/2:2===t.hAlign&&(i=e.width-r-o),i}function B(t,e,n,o){var r=2;return 1===t.vAlign?e.height-2>o&&(r=(e.height-o-2)/2+2):2===t.vAlign&&(r=e.height-o-2),r}function G(t,e,n,o,r){var i,a;if(t._direction===T.vertical){if(t._isFlowLayout){if(r!==h)for(i=t._items.length;i>0;){if(!(j(t,e,n,i,u(t._items.length/i))>r))return[i=l(i,1),u(t._items.length/i)];i-=1}return[t._items.length,1]}return[i=l(1,t._maxRowCount),u(t._items.length/i)]}if(t._isFlowLayout){if(o!==h)for(a=t._items.length;a>0;){if(!(F(t,e,n,u(t._items.length/a),a)>o))return a=l(a,1),[u(t._items.length/a),a];a-=1}return[1,t._items.length]}return a=l(1,t._maxColumnCount),[u(t._items.length/a),a]}function H(t){var e=t.textIndent;return 1===t.hAlign||0===e||e===f||e===h?2:8*e}function V(t,e){var n,r,i=e.cellRect.width,a=e.cellRect.height,u=e.sheet,c=G(t,e.sheet,e.cellStyle,i-1,a),f=c[0],h=c[1],p=P(t,e.sheet,e.cellStyle,f,h),d=t.icon_size*u.zoom(),g=t.defaultPadding*u.zoom(),m=l(_(t,e.cellStyle),d),y=F(t,u,e.cellStyle,f,h),v=j(t,u,e.cellStyle,f),w=L(e.cellStyle,e.cellRect,u.zoom(),y),S=B(e.cellStyle,e.cellRect,u.zoom(),v),A=function(n){var r,i,a,l,c,y=D(t._items[n],C)?t._items[n].text:t._items[n],v=u.dp(y,e.cellStyle.font),A=s(n/h),I=n%h;if(t._direction===T.vertical&&(A=n%f,I=s(n/f)),r=new o.Rect,i=0,p.filter((function(t,e){return e<I})).forEach((function(t){i+=t})),r.x=w+i+I*(d+g+t._itemSpacing.horizontal*u.zoom()),r.y=S+A*m+t._itemSpacing.vertical*u.zoom()*A,a=t.dHb(),r.width=(t._textAlign!==x.right||a.hasMagin?p[I]:v)+d+g,r.height=m,l=e.x-e.cellRect.x,c=e.y-e.cellRect.y,r&&r.contains(l,c))return{value:{value:D(t._items[n],b)?t._items[n].value:t._items[n]}}};for(n=0;n<t._items.length;n++)if("object"==typeof(r=A(n)))return r.value}function z(t,e){var n,o=!1,r=D(t,b)?t.value:t;if(e!==f)if(Array.isArray(e)){for(n=0;n<e.length;n++)if(O(e[n],r)){o=!0;break}}else o=O(e,r);return o}function W(t,e,n,o){var r,i,a,s;if(o)return e;for(t===f&&(t=[]),Array.isArray(t)||(t=[t]),r={},n.forEach((function(t){r[D(t,b)?t.value:t]=!0})),i=t.length-1;i>=0;i--)r[t[i]]||t.splice(i,1);if(-1===(a=t.slice()).indexOf(e))a.push(e);else for(i=a.length-1;i>=0;i--)O(a[i],e)&&a.splice(i,1);return s=[],n.forEach((function(t){-1!==a.indexOf(t.value)&&s.push(t.value)})),s}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=r.Common.j.C4,a=r.Common.l.Ra,s=Math.floor,l=Math.max,u=Math.ceil,c="alphabetic",f=null,h=void 0,p=r.Common.j.Fa,d=o.Ul.lZa,g=o.CellTypes.Base,m=o.GC$,y=m.each,v=o.Ul.fp,C="text",b="value",w="number",function(t){t[t.horizontal=0]="horizontal",t[t.vertical=1]="vertical"}(T=e.Direction||(e.Direction={})),function(t){t[t.left=2]="left",t[t.right=3]="right"}(x=e.TextAlign||(e.TextAlign={})),S={items:f,direction:T.horizontal,maxColumnCount:1,maxRowCount:1,isFlowLayout:!0,itemSpacing:{horizontal:20,vertical:5},textAlign:x.right},A=function(t){function e(){var e,n=t.call(this)||this;return n.typeName="11",n.icon_size=12,n.defaultPadding=5,e=n,y(S,(function(t,n){"items"===t&&(n=[]),e["_"+t]=n})),n}return E(e,t),e.prototype.paintValue=function(t,e,n,r,i,a,u,c){var f,h,p,g,m,y,b,w,S,A,I,R,k,M,N,E,O,H,V,z,W,U,q,Y,X,Z,Q,J,$=this;if(t){for(t.save(),t.rect(n+1,r+1,i-2,a-2),t.clip(),t.beginPath(),f=0,0,p=(h=c.sheet).zoom(),g=$.icon_size*p,m=$.defaultPadding*p,y=g/2,b=new o.Rect(n+1,r+1,i-2,a-2),I=F($,h,u,S=(w=G($,h,u,i-2,a-2))[0],A=w[1]),R=j($,h,u,S,A),k=P($,h,u,S,A),M=_($,u),N=n+L(u,b,p,I),E=r+B(u,b,p,R),(O=u.font)&&t.font!==O&&d(t,c.fontInfo.font),u.foreColor&&(t.fillStyle=u.foreColor),H=u.textDecoration,z=(V=c.fontInfo.fontSize)>8?s((V-8)/5+2):1,0,W=v(u.font)/2-V/2+z-1,U=N,q=E,Y=0;Y<$._items.length;Y++)N>n+i||E>r+a||(X=D($._items[Y],C)?$._items[Y].text:$._items[Y],f=h.dp(X,u.font),t.textAlign="left",Z=$._direction===T.vertical?k[s(Y/S)]:k[Y%A],Q=0,$._textAlign===x.left?($.zGb(t,$._items[Y],e,f,N,E,Z,M,W),N=N+Z+m,t.save(),$.AGb(t,e,$._items[Y],N,E+M-W-g,y),t.restore(),Q=g):(t.save(),$.AGb(t,e,$._items[Y],N,E+M-W-g,y),N=N+g+m,t.restore(),$.zGb(t,$._items[Y],e,f,N,E,Z,M,W),Q=Z),H&&(J=this.dHb(),$.ip(t,H,N-($._textAlign===x.right?0:Z+m)+J.paddingLeft,E+M-W-J.paddingBottom,f,V,z)),$._direction===T.vertical?(E+=l(M,g)+$._itemSpacing.vertical*p,(Y+1)%S==0&&(U=U+Z+g+m+$._itemSpacing.horizontal*p,E=r+B(u,b,p,R)),N=U):(N=N+Q+$._itemSpacing.horizontal*p,(Y+1)%A==0&&(N=n+L(u,b,p,I),q=q+l(M,g)+$._itemSpacing.vertical*p),E=q));t.restore()}},e.prototype.getText=function(t,e){return t},e.prototype.zGb=function(t,e,n,o,r,i,a,s,l){var u=D(e,C)?e.text:e;t.textBaseline!==c&&(t.textBaseline=c),t.fillText(u,r,i+s-l)},e.prototype.getItemsBound=function(t,e,n,r){var i,a,u,c,f,h,p,d,g,m,y,v,b,w,S,A,I,R,k,M=this,N=t.zoom(),E=t.getActualStyle(e,n,r),O=o.To.No("11pt "+t.currentTheme().bodyFont(),N);for(E.font&&(O=o.To.No(E.font,N)),E.font=O.font,i=1===r?-1:void 0,a=2===r?-1:void 0,c=(u=t.getCellRect(e,n,i,a)).width,f=u.height,h=G(M,t,E,c-1,f),p=h[0],d=h[1],g=P(M,t,E,p,d),m=M.icon_size*t.zoom(),y=M.defaultPadding*t.zoom(),v=l(_(M,E),m),b=F(M,t,E,p,d),w=j(M,t,E,p,d),S=L(E,u,t.zoom(),b),A=B(E,u,t.zoom(),w),I=[],R=function(e){var n,r,i,a=D(M._items[e],C)?M._items[e].text:M._items[e],l=t.dp(a,E.font),c=s(e/d),f=e%d;M._direction===T.vertical&&(c=e%p,f=s(e/p)),n=new o.Rect,r=0,g.filter((function(t,e){return e<f})).forEach((function(t){r+=t})),n.x=S+r+f*(m+y+M._itemSpacing.horizontal*t.zoom())+u.x,n.y=A+c*v+M._itemSpacing.vertical*t.zoom()*c+u.y,i=M.dHb(),n.width=(M._textAlign!==x.right||i.hasMagin?g[f]:l)+m+y,n.height=v,n.x>u.x+u.width||n.y>u.y+u.height?I[e]=null:I[e]=n},k=0;k<M._items.length;k++)R(k);return I},e.prototype.AGb=function(t,e,n,o,r,i){},e.prototype.dHb=function(){return{hasMagin:!1,paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}},e.prototype.getAutoFitWidth=function(t,e,n,o,r){var i=r&&r.sheet,a=H(n),s=G(this,i,n);return(F(this,i,n,s[0],s[1])+a)/i.zoom()},e.prototype.getAutoFitHeight=function(t,e,n,o,r){var i=r&&r.sheet,a=G(this,i,n);return j(this,i,n,a[0],a[1])/i.zoom()},e.prototype.getHitInfo=function(t,e,n,r,i){var a,s,l,u,c,h,d,g,m,y,v=this;return i?(r=n.cellType.f5(r,n),a=i.sheetArea,s=i.sheet,(p(a)||3===a)&&r?(l={x:t,y:e,row:i.row,col:i.col,cellStyle:n,cellRect:r,sheetArea:a,sheet:s},n.font&&(n.font=o.To.No(n.font,s.zoom()).font),d=F(v,s,n,c=(u=G(v,s,n,r.width-1,r.height-2))[0],h=u[1]),g=j(v,s,n,c,h),m=r.x+L(n,r,s.zoom(),d),y=r.y+B(n,r,s.zoom(),g),new o.Rect(m,y,d,g).contains(l.x,l.y)&&(l.isReservedLocation=!0),l):f):f},e.prototype.processMouseDown=function(t){return!!t&&void(t.isReservedLocation&&(this.uK=!0))},e.prototype.processMouseLeave=function(e){return t.prototype.processMouseLeave.call(this,e),!!e&&void(this.uK=!1)},e.prototype.processMouseUp=function(t){var e,n,o,r,i,a;return!!t&&(e=this,n=t.sheet,!!(e.uK&&n&&t.isReservedLocation&&(e.uK=!1,o=t.row,r=t.col,i=t.sheetArea,a=V(e,t)))&&(function(t,e,n,o,r,i){var a=e.getValue(n,o,i),s=t.rK(a,r),l={cmd:"editCell",sheetName:e.name(),row:n,col:o,newValue:s,autoFormat:!0};e.wu().execute(l),t.triggerButtonClicked(e,n,o,i)}(e,n,o,r,a.value,i),!0))},e.prototype.rK=function(t,e){return W(t,e,this._items,!0)},e.prototype.triggerButtonClicked=function(t,e,n,o){var r=t.parent;r&&r.tw(t,e,n,o)},e.prototype.toJSON=function(){var t,e=this,n={typeName:e.typeName};return y(S,(function(o,r){t=e["_"+o],("items"===o?t&&t.length>0:t!==r)&&(n[o]="object"==typeof t?i(t):t)})),n},e.prototype.fromJSON=function(t){var e=this;y(S,(function(n){var o=t[n];p(o)||(e["_"+n]=o)}))},e}(g),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return E(e,t),e.prototype.AGb=function(t,e,n,o,r,i){var a=D(n,b)?n.value:n;t.beginPath(),t.fillStyle="white",t.arc(o+i,r+i,i,0,2*Math.PI),t.fill(),t.beginPath(),t.strokeStyle="black",t.arc(o+i,r+i,i,0,2*Math.PI),t.stroke(),e!==f&&O(e,a)&&(t.beginPath(),t.strokeStyle="black",t.arc(o+i,r+i,.5*i,0,2*Math.PI),t.fillStyle="black",t.fill(),t.stroke())},e}(A),e.RadioButtonList=I,R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.typeName="12",e}return E(e,t),e.prototype.AGb=function(t,e,n,o,r,i){t.strokeStyle="black",t.strokeRect(o+.5,r+.5,2*i+.05,2*i+.05),t.fillStyle="white",t.fillRect(o+1,r+1,2*i-1,2*i-1);var a=z(n,e);e!==f&&a&&(t.beginPath(),t.lineWidth=2.5,t.moveTo(o+3,r+i),t.lineTo(o+i,r+2*i-3.5),t.lineTo(o+2*i-1.5,r+3),t.stroke())},e.prototype.rK=function(t,e){return W(t,e,this._items,!1)},e}(A),e.CheckBoxList=R,function(t){t[t.single=0]="single",t[t.multiple=1]="multiple"}(k=e.SelectionMode||(e.SelectionMode={})),M={selectedBackColor:"rgb(227,119,0)",selectedForeColor:"white",padding:"5",items:f,itemSpacing:{horizontal:5,vertical:5},selectionMode:k.multiple},N=function(t){function e(){var e,n=t.call(this)||this;return n.typeName="13",n.icon_size=0,n.defaultPadding=0,e=n,y(M,(function(t,n){"items"===t&&(n=[]),e["_"+t]=n})),n}return E(e,t),e.prototype.zGb=function(t,e,n,o,r,i,a,s,l){var u,f,h,p,d;t.save(),t.beginPath(),u=z(e,n),f=D(e,C)?e.text:e,h=this._selectedBackColor,p=this._selectedForeColor,u&&(t.fillStyle=h,t.fillRect(r+1,i+1,a-1,s-1),t.fillStyle=p),t.textAlign="center",t.textBaseline!==c&&(t.textBaseline=c),d=this.dHb(),t.fillText(f,r+d.paddingLeft+(a-d.paddingLeft-d.paddingRight)/2,i+d.paddingTop+s-d.paddingTop-d.paddingBottom-l),t.restore()},e.prototype.rK=function(t,e){return W(t,e,this._items,this._selectionMode===k.single)},e.prototype.dHb=function(){var t,e=0,n=0,o=0,r=0;return this._padding&&(t=function(t){var e,n,o,r,i=["0","0","0","0"];return"string"==typeof t&&(o=void 0,r=void 0,1===(n=(e=t.split(" ",4)).length)?i=[o=e[0],o,o,o]:2===n?i=[o=e[0],r=e[1],o,r]:3===n?(r=e[1],i=[e[0],r,e[2],r]):4===n&&(i=[e[0],e[1],e[2],e[3]])),i}(this._padding),e=typeof(e=parseInt(t[0],10))===w&&e>0?e:0,r=typeof(r=parseInt(t[1],10))===w&&r>0?r:0,n=typeof(n=parseInt(t[2],10))===w&&n>0?n:0,o=typeof(o=parseInt(t[3],10))===w&&o>0?o:0),{hasMagin:!0,paddingTop:e,paddingBottom:n,paddingLeft:o,paddingRight:r}},e.prototype.toJSON=function(){var e,n=this,o=t.prototype.toJSON.call(this);return y(M,(function(t,r){e=n["_"+t],("items"===t?e&&e.length>0:e!==r)&&(o[t]="object"==typeof e?i(e):e)})),o},e.prototype.fromJSON=function(e){t.prototype.fromJSON.call(this,e);var n=this;y(M,(function(t){var o=e[t];p(o)||(n["_"+t]=o)}))},e}(A),e.ButtonList=N,y(S,(function(t){A.prototype[t]=function(e){var n,o,r,i,a,s,l="_"+t;if(0===arguments.length)return this[l];if("items"===t){for(n=[],o=0;o<e.length;o++)r=e[o],p(r.text)||p(r.value)?p(r.text)?p(r.value)?p(r)||"object"==typeof r||n.push({text:r,value:r}):(r.text=r.value,n.push(r)):(r.value=r.text,n.push(r)):n.push(r);e=n}return"itemSpacing"===t?(i=this[l],this[l]={horizontal:i.horizontal,vertical:i.vertical},p(e.horizontal)||(a=parseInt(e.horizontal,10),isNaN(a)||(this[l].horizontal=a)),p(e.vertical)||(s=parseInt(e.vertical,10),isNaN(s)||(this[l].vertical=s))):this[l]=e,this}})),o.CellTypes._o[11]=I,o.CellTypes._o[12]=R,y(M,(function(t){N.prototype[t]=function(e){var n,o,r,i,a,s,l="_"+t;if(0===arguments.length)return this[l];if("items"===t){for(n=[],o=0;o<e.length;o++)r=e[o],p(r.text)||p(r.value)?p(r.text)?p(r.value)?p(r)||"object"==typeof r||n.push({text:r,value:r}):(r.text=r.value,n.push(r)):(r.value=r.text,n.push(r)):n.push(r);e=n}return"itemSpacing"===t?(i=this[l],this[l]={horizontal:i.horizontal,vertical:i.vertical},p(e.horizontal)||(a=parseInt(e.horizontal,10),isNaN(a)||(this[l].horizontal=a)),p(e.vertical)||(s=parseInt(e.vertical,10),isNaN(s)||(this[l].vertical=s))):this[l]=e,this}})),o.CellTypes._o[13]=N},"./dist/plugins/celltype/rangecelltype.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function p(t){return t.map((function(t){return{start:t.start,size:t.size}}))}function d(t,e,n,r,i,a){var u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z=e.x,Q=e.y,J=e.width,$=e.height,K=r.sheet,tt=r.sheetArea,et=r.isPrinting,nt=r.needTopGridline,ot=r.needLeftGridline,rt=[],it=[],at=K.vu(),st=a.rowCount,lt=a.colCount,ut=a.rowSize,ct=a.colSize,ft=a.cellStyleList,ht=a.sparklines;for(i.$Jb(n),c=(u=i.cKb()).baseRow,f=u.baseCol,p=(h=i.UJb).Pm,h.Us(new o.Rect(0,0,J,$)),d=new o.AF(h,h.Gr(1,3),h.Hr(1,3),3),g=i.dKb(!0),Q+=1,$-=1,Z+=1,J-=1,m=0,y=0,ut=ut.map((function(t){var e=t.size*$,n=l(e);return(y+=e-n)>=1&&(n++,y--),{start:l(t.start*$),size:n}})),ct=ct.map((function(t){var e=t.size*J,n=l(e);return(m+=e-n)>=1&&(n++,m--),{start:l(t.start*J),size:n}})),v=h.conditionalFormats,C=0;C<st;C++)for(b=0;b<lt;b++)if(ft[C][b]){if(T=(w=ft[C][b]).style,x=w.isSpan,S=w.span,A=!1,I=g[C][b],x&&!S)continue;if(T=T.clone(!0),R=l(Z+ct[b].start),k=l(Q+ut[C].start),void 0,void 0,E=x?S.colCount:1,D=x?S.rowCount:1,M=ct[b+E]?ct[b+E].start:J,O=l(M-ct[b].start),N=ut[C+D]?ut[C+D].start:$,j=l(N-ut[C].start),I.formatStyle&&(I.formatStyle.Yo(T),T=I.formatStyle),T.Zo(p),F=null,x){for(F={row:C,col:b,x:l(R),y:l(k),width:l(O),height:l(j),rowCount:D,colCount:E},P={},_={},L=[],B=void 0,G=void 0,H=0,V=0,B=0;B<E-1;B++)W=(z=ct[b+B])?z.size:0,_[B]=W,H+=W;for(_[B]=l(O)-H,G=0;G<D-1;G++)W=(U=ut[C+G])?U.size:0,P[G]=W,V+=W;for(P[G]=l(j)-V,G=0;G<D;G++){for(q=[],Y=0;Y<E;Y++)ft[G+C]&&ft[G+C][b+Y]&&q.push(ft[G+C][b+Y].style);L.push(q)}F.spanSizeInfo={styleList:L,rowSizes:P,colSizes:_}}d.jF(C,b,l(R),l(k),l(O),l(j),T,F,nt&&0===C,ot&&0===b),X=null,ht[C][b]&&((X=ht[C][b].clone())&&(X.oZa=h.name(),X.hKb=X.iKb(h),X.jKb=X.kKb(h),X.lKb=h)),I&&I.value&&"SparklineExValue"===I.value.typeName&&(s.bDc(t,I.value,R,k,O,j,K),A=!0),I.validStyle&&it.push({style:I.validStyle,x:R,y:k,width:O,height:j}),!A&&rt.push({data:I.value,row:C,col:b,x:R,y:k,width:O,height:j,style:T,sparkline:X,baseRow:C+c,baseCol:b+f,conditionalFormats:v,imageLoader:at,cellLayout:{row:C,col:b,x:R,y:k,width:O,height:j}})}t.save(),nt&&(Q-=2,$+=4),ot&&(Z-=2,J+=4),t.rect(Z,Q,J,$),t.clip(),rt.length>0&&h.yl.SI(t,rt,tt,et,K,c,f),d.paint(t),it.length>0&&h.yl.jJ(t,it),t.restore()}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Bindings"),i=n("Sparkline"),a=o.CellTypes.Base,s=o.CellTypes.Context,l=Math.floor,u=function(){function t(){this.Uu=0,this.SV=0,this.Xj=0,this.OZ=0}return t.prototype.YE=function(t,e){var n=this,o=e.row,r=e.col,i=e.rowCount,a=e.colCount;return n.Uu=o,n.SV=r,n.Xj=i,n.OZ=a,n.Ny=n.nJb(t,e),n.NJb=n.OJb(t,e),n},t.prototype.PJb=function(){return this.NJb},t.prototype.OJb=function(t,e){var n,o,r,i,a,s=this,l=e.row,u=e.col,c=e.rowCount,f=e.colCount,h=0,p=[],d=0,g=[],m=0,y=l+c,v=u+f;for(n=l;n<y;n++)m=t.getRowHeight(n),d+=m,g.push(m);for(o=u;o<v;o++)m=t.getColumnWidth(o),h+=m,p.push(m);return m=0,r=g.map((function(t){var e=m/d;return m+=t,{start:e,size:t/d}})),m=0,i=p.map((function(t){var e=m/h;return m+=t,{start:e,size:t/h}})),a=s.nJb(t,e),{rowCount:c,colCount:f,rowSize:r,colSize:i,cellStyleList:s.QJb(t,e,a,r,i),sparklines:s.RJb(t,e),totalHeight:d,totalWidth:h}},t.prototype.SJb=function(t,e,n,r,i){var a,s,l,u,c,f,h,p=null;for(a=0,s=i;a<s.length;a++)if(u=(l=s[a]).rowOffset,c=l.colOffset,f=l.rowCount,h=l.colCount,new o.Range(u+n,c+r,f,h).contains(t,e)){p=l;break}return p},t.prototype.TJb=function(t,e,n){var o,r=[0,0],i=r[0],a=r[1],s=t.rowOffset,l=t.colOffset,u=s+t.rowCount,c=l+t.colCount;for(o=s;o<u;o++)a+=e[o]?e[o].size:0;for(o=l;o<c;o++)i+=n[o]?n[o].size:0;return{width:i,height:a}},t.prototype.QJb=function(t,e,n,o,r){var i,a,s,l,u,c=e.row,f=e.col,h=e.rowCount,p=e.colCount,d=[];for(i=c;i<c+h;i++){for(a=[],s=f;s<f+p;s++)(l=this.SJb(i,s,c,f,n))&&l.rowOffset+c===i&&l.colOffset+f===s?(u=this.TJb(l,o,r),a.push({style:t.getActualStyle(i,s,3,!0),spanWidth:u.width,spanHeight:u.height,isSpan:!0,span:l})):l?a.push({style:t.getActualStyle(i,s,3,!0),isSpan:!0}):a.push({style:t.getActualStyle(i,s,3,!0)});d.push(a)}return d},t.prototype.nJb=function(t,e){var n,o,r,i=t.ITa.getSpans(),a=[],s=e.row,l=e.col,u=e.rowCount,c=e.colCount;for(n=0,o=i;n<o.length;n++)(r=o[n]).intersect(s,l,u,c)&&a.push({rowOffset:r.row-s,colOffset:r.col-l,rowCount:r.rowCount,colCount:r.colCount});return a},t.prototype.RJb=function(t,e){var n,o,r,i,a=e.row,s=e.col,l=e.colCount,u=e.rowCount,c=[];for(n=a;n<a+u;n++){for(o=[],r=s;r<s+l;r++)(i=t.getSparkline(n,r))?o.push(i.clone()):o.push(null);c.push(o)}return c},t.prototype.toJSON=function(){var t=this.PJb(),e=t.rowCount,n=t.colCount,o=t.rowSize,r=t.colSize,i=t.cellStyleList,a=t.sparklines,s=t.totalWidth,l=t.totalHeight,u=p(o),c=p(r),f=i.map((function(t){return t.map((function(t){if(t){var e=t.style,n=t.spanWidth,o=t.spanHeight,r=t.isSpan,i=t.span;return{style:e.toJSON(),spanWidth:n,spanHeight:o,isSpan:r,span:i}}return null}))}));return{rowCount:e,colCount:n,rowSize:u,colSize:c,cellStyleList:f,sparklines:a.map((function(t){return t.map((function(t){if(t)return{sparklineType:t.sparklineType(),sp:t.toJSON(),setting:t.setting().toJSON()}}))})),totalWidth:s,totalHeight:l}},t.prototype.fromJSON=function(t){var e,n,r,a,s,l,u,c,f,h,d,g;t&&(e=t.rowCount,n=t.colCount,r=t.rowSize,a=t.colSize,s=t.cellStyleList,l=t.sparklines,u=t.totalWidth,c=t.totalHeight,f=p(r),h=p(a),d=s.map((function(t){return t.map((function(t){var e,n,r,i,a,s;return t?(e=t.style,n=t.spanWidth,r=t.spanHeight,i=t.isSpan,a=t.span,s=null,e&&(s=new o.Style).fromJSON(e),{style:s,spanWidth:n,spanHeight:r,span:a,isSpan:i}):null}))})),g=l.map((function(t){return t.map((function(t){if(t){var e=new i.Sparkline,n=new i.SparklineSetting(t.setting);return e.fromJSON(t.sp),e.setting(n),e.sparklineType(t.sparklineType),e}}))})),this.NJb={rowCount:e,colCount:n,rowSize:f,colSize:h,cellStyleList:d,sparklines:g,totalWidth:u,totalHeight:c})},t.prototype.no=function(){this.NJb=null},t}(),e.Wgc=u,c=function(){function t(){}return t.prototype.YE=function(t,e){var n=this;return n.my=e,n.UJb=new o.Worksheet,n.VJb=t.parent&&t.parent.options.allowDynamicArray,n.UJb.getCalcService&&(n.UJb.getCalcService().allowDynamicArray=n.VJb,n.WJb=n.XJb(t)),n.YJb(t),n},t.prototype.XJb=function(t){var e,n,o,r,i,a,s,l=this.my,u=l.row,c=l.col,f=l.colCount,h=l.rowCount,p=[],d=t.Bj&&t.Bj();for(e=u;e<u+h;e++)for(n=c;n<c+f;n++)t.getFormula(e,n)&&((o=d&&d.Qf(e,n))&&o.isDynamicArray&&(r=o.row,i=o.col,a=o.rowCount,s=o.colCount,a>1&&p.push({row:r+1,col:i,rowCount:a-1,colCount:s}),s>1&&p.push({row:r,col:i+1,rowCount:1,colCount:s-1})));return p},t.prototype.ZJb=function(){var t,e,n,o,r,i,a,s=this.WJb,l=this.UJb;for(t=0,e=s;t<e.length;t++)o=(n=e[t]).row,r=n.col,i=n.rowCount,a=n.colCount,l.clear(o,r,i,a,3,1)},t.prototype.$Jb=function(t){var e,n=this.UJb;n.suspendEvent(),e=new r.CellBindingSource(t),this.ZJb(),n.setDataSource(e),n.resumeEvent()},t.prototype.YJb=function(t){var e=this.UJb,n=t.toJSON({includeBindingSource:!0});delete n.charts,delete n.shapes,delete n.tables,e.fromJSON(JSON.parse(JSON.stringify(n))),this._Jb()},t.prototype._Jb=function(){var t,e,n=this.my,o=n.row,r=n.col,i=n.colCount,a=n.rowCount,s=[],l=[];for(t=o;t<o+a;t++){for(l=[],e=r;e<r+i;e++)l.push(this.aKb(t,e,3));s.push(l)}this.bKb=s},t.prototype.cKb=function(){var t=this.my;return{baseRow:t.row,baseCol:t.col}},t.prototype.dKb=function(t){var e,n,o,r,i,a,s,l=this.UJb,u=this.my,c=u.row,f=u.col,h=u.colCount,p=u.rowCount,d=[];for(e=c;e<c+p;e++){for(n=[],o=void 0,r=void 0,i=f;i<f+h;i++)a=l.getText(e,i),s=l.getValue(e,i,3,1),o=this.eKb(e,i,3),r=this.fKb(l,e,i,s,t),n.push({value:s,formatStyle:o,text:a,validStyle:r});d.push(n)}return d},t.prototype.aKb=function(t,e,n){var o;return this.UJb.uja&&(o=this.UJb.getDataValidator(t,e,n))?o.highlightStyle():null},t.prototype.fKb=function(t,e,n,o,r){if(r&&t.isValid&&!t.isValid(e,n,o)){var i=this.my,a=i.row,s=i.col;return this.bKb[e-a][n-s]}return null},t.prototype.eKb=function(t,e,n){var r=this.UJb.conditionalFormats;return r?r.Eq(new o.Style,t,e,n):null},t.prototype.getCellValueInfo=function(t){var e,n,o,r=this.my,i=r.row,a=r.col,s=r.colCount,l=r.rowCount,u=[],c=t.ITa;for(e=i;e<i+l;e++){for(n=[],o=a;o<a+s;o++)n.push({bindPath:t.getBindingPath(e,o),formula:t.getFormula(e,o),value:c.getValue(e,o,3,null,1)});u.push(n)}return u},t.prototype.setValueToDataStruct=function(t,e,n,o){o[t]||(o[t]={}),o[t][e]=n},t.prototype.toJSON=function(){var t=this.UJb,e=this.VJb,n=this.WJb.map((function(t){return{row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}})),o=this.my;return{spillRangs:n,allowDynamicArray:e,range:{row:o.row,col:o.col,rowCount:o.rowCount,colCount:o.colCount},templatejson:JSON.stringify(t.toJSON({includeBindingSource:!0}))}},t.prototype.fromJSON=function(t){var e,n,r,i,a,s,l;t&&((n=(e=this).UJb=new o.Worksheet).suspendCalcService&&n.suspendCalcService(),e.WJb=t.spillRangs,e.VJb=t.allowDynamicArray,n.getCalcService&&(n.getCalcService().allowDynamicArray=e.VJb),n.fromJSON(JSON.parse(t.templatejson)),e.ZJb(),i=(r=t.range).row,a=r.col,s=r.rowCount,l=r.colCount,e.my=new o.Range(i,a,s,l),this._Jb(),n.resumeCalcService&&n.resumeCalcService())},t.prototype.no=function(){this.UJb.no(),this.UJb=null,this.my=null},t}(),e.Xgc=c,f=function(t){function e(e,n,r,i,a){var s,l=t.call(this)||this;return l.allowOverflow=!1,l.typeName="16",s=1===arguments.length?new o.Range(0,0,e.getRowCount(),e.getColumnCount()):new o.Range(n,r,i,a),e&&s&&(l._R=(new u).YE(e,s),l.gKb=(new c).YE(e,s)),l}return h(e,t),e.prototype.getAutoFitWidth=function(){return this._R.NJb.totalWidth},e.prototype.getAutoFitHeight=function(){return this._R.NJb.totalHeight},e.prototype.updateTemplate=function(t,e){t&&e&&(this._R.YE(t,e),this.gKb.YE(t,e))},e.prototype.paintContent=function(t,e,n,o,r,i,a,s){var l,u=this.gKb,c=this._R;u&&c&&(l=this._R.PJb(),a.cellPadding&&(s.needTopGridline=!0,s.needLeftGridline=!0),d(t,{x:n,y:o,width:r,height:i},e,s,u,l))},e.prototype.toJSON=function(){return{typeName:this.typeName,layout:this._R.toJSON(),resolvor:this.gKb.toJSON()}},e.prototype.fromJSON=function(t){t.layout&&(this._R=new u,this._R.fromJSON(t.layout)),t.resolvor&&(this.gKb=new c,this.gKb.fromJSON(t.resolvor))},e}(a),e.RangeTemplate=f,o.CellTypes._o[16]=f,e.paintRangeTemplate=d},"./dist/plugins/comment/comment-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function S(t,e,n){var o,i=t.ITa.Ky.JU();return!!i&&(o=i.location(),t.wu().execute({cmd:m,sheetName:t.name(),row:i.nT,col:i.oT,oldValue:o.clone(),newValue:new r.Point(o.x+e,o.y+n),propertyName:"location"}))}function A(t){var e=t.comment;e&&(s(t.row)||s(t.col))&&(t.row=e.nT,t.col=e.oT)}function I(t,e){var n,o,r;if((e?t.canUndo():t.canExecute())&&(n=t.KV)){for(o=0;o<n.length;o++)(r=n[o])&&(e?r.undo():r.execute());return!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("Core"),r.GC$,a=r.Events,s=o.Common.j.Fa,l=i.Commands.ActionBase,u="deleteComment",c="deleteCommentByKey",f="deactivateComment",h="moveCommentUp",p="moveCommentDown",d="moveCommentLeft",g="moveCommentRight",m="changeComment",y="changeCommentTransaction",v=i.Commands.h4,C=function(t){function e(e,n){var o=t.call(this)||this;return A(n),o.kj=e,o.VQ=n,o}return x(e,t),e.prototype.execute=function(){var t,e,n,o,r,s,l=this;return!!l.canExecute()&&(t=l.kj,l.Lz(t,!0),e=t.comments.get(l.VQ.row,l.VQ.col),o=(n=t.ITa).Ky,r={sheet:t,sheetName:t.name(),comment:e,cancel:!1},t.Wq(a.CommentRemoving,r),r.cancel||(n.startTransaction(),o.remove(e.nT,e.oT),o.rV=null,t.GJ(),t.Wq(a.CommentRemoved,{sheet:t,sheetName:t.name(),comment:e}),s=i.Commands.bWa(t.name()),l.VQ[s]=n.endTransaction()),l.Mz(t,!0),!0)},e.prototype.undo=function(){var t,e=this,n=e.kj;return e.Lz(n,!0),t=i.Commands.bWa(n.name()),n.ITa.undo(e.VQ[t]),n.EJ(),e.Mz(n,!0),!0},e}(l),e.CommentDeleteUndoAction=C,b=function(t){function e(e,n){var o=t.call(this)||this;return A(n),o.kj=e,o.VQ=n,o}return x(e,t),e.prototype.execute=function(){var t,e=this,n=e.VQ,o=e.kj,r=o.comments.get(n.row,n.col);return!(!e.canExecute()||!r||(e.Lz(o,!0),t=n.propertyName,r[t](n.newValue),"location"===t&&(n.displayMode?r.displayMode(n.displayMode):n.displayMode=r.displayMode()),e.Mz(o,!0),0))},e.prototype.undo=function(){var t,e=this,n=e.VQ,o=e.kj;return e.Lz(o,!0),!!(t=o.comments.get(n.row,n.col))&&(t[n.propertyName](n.oldValue),e.Mz(o,!0),!0)},e}(l),e.CommentPropertyUndoAction=b,i.Commands.ChangeComment=b,w=function(t){function e(e,n){var o,r,i=t.call(this)||this,a=i;if(a.KV=[],a.kj=e,a.VQ=n,o=n.commands)for(r=0;r<o.length;r++)a.add(o[r]);return i}return x(e,t),e.prototype.execute=function(){return I(this,!1)},e.prototype.undo=function(){return I(this,!0)},e.prototype.add=function(t){this.KV.push(t)},e}(l),i.Commands[c]={canUndo:!1,execute:function(t,e){var n=i.Commands.bT(t,e),o=n.ITa.Ky.JU();return!!o&&n.wu().execute({cmd:u,sheetName:n.name(),row:o.nT,col:o.oT})}},i.Commands[f]={canUndo:!1,execute:function(t,e){var n=i.Commands.bT(t,e),o=n.ITa.Ky;return!!o.JU()&&(o.vQ(),n.GJ(),n.repaint(),!0)}},i.Commands[h]={canUndo:!1,execute:function(t,e){return S(i.Commands.bT(t,e),0,-1)}},i.Commands[p]={canUndo:!1,execute:function(t,e){return S(i.Commands.bT(t,e),0,1)}},i.Commands[d]={canUndo:!1,execute:function(t,e){return S(i.Commands.bT(t,e),-1,0)}},i.Commands[g]={canUndo:!1,execute:function(t,e){return S(i.Commands.bT(t,e),1,0)}},i.Commands[u]={canUndo:!0,execute:function(t,e,n){return v(t,C,e,n)}},i.Commands[m]={canUndo:!0,execute:function(t,e,n){return v(t,b,e,n)}},i.Commands[y]={canUndo:!0,execute:function(t,e,n){return v(t,w,e,n)}},T=function(t){var e=r.Ul.sl();t.register(c,i.Commands[c],e?8:46,!1,!1,!1,!1),t.register(f,i.Commands[f],27,!1,!1,!1,!1),t.register(h,i.Commands[h],38,!1,!1,!1,!1),t.register(p,i.Commands[p],40,!1,!1,!1,!1),t.register(d,i.Commands[d],37,!1,!1,!1,!1),t.register(g,i.Commands[g],39,!1,!1,!1,!1),t.register(u,i.Commands[u]),t.register(m,i.Commands[m]),t.register(y,i.Commands[y])},i.Commands.uT=T},"./dist/plugins/comment/comment-touch.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("./dist/plugins/comment/comment.js"),i=n("Touch"),o.Rxb.touch&&(a=o.GC$,s=o.Ul.nl,l=function(){function t(t,e){var n=this;n.NS=t,n.LV=e,n.kT=e.kT,n.kj=n.kT.kj,n.hQ=new i.TP(n.kj)}return t.prototype.OS=function(t){var e,n=new i.oP(t.X,t.Y),o=a(this.NS).offset();return o&&(e=document.body,n.X+=o.left+e.clientLeft||0,n.Y+=o.top+e.clientTop||0),n},t.prototype.jQ=function(t){t.DO=35},t.prototype.lQ=function(t){var e=this,n=e.OS(t.rN);e.LV.iV({target:t.GP,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}),e.hQ.OP()},t.prototype.pQ=function(t){var e,n,o=this,r=t.dP.rO,i=o.kj,s=i.parent;1!==r&&s&&s.options.allowUserZoom?(i.mm.lV=!1,e=o.LV,a(e.TU).remove(),o.hQ.PP(r)):(n=o.OS(t.rN),o.LV.BD({target:t.GP,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}))},t.prototype.qQ=function(t){var e,n=this,o=t.dP.rO,r=n.kj.parent;1!==o&&r&&r.options.allowUserZoom?n.hQ.SP(o):(e=n.OS(t.rN),n.LV.CD({target:t.GP,isTouch:!0,button:0,pageX:e.X,pageY:e.Y,stopPropagation:function(){}}))},t.prototype.sQ=function(t){var e=this.kT,n=this.kj;try{n.suspendPaint(),3===e.commentState()?e.commentState(1):1===e.commentState()&&e.commentState(2)}finally{n.resumePaint()}},t}(),u=function(){function t(t,e,n,o){var r,a=this,s=a.kT=e.kT;a.yM=new i.jR(a),a.DQ=new i.kR(t,"Comment"+s.nT+s.oT,a.yM,2,200),a.BQ=n,a.CQ=o,(r=a.DQ)._M=function(){return 3!==s.commentState()},r.bN=function(){return!0},r.dN=function(t){return o.jQ(t)},r.eN=function(t){return o.lQ(t)},r.fN=function(t){return o.pQ(t)},r.hN=function(t){return o.qQ(t)},r.iN=function(t){return o.sQ(t)}}return t.prototype.EQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!0)},t.prototype.FQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!1)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),c=function(t){function e(e,n,o){return t.call(this,e,n,o,new l(e,n))||this}return p(e,t),e}(u),f=function(t){function e(e,n,o){return t.call(this,e,n,o,new h(e,n))||this}return p(e,t),e}(u),h=function(t){function e(e,n){return t.call(this,e,n)||this}return p(e,t),e.prototype.lQ=function(t){var e=this,n=e.OS(t.rN);e.LV.hV({target:t.GP,isTouch:!0,button:0,pageX:n.X,pageY:n.Y,stopPropagation:function(){}}),e.hQ.OP()},e}(l),r.GV.$n("touch",{init:function(t){var e=this,n=e.kT.kj.parent.BQ;e.wR=new c(t[0],e,n),e.wR.EQ(),e.MV=new f(t[1],e,n),e.MV.EQ()},detachEditor:function(t){var e=this,n=e.kT.kj;e.MV=new f(t,e,n.parent.BQ),e.MV.EQ()},preProcessMouseDownEdit:function(t){var e=t.e,n=this.MV;n&&!e.isTouch&&n.GQ(e)&&(s(e),t.r=!0)},preProcessMouseDownDragResize:function(t){var e=t.e,n=this.wR;n&&!e.isTouch&&n.GQ(e)&&(s(e),t.r=!0)},preProcessMouseMove:function(t){var e=t.e,n=e.isTouch,o=this.wR,r=this.MV;o&&!n&&o.IQ(e)&&(s(e),t.r=!0),r&&!n&&r.IQ(e)&&(s(e),t.r=!0)},preProcessMouseUp:function(t){var e=t.e,n=e.isTouch,o=this.wR,r=this.MV;o&&!n&&o.HQ(e)&&(s(e),t.r=!0),r&&!n&&r.HQ(e)&&(s(e),t.r=!0)}}))},"./dist/plugins/comment/comment.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/comment/comment.js")),o(n("./dist/plugins/comment/comment-actions.js")),n("./dist/plugins/comment/comment-touch.js")},"./dist/plugins/comment/comment.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q;function Y(t,e){return new i.Point(t,e)}function X(t,e,n,o){return new i.Rect(t,e,n,o)}function Z(t){return t.height}function Q(t){return t.width}function J(t,e){var n=t.options;return!n.isProtected||n.protectionOptions.allowEditObjects||e&&!e.locked()}function $(t,e,n,o,r){var i,a,s,l,u,c,f=this.ITa.Ky;if(t&&f)for(a=f.all(),s=0;s<a.length;s++)l=(i=a[s]).nT,u=i.oT,l===e&&u===n||l>=e&&l<e+o&&u>=n&&u<n+r&&f.remove(l,u);(i=f.get(e,n))&&((c=f.pT(i))&&c.qT())}function K(){var t=this,e=t.nQ&&t.nQ();e&&e.rT(t)}function tt(t,e,n){var o=this.nQ&&this.nQ();o&&o.sT(t,e,n)}function et(t,e){return t&&t.getRowHeight(e)}function nt(t,e){return t&&t.getColumnWidth(e)}function ot(t,e){return t&&t.getViewportLeftColumn(e)}function rt(t,e){return t&&t.getViewportTopRow(e)}function it(t,e,n){return B.push(t),r.Ul.Pl(t,e,function(t){var e=t;return function(t,n){var o=this,r=o.kj;r&&(r.ITa.UUa({type:"property",comment:o,name:e,value:n}),r.Xq<=0&&(r.RP(),"indicatorColor"!==e&&"indicatorSize"!==e||r.repaint(r.getCellRect(o.nT,o.oT))),r.Wq(T.CommentChanged,{sheet:r,sheetName:r.name(),comment:o,propertyName:e}))}}(t),n)}function at(t,e,n,o,r){var i=X(e,n,o,o);i.cursor=r,t.push(i)}function st(t,e,n,o){i.GC$(t.DT).css(e,n),i.GC$(t.ET).css(e,o)}function lt(t,e){var n,o=t.length,r=0;for(n=0;n<o;n++)r+=A(t[n],e);return r}function ut(t,e){t&&t.RF(e)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("Core"),a=r.Commands,s=r.Worksheet,l=null,u=void 0,c=Math.max,f=Math.min,h=Math.floor,p=Math.atan2,d=Math.abs,g="default",m=r.GC$.extend,y=r.Ul.Nl,v=o.Common.k,C=r.Vl,b=r.En,w=r.Ul,T=r.Events,x=w.nl,S=w.Rl,A=w.Voa,I=parseFloat,R=o.Common.u,k=r.Bn,M=document,N=window,E={cGc:"mouse",dGc:"move",eGc:"DOMMouseScroll",fGc:"left",OLb:"top",gGc:"right",hGc:"bottom",iGc:"width",jGc:"height",kGc:"position",lGc:"absolute",mGc:"overflow",nGc:"visible",oGc:"z-index",pGc:"hidden",qGc:"box-sizing",rGc:"content-box",sGc:"padding",tGc:"px",uGc:"div",vGc:".comment",wGc:".floatBlockCanvas",xGc:".hostContainer",yGc:".lineCanvasContainer",zGc:".host",AGc:".editor",BGc:"gc-spread-",CGc:"className",DGc:"cursor",EGc:"text",FGc:701,GGc:898,HGc:"gc-no-user-select",IGc:" ",JGc:"unselectable",KGc:"on",LGc:"comment_editor",MGc:"comment_indicator",NGc:"font-family",OGc:"font-style",PGc:"font-size",QGc:"font-weight",RGc:"color",SGc:"textArea",TGc:".lineCanvas",UGc:".commentDocument",VGc:"-resize",WGc:"line-height",XGc:"background-color",YGc:"text-align",ZGc:"mousedown",$Gc:"mousemove",_Gc:"mouseup",aHc:"mousewheel",bHc:"text-decoration"},r.GC$.extend(s.prototype,{RP:function(t){var e,n,o,r,i,a=this,s=a.nQ&&a.nQ();if(!a.fI)for(e=a.am(),n=void 0,o=0;o<=2;o++)for(r=0;r<=2;r++)(n=e.Ft(o,r))&&0!==Q(n)&&0!==Z(n)&&(t&&!n.intersectRect(t)||(i=a.ITa.Ky,s&&i&&s.fT(i)))}}),r.CellRange.prototype.comment=function(t){var e=this,n=e.sheet,o=e.row,r=e.col;return 0===arguments.length?n.ITa.Ky.get(o,r):(t instanceof _&&n.ITa.Ky.Cz(o,r,t),e)},D=function(t,e){var n=t.Vs(),o=t.hitTest(e.pageX-n.left,e.pageY-n.top);o&&function(t,e){var n,o=-1,r=-1;if(e&&e.rowViewportIndex>=0&&e.colViewportIndex>=0&&(o=e.row,r=e.col),t.parent){if(o<0||r<0)return;n=t.ITa.Ky.get(o,r),t.ITa.Ky.tT(n)}}(t,o)},O=function(t,e){var n=e.ITa.Ky;e.bind(T.TopRowChanged+E.vGc,(function(){n.cQ()})),e.bind(T.LeftColumnChanged+E.vGc,(function(){n.cQ()})),e.bind(T.FloatingElementSelected+E.vGc,(function(t,e){"comments"!==e.type&&(n.vQ(),n.tT(l))})),t.bind(E.ZGc+E.vGc,(function(t){n.vQ(),D(e,t)})).bind(E.aHc+E.vGc,(function(t){D(e,t)})).bind(E.$Gc+E.vGc,(function(t){D(e,t)}))},j=function(t,e){e.unbind(E.vGc),t.unbind(E.vGc)},T.CommentChanged="CommentChanged",function(t){t[t.active=1]="active",t[t.edit=2]="edit",t[t.normal=3]="normal"}(F=e.CommentState||(e.CommentState={})),function(t){t[t.alwaysShown=1]="alwaysShown",t[t.hoverShown=2]="hoverShown"}(e.DisplayMode||(e.DisplayMode={})),P=function(){function t(t,e,n,o){var r=this;arguments.length<=1?r.top=r.right=r.bottom=r.left=t||0:(r.top=t,r.right=e,r.bottom=n,r.left=o)}return t.prototype.clone=function(){var e=this;return new t(e.top,e.right,e.bottom,e.left)},t.prototype.toString=function(){var t=this,e="";return[E.OLb,E.gGc,E.hGc,E.fGc].forEach((function(n){e+=t[n]+E.tGc+E.IGc})),e.trim()},t}(),e.Padding=P,_=function(){function t(t){var e=this;e.nT=-1,e.oT=-1,e.text(t||""),e.zIndex(E.GGc)}return t.prototype.clone=function(){var e=this,n=new t;return B.forEach((function(t){var o=e[t]();e[t].isDefault&&e[t].isDefault(o)||n[t](o&&o.clone?o.clone():o)})),n.kj=e.kj,n.nT=e.nT,n.oT=e.oT,n},t.prototype.toJSON=function(){var t=this,e={rowIndex:t.nT,colIndex:t.oT};return B.forEach((function(n){var o=t[n]();t[n].isDefault&&t[n].isDefault(o)||(e[n]=o&&o.clone?o.clone():o)})),e},t.prototype.fromJSON=function(t,e){if(t){var n=this;B.forEach((function(e){var o=t[e];o!==u&&("location"===e?n.location(new i.Point(o.x,o.y),!1):"padding"===e?n.padding(new P(o.top,o.right,o.bottom,o.left),!1):n[e](o,!1))})),t.rowIndex!==u&&(n.nT=t.rowIndex),t.colIndex!==u&&(n.oT=t.colIndex)}},t}(),e.Comment=_,L={},B=[],[[E.EGc,""],["location",Y(9,-18)],[E.iGc,160,function(t){return t>0}],[E.jGc,100,function(t){return t>0}],["fontFamily","Arial"],["fontStyle","normal"],["fontSize","9pt",function(t){return/^\d+pt$/.test(t)&&parseInt(t,10)>0}],["fontWeight","normal"],["textDecoration",0],["foreColor","black"],["locked",!0],["lockText",!0],["horizontalAlign",0],["autoSize",!1],["dynamicSize",!0,function(t){return"boolean"==typeof t&&this.dynamicMove()}],["dynamicMove",!0,function(t){return t||this.dynamicSize(!1),!0}],["backColor","#FFFFE1"],["opacity",1,function(t){return t>=0&&t<=1}],["borderWidth",1,function(t){return t>=1}],["borderStyle","solid"],["borderColor","black"],["padding"],["showShadow",!1],["displayMode",2],["commentState",3],["zIndex",-1],["ignoreDefaultLocation",!1],["indicatorColor","red",function(t){return"string"==typeof t}],["indicatorSize",6,function(t){return"number"==typeof t&&t>1}]].forEach((function(t){L[t[0]]=it(t[0],t[1],t[2])})),G=L.zIndex,L.zIndex=function(){var t,e,n=G.apply(this,arguments);return 0===arguments.length&&n===E.GGc&&(t=this.kj.comments.wTa,e=this.mi,n=E.GGc-(t-1-e)),n},m(_.prototype,L),H=function(){function t(t,e){var n,o=this,r=t&&t.kj;o.WE=1,o.aS=1,o.kT=t,o.vT(),o._zoomFactor=r.zoom(),o.wT=e,o.BF=e.xT,o.ad(),n=o.yT(o.zT(),t.width(),t.height()),o.AT=Y(n.x,n.y),o.BT(),o.CT()}return t.prototype.ad=function(){var e=this,n=e.kT.kj;e.FT=E.BGc+"floatBlockCanvas",e.GT=E.BGc+"host-container",e.HT=E.BGc+"host",e.IT=E.BGc+"lineCanvas",e.JT=y(E.uGc),i.GC$(e.JT).addClass(E.BGc+"floatBlockCanvas-container").css([E.kGc,E.mGc,E.qGc],[E.lGc,E.pGc,E.rGc]),e.DT=y("canvas"),b.Kn(e.DT,null,n),i.GC$(e.DT).addClass(e.FT).css([E.fGc,E.OLb,E.kGc],[0,0,E.lGc]),e.ET=y(E.uGc),i.GC$(e.ET).addClass(e.GT).css([E.kGc,E.qGc,E.mGc],[E.lGc,E.rGc,E.pGc]),e.qo=y(E.uGc),i.GC$(e.qo).addClass(e.HT+E.IGc+E.HGc).css([E.fGc,E.OLb,E.iGc,E.jGc,E.kGc,"word-wrap","word-break","white-space",E.mGc,E.qGc,E.JGc,E.WGc],[0,0,"100%","100%",E.lGc,"break-word","normal","pre-wrap",E.pGc,E.rGc,E.KGc,"normal"]),i.GC$(e.ET).append(e.qo),i.GC$(e.JT).append(e.DT).append(e.ET),e.KT=y(E.uGc),i.GC$(e.KT).addClass(E.BGc+"lineCanvas-container").css([E.kGc,E.mGc,"pointer-events"],[E.lGc,E.pGc,"none"]),e.LT=y("canvas"),b.Kn(e.LT,l,n),i.GC$(e.LT).addClass(e.IT).css([E.fGc,E.gGc,E.kGc],[0,0,E.lGc]),i.GC$(e.KT).append(e.LT),e.MT=[],e.NT=7,e.qS=!1,e.kv=!1,t.ao(e,"init",[e.DT,e.qo])},t.prototype.OT=function(){var t=this,e=t.kT.kj;!t.PT&&e&&e.nQ&&(t.PT=e.nQ().PT),t.PT&&(t.PT.appendChild(t.KT),t.QT(),t.PT.appendChild(t.JT),t.RT(t.DT,E.wGc),t.RT(t.ET,E.xGc),t.ST()?t.TT():t.UT(),t.AT=t.zT(),t.VT())},t.prototype.WT=function(){var t=this;t.JT&&t.KT&&t.PT&&(t.XT(t.DT,E.wGc),t.XT(t.ET,E.xGc),t.YT(),t.ZT(),t.$T(),i.GC$(t.JT).remove(),i.GC$(t.KT).remove())},t.prototype._T=function(){return this.kT.width()*this._zoomFactor},t.prototype.aU=function(){return this.kT.height()*this._zoomFactor},t.prototype.zT=function(){var t=this,e=t.kT;return e!==t.wT.bU||e.commentState()!==F.normal||e.ignoreDefaultLocation()?t.cU(e.location()):(e._3=t.cU(Y(9,-18)),e._3)},t.prototype.cU=function(t){var e,n,o=this,r=o.kT,i=r&&r.kj,a=o._zoomFactor,s=Y(0,0);return i&&((e=o.dU(i,r.nT,r.oT,o.WE,o.aS)).x!==l&&void 0!==e.x&&e.y!==l&&void 0!==e.y&&Q(e)&&Z(e)&&(n=i.am(),s.x=e.x+Q(e)+t.x*a-n.Br,s.y=e.y+t.y*a-n.Cr)),s},t.prototype.dU=function(t,e,n,o,r){var i,a,s,c,f=X(0,0,0,0),h=t.am(),p=rt(t,o),d=ot(t,r),g=this._zoomFactor,m=S(t,d,n,!1);return d===t.qq&&(m+=t.eCb),i=S(t,p,e,!0),p===t.lq&&(i+=t.cCb),f.y=e>=p?i:-i,f.x=n>=d?m:-m,(a=t.getSpan(e,n))!==u&&a!==l?(f.height=S(t,e,e+a.rowCount,!0),f.width=S(t,n,n+a.colCount,!1)):(f[E.jGc]=et(t,e)*g,f[E.iGc]=nt(t,n)*g),f.x+=h.Br,f.y+=h.Cr,s=h.hs,c=h.fs,1===o?f.y+=c:2===o&&(f.y+=c+h.jr),1===r?f.x+=s:2===r&&(f.x+=s+h.er),f},t.prototype.eU=function(t){var e,n,o=this,r=o.kT,i=r&&r.kj,a=o._zoomFactor,s=Y(0,0);return i&&((e=o.dU(i,r.nT,r.oT,o.WE,o.aS)).x!==l&&e.x!==u&&e.y!==l&&e.y!==u&&Q(e)&&Z(e)&&(n=i.am(),s.x=(t.x-(e.x+Q(e)-n.Br))/a,s.y=(t.y-(e.y-n.Cr))/a)),s},t.prototype.fU=function(){var t=this;t.AT=t.zT(),t.BT(),t.CT(),t.VT()},t.prototype.gU=function(){var t=this;t.AT=t.zT(),t.CT()},t.prototype.hU=function(){var t,e=this,n=e.kT;n.dynamicMove()?n.dynamicSize()?e.iU():(e.jU(),e.CT()):(e.BT(),e.CT(),t=e.eU(e.AT===n._3?e.zT():e.AT),n.location(t))},t.prototype.qT=function(){var t=this;t.AT=t.zT(),t.VT()},t.prototype.jU=function(){var t=this,e=t.kT,n=t.kU();t.AT=n,e.location(t.eU(n),!1),t.VT()},t.prototype.kU=function(){var t,e,n,o,r,i,a,s=this,l=s.kT,u=l&&l.kj,c=s._zoomFactor,f=ot(u,s.aS),h=rt(u,s.WE),p=0;for(t=0;t<s.aS;t++)p+=u.getViewportWidth(t);for(e=S(u,f,s.lU,!1),f<s.lU?p+=e:p-=e,(n=nt(u,s.lU))<s.mU&&(s.mU=n),p+=s.mU*c,o=0,r=0;r<s.aS;r++)o+=u.getViewportHeight(r);return i=S(u,h,s.nU,!0),h<s.nU?o+=i:o-=i,(a=et(u,s.nU))<s.oU&&(s.oU=a),Y(p,o+=s.oU*c)},t.prototype.pU=function(){var t,e,n,o,r=this,i=r.kT,a=i&&i.kj,s=S(a,r.lU,r.mT,!1),l=nt(a,r.lU);l<r.mU&&(r.mU=l),(t=nt(a,r.mT))<r.qU&&(r.qU=t),s=s-r.mU+r.qU,e=S(a,r.nU,r.lT,!0),(n=et(a,r.nU))<r.oU&&(r.oU=n),(o=et(a,r.lT))<r.rU&&(r.rU=o),e=e-r.oU+r.rU,i.width(s),i.height(e)},t.prototype.iU=function(){this.pU(),this.jU()},t.prototype.BT=function(){var t,e,n,o,r,i,a,s,l,u,c,f=this,h=f.kT,p=h&&h.kj,d=f._zoomFactor;if(f.AT){for(t=ot(p,f.aS),e=rt(p,f.WE),0===f.aS?n=f.AT.x:1===f.aS?n=f.AT.x-p.getViewportWidth(0):2===f.aS&&(n=f.AT.x-(p.getViewportWidth(0)+p.getViewportWidth(1))),0===f.WE?o=f.AT.y:1===f.WE?o=f.AT.y-p.getViewportHeight(0):2===f.WE&&(o=f.AT.y-(p.getViewportHeight(0)+p.getViewportHeight(1))),r=Y(n,o),i=0,a=0,s=t;s<p.getColumnCount();s++){if(!(i+(l=nt(p,s)*d)<r.x)){f.lU=s,f.mU=(r.x-i)/d;break}i+=l}for(u=e;u<p.getRowCount();u++){if(!(a+(c=et(p,u)*d)<r.y)){f.nU=u,f.oU=(r.y-a)/d;break}a+=c}}},t.prototype.CT=function(){var t,e,n,o,r,i,a,s,l,u,c,f=this,h=f.kT,p=h&&h.kj,d=f._zoomFactor;if(f.AT){for(t=ot(p,f.aS),e=rt(p,f.WE),0===f.aS?n=f.AT.x+f._T():1===f.aS?n=f.AT.x+f._T()-p.getViewportWidth(0):2===f.aS&&(n=f.AT.x+f._T()-(p.getViewportWidth(0)+p.getViewportWidth(1))),0===f.WE?o=f.AT.y+f.aU():1===f.WE?o=f.AT.y+f.aU()-p.getViewportHeight(0):2===f.WE&&(o=f.AT.y+f.aU()-(p.getViewportHeight(0)+p.getViewportHeight(1))),r=Y(n,o),i=0,a=0,s=t;s<p.getColumnCount();s++){if(!(i+(l=nt(p,s)*d)<r.x)){f.mT=s,f.qU=(r.x-i)/d;break}i+=l}for(u=e;u<p.getRowCount();u++){if(!(a+(c=et(p,u)*d)<r.y)){f.lT=u,f.rU=(r.y-a)/d;break}a+=c}}},t.prototype.rI=function(t,e){var n=this,o=n.kT;t<=n.nU?o.dynamicMove()&&(n.nU+=e,n.lT+=e):t>n.nU&&t<=n.lT&&o.dynamicSize()&&(n.lT+=e),n.iU()},t.prototype.tI=function(t,e){var n=this,o=n.kT;t<=n.lU?o.dynamicMove()&&(n.lU+=e,n.mT+=e):t>n.lU&&t<=n.mT&&o.dynamicSize()&&(n.mT+=e),n.iU()},t.prototype.GR=function(t,e){var n=this,o=n.kT,r=t+e-1;t<n.nU?r<n.nU?o.dynamicMove()&&(n.nU-=e,n.lT-=e):r<n.lT&&o.dynamicMove()&&(o.dynamicSize()?n.lT-=e:n.lT-=n.nU-t+1,n.nU=t,n.oU=0):t<=n.lT&&(r<n.lT?o.dynamicSize()&&(n.lT-=e):o.dynamicSize()&&(n.lT=t,n.rU=0)),n.iU()},t.prototype.HR=function(t,e){var n=this,o=n.kT,r=t+e-1;t<n.lU?r<n.lU?o.dynamicMove()&&(n.lU-=e,n.mT-=e):r<n.mT&&o.dynamicMove()&&(o.dynamicSize()?n.mT-=e:n.mT-=n.lU-t+1,n.lU=t,n.mU=0):t<=n.mT&&(r<n.mT?o.dynamicSize()&&(n.mT-=e):o.dynamicSize()&&(n.mT=t,n.qU=0)),n.iU()},t.prototype.VT=function(){var t,e=this,n=e.kT,o=n.kj;e.sU()&&(t=o.zoom(),e._zoomFactor!==t?(e._zoomFactor=t,e.AT=e.kU()):(e._zoomFactor=t,e.AT!==n._3||1!==n.displayMode()&&2!==n.commentState()||(e.AT=e.zT())),e.vT(),e.tU(),e.uU(),e.vU(),e.wU(),w.Ml.chrome&&e.xU())},t.prototype.tU=function(){var t=this,e=t.kT.kj,n=e.parent&&e.parent.options.useTouchLayout;t.NT=n?11:7},t.prototype.vT=function(){var t=this,e=t.kT,n=e.kj;t.WE=n.Er(e.nT),t.aS=n.Fr(e.oT)},t.prototype.uU=function(){var t=this,e=2===t.kT.commentState()?t.BF:t.qo;t.yU(),t.zU(e),t.AU(e),t.BU(e),t.CU()},t.prototype.AU=function(t){var e=this.kT;t===this.qo&&(t.innerHTML=R.Ob(e.text()))},t.prototype.BU=function(t){var e,n,o,r,a,s,l,u,h,p,d,g,m,y,v,C,w=this,T=w.kT,x=2===T.commentState()||1===T.displayMode()?w.zT():w.AT,S=w._zoomFactor;x&&(e=w.kv?w.yT(x,T.width(),T.height()):w.yT(x),w.DU(e),n=Q(e)*S,o=Z(e)*S,s=(r=e.x)+n,l=(a=e.y)+o,u=w.NT,r<(h=w.EU(w.WE,w.aS)).x?(st(w,E.fGc,r-h.x,r+u-h.x),n+=r-h.x,r=h.x):(st(w,E.fGc,0,u),s>h.x+Q(h)&&(n+=h.x+Q(h)-1-s)),n=f(Q(h)-1,n),a<h.y?(st(w,E.OLb,a-h.y,a+u-h.y),o+=a-h.y,a=h.y):(st(w,E.OLb,0,u),l>h.y+Z(h)&&(o+=h.y+Z(h)-1-l)),o=f(Z(h)-1,o),i.GC$(w.JT).css({left:r,top:a,width:n,height:o}),p=n,d=o,b.Pn(w.DT,p,d),g=c(0,p-2*(u+T.borderWidth())),m=c(0,d-2*(u+T.borderWidth())),i.GC$(w.ET).css({width:g,height:m}),y=g,v=m,(C=T.padding())&&(y-=Math.ceil(I(C.left)+I(C.right)),v-=Math.ceil(I(C.top)+I(C.bottom))),i.GC$(t).css({width:c(0,y),height:c(0,v)}))},t.prototype.DU=function(t){var e,n,o,r,i=this,a=i.kT,s=i.AT;t.x===s.x&&t.y===s.y&&Q(t)===a.width()&&Z(t)===a.height()||(e=i.eU(Y(t.x,t.y)),n=Q(t),o=Z(t),r=a.location(),e.x===r.x&&e.y===r.y||a.location(e,!1),n!==a.width()&&a.width(n,!1),o!==a.height()&&a.height(o,!1),a.dynamicMove()&&(i.AT=Y(t.x,t.y)))},t.prototype.CU=function(){var t=this,e=t.kT;J(e&&e.kj)?(t.RT(t.DT,E.wGc),t.RT(t.ET,E.xGc),t.QT(),t.UT(),t.TT()):(e.locked()?(t.XT(t.DT,E.wGc),t.FU(t.DT),t.XT(t.ET,E.xGc),t.FU(t.ET),t.DT.style.cursor=g,t.ET.style.cursor=g):(t.RT(t.DT,E.wGc),t.RT(t.ET,E.xGc)),e.lockText()?(t.YT(),t.FU(t.qo),t.$T(),t.FU(t.BF),(e.locked()||e.commentState()!==F.active)&&e.commentState(3),t.qo.style.cursor=e.locked()?g:E.dGc):(t.UT(),t.TT()),t.QT())},t.prototype.yU=function(){var t=this,e=t.kT,n=t.wT,o=e&&e.kj;switch(e.commentState()){case F.active:n.GU(e),t.ST()&&t.HU(),o.getSelections().length>0&&o.EJ(),C.Zl(o);break;case F.edit:n.GU(e),t.ST()||t.IU(),o.getSelections().length>0&&o.EJ(),C.Zl(l);break;case F.normal:e===n.JU()&&(n.vQ(),0===o.getSelections().length&&o.GJ())}},t.prototype.zU=function(t){var e,n,a,s,l;n=(e=this).kT,(a=i.GC$(t)).css("font-family",n.fontFamily()).css("font-style",n.fontStyle()).css("font-size",parseInt(n.fontSize(),10)*e._zoomFactor+"pt").css("font-weight",n.fontWeight()),a.css("text-decoration",r.To.So(n.textDecoration())),s={0:"left",1:"center",2:"right",3:"general"},a.css("text-align",s[n.horizontalAlign()]),n.padding()?a.css(E.sGc,""+n.padding()):a.css(E.sGc,"0px"),a.css("background-color",function(t,e,n){var r,i;return n?((i=(r=o.Common.pc).ec(t)).a=e,r.bc(i)):t}(n.backColor(),n.opacity(),t===e.qo)).css("color",n.foreColor()),i.GC$(e.ET).css("border-width",n.borderWidth()).css("border-style",n.borderStyle()).css("border-color",n.borderColor()),l=e.wT.KU(n),i.GC$(e.KT).css(E.oGc,l),i.GC$(e.JT).css(E.oGc,l)},t.prototype.xU=function(){var t,e,n,o=this.kT.kj,r=i.GC$(this.ET);o&&r&&(e=(t=o.Vs()).left-Math.floor(t.left)>=.5?.5:0,n=t.top-Math.floor(t.top)>=.5?.5:0,r.css(E.fGc,I(r.css(E.fGc))+e),r.css(E.OLb,I(r.css(E.OLb))+n))},t.prototype.vU=function(){var t,e,n,o,r,a,s,l,u,c=this,h=c.kT,p=h.kj,g=c.dU(p,h.nT,h.oT,c.WE,c.aS),m=p.am(),y=Y(g.x+Q(g)-m.Br,g.y-m.Cr),v=i.GC$(c.JT).position(),C=i.GC$(c.ET).position(),w=i.GC$(c.ET);t=v.left+C.left>y.x?Y(v.left+C.left,v.top+C.top):v.top+C.top+w.height()<y.y?Y(v.left+C.left+w.width(),v.top+C.top+w.height()):Y(v.left+C.left+w.width(),v.top+C.top),e=c.NT,n=d(y.x-t.x)+2*e,o=d(y.y-t.y)+2*e,s=(r=f(y.x,t.x)-e)+n,l=(a=f(y.y,t.y)-e)+o,r<(u=c.EU(c.WE,c.aS)).x&&(n-=u.x-r,r=u.x),s>u.x+Q(u)&&(n-=s-(u.x+Q(u))),n=f(Q(u),n),a<u.y&&(o-=u.y-a,a=u.y),l>u.y+Z(u)&&(o-=l-(u.y+Z(u))),o=f(Z(u),o),i.GC$(c.KT).css(E.fGc,r).css(E.OLb,a).css(E.iGc,n).css(E.jGc,o),b.Pn(c.LT,n,o),y.x=y.x-r,y.y=y.y-a,t.x=t.x-r,t.y=t.y-a,c.LU(y,t)},t.prototype.LU=function(t,e){var n,o,r,i=this;i.MU||(i.MU=i.LT.getContext("2d")),n=i.MU,o=i.kT.borderColor(),n.strokeStyle=o,n.clearRect(0,0,b.Nn(i.LT),b.On(i.LT)),n.beginPath(),n.moveTo(t.x,t.y),n.lineTo(e.x,e.y),n.stroke(),n.save(),k.Dn(n,t.x,t.y),n.fillStyle=o,n.beginPath(),r=p(e.y-t.y,e.x-t.x),n.rotate(r),n.moveTo(0,0),n.lineTo(7,-4),n.lineTo(7,4),n.lineTo(0,0),n.fill(),k.Dn(n,-t.x,-t.y),n.closePath(),n.restore()},t.prototype.wU=function(){var t,e,n,o,r,a,s,l=this,u=l.kT,c=u.kj;l.NU=l.kT.commentState(),l.OU||(l.OU=l.DT.getContext("2d")),t=l.OU,e=b.Nn(l.DT),n=b.On(l.DT),o=i.GC$(l.ET).outerWidth(),r=i.GC$(l.ET).outerHeight(),a=l.NT,t.clearRect(0,0,e,n),l.kT.showShadow()&&(l.QU(t,e,n),s=2*(a+2),t.clearRect(a,a,e-s,n-s),l.PU(t,a,o,r)),J(c,u)&&l.RU(t,a,e,n,o,r),t.restore()},t.prototype.PU=function(t,e,n,o){t.fillRect(e+2,o+e,n,2),t.fillRect(n+e,e+2,2,o)},t.prototype.QU=function(t,e,n){var o,r;switch(this.NU){case F.active:for(t.beginPath(),r=0;r<n;r++)for(o=r%2==0?1:3;o<e;)t.moveTo(o,r),t.lineTo(o+1,r+1),o+=4;t.stroke(),t.closePath();break;case F.edit:for(t.beginPath(),o=0,r=0,4;o<e+n;)t.moveTo(o+4,0),t.lineTo(0,r+4),o+=4,r+=4;t.stroke(),t.closePath()}},t.prototype.RU=function(t,e,n,o,r,a){var s=this,u=s.MT;s.NU!==F.active&&s.NU!==F.edit||(u.splice(0,u.length),at(u,0,0,e,"nw"+E.VGc),at(u,n-e,0,e,"ne"+E.VGc),at(u,0,o-e,e,"sw"+E.VGc),at(u,n-e,o-e,e,"se"+E.VGc),a>=3*e?(at(u,0,h(o/2-e/2),e,"w"+E.VGc),at(u,n-e,h(o/2-e/2),e,"e"+E.VGc)):(u.push(l),u.push(l)),r>=3*e?(at(u,h(n/2-e/2),0,e,"n"+E.VGc),at(u,h(n/2-e/2),o-e,e,"s"+E.VGc)):(u.push(l),u.push(l)),t.restore(),t.fillStyle="white",t.strokeStyle="#939393",t.lineWidth=1,k.Dn(t,.5,.5),i.GC$.each(u,(function(e,n){if(n){var o=n.x,r=n.y,i=Q(n),a=Z(n);t.beginPath(),t.fillRect(o,r,i-1,a-1),t.strokeRect(o,r,i-1,a-1),t.stroke(),t.closePath()}})),k.Dn(t,-.5,-.5))},t.prototype.SU=function(){var t,e,n,o=this,r=o.EU(o.WE,o.aS);o.TU?i.GC$(o.TU).remove():o.TU=y(E.uGc),t=i.GC$(o.TU),e=i.GC$(o.ET),t.addClass("gc-spread-moveResizeContainer").css([E.kGc,E.fGc,E.OLb,E.iGc,E.jGc,"border"],[E.lGc,o.AT.x+o.NT-r.x,o.AT.y+o.NT-r.y,e.outerWidth()-2,e.outerHeight()-2,"gray solid thin"]),o.UU?i.GC$(o.UU).remove():o.UU=y(E.uGc),(n=i.GC$(o.UU)).bind("mousemove",(function(t){o.BD(t)})).bind(E._Gc,(function(t){o.CD(t)})).css([E.kGc,E.mGc,E.OLb,E.fGc,E.iGc,E.jGc,"background",E.oGc],[E.lGc,E.pGc,r.y,r.x,Q(r),Z(r),"rgba(255,255,255,0.01)",901]),n.append(o.TU),o.PT&&o.PT.appendChild(o.UU)},t.prototype.VU=function(t){var e,n,o,r,a,s,l,u,c,f=this,h=f.NT,p=f._zoomFactor,d=f.wT.WU;if(d.XU){if(e=f.YU(),n=t.pageX/p-d.x+e.x,o=t.pageY/p-d.y+e.y,0===n&&0===o)return;r=f.EU(f.WE,f.aS),s=i.GC$(f.TU),d.ZU<0?(l=d.$U.x+n,u=d.$U.y+o,a=f.cU(Y(l,u)),s.css([E.fGc,E.OLb],[a.x+h-r.x,a.y+h-r.y])):(c=f._U(n,o,d.ZU),a=f.cU(Y(c.x,c.y)),s.css([E.fGc,E.OLb,E.iGc,E.jGc],[a.x+h-r.x,a.y+h-r.y,Q(c)*p-2*h-2,Z(c)*p-2*h-2]))}},t.prototype.IU=function(){var t,e=this,n=e.kT;e.ST()||(t=e.wT.xT,i.GC$(e.qo).remove(),e.YT(),i.GC$(t).remove(),i.GC$(e.ET).append(t),e.aV(t),e.BU(t),i.GC$(t).focus(),t.selectionStart=t.value.length,e.TT(),2!==n.commentState()&&n.commentState(2))},t.prototype.HU=function(){var e,n=this,o=n.kT,r=o.kj;n.ST()&&(e=n.wT.xT,n.$T(),i.GC$(e).remove(),i.GC$(n.ET).append(n.qo),n.aV(n.qo),n.UT(),t.ao(n,"detachEditor",n.qo),2===o.commentState()&&o.commentState(3),i.GC$(e).val()!==o.text()&&r.wu().execute({cmd:"changeComment",sheetName:r.name(),row:o.nT,col:o.oT,oldValue:o.text(),newValue:i.GC$(e).val(),propertyName:E.EGc}))},t.prototype.bV=function(t){var e=this.kT.kj,n=-1;return 0===t||2===t?n=e.getViewportHeight(t):1===t&&(n=S(e,e.getViewportBottomRow(0)+1,rt(e,2)+1,!0)),n},t.prototype.cV=function(t){var e=this.kT.kj,n=-1;return 0===t||2===t?n=e.getViewportWidth(t):1===t&&(n=S(e,e.getViewportRightColumn(0)+1,ot(e,2)+1,!1)),n},t.prototype.EU=function(t,e){var n=this.kT.kj.am(),o=n.Ft(t,e);return 0===t&&0===e||0===t&&2===e||2===t&&0===e||2===t&&2===e?o=X(0,0,n.hs+n.er+n.js,n.fs+n.jr+n.gs):0===t&&1===e||2===t&&1===e?o=X(n.hs,0,n.er,n.fs+n.jr+n.gs):1===t&&0===e||1===t&&2===e?o=X(0,n.fs,n.hs+n.er+n.js,n.jr):1===t&&1===e&&(o=X(n.hs,n.fs,n.er,n.jr)),o},t.prototype.aV=function(t){var e=this,n=e.kT,o=i.GC$(t);t!==e.BF&&t!==e.qo||(t===e.BF?t.value=n.text():t.innerHTML=R.Ob(n.text()),o.css([E.NGc,E.OGc,E.PGc,E.QGc,E.RGc,E.XGc,E.YGc,E.bHc],[n.fontFamily(),n.fontStyle(),n.fontSize(),n.fontWeight(),n.foreColor(),n.backColor(),n.horizontalAlign(),n.textDecoration()]),n.padding()?o.css(E.sGc,""+n.padding()):o.css(E.sGc,"0px"))},t.prototype.sU=function(){return!(!this.JT||!this.JT.parentNode)},t.prototype.ST=function(){var t=this;return t.sU()&&t.kT===t.wT.JU()&&i.GC$(t.ET).find(E.SGc).length>0},t.prototype.dV=function(){var t,e=this,n=e.kT.kj,o=l;return e.sU()&&(t=n.am(),o=X(e.AT.x+t.zr+t.Br,e.AT.y+t.Ar+t.Cr,e._T(),e.aU())),o},t.prototype.eV=function(){var t,e,n,o=this,r=o.kT,i=o._zoomFactor;return o.sU()&&(t=o.dV())?(void 0,void 0,void 0,void 0,n=e=(o.NT+r.borderWidth())*i,X(t.x+e,t.y+n,Q(t)-2*e,Z(t)-2*n)):l},t.prototype.fV=function(t){var e,n=this,o=n.kT,r=o.kj,i=t.target,a=n.wT.WU,s=i.style,l=g;a.XU?i[E.CGc]!==n.HT&&i[E.CGc]!==n.FT&&i[E.CGc]!==n.IT&&i[E.CGc]!==E.BGc+"floatPanel"||(l=a.ZU>=0?"crosshair":E.dGc):i[E.CGc]===n.HT?!J(r)&&o.lockText()?o.locked()||(l=E.dGc):l=E.EGc:i[E.CGc]!==n.FT&&i[E.CGc]!==n.GT||J(r,o)&&(l=(e=n.gV(t))>=0&&e<n.MT.length?n.MT[e].cursor:E.dGc),s[E.DGc]=l},t.prototype.hV=function(e){var n,o=this,r=o.kT,i=r&&r.kj;if(i.endEdit()&&(n={e:e,r:l},t.ao(o,"preProcessMouseDownEdit",n),!n.r))return i.Wq(T.FloatingElementSelected,{type:"comments"}),o.wT.GU(r),r.commentState(2),o.CD(e),x(e)},t.prototype.iV=function(e){var n,o,r,i,a,s=this,u=s.kT,c=u&&u.kj,f=s._zoomFactor,h=s.wT,p=h.WU;c.endEdit()&&(n={e:e,r:l},t.ao(s,"preProcessMouseDownDragResize",n),n.r||(c.Wq(T.FloatingElementSelected,{type:"comments"}),p.x=e.pageX/f,p.y=e.pageY/f,p.$U=X(u.location().x,u.location().y,u.width(),u.height()),p.ZU=s.gV(e),s.tC(),p.XU=!0,s.fV(e),h.GU(u),u.commentState(F.active),J(c,u)&&(s.eS={},s.eS.jV=rt(c,s.WE),s.eS.kV=ot(c,s.aS),s.SU(),p.ZU<0?s.qS=!0:s.kv=!0),o=c.mm,r=c.Vs(),i=Y(e.pageX-r.left,e.pageY-r.top),a=c.hitTest(i.x,i.y),o.rG={KG:a.rowViewportIndex,MG:a.colViewportIndex,sG:a.hitTestType},o.$F=i,o.qG(),o.lV=!0,e.stopPropagation()))},t.prototype.yT=function(t,e,n){var o,r,i,a,s,l,u=this,c=u.kT,f=c&&c.kj,h=u.NT,p=u._zoomFactor,g=u.aS,m=u.WE,y=u.EU(m,g),v=void 0!==e?e*p:u._T(),C=void 0!==n?n*p:u.aU(),b=t.x,w=t.y,T=f.am(),x=u.dU(f,0,0,m,g),A=t.x+(0-(x.x-T.Br))+v-h,I=t.y+(0-(x.y-T.Cr))+C-h,R=0,k=0,M=0,N=0;return 0===g?(R=0-h,M=Q(T)-T.Br):1===g?(o=S(f,f.getViewportRightColumn(0)+1,ot(f,1),!1),R=y.x-h-o,M=u.cV(2)):2===g&&(R=0-h,M=0),b<R&&(u.kv?v-=R-b:A+=R-b,b=R),1!==g&&2!==g||(M+=S(f,0,f.getColumnCount(),!1,A)),A>M&&(u.kv?v-=A-M:u.qS?b-=A-M:(r=u.wT.bU&&!c.ignoreDefaultLocation()?9:c.location().x,(a=b-(i=2*d(r)+nt(f,c.oT)+c.width()))>R?b=a:b<M?v-=A-M:(a=b-i,A-i>R||(a=b-(A-M)),a<R?(v-=R-a,b=R):b=a))),0===m?(k=0-h,N=Z(T)-T.Cr):1===m?(s=S(f,f.getViewportBottomRow(0)+1,rt(f,1),!0),k=y.y-h-s,N=u.bV(2)):(k=0-h,N=0),w<k&&(u.kv?C-=k-w:I+=k-w,w=k),1!==m&&2!==m||(N+=S(f,0,f.getRowCount(),!0,I)),I>N&&(u.kv?C-=I-N:u.qS?w-=I-N:I>N&&((l=w-(I-N))<k?(C-=k-l,w=k):w=l)),X(b,w,v/p,C/p)},t.prototype.YU=function(){var t=this,e=t.kT.kj,n=t.eS,o=n.jV,r=n.kV,i=rt(e,t.WE),a=ot(e,t.aS),s=S(e,o,i,!0),l=S(e,r,a,!1);return Y(r<a?l:-l,o<i?s:-s)},t.prototype.mV=function(t){var e,n,o,r,i,s,l,u,c,f,h=this,p=h.kT,d=p&&p.kj,g=h._zoomFactor,m=h.wT.WU,y=a.ChangeComment;if(m.XU){if(e=h.YU(),n=t.pageX/g-m.x+e.x,o=t.pageY/g-m.y+e.y,0===n&&0===o)return;r=void 0,i=void 0,m.ZU<0?(l=m.$U.x+n,u=m.$U.y+o,r=h.cU(Y(l,u)),i=h.yT(r),(s=h.eU(Y(i.x,i.y))).x===p.location().x&&s.x===p.location().y||d.wu().execute({cmd:"changeComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.location().clone(),newValue:s,propertyName:"location"})):(p.autoSize(!1),c=h._U(n,o,m.ZU),r=h.cU(Y(c.x,c.y)),i=h.yT(r,Q(c),Z(c)),f=[],(s=h.eU(Y(i.x,i.y))).x===p.location().x&&s.y===p.location().y||f.push(new y(d,{cmd:"changeComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.location().clone(),newValue:s,propertyName:"location"})),Q(i)!==p.width()&&f.push(new y(d,{cmd:"changeComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.width(),newValue:i.width,propertyName:E.iGc})),Z(i)!==p.height()&&f.push(new y(d,{cmd:"changeComment",sheetName:d.name(),row:p.nT,col:p.oT,oldValue:p.height(),newValue:i.height,propertyName:E.jGc})),f.length>0&&d.wu().execute({cmd:"changeCommentTransaction",sheetName:d.name(),commands:f}))}},t.prototype.BD=function(e){var n,o,r,i,a,s=this,u=s.kT.kj,c={e:e,r:l};if(t.ao(s,"preProcessMouseMove",c),!(c.r||(this.fV(e),u.getSelections()&&u.getSelections().length>0)))return n=s.wT,o=e.target,r=u.mm,i=u.Vs(),a=Y(e.pageX-i.left,e.pageY-i.top),o&&n.WU.XU&&(s.TU&&s.VU(e),1===s.WE&&(r.$F.y=a.y),1===s.aS&&(r.$F.x=a.x),r.NG()),x(e)},t.prototype.CD=function(e){var n,o,r,a=this,s=a.kT.kj,u={e:e,r:l};if(t.ao(a,"preProcessMouseUp",u),!(u.r||s.getSelections()&&s.getSelections().length>0))return n=e.target,o=a.wT,(r=s.mm).lV=!1,r.RG(),n&&(a.mV(e),a.UU&&(i.GC$(a.UU).remove(),a.UU=null,a.qS=!1,a.kv=!1),a.uC(),o.WU.XU=!1,a.fV(e)),x(e)},t.prototype.gV=function(t){var e,n,o,r,a,s=this,l=s.MT;if(l.length>0&&(s.NU===F.active||s.NU===F.edit))for(e=s.DT,n=t.pageX-i.GC$(e).offset().left,o=t.pageY-i.GC$(e).offset().top,r=0;r<l.length;r++)if((a=l[r])&&a.contains(n,o))return r;return-1},t.prototype._U=function(t,e,n){var o,r,i=-1,a=-1;switch(n){case 0:i=0,a=0;break;case 1:i=2,a=0;break;case 2:i=0,a=2;break;case 3:i=2,a=2;break;case 4:i=0,a=1;break;case 5:i=2,a=1;break;case 6:i=1,a=0;break;case 7:i=1,a=2}return o=this.nV(t,i),r=this.oV(e,a),X(o.x,r.y,o.w,r.h)},t.prototype.nV=function(t,e){var n,o,r=2*this.NT,i=this.wT.WU,a=Q(i.$U)-r;return 0===e?a-=t:2===e&&(a+=t),n=i.$U.x,a>=0?0===e&&(n+=t):0===e?n+=Q(i.$U)-r:2===e&&(n+=a),o=Q(i.$U),1!==e&&(o=d(a)+r),{x:n,w:o}},t.prototype.oV=function(t,e){var n,o,r=2*this.NT,i=this.wT.WU,a=Z(i.$U)-r;return 0===e?a-=t:2===e&&(a+=t),n=i.$U.y,a>=0?0===e&&(n+=t):0===e?n=Z(i.$U)-r:2===e&&(n+=a),o=Z(i.$U),1!==e&&(o=d(a)+r),{y:n,h:o}},t.prototype.FU=function(t){var e,n,o=this,r=o.kT.kj;if(t){switch(e=u,t){case o.DT:e=E.wGc;break;case o.ET:e=E.xGc;break;case o.KT:e=E.yGc;break;case o.qo:e=E.zGc;break;case o.BF:e=E.AGc}e&&(i.GC$(t).unbind(E.aHc+e).unbind(E.eGc+e),n=function(t){r.RF(t),x(t)},i.GC$(t).bind(E.aHc+e,n).bind(E.eGc+e,n))}},t.prototype.RT=function(t,e){var n,o=this,r=o.kT,a=r&&r.kj;o.XT(t,e),n=function(t){ut(a,t)},i.GC$(t).bind(E.ZGc+e,(function(t){o.iV(t)})).bind(E.$Gc+e,(function(t){o.BD(t)})).bind(E._Gc+e,(function(t){o.CD(t)})).bind(E.aHc+e,n).bind(E.eGc+e,n)},t.prototype.XT=function(t,e){i.GC$(t).unbind(e)},t.prototype.QT=function(){var t,e,n=this,o=n.kT,r=o&&o.kj,a=n.wT;n.ZT(),r&&(t=r.Vs(),e=function(t){r.RF(t)},i.GC$(n.LT).bind(E.ZGc+E.TGc,(function(e){var o,s,l=r.ITa.Ky.hitTest(e.pageX-t.left,e.pageY-t.top);l?(o=l.comment,s=a.pT(o),l.area===E.LGc?s.hV(e):l.area===E.MGc&&s.iV(e),i.GC$(s.JT).css(E.oGc,parseInt(i.GC$(n.KT).css(E.oGc)+1,10))):r.OF(e)})).bind(E.$Gc+E.TGc,(function(e){var o,i,s=r.ITa.Ky.hitTest(e.pageX-t.left,e.pageY-t.top),u=n.LT.style;s?(o=s.comment,a.pT(o).BD(e),s.area===E.LGc?u.cursor=E.EGc:s.area===E.MGc&&(u.cursor=E.dGc)):(r.PF(e),n.wT.tT(l),(i=r.Ws())&&(u.cursor=i.style.cursor))})).bind(E._Gc+E.TGc,(function(e){var n,o=r.ITa.Ky.hitTest(e.pageX-t.left,e.pageY-t.top);o?(n=o.comment,a.pT(n).CD(e)):r.QF(e)})).bind("dblclick"+E.TGc,(function(t){r.TF(t)})).bind(E.aHc+E.TGc,e).bind(E.eGc+E.TGc,e))},t.prototype.ZT=function(){i.GC$(this.LT).unbind(E.TGc)},t.prototype.UT=function(){var t,e=this,n=e.kT,o=n&&n.kj;n.commentState()!==F.edit&&e.qo&&(e.YT(),t=function(t){ut(o,t)},i.GC$(e.qo).bind(E.ZGc+E.zGc,(function(t){e.hV(t)})).bind(E.$Gc+E.zGc,(function(t){e.BD(t)})).bind(E._Gc+E.zGc,(function(t){e.CD(t)})).bind(E.aHc+E.zGc,t).bind(E.eGc+E.zGc,t))},t.prototype.YT=function(){var t=this;t.kT.commentState()!==F.edit&&t.qo&&i.GC$(t.qo).unbind(E.zGc)},t.prototype.TT=function(){var t,e=this,n=e.kT,o=n&&n.kj,r=e.BF;n.commentState()===F.edit&&r&&(this.$T(),t=function(t){o&&(o.RF(t),w.nl(t))},i.GC$(r).bind(E.ZGc+E.AGc,(function(t){t.stopPropagation()})).bind(E.$Gc+E.AGc,(function(t){t.stopPropagation()})).bind(E._Gc+E.AGc,(function(t){t.stopPropagation()})).bind(E.aHc+E.AGc,t).bind(E.eGc+E.AGc,t).bind("input"+E.AGc,(function(){n.autoSize()&&e.pV()})).bind("keydown"+E.AGc,(function(t){27!==t.keyCode&&9!==t.keyCode||(n.commentState(F.active),x(t),C.Zl(o))})).bind("focusout"+E.AGc,(function(){i.GC$(r).val()!==n.text()&&o.wu().execute({cmd:"changeComment",sheetName:o.name(),row:n.nT,col:n.oT,oldValue:n.text(),newValue:i.GC$(r).val(),propertyName:E.EGc})})))},t.prototype.pV=function(){var t,e,n,o,r,a,s,l,u,f,h,p,d,g,m,y=this,v=y.kT,C=v&&v.kj;if(v.commentState()===F.edit?e=(t=y.BF).value.split("\n"):(t=y.qo,e=R.Pb(t.innerHTML).split("\n")),n=i.GC$(t).height(),o=i.GC$(t).width(),s=0,u="",(l=t.style).font?(s=lt(e,u),u+=l.font):(v.fontStyle()&&(u+=E.IGc+v.fontStyle()),v.fontWeight()&&(u+=E.IGc+v.fontWeight()),v.fontSize()&&(u+=E.IGc+v.fontSize()),v.fontFamily()&&(u+=E.IGc+v.fontFamily()),s=lt(e,u)),f=s,5,e&&e.length>0){for(r=f,h=0,p=0;p<e.length;p++)h<(d=C.rt(e[p],u))&&(h=d);a=c(h,5)}else r=f,a=5;i.GC$(t).css(E.jGc,r).css(E.iGc,a),2===v.commentState()&&v.text(t.value),y.qV=!0,0!==(g=r-n)&&v.height(v.height()+g),0!==(m=a-o)&&v.width(v.width()+m),y.qV=!1},t.prototype.$T=function(){var t=this.BF;t&&i.GC$(t).unbind(E.AGc)},t.prototype.tC=function(){var t=this,e=t.wT.WU;e.XU||(i.GC$(M).bind(E.$Gc+E.UGc,(function(e){t.BD(e)})).bind(E._Gc+E.UGc,(function(e){t.CD(e)})),e.XU=!0)},t.prototype.uC=function(){var t=this.wT.WU;t.XU&&(t.XU=!1,i.GC$(M).unbind(E.UGc))},t}(),e.GV=H,r.Zn(H),V=function(){function t(t){var e=this;e.kj=t,e.WU={XU:!1,x:0,y:0,$U:l,ZU:-1},e.xT=l,e.bU=l,e.rV=l,e.sV=[],e.wTa=0,e.jT=[],e.tV(),e.uV(),e.xn={}}return t.prototype.dispose=function(t){var e=this;e.all().forEach((function(t){e.hT(t)})),e.Uka(),!1!==t&&(e.kj=l)},t.prototype.add=function(t,e,n){var o,r,a=this,s=a.kj,u=s.getSpan(t,e);return!u||u.row===t&&u.col===e?(o=a.get(t,e),r="string"==typeof n?new _(n):n,a.Cz(t,e,r),s.Bq("comment",t,e,i.SheetArea.viewport,o,r),r):l},t.prototype.Cz=function(t,e,n){var o=this,r=o.kj,i=o.sV;o.vV(t,e),n&&(r.ITa.UUa({type:"add",row:t,col:e}),n.nT=t,n.oT=e,n.kj=r,i.push(n),n.mi=o.wTa,o.wTa++,o.JUa(t,e,n),r.$p())},t.prototype.get=function(t,e){return this.xn[t+"_"+e]||l},t.prototype.JUa=function(t,e,n){this.xn[t+"_"+e]=n},t.prototype.VUa=function(t,e,n){var o=t.nT,r=t.oT;this.get(o,r)===t&&this.JUa(o,r,u),this.kj.ITa.UUa({type:"rowcol",comment:t,row:o,col:r}),t.nT=e,t.oT=n,this.JUa(e,n,t)},t.prototype.remove=function(t,e){var n=this.vV(t,e),o=this.kj;n&&(o.Bq("comment",t,e,i.SheetArea.viewport,n,u),o.$p())},t.prototype.vV=function(t,e){var n=this,o=n.kj,r=n.get(t,e);return r&&(o.ITa.UUa({type:"remove",row:t,col:e,comment:r}),n.hT(r),v.Fb(n.sV,r),v.Fb(n.jT,n.pT(r)),n.JUa(t,e,u)),r},t.prototype.clear=function(t){var e,n,o,r,i=this,a=i.kj,s=i.sV;for(a.suspendPaint(),e=s.length-1;e>=0;e--)o=(n=s[e]).nT,r=n.oT,(!t||o>=t.row&&o<t.row+t.rowCount&&r>=t.col&&r<t.col+t.colCount)&&i.remove(o,r);a.resumePaint()},t.prototype.all=function(){return this.sV.concat()},t.prototype.qUa=function(t,e,n,o,r,i){(t||o)&&(t&&this.VUa(t,r,i),o&&this.VUa(o,e,n))},t.prototype.getOuterContainer=function(t){var e=this.pT(t);return e?e.JT:l},t.prototype.tV=function(){var t=y(E.SGc);i.GC$(t).addClass("gc-comment-editor").css(E.fGc,0).css(E.OLb,0).css(E.kGc,E.lGc).css("margin",0).css(E.sGc,0).css("word-wrap","break-word").css("word-break","normal").css(E.mGc,E.pGc).css("resize","none").css("outline","none").css("border","0px").css(E.qGc,E.rGc).css(E.WGc,"normal").attr("autocomplete","off").attr("gcUIElement","gcEditingInput"),this.xT=t},t.prototype.uV=function(){var t=this,e=t.kj;e&&(e.Fu(T.ColumnChanged+E.vGc,(function(e,n){var o=n.propertyName;o!==E.iGc&&"isVisible"!==o||t.wV()})),e.Fu(T.RowChanged+E.vGc,(function(e,n){var o=n.propertyName;o!==E.jGc&&"isVisible"!==o||t.wV()})),e.Fu(T.ColumnWidthChanged+E.vGc,(function(){t.wV()})),e.Fu(T.RowHeightChanged+E.vGc,(function(){t.wV()})),e.Fu(T.CommentChanged+E.vGc,(function(e,n){var o,r,i,a;n&&(o=n.propertyName,r=n.comment,(i=t.pT(r))&&(a=["autoSize","text","fontFamily","fontStyle","fontSize","fontWeight","padding"],"location"===o?i.fU():o===E.iGc||o===E.jGc?i.gU():a.indexOf(o)>=0&&r.autoSize()&&!i.qV&&i.pV()))})))},t.prototype.Uka=function(){var t=this.kj;t&&t.Gu(E.vGc)},t.prototype.pT=function(t){var e,n,o=this.jT;if(t)for(e=0;e<o.length;e++)if((n=o[e]).kT===t)return n;return l},t.prototype.iT=function(){return 0===this.sV.length},t.prototype.xV=function(){var t,e,n,o=this.sV;if(o.length>0){for(t=o[0].zIndex(),e=1;e<o.length;e++)t<(n=o[e]).zIndex()&&(t=n.zIndex());return t}return 0},t.prototype.rI=function(t,e){var n,o,r,i,a=this,s=a.sV,l=a.jT;for(n=0;n<s.length;n++)t<=(o=s[n]).nT&&a.VUa(o,o.nT+e,o.oT);for(r=0;r<l.length;r++)(i=l[r]).sU()&&i.rI(t,e)},t.prototype.tI=function(t,e){var n,o,r,i,a=this,s=a.sV,l=a.jT;for(n=0;n<s.length;n++)t<=(o=s[n]).oT&&a.VUa(o,o.nT,o.oT+e);for(r=0;r<l.length;r++)(i=l[r]).sU()&&i.tI(t,e)},t.prototype.GR=function(t,e){var n,o,r,i,a,s=this,l=s.sV,u=s.jT;for(n=l.length-1;n>=0;n--)r=(o=l[n]).nT,i=o.oT,r>=t&&r<t+e&&s.remove(r,i);for(n=0;n<l.length;n++)t<(o=l[n]).nT&&s.VUa(o,o.nT-e,o.oT);for(n=0;n<u.length;n++)(a=u[n]).sU()&&a.GR(t,e)},t.prototype.HR=function(t,e){var n,o,r,i,a,s=this,l=s.sV,u=s.jT;for(n=l.length-1;n>=0;n--)r=(o=l[n]).nT,(i=o.oT)>=t&&i<t+e&&s.remove(r,i);for(n=0;n<l.length;n++)t<(o=l[n]).oT&&s.VUa(o,o.nT,o.oT-e);for(n=0;n<u.length;n++)(a=u[n]).sU()&&a.HR(t,e)},t.prototype.JU=function(){return this.rV},t.prototype.GU=function(t){var e=this;t&&t!==e.rV&&(e.vQ(),e.rV=t)},t.prototype.vQ=function(){var t,e=this,n=e.rV;n&&(!(t=e.pT(n))||t.qS||t.kv||(t.ST()&&t.HU(),n.commentState(F.normal),e.rV=l))},t.prototype.Ao=function(t){var e=this,n=e.pT(t),o=!1;n||(o=!0,n=new H(t,e),e.jT.push(n)),n.OT(),o&&t.autoSize()&&!n.qV&&n.pV()},t.prototype.tT=function(t){var e=this,n=e.rV;if(n)if(1===n.displayMode()){if(n.commentState()===F.edit)return}else if(n.commentState()===F.edit||n.commentState()===F.active)return;t!==e.bU&&(e.bU&&e.hT(e.bU),t&&2===t.displayMode()?e.WU.XU||t.yV||(e.bU=t,t.yV=N.setTimeout((function(){e.Ao(t)}),200)):e.bU=l)},t.prototype.hT=function(t){var e=this,n=e.pT(t);n&&n.sU()&&(n.WT(),t===e.rV&&e.kj.GJ()),clearTimeout(t.yV),delete t.yV},t.prototype.zV=function(){var t=this.kj.nQ&&this.kj.nQ();t&&i.GC$(t.PT).show()},t.prototype.AV=function(){var t=this.kj.nQ&&this.kj.nQ();t&&i.GC$(t.PT).hide()},t.prototype.BV=function(t,e,n){var o,r=this.pT(t);return!(!r||!(o=r.dV()))&&o.contains(e,n)},t.prototype.CV=function(t,e,n){var o,r=this.pT(t);return!(!r||!(o=r.eV()))&&o.contains(e,n)},t.prototype.hitTest=function(t,e){var n,o,r=this,i=l;for(n=0;n<r.sV.length;n++)o=r.sV[n],J(r.kj,o)&&r.BV(o,t,e)&&(i?o.zIndex()>i.zIndex()&&(i=o):i=o);return i?{x:t,y:e,comment:i,area:r.CV(i,t,e)?E.LGc:E.MGc}:l},t.prototype.KU=function(t){var e=this,n=e.xV();return t===e.bU?n+2:t===e.rV?n+1:t.zIndex()},t.prototype.wV=function(){this.jT.forEach((function(t){t.hU()}))},t.prototype.cQ=function(){this.jT.forEach((function(t){t.qT()}))},t.prototype.fromJSON=function(t,e){var n,o,r,i=this;if(t&&0!==t.length)for(i.wTa=0,n=0;n<t.length;n++)o=t[n],(r=new _).fromJSON(o,e),3!==r.commentState()&&(i.rV=r),i.kj.ITa.Ky.Cz(r.nT,r.oT,r)},t.prototype.toJSON=function(){var t,e,n=this.sV;if(!n||0===n.length)return u;for(t=[],e=0;e<n.length;e++)t.push(n[e].toJSON());return 0===t.length?u:t},t}(),z=function(){function t(t){var e=this;e.kj=l,e.oQ=!0,e.PT=e.DV(),t.appendChild(e.PT)}return t.prototype.no=function(){this.kj=l},t.prototype.DV=function(){var t=y(E.uGc);return i.GC$(t).addClass("gc-comment-layoutPanel"+E.IGc+E.HGc).css([E.kGc,E.fGc,E.OLb,E.jGc,E.iGc,E.mGc,E.oGc,E.JGc],[E.lGc,0,0,0,0,E.nGc,E.FGc,E.KGc]),t},t.prototype.rT=function(t){var e,n,o=this;t.ITa.Ky.iT()||(e=t.am(),i.GC$(o.PT).css(E.fGc,e.x+e.Br).css(E.OLb,e.y+e.Cr),o.kj!==t&&(o.kj&&((n=o.kj.ITa.Ky.JU())&&n.commentState()===F.edit&&n.commentState(F.active)),o.kj=t))},t.prototype.sT=function(t,e,n){var o,r,a,s=n.row,l=n.col,u=n.x,c=n.y,f=Q(n),h=Z(n);e===i.SheetArea.viewport&&this.kj&&((o=this.kj.ITa.Ky.get(s,l))&&(r=this.kj,a=(o.indicatorSize()||6)*(r?r.zoom():1),t&&f>0&&h>0&&(t.save(),t.rect(u,c,f,h),t.clip(),t.fillStyle=o.indicatorColor()||"red",t.beginPath(),t.moveTo(u+f-a,c),t.lineTo(u+f,c),t.lineTo(u+f,c+a),t.lineTo(u+f-a,c),t.fill(),t.restore())))},t.prototype.fT=function(t){var e,n,o,r,i,a,s;if(this.oQ){for(t.zV(),e=this.kj,n=t.all(),o=0;o<n.length;o++)r=n[o],i=t.pT(r),this.EV(t,r)?(1===r.displayMode()&&r===t.bU&&(t.bU=l),i&&i.sU()?i.VT():t.Ao(r)):i&&i.sU()&&t.hT(r);(a=t.JU())&&((s=t.pT(a))&&s.sU()&&e.getSelections().length>0&&e.ITa.do("clearSelection"))}else t.AV()},t.prototype.EV=function(t,e){var n=t.kj;if(n&&nt(n,e.oT)&&et(n,e.nT))switch(e.displayMode()){case 1:return!0;case 2:if(3!==e.commentState())return t&&e!==t.bU&&(t.bU=e),!0;if(e===t.bU)return!0}return!1},t}(),W=r.lUa,r.GC$.extend(W.prototype,{UUa:function(t){var e,n=this.zTa;n&&((e=n.WUa)||(e=n.WUa=[]),e.push(t))},XUa:function(t){var e,n,o,r,i,a;if(t)for(this,e=this.Ky,n=t.length-1;n>=0;n--)r=(o=t[n]).comment,"add"===o.type?e.vV(o.row,o.col):"remove"===o.type?e.Cz(o.row,o.col,o.comment):"property"===o.type?(i=o.name,a=o.value,r[i](a)):"rowcol"===o.type&&e.VUa(r,o.row,o.col)},wyb:function(t,e,n,o){var r,i;for(r=0;r<n;r++)for(i=0;i<o;i++)0===r&&0===i||this.getCell(t+r,e+i).comment()&&this.comments.remove(t+r,e+i)}}),W.$n("comments",{init:function(){this.Ky=new V(this.kj)},undo:function(t){var e=t.WUa;e&&this.XUa(e)},dispose:function(t){var e=this,n=t&&t.clearCache;e.Ky&&e.Ky.dispose(n),!1!==n&&(e.Ky=l)}}),U={init:function(){var t=this;t.comments=t.ITa.Ky,t.nQ=function(){var e=t.parent;if(e)return e.gT||(e.gT=new z(e.xv())),e.gT.kj=t,t.parent.gT}},dispose:function(t){!1!==t.clearCache&&(this.nQ=l,this.comments=l),j(this,i.GC$(this.Ws()))},setHost:function(t){if(t){var e=this.ITa.Ky;e&&e.uV(),O(t,this)}},onLayoutChanged:function(t){var e=this,n=e.ITa.Ky,o=t.changeType,a=t.row,s=t.rowCount,l=t.col,u=t.colCount;"addRows"===o?n.rI(a,s):"deletingRows"===o?n.GR(a,s):"addColumns"===o?n.tI(l,u):"deletingColumns"===o?n.HR(l,u):t.sheetArea===i.SheetArea.viewport&&("clear"===o?4==(4&t.type)&&n.clear(new r.Range(a,l,s,u)):"addSpan"===o?$.call(e,!0,a,l,s,u):"removeSpan"===o&&$.call(e,!1,a,l))},paint:function(t){this.ITa.Ky.iT()||(K.call(this),this.RP(t.clipRect))},paintCell:function(t){t.isPrinting||t.sheetArea!==i.SheetArea.viewport||tt.call(this,t.ctx,t.sheetArea,t.cell)},toJson:function(t,e){e&&e.ignoreStyle||(t.comments=this.ITa.Ky.toJSON())},fromJson:function(t,e,n){var o;n&&n.ignoreStyle||t&&((o=e?t.commentManager:t.comments)&&this.ITa.Ky.fromJSON(o,e))},lastNonNullRowAndCol:function(){var t,e,n,o,r=0,i=0,a=this.ITa.Ky;if(a&&((t=a.jT)&&t.length>0))for(e=0,n=t.length;e<n;e++)(o=t[e])&&o.kT&&(o.lT>r&&(r=o.lT),o.mT>i&&(i=o.mT));return{lastNonNullRow:r,lastNonNullCol:i}},clearSelection:function(){this.ITa.Ky.vQ()},processKeyDown:function(t){var e=this.ITa.Ky.JU();e&&this.mm.LH(t.e)&&(e.commentState(2),t.r=!0)}},s.$n("comments",U),q={init:function(){a.uT(this.commandManager())},dispose:function(){this.gT&&(this.gT.no(),this.gT=l)}},r.Workbook.$n("comments",q)},"./dist/plugins/conditional/conditional.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/conditional/conditional.js")),o(n("./dist/plugins/conditional/conditional.ns.js"))},"./dist/plugins/conditional/conditional.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht,Vt,zt,Wt,Ut,qt,Yt,Xt,Zt,Qt,Jt,$t,Kt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function te(t){return t.rowCount}function ee(t){return t.colCount}function ne(t,e,n,o){switch(o&&"string"==typeof e&&"string"==typeof n&&(e=e.toLowerCase(),n=n.toLowerCase()),t){case st.equalsTo:return e===n;case st.notEqualsTo:return e!==n;case st.greaterThan:return e>n;case st.greaterThanOrEqualsTo:return e>=n;case st.lessThan:return e<n;case st.lessThanOrEqualsTo:return e<=n;default:return!1}}function oe(t,e,n,o,r,i,a,s,l){var u=Math.round;switch(t.lineWidth=1,t.rect(i,a,s,l),n=u(++n),o=u(o),t.clip(),e.iconSetType){case 10:case 15:case 1:case 11:case 16:case 0:c.drawArrows(t,e.iconSetType,e.iconIndex,n,o,r);break;case 2:c.drawIconTypeIsTwo(t,e.iconSetType,e.iconIndex,n,o,r);break;case 3:c.drawStar(t,e.iconSetType,e.iconIndex,n,o,r);break;case 14:case 12:case 5:c.drawCircle(t,e.iconSetType,e.iconIndex,n,o,r);break;case 4:c.drawFlag(t,e.iconSetType,e.iconIndex,n,o,r);break;case 6:c.drawTrafficLight(t,e.iconSetType,e.iconIndex,n,o,r);break;case 7:c.drawIconTypeIsSen(t,e.iconSetType,e.iconIndex,n,o,r);break;case 8:c.drawIconTypeIsEight(t,e.iconSetType,e.iconIndex,n,o,r);break;case 9:c.drawIconTypeIsNine(t,e.iconSetType,e.iconIndex,n,o,r);break;case 18:c.drawSector(t,e.iconSetType,e.iconIndex,n,o,r);break;case 17:case 13:c.drawSignal(t,e.iconSetType,e.iconIndex,n,o,r);break;case 19:c.drawMagicCube(t,e.iconSetType,e.iconIndex,n,o,r)}}function re(t,e,n,o){var r=e.ranges(),i=P(r),a=u.formulaToExpression(t,n,i.r,i.c,o);return u.expressionToFormula(t,a,i.r,i.c,!o)}function ie(t){return"string"==typeof t&&("="!==(t=f.trim(t))[0]&&(t='="'+h.Gb(t,'"','""')+'"')),t}function ae(t,e){if(e)for(var n=0;n<e.length;n++)t.push(e[n])}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("@grapecity/js-calc"),a=n("./dist/plugins/conditional/conditional.ns.js"),s=n("@grapecity/js-calc"),l=n("Core"),u=n("SheetsCalc"),c=n("./dist/plugins/conditional/conditionalFormatIcon.js"),f=r.GC$,h=o.Common.u,p=null,d=void 0,g="undefined",m="string",y=Math.min,v=Math.max,C=Math.abs,b=Math.floor,w=Math.ceil,T=i.Convert,x=T.Na,S=T.Pa,A=T.Th,I=o.Common.u,R=I.Db,k=I.kb,M=I.jb,N=I.Bb,E=o.Common.j.Fa,D=o.Common.q,O=o.Common.F,j=r.Ul,F=j.T$a,P=j.l_a,_=!!i,L=r.Style,B=o.Common.k,G=o.Common.pc,H=G.bc,V=r.kf,z=r.Range,W=o.Common.l,U=o.Common.k,q=U.Fb,Y=U.Cb,X=U.ac,Z=i.Functions,Q=i.evaluateOperator,J=r.Rm,$=new o.Common.ResourceManager(a.SR),K=$.getResource.bind($),tt=function(t){var e=t.row<0?u.BAND_INDEX_CONST:t.row,n=t.col<0?u.BAND_INDEX_CONST:t.col;return s.uf(p,p,e,n,e+t.rowCount-1,n+t.colCount-1)},et=function(t){var e;if(t instanceof i.Expression)e=t;else if(t instanceof z)e=tt(t);else{if(!x(t))throw K().Exp_NotSupport;t=S(t),isNaN(t)||((e=new i.Expression(2)).value=t)}return e},nt=function(t,e,n,o){var r=t,i=e,a=function(t,e){var a,s,l=this;return l.hasOwnProperty("_ps")||(l._ps={}),a=l._ps,0===arguments.length?a[r]!==d?o?o.call(l,a[r]):a[r]:i:(a[r]!==t&&(s=a[r]!==d?a[r]:i,a[r]=t,!1!==e&&n&&n.call(l,t,s)),l)};return a.isDefault=function(t){return t===i},a},ot=function(t,e,n){var o=this;return n||(n={}),e||(e=o),f.each(e,(function(e,r){var i,a=o[r];E(a)||(i=a.call(o),"formula"===r?(o.getFormulaString?i=o.getFormulaString(t,d,d,!0):o.condition()&&o.condition().getFormulaString&&(i=o.condition().getFormulaString(t,d,d,!0)),i&&(n[r]=i)):"iconCriteria"===r||"icons"===r?n[r]=i:W.Ska(i)?n[r]=W.Daa(i):i&&i.toJSON?n[r]=i.toJSON(t):E(i)||a.isDefault(i)||(n[r]=i))})),n},rt=function(t,n,o,r){if(o){var i,a=this;n||(n=a),f.each(n,(function(n,s){var l,u,c,h,p,d,g,y,v,C;if(i=o[s],!E(i))if("ranges"===s){for(l=[],u=0;u<i.length;u++)c=i[u],l.push(V(c.row,c.col,te(c),ee(c)));a.ranges(l,!1)}else if("style"===s)a.style(new L,!1),a.style().fromJSON(i,r);else if("iconCriteria"===s)for(h=i.length,p=0;p<h;p++)d=i[p],a.NV[p]=new Xt(d.isGreaterThanOrEqualTo,d.iconValueType,d.iconValue);else if("icons"===s)for(g=i.length,y=0;y<g;y++)v=i[y],a.CZa[y]={iconSetType:v.iconSetType,iconIndex:v.iconIndex};else"iconSetType"===s?a[s](i,!0):"item1"===s||"item2"===s?(a[s](e.$V(),!1),a[s]().fromJSON(i,t)):"expected"===s?f.getType(i)!==m||5!==o.conType&&13!==o.conType?a[s](i,!1):"/OADate("===i.substr(0,8)?a[s](W.Rka(i),!1):a[s](new Date(i)):"condition"===s?((C=new Ft).fromJSON(i,t),a.condition(C,!1)):f.getType(i)===m&&"/OADate("===i.substr(0,8)?a[s](W.Rka(i),!1):a[s](i,!1)}))}},it=r.lUa,f.extend(it.prototype,{YUa:function(){var t=this.zTa;t&&!t.ZUa&&(t.ZUa=this.U5.AW.map((function(t){return{rule:t,ranges:t.ranges().slice()}})))},$Ua:function(t){var e=this.U5,n=this.kj;n.suspendPaint(),t&&(e.AW=t.map((function(t){var e=t.rule;return e.ranges(t.ranges),e})),e.QV()),n.resumePaint()},_Ua:function(t,e,n){this.YUa(),this.U5.rI(t,e,n)},aVa:function(t,e){this.YUa(),this.U5.GR(t,e)},bVa:function(t,e,n){this.YUa(),this.U5.tI(t,e,n)},cVa:function(t,e){this.YUa(),this.U5.HR(t,e)},dVa:function(){this.YUa(),this.U5.Nm()},eVa:function(){this.YUa(),this.U5.QV()}}),it.$n("conditionalFormat",{init:function(){this.U5=new $t(this.kj)},undo:function(t){var e=t.ZUa;e&&this.$Ua(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.U5&&(e.U5.no(),e.U5=p)}}),at={init:function(){this.conditionalFormats=this.ITa.U5},dispose:function(t){if(!1!==t.clearCache){var e=this.conditionalFormats;e&&e.OV()}},onLayoutChanged:function(t){var e=t.changeType,n=t.row,o=te(t),r=t.col,i=ee(t),a=t.sheetArea,s=this.ITa,l=this.tables;"addRows"===e?s._Ua(n,o,l&&l.KFc(n,-1,o,-1,!0)):"deleteRows"===e?s.aVa(n,o):"addColumns"===e?s.bVa(r,i):"deleteColumns"===e?s.cVa(r,i):"clear"===e?s.dVa():"setColumnCount"!==e&&"setRowCount"!==e||3!==a&&1!==a||s.eVa()},toJson:function(t,e){var n=this.conditionalFormats,o=e&&e.ignoreStyle;n&&!o&&(t.conditionalFormats=n.toJSON(this))},fromJson:function(t,e,n){var o=n&&n.ignoreStyle;t&&t.conditionalFormats&&!o&&this.conditionalFormats.fromJSON(t.conditionalFormats,this,e)}},r.Worksheet.$n("conditionalFormat",at),r.Workbook.$n("conditionalFormat",{fromJson:function(t,e,n){this.sheets.forEach((function(t){t.conditionalFormats&&t.conditionalFormats.getRules().forEach((function(t){t.S$a()}))}))}}),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqualsTo=5]="lessThanOrEqualsTo"}(st=e.GeneralComparisonOperators||(e.GeneralComparisonOperators={})),lt=[9,10,13,14,11,12],function(t){t[t.or=0]="or",t[t.and=1]="and"}(ut=e.LogicalOperators||(e.LogicalOperators={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.greaterThan=2]="greaterThan",t[t.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",t[t.lessThan=4]="lessThan",t[t.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",t[t.between=6]="between",t[t.notBetween=7]="notBetween"}(ct=e.ComparisonOperators||(e.ComparisonOperators={})),function(t){t[t.contains=0]="contains",t[t.doesNotContain=1]="doesNotContain",t[t.beginsWith=2]="beginsWith",t[t.endsWith=3]="endsWith"}(e.TextComparisonOperators||(e.TextComparisonOperators={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.beginsWith=2]="beginsWith",t[t.doesNotBeginWith=3]="doesNotBeginWith",t[t.endsWith=4]="endsWith",t[t.doesNotEndWith=5]="doesNotEndWith",t[t.contains=6]="contains",t[t.doesNotContain=7]="doesNotContain"}(ft=e.TextCompareType||(e.TextCompareType={})),function(t){t[t.backgroundColor=0]="backgroundColor",t[t.foregroundColor=1]="foregroundColor"}(ht=e.ColorCompareType||(e.ColorCompareType={})),function(t){t[t.empty=0]="empty",t[t.nonEmpty=1]="nonEmpty",t[t.error=2]="error",t[t.nonError=3]="nonError",t[t.formula=4]="formula"}(pt=e.CustomValueType||(e.CustomValueType={})),function(t){t[t.equalsTo=0]="equalsTo",t[t.notEqualsTo=1]="notEqualsTo",t[t.before=2]="before",t[t.beforeEqualsTo=3]="beforeEqualsTo",t[t.after=4]="after",t[t.afterEqualsTo=5]="afterEqualsTo"}(dt=e.DateCompareType||(e.DateCompareType={})),function(t){t[t.dateOccurring=0]="dateOccurring",t[t.yearOccurring=1]="yearOccurring",t[t.quarterOccurring=2]="quarterOccurring",t[t.monthOccurring=3]="monthOccurring",t[t.weekOccurring=4]="weekOccurring",t[t.dayOccurring=5]="dayOccurring",t[t.yearTodate=6]="yearTodate"}(gt=e.DateExConditionExpectType||(e.DateExConditionExpectType={})),function(t){t[t.top=0]="top",t[t.bottom=1]="bottom"}(e.Top10ConditionType||(e.Top10ConditionType={})),function(t){t[t.today=0]="today",t[t.yesterday=1]="yesterday",t[t.tomorrow=2]="tomorrow",t[t.last7Days=3]="last7Days",t[t.thisMonth=4]="thisMonth",t[t.lastMonth=5]="lastMonth",t[t.nextMonth=6]="nextMonth",t[t.thisWeek=7]="thisWeek",t[t.lastWeek=8]="lastWeek",t[t.nextWeek=9]="nextWeek",t[t.nextQuarter=10]="nextQuarter",t[t.thisQuarter=11]="thisQuarter",t[t.lastQuarter=12]="lastQuarter",t[t.nextYear=13]="nextYear",t[t.thisYear=14]="thisYear",t[t.lastYear=15]="lastYear"}(mt=e.DateOccurringType||(e.DateOccurringType={})),function(t){t[t.quarter1=0]="quarter1",t[t.quarter2=1]="quarter2",t[t.quarter3=2]="quarter3",t[t.quarter4=3]="quarter4"}(yt=e.QuarterType||(e.QuarterType={})),function(t){t[t.above=0]="above",t[t.below=1]="below",t[t.equalOrAbove=2]="equalOrAbove",t[t.equalOrBelow=3]="equalOrBelow",t[t.above1StdDev=4]="above1StdDev",t[t.below1StdDev=5]="below1StdDev",t[t.above2StdDev=6]="above2StdDev",t[t.below2StdDev=7]="below2StdDev",t[t.above3StdDev=8]="above3StdDev",t[t.below3StdDev=9]="below3StdDev"}(vt=e.AverageConditionType||(e.AverageConditionType={})),function(t){t[t.number=0]="number",t[t.lowestValue=1]="lowestValue",t[t.highestValue=2]="highestValue",t[t.percent=3]="percent",t[t.percentile=4]="percentile",t[t.automin=5]="automin",t[t.formula=6]="formula",t[t.automax=7]="automax"}(Ct=e.ScaleValueType||(e.ScaleValueType={})),function(t){t[t.leftToRight=0]="leftToRight",t[t.rightToLeft=1]="rightToLeft"}(e.BarDirection||(e.BarDirection={})),function(t){t[t.automatic=0]="automatic",t[t.cellMidPoint=1]="cellMidPoint",t[t.none=2]="none"}(e.DataBarAxisPosition||(e.DataBarAxisPosition={})),function(t){t[t.threeArrowsColored=0]="threeArrowsColored",t[t.threeArrowsGray=1]="threeArrowsGray",t[t.threeTriangles=2]="threeTriangles",t[t.threeStars=3]="threeStars",t[t.threeFlags=4]="threeFlags",t[t.threeTrafficLightsUnrimmed=5]="threeTrafficLightsUnrimmed",t[t.threeTrafficLightsRimmed=6]="threeTrafficLightsRimmed",t[t.threeSigns=7]="threeSigns",t[t.threeSymbolsCircled=8]="threeSymbolsCircled",t[t.threeSymbolsUncircled=9]="threeSymbolsUncircled",t[t.fourArrowsColored=10]="fourArrowsColored",t[t.fourArrowsGray=11]="fourArrowsGray",t[t.fourRedToBlack=12]="fourRedToBlack",t[t.fourRatings=13]="fourRatings",t[t.fourTrafficLights=14]="fourTrafficLights",t[t.fiveArrowsColored=15]="fiveArrowsColored",t[t.fiveArrowsGray=16]="fiveArrowsGray",t[t.fiveRatings=17]="fiveRatings",t[t.fiveQuarters=18]="fiveQuarters",t[t.fiveBoxes=19]="fiveBoxes",t[t.noIcons=20]="noIcons"}(bt=e.IconSetType||(e.IconSetType={})),function(t){t[t.number=1]="number",t[t.percent=4]="percent",t[t.formula=7]="formula",t[t.percentile=5]="percentile"}(wt=e.IconValueType||(e.IconValueType={})),function(t){t[t.relationCondition=0]="relationCondition",t[t.numberCondition=1]="numberCondition",t[t.textCondition=2]="textCondition",t[t.colorCondition=3]="colorCondition",t[t.formulaCondition=4]="formulaCondition",t[t.dateCondition=5]="dateCondition",t[t.dateExCondition=6]="dateExCondition",t[t.textLengthCondition=7]="textLengthCondition",t[t.top10Condition=8]="top10Condition",t[t.uniqueCondition=9]="uniqueCondition",t[t.averageCondition=10]="averageCondition",t[t.cellValueCondition=11]="cellValueCondition",t[t.areaCondition=12]="areaCondition",t[t.timeCondition=13]="timeCondition"}(Tt=e.ConditionType||(e.ConditionType={})),function(t){t[t.conditionRuleBase=0]="conditionRuleBase",t[t.cellValueRule=1]="cellValueRule",t[t.specificTextRule=2]="specificTextRule",t[t.formulaRule=3]="formulaRule",t[t.dateOccurringRule=4]="dateOccurringRule",t[t.top10Rule=5]="top10Rule",t[t.uniqueRule=6]="uniqueRule",t[t.duplicateRule=7]="duplicateRule",t[t.averageRule=8]="averageRule",t[t.twoScaleRule=10]="twoScaleRule",t[t.threeScaleRule=11]="threeScaleRule",t[t.dataBarRule=12]="dataBarRule",t[t.iconSetRule=13]="iconSetRule"}(xt=e.RuleType||(e.RuleType={})),St=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0,0)},At=function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),23,59,59,999)},It=function(t,e){t.setDate(e)},Rt=function(t){return t.getDate()},kt=function(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()},Mt=function(t,e){return e>At(t)},Nt=function(t,e){return e<St(t)},Et=function(t,e){return t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes()&&t.getSeconds()===e.getSeconds()&&t.getMilliseconds()===e.getMilliseconds()},Dt=function(t,e){var n=new Date(1899,11,30,t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());return new Date(1899,11,30,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())>n},Ot=function(t,e){return!Dt(t,e)&&!Et(t,e)},e.$V=function(t,e,n,o,r,i,a,s,l){return new Ft(t,{compareType:e,expected:n,formula:o,customValueType:r,type:i,ranges:a,item1:s,item2:l})},e.Cxb=new L,jt=["conType","compareType","item1","item2","ignoreBlank","expected","formula","treatNullValueAsZero","integerValue","forceValue2Text","useWildCards","ignoreCase","customValueType","expectTypeId","type","ranges","isPercent","regex"],Ft=function(){function t(t,e){var n,o;e||(e={}),n=e.formula,(o=this).offsetRow=0,o.offsetCol=0,o.conType("string"==typeof t?Tt[t]:t),E(e.compareType)||o.RV(e.compareType),E(e.expected)||o.expected(e.expected),E(n)||o.formula("string"==typeof n?R(f.trim(n),"="):n),E(e.item1)||o.item1(e.item1),E(e.item2)||o.item2(e.item2),E(e.customValueType)||o.customValueType(e.customValueType),E(e.type)||o.type(e.type),o.ranges(e.ranges),o.Lf=p,o.TV=p}return t.prototype.context=function(t){if(1===arguments.length){this.xc=t;var e=this.item1(),n=this.item2();e&&e.context&&e.context(t),n&&n.context&&n.context(t)}return this.xc},t.prototype.j_a=function(t){var e=this,n=e.item1(),o=e.item2();t?e.q$a=!0:e.p$a=!0,n&&n.j_a(t),o&&o.j_a(t)},t.prototype.k_a=function(){var t=this,e=t.item1(),n=t.item2();delete t.q$a,delete t.p$a,e&&e.k_a(),n&&n.k_a()},t.prototype.initExpression=function(t,e,n){var o,r,i,a,s,l=this.item1(),u=this.item2();l&&l.initExpression&&l.initExpression(),u&&u.initExpression&&u.initExpression(),t=t||this.xc,o=this.Yw,t&&o&&!this.Lf&&(this.ranges()?(e=(r=P(this.ranges())).r,n=r.c):(e=e||0,n=n||0),i=t.getCalcService(),a=t.yj(),i&&a&&(s=!1,this.q$a&&(s=!this.p$a),this.Lf=i.parse(a,o,e,n,!1,!0,s)))},t.prototype.expression=function(t,e,n,o){var r,i,a;return 1===arguments.length?(this.Lf=t,e=e||this.xc,t?e&&(this.ranges()?(n=(r=P(this.ranges())).r,o=r.c):(n=n||0,o=o||0),i=e.getCalcService(),a=e.yj(),i&&a&&(this.Yw=i.unparse(a,t,n,o))):this.Yw=t,this.Lf):(this.Lf||this.initExpression(e,n,o),this.Lf)},t.prototype.getFormulaString=function(t,e,n,o){var r,i,a;return t=t||this.xc,r=this.Lf,i=this.Yw,t&&i?(r||(this.initExpression(t,e,n),r=this.Lf),a=P(this.ranges()),e=E(e)?a.r:e,n=E(n)?a.c:n,t.getCalcService().unparse(t.yj(),r,e,n,d,!!o)):i},t.prototype.formula=function(t,e,n){if("string"!=typeof t){var o=this.item1(),r=this.item2();return 0===n&&o&&o.formula?o.formula(t,e,n):1===n&&r&&r.formula?r.formula(t,e,n):this.getFormulaString(d,t,e)}this.Yw=t,this.Lf=p},t.prototype.adjustOffset=function(t,e){var n=this,o=n.item1();o&&o.adjustOffset&&o.adjustOffset(t,e),(o=n.item2())&&o.adjustOffset&&o.adjustOffset(t,e),n.offsetRow=t,n.offsetCol=e},t.prototype.relationConditionEvaluate=function(t,e,n,o,r){var i,a,s=this;function l(o,r){if(t&&o&&3===o.conType()){var i=t.getActualStyle(e,n,3,!0);i&&(0===o.RV()?r=i.backColor:1===o.RV()&&(r=i.foreColor))}return r}function u(t,e){if(t)return t.ignoreBlank(s.ignoreBlank()),arguments.length<5?l(t,o):e}function c(o,r){return!E(o)&&o.evaluate(t,e,n,r)}return i=u(s.item1(),o),a=u(s.item2(),r),(c(s.item1(),i)?1:0)+(c(s.item2(),a)?1:0)>s.RV()},t.prototype.cellValueConditionEvaluate=function(t,e,n,o){var r=this.getExpected(t,e,n);return!(r!==p||!t||!t.lRa)||this.cellValueConditionCheckCondition(r,o)},t.prototype.cellValueConditionCheckCondition=function(t,e){var n,o,r,i=0,a=!1,s=this.RV();if(E(e)&&E(t))switch(s){case st.equalsTo:case st.greaterThanOrEqualsTo:case st.lessThanOrEqualsTo:return!0;case st.notEqualsTo:case st.greaterThan:case st.lessThan:default:return!1}return"boolean"==typeof t||"boolean"==typeof e?ne(s,e,t):(n={},E(e)?this.treatNullValueAsZero()?a=!0:i=e:"boolean"!=typeof e&&A(e,n)&&(i=n.value,a=!isNaN(i)),o=0,r=!1,A(t,n)&&(o=n.value,r=!0),a?r?ne(s,i,o):s===st.notEqualsTo:"string"==typeof e?r?Q(lt[s],e,o):"string"==typeof t?ne(s,e,t,!0):1===s:!!E(e)&&s===st.notEqualsTo)},t.prototype.numberConditionEvaluate=function(t,e,n,o){var r=this.numberConditionGetExpected(t,e,n);return!(r!==p||!t||!t.lRa)||(this.integerValue()&&(r=isNaN(r)?p:r>0?b(r):w(r)),this.numberConditionCheckCondition(r,o))},t.prototype.numberConditionCheckCondition=function(t,e){var n,o,r=this;if((E(e)||""===e)&&r.ignoreBlank())return!0;if(isNaN(e))return!1;if(E(t)){if(r.ignoreBlank())return!0;t=0}try{n=parseFloat(e)}catch(t){return!1}return!(r.integerValue()&&(o=n-b(n)==0,!o))&&ne(r.RV(),n,t)},t.prototype.numberConditionGetExpected=function(t,e,n){var o,r=this;return r.Yw&&r.Yw.length>0?(o=t.Cf())?o.evaluate(t.yj(),r.expression(p,t),e,n):r.expected():r.expected()},t.prototype.textConditionEvaluate=function(t,e,n,o){var r,i,a,s=this,l=s.compareType(),u=s.ignoreCase();function c(t,e){return s.testTextByCondition(e,t,"^","$",(function(){return u?t.toLowerCase()===e.toLowerCase():t===e}))}function f(t,e){return s.testTextByCondition(e,t,"^","",(function(){return k(e,t,u)}))}function h(t,e){return s.testTextByCondition(e,t,"","$",(function(){return M(e,t,u)}))}function g(t,e){return s.testTextByCondition(e,t,"","",(function(){return N(e,t===d||t===p?"":t,u)}))}if(!s.forceValue2Text()&&O(o,Date))return l!==ft.beginsWith&&l!==ft.endsWith&&l!==ft.contains&&(l===ft.doesNotBeginWith||l===ft.doesNotEndWith||l===ft.doesNotContain);if(r=E(o)?"":""+o,s.ignoreBlank()&&""===r)return!0;if(i=this.getExpected(t,e,n),a=E(i)?"":""+i,s.hasWildcard(a)&&"number"==typeof o)return l===ft.doesNotBeginWith||l===ft.doesNotContain||l===ft.doesNotEndWith||l===ft.notEqualsTo;switch(l){case ft.equalsTo:return c(a,r);case ft.notEqualsTo:return!c(a,r);case ft.beginsWith:return f(a,r);case ft.doesNotBeginWith:return!f(a,r);case ft.endsWith:return h(a,r);case ft.doesNotEndWith:return!h(a,r);case ft.contains:return g(a,r);case ft.doesNotContain:return!g(a,r);default:return!1}},t.prototype.hasWildcard=function(t){return t.indexOf("*")>-1||t.indexOf("?")>-1},t.prototype.testTextByCondition=function(t,e,n,o,r){var i;return this.useWildCards()?this.regex()?D.qb(this.regex()).test(t):(i=D.ub(e))?(i=n+i+o,this.ignoreCase()?D.sb(i).test(t):D.qb(i).test(t)):r():r()},t.prototype.colorConditionEvaluate=function(t,e,n,r){var i,a,s,l;function u(t){return E(t)||""===t?p:G.ec(t)}if(a=u((i=this).expected()),E(a)||""===a){if(i.ignoreBlank()||E(a)&&E(r))return!0}else if(s=u(r),(E(s)||""===s)&&t&&t.getDefaultStyle&&(l=t.getDefaultStyle(),i.RV()===ht.backgroundColor?s=l.backColor:i.RV()===ht.foregroundColor&&(s=l.foreColor)),!E(s)&&""!==s)return o.Common.pc.Pka(s,a);return!1},t.prototype.formulaConditionEvaluate=function(t,e,n,o){var r,i,a,s;if(!_)return!1;if((r=this).customValueType()===pt.formula)return i=r.getExpected(t,e,n),!(!r.ignoreBlank()||!E(i)&&""!==i)||(a={},!!T.Uh(i,a)&&a.value);switch(s=T.vf,r.customValueType()){case pt.empty:return E(o)||""===o;case pt.nonEmpty:return!E(o)&&""!==o;case pt.error:return s(o);case pt.nonError:return!s(o);default:return!1}},t.prototype.formulaConditionGetExpected=function(t,e,n){var o,r,a,l,u,c,f,h,p,g,m=this;if(m.Yw&&m.Yw.length>0){if(!(o=t.Cf()))return m.expected();if(r=o.Hg(t.yj(),m.expression(d,t),s.pf(e,n),!0),a=void 0,l=void 0,u=void 0,c=void 0,f=void 0,T.Fh(r)){for(a=r.getRowCount(0),l=r.getColumnCount(0),u=[],c=0;c<a;c++)for(u[c]=[],f=0;f<l;f++)u[c][f]=r.getValue(0,c,f);r=u}else if(T.Ca(r)){for(a=r.getRowCount(),l=r.getColumnCount(),u=[],c=0;c<a;c++)for(u[c]=[],f=0;f<l;f++)u[c][f]=r.getValue(c,f);r=u}return O(r,Array)?(a=X(r),l=X(r[0]),1===a&&1===l?r[0][0]:(p=e-(h=function(t,e,n){var o,r;for(o=0;o<t.length;o++)if((r=t[o]).contains(e,n))return r}(m.ranges(),e,n)).row,g=n-h.col,p<a&&g<l?r[p][g]:i.Errors.NotAvailable)):r}return m.expected()},t.prototype.dateOrTimeEvaluate=function(t,e,n,o,r,i,a){var s,l,u=this;if((E(o)||""===o)&&u.ignoreBlank())return!0;if(!O(o,Date))return u.RV()===dt.notEqualsTo;if(s=p,l=this.getExpected(t,e,n),O(l,Date)?s=l:"string"==typeof l?s=W.Qa(l):"number"==typeof l&&(s=W.Xb(l)),E(s))return!!u.ignoreBlank();switch(u.RV()){case dt.equalsTo:return r(s,o);case dt.notEqualsTo:return!r(s,o);case dt.after:return a(s,o);case dt.afterEqualsTo:return a(s,o)||r(s,o);case dt.before:return i(s,o);case dt.beforeEqualsTo:return i(s,o)||r(s,o);default:return!1}},t.prototype.dateConditionEvaluate=function(t,e,n,o){return this.dateOrTimeEvaluate(t,e,n,o,kt,Nt,Mt)},t.prototype.timeConditionEvaluate=function(t,e,n,o){return this.dateOrTimeEvaluate(t,e,n,o,Et,Ot,Dt)},t.prototype.dateExConditionEvaluate=function(t,e,n,o){var r=this.A4(t,e,n);return!E(r)&&this.dateExConditionCheckCondition(r,o)},t.prototype.getExConditionDateScope=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F=p,P=p,_=new Date,L=new Date(_.getFullYear(),_.getMonth(),_.getDate(),_.getHours(),_.getMinutes(),_.getSeconds(),_.getMilliseconds());switch(t){case mt.last7Days:It(L,Rt(L)-6),F=St(L),P=At(_);break;case mt.yesterday:It(L,Rt(L)-1),F=St(L),P=At(L);break;case mt.today:F=St(_),P=At(_);break;case mt.tomorrow:It(L,Rt(L)+1),F=St(L),P=At(L);break;case mt.lastWeek:It(e=_,Rt(_)-_.getDay()-7),(n=L).setDate(Rt(L)-L.getDay()-1),F=St(e),P=At(n);break;case mt.thisWeek:It(o=_,Rt(_)-_.getDay()),It(r=L,Rt(L)-L.getDay()+6),F=St(o),P=At(r);break;case mt.nextWeek:It(i=_,Rt(_)-_.getDay()+7),It(a=L,Rt(L)-L.getDay()+13),F=St(i),P=At(a);break;case mt.lastMonth:It(s=_,1),s.setMonth(_.getMonth()-1),It(l=L,0),F=St(s),P=At(l);break;case mt.thisMonth:It(u=_,1),It(c=L,1),c.setMonth(L.getMonth()+1),It(c,0),F=St(u),P=At(c);break;case mt.nextMonth:It(f=_,1),f.setMonth(_.getMonth()+1),It(h=L,1),h.setMonth(L.getMonth()+2),It(h,0),F=St(f),P=At(h);break;case mt.nextQuarter:m=(g=(d=_).getMonth())%3,d.setDate(1),d.setMonth(g-m+3),void 0,(y=L).setDate(1),y.setMonth(g-m+3+2),v=2===y.getMonth()||11===y.getMonth()?31:30,y.setDate(v),F=St(d),P=At(y);break;case mt.thisQuarter:w=(b=(C=_).getMonth())%3,C.setDate(1),C.setMonth(b-w),void 0,(T=L).setDate(1),T.setMonth(b-w+2),x=2===T.getMonth()||11===T.getMonth()?31:30,T.setDate(x),F=St(C),P=At(T);break;case mt.lastQuarter:I=(A=(S=_).getMonth())%3,S.setDate(1),S.setMonth(A-I-3),void 0,(R=L).setDate(1),R.setMonth(A-I-3+2),k=2===R.getMonth()||11===R.getMonth()?31:30,R.setDate(k),F=St(S),P=At(R);break;case mt.nextYear:(M=_).setDate(1),M.setFullYear(M.getFullYear()+1),M.setMonth(0),(N=L).setFullYear(N.getFullYear()+1),N.setMonth(11),N.setDate(31),F=St(M),P=At(N);break;case mt.thisYear:(E=_).setDate(1),E.setMonth(0),(D=L).setMonth(11),D.setDate(31),F=St(E),P=At(D);break;case mt.lastYear:(O=_).setFullYear(O.getFullYear()-1),O.setDate(1),O.setMonth(0),(j=L).setFullYear(j.getFullYear()-1),j.setMonth(11),j.setDate(31),F=St(O),P=At(j)}return{from:F,to:P}},t.prototype.dateExConditionCheckCondition=function(t,n){var o,r,i,a,s,l,u,c,f,h,d;if(r=n,(o=this).ignoreBlank()&&(E(r)||""===r))return!0;try{r=T.Wh(r)}catch(t){return!1}if((a=o.expectTypeId())===gt.dateOccurring){if(l=(s=this.getExConditionDateScope(t)).from,u=s.to,!E(l)&&!E(u))return c=e.$V(Tt.dateCondition,dt.afterEqualsTo,l,p),f=e.$V(Tt.dateCondition,dt.beforeEqualsTo,u,p),e.$V(Tt.relationCondition,ut.and,p,p,p,p,p,c,f).evaluate(p,0,0,r)}else if(i=o.A4(p,0,0),!E(i)){if(a===gt.yearOccurring)return i===r.getFullYear();if(a===gt.quarterOccurring)return function(t,e){switch(t){case yt.quarter1:return e.getMonth()>=0&&e.getMonth()<=2;case yt.quarter2:return e.getMonth()>=3&&e.getMonth()<=5;case yt.quarter3:return e.getMonth()>=6&&e.getMonth()<=8;case yt.quarter4:return e.getMonth()>=9&&e.getMonth()<=11;default:return!1}}(i,r);if(a===gt.monthOccurring)return i===r.getMonth();if(a===gt.weekOccurring)return i===r.getDay();if(a===gt.dayOccurring)return i===Rt(r);if(a===gt.yearTodate)return h=new Date,d=new Date,h.setMonth(0,1),h.setHours(0,0,0,0),d.setHours(23,59,59,59),h<=r&&r<=d}return!1},t.prototype.textLengthConditionEvaluate=function(t,e,n,o){var r,i;return E(o)||""===o?this.ignoreBlank():(r=E(o)?0:(""+o).length,"number"==typeof(i=this.A4(t,e,n))&&ne(this.RV(),r,i))},t.prototype.top10ConditionEvaluate=function(t,e,n,o){var r,i,a,s=this;if(E(o)||""===o)return s.ignoreBlank();if(r=s.A4(t,e,n),!E(r)&&(i=void 0,s.k$a?(E(s.mxb)&&(s.mxb=s.getTopValues(t,r,s.ranges())),i=s.mxb):i=s.getTopValues(t,r,s.ranges()),i)){a=0;try{a=s.Pa(o)}catch(t){return!1}if(U.Bb(i,a))return!0}return!1},t.prototype.A4=function(t,e,n){var o=this.getExpected(t,e,n);return o=parseInt(o,10),isNaN(o)||!isFinite(o)?p:o},t.prototype.adjustRange=function(t,e){return V(t.row,t.col,Math.min(te(t),e.getRowCount()),Math.min(ee(t),e.getColumnCount()))},t.prototype.getTopValues=function(t,e,n){var o,r,i,a,s,l,u,c,f,h=0===this.type()?1:-1,p=[];if(!n)return p;for(o=this.UV(t,n),r=X(o),u=0;u<r;u++)for(i=this.adjustRange(o[u],t),c=0;c<te(i);c++)for(a=c+i.row,f=0;f<ee(i);f++)s=f+i.col,l=this.Pa(t.getValue(a,s)),E(l)||p.push(l);return p.sort((function(t,e){return(e-t)*h})),X(p)>e&&(p=p.slice(0,e)),p},t.prototype.Pa=function(t){return("number"==typeof t||O(t,Date))&&_?S(t):p},t.prototype.uniqueConditionEvaluate=function(t,e,n,o){var r,i,a,s,l=this,u=o;return E(u)||""===u?l.ignoreBlank():(_&&x(u)&&(u=S(u)),r=this.getExpected(t,e,n),i={},T.Uh(r,i),a=i.value,!E(a)&&(s=l.duplicatedArrayCached||l.getDuplicated(t,l.ranges()),!E(s)&&U.Bb(s,u)?!0===a:!0!==a))},t.prototype.getDuplicated=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p=[],d={},g=this.UV(t,e);if(g)for(n=X(g),o=0;o<n;o++)for(r=g[o],i=te(r=this.adjustRange(r,t)),a=ee(r),s=0;s<i;s++)for(l=s+r.row,u=0;u<a;u++)c=u+r.col,f=t.getValue(l,c,3),!E(f)&&_&&x(f)&&(f=S(f)),(h=d[f])?1===h&&p.push(f):d[f]=1;return p},t.prototype.VV=function(t,e){var n,o=t.length;for(n=0;n<o;n++)if(t[n].key===e)return!0;return!1},t.prototype.averageConditionEvaluate=function(t,e,n,o){var r,i,a,s,l,u,c,f;if(!_)return!1;if((r=this).ignoreBlank()&&(E(o)||""===o))return!0;if(r.WV(),r.k$a?(E(r.mxb)&&(r.mxb=r.getExpected(t,e,n)),i=r.mxb):i=r.getExpected(t,e,n),s=A(i,a={})?a.value:NaN,l=p,u=r.TV?r.XV(t,r.TV,e,n):p,E(u)||(l=A(u,a={})?a.value:NaN),x(o)&&(c=S(o),!isNaN(s)))switch(f=isNaN(l),r.type()){case vt.above:return c>s;case vt.below:return c<s;case vt.equalOrAbove:return c>=s;case vt.equalOrBelow:return c<=s;case vt.above1StdDev:return!f&&c>s+l;case vt.below1StdDev:return!f&&c<s-l;case vt.above2StdDev:return!f&&c>s+2*l;case vt.below2StdDev:return!f&&c<s-2*l;case vt.above3StdDev:return!f&&c>s+3*l;case vt.below3StdDev:return!f&&c<s-3*l;default:return!1}return!1},t.prototype.WV=function(){var t=this;t.ranges()&&(t.Lf=t.YV("AVERAGE",t.ranges()),t.type()>=4&&t.type()<=9&&(t.TV=t.YV("STDEV",t.ranges())))},t.prototype.YV=function(t,e){var n,o,r,a;if(!_)return p;if(n=Z.findGlobalFunction(t)){for(o=[],r=X(e),a=0;a<r;a++)o[a]=et(e[a]);return i.Jh(n,o)}return p},t.prototype.averageConditionGetExpected=function(t,e,n){var o=t.Cf();return o?o.Hg(t.yj(),this.expression(d,t),s.pf(e,n),!1):p},t.prototype.nxb=function(){var t=this.conType();t!==Tt.averageCondition&&t!==Tt.top10Condition||(this.k$a=!0)},t.prototype.oxb=function(){this.k$a=!1,this.mxb=d},t.prototype.XV=function(t,e,n,o){var r=t.Cf();return r?r.Hg(t.yj(),e,s.pf(n,o),!1):p},t.prototype.ZV=function(t,e){var n,o;for(o=0;o<X(e);o++)n=e[o],O(n,Array)&&X(n)>0?X(e)>1?t.push(n[0]):t.push.apply(t,n):t.push(n)},t.prototype.getValidList=function(t,e,n){var o,r,i=[],a=this.getValidListImp(t,e,n);for(o=0,r=X(a);o<r;o++)i.push(a[o].value);return i},t.prototype.getValidListImp=function(t,e,n){var o,r,i,a,s,l,u=this,c=[];if(u.Yw&&u.Yw.length>0)o=u.getExpected(t,e,n),O(o,Array)?u.ZV(c,o):c.push(o);else if(u.expected()&&u.expected().length>0&&(r=u.expected().replace(/\\,/g,String.fromCharCode(206)).split(",")))for(i=0;i<X(r);i++)a=r[i],E(a)||(s=RegExp(String.fromCharCode(206),"g"),""!==(l=f.trim(a).replace(s,","))&&c.push({text:l,value:l}));return c},t.prototype.areaConditionEvaluate=function(t,e,n,o){var r,i,a,s,l;function u(t,e,n){return O(t,Date)&&O(e,Date)?t.valueOf()===e.valueOf():n||"string"!=typeof t||"string"!=typeof e?t===e:t.toLowerCase()===e.toLowerCase()}if(r=this,E(o)||""===o)return!0===r.ignoreBlank();for(i=r.getValidList(t,e,n),a=0;a<X(i);a++){if(s=i[a],E(s)&&E(o))return!0;if(r.Yw){if(u(s,o,!1))return!0}else if(l=t.getActualStyle(e,n,3,!0),u(j.ul(l,s,!0),o,!0))return!0}return!1},t.prototype.areaConditionGetExpected=function(t,e,n){var o,r,i,a,l,u,c,f,h,p,g,m,y,C=this,b=[];if(C.Yw){if(o=void 0,r=void 0,i=void 0,a=void 0,l=void 0,u=void 0,!(c=t.Cf()))return b;if(f=c.Hg(t.yj(),C.expression(d,t),s.pf(e,n),!0),T.Fh(f))for(o=f.getRowCount(0),r=f.getColumnCount(0),h=f.getRow(0),p=f.getColumn(0),(g=f.xf&&f.xf.kj)&&(m=g.getRowCount(),y=g.getColumnCount(),o=o>m?v(m-h,0):o,r=r>y?v(y-p,0):y),i=0;i<o;i++)for(b[i]=[],a=0;a<r;a++)l=f.getValue(0,i,a),u=g?g.getText(h+i,p+a):l,b[i][a]={value:l,text:u};else if(T.Ca(f))for(o=f.getRowCount(),r=f.getColumnCount(),i=0;i<o;i++)for(b[i]=[],a=0;a<r;a++)l=f.getValue(i,a),b[i][a]={value:l,text:l}}else b.push({value:C.expected(),text:C.expected()});return b},t.prototype.reset=function(){var t=this;switch(t.ignoreBlank(!1),t.RV(1),t.item1(p),t.item2(p),t.value1=p,t.value2=p,t.expected(p),t.RV(0),t.integerValue(!1),t.operator=0,t.text="",t.RV(0),t.useWildCards(!0),t.ignoreCase(!1),t.forceValue2Text(!1),t.customValueType(0),t.Lf=p,t.type(0),this.expectTypeId(0),t.ranges(p),t.isPercent(!1),t.regex(p),t.conType()){case Tt.relationCondition:t.ignoreBlank(!1),t.RV(1);break;case Tt.numberCondition:t.RV(0),t.integerValue(!1);break;case Tt.textCondition:t.RV(0),t.useWildCards(!0),t.forceValue2Text(!1);break;case Tt.colorCondition:t.RV(0);break;case Tt.formulaCondition:t.customValueType(0),t.TV=p;break;case Tt.dateCondition:case Tt.timeCondition:t.RV(0);break;case Tt.dateExCondition:t.expectTypeId(0);break;case Tt.textLengthCondition:t.RV(0);break;case Tt.top10Condition:case Tt.averageCondition:t.type(0);break;case Tt.cellValueCondition:t.operator=6;break;case Tt.areaCondition:}},t.prototype.evaluate=function(t,e,n,o){var r=this.conType();return!E(r)&&this[Tt[r]+"Evaluate"](t,e,n,o)},t.prototype.getExpectedNormal=function(t,e,n,o,r,i){var a,l=this,u=l.Yw,c=l.expected();return u?(a=t.Cf())?a.Hg(t.yj(),l.expression(d,t),s.pf(e,n),!1,i):c:c},t.prototype.getExpected=function(t,e,n){var o=this;switch(o.conType()){case 2:return o.getExpectedNormal(t,e,n,e-o.offsetRow,n-o.offsetCol,!1);case 5:case 6:case 7:case 9:case 11:case 13:return o.getExpectedNormal(t,e,n,e-o.offsetRow,n-o.offsetCol,!1);case 8:return o.getExpectedNormal(t,e,n,e,n);case 0:return p;case 1:return o.numberConditionGetExpected(t,e,n);case 3:return p;case 4:return o.formulaConditionGetExpected(t,e,n);case 10:return o.averageConditionGetExpected(t,e,n);case 12:return o.areaConditionGetExpected(t,e,n);default:return p}},t.prototype.UV=function(t,e){var n,o,r,i=[];for(n=0,o=X(e);n<o;n++)r=t.Tq(e[n]),i.push(r);return i},t.prototype.getExpressions=function(){var t=[],e=this;return 0===e.conType()?(e.item1()&&e.item1().getExpressions&&(t=e.item1().getExpressions()),e.item2()&&e.item2().getExpressions&&(t=t.concat(e.item2().getExpressions())),t):(e.Lf||e.initExpression(),e.Lf?[e.Lf]:[])},t.prototype.setExpressions=function(t,e){var n,o=this;return e&&e.push({type:"condition",condition:this,expressions:o.getExpressions()}),0===o.conType()?(o.item1()&&o.item1().setExpressions&&(n=o.item1().getExpressions().length,o.item1().setExpressions(t.slice(0,n))),void(o.item2()&&o.item2().setExpressions&&o.item2().setExpressions(t.slice(n)))):void o.expression(t[0])},t.prototype.toJSON=function(t){return ot.call(this,t,jt)},t.prototype.fromJSON=function(t,e,n){var o;t&&(o=this,rt.call(o,e,jt,t,n),e&&e.Wu&&e.Wu.useR1C1&&e instanceof l.Worksheet&&(o.context(e),F(o)),o.j_a(!0),o.initExpression(),o.k_a())},t.fromSource=function(t){return e.$V(12,p,t,p)},t.fromFormula=function(t){return e.$V(12,p,"",t)},t.fromDay=function(t){var n=e.$V(6,p,t);return n.expectTypeId(5),n},t.fromMonth=function(t){var n=e.$V(6,p,t);return n.expectTypeId(3),n},t.fromQuarter=function(t){var n=e.$V(6,p,t);return n.expectTypeId(2),n},t.fromWeek=function(t){var n=e.$V(6,p,t);return n.expectTypeId(4),n},t.fromYear=function(t){var n=e.$V(6,p,t);return n.expectTypeId(1),n},t}(),e.Condition=Ft,Ft.prototype.conType=nt("conType",p),Ft.prototype.ranges=nt("ranges",p,(function(t){var e=this.item1(),n=this.item2();e&&e.ranges&&e.ranges(t),n&&n.ranges&&n.ranges(t)})),Ft.prototype.ignoreBlank=nt("ignoreBlank",!1),Ft.prototype.compareType=nt("compareType",d),Ft.prototype.RV=Ft.prototype.compareType,Ft.prototype.expected=nt("expected",d),Ft.prototype.item1=nt("item1",p),Ft.prototype.item2=nt("item2",p),Ft.prototype.treatNullValueAsZero=nt("treatNullValueAsZero",!1),Ft.prototype.integerValue=nt("integerValue",!1),Ft.prototype.forceValue2Text=nt("forceValue2Text",!1),Ft.prototype.useWildCards=nt("useWildCards",!0),Ft.prototype.regex=nt("regex",p),Ft.prototype.ignoreCase=nt("ignoreCase",!1),Ft.prototype.customValueType=nt("customValueType",d),Ft.prototype.expectTypeId=nt("expectTypeId",0),Ft.prototype.type=nt("type",p),Ft.prototype.isPercent=nt("isPercent",!1),Pt=function(){function t(t,e,n){var o=this;o.xyb=!0,o.ruleType(t),o.style(e),o.ranges(n)}return t.prototype.stopIfTrue=function(t){},t.prototype.evaluate=function(t,n,o,r){var i,a,s=this;return s.contains(n,o)?(s.initCondition(),i={baseRow:0,baseCol:0},s.getBaseCoordinate(i),s.condition().adjustOffset(n-i.baseRow,o-i.baseCol),a=p,s.condition().evaluate(t,n,o,r)&&(a=s.getExpected()||e.Cxb),s.condition().adjustOffset(0,0),a):p},t.prototype.contains=function(t,e){var n,o,r=this.ranges();if(r)for(n=X(r),void 0,o=0;o<n;o++)if(r[o].contains(t,e))return!0;return!1},t.prototype.createCondition=function(){return this.xyb=!1,null},t.prototype.initCondition=function(t){var e=this.condition();e||((e=this.createCondition())&&(e.ranges(this.ranges()),this.condition(e)),t&&this.context(t),this.context()&&e&&e.context(this.context()))},t.prototype.yyb=function(){var t,e=this;e.xyb&&((t=e.condition())||(e.initCondition(),t=e.condition()),t&&!t.Lf&&t.initExpression())},t.prototype.context=function(t){return 1===arguments.length&&(this.xc=t,this.condition()&&this.condition().context(t)),this.xc},t.prototype.getExpected=function(){return this.style()},t.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.stopIfTrue(!1),t.priority(1)},t.prototype.intersects=function(t,e,n,o){var r,i,a=this.ranges();if(a)for(r=X(a),void 0,i=0;i<r;i++)if(a[i].intersect(t,e,n,o))return!0;return!1},t.prototype.isScaleRule=function(){return!1},t.prototype.getBaseCoordinate=function(t){var e,n,o,r,i;if(t.baseRow=Number.MAX_VALUE,t.baseCol=Number.MAX_VALUE,(e=this).ranges()&&X(e.ranges())>0)for(n=0;n<X(e.ranges());n++)r=-1===(r=(o=e.ranges()[n]).row)?0:r,i=-1===(i=o.col)?0:i,t.baseRow=y(r,t.baseRow),t.baseCol=y(i,t.baseCol);else t.baseRow=0,t.baseCol=0},t.prototype._V=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p=this,d=n?e:0,g=n?0:e;if(p.yyb(),p.ranges())for(r=X(p.ranges()),i=0;i<r;i++)if(a=p.ranges()[i],s=n?a.row:a.col,l=n?te(a):ee(a),-1!==s){if(o&&o.length>0){for(u=!1,c=0,f=o.length;c<f;c++)if((h=o[c])&&(!n&&h.col===t&&(h.col===a.col&&h.col+h.colCount-e===a.col+a.colCount||a.row===h.row&&a.rowCount===h.rowCount&&a.col>=h.col&&a.col+a.colCount<=h.col+h.colCount)||n&&h.row===a.row&&h.row+h.rowCount-e===a.row+a.rowCount&&a.row===t)){p.ranges()[i]=V(a.row,a.col,te(a)+d,ee(a)+g),u=!0;break}if(u)break}s>=t?p.ranges()[i]=V(a.row+d,a.col+g,te(a),ee(a)):t<=s+l&&(p.ranges()[i]=V(a.row,a.col,te(a)+d,ee(a)+g))}},t.prototype.rI=function(t,e,n){this._V(t,e,!0,n)},t.prototype.tI=function(t,e,n){this._V(t,e,!1,n)},t.prototype.aW=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p=this,d=n?t:0,g=n?0:t,m=n?e:0,v=n?0:e;if(p.yyb(),p.ranges()){for(o=[],r=X(p.ranges()),i=0;i<r;i++)a=p.ranges()[i],s=n?a.row:a.col,l=n?te(a):ee(a),-1!==s&&(s>t?s+l<=t+e?o.push(a):p.ranges()[i]=V(a.row-m,a.col-v,te(a),ee(a)):t<s+l&&(u=V(a.row,a.col,te(a)-y(a.row+te(a)-d,m),ee(a)-y(a.col+ee(a)-g,v)),0===ee(u)||0===te(u)?o.push(a):p.ranges()[i]=u));for(c=X(o),f=0;f<c;f++)h=o[f],q(p.ranges(),h)}},t.prototype.GR=function(t,e){this.aW(t,e,!0)},t.prototype.HR=function(t,e){this.aW(t,e,!1)},t.prototype.toJSON=function(t){return ot.call(this,t)},t.prototype.fromJSON=function(t,e,n){t&&(rt.call(this,e,p,t,n),this.initCondition(e))},t.prototype.S$a=function(){var t=this.condition();t&&F(t)},t.prototype.hW=function(t){var e,n,o=[],r=X(t);for(n=0;n<r;n++)e=t[n],o.push(V(e.row,e.col,te(e),ee(e)));return o},t.prototype.iW=function(){var t,e,n=this.cW,o=this.ranges();if(!n)return this.cW=this.hW(o),!1;if(X(n)!==(t=X(o)))return!0;for(e=0;e<t;e++)if(!n[e].equals(o[e]))return!0;return!1},t}(),e.ConditionRuleBase=Pt,(_t=Pt.prototype).ruleType=nt("ruleType",p),_t.ranges=nt("ranges",p,(function(t){var e,n=this.condition();n&&n.ranges()&&((e=n.xc)&&e.ITa.YUa(),n.ranges(t))})),_t.condition=nt("condition",p),_t.style=nt("style",p),_t.priority=nt("priority",1),_t.stopIfTrue=nt("stopIfTrue",!1),Lt=["ruleType","style","operator","text","formula","type","rank","priority","stopIfTrue","ranges"],Bt=function(t){function n(e,n,o,r,i,a,s,l,u,c){var h=t.call(this,e,o)||this,d=h;return d.ranges(n),d.operator(r),d.value1("string"==typeof i?f.trim(i):i),d.value2("string"==typeof a?f.trim(a):a),d.text(s),d.formula(l),d.type(u),d.rank(c),d.cached=!1,d.cW=p,h}return Kt(n,t),n.prototype.value1=function(t,e){var n,o;return 1!==arguments.length?(n=this.condition())&&((o=n.formula(t,e,0))&&o.length>0)?"="+R(f.trim(""+o),"="):this._Qa:void(this._Qa=t)},n.prototype.value2=function(t,e){var n,o;return 1!==arguments.length?(n=this.condition())&&((o=n.formula(t,e,1))&&o.length>0)?"="+R(f.trim(""+o),"="):this.aRa:void(this.aRa=t)},n.prototype.formula=function(t,e){var n=this,o=n.condition();return"string"!=typeof t?o&&o.formula(t,e)||n.Yw:(n.Yw=t,void(o&&o.formula(t)))},n.prototype.cellValueRuleCreateCondition=function(){var t,n,o,r,i,a,s,l,u=this,c=u.value1(),f=u.value2(),h=u.ranges(),g=u.bW(c)?R(c,"="):p,m=u.bW(f)?R(f,"="):p,y=u.operator();return y===ct.between?((t=e.$V(Tt.cellValueCondition,3,c,g,d,d,h)).treatNullValueAsZero(!0),(n=e.$V(Tt.cellValueCondition,5,f,m,d,d,h)).treatNullValueAsZero(!0),i=e.$V(Tt.relationCondition,1,p,p,p,p,h,t,n),(o=e.$V(Tt.cellValueCondition,5,c,g,d,d,h)).treatNullValueAsZero(!0),(r=e.$V(Tt.cellValueCondition,3,f,m,d,d,h)).treatNullValueAsZero(!0),a=e.$V(Tt.relationCondition,1,p,p,p,p,h,o,r),e.$V(Tt.relationCondition,0,p,p,p,p,h,i,a)):y===ct.notBetween?((t=e.$V(Tt.cellValueCondition,4,c,g,d,d,h)).treatNullValueAsZero(!0),n=e.$V(Tt.cellValueCondition,2,f,m,d,d,h),t.treatNullValueAsZero(!0),i=e.$V(Tt.relationCondition,0,p,p,p,p,h,t,n),(o=e.$V(Tt.cellValueCondition,2,c,g,d,d,h)).treatNullValueAsZero(!0),(r=e.$V(Tt.cellValueCondition,4,f,m,d,d,h)).treatNullValueAsZero(!0),a=e.$V(Tt.relationCondition,0,p,p,p,p,h,o,r),e.$V(Tt.relationCondition,1,p,p,p,p,h,i,a)):(s=y,(l=e.$V(11,s,c,g,d,d,h)).treatNullValueAsZero(!0),l)},n.prototype.bW=function(t){return!E(t)&&"="===t[0]},n.prototype.specificTextRuleCreateCondition=function(){var t,n,o,r,i=this.operator();switch(i){case 2:t=2;break;case 3:t=4;break;case 0:t=6;break;case 1:t=7;break;default:t=0}return n=this.text(),o=p,n&&"="===n[0]&&(o=n),(r=e.$V(2,t,n,o,d,d,this.ranges())).ignoreCase(!0),r.useWildCards(2!==i&&3!==i),r},n.prototype.formulaRuleCreateCondition=function(){var t=this.ranges();return e.$V(4,p,p,this.Yw,4,p,t)},n.prototype.dateOccurringRuleCreateCondition=function(){return e.$V(6,p,this.type(),p,p,d,this.ranges())},n.prototype.top10RuleCreateCondition=function(){return e.$V(8,p,this.rank(),p,p,this.type(),this.ranges())},n.prototype.uniqueRuleCreateCondition=function(){return e.$V(9,p,!1,p,p,p,this.ranges())},n.prototype.duplicateRuleCreateCondition=function(){return e.$V(9,p,!0,p,p,p,this.ranges())},n.prototype.averageRuleCreateCondition=function(){return e.$V(10,p,p,p,p,this.type(),this.ranges())},n.prototype.createCondition=function(){return this[xt[this.ruleType()]+"CreateCondition"]()},n.prototype.reset=function(){var t=this;switch(t.ranges(p),t.condition(p),t.style(p),t.stopIfTrue(!1),t.priority(1),t.operator(6),t.value1(p),t.value2(p),t.text(""),t.formula(p),t.type(0),t.rank(10),t.ruleType()){case 1:t.operator(6);break;case 2:t.operator(0);break;case 4:t.style(p);break;case 5:t.type(0),t.rank(10);break;case 8:t.type(0)}},n.prototype.evaluate=function(e,n,o,r){return this.jW(e),t.prototype.evaluate.call(this,e,n,o,r)},n.prototype.jW=function(t){var e,n=this;n.initCondition(),9===(e=n.condition()).conType()&&(n.iW()&&(n.Nm(),n.cW=n.hW(n.ranges())),!1===n.cached&&(e.duplicatedArrayCached=e.getDuplicated(t,n.ranges()),n.cached=!0))},n.prototype.Nm=function(){this.cached=!1},n.prototype.rI=function(e,n,o){t.prototype.rI.call(this,e,n,o),this.Nm()},n.prototype.tI=function(e,n,o){t.prototype.tI.call(this,e,n,o),this.Nm()},n.prototype.GR=function(e,n){t.prototype.GR.call(this,e,n),this.Nm()},n.prototype.HR=function(e,n){t.prototype.HR.call(this,e,n),this.Nm()},n.prototype.toJSON=function(t){var e,n,o,r,i=this;return E(i.condition())&&this.initCondition(),e=ot.call(i,t,Lt),n=i.value1(),function(t,e){return t===xt.cellValueRule&&(e===ct.between||e===ct.notBetween)}(e.ruleType,e.operator)&&(o=i.value2()),r=t&&t.parent&&1===t.parent.options.referenceStyle,E(n)||(i.bW(n)&&r&&(n=re(t,i,n,r)),e.value1=n),E(o)||(i.bW(o)&&r&&(o=re(t,i,o,r)),e.value2=o),i.ruleType()===xt.conditionRuleBase&&(e.condition=i.condition().toJSON()),e},n.prototype.fromJSON=function(t,e,n){var o=Lt;E(t.condition)||(o=Lt.concat(["condition"])),rt.call(this,e,o,t,n),E(t.value1)||this.value1(t.value1),E(t.value2)||this.value2(t.value2),this.initCondition(e)},n}(Pt),e.NormalConditionRule=Bt,Gt={operator:nt("operator",p),text:nt("text",p),type:nt("type",p),rank:nt("rank",p),priority:nt("priority",1)},f.extend(Bt.prototype,Gt),Ht=function(t,e){this.type=t,this.value=e},e.ScaleValue=Ht,Vt=["ruleType","ranges","minType","minValue","minColor","maxType","maxValue","maxColor","midType","midValue","midColor","priority"],zt=function(t){function n(e,n,o,r,i,a,s,l,u,c,f){var h,d,g,m,y,v,C,b,w,T=t.call(this,e,p,f)||this,x=T;return x.xyb=!1,x.lowestValueCached=p,x.highestValueCached=p,x.zyb={},x.cached=!1,x.cW=p,h=n,d=o,g=r,m=i,y=a,v=s,C=l,b=u,w=c,arguments.length<=1&&(h=1,d=p,g=H(255,248,105,107),m=4,y=50,v=H(255,255,235,132),C=2,b=p,w=H(255,99,190,123)),x.minColor(g),x.minValue(d),x.minType(h),x.midColor(v),x.midValue(y),x.midType(m),x.maxColor(w),x.maxValue(b),x.maxType(C),T}return Kt(n,t),n.prototype.stopIfTrue=function(t){return!1},n.prototype.isScaleRule=function(){return!0},n.prototype.createCondition=function(){return p},n.prototype.fW=function(t){var n=e.$V(8,p,p,p,p,1).getTopValues(t,1,this.ranges());return X(n)>0?n[0]:p},n.prototype.gW=function(t){var n=e.$V(8,p,p,p,p,0).getTopValues(t,1,this.ranges());return X(n)>0?n[0]:p},n.prototype.jW=function(t){var e=this;e.iW()&&(e.Nm(),e.cW=e.hW(e.ranges())),!1===e.cached&&(e.lowestValueCached=e.fW(t),e.highestValueCached=e.gW(t),e.cached=!0)},n.prototype.Nm=function(){this.lowestValueCached=p,this.highestValueCached=p,this.zyb={},this.cached=!1},n.prototype.kW=function(t,e,n,o){var r,i;return o&&(r=t.Cf())?(i=r.parse(t.yj(),o,e,n),r.Hg(t.yj(),i,s.pf(e,n),!1)):p},n.prototype.bW=function(t){return t&&"="===t[0]},n.prototype.lW=function(t){return E(t)||""===t?p:"="===t[0]?t.substr(1):t},n.prototype.mW=function(t,e,n,o){if(this.bW(o))return this.kW(t,e,n,this.lW(""+o));var r={};return A(o,r)?r.value:NaN},n.prototype.dW=function(t){return this.jW(t),this.highestValueCached},n.prototype.eW=function(t){return this.jW(t),this.lowestValueCached},n.prototype.nW=function(t,e,n,o){var r,i,a=this.mW(t,e,n,o);return!isNaN(a)&&0<=a&&a<=100&&(r=this.eW(t),i=this.dW(t),typeof r!==g&&r!==p&&typeof i!==g&&i!==p)?r+(i-r)*a/100:p},n.prototype.oW=function(t,e,n,o){var r,i,a,l,u,c,f,h,d,g,m,y,v=this.zyb;if(void 0!==v[o])return v[o];if(r=this.mW(t,e,n,o),!isNaN(r)&&0<=r&&r<=100){for(i=0,a=this.ranges(),l=X(a),u=0;u<l;u++)c=this.YV("PERCENTILE",[t.Tq(a[u]),r/100]),f=t.Cf(),h=t.yj(),d=f.unparse(h,c,e,n),g=f.parse(h,d,e,n),m=f.Hg(h,g,s.pf(e,n),!1),i+=A(m,y={})?y.value:0;return v[o]=i/l,v[o]}return v[o]=p,v[o]},n.prototype.pW=function(t,e,n,o,r){var i,a,s=this;switch(o){case Ct.formula:return s.bW(r)||(r="="+r),s.mW(t,e,n,r);case Ct.highestValue:return s.dW(t);case Ct.lowestValue:return s.eW(t);case Ct.number:return s.mW(t,e,n,r);case Ct.percent:return s.nW(t,e,n,r);case Ct.percentile:return s.oW(t,e,n,r);case Ct.automax:return(i=s.dW(t))<0?0:i;case Ct.automin:return(a=s.eW(t))>0?0:a;default:return p}},n.prototype.qW=function(t,e,n){return t===e&&t===n?1:t<=e?0:t>=n?1:(t-e)/(n-e)},n.prototype.rW=function(t,e,n){var o,r,i,a,s,l;return 0<=t&&t<=1?(o=G.ec(e),r=G.ec(n),i=o.a*(1-t)+r.a*t,a=o.r*(1-t)+r.r*t,s=o.g*(1-t)+r.g*t,l=o.b*(1-t)+r.b*t,H(parseFloat(i/255+""),parseInt(a+"",10),parseInt(s+"",10),parseInt(l+"",10))):p},n.prototype.YV=function(t,e){var n,o,r,a;if(!_)return p;if(n=Z.findGlobalFunction(t)){for(o=[],r=X(e),a=0;a<r;a++)o[a]=et(e[a]);return i.Jh(n,o)}return p},n.prototype.rI=function(e,n,o){t.prototype.rI.call(this,e,n,o),this.Nm()},n.prototype.tI=function(e,n,o){t.prototype.tI.call(this,e,n,o),this.Nm()},n.prototype.GR=function(e,n){t.prototype.GR.call(this,e,n),this.Nm()},n.prototype.HR=function(e,n){t.prototype.HR.call(this,e,n),this.Nm()},n.prototype.scaleEvaluate=function(t,e,n,o){var r,i,a,s,l=this;if(l.jW(t),l.contains(e,n)){if(E(o))return p;try{if(r=S(o),i=l.pW(t,e,n,l.minType(),l.minValue()),a=l.pW(t,e,n,l.midType(),l.midValue()),i>(s=l.pW(t,e,n,l.maxType(),l.maxValue())))return p;if(isNaN(a)){if(!isNaN(i)&&!isNaN(s))return l.qW(r,i,s)}else if(!isNaN(i)&&!isNaN(s))return r<i?0:r>=s?2:i<=r&&r<=a?l.qW(r,i,a):1+l.qW(r,i,s)}catch(t){return p}}return p},n.prototype.twoScaleRuleEvaluate=function(t,e,n,o){var r,i,a,s,l,u;if(!E(o)){if(r={},i=x(o)&&A(o,r)?r.value:NaN,isNaN(i))return p;if(s=(a=this).pW(t,e,n,a.minType(),a.minValue()),l=a.pW(t,e,n,a.maxType(),a.maxValue()),!E(s)&&!E(l))return u=a.qW(i,s,l),a.rW(u,a.minColor(),a.maxColor())}return p},n.prototype.threeScaleRuleEvaluate=function(t,e,n,o){var r,i,a,s,l,u,c=this;if(c.lh=t,!E(o)){if(r={},i=x(o)&&A(o,r)?r.value:NaN,isNaN(i))return p;if(a=c.pW(t,e,n,c.minType(),c.minValue()),s=c.pW(t,e,n,c.midType(),c.midValue()),l=c.pW(t,e,n,c.maxType(),c.maxValue()),!E(a)&&!E(l)&&!E(s))return u=void 0,a>l?p:i<=a||a===l?i>=l?c.maxColor():c.minColor():i>=l?c.maxColor():i<=s?(u=c.qW(i,a,s),c.rW(u,c.minColor(),c.midColor())):(u=c.qW(i,s,l),c.rW(u,c.midColor(),c.maxColor()))}return p},n.prototype.evaluate=function(t,e,n,o){return this[xt[this.ruleType()]+"Evaluate"](t,e,n,o)},n.prototype.ad=function(){var t=this;t.minValue(p),t.minType(1),t.midValue(50),t.midType(4),t.maxValue(p),t.maxType(2),10===t.ruleType()&&(t.minColor(H(0,255,255,255)),t.maxColor(H(255,99,190,123))),11===t.ruleType()&&(t.midValue(50),t.midType(4),t.minColor(H(255,248,105,107)),t.midColor(H(255,255,235,132)),t.maxColor(H(255,99,190,123)))},n.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.ad(),t.lh=p,t.stopIfTrue(!1),t.priority(1)},n.prototype.toJSON=function(t){return ot.call(this,t,Vt)},n.prototype.fromJSON=function(t,e,n){rt.call(this,e,Vt,t,n),this.initCondition(e)},n}(Pt),e.ScaleRule=zt,Wt={minValue:nt("minValue",p),minType:nt("minType",5),minColor:nt("minColor",p),midValue:nt("midValue",50,p,(function(t){var e=this;if(e.lh){if(2===e.midType())return e.dW(e.lh);if(1===e.midType())return e.eW(e.lh)}return t})),midType:nt("midType",p),midColor:nt("midColor",p),maxType:nt("maxType",7),maxValue:nt("maxValue",p),maxColor:nt("maxColor",p)},f.extend(zt.prototype,Wt),Ut=["ruleType","ranges","gradient","color","showBorder","borderColor","dataBarDirection","negativeFillColor","useNegativeFillColor","negativeBorderColor","useNegativeBorderColor","axisPosition","axisColor","showBarOnly","minType","minValue","maxType","maxValue","priority"],qt=function(t){function e(e,n,o,r,i,a){var s=this,l=e,u=n,c=o,f=r,h=i;return 0===arguments.length&&(l=5,u=p,c=7,f=p,h=H(255,99,142,198)),(s=t.call(this,12,l,u,p,p,p,p,c,f,p,a)||this).xyb=!1,s.ad(h),s}return Kt(e,t),e.prototype.ad=function(t){var e=this;e.gradient(!0),e.color(t),e.showBorder(!1),e.borderColor("black"),e.dataBarDirection(0),e.negativeFillColor("red"),e.useNegativeFillColor(!0),e.negativeBorderColor("black"),e.useNegativeBorderColor(!1),e.axisPosition(0),e.axisColor("black"),e.showBarOnly(!1)},e.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.ad(H(255,99,142,198)),t.stopIfTrue(!1),t.priority(1),t.minValue(p),t.minType(5),t.midValue(p),t.midType(p),t.maxValue(p),t.maxType(7),t.minColor(p),t.midColor(p),t.maxColor(p)},e.prototype.sW=function(t,e,n,o){var r,i,a,s,l=this,u=o?l.maxType():l.minType(),c=o?l.maxValue():l.minValue();if(6!==u&&4!==u)return l.pW(t,e,n,u,c);for(i=0;i<X(l.ranges());i++)if(l.ranges()[i].intersect(e,-1,1,-1)&&(r=l.ranges()[i]))return a=-1===(a=r.row)?0:a,s=-1===(s=r.col)?0:s,l.pW(t,a,s,u,c)},e.prototype.tW=function(t,e,n){return t>=n&&t>e?[1,0]:t<=e&&t<n?[0,0]:n===e?[.5,0]:[(t-e)/(n-e),0]},e.prototype.uW=function(t,e,n){var o,r,i=.5,a=C(n-e);return n>0&&e>=0?n===e||t>=n?[.5,i]:t<=e?[e/n*.5,i]:[.5*C(t/n),i]:n>0&&e<0?(o=n>C(e)?.5:n/a,r=n>C(e)?e/a:-.5,t>0?t>=n?[o,i]:[t/n*o,i]:t<0?t<=e?[r,i]:[t/e*r,i]:[0,i]):n<=0&&e<0?n===e?[-.5,i]:t>=n?[-n/e*.5,i]:t<=e?[-.5,i]:[-t/e*.5,i]:0===n&&0===e?[0,i]:[-1,i=-1]},e.prototype.vW=function(t,e,n){var o,r,i,a=-1,s=C(e),l=C(n),u=C(n-e),c=e<0?-1:1;return n>0&&e>=0||n<=0&&e<0?(o=v(s,l),r=y(s,l),a=e<0?1:0,(i=C(t))<=r&&i<o?[0,a]:i>=o&&i>r?[c,a]:r===o?[.5*c,a]:[c*(C(t)-r)/u,a]):n>0&&e<0?(a=C(e)/u,0===t?[0,a]:t>=n?[1-a,a]:[v(t,e)/u,a]):0===n&&0===e?(a=.5,0===t?[0,a]:[.5*c,a]):[-1,a]},e.prototype.wW=function(t,e,n){var o=this;return 0===o.axisPosition()?o.vW(t,e,n):1===o.axisPosition()?o.uW(t,e,n):o.tW(t,e,n)},e.prototype.evaluate=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,d,g,m;if(!E(o)){if(r={},i=x(o,!0)&&A(o,r)?r.value:NaN,isNaN(i))return p;if(s=(a=this).sW(t,e,n,!1),l=a.sW(t,e,n,!0),O(s,Date)&&(s=W.Ra(s)),O(l,Date)&&(l=W.Ra(l)),!E(s)&&!E(l))return s>l&&(u=l,l=s,s=u),c=void 0,!(f=a.wW(i,s,l))||X(f)<2?p:(h=f[0],c=f[1],d=i<0&&a.useNegativeFillColor()?a.negativeFillColor():a.color(),g=i<0&&a.useNegativeBorderColor()?a.negativeBorderColor():a.borderColor(),m=a.axisColor(),d=J.Om(t,d),g=J.Om(t,g),m=J.Om(t,m),{fillColor:d,borderColor:g,showBorder:a.showBorder(),axisColor:m,isGradient:a.gradient(),direction:a.dataBarDirection(),axisLocation:c,scale:h,showBarOnly:a.showBarOnly()})}return p},e.prototype.toJSON=function(t){return ot.call(this,t,Ut)},e.prototype.fromJSON=function(t,e,n){rt.call(this,e,Ut,t,n),this.initCondition(e)},e.paintDataBar=function(t,e,n,o,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,w,T=new r.Rect(n+2,o+2,i-4,a-4),x=T.x,S=T.y,A=b(C(T.width*e.scale)),I=T.height;if(0===e.axisLocation)e.scale<=0&&(A=0);else if(1===e.axisLocation)e.scale<0?x=x+T.width-A:A=0;else{for(s=b(T.width*e.axisLocation+x)+.5,l=T.y,1,u=a-2,t.lineWidth=1,t.strokeStyle=e.axisColor,t.beginPath(),c=0;c<=u;c+=2)1===e.direction?(t.moveTo(2*n+i-s,l+c),t.lineTo(2*n+i-s,l+c+1)):(t.moveTo(s,l+c),t.lineTo(s,l+c+1));t.stroke(),e.scale>0?x=s+1:e.scale<0?x=s-A:A=0}e.showBorder&&(x=b(x)+.5,A-=1,S+=.5,I-=1),f=x,h=x+A,1===e.direction&&(f=2*n+i-x-A,h=2*n+i-x),A>=0&&I>=0&&(p=e.fillColor,e.isGradient&&(d=.9,p=t.createLinearGradient(f,S,h,S),g=G.ec(e.fillColor),m=H(g.a,b(229.5+g.r*(1-d)),b(229.5+g.g*(1-d)),b(229.5+g.b*(1-d))),y=e.scale<0?1-d:d,v=e.fillColor,w=e.scale<0?1:0,1===e.direction?(p.addColorStop(y,v),p.addColorStop(w,m)):(p.addColorStop(y,m),p.addColorStop(w,v))),t.fillStyle=p,t.fillRect(f,S,A,I),e.showBorder&&A>0&&I>0&&(t.strokeStyle=e.borderColor,t.strokeRect(f,S,A,I)))},e}(zt),e.DataBarRule=qt,Yt={gradient:nt("gradient",!0),color:nt("color",p),showBorder:nt("showBorder",!1),borderColor:nt("borderColor","black"),dataBarDirection:nt("dataBarDirection",0),negativeFillColor:nt("negativeFillColor","red"),useNegativeFillColor:nt("useNegativeFillColor",!0),negativeBorderColor:nt("negativeBorderColor","black"),useNegativeBorderColor:nt("useNegativeBorderColor",!1),axisPosition:nt("axisPosition",0),axisColor:nt("axisColor","black"),showBarOnly:nt("showBarOnly",!1)},f.extend(qt.prototype,Yt),Xt=function(t,e,n){this.isGreaterThanOrEqualTo=t,this.iconValueType=e,this.iconValue=n},e.IconCriterion=Xt,Zt=["ruleType","ranges","iconSetType","iconCriteria","showIconOnly","reverseIconOrder","priority","icons"],Qt=function(t){function e(e,n){var o=this,r=e;return 0===arguments.length&&(r=0),(o=t.call(this,13,p,p,p)||this).xyb=!1,o.ranges(n),o.ad(r),o}return Kt(e,t),e.prototype.xW=function(t){var e=this;e.iconSetType(t,!1),e.iconSetType()>=bt.threeArrowsColored&&e.iconSetType()<=bt.threeSymbolsUncircled?(e.NV=[],e.NV[0]=new Xt(!0,wt.percent,33),e.NV[1]=new Xt(!0,wt.percent,67),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2}):e.iconSetType()>=bt.fourArrowsColored&&e.iconSetType()<=bt.fourTrafficLights?(e.NV=[],e.NV[0]=new Xt(!0,wt.percent,25),e.NV[1]=new Xt(!0,wt.percent,50),e.NV[2]=new Xt(!0,wt.percent,75),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2},e.CZa[3]={iconSetType:t,iconIndex:3}):e.iconSetType()>=bt.fiveArrowsColored&&e.iconSetType()<=bt.fiveBoxes?(e.NV=[],e.NV[0]=new Xt(!0,wt.percent,20),e.NV[1]=new Xt(!0,wt.percent,40),e.NV[2]=new Xt(!0,wt.percent,60),e.NV[3]=new Xt(!0,wt.percent,80),e.CZa=[],e.CZa[0]={iconSetType:t,iconIndex:0},e.CZa[1]={iconSetType:t,iconIndex:1},e.CZa[2]={iconSetType:t,iconIndex:2},e.CZa[3]={iconSetType:t,iconIndex:3},e.CZa[4]={iconSetType:t,iconIndex:4}):e.iconSetType()>bt.fiveBoxes&&(e.NV=[],e.CZa=[])},e.prototype.ad=function(t){this.showIconOnly(!1),this.reverseIconOrder(!1),this.xW(t)},e.prototype.yW=function(t){var e=X(this.NV)+1;return this.reverseIconOrder()&&e>2?e-1-t:t},e.prototype.pW=function(t,e,n,o){var r=this,i=r.NV[o];if(i)switch(i.iconValueType){case wt.formula:case wt.number:return r.mW(t,e,n,i.iconValue);case wt.percent:return r.nW(t,e,n,i.iconValue);case wt.percentile:return r.oW(t,e,n,i.iconValue);default:return p}},e.prototype.evaluate=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,d,g,m,y=this,v=o;if(E(v))return p;if(r={},i=x(o,!0)&&"boolean"!=typeof v&&A(o,r)?r.value:NaN,isNaN(i))return p;if(a=0,s=y.iconSetType(),l=y.NV,s>=bt.fiveArrowsColored?a=5:s>=bt.fourArrowsColored?a=4:s>=bt.threeArrowsColored&&(a=3),!l)return 0;for(c=0,f=a-1;f>0;f--)if(f<X(l)+1&&(u=l[f-1],!E(u&&u.iconValue)&&(h=y.pW(t,e,n,f-1),!E(h)&&(d=u.isGreaterThanOrEqualTo?i>=h:i>h,i<Number.MAX_VALUE&&d)))){c=f;break}return g=y.yW(c),(m=y.CZa)?{iconSetType:m[g]?m[g].iconSetType:bt.noIcons,iconIndex:m[g]?m[g].iconIndex:0,showIconOnly:y.showIconOnly()}:{iconSetType:bt.noIcons,iconIndex:0,showIconOnly:y.showIconOnly()}},e.prototype.reset=function(){var t=this;t.ranges(p),t.condition(p),t.style(p),t.showIconOnly(!1),t.reverseIconOrder(!1),t.iconSetType(0,p),t.NV=p,t.stopIfTrue(!1),t.priority(1),t.minColor(p),t.minValue(p),t.minType(5),t.midColor(p),t.midValue(p),t.midType(p),t.maxColor(p),t.maxValue(p),t.maxType(7),t.CZa=p},e.prototype.icons=function(t){return 1===arguments.length&&(this.CZa=t),this.CZa},e.prototype.iconCriteria=function(){return this.NV},e.prototype.toJSON=function(t){return ot.call(this,t,Zt)},e.prototype.fromJSON=function(t,e,n){rt.call(this,e,Zt,t,n),this.initCondition(e)},e.getIcon=function(t,e){return p},e.Pdc=function(t,e,n,o,r,i,a){if(a.ko(e)){var s=a.lo(e);t.drawImage(s,n,o,r,i)}else a.fo(e)},e.paintIconSet=function(t,n,o,r,i,a,s,u,c,h){var p,d,g=l.To.No(s.font,1).fontSize,m=o+2;if(n.showIconOnly&&(1===s.hAlign?m=o+i/2-g/2:2===s.hAlign&&(m=o+i-2-g-2)),p=1===s.vAlign?r+a/2-g/2:2===s.vAlign?r+a-2-u/2-g/2:r+2+u/2-g/2,n.iconSetType!==bt.noIcons)if((d=e.getIcon(n.iconSetType,n.iconIndex))&&"string"===f.getType(d)&&h)try{e.Pdc(t,d,m,p,g,g,h)}catch(t){}else oe(t,n,m,p,g,o,r,i,a)},e}(zt),e.IconSetRule=Qt,Jt={iconSetType:nt("iconSetType",bt.threeArrowsColored,(function(t){this.xW(t)})),reverseIconOrder:nt("reverseIconOrder",!1),showIconOnly:nt("showIconOnly",!1)},f.extend(Qt.prototype,Jt),$t=function(){function t(t){this.AW=[],this.BW=p,this.DW={},this.Kfc=!0,this.WS=t}return t.prototype.no=function(){this.WS=p},t.prototype.getRule=function(t){return this.AW[t]},t.prototype.count=function(){return X(this.AW)},t.prototype.w4=function(){return this.AW},t.prototype.UV=function(t){var e,n,o=[],r=this.WS,i=X(t);for(e=0;e<i;e++)n=r.Tq(t[e]),o.push(n);return o},t.prototype.EW=function(t){var e,n,o,r,i=[],a=this.WS;for(e=0,n=X(t);e<n;e++)o=t[e],r=new z(o.row,o.col,te(o),ee(o)),0===o.row&&te(o)===a.getRowCount()&&(r.row=-1),0===o.col&&ee(o)===a.getColumnCount()&&(r.col=-1),i.push(r);return i},t.prototype.QV=function(){if(this.Kfc&&(this.DW={},this.AW))for(var t=0;t<X(this.AW);t++)this.FW(this.AW[t])},t.prototype.OV=function(){this.Kfc&&(this.DW={})},t.prototype.FW=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;if(this.Kfc)for(n=(e=this).DW,s=e.UV(t.ranges()),u=(l=e.WS).getRowCount(),c=l.getColumnCount(),f=0;f<X(s);f++)for(p=(h=s[f]).row,d=h.col,p+(g=te(h))-1>=u&&(g=u-p),d+(m=ee(h))-1>=c&&(m=c-d),y=0;y<g;y++)for((o=n[i=y+p])||(n[i]=o=[]),v=0;v<m;v++)(r=o[a=v+d])||(o[a]=r=[]),r.push(t)},t.prototype.GW=function(t){var e,n,o,r,i,a,s,l,u,c,f;if(this.Kfc)for(e=this.DW,i=this.UV(t.ranges()),a=0;a<X(i);a++)for(s=i[a],l=0;l<te(s);l++)if(n=e[l+s.row])for(u=0;u<ee(s);u++)if(o=n[r=u+s.col]){for(c=[],f=0;f<X(o);f++)o[f]!==t&&c.push(o[f]);0===X(c)&&(c=d),n[r]=c}},t.prototype.HW=function(t,e,n,o){var r,i,a,s;if(this.Kfc)for(r=this.DW,a=0;a<n;a++)if(i=r[a+t])for(s=0;s<o;s++)i[s+e]=d},t.prototype.Ayb=function(t,e){var n,o,r=[];for(n=0;n<X(this.AW);n++)(o=this.AW[n]).contains(t,e)&&r.push(o);return r},t.prototype.addSpecificTextRule=function(t,e,n,o){var r=new Bt(2,o,n,t,p,p,e);return this.addRule(r)},t.prototype.addCellValueRule=function(t,e,n,o,r){var i=new Bt(1,r,o,t,ie(e),ie(n));return this.addRule(i)},t.prototype.addDateOccurringRule=function(t,e,n){var o=new Bt(4,n,e,p,p,p,p,p,t);return this.addRule(o)},t.prototype.addFormulaRule=function(t,e,n){var o=new Bt(3,n,e,p,p,p,p,t);return this.addRule(o)},t.prototype.addTop10Rule=function(t,e,n,o){var r=new Bt(5,o,n,p,p,p,p,p,t,e);return this.addRule(r)},t.prototype.addUniqueRule=function(t,e){var n=new Bt(6,e,t);return this.addRule(n)},t.prototype.addDuplicateRule=function(t,e){var n=new Bt(7,e,t);return this.addRule(n)},t.prototype.addAverageRule=function(t,e,n){var o=new Bt(8,n,e,p,p,p,p,p,t);return this.addRule(o)},t.prototype.add3ScaleRule=function(t,e,n,o,r,i,a,s,l,u){var c;return c=0===arguments.length?new zt(11):new zt(11,t,e,n,o,r,i,a,s,l,u),this.addRule(c)},t.prototype.add2ScaleRule=function(t,e,n,o,r,i,a){var s;return s=0===arguments.length?new zt(10):new zt(10,t,e,n,p,p,p,o,r,i,a),this.addRule(s)},t.prototype.addDataBarRule=function(t,e,n,o,r,i){var a;return a=0===arguments.length?new qt:new qt(t,e,n,o,r,i),this.addRule(a)},t.prototype.addIconSetRule=function(t,e){var n=new Qt(t,e);return this.addRule(n)},t.prototype.addRule=function(t){var e,n,o,r,i,a,s,l,u,c,f=this,h=f.WS;if(h){if(!t)throw Error(K().Exp_RuleIsNull);for(n=void 0,o=void 0,(e=t.ranges())&&(n=(r=P(e)).r,o=r.c),(a=(i=t.getExpected())&&i.formatter)&&"string"==typeof a&&h.fJb(n||0,o||0,a),h.ITa.YUa(),s=0,l=X(f.AW);s<l;s++)c=(u=f.AW[s]._ps).priority||1,u.priority=c+1;return t.priority(1),f.AW.push(t),t.context(h),f.FW(t),h.$p(),t}},t.prototype.removeRule=function(t){var e,n,o=this,r=o.WS,i=r.parent;r&&(t&&((n=(e=t.getExpected())&&e.formatter)&&"string"==typeof n&&i.QHb[n]&&i.RHb(n),r.ITa.YUa(),o.GW(t),q(o.AW,t)),r.$p())},t.prototype.IW=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,d,g,m,C,b;return t.intersect(e,n,o,r)?(i=t.row,a=t.row+te(t)-1,s=t.col,l=t.col+ee(t)-1,u=e,c=e+o-1,f=n,h=n+r-1,d=[],-1!==i&&-1!==s&&-1!==u&&-1!==f&&(f-s>0&&(g=V(i,s,te(t),f-s),d.push(g)),l-h>0&&(m=V(i,h+1,te(t),l-h),d.push(m)),u-i>0&&(C=V(i,v(f,s),u-i,y(h,l)-v(f,s)+1),d.push(C)),a-c>0&&(b=V(c+1,v(f,s),a-c,y(h,l)-v(f,s)+1),d.push(b))),X(d)>0?d:p):[t]},t.prototype.removeRuleByRange=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g=this,m=g.WS;if(m){if(r=[],g.AW)for(m.ITa.YUa(),g.HW(t,e,n,o),i=0,a=X(g.AW);i<a;i++)if((s=g.AW[i])&&s.ranges()&&s.intersects(t,e,n,o)){for(l=[],u=g.UV(s.ranges()),c=0,f=X(u);c<f;c++)(h=g.IW(u[c],t,e,n,o))&&(l=l.concat(h));X(l)>0?s.ranges(g.EW(l)):r.push(s)}for(p=0,d=X(r);p<d;p++)q(g.AW,r[p]);m.$p()}},t.prototype.clearRule=function(){var t,e,n,o,r=this,i=r.WS,a=i.parent;if(i){for(t=r.AW,i.ITa.YUa(),e=0;e<t.length;e++)(o=(n=t[e].getExpected())&&n.formatter)&&"string"==typeof o&&a.QHb[o]&&a.RHb(o);r.AW.length=0,r.QV(),i.$p()}},t.prototype.getRules=function(t,e){var n,o,r,i,a,s,l,u,c=this,h=c.AW;if(0===arguments.length||0===X(h))return h;if(t=t===d?-1:t,e=e===d?-1:e,n=[],c.Kfc)o=c.DW,i=void 0,-1!==t&&-1!==e?(i=o[t])&&(r=i[e],ae(n,r)):-1===t?f.each(o,(function(t,o){r=o[e],ae(n,r)})):(i=o[t])&&f.each(i,(function(t,e){ae(n,e)}));else if(s=(a=c.WS).getRowCount(),l=a.getColumnCount(),u=void 0,-1!==t&&-1!==e)ae(n,c.Ayb(t,e));else if(-1===t)for(u=0;u<s;u++)ae(n,c.Ayb(u,e));else for(u=0;u<l;u++)ae(n,c.Ayb(t,u));return n},t.prototype.containsRule=function(t,e,n){return!(!t||!U.Bb(this.AW,t))&&t.contains(e,n)},t.prototype._V=function(t,e,n,o){var r,i,a,s=this;if(s.AW&&s.WS)for(r=X(s.AW),i=0;i<r;i++)(a=s.AW[i])&&(n?a.rI(t,e,o):a.tI(t,e,o));s.QV()},t.prototype.rI=function(t,e,n){this._V(t,e,!0,n)},t.prototype.tI=function(t,e,n){this._V(t,e,!1,n)},t.prototype.aW=function(t,e,n){var o,r,i=this;if(i.AW&&i.WS)for(o=X(i.AW)-1;o>=0;o--)(r=i.AW[o])&&(n?r.GR(t,e):r.HR(t,e),r.ranges().length<=0&&(i.GW(r),i.AW.splice(o,1)));i.QV()},t.prototype.GR=function(t,e){this.aW(t,e,!0)},t.prototype.HR=function(t,e){this.aW(t,e,!1)},t.prototype.Nm=function(){var t,e,n,o=this.AW;if(o!==p&&X(o)>0)for(e=0,n=X(o);e<n;e++)(t=o[e]).Nm&&t.Nm()},t.prototype.XA=function(t,e,n,o,r,i,a,s){var l,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F=[],_=[],L=[],B=[],G=this,H=G.WS;for(-1===t&&(t=0,o=0,i=H.getRowCount()),-1===e&&(e=0,r=0,a=H.getColumnCount()),l=0;l<i;l++)for(c=0;c<a;c++)for(f=G.getRules(t+l,e+c),h=0;h<X(f);h++){for(d=(p=f[h]).ranges(),g=[],m=0;m<X(d);m++)y=d[m],C=(v=H.Tq(y)).row,b=v.col,w=te(v),T=ee(v),Y(L,y)<=-1&&y.contains(t+l,e+c)&&(L.push(y),(x=V(o+l,r+c,-1,-1)).rowCount=C+w>=i+t?i-l:t<C?w:C+w-t,x.colCount=b+T>=a+e?a-c:e<b?T:b+T-e,G===n&&y.containsRange(x)||g.push(x),s&&-1===B.indexOf(x)&&B.push(x));g.length>0&&((S=F.indexOf(p))<0?(F.push(p),_.push(g)):_[S]=_[S].concat(g))}for(A=0,I=F.length;A<I;A++)k=(R=G.iga(F[A].toJSON(),F[A].context())).ranges(),R.ranges(_[A]),(M=R.Yw)&&(N=1===H.parent.options.referenceStyle,E=P(k),D=u.formulaToExpression(H,M,E.r,E.c,N),O=P(_[A]),j=u.expressionToFormula(H,D,O.r,O.c,N),R.formula(j)),n.addRule(R);return G.QV(),B},t.prototype.YA=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,C,b,w,T,x=[],S=this,A=S.WS,I=A.getRowCount(3),R=A.getColumnCount(3);for(-1===t&&(t=0,n=A.getRowCount()),-1===e&&(e=0,o=A.getColumnCount()),a=0;a<n;a++)for(s=0;s<o;s++)for(l=S.getRules(t+a,e+s),u=0;u<X(l);u++){for(f=(c=l[u]).ranges(),h=[],p=0;p<X(f);p++)d=f[p],m=(g=A.Tq(d)).row,C=g.col,b=te(g),w=ee(g),B.Bb(r,d)||Y(x,d)<=-1&&d.contains(t+a,e+s)&&(x.push(d),t>m&&h.push(V(m,C,t-m,w)),e>C&&h.push(V(v(t,m),C,y(t+n,m+b)-v(t,m),e-C)),e+o<C+w&&h.push(V(v(t,m),e+o,y(t+n,m+b)-v(t,m),C+w-(e+o))),t+n<m+b&&h.push(V(t+n,C,m+b-(t+n),w)));S.Byb(A,x,r,f,I,R,i),(T=f.concat(h)).length>0?(c.yyb(),c.ranges(T)):S.removeRule(c)}S.QV()},t.prototype.Byb=function(t,e,n,o,r,i,a){var s,l,u,c,f,h;for(s=0;s<X(e);s++){if(u=[l=e[s]],a)for(c=0;c<X(n);c++)f=n[c],l.intersect(f.row,f.col,f.rowCount,f.colCount)&&(u=u.concat(t.v_a(l,f,r,i)));for(h=0;h<X(u);h++)q(o,u[h])}},t.prototype.jp=function(t,e,n,o,r,i,a,s){var l=16,u=!1,c=!1,f=s.sheet,h=s.row,p=s.col,d=f.zoom(),g=this.oRa(f,h,p,e),m=g.iconSet,y=g.dataBar;return(y||m)&&(t.save(),t.beginPath(),y&&(qt.paintDataBar(t,y,n,o,r,i),u=y.showBarOnly),m&&((r<(l=parseInt(l*d+"",10))||i<l)&&(t.rect(n,o,r,i),t.clip(),t.beginPath()),Qt.paintIconSet(t,m,n,o,r,i,a,s.lineHeight,d,s.imageLoader),c=m.showIconOnly),t.restore()),u||c},t.prototype.oRa=function(t,e,n,o){var r,i,a,s,l,u,c,f,h=t.ss,d=h.Um(e,n);if(d)r=d.i,i=d.d;else{if(a=this.getRules(e,n),(s=X(a))>0){for(a.sort((function(t,e){return t.priority()-e.priority()})),l=p,u=p,c=void 0,void 0,f=void 0,f=0;f<s&&(!l||!u);f++)(c=a[f])&&(O(c,qt)&&(l=c),O(c,Qt)&&(u=c));if(l||u)for(l=u=p,f=0;!(!(f<s)||l&&u||(c=a[f],c&&(!l&&O(c,qt)&&(l=c),!u&&O(c,Qt)&&(u=c),c.stopIfTrue()&&c.evaluate(t,e,n,o))));f++);l&&(i=l.evaluate(t,e,n,o)),u&&(r=u.evaluate(t,e,n,o))}h.Wm(e,n,i,r)}return{dataBar:i,iconSet:r}},t.prototype.bp=function(t,e,n){var o,r,i;if(E(n)||3===n)for(o=this.getRules(t,e),r=0,i=X(o);r<i;r++)if(o[r]instanceof Qt)return!0;return!1},t.prototype.toJSON=function(t){var e,n,o=[];for(e=0;e<X(this.AW);e++)n=this.AW[e],o.push(n?n.toJSON(t):p);return 0===X(o)?d:{rules:o}},t.prototype.fromJSON=function(t,e,n){var o,r,i,a,s;if(t&&(o=t.rules)){for(this.AW=[],r=X(o),i=0;i<r;i++)a=o[i],(s=this.iga(a,e,n))&&this.AW.push(s);this.Kfc=!function(t){var e,n,o,r,i=X(t);for(e=0;e<i;e++)if(n=t[e],o=n.ranges)for(r=0;r<o.length;r++)if(o[r].rowCount>1e3)return!0;return!1}(o),this.QV()}},t.prototype.iga=function(t,e,n){var o,r=p;return t&&((o=this.JW()[t.ruleType])&&(r=new o).fromJSON(t,e,n)),r},t.prototype.JW=function(){if(!this.BW){var t={};t[0]=Bt,t[1]=Bt,t[2]=Bt,t[3]=Bt,t[4]=Bt,t[5]=Bt,t[6]=Bt,t[7]=Bt,t[8]=Bt,t[9]=zt,t[10]=zt,t[11]=zt,t[12]=qt,t[13]=Qt,this.BW=t}return this.BW},t.prototype.Eq=function(t,e,n,o){var r,i,a,s,l,u,c=this;if(c&&c.count()>0&&(r=c.getRules(e,n),i=X(r),a=void 0,s=p,i>0))for(r.sort((function(t,e){return t.priority()-e.priority()})),l=0;l<i&&!((a=r[l])&&(u=c.WS,a.isScaleRule()?10!==a.ruleType()&&11!==a.ruleType()||(s=a.evaluate(u,e,n,u.getValue(e,n,o)),s&&(t||(t=new L),t.backColor===d&&(t.backColor=s))):(s=a.evaluate(u,e,n,u.getValue(e,n,o)),s&&(t||(t=new L),t.Yo(s,!1,1))),a.stopIfTrue()&&s));l++);return t},t.prototype.Fq=function(t,e,n,o){var r,i,a,s,l,u,c,f,h={v5:!1},g=this;if(g&&g.count()>0&&(r=g.getRules(t,e),i=X(r),a=void 0,s=p,i>0))for(r.sort((function(t,e){return t.priority()-e.priority()})),l=0;l<i;l++)if(a=r[l]){if(u=g.WS,a.isScaleRule()){if(c=a.ruleType(),"backColor"===n&&(10===c||11===c)&&(s=a.evaluate(u,t,e,u.getValue(t,e,o)))){h.Fi=s,h.v5=!0;break}}else{if(!((f=a.style())&&void 0!==f[n]||a.stopIfTrue()))continue;if((s=a.evaluate(u,t,e,u.getValue(t,e,o)))&&s[n]!==d){h.Fi=s[n],h.v5=!0;break}}if(a.stopIfTrue()&&s)break}return h},t}(),e.ConditionalFormats=$t},"./dist/plugins/conditional/conditional.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/conditional/conditional.res.en.js");e.SR={en:o}},"./dist/plugins/conditional/conditional.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_RuleIsNull="The argument 'rule' is null",e.Exp_NotSupported="NotSupportException"},"./dist/plugins/conditional/conditionalFormatIcon.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b;function w(t,e,n,o,r){t.beginPath(),t.moveTo(e,n),t.lineTo(e+o,n),t.lineTo(e+o,n+r),t.lineTo(e,n+r),t.lineTo(e,n),t.closePath(),t.fill(),t.stroke()}function T(t,e,n){t.moveTo(i(.1*o)*e,-a(.1*o)*e),t.lineTo(i(.3*o)*n,-a(.3*o)*n),t.lineTo(0*e,-a(.5*o)*e),t.lineTo(i(.7*o)*n,-a(.7*o)*n),t.lineTo(i(.9*o)*e,-a(.9*o)*e),t.lineTo(i(1.1*o)*n,-a(1.1*o)*n),t.lineTo(i(1.3*o)*e,-a(1.3*o)*e),t.lineTo(0*n,-a(1.5*o)*n),t.lineTo(i(1.7*o)*e,-a(1.7*o)*e),t.lineTo(i(1.9*o)*n,-a(1.9*o)*n),t.lineTo(i(.1*o)*e,-a(.1*o)*e)}function x(t,e,n,i,a,s){var l=s,u=r(l/2);t.translate(i+u,a+u),t.strokeStyle=b[e][n].strokeStyle,t.rotate(b[e][n].rotate),t.beginPath(),t.arc(0,0,u,0,2*o),t.closePath(),t.fillStyle=b[e][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,u,0,2*o),t.closePath(),t.stroke(),t.beginPath(),t.fillStyle=b[e][n].fillColor2,t.fillRect(.375*-l,.1*-l,.75*l,.2*l),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[e][n].fillColor2,t.fillRect(.1*-l,.375*-l,.2*l,.75*l),t.closePath(),t.fill(),t.stroke()}function S(t,e,n,r,i,a){var s=a;t.translate(r,i),t.strokeStyle=b[e][n].strokeStyle,t.beginPath(),t.arc(.5*s,.5*s,.5*s,0,2*o),t.closePath(),t.fillStyle=b[e][n].fillColor,t.fill(),t.beginPath(),t.arc(.5*s,.5*s,.5*s,0,2*o),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(s/3,.1*s),t.lineTo(s/1.5,.1*s),t.lineTo(.625*s,.6*s),t.lineTo(.375*s,.6*s),t.lineTo(s/3,.1*s),t.moveTo(.625*s,.85*s),t.arc(.5*s,.8*s,.15*s,0,2*o),t.fillStyle=b[e][n].fillColor2,t.fill(),t.closePath()}function A(t,e,n,i,a,s){var l=s;t.translate(r(i+l/2),r(l/2+a)),t.strokeStyle=b[e][n].strokeStyle,t.rotate(b[e][n].rotate),t.beginPath(),t.arc(0,0,l/2,0,2*o),t.closePath(),t.fillStyle=b[e][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,l/2,0,2*o),t.stroke(),t.closePath(),t.beginPath(),t.fillStyle=b[e][n].fillColor2,t.fillRect(.325*-l,.25*-l,.2*l,.5*l),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[e][n].fillColor2,t.fillRect(.325*-l,.05*l,.65*l,.2*l),t.closePath(),t.fill(),t.stroke()}function I(t,e,n,r,i,a){var s=a;t.translate(r,i),t.beginPath(),t.strokeStyle=b[e][n].strokeStyle,t.moveTo(s/3,.5),t.lineTo(s/1.5,.5),t.lineTo(.625*s,.65*s),t.lineTo(.375*s,.65*s),t.lineTo(s/3,.5),t.moveTo(.65*s,.85*s),t.arc(.5*s,.85*s,.15*s,0,2*o),t.fillStyle=b[e][n].fillColor,t.fill(),t.stroke()}function R(t,e,n,o,i,a){var s,l,u=a;t.translate(r(o+u/2),r(i+u/2)),t.strokeStyle=b[e][n].strokeStyle,t.rotate(b[e][n].rotate),t.beginPath(),P(t,-(s=.5*u),-(l=.075*u)),F(t,-s,l),F(t,-l,l),F(t,-l,s),F(t,l,s),F(t,l,l),F(t,s,l),F(t,s,-l),F(t,l,-l),F(t,l,-s),F(t,-l,-s),F(t,-l,-l),F(t,-s,-l),t.fillStyle=b[e][n].fillColor,t.fill(),t.stroke()}function k(t,e,n,o,i,a){var s=a;t.translate(r(o+s/2),r(i+s/2)),t.strokeStyle=b[e][n].strokeStyle,t.rotate(b[e][n].rotate),t.beginPath(),t.fillStyle=b[e][n].fillColor,t.fillRect(.375*-s,.25*-s,.2*s,.5*s),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=b[e][n].fillColor,t.fillRect(.375*-s,.05*s,.75*s,.2*s),t.closePath(),t.fill(),t.stroke()}function M(t,e,n,r,i,a){var s=a;t.strokeStyle=b[e][n].strokeStyle,t.beginPath(),t.arc(s/2+r,s/2+i,s/2,0,2*o),t.fillStyle=b[e][n].fillColor,t.closePath(),t.fill(),t.stroke()}function N(t,e,n,o,i,a){var s=a;t.strokeStyle=b[e][n].strokeStyle,t.beginPath(),t.translate(o+r(s/2),i+r(s/2)),t.beginPath(),P(t,0,-s/2),F(t,s/2,0),F(t,0,s/2),F(t,-s/2,0),F(t,0,-s/2),t.fillStyle=b[e][n].fillColor,t.closePath(),t.fill(),t.stroke()}function E(t,e,n,o,i,a){var s=r(a);t.translate(o,i),t.strokeStyle=b[e][n].strokeStyle,t.beginPath(),P(t,0,s),F(t,s/2,s-s/2*Math.sqrt(3)),F(t,s,s),F(t,0,s),t.fillStyle=b[e][n].fillColor,t.closePath(),t.fill(),t.stroke()}function D(t,e,n,o,i,a){var s=a;t.strokeStyle=b[e][n].strokeStyle,t.translate(r(s/2+o),r(s/2+i)),t.beginPath(),t.rotate(b[e][n].rotate),P(t,-s/2,-s/5.4),F(t,s/2,-s/5.4),F(t,s/2,s/5.4),F(t,-s/2,s/5.4),F(t,-s/2,-s/5.4),t.fillStyle=b[e][n].fillColor,t.fill(),t.stroke()}function O(t,e,n,o,i,a){t.strokeStyle=b[e][n].strokeStyle;var s=a;t.translate(r(s/2+o),r(s/2+i)),t.beginPath(),P(t,-s/2,-s/3),F(t,s/2,-s/3),F(t,0,s/3),F(t,-s/2,-s/3),t.fillStyle=b[e][n].fillColor,t.fill(),t.stroke()}function j(t,e,n,o,i,a){t.strokeStyle=b[e][n].strokeStyle;var s=a;t.translate(r(s/2+o),r(s/2+i)),t.beginPath(),P(t,-s/2,s/3),F(t,s/2,s/3),F(t,0,-s/3),F(t,-s/2,s/3),t.fillStyle=b[e][n].fillColor,t.fill(),t.stroke()}function F(t,e,n){t.lineTo(r(e)+.5,r(n)+.5)}function P(t,e,n){t.moveTo(r(e)+.5,r(n)+.5)}Object.defineProperty(e,"__esModule",{value:!0}),o=Math.PI,r=Math.round,i=Math.cos,a=Math.sin,b=[[{strokeStyle:l="#326f5b",fillColor:u="#76a797",fillColor2:"",rotate:o},{strokeStyle:c="#A4802b",fillColor:f="#EAC282",fillColor2:"",rotate:-.5*o},{strokeStyle:h="#9E381C",fillColor:p="#D86344",fillColor2:"",rotate:0}],[{strokeStyle:d="#646262",fillColor:g="#808080",fillColor2:"",rotate:o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.5*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:o}],[{strokeStyle:c,fillColor:"#FFFFFF",fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:y="#303030",fillColor:v="#505050",fillColor2:"#d86344",rotate:0},{strokeStyle:y,fillColor:v,fillColor2:"#eac282",rotate:0},{strokeStyle:y,fillColor:v,fillColor2:u,rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:h,fillColor:p,fillColor2:"white",rotate:.25*o},{strokeStyle:c,fillColor:f,fillColor2:"white",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"white",rotate:-.25*o}],[{strokeStyle:h,fillColor:p,fillColor2:"",rotate:.25*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:-.25*o}],[{strokeStyle:l,fillColor:u,fillColor2:"",rotate:o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.75*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.25*o},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:g,fillColor2:"",rotate:o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.75*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.25*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:m="#353535",fillColor:v,fillColor2:"",rotate:0},{strokeStyle:g,fillColor:"#b1b1b1",fillColor2:"",rotate:0},{strokeStyle:"#b28578",fillColor:"#edb9ab",fillColor2:"",rotate:0},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:C="#727272",fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:s="#4d82b8 #4d82b8 #4d82b8 #4d82b8",fillColor2:"",rotate:0}],[{strokeStyle:m,fillColor:v,fillColor2:"",rotate:0},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:0},{strokeStyle:l,fillColor:u,fillColor2:"",rotate:0}],[{strokeStyle:l,fillColor:u,fillColor2:"",rotate:o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.75*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.5*o},{strokeStyle:c,fillColor:f,fillColor2:"",rotate:-.25*o},{strokeStyle:h,fillColor:p,fillColor2:"",rotate:0}],[{strokeStyle:d,fillColor:g,fillColor2:"",rotate:o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.75*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.5*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:-.25*o},{strokeStyle:d,fillColor:g,fillColor2:"",rotate:0}],[{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #4d82b8 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:s,fillColor2:"",rotate:0}],[{strokeStyle:v,fillColor:v,fillColor2:"",rotate:2*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:.5*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:.5*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:1*o},{strokeStyle:v,fillColor:v,fillColor2:"",rotate:2*o}],[{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #b3b3b3 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #b3b3b3",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#b3b3b3 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:"#4d82b8 #b3b3b3 #4d82b8 #4d82b8",fillColor2:"",rotate:0},{strokeStyle:C,fillColor:s,fillColor2:"",rotate:0}]],e.drawSignal=function(t,e,n,o,i,a){var s,l;t.translate(o,i),t.strokeStyle=b[e][n].strokeStyle,s=b[e][n].fillColor.split(" "),l=r(.2*a),t.fillStyle=s[0],w(t,l+.5,3*l+.5,l,2*l),t.fillStyle=s[1],w(t,2*l+.5,2*l+.5,l,3*l),t.fillStyle=s[2],w(t,3*l+.5,l+.5,l,4*l),t.fillStyle=s[3],w(t,4*l+.5,.5,l,5*l)},e.drawMagicCube=function(t,e,n,o,i,a){var s,l;t.translate(o,i),t.strokeStyle=b[e][n].strokeStyle,s=b[e][n].fillColor.split(" "),t.fillStyle=b[e][n].strokeStyle,l=r(a/2),t.fillStyle=s[0],w(t,.5,.5,l,l),t.fillStyle=s[1],w(t,l+.5,.5,l,l),t.fillStyle=s[2],w(t,.5,l+.5,l,l),t.fillStyle=s[3],w(t,l+.5,l+.5,l,l)},e.drawSector=function(t,e,n,r,i,a){t.translate(r+a/2,i+a/2),t.strokeStyle=b[e][n].strokeStyle,4===n?(t.beginPath(),t.arc(0,0,a/2,0,b[e][n].rotate),t.closePath(),t.fillStyle=b[e][n].fillColor,t.fill(),t.beginPath(),t.arc(0,0,a/2,0,b[e][n].rotate),t.closePath(),t.stroke()):0===n?(t.beginPath(),t.arc(0,0,a/2,0,2*o),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.arc(0,0,a/2,0,b[e][n].rotate),t.stroke(),t.closePath()):1===n?(t.beginPath(),t.arc(0,0,a/2,0,2*o),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-a/2),t.arc(0,0,a/2,.5*-o,0),t.lineTo(0,0),t.closePath(),t.fillStyle=b[e][n].fillColor,t.fill(),t.arc(0,0,a/2,0,2*o),t.stroke()):2===n?(t.beginPath(),t.arc(0,0,a/2,0,2*o),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-a/2),t.arc(0,0,a/2,.5*-o,.5*o),t.moveTo(0,0),t.closePath(),t.fillStyle=b[e][n].fillColor,t.fill(),t.arc(0,0,a/2,0,2*o),t.stroke()):3===n&&(t.beginPath(),t.arc(0,0,a/2,0,2*o),t.closePath(),t.fillStyle="white",t.fill(),t.beginPath(),t.moveTo(0,0),t.lineTo(0,-a/2),t.arc(0,0,a/2,.5*-o,o),t.lineTo(0,0),t.fillStyle=b[e][n].fillColor,t.fill(),t.arc(0,0,a/2,0,2*o),t.stroke(),t.closePath())},e.drawStar=function(t,e,n,r,s,l){var u=l/1.8,c=u/2.5;t.translate(u+r,u+s),t.strokeStyle="#727272",t.fillStyle=b[e][n].fillColor,t.beginPath(),2===n&&(t.strokeStyle="#727272",T(t,u,c),t.fill(),t.stroke(),t.strokeStyle=b[e][n].strokeStyle,T(t,u,c),t.stroke(),t.closePath()),0===n&&(t.fillStyle="white",T(t,u,c),t.fill(),t.stroke(),t.strokeStyle="#727272",T(t,u,c),t.stroke(),t.closePath()),1===n&&(t.strokeStyle=b[e][n].fillColor,t.moveTo(0*u,-a(.5*o)*u),t.lineTo(i(.7*o)*c,-a(.7*o)*c),t.lineTo(i(.9*o)*u,-a(.9*o)*u),t.lineTo(i(1.1*o)*c,-a(1.1*o)*c),t.lineTo(i(1.3*o)*u,-a(1.3*o)*u),t.lineTo(0*c,-a(1.5*o)*c),t.fill(),t.stroke(),t.closePath(),t.beginPath(),t.moveTo(0*u,-a(.5*o)*u),t.lineTo(-i(.7*o)*c,-a(.7*o)*c),t.lineTo(-i(.9*o)*u,-a(.9*o)*u),t.lineTo(-i(1.1*o)*c,-a(1.1*o)*c),t.lineTo(-i(1.3*o)*u,-a(1.3*o)*u),t.lineTo(0*c,-a(1.5*o)*c),t.fillStyle="white",t.fill(),t.closePath(),t.beginPath(),t.strokeStyle="#727272",T(t,u,c),t.stroke(),t.closePath())},e.drawIconTypeIsEight=function(t,e,n,o,r,i){2===n?A(t,e,n,o,r,i):0===n?x(t,e,n,o,r,i):1===n&&S(t,e,n,o,r,i)},e.drawIconTypeIsNine=function(t,e,n,o,r,i){2===n?k(t,e,n,o,r,i):0===n?R(t,e,n,o,r,i):1===n&&I(t,e,n,o,r,i)},e.drawFlag=function(t,e,n,o,i,a){var s=1.2*a;t.translate(o,i),t.strokeStyle=g,t.fillStyle=g,w(t,r(.2*s)+.5,.5,r(.06*s),r(.8*s)),t.strokeStyle=b[e][n].strokeStyle,t.beginPath(),P(t,.4*s,.5),F(t,.4*s,.5*s),F(t,.9*s,.25*s),F(t,.4*s,.5),t.fillStyle=b[e][n].fillColor,t.fill(),t.stroke()},e.drawIconTypeIsSen=function(t,e,n,o,r,i){2===n?M(t,e,n,o,r,i):1===n?E(t,e,n,o,r,i):N(t,e,n,o,r,i)},e.drawTrafficLight=function(t,e,n,i,a,s){var l=r(s);t.strokeStyle=b[e][n].strokeStyle,t.fillStyle=b[e][n].fillColor,w(t,i+.5,a+.5,l,l),t.beginPath(),t.arc(l/2+i+.5,l/2+a+.5,.375*l,0,2*o),t.fillStyle=b[e][n].fillColor2,t.fill(),t.stroke()},e.drawCircle=M,e.drawIconTypeIsTwo=function(t,e,n,o,r,i){1===n?D(t,e,n,o,r,i):0===n?O(t,e,n,o,r,i):2===n&&j(t,e,n,o,r,i)},e.drawArrows=function(t,e,n,o,i,a){var s,l,u,c,f=a/3.5,h=b[e].length-1;t.strokeStyle=b[e][h-n].strokeStyle,t.translate(r(1.75*f+o),r(1.75*f+i)),t.rotate(b[e][h-n].rotate),t.beginPath(),s=.25*f,l=1.25*f,P(t,-(u=.75*f),-(c=1.75*f)),F(t,s,-c),F(t,s,s),F(t,l,-u),F(t,l,s),F(t,-s,c),F(t,-c,s),F(t,-c,-u),F(t,-u,s),F(t,-u,-c),t.fillStyle=b[e][h-n].fillColor,t.fill(),t.stroke()}},"./dist/plugins/contextMenu/context-menu-dialog.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=o.Ul.vl,i=o.Go,a=o.GC$,s="gc.command.executed",l=function(t){function e(e,n){var o=t.call(this,e,r(e))||this;return o.Eu=n,o}return u(e,t),e.prototype.Qla=function(t,e,n){var o=this,r=t[0];o.kma&&o.kma.ai&&o.kma.ai(r,e,n,o.Eu)},e.prototype.OT=function(t,e,n,o,r){var i=this,a=i.Sla(n,o);i.kma=t,i.Qla(a,e,r)},e.prototype.Sla=function(e,n){var o=this.yo();return o.css(["left","top"],[e,n]),o.empty(),t.prototype.Ao.call(this),this.QQ(),o},e.prototype.Loa=function(t){var e,n,o,r=this.yo();return"block"!==r.css("display")||((e=r.offset()).top+=document.body.clientTop||0,e.left+=document.body.clientLeft||0,n=t.x,o=t.y,n<e.left||n>r.width()+e.left||o<e.top||o>r.height()+e.top)},e.prototype.QQ=function(){var t=this;t.Eu.bind(s,(function(){t.close()}))},e.prototype.Tla=function(){this.Eu.unbind(s)},e.prototype.close=function(){var e=this;e.kma&&e.kma.no(),e.Tla(),e.vo(e.Cj)&&a("#"+e.Cj).remove(),t.prototype.close.call(this)},e}(i),e.ContextMenuViewDialog=l},"./dist/plugins/contextMenu/context-menu.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/contextMenu/context-menu.js")),o(n("./dist/plugins/contextMenu/menu-view.js")),o(n("./dist/plugins/contextMenu/context-menu.ns.js"));var r=n("./dist/plugins/contextMenu/context-menu-dialog.js");e.Cyb=r.ContextMenuViewDialog},"./dist/plugins/contextMenu/context-menu.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct;function bt(t){var e,n;if(t.slicers){if(!(e=t.slicers.all())||c(e))return null;for(n in e)if(e[n].isSelected())return!0;return!1}}function wt(t,e,n){var o,r,i,a,s="row"===e?"rowCount":"colCount";for(o=0;o<t.length;o++)for(i=-1===(r=t[o])[e]?0:r[e],a=0;a<r[s];a++)n(i+a)}function Tt(t,e){var n,o=[],r=-1;for(n=t.row;n<t.row+t.rowCount;n++)!1!==e[n]&&-1===r&&(r=n),!1===e[n]&&-1!==r&&(o.push([r,n-r]),r=-1);return-1!==r&&o.push([r,n-r]),o}function xt(t,e){var n,o,r,i;if(1===e.colCount&&-1===e.row){if((n=e.col)===t.$q()&&((o=n-1)>=0&&!t.getColumnVisible(o)))return!0}else if(1===e.rowCount&&-1===e.col&&((r=e.row)===t.ar()&&((i=r-1)>=0&&!t.getRowVisible(i))))return!0}function St(t,e){var n,o,r,i,a,s=[p+F,p+S,p+T,p+x],l=e.name;if(s.indexOf(l)<0)return!0;if(o=(n=t.getActiveSheet()).getActiveRowIndex(),r=n.getActiveColumnIndex(),n.comments){if(n.comments.get(o,r))return l!==p+F;if(l===p+S||l===p+T)return!1;if(l===p+F)return!0;for(i=n.getSelections(),a=0;a<i.length;a++)if(It(i[a],n))return!0;return!1}}function At(t,e){var n,o,r,i,a,s;if(e.comments)for(n=e.comments.all(),o=void 0,r=void 0,i=0;i<t.length;i++)for(a=t[i],s=0;s<n.length;s++)if(!n[s].locked()&&(r=n[s].nT,o=n[s].oT,r>=a.row&&r<a.row+a.rowCount&&o>=a.col&&o<a.col+a.colCount))return!0;return!1}function It(t,e){var n,o,r,i;if(e.comments)for(n=e.comments.all(),o=void 0,r=void 0,i=0;i<n.length;i++)if(r=n[i].nT,o=n[i].oT,r>=t.row&&r<t.row+t.rowCount&&o>=t.col&&o<t.col+t.colCount)return!0;return!1}function Rt(t,e){var n,o,r,i,a;return[p+O,p+j].indexOf(e.name)<0||!(!(o=(n=t.getActiveSheet()).getSelections())||1!==o.length||(r=o[0],i=Mt(n,r),i&&(a=i.range(),r.row<a.row||r.col<a.col||r.row+r.rowCount>a.row+a.rowCount||r.col+r.colCount>a.col+a.colCount)))}function kt(t){var e,n,o,r=t.getActiveRowIndex(),i=t.getActiveColumnIndex();if(!t.tu().UHb)return!1;if(t.tables&&t.tables.find(r,i))return!1;for(e=t.ITa.getSpans(),n=0;n<e.length;n++)if(r>=(o=e[n]).row&&r<o.row+o.rowCount&&i>=o.col&&i<o.col+o.colCount)return!1;return!0}function Mt(t,e){var n,o,r;if(!e)return null;for(n=e.row;n<e.row+e.rowCount;n++)for(o=e.col;o<e.col+e.colCount;o++)if(t.tables&&(r=t.tables.find(n,o)))return r;return null}function Nt(t,e,n,o){var r,i;for(r=0;r<e.length;r++)(i=e[r]).PIb(n,o,!0,dt,i.nKb())}function Et(t){var e,n,o,r=t;for(e=0;e<r.length-1;e++)for(n=e+1;n<r.length;n++)r[e].row<r[n].row&&(o=r[e],r[e]=r[n],r[n]=o);return r}function Dt(t){var e,n,o,r=t;for(e=0;e<r.length-1;e++)for(n=e+1;n<r.length;n++)r[e].col<r[n].col&&(o=r[e],r[e]=r[n],r[n]=o);return r}function Ot(t,e,n,o){var r=t.ITa.getSpans(dt,3);e>=0?(Ft(t,r,e,o,3),Ft(t,t.ITa.getSpans(dt,2),e,o,2)):n>=0&&(jt(t,r,n,o,3),jt(t,t.ITa.getSpans(dt,1),n,o,1))}function jt(t,e,n,o,r){var i,a,s,l,u,c,f;for(i=0,a=e.length;i<a;i++)if(n>(s=e[i]).col&&n<s.col+s.colCount)for(l=t.getStyle(s.row,s.col,r),u=n;u<n+o;u++)for(c=s.row;c<s.row+s.rowCount;c++)t.setStyle(c,u,l,r),c===s.row+s.rowCount-1&&((f=t.getCell(s.row+s.rowCount-1,s.col).borderBottom())&&t.getCell(c,u).borderBottom(f))}function Ft(t,e,n,o,r){var i,a,s,l,u,c,f;for(i=0,a=e.length;i<a;i++)if(n>=(s=e[i]).row&&n<=s.row+s.rowCount)for(l=t.getStyle(s.row,s.col,r),u=n;u<n+o;u++)for(c=s.col;c<s.col+s.colCount;c++)t.setStyle(u,c,l,r),c===s.col+s.colCount-1&&((f=t.getCell(s.row,s.col+s.colCount-1).borderRight())&&t.getCell(u,c).borderRight(f))}function Pt(t,e,n,o,r){var i,s,l,u,c,f=t.getSheetFromName(e.sheetName);return!!f&&(i=e.considerAllSheets,s=t.sheets,f.suspendPaint(),l=a.Commands.bWa(f.name()),n?(r&&r(f,e),i?a.Commands._xb(s,e):f.ITa.undo(e[l])):(i?a.Commands.Zxb(s):f.ITa.startTransaction(),u=o(f,e),i?a.Commands.$xb(s,e):e[l]=f.ITa.endTransaction()),f.resumePaint(),i&&((c=t.getActiveSheet())&&f!==c&&c.repaint()),u)}function _t(t,e,n){var o;if(n>0){for(o=e+1;o<t.getRowCount();o++)if((n-=t.getRowHeight(o))<=0)return o-e}else if(n<0)for(o=e-1;o>=0;o--)if((n+=t.getRowHeight(o))>=0)return o-e;return 0}function Lt(t,e,n,o){var r,i,a=t.getSheetFromName(e.sheetName);a&&(r=a.options.clipBoardOptions,a.options.clipBoardOptions=o,i=function(){a.options.clipBoardOptions=r},n.execute({cmd:z,sheetName:a.name(),callback:i}))}function Bt(t,e,n,o){return Pt(t,e,n,(function(t){var e,n=function(t){var e,n,o;if(t.slicers){if(!(e=t.slicers.all())||c(e))return null;for(o in n=[],e)e[o].isSelected()&&n.push(e[o]);return n}}(t);if(n&&0!==n.length)for(e in n)n.hasOwnProperty(e)&&n[e].sortState(o)}))}function Gt(t){t.Os(7,mt().hideSheetFailureInfo)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/plugins/contextMenu/context-menu-dialog.js"),i=n("./dist/plugins/contextMenu/menu-view.js"),a=n("Core"),s=n("./dist/plugins/contextMenu/context-menu.ns.js"),l=a.GC$,u=o.Common.j.Fa,c=o.Common.j.za,f=a.Ul.nl,o.Commands.CommandManager,h="gc.spread.contextMenu.",p="gc.spread.",d="gc-spread-",g="viewport",m="colHeader",y="rowHeader",v="slicer",C="sheetTab",b="corner",w="removeSlicer",T="toggleComment",x="deleteComment",S="editComment",A="unhideSheet",I="hideSheet",R="unhideRows",k="unhideColumns",M="hideRows",N="hideColumns",E="sortAscend",D="sortDescend",O="sort",j="filter",F="insertComment",P="deleteSheet",_="insertSheet",L="insertRows",B="insertColumns",G="deleteRows",H="deleteColumns",V="clearContents",z="paste",W="pasteOptions",U="pasteFormatting",q="pasteValues",Y="pasteFormula",X="pasteAll",Z="cut",Q="copy",J="pasteValuesFormatting",$="pasteFormulaFormatting",K="separator",tt="slicerSortAscend",et="slicerSortDescend",nt="tableInsert",ot="tableDelete",rt="tableInsertRowsAbove",it="tableInsertRowsBelow",at="tableInsertColumnsLeft",st="tableInsertColumnsRight",lt="tableDeleteRows",ut="tableDeleteColumns",ct="insertCopiedCells",ft="insertCutCells",ht="shiftCellsDown",pt="shiftCellsRight",dt=void 0,gt=new o.Common.ResourceManager(s.SR),mt=gt.getResource.bind(gt),yt={sheetTab:function(t,e,n){return RegExp("sheetTab","i").test(n.workArea)&&t.tabStripHitInfo&&t.tabStripHitInfo.sheetTab&&"newSheet"!==t.tabStripHitInfo.sheetTab.sheetName},outline:function(t,e,n){return!!(RegExp("outline","i").test(n.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.outlineHitInfo)},viewport:function(t,e,n){if(RegExp("viewport","i").test(n.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.commentHitInfo)return St(e,n)&&Rt(e,n)&&function(t,e){var n,o;return[p+ct].indexOf(e.name)<0||(n=t.getActiveSheet(),(o=n.tu())&&!o.G4&&o.n5&&1===o.n5.length&&1===n.getSelections().length&&kt(n))}(e,n)&&function(t,e){var n,o;return[p+ft].indexOf(e.name)<0||(n=t.getActiveSheet(),(o=n.tu())&&o.G4&&o.n5&&1===o.n5.length&&1===n.getSelections().length&&kt(n))}(e,n)},rowHeader:function(t,e,n){if(RegExp("rowHeader","i").test(n.workArea)&&t.worksheetHitInfo&&2===t.worksheetHitInfo.hitTestType)return function(t,e){var n,o,r,i,a,s,l,u;if([p+y+ct,p+y+ft].indexOf(e.name)<0)return!0;if(n=t.getActiveSheet(),o=n.tu(),r=n.getActiveRowIndex(),n.tables)for(i=n.tables.all(),a=0;a<i.length;a++)if(s=i[a],r>s.cj&&r<s.cj+s.Xj)return!1;for(l=n.ITa.getSpans(),a=0;a<l.length;a++)if(u=l[a],r>u.row&&r<u.row+u.rowCount)return!1;if(!o.UHb||o.n5&&1!==o.n5.length||1!==n.getSelections().length)return!1;if(e.name===p+y+ft){if(o.G4&&o.n5&&n.getColumnCount()%o.n5[0].colCount==0)return!0}else if(e.name===p+y+ct&&!o.G4&&o.n5&&n.getColumnCount()%o.n5[0].colCount==0)return!0;return!1}(e,n)},colHeader:function(t,e,n){if(RegExp("colHeader","i").test(n.workArea)&&t.worksheetHitInfo&&1===t.worksheetHitInfo.hitTestType)return function(t,e){var n,o,r,i,a,s,l,u;if([p+m+ct,p+m+ft].indexOf(e.name)<0)return!0;if(n=t.getActiveSheet(),o=n.tu(),r=n.getActiveColumnIndex(),n.tables)for(i=n.tables.all(),a=0;a<i.length;a++)if(s=i[a],r>s.dj&&r<s.dj+s.OZ)return!1;for(l=n.ITa.getSpans(),a=0;a<l.length;a++)if(u=l[a],r>u.col&&r<u.col+u.colCount)return!1;if(!o.UHb||o.n5&&1!==o.n5.length||1!==n.getSelections().length)return!1;if(e.name===p+m+ct){if(!o.G4&&o.n5&&n.getRowCount()%o.n5[0].rowCount==0)return!0}else if(e.name===p+m+ft&&o.G4&&o.n5&&n.getRowCount()%o.n5[0].rowCount==0)return!0;return!1}(e,n)},corner:function(t,e,n){if(RegExp("corner","i").test(n.workArea)&&t.worksheetHitInfo&&0===t.worksheetHitInfo.hitTestType)return St(e,n)&&Rt(e,n)},slicer:function(t,e,n){return RegExp("slicer","i").test(n.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"Slicer"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},chart:function(t,e,n){return RegExp("chart","i").test(n.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo&&t.worksheetHitInfo.floatingObjectHitInfo.floatingObject&&"2"===t.worksheetHitInfo.floatingObjectHitInfo.floatingObject.typeName},shape:function(t,e,n){return RegExp("shape","i").test(n.workArea)&&t.worksheetHitInfo&&t.worksheetHitInfo.shapeHitInfo},table:function(t,e,n){var o=e.getActiveSheet().tables;return RegExp("table","i").test(n.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&o&&o.mKb()},vpWithoutTb:function(t,e,n){if(RegExp("vpWithoutTb","i").test(n.workArea)&&t.worksheetHitInfo&&3===t.worksheetHitInfo.hitTestType&&!t.worksheetHitInfo.floatingObjectHitInfo&&!t.worksheetHitInfo.shapeHitInfo&&!t.worksheetHitInfo.commentHitInfo){var o=e.getActiveSheet().tables;return!(o&&o.mKb())&&St(e,n)&&Rt(e,n)}}},vt=[],Ct=function(){function t(){this.menuView=new i.MenuView,this.menuData=[{text:mt().copy,name:p+Q,command:h+Q,iconClass:d+Q,workArea:g+m+y+v+b},{text:mt().cut,name:p+Z,command:h+Z,iconClass:d+Z,workArea:g+m+y+v+b},{text:mt().pasteOptions,name:p+W,iconClass:d+W,type:"groupHeader",workArea:g+m+y+v+b},{command:h+X,name:p+X,iconClass:d+X,group:p+W,text:mt().pasteAll,workArea:g+m+y+v+b},{command:h+Y,name:p+Y,iconClass:d+Y,group:p+W,text:mt().pasteFormula,workArea:g+m+y+b},{command:h+q,name:p+q,iconClass:d+q,group:p+W,text:mt().pasteValues,workArea:g+m+y+b},{command:h+U,name:p+U,iconClass:d+U,group:p+W,text:mt().pasteFormatting,workArea:g+m+y+b},{command:h+J,name:p+J,iconClass:d+J,group:p+W,text:mt().pasteValuesFormatting,workArea:g+m+y+b},{command:h+$,name:p+$,iconClass:d+$,group:p+W,text:mt().pasteFormulaFormatting,workArea:g+m+y+b},{type:K},{text:mt().clearContents,command:h+V,name:p+V,workArea:g+m+y+b},{type:K},{text:mt().headerInsertCopiedCells,name:p+y+ct,command:h+y+ct,workArea:y},{text:mt().headerInsertCutCells,name:p+y+ft,command:h+y+ft,workArea:y},{text:mt().headerInsertCopiedCells,name:p+m+ct,command:h+m+ct,workArea:m},{text:mt().headerInsertCutCells,name:p+m+ft,command:h+m+ft,workArea:m},{text:mt().insertCopiedCells,name:p+ct,subMenu:[{text:mt().shiftCellsRight,name:p+ct+pt,command:h+ct+pt,iconClass:d+pt},{text:mt().shiftCellsDown,name:p+ct+ht,command:h+ct+ht,iconClass:d+ht}],workArea:g},{text:mt().insertCutCells,name:p+ft,subMenu:[{text:mt().shiftCellsRight,name:p+ft+pt,command:h+ft+pt,iconClass:d+pt},{text:mt().shiftCellsDown,name:p+ft+ht,command:h+ft+ht,iconClass:d+ht}],workArea:g},{text:mt().insertRows,name:p+L,command:h+L,workArea:y},{text:mt().insertColumns,name:p+B,command:h+B,workArea:m},{text:mt().deleteRows,name:p+G,command:h+G,workArea:y},{text:mt().deleteColumns,name:p+H,command:h+H,workArea:m},{type:K},{text:mt().tableInsert,name:p+nt,subMenu:[{text:mt().tableInsertColumnsLeft,name:p+at,command:"tableInsertColumnsLeftForContextMenu",iconClass:d+at},{text:mt().tableInsertColumnsRight,name:p+st,command:"tableInsertColumnsRightForContextMenu",iconClass:d+st},{text:mt().tableInsertRowsAbove,name:p+rt,command:"tableInsertRowsAboveForContextMenu",iconClass:d+rt},{text:mt().tableInsertRowsBelow,name:p+it,command:"tableInsertRowsBelowForContextMenu",iconClass:d+it}],workArea:"table"},{text:mt().tableDelete,name:p+ot,subMenu:[{text:mt().tableDeleteColumns,name:p+ut,command:"tableDeleteColumnsForContextMenu",iconClass:d+ut},{text:mt().tableDeleteRows,name:p+lt,command:"tableDeleteRowsForContextMenu",iconClass:d+lt}],workArea:"table"},{type:K},{text:mt().insertSheet,name:p+_,command:h+_,workArea:C},{text:mt().deleteSheet,name:p+P,command:h+P,workArea:C},{type:K},{text:mt().filter,name:p+j,command:h+j,workArea:g+b},{text:mt().sort,name:p+O,subMenu:[{text:mt().sortAscend,name:p+E,command:h+E,iconClass:d+E},{text:mt().sortDescend,name:p+D,command:h+D,iconClass:d+D}],workArea:g+b},{text:mt().slicerSortAscend,name:p+tt,command:h+tt,iconClass:d+E,workArea:v},{text:mt().slicerSortDescend,name:p+et,command:h+et,iconClass:d+D,workArea:v},{type:K},{text:mt().insertComment,name:p+F,command:h+F,iconClass:d+F,workArea:g+b},{text:mt().editComment,name:p+S,command:h+S,iconClass:d+S,workArea:g+b},{text:mt().deleteComment,name:p+x,command:h+x,iconClass:d+x,workArea:g+b},{text:mt().toggleComment,name:p+T,command:h+T,workArea:g+b},{type:K},{text:mt().hideRows,name:p+M,command:h+M,workArea:y},{text:mt().unhideRows,name:p+R,command:h+R,workArea:y},{text:mt().hideColumns,name:p+N,command:h+N,workArea:m},{text:mt().unhideColumns,name:p+k,command:h+k,workArea:m},{type:K},{text:mt().hideSheet,name:p+I,command:h+I,workArea:C},{text:mt().unhideSheet,name:p+A,command:h+A,workArea:C},{type:K},{text:mt().removeSlicer,name:p+w,command:h+w,workArea:v}]}return t.prototype.ad=function(t){var e=this;e.Mma||(e.wu=t.commandManager(),u(e.Ela)&&(e.Ela=new r.ContextMenuViewDialog(t.xv(),l(t.sv))),e.nla(t),e.kTa={filter:{menuDataDict:[p+j],checkFunction:function(t){if(t.rowFilter)return!0}},comments:{menuDataDict:[p+F,p+S,p+x,p+T],checkFunction:function(t){if(t.comments)return!0}},slicer:{menuDataDict:[p+tt,p+et,p+w],checkFunction:function(t){if(t.slicers)return!0}},floatingObject:{menuDataDict:[p+q,p+U,p+Y],checkFunction:function(t){var e;return!t.BR||(!((e=t.BR().fromSheet)&&e.CR)||void 0)}},table:{menuDataDict:[p+nt,p+ot],checkFunction:function(t){if(t.tables)return!0}}},e.Mma=!0)},t.prototype.ola=function(t,e){var n,o,r,i,a,s=this;return e.focus(),n=s.pla(t,e),o=e.getActiveSheet(),u(n)||u(o)?void f(t):(r={row:o.getActiveRowIndex(),col:o.getActiveColumnIndex()},void(o.isEditing()&&n.worksheetHitInfo&&n.worksheetHitInfo.col===r.col&&n.worksheetHitInfo.row===r.row||e.getTab()&&e.getTab().FD||(s.ad(e),s.qla(n,e),i=s.Fla(s.menuData,n,e),a=s.onOpenMenu(s.menuData,i,n,e),a||(f(t),i.length&&s.jla(i,n,e)))))},t.prototype.qla=function(t,e){this.Ela.Loa(t)&&this.sla(t,e)},t.prototype.sla=function(t,e){var n=this,o=e.getActiveSheet();o.isEditing()&&o.endEdit(),n.tla(t)?n.ula(t,e):n.vla(t)&&n.wla(t,e)},t.prototype.vla=function(t){return!!t.worksheetHitInfo},t.prototype.xla=function(t,e,n,o){var r,i,a=!0;if(1===o){for(r=0;r<t.length;r++)-1===(i=t[r]).row&&n>=i.col&&n<i.col+i.colCount&&(a=!1);return a}if(2===o){for(r=0;r<t.length;r++)-1===(i=t[r]).col&&e>=i.row&&e<i.row+i.rowCount&&(a=!1);return a}for(r=0;r<t.length;r++)if((i=t[r]).contains(e,n))return!1;return!0},t.prototype.tla=function(t){return!(!t.tabStripHitInfo||!t.tabStripHitInfo.sheetTab)},t.prototype.yla=function(t){return t.tabStripHitInfo.sheetTab.sheetName},t.prototype.wla=function(t,e){var n=e.getActiveSheet(),o=t.worksheetHitInfo;o.floatingObjectHitInfo||o.commentHitInfo||o.shapeHitInfo||(this.Ala(n,o),this.aPa(n))},t.prototype.aPa=function(t){var e,n=t.getActiveRowIndex(),o=t.getActiveColumnIndex(),r=t.comments;r&&((e=r.get(n,o))&&r.bU===e&&r.hT(e))},t.prototype.zla=function(t){return 3===t.hitTestType},t.prototype.cs=function(t,e,n){t.cs&&t.cs(e,n)},t.prototype.Ala=function(t,e){var n=t.ITa.getSelections(),o=e.row,r=e.col;this.xla(n,o,r,e.hitTestType)&&t.Qs(e.rowViewportIndex<0?-1:e.row,e.colViewportIndex<0?-1:e.col)&&(t.mm.Ala(t,e,o,r),t.mm.hH())},t.prototype.ula=function(t,e){var n=this.yla(t),o=e.getSheetIndex(n),r=e.sheets[o];r&&(r.isSelected()||(e.sheets.forEach((function(t){t.isSelected()&&t.DHb(!1,!0)})),e.hq&&e.hq.BHb(e,r,!1,!0,r.name(),o)),e.dq(o,2,!1,!0),this.$Oa(this.menuData,t,e))},t.prototype.pla=function(t,e){var n=e.oia(),o=t.pageX-n.left,r=t.pageY-n.top;return e.hitTest(o,r,!0)},t.prototype.onOpenMenu=function(t,e,n,o){},t.prototype.jla=function(t,e,n){var o=this;o.Ela.Loa(e)&&(o.Cla(),o.Dla(t,e,n))},t.prototype.Cla=function(){this.Ela.close()},t.prototype.Dla=function(t,e,n){this.Ela.OT(this.menuView,t,e.x,e.y,n)},t.prototype.Fla=function(t,e,n){var o=this,r=[],i={};return l.extend(!0,i,t),l.each(i,(function(t,o){u(o)||(o.type===K&&r.push(o),l.each(yt,(function(t,i){i(e,n,o)&&r.push(o)})))})),o.J$a(r,e),o.lTa(r,n),o.oKb(r,n),o.UZa(r,n),o.RZa(r),r=o.Bma(r),o.pKb(r),r},t.prototype.pKb=function(t){var e,n,o=0,r=!1;for(e=0;e<t.length&&((n=t[e].name)!==p+y+ct&&n!==p+y+ft&&n!==p+m+ct&&n!==p+m+ft||(r=!0),n!==p+L&&n!==p+B||(o=e,!r));e++);r&&t.splice(o,1)},t.prototype.J$a=function(t,e){var n=e.worksheetHitInfo;n&&(n.row===dt||n.col===dt)&&t.splice(0,t.length)},t.prototype.lTa=function(t,e){var n=this,o=e.getActiveSheet(),r=n.kTa;return l.each(r,(function(e,r){var i,a,s;if(!r.checkFunction(o))for(a=0,s=(i=r.menuDataDict).length;a<s;a++)n.hma(t,i[a],(function(t,e){t[e]=null}))})),t},t.prototype.oKb=function(t,e){var n,o,r,i=e.getActiveSheet(),a=i.getSelections();a&&a.length>0&&(n=Mt(i,a[0]),o=i.getActiveRowIndex(),r=i.getActiveColumnIndex(),n&&l.each(t,(function(t,e){if(!u(e)&&e.name===p+nt){var i=e.subMenu;n.checkTableLastRow(o)&&i.splice(3,1),n.checkTableLastCol(r)&&i.splice(1,1)}})))},t.prototype.RZa=function(t){var e;for(e=t.length-1;e>0;e--)t[e]?t[e].subMenu&&this.RZa(t[e].subMenu):t.splice(e,1);return t},t.prototype.Bma=function(t){var e,n,o,r,i,a=[],s=t.length;for(e=0;e<s;e++)t[e]&&t[e].type===K&&t[e+1]&&t[e+1].type===K||a.push(t[e]);for(s=a.length,n=0,o=0,r=!0,i=!0,e=0;e<s&&(r&&a[e].type===K?n++:r=!1,i&&a[s-1-e].type===K?o++:i=!1,r||i);e++);return a.splice(s-o,o),a.splice(0,n),a},t.prototype.UZa=function(t,e){this.VZa(t,e),this.QZa(t,e)},t.prototype.VZa=function(t,e){var n,o=e.getActiveSheet(),r=o.tables;for(n=0;n<t.length;n++)if(t[n]){switch(t[n].name){case p+L:o.ZZa()||(t[n].disable=!0);break;case p+G:(!o.ZZa()||r&&r.containTableHeaderTotalRowForSheet())&&(t[n].disable=!0);break;case p+B:case p+H:o.$Za()||(t[n].disable=!0);break;case p+rt:r&&(r.isAcrossTables()||r.containTableHeader()||r.noRoomToInsertRow())&&(t[n].disable=!0);break;case p+it:r&&(r.isAcrossTables()||r.noRoomToInsertRow())&&(t[n].disable=!0);break;case p+lt:r&&(r.checkTableRow()||r.isAcrossTables()||r.containTableHeaderTotalRow())&&(t[n].disable=!0);break;case p+at:case p+st:r&&(r.isAcrossTables()||r.noRoomToInsertColumn())&&(t[n].disable=!0);break;case p+ut:r&&(r.checkTableCol()||r.isAcrossTables()||r.isWholeTableCol())&&(t[n].disable=!0)}t[n]&&t[n].subMenu&&this.VZa(t[n].subMenu,e)}},t.prototype.QZa=function(t,e){var n,o,r,i,a=e.getActiveSheet(),s=a.options.isProtected,l=a.options.protectionOptions;if(s&&l)for(n=void 0,o=0;o<t.length;o++)if(t[o]){switch(t[o].name){case p+L:l.allowInsertRows||(t[o].disable=!0);break;case p+B:l.allowInsertColumns||(t[o].disable=!0);break;case p+G:l.allowDeleteRows||(t[o].disable=!0);break;case p+H:l.allowDeleteColumns||(t[o].disable=!0);break;case p+j:l.allowFilter||(t[o].disable=!0);break;case p+E:case p+D:l.allowSort||(t[o].disable=!0);break;case p+M:case p+R:case p+N:case p+k:t[o].disable=!0;break;case p+tt:case p+et:l.allowEditObjects||t.splice(0,t.length);break;case p+F:l.allowEditObjects||(t[o]=null);break;case p+S:r=void 0,a.comments&&(r=(n=a.comments.get(a.getActiveRowIndex(),a.getActiveColumnIndex()))&&n.lockText()),!l.allowEditObjects&&r&&(t[o]=null);break;case p+x:i=void 0,a.comments&&(i=!At(a.getSelections(),a)),!l.allowEditObjects&&i&&(t[o]=null);break;case p+rt:case p+it:case p+at:case p+st:case p+lt:case p+ut:t[o].disable=!0}t[o]&&t[o].subMenu&&this.QZa(t[o].subMenu,e)}},t.prototype.$Oa=function(t,e,n){var o,r,i;if(e.tabStripHitInfo&&(this,o=n.sheets,r=this.RS(p+A))){for(i=0;i<o.length;i++)if(!o[i].visible())return void(r.disable=!1);r.disable=!0}},t.prototype.RS=function(t){return this.gma(this.menuData,t)},t.prototype.gma=function(t,e){var n;return this.hma(t,e,(function(t,e){n=t[e]})),n},t.prototype.hma=function(t,e,n){for(var o=t.length,r=0;r<o;r++)if(!u(t[r])){if(e===t[r].name)return void n(t,r);t[r].subMenu&&this.hma(t[r].subMenu,e,n)}},t.prototype.nla=function(t){var e,n,o,r,i,s,l,f,p,d,g,v,C,b,O,W,K,nt,ot,rt,it,at,st,lt,ut,gt,mt,yt,Ct,St,At,It,Rt=t.commandManager(),kt={canUndo:!1,execute:function(t,e){var n=t.getSheetFromName(e.sheetName);n&&(bt(n)?Rt.execute({cmd:"copyFloatingObjects",sheetName:n.name()}):Rt.execute({cmd:Q,sheetName:n.name(),ignoreClipboard:!0}))}};Rt.register(h+Q,kt,null,!1,!1,!1,!1),e={canUndo:!1,execute:function(t,e){var n=t.getSheetFromName(e.sheetName);n&&(bt(n)?Rt.execute({cmd:"cutFloatingObjects",sheetName:n.name()}):Rt.execute({cmd:Z,sheetName:n.name(),ignoreClipboard:!0}))}},Rt.register(h+Z,e,null,!1,!1,!1,!1),n={canUndo:!1,execute:function(t,e){var n,o,r=t.getSheetFromName(e.sheetName);r&&(r.isPasteFloatingObject&&r.isPasteFloatingObject()?Rt.execute({cmd:"pasteFloatingObjects",sheetName:r.name()}):r.isPasteShapes&&r.isPasteShapes()?Rt.execute({cmd:"pasteShapes",sheetName:r.name()}):(n=r.options.clipBoardOptions,r.options.clipBoardOptions=0,o=function(){r.options.clipBoardOptions=n},Rt.execute({cmd:z,sheetName:r.name(),callback:o})))}},Rt.register(h+X,n,null,!1,!1,!1,!1),o={canUndo:!1,execute:function(t,e){var n,o,r=t.getSheetFromName(e.sheetName);r&&(n=r.options.clipBoardOptions,r.options.clipBoardOptions=0,o=function(){r.options.clipBoardOptions=n},Rt.execute({cmd:z,sheetName:r.name(),callback:o,shiftCells:a.InsertShiftCell.right}))}},Rt.register(h+ct+pt,o,null,!1,!1,!1,!1),Rt.register(h+ft+pt,o,null,!1,!1,!1,!1),Rt.register(h+m+ct,o,null,!1,!1,!1,!1),Rt.register(h+m+ft,o,null,!1,!1,!1,!1),r={canUndo:!1,execute:function(t,e){var n,o,r=t.getSheetFromName(e.sheetName);r&&(n=r.options.clipBoardOptions,r.options.clipBoardOptions=0,o=function(){r.options.clipBoardOptions=n},Rt.execute({cmd:z,sheetName:r.name(),callback:o,shiftCells:a.InsertShiftCell.down}))}},Rt.register(h+ct+ht,r,null,!1,!1,!1,!1),Rt.register(h+ft+ht,r,null,!1,!1,!1,!1),Rt.register(h+y+ct,r,null,!1,!1,!1,!1),Rt.register(h+y+ft,r,null,!1,!1,!1,!1),i={canUndo:!1,execute:function(t,e){Lt(t,e,Rt,3)}},Rt.register(h+Y,i,null,!1,!1,!1,!1),s={canUndo:!1,execute:function(t,e){Lt(t,e,Rt,1)}},Rt.register(h+q,s,null,!1,!1,!1,!1),l={canUndo:!1,execute:function(t,e){var n,o,r=t.getSheetFromName(e.sheetName);r&&(n=r.options.clipBoardOptions,r.options.clipBoardOptions=2,o=function(){r.options.clipBoardOptions=n},Rt.execute({cmd:z,sheetName:r.name(),callback:o}))}},Rt.register(h+U,l,null,!1,!1,!1,!1),f={canUndo:!1,execute:function(t,e){Lt(t,e,Rt,4)}},Rt.register(h+J,f,null,!1,!1,!1,!1),p={canUndo:!1,execute:function(t,e){Lt(t,e,Rt,5)}},Rt.register(h+$,p,null,!1,!1,!1,!1),d={canUndo:!1,execute:function(t,e){var n=t.getSheetFromName(e.sheetName);n&&Rt.execute({cmd:"clear",sheetName:n.name()})}},Rt.register(h+V,d,null,!1,!1,!1,!1),g={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(e,n){var o,r,i,a,s,l,u,c,f,h,p,d,g=n.commentState||2,m=n.displayMode,y=n.activeRow,v=n.activeCol,C=e.comments.add(y,v,"");C&&(C.commentState(g),m&&C.displayMode(m),o=e.Er(y),r=e.Fr(v),i=e.getCellRect(y,v,o,r),a=e.am().Ft(o,r),s=C.location(),l=C.width(),u=C.height(),c=void 0,f=void 0,h=void 0,p=void 0,d=t.ku,i.y+s.y<a.y?(h=_t(e,y,i.y+s.y-a.y),c=d.ms(e,h),d.ju(c.cj,0),e.os()):i.y+s.y+u>a.y+a.height&&(h=_t(e,y,i.y+s.y+u-(a.y+a.height)),c=d.ms(e,h),d.ju(c.cj,0),e.os()),i.x+s.x+l>a.x+a.width&&(p=function(t,e,n){var o;if(n>0){for(o=e+1;o<t.getColumnCount();o++)if((n-=t.getColumnWidth(o))<=0)return o-e}else if(n<0)for(o=e-1;o>=0;o--)if((n+=t.getColumnWidth(o))>=0)return o-e;return 0}(e,v,i.x+s.x+l-(a.x+a.width)),f=d.Sw(e,p),d.lu(f.dj,0),e.qs()))}),(function(t,e){var n=e.activeRow,o=e.activeCol,r=t.comments.get(n,o);r&&(e.displayMode=r.displayMode(),e.commentState=r.commentState())}))}},Rt.register(h+F,g,null,!1,!1,!1,!1),v={canUndo:!1,execute:function(t,e){var n,o,r,i=t.getSheetFromName(e.sheetName);i&&(n=e.activeRow,o=e.activeCol,(r=i.comments.get(n,o))&&r.commentState(2))}},Rt.register(h+S,v,null,!1,!1,!1,!1),C={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){var n,o,r,i,a,s=e.selections,l=s.length;if(!(l<=0))for(n=0;n<l;n++)for(r=(o=s[n]).row;r<o.row+o.rowCount;r++)for(i=o.col;i<o.col+o.colCount;i++)!(a=t.comments.get(r,i))||t.options.isProtected&&!t.options.protectionOptions.allowEditObjects&&a.locked()||Rt.execute({cmd:x,sheetName:t.name(),row:a.nT,col:a.oT})}))}},Rt.register(h+x,C,null,!1,!1,!1,!1),b={canUndo:!1,execute:function(t,e){var n,o,r,i=t.getSheetFromName(e.sheetName);i&&(n=e.activeRow,o=e.activeCol,(r=i.comments.get(n,o))&&(2===r.displayMode()?r.displayMode(1):r.displayMode(2)))}},Rt.register(h+T,b,null,!1,!1,!1,!1),O={canUndo:!0,execute:function(t,e,n){return e.considerAllSheets=!0,Pt(t,e,n,(function(t){var n,o,r,i,a,s,l,u,c,f,h,p=Et(e.selections);for(o=0;o<p.length;o++){for(n=p[o],r=t.getRange(n.row-1,0,1,n.colCount),i=[],a=0;a<r.colCount;a++)t.getCell(r.row,a).locked()||i.push(a);for(s=n.row,l=n.rowCount,t.addRows(s,l),u=0;u<i.length;u++)for(c=p[o].row;c<p[o].row+p[o].rowCount;c++)t.getCell(c,i[u]).locked(!1);if(t.tables&&l>0)for(f=t.tables.s$(s,-1,l,-1),h=0;h<f.length;h++)f[h].PIb(s,l,!1,!1);Ot(t,s,-1,l)}}))}},Rt.register(h+L,O,null,!1,!1,!1,!1),W={canUndo:!0,execute:function(t,e,n){return e.considerAllSheets=!0,Pt(t,e,n,(function(t){var n,o,r,i,a,s,l,u,c,f,h,p=Dt(e.selections);for(o=0;o<p.length;o++){for(n=p[o],r=t.getRange(0,n.col-1,n.rowCount,1),i=[],a=0;a<r.rowCount;a++)t.getCell(a,r.col).locked()||i.push(a);for(s=n.col,l=n.colCount,t.addColumns(s,l),u=0;u<i.length;u++)for(c=s;c<s+l;c++)t.getCell(i[u],c).locked(!1);if(t.tables&&l>0)for(f=t.tables.s$(-1,s,-1,l),h=0;h<f.length;h++)f[h].QIb(s,l,!1,!1);Ot(t,-1,s,l)}}))}},Rt.register(h+B,W,null,!1,!1,!1,!1),K={canUndo:!0,execute:function(t,e,n){return e.considerAllSheets=!0,Pt(t,e,n,(function(t){var n,o,r,i,a,s,l,u,c=Et(e.selections),f=t.filterRowsVisibleInfo&&t.filterRowsVisibleInfo.rowsVisibleInfo,h=f&&Object.keys(f).length>0;for(n=0;n<c.length;n++)if(r=(o=c[n]).row,i=o.rowCount,a=t.getRowCount(),h)for(l=(s=Tt(o,f)).length-1;l>=0;l--)r=s[l][0],i=s[l][1],u=t.tables&&t.tables.s$(r,-1,i,-1),t.deleteRows(r,i),u.length>0&&a-t.getRowCount()>0&&(a=t.getRowCount(),Nt(0,u,r,i));else u=t.tables&&t.tables.s$(r,-1,i,-1),t.deleteRows(r,i),u.length>0&&a-t.getRowCount()>0&&Nt(0,u,r,i)}))}},Rt.register(h+G,K,null,!1,!1,!1,!1),nt={canUndo:!0,execute:function(t,e,n){return e.considerAllSheets=!0,Pt(t,e,n,(function(t){var n,o,r,i,a,s,l=Dt(e.selections);for(n=0;n<l.length;n++)if(o=t.getColumnCount(),r=l[n].col,i=l[n].colCount,a=void 0,t.tables&&(a=t.tables.s$(-1,r,-1,i)),t.deleteColumns(r,i),t.tables&&o-t.getColumnCount()>0)for(s=0;s<a.length;s++)a[s].QIb(r,i,!0)}))}},Rt.register(h+H,nt,null,!1,!1,!1,!1),ot={canUndo:!1,execute:function(e){var n,o,r=e.getActiveSheetIndex(),i=[],s=e.getActiveSheet(),l=e.vv(e.wv(r));e.sheets.forEach((function(t){t.DHb()&&i.push(t)})),i.forEach((function(t){t.DHb(!1,!0)})),n={sheetName:l.name(),propertyName:"insertSheet",cancel:!1,sheetIndex:r},e.Wq(a.Events.SheetChanging,n),n.cancel||(e.ow(r,2,l),o=l.name(),e.hq&&e.hq.BHb(t,l,!1,!0,o,e.getSheetIndex(o)),e.Wq(a.Events.SheetChanged,{sheetName:l.name(),propertyName:"insertSheet",sheetIndex:r}),e.Wq(a.Events.ActiveSheetChanged,{oldSheet:s,newSheet:l}))}},Rt.register(h+_,ot,null,!1,!1,!1,!1),rt={canUndo:!1,execute:function(e){var n,o,r,i,s=e.getActiveSheet();e.getSheetCount()>1?(n=[],o=[],e.sheets.forEach((function(t,e){if(t.DHb()){var r=t.name();n.push(r),o.push(e)}})),n.length!==e.sheets.length?n.length>=1&&(n.forEach((function(t,n){var r,i=o[n],s=e.getSheetFromName(t),l={sheetName:t,propertyName:"deleteSheet",cancel:!1,sheetIndex:i};e.Wq(a.Events.SheetChanging,l),l.cancel||(e.removeSheet(e.getSheetIndex(t)),e.Wq(a.Events.SheetChanged,{sheetName:t,propertyName:"deleteSheet",sheetIndex:i}),s===(r=e.getActiveSheet())&&e.Wq(a.Events.ActiveSheetChanged,{oldSheet:s,newSheet:r}))})),i=(r=e.getActiveSheet()).name(),r.isSelected()||e.hq&&e.hq.BHb(t,r,!1,!0,i,e.getSheetIndex(i))):Gt(s)):Gt(s),e.undoManager().clear()}},Rt.register(h+P,rt,null,!1,!1,!1,!1),it={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){var n,o=e.selections[0],r=Mt(t,o),i=e.activeRow,a=e.activeCol;r?r.range().contains(i,a,1,1)&&(n=r.name(),Rt.execute({cmd:"contextmenuFilterForTable",sheetName:t.name(),cmdOption:{tableName:n,activeRow:i,activeCol:a,expectedText:t.getText(i,a)}})):t.rowFilter&&Rt.execute({cmd:"contextmenuFilterForSheet",sheetName:t.name(),cmdOption:{activeRow:i,activeCol:a,selection:o,expectedText:t.getText(i,a)}})}))}},Rt.register(h+j,it,null,!1,!1,!1,!1),at={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){var n=e.activeCol,o=e.selections,r=Mt(t,o[0]),i=r?r.dataRange():o[0],s=t.oec(i,!0,null),l={sheet:t,sheetName:t.name(),col:n,ascending:!0,range:i,compareFunction:dt,groupSort:s.groupSort,ignoreHidden:s.ignoreHidden,cancel:!1};t.Wq(a.Events.RangeSorting,l),!1===l.cancel&&(t.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:n,ascending:!0,compareFunction:l.compareFunction}],{groupSort:l.groupSort,ignoreHidden:l.ignoreHidden},dt,!!r),t.Wq(a.Events.RangeSorted,l))}))}},Rt.register(h+E,at,null,!1,!1,!1,!1),st={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){var n=e.activeCol,o=e.selections,r=Mt(t,o[0]),i=r?r.dataRange():o[0],s=t.oec(i,!0,null),l={sheet:t,sheetName:t.name(),col:n,ascending:!1,range:i,compareFunction:dt,groupSort:s.groupSort,ignoreHidden:s.ignoreHidden,cancel:!1};t.Wq(a.Events.RangeSorting,l),!1===l.cancel&&(t.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[{index:n,ascending:!1,compareFunction:l.compareFunction}],{groupSort:l.groupSort,ignoreHidden:l.ignoreHidden},dt,!!r),t.Wq(a.Events.RangeSorted,l))}))}},Rt.register(h+D,st,null,!1,!1,!1,!1),lt={canUndo:!0,execute:function(t,e,n){return Bt(t,e,n,1)}},Rt.register(h+tt,lt,null,!1,!1,!1,!1),ut={canUndo:!0,execute:function(t,e,n){return Bt(t,e,n,2)}},Rt.register(h+et,ut,null,!1,!1,!1,!1),gt={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){wt(e.selections,"row",(function(e){t.setRowVisible(e,!1)}))}))}},Rt.register(h+M,gt,null,!1,!1,!1,!1),mt={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){wt(e.selections,"col",(function(e){t.setColumnVisible(e,!1)}))}))}},Rt.register(h+N,mt,null,!1,!1,!1,!1),yt={canUndo:!1,execute:function(t){var e,n,o,r,i,s,l,u,c,f,h,p,d,g=0;if(t.sheets.forEach((function(t){t.visible()&&(g+=1)})),e=t.getActiveSheet(),g<=1)Gt(e);else{if(o=[],t.sheets.forEach((function(t){t.DHb()&&o.push(t)})),g!==o.length){for(r=0;r<o.length;r++)u={sheetName:s=(i=o[r]).name(),propertyName:"isVisible",cancel:!1,sheetIndex:l=t.getSheetIndex(s),oldValue:!0,newValue:!1},t.Wq(a.Events.SheetChanging,u),u.cancel||(i.DHb(!1,!0),vt.push(i),i.visible(!1),c=t.getActiveSheet(),r!==o.length-1||c.isSelected()||(n={oldValue:!1,newValue:!0,sheetName:f=c.name(),propertyName:"isSelected",cancel:!1,sheetIndex:t.getSheetIndex(f)},t.Wq(a.Events.SheetChanging,n)),t.Wq(a.Events.SheetChanged,{sheetName:s,propertyName:"isVisible",sheetIndex:l,oldValue:!0,newValue:!1}));p=(h=t.getActiveSheet()).name(),n&&(n.cancel?h.ITa.CHb(!1):(h.ITa.CHb(!0),t&&t.hq&&t.hq.repaint(),d={oldValue:!1,newValue:!0,sheetName:p,propertyName:"isSelected",sheetIndex:t.getSheetIndex(p)},t.Wq(a.Events.SheetChanged,d))),e===h&&t.Wq(a.Events.ActiveSheetChanged,{oldSheet:e,newSheet:h})}else Gt(e);t.undoManager().clear()}}},Rt.register(h+I,yt,null,!1,!1,!1,!1),Ct={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){var n=e.selections,o=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;u(o)&&(o=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=xt(t,n[0])),1===n.length&&o?(t.setRowVisible(n[0].row-1,!0),t.mq(n[0].row-1)):wt(n,"row",(function(e){t.setRowVisible(e,!0),e===t._t()&&(t.lq=0,t.os())}))}))}},Rt.register(h+R,Ct,null,!1,!1,!1,!1),St={canUndo:!0,execute:function(t,e,n){return Pt(t,e,n,(function(t){var n=e.selections,o=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol;u(o)&&(o=e.isAnyHiddenRowOrColBeforeFirstVisibleRowOrCol=xt(t,n[0])),1===n.length&&o?(t.setColumnVisible(n[0].col-1,!0),t.rq(n[0].col-1)):wt(n,"col",(function(e){t.setColumnVisible(e,!0),e===t.$t()&&(t.qq=0,t.qs())}))}))}},Rt.register(h+k,St,null,!1,!1,!1,!1),At={canUndo:!1,execute:function(t){var e,n,o,r,i,s,l,u;if(0===vt.length)for(e=t.sheets,n=0;n<e.length;n++)e[n].visible()||(vt.push(e[n]),e[n].DHb(!1));if(o=t.getActiveSheet(),vt.length>0){if(t.sheets.forEach((function(t){t.DHb(!1,!0)})),s={sheetName:i=(r=vt.pop()).name(),propertyName:"isVisible",cancel:!1,sheetIndex:t.getSheetIndex(i),oldValue:!1,newValue:!0},t.Wq(a.Events.SheetChanging,s),s.cancel)return;r.visible(!0),l={oldValue:!1,newValue:!0,sheetName:i,propertyName:"isSelected",cancel:!1,sheetIndex:t.getSheetIndex(i)},t.Wq(a.Events.SheetChanging,l),t.setActiveSheet(r.name()),l.cancel?r.ITa.CHb(!1):(r.ITa.CHb(!0),t&&t.hq&&t.hq.repaint(),u={oldValue:!1,newValue:!0,sheetName:i,propertyName:"isSelected",sheetIndex:t.getSheetIndex(i)},t.Wq(a.Events.SheetChanged,u)),t.Wq(a.Events.SheetChanged,{sheetName:i,propertyName:"isVisible",sheetIndex:t.getSheetIndex(i),oldValue:!1,newValue:!0})}t.getActiveSheet()&&(t.focus(!0),t.Wq(a.Events.ActiveSheetChanged,{oldSheet:o,newSheet:t.getActiveSheet()}))}},Rt.register(h+A,At,null,!1,!1,!1,!1),It={canUndo:!1,execute:function(t,e){var n,o,r,i=t.getSheetFromName(e.sheetName);if(i&&(t.suspendPaint(),n=[],(o=i.slicers.all())&&!c(o))){for(r in o)o[r].isSelected()&&n.push(o[r].name());n.length>0&&Rt.execute({cmd:"deleteFloatingObjects",sheetName:i.name(),floatingObjects:n}),t.resumePaint()}}},Rt.register(h+w,It,null,!1,!1,!1,!1)},t}(),e.ContextMenu=Ct,a.Workbook.$n("contextmenu",{setHost:function(){var t=this,e=t.qo;t.contextMenu||(t.contextMenu=new Ct),l(e).bind("contextmenu.gcSheet",(function(e){if(t.options.allowContextMenu)return t.contextMenu.ola(e,t)}))},dispose:function(){l(this.qo).unbind("contextmenu.gcSheet")},onCultureChanged:function(){var t,e=mt(),n=this.contextMenu;n&&(t=n.menuData,l.each(e,(function(e,o){n.hma(t,p+e,(function(t,e){t[e].text=o}))})))}})},"./dist/plugins/contextMenu/context-menu.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/contextMenu/context-menu.res.en.js");e.SR={en:o}},"./dist/plugins/contextMenu/context-menu.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.copy="Copy",e.cut="Cut",e.pasteOptions="Paste Options:",e.pasteAll="All",e.pasteFormula="Formulas",e.pasteValues="Values",e.pasteFormatting="Formatting",e.pasteValuesFormatting="Values&Formatting",e.pasteFormulaFormatting="Formula&Formatting",e.clearContents="Clear Contents",e.insertRows="Insert",e.insertColumns="Insert",e.deleteRows="Delete",e.deleteColumns="Delete",e.insertSheet="Insert",e.deleteSheet="Delete",e.insertComment="Insert Comment",e.filter="Filter",e.sort="Sort",e.insertCopiedCells="Insert Copied Cells...",e.insertCutCells="Insert Cut Cells...",e.shiftCellsRight="Shift Cells Right",e.shiftCellsDown="Shift Cells Down",e.headerInsertCopiedCells="Insert Copied Cells",e.headerInsertCutCells="Insert Cut Cells",e.slicerSortAscend="Sort A to Z",e.slicerSortDescend="Sort Z to A",e.sortAscend="Sort A to Z",e.sortDescend="Sort Z to A",e.hideRows="Hide",e.hideColumns="Hide",e.hideSheet="Hide",e.unhideSheet="Unhide",e.unhideColumns="Unhide",e.unhideRows="Unhide",e.editComment="Edit Comment",e.deleteComment="Delete Comment",e.toggleComment="Show/Hide Comment",e.removeSlicer="Remove",e.removeFloatingObject="Remove",e.tableInsert="Insert",e.tableInsertRowsAbove="Table Rows Above",e.tableInsertRowsBelow="Table Row Below",e.tableInsertColumnsLeft="Table Columns to the Left",e.tableInsertColumnsRight="Table Columns to the Right",e.tableDelete="Delete",e.tableDeleteRows="Table Rows",e.tableDeleteColumns="Table Columns",e.hideSheetFailureInfo="A workbook must contain at least one visible worksheet.\nTo hide, delete or move the selected sheet(s), you must first insert a new sheet or unhide a sheet that is already hidden."},"./dist/plugins/contextMenu/menu-view.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=r.GC$,a=r.Ul.Nl,s=o.Common.j,l=s.Fa,u=s.Aa,c=s.C4,f=void 0,h=document,d=(p={qKb:"mouseenter",rKb:"mouseleave",sKb:"click",tKb:"gc.command.executed",uKb:".",vKb:"gc-ui-contextmenu",wKb:"-",xKb:"container",yKb:"hover",zKb:"disable-hover",AKb:"text",BKb:"icon",CKb:"menuitem",DKb:"nonselective-menuitem",EKb:"menuitem-content",FKb:"sup-container",GKb:"separator",HKb:"sup-indicator",IKb:"subitems-container",JKb:"group-container",KKb:"title",LKb:"group-header",MKb:"groupitems-container",NKb:"groupitem",OKb:"nonexecutable",PKb:"executable",QKb:"disable",RKb:"gc-statusbar-contextmenu",SKb:" ui-widget",TKb:" ui-state-hover",UKb:" ui-icon ui-icon-triangle-1-e",VKb:"DIV",WKb:"SPAN",XKb:"keydown.ctx.gcSheet",YKb:"none",ZKb:"inline-block",$Kb:"visible",_Kb:"hidden"}).vKb+p.wKb+p.yKb,g=p.vKb+p.wKb+p.CKb,m=p.vKb+p.wKb+p.DKb,y=p.vKb+p.wKb+p.EKb,v=p.vKb+p.wKb+p.PKb,C=p.vKb+p.wKb+p.FKb,b=p.vKb+p.wKb+p.IKb,w=p.RKb+p.wKb+"check",T=p.RKb+p.wKb+"check-container",x=p.RKb+p.wKb+"content",S=p.RKb+p.wKb+"status",A=function(){function t(){}return t.prototype.ai=function(t,e,n,o){var r=this;r.qo=i(t),r.lla=c(e),r.wu=n.commandManager(),r.xc=n,r.Eu=o,r.LQ=[],r.YPa={},r.rQa=[],r.ZPa=null,r.lma()},t.prototype.mma=function(){var t,e,n,o,r,a,s,u=this,c=parseInt(u.qo.css("left"),10),f=parseInt(u.qo.css("top"),10),d=u.qo.width(),g=u.qo.height(),m=i(u.xc.getHost()),y=m.width(),v=u.hostInfo;l(v)?(o=m.height(),c+d>y&&(c=c-d>0?c-d:c,u.qo.css("left",c)),f+g>o&&(f>g?f-=g:o>=g?f=o-g:(r=u.qo.css("display"),u.qo.css("display",p.YKb),(a=h.documentElement.scrollHeight)-(s=m.offset().top)>f+g||a>g&&(f=o+(a-s-o)-g),u.qo.css("display",r)),u.qo.css("top",f))):(t=v.top,e=v.width,n=v.height,c+d>e&&(c=c-d>0?c-d:c,u.qo.css("left",c)),window.innerHeight-t-n<t&&(f-=g,u.qo.css("top",f)))},t.prototype.lma=function(){var t,e,n,o=this,r=o.lla;l(r)||!function(t){if(t instanceof Object)return!0}(r)||r.length<1||(r instanceof Array||(r=[r]),t="menuView",e=o.nma(t,r),o.YPa.menuView=e,(n=o.oma(o.lla)).appendTo(o.qo),o.mma(),o.QQ(),o.rQa.push({name:t,menuView:n}))},t.prototype.nma=function(t,e){for(var n,o=this,r=e.length,i=0,a=[];i<r;i++)n=e[i],l(n)||"separator"===n.type||(n.subMenu?o.YPa[n.name]=o.nma(n.name,n.subMenu):"groupHeader"===n.type&&(o.pma(n,e),o.YPa[n.name]=o.nma(t,n.groups)),a.push(o.qma(t,n)));return a},t.prototype.qma=function(t,e){var n,o,r,a=this;if(n="groupHeader"===e.type?a.$Pa():a.rma(),o=a.createMenuItemElement(e),!l(o))return o instanceof HTMLElement&&(o=i(o)),o.appendTo(n),r={name:e.name,host:n,menuItemData:e,menuName:t},a.LQ.push(r),r},t.prototype.rma=function(){var t=i(a(p.VKb));return t.addClass(g),t},t.prototype.$Pa=function(){var t=i(a(p.VKb));return t.addClass(m),t},t.prototype.createMenuItemElement=function(t){var e=this,n=t.type;return"groupHeader"===n?e.tma(t):"groupItem"===n?e.uma(t):"statusBar"===n?e.Eyb(t):t.subMenu?e.vma(t):e.wma(t)},t.prototype.wma=function(t){var e,n,o=i(a(p.VKb)).addClass(y);return t.command?t.disable?o.addClass(p.vKb+p.wKb+p.QKb):o.addClass(v):o.addClass(p.vKb+p.wKb+p.OKb),e=i(a(p.WKb)).addClass(p.vKb+p.wKb+p.BKb),t.iconClass&&e.addClass(t.iconClass),e.appendTo(o),t.text&&((n=i(a(p.WKb)).addClass(p.vKb+p.wKb+p.AKb))[0].innerHTML=t.text,n.appendTo(o)),o},t.prototype.sma=function(t){return i(a(p.VKb)).addClass(p.vKb+p.wKb+p.GKb)},t.prototype.tma=function(t){var e,n,o,r,s,l,u=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.JKb);if(t.groups.length<=0)return u;for((e=this.wma(t)).addClass(p.vKb+p.wKb+p.LKb),e.appendTo(u),n=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.MKb),r=(o=t.groups).length,s=0;s<r;s++)(l=this.xma("name",o[s].name).host).addClass(p.vKb+p.wKb+p.NKb),l.appendTo(n);return n.appendTo(u),u},t.prototype.uma=function(t){var e=this.wma(t);return e.find(p.uKb+p.vKb+p.wKb+p.AKb).remove(),e.attr(p.KKb,t.text),e},t.prototype.Eyb=function(t){var e,n,o,r=a("div"),s=i(r).addClass(y),l=t.visible,u=t.menuContent,c=t.status,f=a("div");return i(f).addClass(w),e=a("div"),i(e).addClass(T),e.appendChild(f),e.style.visibility=l?p.$Kb:p._Kb,(n=a("div")).innerText=u,i(n).addClass(x),o=a("div"),i(o).addClass(S),c?(o.innerText=c,o.style.display=p.ZKb):o.style.display=p.YKb,r.appendChild(e),r.appendChild(n),r.appendChild(o),s},t.prototype.vma=function(t){var e,n=i(a(p.VKb)).addClass(C),o=this.wma(t);return t.subMenu.length>0&&(i(a(p.WKb)).addClass(p.vKb+p.wKb+p.HKb+p.UKb).appendTo(o),(e=this.oma(t.subMenu)).addClass(b),e.appendTo(n)),o.appendTo(n),n},t.prototype.oma=function(t){for(var e,n,o,r=this,s=i(a(p.VKb)).addClass(p.vKb+p.wKb+p.xKb+p.SKb),u=t.length,c=0;c<u;c++)l(t[c])||(e=t[c].name,l(e)?"separator"===t[c].type&&(o=r.$Pa(),r.sma(t[c]).appendTo(o),o.appendTo(s)):(n=r.xma("name",e),l(n)||n.host.appendTo(s)));return s},t.prototype.xma=function(t,e){for(var n=this.LQ,o=n.length,r=0;r<o;r++)if(e instanceof i?e[0]===n[r][t][0]:n[r][t]===e)return n[r]},t.prototype.pma=function(t,e){var n,o,r;for(t.groups=[],n=e.length,o=0;o<n;o++)(r=e[o])&&r.group&&r.group===t.name&&(r.type="groupItem",t.groups.push(r),e.splice(o,1),o--)},t.prototype.QQ=function(){var t=this;i(p.uKb+g).bind(p.qKb,(function(){var e,n,o=i(this),r=t.xma("host",o);for(t.ZPa=r,e=0,n=t.rQa.length;e<n&&r.menuName!==t.rQa[n-e-1].name;e++)t.Ooa();t._Pa(),t.cQa(!1)})).bind(p.rKb,(function(){t.ZPa=null,t._Pa()})).bind(p.sKb,(function(e){var n=i(this),o=t.xma("host",n);t.ZPa=o,t.aQa(!1,e)&&t.WT()})),i(h).bind(p.XKb,(function(e){var n,o;switch(e.keyCode){case 27:t.Ooa()||t.WT();break;case 32:case 13:t.aQa(!0,e)&&t.WT();break;case 9:e.shiftKey?t.bQa(!1,!0):t.bQa(!0,!0);break;case 37:n=t.Ooa(),(o=t.xma("name",n))&&(t.ZPa=o),t.ZPa&&t.ZPa.menuItemData.group&&t.bQa(!1,!0);break;case 38:t.bQa(!1,!1);break;case 39:t.ZPa&&t.ZPa.menuItemData.group&&t.bQa(!0,!0),t.cQa(!0);break;case 40:t.bQa(!0,!1)}e.preventDefault?e.preventDefault():e.returnValue=!1}))},t.prototype.Noa=function(t){var e,n,o,r,i=t.offset().left,a=t.width();i+a>(window.scrollX||window.pageXOffset)+window.innerWidth&&t.css("left",-a),e=t.offset().top,n=t.height(),o=t.position().top,e+n>(r=window.scrollY||window.pageYOffset)+window.innerHeight&&t.css("top",o-(e+n-(r+window.innerHeight)))},t.prototype.zma=function(t){return t.command},t.prototype.getCommandOptions=function(t,e,n){},t.prototype.aQa=function(t,e){var n,o=this,r=o.ZPa;if(r&&!r.menuItemData.disable)return(n=r.menuItemData).subMenu?void(n.subMenu.length>0&&o.cQa(t)):(o.h4(e),!0)},t.prototype.h4=function(t){var e,n,o,r,i,a,s=this,c=s.ZPa,f=s.zma(c.menuItemData);l(f)||(e=s.getCommandOptions(c.menuItemData,c.host[0],t),n=s.wu,u(f)?f(s.xc,e):(r=(o=s.xc.getActiveSheet()).getActiveColumnIndex(),i=o.getActiveRowIndex(),a=o.tables.find(i,r),n.execute({cmd:f,sheetName:o.name(),selections:o.getSelections(),activeRow:i,activeCol:r,commandOptions:e,tableName:a?a.name():""})))},t.prototype.Tla=function(){i(p.uKb+g).unbind(p.qKb).unbind(p.rKb).unbind(p.sKb),i(h).unbind(p.XKb)},t.prototype.no=function(){var t=this;t.qo=null,t.lla=null,t.wu=null,t.xc=null,t.Eu=null,t.LQ=null,t.YPa=null,t.ZPa=null,t.Tla()},t.prototype.Ooa=function(){var t;if(this.rQa.length>1)return(t=this.rQa.pop()).menuView.find(p.uKb+g).removeClass(d+p.TKb),t.menuView.hide(),t.name},t.prototype._Pa=function(){var t,e,n=this,o=n.dQa(!0);if(o){for(t=0,e=o.length;t<e;t++)o[t].host.removeClass(d+p.TKb);n.ZPa&&(n.ZPa.menuItemData.disable?n.ZPa.host.addClass(p.vKb+p.wKb+p.zKb+p.TKb):n.ZPa.host.addClass(d+p.TKb))}},t.prototype.WT=function(){this.Eu.trigger(p.tKb),this.no()},t.prototype.bQa=function(t,e){var n,o,r,i=this,a=i.dQa(e);i.ZPa&&((n=i.eQa(i.ZPa,a))||(o=i.YPa[i.ZPa.menuItemData.group])&&(r=o[0],n=i.eQa(r,a))),t?(n!==f&&n!==a.length-1||(n=-1),n="number"==typeof n?n+1:0):(n!==f&&0!==n||(n=a.length),n="number"==typeof n?n-1:0),i.ZPa=a[n],i._Pa()},t.prototype.dQa=function(t){for(var e,n,o,r=this,i=r.rQa[r.rQa.length-1].name,a=r.YPa[i],s=0,l=a.length,u=[];s<l;s++)if("groupHeader"!==a[s].menuItemData.type)u.push(a[s]);else if(e=r.YPa[a[s].menuItemData.name],t)for(n=0,o=e.length;n<o;n++)u.push(e[n]);else u.push(e[0]);return u},t.prototype.eQa=function(t,e){var n,o=e.length;for(n=0;n<o;n++)if(t.name===e[n].name)return n},t.prototype.cQa=function(t){var e,n,o=this,r=o.ZPa;r&&((e=r.menuItemData).subMenu&&e.subMenu.length>0&&(e.name!==o.rQa[o.rQa.length-1].name&&((n=i(r.host.find(p.uKb+b)[0])).show(),o.Noa(n),o.rQa.push({name:e.name,menuView:n})),o.ZPa=null,t&&o.bQa(!0,!1)))},t}(),e.MenuView=A},"./dist/plugins/data/binding.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b;function w(t,e){var n=t&&t.wq;return!(!n||!n.xL(e)||(t.clearPendingChanges(),o.Worksheet.ao(t,"initBinding",{sheet:t,data:e}),0))}function T(t,e,n){var o,r,i,a,s,l,u,f,h,p=t,m=p.Ou,y={value:c,hasBinding:!1};if(!m)return y;if(o=p.kj,(r=p.CL)===g){if(s=o?o.getBindingPath(e,n):c)return{value:m.getValue(s),hasBinding:!0}}else{if(e<0||t.getRowCount()<=e)return y;if(l=o?o.getColumnCount():t.getColumnCount(),n<0||l<=n)return y;if(o?(p.qia||(p.qia=o.ITa.Hp(!1,3)),(i=p.qia[n])&&(a=i.name)):t.HL&&(p.qia?(i=p.qia[n])&&(a=i.dataField):a=t.HL[n]),r)return u=d[r],h=A(f=i&&i.value)?f:c,u.getValue(m,h,a,e,n)}return y}function x(t,e){return t&&e&&e!==g?d[e].getProperties(t):c}function S(t){return v&&t instanceof v}function A(t){return t instanceof Function}function I(t,e,n){var o,r,i,a,s;if(t&&e){if(o=t[e],!u(o))return void(A(o)?t[e](n):t[e]=n);for(i=(r=e.split(".")).length,a=0;a<i&&(s=r[a],t);a++)a===i-1?A(t[s])?t[s](n):t[s]=n:A(t[s])?(u(t[s]())&&t[s]({}),t=t[s]()):(u(t[s])&&(t[s]={}),t=t[s])}}function R(t,e,n){var o,r,i,a,s;if(!t||!e)return c;if(o=t[e],!u(o))return A(o)?o():o;r=null,n?(r=n[e])||(r=e.split("."),n[e]=r):r=e.split("."),i=r.length,a=0;do{if(t=A(t[s=r[a]])?t[s]():t[s],u(t))return c;++a}while(a<i);return t}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=r.GC$,a=n("Common"),s=n("./dist/plugins/data/data.ns.js"),l=i.isNumeric,u=a.Common.j.Fa,c=null,f=void 0,h="string",e.yL=p,d=e.yL=p={},g="cellBinding",m=new a.Common.ResourceManager(s.SR),y=m.getResource.bind(m),v=function(){function t(t){this.xf=t}return t.prototype.setValue=function(t,e){I(this.xf,t,e)},t.prototype.getValue=function(t){return R(this.xf,t)},t.prototype.getSource=function(){return this.xf},t}(),e.CellBindingSource=v,C=function(){function t(t){this.ad(t)}return t.prototype.bind=function(t,e){var n,o,r,a,s=this,l=s.kj,u=s.Ou;if(e&&s.tUa(e,{type:"bind",oldDataSource:u}),u&&(u.lka&&(u.subscribe=u.lka,delete u.mka,delete u.lka),A(u.dispose)&&u.dispose()),s.zL(s.AL),s.zL(s.BL),s.ad(l),s.Ou=t,t){if(!(n=s.CL=function(t){var e=c;return t&&(S(t)?e=g:i.each(d,(function(n,o){if(o.isDataSource(t))return e=n,!1}))),e}(t)))throw Error(y().Exp_NotSupportedDataSource);s.DL=s.EL(),l&&i[i.sd]({tc:l.parent}),l&&(o=s.AL,r=t.currentPosition,t.subscribe&&o.push(t.subscribe(s.FL,s)),r&&r.subscribe&&o.push(r.subscribe(s.GL,s)),A(t.subscribe)&&!t.lka&&(a=t.lka=t.subscribe,t.mka=!1,t.subscribe=function(e,n){var o=[].concat.apply([],arguments),r=function(){if(!t.mka&&A(e))return e.apply(n,arguments)};return o[0]=r,a.apply(t,o)}),s.Lx()),s.HL=x(t,n)}return w(l,t)},t.prototype.Lx=function(){var t,e,n,o,r,i=this,a=i.kj,s=i.Ou;if(a&&s&&(t=i.CL,i.zL(i.BL),e=c,t!==g&&(n=a.getActiveRowIndex(),s.currentPosition?(-1<=n&&n<s.count()&&s.currentPosition(n),e=s.currentItem()):e=i.ru(n)),e))for(r in o=function(){a&&a.repaint()},e)e[r]&&A(e[r].subscribe)&&i.BL.push(e[r].subscribe(o,c,c))},t.prototype.zL=function(t){var e,n;if(t)for(e=0;e<t.length;e++)(n=t[e])&&A(n.dispose)&&n.dispose()},t.prototype.getRowCount=function(){var t=this.Ou,e=this.CL,n=0;return t&&e&&e!==g&&(n=d[e].getDataLength(t)),n},t.prototype.getColumnCount=function(){var t,e,n,o=this.HL;return o?o.length:(t=this.Ou)&&(e=t[0],"null"===(n=i.getType(e))||n===h||"number"===n)?1:0},t.prototype.getSource=function(){return this.Ou},t.prototype.rL=function(){return this.HL},t.prototype.Nka=function(t){this.HL=t},t.prototype.ru=function(t){var e=this.Ou,n=this.CL,o=c;return e&&n&&n!==g&&(o=d[n].getDataItem(e,t)),o},t.prototype.EL=function(){var t,e,n,o=this;if(!o.DL)for(t=o.getRowCount(),e=0;e<t;e++)if(n=o.ru(e)){o.DL=n.entityAspect&&n.entityType||n.constructor;break}return o.DL},t.prototype.getValue=function(t,e){return T(this,t,e)},t.prototype.setValue=function(t,e,n,o){var r,i=this;return o&&(r=T(i,t,e).value,i.tUa(o,{type:"setValue",row:t,col:e,oldValue:r})),function(t,e,n,o){var r,i,a,s,l,u,f,h,p,m=t,y=m.Ou,v=!1;if(!y)return v;if(r=m.kj,(i=m.CL)===g)(l=r?r.getBindingPath(e,n):c)&&(y.setValue(l,o),v=!0);else{if(e<0||t.getRowCount()<=e)return v;if(u=r?r.getColumnCount():t.getColumnCount(),n<0||u<=n)return v;r?(m.qia||(m.qia=r.ITa.Hp(!1,3)),(a=m.qia[n])&&(s=a.name)):t.HL&&(m.qia?(a=m.qia[n])&&(s=a.dataField):s=t.HL[n]),i&&(f=d[i],h=a&&a.value,p=A(h)?h:c,v=f.setValue(y,p,s,e,n,o))}return v}(i,t,e,n)},t.prototype.sL=function(){var t=d[this.CL];return t&&t.canAdd&&t.canAdd()},t.prototype.tL=function(){var t=d[this.CL];return t&&t.canInsert&&t.canInsert()},t.prototype.vL=function(){var t=d[this.CL];return t&&t.canRemove&&t.canRemove()},t.prototype.uL=function(t,e,n){var o,r,i=this,a=i.Ou;!a||t>i.getRowCount()||(o=i.CL,r=i.EL(),o&&o!==g&&!i.IL&&(i.JL=!0,n&&i.tUa(n,{type:"addItems",row:t,rowCount:e}),d[o].addItems(a,t,e,r),i.JL=!1))},t.prototype.wL=function(t,e,n){var o,r=this,i=r.CL,a=r.getRowCount(),s=r.Ou;!s||t>=a||i&&i!==g&&!r.IL&&(r.JL=!0,o=d[i].removeItems(s,t,e),n&&o&&o.length>0&&r.tUa(n,{type:"removeItems",row:t,removedItems:o}),r.JL=!1)},t.prototype.uUa=function(t,e){var n=this.Ou,o=this.CL;d[o].undoRemoveItems(n,t,e)},t.prototype.xL=function(t){return S(t||this.Ou)},t.prototype.ad=function(t){var e=this;e.Ou=c,e.CL="",e.DL=c,e.HL=c,e.AL=[],e.BL=[],e.qia=c,e.kj=t,function(t){var e=t&&t.wq;e&&e.xL()&&o.Worksheet.ao(t,"resetBinding",{sheet:t})}(t)},t.prototype.FL=function(t){var e,n,o,r,i=this,a=i.kj;if(a&&!i.JL){if(t){if(i.IL=!0,!isNaN(t.length)&&(a.setRowCountCore(t.length),e=a.ITa,u(i.HL)&&0===e.VTa(!1,3)&&(i.HL=x(i.Ou),a.setColumnCount(i.getColumnCount()),n=i.rL())))for(o=0,r=n.length;o<r;o++)e.do("setItem",!1,3,o,{name:n[o]});i.IL=!1}a.$p()}},t.prototype.GL=function(){var t,e=this.kj,n=this.Ou;e&&n&&n.currentPosition&&(t=n.currentPosition(),e.Jl!==t&&(e.Sr(t,e.Kl,f,f,2),e.$p()))},t.prototype.tUa=function(t,e){if(!(this.kj&&this.kj.ITa&&!u(this.kj.ITa.WTa)&&this.kj.ITa.WTa<=0)){var n=t.rUa;n||(n=t.rUa=[]),e.bindingManager=this,n.push(e)}},t.prototype.sUa=function(t){var e=this,n=t.type,o=t.row;"bind"===n?e.bind(t.oldDataSource):"setValue"===n?e.setValue(o,t.col,t.oldValue):"addItems"===n?e.wL(o,t.rowCount):"removeItems"===n&&e.uUa(o,t.removedItems)},t.prototype.toJSON=function(){var t,e=this.Ou;return e?{type:t=this.CL,source:e=t===g?e.getSource():d[t].toJSON(e)}:c},t.prototype.fromJSON=function(t){var e,n,o=t&&t.source;o&&(void 0,(n=(e=t.type)===g?new v(o):d[e].fromJSON(o))&&this.bind(n))},t}(),e.qL=C,e.setValueByPath=I,e.LL=R,b=function(){function t(){this.pathCache={}}return t.prototype.isDataSource=function(t){return i.isArray(t)},t.prototype.getDataLength=function(t){return t.length},t.prototype.getDataItem=function(t,e){return t[e]},t.prototype.addItems=function(t,e,n,o){var r,i;for(r=0;r<n;r++)i={},o&&(i=o.createEntity?o.createEntity():new o),t.splice(e,0,i)},t.prototype.removeItems=function(t,e,n){var o=this.getDataLength(t);if(e<o)return t.splice(e,Math.min(n,o-e))},t.prototype.undoRemoveItems=function(t,e,n){for(var o=0,r=n.length;o<r;o++)t.splice(e+o,0,n[o])},t.prototype.getProperties=function(t){var e,n,o=t.length,r=c;if(o>0)for(n in r=[],e=t[0])A(e[n])||r.push(n);return r},t.prototype.getValue=function(t,e,n,o,r){var i=c,a=!1,s=this.getDataItem(t,o);return u(s)||(e?(i=e(s),a=!0):n?(i=R(s,n,this.pathCache),a=!0):(typeof s===h||l(s))&&0===r&&(i=s,a=!0)),{value:i,hasBinding:a}},t.prototype.setValue=function(t,e,n,o,r,i){var a=!1,s=this.getDataItem(t,o);return u(s)||(e?(e(s,i),a=!0):n?(I(s,n,i),a=!0):(typeof s===h||l(s))&&0===r&&(t[o]=i,a=!0)),a},t.prototype.fromJSON=function(t){return t},t.prototype.toJSON=function(t){return t},t}(),d.defaultBindingSource=new b},"./dist/plugins/data/data.dataview.js":function(t,e,n){"use strict";var o,r,i,a;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/plugins/data/binding.js"),e.yL=r.yL,i=o.Common.j.Fa,a=function(){function t(){}return t.prototype.isDataSource=function(t){var e=window.wijmo;return e&&e.data&&e.data.isDataView&&e.data.isDataView(t)},t.prototype.getDataLength=function(t){return t.count()},t.prototype.getDataItem=function(t,e){return t.item(e)},t.prototype.addItems=function(t,e,n,o){if(o)for(var r=0;r<n;r++)t.mka=!0,t.add(o.createEntity?o.createEntity():new o),t.mka=!1,t.commitEdit()},t.prototype.removeItems=function(t,e,n){var o,r,i,a,s=this.getDataLength(t);if(e<s){for(o=[],r=Math.min(n,s-e),i=0;i<r;i++)a=t.item(e),t.remove(a),o.push(a);return o}},t.prototype.undoRemoveItems=function(t,e,n){var o,r,i=t.getSource();for(o=0,r=n.length;o<r;o++)i.splice(e+o,0,n[o]);t.refresh()},t.prototype.getProperties=function(t){var e,n=0,o=null,r=t.getProperties();if(r&&r.length>0)for(n=r.length,o=[],e=0;e<n;e++)o.push(r[e].name);return o},t.prototype.canInsert=function(){return!1},t.prototype.getValue=function(t,e,n,o,r){var a=null,s=!1,l=this.getDataItem(t,o);return i(l)||(e?(a=e(l),s=!0):n&&(a=t.getProperty(l,n),s=!0)),{value:a,hasBinding:s}},t.prototype.setValue=function(t,e,n,o,r,a){var s=!1,l=this.getDataItem(t,o);return i(l)||(e?(e(l,a),s=!0):n&&(t.setProperty(l,n,a),s=!0)),s},t.prototype.fromJSON=function(t){return t},t.prototype.toJSON=function(t){return t.local},t}(),r.yL.dataViewBinding=new a},"./dist/plugins/data/data.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n("./dist/plugins/data/worksheet-databind.js");var r=n("./dist/plugins/data/binding.js");e.CellBindingSource=r.CellBindingSource,e.qL=r.qL,e.setValueByPath=r.setValueByPath,e.LL=r.LL,o(n("./dist/plugins/data/data.ko.js")),o(n("./dist/plugins/data/data.dataview.js")),o(n("./dist/plugins/data/data.ns.js"))},"./dist/plugins/data/data.ko.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/data/binding.js"),e.yL=i.yL,a=r.Common.j.Fa,s=o.GC$,l=s.isFunction,u=s.getType,c=s.isNumeric,f="string",h=window.ko,p=function(){function t(){}return t.prototype.isDataSource=function(t){return h&&h.isObservable(t)},t.prototype.getDataLength=function(t){return t().length},t.prototype.getDataItem=function(t,e){return t()[e]},t.prototype.addItems=function(t,e,n,o){var r,i;for(r=0;r<n;r++)i={},o&&(i=o.createEntity?o.createEntity():new o),t.splice(e,0,i)},t.prototype.removeItems=function(t,e,n){var o=this.getDataLength(t);if(e<o)return t.splice(e,Math.min(n,o-e))},t.prototype.undoRemoveItems=function(t,e,n){for(var o=0,r=n.length;o<r;o++)t.splice(e+o,0,n[o])},t.prototype.getProperties=function(t){var e,n,o=t(),r=[];if(o.length>0)for(n in e=o[0])l(e[n])?h&&h.isObservable(e[n])&&r.push(n):r.push(n);return r},t.prototype.getValue=function(t,e,n,o,r){var s=null,l=!1,h=this.getDataItem(t,o);return a(h)||(e?(s=e(h),l=!0):n?(s=i.LL(h,n),l=!0):(u(h)===f||c(h))&&0===r&&(s=h,l=!0)),{value:s,hasBinding:l}},t.prototype.setValue=function(t,e,n,o,r,s){var l=!1,h=this.getDataItem(t,o);return a(h)||(e?(e(h,s),l=!0):n?(i.setValueByPath(h,n,s),l=!0):(u(h)===f||c(h))&&0===r&&(t()[o]=s,l=!0)),l},t.prototype.fromJSON=function(t){return h?h.observableArray(t):null},t.prototype.toJSON=function(t){return t()},t}(),i.yL.koBinding=new p,h&&((d=h.bindingHandlers)["gc-spread-sheets"]=d["gcspread-sheets"]=d.wijspread={init:function(t,e,n,r){var i,a,l,u,c,h,p,d,g,m,y,v;if(!s(t).data("workbook")&&(a=(i=e())&&i.sheets,l=new o.Workbook(s("#"+t.id)[0],i),a)){for(u=void 0,c=void 0,h=a.length,p=l.getSheetCount();p<h;)u=l.vv(l.wv(p)),l.ow(p,0,u),p=l.getSheetCount();for(d=0;d<h;d++)u=l.getSheet(d),g=(c=a[d]).name,m=c.autoGenerateColumns,y=c.data,v=c.columns,typeof g===f&&g.length>0&&u.cq(g),"boolean"==typeof m&&(u.autoGenerateColumns=m),y&&u.setDataSource(y),v&&v.length>0&&(u.autoGenerateColumns=!1,u.bindColumns(v))}},update:function(t,e,n,o){}})},"./dist/plugins/data/data.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/data/data.res.en.js");e.SR={en:o}},"./dist/plugins/data/data.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_NotSupportedDataSource="The data source is not supported!"},"./dist/plugins/data/worksheet-databind.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;function g(t,e,n){"string"==typeof n&&(n={name:n}),t.ITa.do("setItem",!1,3,e,n);var o=n&&n.formatter,r=n&&n.cellType;o&&t.setFormatter&&t.setFormatter(-1,e,o),r&&t.setCellType(-1,e,r),n&&n.width&&t.setColumnWidth(e,n.width)}function m(t,e,n,o){var r,i,s,l,u=t.wq;for(r=0;r<n;r++)for(i=0;i<o;i++)s=u.getValue(r,i).value,a(s)||(l=s,p.Ska(s)&&(l=p.Daa(s)),t.qI(e,r,i,l))}function y(t,e,n,o){var r,i,s,l,u,c=t.options.colHeaderAutoTextIndex;for(r=0;r<n;r++)if(c>=0&&r===c||-1===c&&r===n-1)for(i=0;i<o;i++)s=e[r]&&e[r][i]&&e[r][i].value,l=t.ITa.Jp(!1,3,i),a(s)&&l&&((u=l.displayName||l.name)&&t.qI(e,r,i,u))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/data/binding.js"),a=r.Common.j.Fa,s=o.GC$.isEmptyObject,l=o.GC$.extend,u=o.Worksheet.prototype,c=null,f="bindingPath",h=RegExp("^\\d*(\\.\\d+)?\\*$"),p=r.Common.l,d={getDataSource:function(){var t=this.wq;return t?t.getSource():c},setDataSource:function(t,e){var n,o,r,a,s,l=this,u=l.wq;if(u&&u.getSource()!==t){if(e&&l.vs(),t){if((u=l.wq).aLb=!0,!u.bind(t,l.ITa.zTa)&&(l.setRowCountCore(u.getRowCount()),l.autoGenerateColumns&&(l.setColumnCount(u.getColumnCount()),n=u.rL())))for(o=0,r=n.length;o<r;o++)l.ITa.do("setItem",!1,3,o,{name:n[o]})}else l.wq=new i.qL(l);l.clearPendingChanges(),a=!1,u&&u.aLb&&(a=u.bLb,delete u.bLb,delete u.aLb),l.recalcAll&&l.recalcAll(a),(s=l.tu())&&s.PA===l&&s.hZ(),l.$p()}},bindColumn:function(t,e){var n=this;n.suspendPaint();try{g(n,t,e)}finally{n.resumePaint()}},bindColumns:function(t){var e,n,o,r,i=this;i.suspendPaint();try{if(t)for(e=t.length,isNaN(e)||i.setColumnCount(e),n=0;n<e;n++)r=(o=t[n]).size,h.test(r)&&(o.starSize=r),g(i,n,o)}finally{i.resumePaint()}},getDataItem:function(t){var e,n,o,r,i,s,l=this,u=l.wq;if(!u||0===u.getRowCount())return c;if(e=l.getColumnCount(),n={},o=u.ru(t))for(r in o)o.hasOwnProperty(r)&&"function"!=typeof r&&(n[r]=o[r]);for(i=0;i<e;i++)(s=l.ITa.Jp(!1,3,i))&&s.name&&s.name.length>0&&a(n[s.name])&&(n[s.name]=l.getValue(t,i));return n},getDataColumnName:function(t){var e,n=this;return 0<=t&&t<n.getColumnCount()&&n.getDataSource()?(e=n.ITa.Jp(!1,3,t))&&(e.displayName||e.name):c},getBindingPath:function(t,e){return this.ITa.getValueForKey(t,e,f)},setBindingPath:function(t,e,n){var o=this;return o.ITa.do("setValueForKey",t,e,f,n),o.$p(),o}},l(u,d),o.CellRange.prototype.bindingPath=o.CellRange.Pl(u.getBindingPath,u.setBindingPath),o.Worksheet.$n("binding",{init:function(){var t=this;t.autoGenerateColumns=!0,t.wq=new i.qL(t)},dispose:function(t){!1!==t.clearCache&&(this.wq=c)},onLayoutChanged:function(t){var e,n,o,r,i,a=this,s=t.changeType,l=t.row,u=t.rowCount,f=t.sheetArea,h=a.wq;if("addingRows"===s)h&&!1===h.sL()?t.canAdd=!1:h&&!1===h.tL()&&(t.newRow=a.getRowCount());else if("addRows"===s)h&&h.uL(l,u,a.ITa.zTa);else if("deletingRows"===s){if(h)if(!1===h.vL())t.canDelete=!1;else for(a.Ts||(a.Ts=[]),e=a.Ts,n=a.ITa,o=h.getRowCount(),r=0;r<u&&l+r<n.getRowCount();r++)i=c,l+r<o&&(i=h.ru(l+r)),e.push({row:l+r,data:i})}else"deleteRows"===s?h&&h.wL(l,u,a.ITa.zTa):"settingRowCount"===s&&(!h.getSource()||h.xL()||3!==f&&2!==f||(t.canSet=!1))},toJson:function(t,e){var n,o,r=this,i=r.getColumnCount(),a=r.getDataSource();e&&e.includeBindingSource&&a&&(m(r,n=t.data.dataTable||{},r.getRowCount(),i),s(n)||(t.data.dataTable=n),y(r,o=t.colHeaderData.dataTable||{},r.getRowCount(1),i),s(o)||(t.colHeaderData.dataTable=o)),!0!==r.autoGenerateColumns&&(t.autoGenerateColumns=r.autoGenerateColumns)},fromJson:function(t,e){var n,o,r,s,l=this;l.wq=new i.qL(l),e&&(n=l.wq,o=t.dataSource,r=t.dataBinding,o&&n.bind(o),r&&n.fromJSON(r,e)),s=t.autoGenerateColumns,a(s)||(l.autoGenerateColumns=s)},preFromJson:function(){this.wq=new i.qL(this)}}),o.lUa.$n("binding",{priority:6e3,getValue:function(t){var e,n=t.row,o=t.col,r=t.sheetArea,i=this.kj.wq;3===r&&i&&i.Ou&&(e=i.getValue(n,o),t.isValueGet=e.hasBinding,t.value=e.value)},setValue:function(t){var e,n,o,r=t.row,i=t.col,a=t.value,s=t.sheetArea,l=this.kj,u=l.wq;3===s&&u&&u.Ou&&((e=u.getValue(r,i)).hasBinding&&(a!==(n=e.value)&&(l.isDirtySuspended()||(o=l.getDataItem(r),this.Cp(r,i,{Dp:o,Ep:n},s)),u.setValue(r,i,a,l.ITa.zTa)),t.isValueSet=!0))},undo:function(t){var e,n,o=t.rUa;if(o)for(e=o.length-1;e>=0;e--)(n=o[e]).bindingManager.sUa(n)}})},"./dist/plugins/dragMerge/dragMerge-action.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function c(t,e){return t.Tq(e)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),e.Commands=o.Commands,r=o.Commands.ActionBase,i=o.Commands.h4,a="dragMerge",s=Math.max,l=function(t){function e(e,n){return t.call(this,e,n)||this}return u(e,t),e.prototype.canExecute=function(){var t,e=this.kj,n=this.VQ,o=c(e,n.oldSelection),r=c(e,n.newSelection);if(o.equals(r)){if((t=e.getSpan(o.row,o.col))&&o.equals(t))return!1;if(1===o.rowCount&&1===o.colCount)return!1}return!0},e.prototype.canUndo=function(){var t=o.Commands.bWa(this.kj.name()),e=this.VQ[t];return o.Commands.cWa(e)},e.prototype.undo=function(){var t,e,n=this;return!!n.canUndo()&&(t=n.kj,n.Lz(t,!0),e=o.Commands.bWa(t.name()),t.ITa.undo(n.VQ[e]),void n.Mz(t,!0))},e.prototype.execute=function(){var t,e,n,r,i=this,a=i.kj,l=i.VQ,u=l.oldSelection,c=l.newSelection;return!!i.canExecute()&&(a.ITa.startTransaction(),i.Lz(a,!0),a.ITa.do("clearSpan",u.row,u.col,u.rowCount,u.colCount),t=c.row,e=c.col,n=c.rowCount,r=c.colCount,a.addSpan(t,e,n,r),a.setSelection(t,e,s(n,1),s(r,1)),i.Mz(a,!0),void(l[o.Commands.bWa(a.name())]=a.ITa.endTransaction()))},e}(r),o.Commands[a]={canUndo:!0,execute:function(t,e,n){return i(t,l,e,n)}},o.Commands.dja=function(t){t.register(a,o.Commands[a])}},"./dist/plugins/dragMerge/dragMerge-event.js":function(t,e,n){"use strict";var o,r,i,a,s;function l(t,e){t.Wq(o.Events.DragMerging,e)}function u(t,e){t.Wq(o.Events.DragMerged,e)}Object.defineProperty(e,"__esModule",{value:!0}),r=(o=n("Core")).GC$,i=void 0,a=Math.abs,s=o.kf,r.extend(o.iI.prototype,{gka:function(t){var e=t,n=this.kj.ITa.findSpan(t.row,t.col);return n&&n.containsRange(t)&&(e=n),e},Yia:function(t,e,n){var o,r,i,s,l,u=this.kj,c=u.parent,f=u.Ix(),h=u.yl;if(c&&c.options.allowUserDragMerge&&f&&!u.CH&&h.Xja){if(r=(o=h.Xja).x,i=o.y,s=o.width,l=o.height,a(r+s-e)<=2&&a(i+l/2-n)<=4)return{right:!0};if(a(r+s/2-e)<=4&&a(i+l-n)<=2)return{bottom:!0}}return null},Zia:function(t){var e,n,o,r,i,a,s,l,u=this;return u.eG=!0,u.OG=!0,u.$ia=!0,u.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},u.fja=t.dragMergeInfo,n=(e=u.kj).ITa,o=e.Ix(),u.ika=u.gka(o),i=(r=e.Tq(u.ika)).row,a=r.col,s=r.rowCount,l=r.colCount,n.qu(i,a,s,l)?(u.OG=!1,void(u.$ia=!1)):(u._ja=e.ITa.getSpans(r),e.suspendPaint(),n.do("clearSpan",i,a,s,l),e.resumePaint(),u.aka=r,u.bka(),u.jka(r),void u.qG())},_ia:function(){var t,e,n,o,r,i,a,s,l=this,u=l.kj,c=u.parent;return c&&!c.options.allowUserDragMerge?void l.aja():(t=l.fH(),e=l.gH(),n=l.aka||l.ika,o=u.Tq(n),void(t>=0&&e>=0&&(r=l.fja,i=l.qja(o,t,e,r),l.kka=i,a=i.rowCount,s=i.colCount,a>0&&s>0&&(l.bka(),l.jka(i),l.aka=i,l.NG()))))},bka:function(){var t,e=this.kj,n=this.aka;n&&((t=e.cm(n)).x-=2,t.y-=2,t.width+=4,t.height+=4,e.yl.dm(t))},qja:function(t,e,n,o){var r,i,a,l,u,c,f,h,p=this.kj,d=t.row,g=t.col,m=t.rowCount,y=t.colCount;return o.right?(i=g,l=n-g+1,u=r=d,c=g+y,f=a=m,h=n-g-y+1):o.bottom&&(r=d,a=e-d+1,u=d+m,c=i=g,f=e-d-m+1,h=l=y),p.ITa.MTa(u,c,f,h)&&(r=d,i=g,a=m,l=y),s(r,i,a,l)},aja:function(){var t,e,n,o=this,r=o.kj,a=r.parent,s=o._ja,c=o.ika,f=o.kka||c;o.eG=!1,o.OG=!1,o.$ia=!1,o.kka=i,o._ja=i,o.aka=i,o.ika=i,o.RG(),a&&a.options.allowUserDragMerge&&(t=r.ITa,r.suspendPaint(),s.length>0&&s.forEach((function(e){t.do("addSpan",e)})),r.resumePaint(),e={sheetName:r.name(),sheet:r,mergeRange:f,cancel:!1},l(r,e),e.cancel||(n={cmd:"dragMerge",sheetName:r.name(),oldSelection:c,newSelection:f},r.wu().execute(n),u(r,{sheetName:r.name(),sheet:r,mergeRange:f})))},jka:function(t){var e=this.kj.yl;(0,e.hka)(e,t)}})},"./dist/plugins/dragMerge/dragMerge.entry.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n("./dist/plugins/dragMerge/dragMerge-action.js"),n("./dist/plugins/dragMerge/dragMerge.js"),n("./dist/plugins/dragMerge/dragMerge-event.js")},"./dist/plugins/dragMerge/dragMerge.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u;function c(t){var e=t.parent;return e&&e.options.backColor||"white"}function f(t,e,n){var r=t.am(),i=function(t,e,n){var o,r,i,a,s=t.Er(n.row);if((1===s||s!==t.Er(n.row+n.rowCount-1))&&(o=t.jt(1)).length>0){if(r=e.y+e.height/2,i=o[0],a=o[o.length-1],i.y<=r&&r<=i.y+i.height)return 1;if(a.y<=r&&r<=a.y+a.height)return 1}}(t,e,n),a=function(t,e,n){var o,r,i,a,s=t.Fr(n.col);if((1===s||s!==t.Fr(n.col+n.colCount-1))&&(o=t.it(1)).length>0){if(r=e.x+e.width/2,i=o[0],a=o[o.length-1],i.x<=r&&r<=i.x+i.width)return 1;if(a.x<=r&&r<=a.x+a.width)return 1}}(t,e,n);return 1===i&&1===a?r.Ft(i,a):1===i?new o.Rect(r.kt,r.qt,r.hs+r.er+r.js,r.jr):1===a?new o.Rect(r.pt,r.nt,r.er,r.fs+r.jr+r.gs):new o.Rect(r.kt,r.nt,r.hs+r.er+r.js,r.fs+r.jr+r.gs)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/dragMerge/dragMerge-action.js"),a=r.Common.pc,s=o.GC$,s.extend(o.oJ.prototype,{cja:function(t,e){var n,r,i,a,s,l,u,c,h,p,d,g,m,y=this,v=y.kj,C=v.mm;o.needPaintSelection(v)&&(4,8,2,4,r=(n=v.cm(C.gka(e))).x,i=n.y,l=r+(a=n.width)-2,u=i+(s=n.height)/2-4,c=4,h=8,d=f(v,p=new o.Rect(l,u,c,h),e),l=r+a/2-4,u=i+s-2,c=8,h=4,m=f(v,g=new o.Rect(l,u,c,h),e),y.Xja=n,y.Wja(t,p,g,d,m))},Wja:function(t,e,n,r,i){var a=this.kj,s=o.Rm.Om(a,a.getSelectionBorderColor());t.save(),t.fillStyle=s,r&&(t.rect(r.x,r.y,r.width,r.height),t.clip()),t.beginPath(),t.rect(e.x,e.y,e.width,e.height),t.fill(),t.restore(),t.save(),t.fillStyle=s,i&&(t.rect(i.x,i.y,i.width,i.height),t.clip()),t.beginPath(),t.rect(n.x,n.y,n.width,n.height),t.fill(),t.restore()},hka:function(t,e){var n,r,i,s,l,u,f,h,p,d,g,m,y=t,v=y.kj,C=v.parent,b=v.mm,w=t.bm();C&&C.options.allowUserDragMerge&&b.$ia&&(n=v.getActiveRowIndex(),r=v.getActiveColumnIndex(),s=(i=v.getActualStyle(n,r))&&i.backColor,l=c(v),(u=a.ec(o.Rm.Om(v,s||l))).a*=.6/255,w.fillStyle=a.bc(u),w.strokeStyle=o.Rm.Om(v,v.getSelectionBorderColor()),w.lineWidth=2,w.beginPath(),f=C.Vv,p=(h=v.cm(e)).x,d=h.y,g=h.width,m=h.height,f>2007?(w.rect(p,d,g-1,m-1),w.strokeRect(p-1,d-1,g+1,m+1)):(w.rect(p+1,d+1,g-2-.5,m-2-.5),w.strokeRect(p-.5,d-.5,g,m)),w.fill(),w.restore(),y.cja(w,e))}}),l={init:function(){i.Commands.dja(this.commandManager())}},o.Workbook.$n("dragMerge",l),u={paintAdornment:function(t){var e,n=t.ctx,o=this,r=o.yl,i=o.ITa.getSelections();o.parent&&o.parent.options.allowUserDragMerge&&1===i.length&&!o.CH&&(e=o.Ix(),r.cja(n,e))}},o.Worksheet.$n("dragMerge",u)},"./dist/plugins/fill/drag-fill.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function F(t){return t.rowCount}function P(t){return t.colCount}function _(t,e){return t.getRowCount(e)}function L(t,e){return t.getColumnCount(e)}function B(t,e,n,o,r){var i,a,s=t.getSelections();t.Tr(),t.addSelection(e,n,o,r),t.Au(s),i=e>0?e:t.ar(),a=n>0?n:t.$q(),t.Kr(i,a,t.Nr,t.Pr)}function G(t){var e=t.parent.getActiveSheet();e&&t!==e&&e.repaint()}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("./dist/plugins/fill/fill.js"),a=n("./dist/plugins/fill/fill.ns.js"),s=n("@grapecity/js-calc"),l=!!s,u=o.Common.j.Fa,c=null,f=void 0,h=r.kf,p=r.GC$,d=Math.max,g=Math.floor,m=r.Commands.ActionBase,y=r.Commands.xy,v=r.Commands.Bu,C=2047,b="startRange",w="fillRange",T="autoFillType",x="fillDirection",S="cancel",A="fill",I="dragDrop",R=p.isEmptyObject,k=new o.Common.ResourceManager(a.SR),M=k.getResource.bind(k),N={fillAuto:function(t,e,n){if(!e)throw Error(M().Exp_RangeIsNull);var r=this,a=n.fillType,s=n.series,l=n.direction,f=n.step,h=n.stop,p=new i.z$(r);if(function(t,e,n,o){return!!(t&&e&&e.containsRange(t))&&(!u(n)&&(1===n&&t.row===e.row&&F(t)===F(e)||0===n&&t.col===e.col&&P(t)===P(e))||!(u(o)||(2!==o&&3!==o||t.col!==e.col||P(t)!==P(e))&&(0!==o&&1!==o||t.row!==e.row||F(t)!==F(e))))}(t,e,l?c:s,l)){r.suspendPaint(),t&&(r.mm.A$=t);try{4===a?p.B$(e,s,!1,n.withTag,n.withoutStyle):0===a?p.C$(e,l):1===a||2===a?p.D$(1===a,e,s,f,h):3===a&&p.E$(e,s,3,f,u(h)?c:o.Common.l.Ra(h),n.unit)}finally{r.resumePaint()}}}},p.extend(r.Worksheet.prototype,N),r.Worksheet.$n(A,{init:function(){this.Fyb=new i.Gyb(this)},setHost:function(t){if(t){var e=this.wu();e[A]||e.register(A,r.Commands[A]),e[I]||e.register(I,r.Commands[I])}},dispose:function(t){if(!1!==t.clearCache){var e=this;e.Fyb&&(e.Fyb.no(),e.Fyb=c)}}}),E=function(t){function e(e,n){var o=t.call(this)||this,i=o,a=n[x],s=0===a,l=s||1===a,u=n[w],c=n[b],f=c.row,p=c.col,d=F(c),g=P(c);return i.kj=e,i.G$=n,4===n[T]?i.H$=new r.Commands.OA(e,{ranges:[n[w]]}):i.I$=l?h(f,s?u.col:p,d,g+P(u)):h(2===a?u.row:f,p,d+F(u),g),i.J$=l?1:0,o}return j(e,t),e.prototype.canExecute=function(){var t=this.kj,e=this.G$,n=e[b],o=e[w];return!(!t.Y3(o.row,o.col,F(o),P(o))||4!==e[T]&&o.intersect(n.row,n.col,F(n),P(n)))},e.prototype.execute=function(){var t,e,n,o,i,a=this;if(a.canExecute()){e=(t=a.G$)[w],(n=a.kj).ITa.startTransaction(),a.Lz(n,!0);try{l&&n.suspendCalcService(),o=n.getSelections(),n.isDirtySuspended()||(a.N$=new y(n,t[w],C)),4===t[T]?a.K$(n):a.L$(n),n.yu(o,n.getSelections())&&n.Au(o)}finally{a.Mz(n,!0),t[r.Commands.bWa(n.name())]=n.ITa.endTransaction(),l&&n.resumeCalcService(!1),n.t4&&n.t4(e.row,e.col,F(e),P(e)),i=[],n.isDirtySuspended()||(a.M$=new y(n,e,C),a.M$.uy(a.N$.sy()),i=a.M$.wy()),v(n,e.row,e.col,F(e),P(e),i,1)}}},e.prototype.K$=function(t){var e,n,o,r,i,a,s,l,u,c=this;c.H$.execute(t),n=(e=c.G$)[b],o=e[w],r=0===c.J$,a=F(n),s=P(n),l=r?d(1,a-F(o)):a,u=r?s:d(1,s-P(o)),n.equals(o)||(i=h(n.row,n.col,l,u),t.Kr(d(t.ar(),i.row),d(t.$q(),i.col),t.Nr,t.Pr),t.Tr(),t.addSelection(i.row,i.col,F(i),P(i)))},e.prototype.L$=function(t){var e,n,o,r=this,i=r.kj,a=r.G$[b],s=r.G$[w],l=r.G$[T],u=r.I$,c={fillType:4,series:r.J$,withTag:!0};try{i.tables&&i.tables.fIb(u)}catch(t){return i.Os(6,t.message),void i.resumePaint()}if(1===l){if(i.fillAuto(a,u,c),i.ITa.MTa(a.row,a.col,a.rowCount,a.colCount))for(e=0;e<s.rowCount;e++)for(n=0;n<s.colCount;n++)(o=i.Aj(a.row+g(e%a.rowCount),a.col+g(n%a.colCount)))&&o.clone&&(o=o.clone()),i.Nq(s.row+e,s.col+n,o)}else 0===l?(2043,r.O$(a,s,2043)):2===l?r.O$(a,s,192):3===l&&(!(1!==F(a)||1!==P(a)||-1===a.row&&-1!==a.col||-1===a.col&&-1!==a.row)?(187,r.O$(a,s,187)):(c.withoutStyle=!0,i.fillAuto(a,u,c)));i.Kr(d(t.ar(),u.row),d(t.$q(),u.col),t.Nr,t.Pr),t.Tr&&t.Tr(),i.addSelection(u.row,u.col,F(u),P(u))},e.prototype.O$=function(t,e,n){var o,r,i,a,s,l=this,u=l.kj,c=u.Tq(t),f=u.Tq(e),h=c.row,p=c.col,d=F(c),m=P(c),y=f.row,v=f.col,C=F(f),b=P(f),w=l.G$[x],T=3===w,S=1===w,A=g(C/d),I=C%d,R=g(b/m),k=b%m;if(0===l.J$){for(o=0;o<A;o++)a=T?y+o*d:y+C-(o+1)*d,u.ax(h,p,a,v,d,m,n,!0);0!==I&&(r=T?h:h+(A+1)*d-C,a=T?y+d*A:y+C-A*d-I,u.ax(r,p,a,v,I,m,n,!0))}else{for(o=0;o<R;o++)s=S?v+o*m:v+b-(o+1)*m,u.ax(h,p,y,s,d,m,n,!0);0!==k&&(i=S?p:p+(R+1)*m-b,s=S?v+m*R:v+b-R*m-k,u.ax(h,i,y,s,d,k,n,!0))}},e.prototype.undo=function(){var t,e,n,o,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{l&&i.suspendCalcService(),t=i.getSelections(),e=r.G$,n=i.NF,o=e[w],a=4===e[T]?r.S$(i):r.T$(i),!i.U$&&n&&n.close(),v(i,o.row,o.col,F(o),P(o),r.M$?r.M$.wy():[],1,f,!0),i.yu(t,i.getSelections())&&i.Au(t)}finally{r.Mz(i,!0),l&&i.resumeCalcService(!1)}}return a},e.prototype.S$=function(t){var e=this.G$[b],n=e.row,o=e.col,i=r.Commands.bWa(t.name());return t.ITa.undo(this.G$[i]),t.Kr(d(t.ar(),n),d(t.$q(),o),t.Nr,t.Pr),!0},e.prototype.T$=function(t){var e,n=this.G$,o=n[b],i=o.row,a=o.col;l&&t.suspendCalcService();try{e=r.Commands.bWa(t.name()),t.ITa.undo(n[e]),t.Kr(d(t.ar(),i),d(t.$q(),a),t.Nr,t.Pr)}finally{l&&t.resumeCalcService(!1)}return t.invalidateLayout(),!0},e}(m),D=function(t){function e(e,n){var o=t.call(this)||this,r=o;return r.kj=e,r.i4=n,r.W$=n[b],r.X$=n[w],r.Y$=n[T],r.Z$=n[x],o}return j(e,t),e.prototype.execute=function(){var t,e,n,o,i,a,s=this,l=!1;if(s.canExecute()){t=s.kj,e=s.X$,t.ITa.startTransaction(),s.oUa(),s.Lz(t,!0),t.vxb=!0;try{n=t.getSelections(),o=t.mm,(i={sheet:t,sheetName:t.name()})[S]=!1,i[w]=e,i[T]=s.Y$,i[x]=s.Z$,t.Wq(r.Events.DragFillBlock,i),o.$$=i[T],o._$=i[S],s.a_(i),delete i[S],t.Wq(r.Events.DragFillBlockCompleted,i),l=!0,t.yu(n,t.getSelections())&&t.Au(n)}finally{s.Mz(t,!0),t.vxb=!1,s.IVa(t,e),a=r.Commands.bWa(t.name()),s.i4[a]=t.ITa.endTransaction()}}return l},e.prototype.a_=function(t){var e,n,o=this,r=o.kj,i=r.mm,a=o.X$,s=o.Y$;i.$$=s,i._$||((e={})[b]=o.W$,e[w]=a,e[T]=5===t[T]?s:t[T],e[x]=o.Z$,n=new E(r,e),r.suspendEvent(),n.execute(),r.resumeEvent(),o.i4.d_=n)},e.prototype.oUa=function(){var t=this;t.kj.isDirtySuspended()||(t.N$=new y(t.kj,t.X$,C))},e.prototype.undo=function(){var t,e,n,o,i=this;if(i.canUndo()){t=i.kj,e=i.X$,i.oUa(),i.Lz(t,!0);try{n=t.getSelections(),t.suspendEvent(),o=r.Commands.bWa(t.name()),t.ITa.undo(i.i4[o]),t.resumeEvent(),t.yu(n,t.getSelections())&&t.Au(n)}finally{i.Mz(t,!0),i.IVa(t,e,!0)}}return!0},e.prototype.IVa=function(t,e,n){var o,r=[];t.isDirtySuspended()||((o=new y(t,e,C)).uy(this.N$.sy()),r=o.wy()),v(t,e.row,e.col,F(e),P(e),r,1,f,n)},e}(m),O=function(t){function e(e,n){return t.call(this,e,n)||this}return j(e,t),e.prototype.canExecute=function(){var t,e,n,o=this,r=o.kj,i=o.VQ,a=i.fromRow,s=i.fromColumn,l=F(i),u=i.columnCount,f=i.toRow,h=i.toColumn,p=!i.copy,d={row:a,col:s,rowCount:l,colCount:u},g={row:f,col:h,rowCount:l,colCount:u};return(!r.tables||!r.tables.zxb(r,d,r,g,p))&&!!r.pu(a,s,l,u,_(r),L(r))&&!(!i.insert&&!r.pu(f,h,l,u,_(r),L(r)))&&(t=f>=0&&h<0&&a>=0&&s<0&&l>0&&u<0,e=f<0&&h>=0&&a<0&&s>=0&&l<0&&u>0,n=o.KZa(t,e),r.Y3(f,h,l,u,c,c,n)&&r.Y3(a,s,l,u,c,c,n))},e.prototype.KZa=function(t,e){var n,o,r=this.VQ,i=this.kj,a=r.insert,s=i.options.isProtected,l=i.options.protectionOptions;return!(!s||R(l)||(n=l.allowDragInsertRows,o=l.allowDragInsertColumns,!a||!(n&&t||o&&e)))},e.prototype.execute=function(){var t,e,n,o,i,a,s,l,u,c,f,h,p,d,g,m,y=this,v=!1;if(y.canExecute()){t=y.kj,e=y.VQ,y.oUa(),n=void 0,o=void 0,i=void 0,a=e.fromRow,s=e.fromColumn,l=e.toRow,u=e.toColumn,c=F(e),f=e.columnCount,h=e.option,p=t.parent.sheets,r.Commands.Zxb(p),y.Lz(t,!0),t.vxb=!0;try{try{t.tables&&t.tables.fIb(new r.Range(l,u,c,f),new r.Range(a,s,c,f))}catch(e){return t.Os(6,e.message),void t.resumePaint()}e.insert?s>=0&&a<0?(n=s,o=u,i=f,d=u,t.addColumns(o,i),e.copy?t.copyTo(-1,o<=n?n+i:n,-1,o,-1,i,h):(t.moveTo(-1,o<=n?n+i:n,-1,o,-1,i,h),t.deleteColumns(o<=n?n+i:n,i),n<o&&(d=o-i)),B(t,-1,d,_(t),i)):a>=0&&s<0&&(n=a,o=l,i=c,g=l,t.addRows(o,i),e.copy?t.copyTo(o<=n?n+i:n,-1,o,-1,i,-1,h):(t.moveTo(o<=n?n+i:n,-1,o,-1,i,-1,h),t.deleteRows(o<=n?n+i:n,i),n<o&&(g=o-i)),B(t,g,-1,i,L(t))):(e.copy?t.copyTo(a,s,l,u,c,f,h):t.moveTo(a,s,l,u,c,f,h),t&&(B(t,l,u,c,f),m=e.io,e.copy||t.isDirtySuspended()||(m._z=y.aA(t,m.cA,a,s,c,f)),t.isDirtySuspended()||(m.dA=y.aA(t,m.fA,l,u,c,f)))),v=!0}finally{t.mm.gA={},y.Mz(t,!0),t.vxb=!1,r.Commands.$xb(p,e)}G(t)}return v},e.prototype.aA=function(t,e,n,o,r,i){var a=new y(t,h(n,o,r,i),this.VQ.option),s=t.tables&&t.tables.$Hb&&t.tables.$Hb(n,o,r,i);return s&&s.length>0&&(this.VQ.tableNamesObj={r:n,c:o,rc:r,cc:i,tableNames:s}),a.uy(e.sy()),v(t,n,o,r,i,a.wy(),0,s),a},e.prototype.oUa=function(){var t=this.kj,e=this.VQ,n=e.io={},o=e.fromRow,r=e.fromColumn,i=e.toRow,a=e.toColumn,s=e.option,l=o<0?0:o,u=r<0?0:r,c=i<0?0:i,f=a<0?0:a,p=o<0?_(t):F(e),d=r<0?L(t):e.columnCount;e.insert||t.isDirtySuspended()||(e.copy||(n.cA=new y(t,h(l,u,p,d),s)),n.fA=new y(t,h(c,f,p,d),s)),n.rA=t.Nr,n.sA=t.Pr,n.tA=t.Jl,n.uA=t.Kl},e.prototype.undo=function(){var t,e,n,o,i,a,s,l,u,c,f,h,p,d,g,m,y,C,b,w,T,x=this;if(x.canUndo()){if(t=x.kj,n=(e=x.VQ).fromRow,o=e.fromColumn,i=e.toRow,a=e.toColumn,s=F(e),l=e.columnCount,!t.pu(n,o,s,l,_(t),L(t)))return!1;if(!e.insert&&!t.pu(i,a,s,l,_(t),L(t)))return!1;u=void 0,c=e.io,x.Lz(t,!0),f=t.parent.sheets,r.Commands._xb(f,e);try{e.insert?o>=0&&n>=0||(o>=0?(u=l,t&&B(t,-1,o,_(t),u)):n>=0&&(u=s,t&&B(t,n,-1,u,L(t)))):(h=n<0?0:n,p=o<0?0:o,d=i<0?0:i,g=a<0?0:a,m=n<0?_(t):s,y=o<0?L(t):l,t&&(B(t,n,o,s,l),C=e.tableNamesObj,b=[],w=[],C&&(C.r===d&&C.c===g&&C.rc===m&&C.cc===y?w=C.tableNames:b=C.tableNames),v(t,d,g,m,y,c.dA?c.dA.wy():[],0,b,!0),v(t,h,p,m,y,c._z?c._z.wy():[],0,w,!0))),t&&(-1!==c.tA&&-1!==c.uA&&((T=t.getSelections()[0]).contains(c.tA,c.uA)?t.Jr(c.tA,c.uA):t.Jr(T.row,T.col)),-2!==c.rA&&-2!==c.sA&&-1!==c.tA&&-1!==c.uA&&t.showCell(c.tA,c.uA,3,3))}finally{x.Mz(t,!0)}G(t)}return!0},e}(m),r.Commands[A]={canUndo:!0,execute:function(t,e,n){return r.Commands.h4(t,D,e,n)}},r.Commands[I]={canUndo:!0,execute:function(t,e,n){return r.Commands.h4(t,O,e,n)}}},"./dist/plugins/fill/fill-event.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S;function A(t){return t.rowViewportIndex}function I(t){return t.colViewportIndex}function R(t){return t.hitTestType}function k(t,e){return t.getRowCount(e)}function M(t,e){return t.getColumnCount(e)}function N(t){return t.colCount}function E(t){return t.rowCount}function D(t){return t.height}function O(t){return t.width}function j(t,e,n,o,i){var a,s,l;t.save(),e===o?(t.rect(e-2,n,7,y(i-n)),t.clip(),t.beginPath(),n<i?(n-=3,i+=3):(n+=3,i-=3),a=r.zF(e-1,n-1,o-1,i+1,w,7),s=r.zF(e,n,o,i,w,7),l=r.zF(e+1,n-1,o+1,i+1,w,7)):n===i&&(t.rect(e,n-2,y(o-e),7),t.clip(),t.beginPath(),e<o?(e-=3,o+=3):(e+=3,o-=3),a=r.zF(e-1,n-1,o+1,i-1,w,7),s=r.zF(e,n,o,i,w,7),l=r.zF(e-1,n+1,o+1,i+1,w,7)),a&&a.vE(t),s&&s.vE(t),l&&l.vE(t),t.stroke(),t.beginPath(),t.restore()}function F(t,e,n,o,i,a,s,l,u,c,f){var h=e?r.Events.DragDropBlock:r.Events.DragDropBlockCompleted,p={sheet:t,sheetName:t.name(),fromRow:n,fromCol:o,toRow:i,toCol:a,rowCount:s,colCount:l,copy:u,insert:c,copyOption:f};return e&&(p.cancel=!1),t.Wq(h,p),p.cancel}function P(t,e,n,o,r){var i,a,s;for(i=0;i<n.rowCount;i++){for(a=0;a<n.colCount;a++){if(!(s=t.getSpan(n.row+i,n.col+a))||s.rowCount!==e.rowCount||s.colCount!==e.colCount)return!1;o&&(a+=e.colCount)}r&&(i+=e.rowCount)}return!0}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("SheetsCalc"),a=n("./dist/plugins/fill/fill-ui.js"),s=n("./dist/plugins/fill/fill.js"),l=n("./dist/plugins/fill/fill.ns.js"),u=n("@grapecity/js-calc"),c=!!u,f=r.GC$,h=r.kf,p=o.Common.j.Fa,d=null,g=void 0,m=Math.min,y=Math.abs,v=Math.max,C="drag",b="corner",w="black",T=2047,x=new o.Common.ResourceManager(l.SR),S=x.getResource.bind(x),f.extend(r.iI.prototype,{gG:function(t){var e,n,o,r,i,a,s,l,u=this;u.zG||(e=u.kj,n=d,1===(o=e.ITa.getSelections()).length?n=o[0]:o.length<1&&(n=e.ITa.getSpan(e.Jl,e.Kl)),n&&(u.zG=!0,u.OG=!0,u.L_=n,r=e.getRangeRect(A(t),I(t),n),(i=u.gA).x=r.x,i.y=r.y,i.width=r.width-1,i.height=r.height-1,i.row=n.row,i.col=n.col,i.rowCount=E(n),i.colCount=N(n),a=e.Tq(n),s=t.row,l=t.col,s<a.row&&(s=a.row),s>=a.row+E(a)&&(s=a.row+E(a)-1),l<a.col&&(l=a.col),l>=a.col+N(a)&&(l=a.col+N(a)-1),i.hitRow=s,i.hitCol=l,i.rowOffset=s-a.row,i.colOffset=l-a.col,u.rG={KG:A(t),MG:I(t),sG:R(t)},u.qG()))},AG:function(){var t,e,n,o,r,i,a,s,l,u,c=this;c.rG&&c.OG&&c.zG&&c.L_&&(t=c.$F,e=c.gA,o=(n=c.kj.getCellRect(e.hitRow,e.hitCol)).width/2,r=n.x+o,i=n.height/2,a=n.y+i,e.hitTarget={x:t.x,y:t.y},s=c.fH(),l=c.gH(),u=!1,(y(r-t.x)>o+5||y(a-t.y)>i+5)&&(u=!0),s>=0&&l>=0&&u&&c.M_(s,l),c.NG())},M_:function(t,e){var n,o,r,i,a,s,l,u,c=this;c.zG&&c.L_&&(n=c.kj,o=c.gA,-1===(r=n.Ix()).row&&-1!==r.col?(o.row=-1,o.col=v(0,m(M(n)-N(o),e-o.colOffset))):-1!==r.row&&-1===r.col?(o.row=v(0,m(k(n)-E(o),t-o.rowOffset)),o.col=-1):(o.row=o.row<0?-1:v(0,m(k(n)-E(o),t-o.rowOffset)),o.col=o.col<0?-1:v(0,m(M(n)-N(o),e-o.colOffset))),o.hitRow=t,o.hitCol=e,i=n.Tq(o),(a=c.N_)&&i.row===a.row&&i.col===a.col&&E(i)===E(a)&&N(i)===N(a)&&i.row>n.ar()&&i.col>n.$q()&&i.row+E(i)-1<n.ir()&&i.col+N(i)-1<n.dr()||(c.MI=i,n.yl.QH(),c.N_=i,(s=n.parent)&&s.options.showDragDropTip&&(l=o.x+o.width+5,u=o.y+o.height+5,s.uw(c.O_(i),l,u))))},O_:function(t){var e,n,o,r,a,s,l,f,h;return t&&c?(n=(e=this.kj).Ix(),a=void 0,o=(o=e.getActiveRowIndex())<0?0:o,r=(r=e.getActiveColumnIndex())<0?0:r,1===E(n)&&1===N(n)?a=u.rf(d,d,t.row-o,t.col-r,!0,!0):(s=void 0,l=void 0,f=void 0,h=void 0,-1===n.row&&n.col>=0?(s=f=i.BAND_INDEX_CONST,l=t.col-r,h=t.col-r+N(n)-1):-1===n.col&&n.row>=0?(l=h=i.BAND_INDEX_CONST,s=t.row-o,f=t.row-o+E(n)-1):n.row>=0&&n.col>=0&&(s=t.row-o,f=t.row-o+E(n)-1,l=t.col-r,h=t.col-r+N(n)-1),a=u.uf(d,d,s,l,f,h,!0,!0,!0,!0,o,r)),e.Cf().unparse(e.yj(),a,o,r)):g},wH:function(){var t,e,n,o,i,a,s,l,u,f,p,g,m=this,y=!1,v="",C=!1,b=m.kj;m.rG=d,m.RG(),t=(e=b.Ix())&&(E(e)>0||N(e)>0)?{r:e.row,c:e.col,rc:E(e),cc:N(e)}:{r:b.Jl,c:b.Kl,rc:1,cc:1},!0===m.zG&&!0===m.OG&&(n=t.r,o=t.c,i=t.rc,a=t.cc,s=m.gA.row,l=m.gA.col,u=b.options.protectionOptions,void 0,f={fromRow:n,fromColumn:o,rowCount:i,columnCount:a,toRow:s,toColumn:l,isDragInsert:m.OH,isDragCopy:m.PH},b.Wq(r.Events.BeforeDragDrop,f),(v=f.invalidMessage)&&0!==v.length||(!m.OH||-1!==n&&-1!==o?s===n&&l===o||((b.qu(n,o,i,a)||b.qu(s,l,i,a))&&(y=!0,v=S().Exp_ChangeMergedCell),y||c&&(b.Ns(n,o,i,a)||b.Ns(s,l,i,a))&&(y=!0,v=S().Exp_ChangePartOfArray),!y&&b.options.isProtected&&(!m.PH&&b.ou(h(n,o,i,a))||b.ou(h(s,l,i,a)))&&(y=!0,v=S().Exp_CellReadOnly),y||(F(b,!0,n,o,s,l,i,a,m.PH,!1,T)||(C=b.wu().execute({cmd:"dragDrop",sheetName:b.name(),fromRow:n,fromColumn:o,toRow:s,toColumn:l,rowCount:i,columnCount:a,copy:m.PH,insert:!1,option:T}),F(b,!1,n,o,s,l,i,a,m.PH,!1,T)))):o>=0?(m.PH&&(l<=o||l>=o+a)||!m.PH&&(l<o||l>o+a))&&((b.qu(-1,o,-1,a)||b.qu(-1,l,-1,0))&&(y=!0,v=S().Exp_ChangeMergedCell),p=u&&u.allowDragInsertColumns,!y&&b.options.isProtected&&!0!==p&&(y=!0,v=S().Exp_ColumnReadOnly),y||(F(b,!0,-1,o,-1,l,-1,a,m.PH,!0,T)||(C=b.wu().execute({cmd:"dragDrop",sheetName:b.name(),fromRow:-1,fromColumn:o,toRow:-1,toColumn:l,rowCount:-1,columnCount:a,copy:m.PH,insert:!0,option:T}),F(b,!1,-1,o,-1,l,-1,a,m.PH,!0,T)))):n>=0&&o<0&&(m.PH&&(s<=n||s>=n+i)||!m.PH&&(s<n||s>n+i))&&((b.qu(n,-1,i,-1)||b.qu(s,-1,0,-1))&&(y=!0,v=S().Exp_ChangeMergedCell),y||c&&(b.Ns(n,-1,i,-1)||b.Ns(s,-1,0,-1))&&(y=!0,v=S().Exp_ChangePartOfArray),g=u&&u.allowDragInsertRows,!y&&b.options.isProtected&&!0!==g&&(y=!0,v=S().Exp_RowReadOnly),y||(F(b,!0,n,-1,s,-1,i,-1,m.PH,!0,T)||(C=b.wu().execute({cmd:"dragDrop",sheetName:b.name(),fromRow:n,fromColumn:-1,toRow:s,toColumn:-1,rowCount:i,columnCount:-1,copy:m.PH,insert:!0,option:T}),F(b,!1,n,-1,s,-1,i,-1,m.PH,!0,T)))))),m.OG=!1,m.zG=!1,m.L_=d,m.OH=!1,m.PH=!1,m.N_=d,m.xw(),C||(m.gA={},b.repaint()),y&&b.Os(3,v)},hG:function(t){var e=this;!0!==e.BG&&!0!==e.OG&&(e.P_(),e.A$&&(e.OG=!0,e.BG=!0,e.$I=!0,e.Q_=t,e.R_=I(t),e.S_=A(t),e.T_=I(t),e.U_(),e.rG={KG:A(t),MG:I(t),sG:R(t)},e.qG()))},U_:function(){var t,e=this,n=function(t){return t.frozenRowCount()}(e.kj),o=function(t){return t.frozenColumnCount()}(e.kj),r=e.V_();r>=0&&r<n?e.W_=0:r>=n&&r<=k(e.kj)&&(e.W_=1),e.X_()?e.Y_=1:e.Y_=e.Q_,(t=e.Z_())>=0&&t<o?e.__=0:t>=o&&t<=M(e.kj)&&(e.__=1),e.a0()?e.b0=1:e.b0=e.R_},CG:function(){var t,e,n=this;n.rG&&n.BG&&n.OG&&n.A$&&(n.S_=n.iH(),n.T_=n.jH(),n.c0=n.fH(),n.d0=n.gH(),n.c0>=0&&n.d0>=0&&(n.e0(),n.f0(),t=n.kj.parent,e=!1,n.g0()&&(e=n.h0(n.A$,n.A_,!0)),t&&t.options.showDragFillTip&&e&&n.i0(),n.j0()),n.NG())},k0:function(){var t,e,n,r,i,a,l,u,c,f,h,p=this,g=p.kj,m=p.A$,y=p.A_,v=g.parent.options.defaultDragFillType,C=p.l0(3===v?5:v),b=p.m0(),w=p.g0();return 1===C?(t=0===b||1===b?1:0,n=new s.z$(g).B$(w,t,!0),e=p.n0(b,y,m),i=(r=g.getActualStyle(e.row,e.col)).cellType||g.Al(),a=r.formatter?r.formatter:r._autoFormatter,l=o.Formatter&&o.Formatter.GeneralFormatter,n instanceof Date&&l&&(a=new l(o.Common.CultureManager.q4().DateTimeFormat.shortDatePattern+" hh:mm:ss AM/PM;@","0")),c=3,(u=p.rG)&&(c=u.sG),f={sheet:g,row:e.row,col:e.col,sheetArea:c,quotePrefix:r.quotePrefix},h={},i.format(n,a,h,f)):0===C?(e=p.n0(b,y,m),g.getFormula(e.row,e.col)?d:g.getText(e.row,e.col)):d},n0:function(t,e,n){var o,r=n.row,i=n.col,a=E(n),s=N(n),l=h(r,i,1,1);return 3===t?(o=0===(o=E(e)%a)?r+a-1:r+o-1,l.row=o,l.col=i):1===t?(o=0===(o=N(e)%s)?i+s-1:i+o-1,l.row=r,l.col=o):0===t?(o=0===(o=N(e)%s)?i:i+s-o,l.row=r,l.col=o):2===t&&(o=0===(o=E(e)%a)?r:r+a-o,l.row=o,l.col=i),l},i0:function(){var t,e,n,o,r,i,a=this,s=a.kj;return 4===a.l0()||a.a0()||a.X_()?(a.xw(),d):(o=a.m0(),r=a.g0(),i=s.cm(r),n=a.k0(),3===o||1===o?(t=i.x+i.width+3,e=i.y+i.height+3):0===o?(t=i.x+3,e=i.y+i.height+3):2===o&&(t=i.x+i.width+3,e=i.y+3),void a.uw(n,t,e))},j0:function(){var t=this;t.o0(),t.p0(),t.q0(),t.r0=t.g0()},o0:function(){var t,e=this.kj;this.r0&&((t=e.cm(this.r0)).x-=2,t.y-=2,t.width+=4,t.height+=4,e.yl.dm(t))},p0:function(t){this.kj.yl.im(this.A$,d,t)},q0:function(){var t,e,n=this.kj,o=n.yl,r=this.g0();r&&(t=o.bm(),e=n.cm(r),t.save(),t.beginPath(),o.RI(t,e),t.restore())},f0:function(){this.A_=this._I()},a0:function(){return-1===this.A$.col&&-1!==this.A$.row},X_:function(){return-1===this.A$.row&&-1!==this.A$.col},ZI:function(){return 4===this.dJ||5===this.dJ},_I:function(){var t=this,e=-1,n=-1,o=-1,r=-1;switch(t.dJ){case 0:t.X_()?(e=-1,o=-1):(e=t.V_(),o=E(t.A$)),n=t.d0,r=t.Z_()-n;break;case 1:t.X_()?(e=-1,o=-1):(e=t.V_(),o=E(t.A$)),n=t.s0()+1,r=t.d0-n+1;break;case 2:e=t.c0,o=t.V_()-e,t.a0()?(n=-1,r=-1):(n=t.Z_(),r=N(t.A$));break;case 3:e=t.t0()+1,o=t.c0-e+1,t.a0()?(n=-1,r=-1):(n=t.Z_(),r=N(t.A$));break;case 5:e=t.c0,o=t.t0()-e+1,t.a0()?(n=-1,r=-1):(n=t.Z_(),r=N(t.A$));break;case 4:t.X_()?(e=-1,o=-1):(e=t.A$.row,o=E(t.A$)),n=t.d0,r=t.s0()-n+1}return h(e,n,o,r)},u0:function(){var t=this.t0();return-1!==t?this.kj.Gr(this.Y_).findRow(t):d},v0:function(){return this.kj.Gr(this.S_).findRow(this.w0())},w0:function(){return this.kj.getViewportBottomRow(this.S_)},x0:function(){var t=this.s0();return-1!==t?this.kj.Hr(this.b0).findCol(t):d},y0:function(){return this.kj.Hr(this.T_).findCol(this.z0())},z0:function(){return this.kj.getViewportRightColumn(this.T_)},e0:function(){var t,e,n,o,r,i,a,s,l,u,c,h,p,d,g,v,C,b,w,T=this,x=T.a0(),S=T.X_(),A=f(T.kj.Ws()).offset(),I=T.$F.e,R=T.$F.x,k=T.$F.y,M=I.pageX-A.left,N=I.pageY-A.top,E=!1;x||S?S?T.d0>=T.Z_()&&T.d0<=T.s0()?T.dJ=4:T.d0<T.Z_()?T.dJ=0:T.d0>T.s0()&&(T.dJ=1):x&&(T.c0>=T.V_()&&T.c0<=T.t0()?T.dJ=5:T.c0<T.V_()?T.dJ=2:T.c0>T.t0()&&(T.dJ=3)):T.c0>=T.V_()&&T.c0<=T.t0()?T.d0>=T.Z_()&&T.d0<=T.s0()?(t=y(T.d0-T.s0()),(e=y(T.c0-T.t0()))>t?T.dJ=5:e<t?T.dJ=4:((n=T.u0())||(n=T.v0()),k>n.y+n.height?T.dJ=3:((o=T.x0())||(o=T.y0()),r=o.x+o.width-R,i=n.y+n.height-k,M>=o.x&&M<=o.x+o.width&&N>=n.y&&N<=n.y+n.height?T.dJ=r>=i?4:5:E=!0))):T.d0<T.Z_()?T.dJ=0:T.d0>T.s0()&&(T.dJ=1):T.c0<T.V_()?T.d0>=T.Z_()&&T.d0<=T.s0()?T.dJ=2:T.d0<T.Z_()?(t=y(T.d0-T.Z_()),e=y(T.c0-T.V_()),T.dJ=e>=t?2:0):T.d0>T.s0()&&(t=y(T.d0-T.s0()),e=y(T.c0-T.V_()),T.dJ=e>=t?2:1):T.c0>T.t0()&&(T.d0>=T.Z_()&&T.d0<=T.s0()?T.dJ=3:T.d0<T.Z_()?(t=y(T.d0-T.Z_()),e=y(T.c0-T.t0()),T.dJ=e>=t?3:0):T.d0>T.s0()&&(t=y(T.d0-T.s0()),e=y(T.c0-T.t0()),T.dJ=e>=t?3:1)),(a=T.kj.yl.rH)&&(u=(s=T.t0())+1,c=(l=T.s0())+1,h=T.kj.getRowHeight(s,3),p=T.kj.getColumnWidth(l,3),d=T.kj.getRowHeight(u,3),g=T.kj.getColumnWidth(c,3),v=a.x+a.width/2-m(10,p/2),C=a.x+a.width/2+m(10,g/2),b=a.y+a.height/2-m(10,h/2),w=a.y+a.height/2+m(10,d/2),!1,(x||S?S?v<=M&&M<=C:b<=N&&N<=w:v<=M&&M<=C&&b<=N&&N<=w)||E?(T.$I=!0,T.dJ=4):T.$I=!1)},V_:function(){return this.A$?-1===this.A$.row?0:this.A$.row:-1},t0:function(){var t=this;return t.A$?-1===t.A$.row?k(t.kj)-1:t.A$.row+E(t.A$)-1:-1},Z_:function(){return this.A$?-1===this.A$.col?0:this.A$.col:-1},s0:function(){var t=this;return t.A$?-1===t.A$.col?M(t.kj)-1:t.A$.col+N(t.A$)-1:-1},hla:function(t,e){var n,o,r,i,a,s,l=h(e.row,e.col,e.rowCount,e.colCount),u=this.kj;return u.ITa.findSpan(t.row,t.col)&&(n=t.rowCount,o=l.rowCount,0!==Math.floor(o%n)&&(r=Math.ceil(o/n)*n,l.row+r<=u.getRowCount()&&(l.rowCount=r)),i=t.colCount,a=l.colCount,0!==Math.floor(a%i)&&(s=Math.ceil(a/i)*i,l.col+s<=u.getColumnCount()&&(l.colCount=s))),l},xH:function(){var t,e,n,o,r,i,a=this,s=a.kj;return a.rG=d,a.RG(),a.xw(),a.BG&&a.OG?(a.BG=!1,a.OG=!1,void((t=a.g0())&&(e=a.h0(a.A$,a.A_),!e||a.$I?(a.A0(),a.WA(t)):(n=s.mm.A$,o=a.hla(n,a.A_),r=a.l0(),s.wu().execute({cmd:"fill",sheetName:s.name(),startRange:n,fillRange:o,autoFillType:r,fillDirection:s.mm.m0()}),i=a._$,!i&&a.B0()&&s.parent.options.showDragFillSmartTag&&4!==a.$$?a.C0(a.$$):a.WA(t),a.A0())))):void a.A0()},C0:function(t){var e=this.kj,n=e.yl.rH,o={x:n.x+n.width,y:n.y+n.height,fillType:t};e.NF=new a.K_(e.parent.xv(),e,o),e.NF.OT()},P_:function(){var t=this.kj,e=t.ITa.getSelections();1===e.length?this.A$=e[0]:t.Jl>=0&&t.Kl>=0&&(this.A$=h(t.Jl,t.Kl,1,1))},A0:function(){this.OG=!1,this.BG=!1},WA:function(t){this.kj.yl.im(t)},l0:function(t){var e=this,n=e.kj,o=t!==g?t:n.parent.options.defaultDragFillType;return e.ZI()?4:5!==o?o:1===E(e.A$)&&1===N(e.A$)&&!e.X_()&&!e.a0()?e.RH?1:0:e.RH?0:1},g0:function(){var t,e,n,o,r=this;return r.A$?r.ZI()?r.A$:r.A_?(t=0,e=0,n=0,o=0,r.D0()?(t=2===r.dJ?r.A_.row:r.A$.row,e=E(r.A$)+E(r.A_),n=r.A$.col,o=N(r.A$)):(t=r.A$.row,e=E(r.A$),n=0===r.dJ?r.A_.col:r.A$.col,o=N(r.A$)+N(r.A_)),h(t,n,e,o)):d:d},h0:function(t,e,n){var o=this.kj,r=!0,i="";return o.ITa.MTa(e.row,e.col,E(e),N(e))&&!function(t,e,n){var o,r=e.row,i=e.rowCount,a=e.col,s=e.colCount,l=n.row,u=n.rowCount,c=n.col,f=n.colCount,h=r===l&&i===u,p=a===c&&s===f;return!(!h&&!p)&&(!(!(o=t.getSpan(r,a))||!P(t,o,e,h,p))&&!t.ITa.qu(l,c,u,f)&&P(t,o,n,h,p))}(o,t,e)&&(r=!1,i=S().Exp_FillRangeContainsMergedCell),r&&o.options.isProtected&&o.ou(e)&&(r=!1,i=S().Exp_FillCellsReadOnly),r||n||o.Os(2,i),r},B0:function(){return this.E0()||this.F0()},E0:function(){return 3===this.dJ||1===this.dJ},F0:function(){return 0===this.dJ||2===this.dJ},D0:function(){return 2===this.dJ||3===this.dJ||5===this.dJ},m0:function(){var t=this.dJ;return t>=0&&t<=3?t:4===t?0:5===t?2:3},tr:function(t,e,n){var o,r,i,a=this,s=d,l=A(t),u=I(t),c=a.kj,f=c.parent;if(p(l)||p(u)||!f.options.allowUserDragDrop&&!f.options.allowUserDragFill)return s;if(-1===(o=c.Ix()).row&&-1===o.col)return s;if(l>=0&&u>=0&&1===c.ITa.getSelections().length){if(a.qH(l,u,e,n))return s;(r=c.getRangeRect(l,u,o)).x-4<e&&e<r.x+4&&r.y<=n&&n<r.y+r.height&&(s={action:C,side:"left"}),s||(i=a.kj.yl.rH)&&i.x<=e&&e<=i.x+i.width&&i.y<=n&&n<=i.y+i.height&&(s={action:C,side:b}),s||r.x+r.width-4<e&&e<r.x+r.width+4&&r.y<=n&&n<r.y+r.height&&(s={action:C,side:"right"}),s||r.y-4<n&&n<r.y+4&&r.x<=e&&e<r.x+r.width&&(s={action:C,side:"top"}),s||r.y+r.height-4<n&&n<r.y+r.height+4&&r.x<=e&&e<r.x+r.width&&(s={action:C,side:"bottom"}),s&&(e<r.x||e>r.x+r.width||n<r.y||n>r.y+r.height)&&(s.outside=!0)}return f&&f.options.allowUserDragDrop||s&&s.side!==b&&(s.side=d),f&&f.options.allowUserDragFill||s&&s.side===b&&(s.side=d),s},Hyb:function(t,e){var n=this,o=n.kj.getSpan(t,e,3);return o?!p(n.kj.getValue(o.row,o.col,3,0)):!p(n.kj.getValue(t,e,3,0))},Iyb:function(t,e,n,o){var r;for(r=e;r<e+o;r++)if(!this.Hyb(t,r))return!1;return!0},Jyb:function(t,e,n,o){var r;for(r=e;r<e+o;r++)if(this.Hyb(t,r))return!1;return!0},Kyb:function(t,e,n,o){var r,i,a,s,l,u,c,f=this,h=f.kj;if("left"===o){for(r=0;r<e;r++)f.Hyb(t,r)&&(n.searchArray[r]=!0);for(i=e-1,a=1;n.searchArray[i];)i--,a++;n.searchLength=a}if("right"===o){for(s=h.getColumnCount(),l=e;l<s;l++)f.Hyb(t,l)&&(n.searchArray[l-e]=!0);for(u=0,c=1;n.searchArray[u];)u++,c++;n.searchLength=c}return n},Lyb:function(t,e,n,o,r){var i,a,s,l,u,c=this,f=c.kj,h=0,p={searchArray:Array(o),searchLength:1},d={searchArray:Array(f.getColumnCount()-r),searchLength:1};for(i=e;i<n;i++)p=c.Kyb(i,t.col,p,"left"),d=c.Kyb(i,t.col+t.colCount-1,d,"right");for(;c.Jyb(n+h,t.col,1,t.colCount);){for(a=!0,s=!1,p=c.Kyb(n+h,o,p,"left"),d=c.Kyb(n+h,r,d,"right"),l=o-1;l>=o-p.searchLength;l--)if(c.Hyb(n+h,l)){h++,a=!1;break}if(a){for(u=r+1;u<=r+d.searchLength;u++)if(c.Hyb(n+h,u)){h++,s=!0;break}if(!s)return h}}return h},Myb:function(t){for(var e=0;this.Iyb(t.row+t.rowCount+e,t.col,1,t.colCount);)e++;return e},Nyb:function(t){var e,n,o,r,i=this;return i.Iyb(t.row+t.rowCount,t.col,1,t.colCount)?i.Myb(t):(o=t.row-2,r=t.row+t.rowCount,1===t.colCount?n=e=t.col:(e=t.col,n=t.col+t.colCount-1),i.Lyb(t,o,r,e,n))},cyb:function(){var t,e,n,o=this,r=o.kj,i=r.mm.A$,a=o.Nyb(i);0!==a&&(t=h(i.row+i.rowCount,i.col,a,i.colCount),o.dJ=3,o.A_=t,e=o.l0(),n=o._$,r.wu().execute({cmd:"fill",sheetName:r.name(),startRange:i,fillRange:t,autoFillType:e,fillDirection:o.dJ}),!n&&r.parent.options.showDragFillSmartTag&&4!==o.$$&&o.C0(o.$$))}}),f.extend(r.oJ.prototype,{gJ:function(t,e){var n,o=this.kj,i=t.x,a=t.y,s=O(t),l=D(t),u=o.Ix(),c=o.am(),f=4,h=-2.5;return e>2007&&(f=5,h=-3),n=new r.Rect(-4,-4,f,f),-1===u.col?(n.x=c.kt,n.y=a+l+h):-1===u.row?(n.x=i+s+h,n.y=c.nt):(n.x=i+s+h,n.y=a+l+h),n},eJ:function(t,e,n,o,i){var a,s,l=this,u=l.kj,c=u.am(),f=u.parent,h=f&&f.Vv,p=l.gJ(o,h),d=p.x,g=p.y,m=O(p),y=D(p),C=c.Ft(e,n);i&&!p.intersectRect(i)||p.intersectRect(C)&&(a=-1.5,h>2007&&(a=-1),(s=new r.Rect(d+a,g+a,m+2,y+2)).x=v(s.x,C.x),s.y=v(s.y,C.y),l.dm(s),t.save(),i&&!i.containsRect(p)&&(t.rect(i.x,i.y,O(i),D(i)),t.clip()),t.beginPath(),t.fillStyle=r.Rm.Om(u,u.getSelectionBorderColor()),t.fillRect(d,g,m,y),l.rH=new r.Rect(p.x,p.y,4,4),t.beginPath(),t.restore())},RI:function(t,e){var n=e.x,o=e.y,r=n+O(e),i=o+D(e);j(t,n,o,r,o),j(t,n,i,r,i),j(t,n,o,n,i),j(t,r,o,r,i)},NI:function(t,e){var n,o,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=g.mm.gA,y=m.hitTarget;m&&y&&(n=m.hitCol,o=m.hitRow,i=g.mm.OH,a=g.OI,t.save(),!0!==i||-1!==m.row&&-1!==m.col?(a&&(s=new r.Rect(a.x-2,a.y-2,O(a)+4,D(a)+4),d.dm(s,e),d.im(g.Ix(),e)),t.rect(e.x,e.y,O(e),D(e)),t.clip(),t.beginPath(),d.RI(t,m)):-1===m.row&&-1!==m.col?((l=g.Hr(0).findCol(n))||(l=g.Hr(1).findCol(n)),l||(l=g.Hr(2).findCol(n)),l&&(u=l.x,c=O(l),m.col=n,y.x>u+c/2&&(m.col<g.cr()||m.col===g.dr())&&(u=l.x+O(l),m.col++),a&&0===O(a)||(a=g.mm.gA),a&&(s=new r.Rect(a.x-2,a.y-2,O(a)+4,D(a)+4),d.dm(s,e),d.im(g.Ix(),e)),g.QI=new r.Rect(u,m.y,0,D(m)),t.rect(e.x,e.y,O(e),D(e)),t.clip(),t.beginPath(),j(t,u,m.y,u,m.y+D(m)))):-1!==m.row&&-1===m.col&&((f=g.Gr(0).findRow(o))||(f=g.Gr(1).findRow(o)),f||(f=g.Gr(2).findRow(o)),f&&(h=f.y,p=D(f),m.row=o,y.y>h+p/2&&(m.row<g.hr()||m.row===g.ir())&&(h=f.y+D(f),m.row++),a&&0===D(a)||(a=g.mm.gA),a&&(s=new r.Rect(a.x-2,a.y-2,O(a)+4,D(a)+4),d.dm(s,e),d.im(g.Ix(),e)),g.QI=new r.Rect(m.x,h,O(m),0),t.rect(e.x,e.y,O(e),D(e)),t.clip(),t.beginPath(),j(t,m.x,h,m.x+O(m),h))),t.beginPath(),t.restore())},QH:function(){var t,e,n,o,i,a,s,l,u,c,f,h=this,p=h.kj,d=p.yt,g=p.mm.MI;d&&d.dragInfo&&g&&(t=h.bm(),e=p.am(),n=p.mm.gA,o=p.cm(g),i=p.frozenTrailingColumnCount(),a=p.frozenTrailingRowCount(),s=p.getColumnCount()-i,l=p.getRowCount()-a,u=e.Ft(1,1),i>0&&g.col+g.colCount<=s&&o.x+O(o)>u.x+O(u)&&o.intersectRect(u)&&(o=o.getIntersectRect(u)),a>0&&g.row+g.rowCount<=l&&o.y+D(o)>u.y+D(u)&&o.intersectRect(u)&&(o=o.getIntersectRect(u)),c=new r.Rect(e.kt,e.nt,e.lt+e.js,e.ot+e.gs),O(o)>0&&D(o)>0?(n.x=o.x,n.y=o.y,n.width=O(o)-1,n.height=D(o)-1,h.NI(t,c)):0!==O(o)&&0!==D(o)||(n.x=o.x,n.y=o.y,n.width=O(o),n.height=D(o),h.NI(t,c)),f=p.mm.OH,p.OI=!0===f?p.QI:new r.Rect(n.x,n.y,O(n),D(n)))}})},"./dist/plugins/fill/fill-ui.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function L(t,e,n,o,r,i){var l=t.CH,u=l?"160px":"150px",f=l?"25px":"20px",h=a(s("div")).css([x,"min-width",S,"padding",A],["block",u,f,0,0]).addClass("gc-smartMenu-item-default "+n+" ui-state-default"+c),p=a(s("div")).addClass(y).appendTo(h),d=a(s("div")).addClass("gc-menu-item-text").appendTo(h),g=a(s("input")).attr({id:e,value:r,type:"radio",name:"fill-group",style:"display:none"}).appendTo(p);return a(s("span")).text(o).appendTo(d),i?(p.addClass(m),g.prop("checked","checked")):g.prop("checked",""),h}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("./dist/plugins/fill/fill.ns.js"),a=r.GC$,s=r.Ul.Nl,l=r.Ul.vl,u=a(document),c=" btn btn-default",h="gc-fill-type-item",p="gc-fill-menu-container",d=(f="ui-state-hover ")+"gc-smartMenu-item-hover",g=f+"gc-smart-tag-hover",m="ui-icon ui-icon-check gc-check-image",y="gc-menu-item-input",v="ui-state-active gc-smart-tag-active",C="gc-tag-container",b="float",w="left",T="top",x="display",S="height",A="margin",I="change",R="input[type=radio]",k="mouseover",M="mouseout",N="click",E="fillTypeChanged",D="keydown.ui-fill",O=new o.Common.ResourceManager(i.SR),j=O.getResource.bind(O),F=function(t){function e(e,n){var o,r=t.call(this,e,l(n.parent.qo))||this;return r.kj=n,r.v_=a("."+C),(o=r.w_=r.yo()).addClass(p),L(n,"smartMenuCopyCells",h,j().CopyCells,"0",!0).appendTo(o),L(n,"smartMenuFillSeries",h,j().FillSeries,"1").appendTo(o),L(n,"smartMenuFillFormattingOnly",h,j().FillFormattingOnly,"2").appendTo(o),L(n,"smartMenuFillWithoutFormatting",h,j().FillWithoutFormatting,"3").appendTo(o),r}return _(e,t),e.prototype.Ao=function(){t.prototype.Ao.call(this)},e.prototype.QQ=function(){var t=this;a("."+h).bind(k,(function(){a(this).addClass(d)})).bind(M,(function(){a(this).removeClass(d)})).bind(N,(function(){var e,n=a(this),o=t.v_,r=n.find(R),i=r[0];i.checked=!0,r.trigger(I),o.trigger(N),o.trigger(M),n.removeClass(d),e=parseInt(a(i).attr("value"),10),t.x_(e)})),t.w_.find(R).bind(I,(function(){a("."+y).removeClass(m),a(this).parent().addClass(m)}))},e.prototype.y_=function(){a("."+h).unbind(k).unbind(M).unbind(N),this.w_.find(R).unbind(I)},e.prototype.x_=function(t){var e=this,n=e.kj,o=n.mm;if(e.z_!==t){e.z_=t,n.U$=!0,n.suspendEvent();try{r.Commands.undo.execute(n.parent,{sheetName:n.name()})}finally{n.resumeEvent()}n.U$=!1,n.wu().execute({cmd:"fill",sheetName:n.name(),startRange:o.A$,fillRange:o.A_,autoFillType:t,fillDirection:o.dJ}),e.v_.trigger(E,t)}},e.prototype.MQ=function(){return!!a("."+p).length},e}(r.Go),P=function(t){function e(e,n,o){var r,i=t.call(this,e,l(n.parent.qo))||this;return i.kj=n,i.B_=o,r=i.C_=i.yo().addClass("gc-smart-tag-default "+C+" gc-no-user-select ui-widget-header"+c),i.D_=a(s("div")).attr("class","fillSmartTag").css(b,w).appendTo(r),i.E_=a(s("div")).attr("class","fillSmartTagDown").css([b,x],[w,"none"]).appendTo(r),i}return _(e,t),e.prototype.F_=function(t,e,n){var o=this,r=o.kj.CH,i=a(e),s=o.G_,l=o.E_,u=r?"38px":"32px",c=r?"24px":"18px";s&&s.MQ()||(t?i.addClass(g):i.removeClass(g),i.css(["width",S],[t?u:c,c]),n||(t?l.show():l.hide()))},e.prototype.H_=function(){var t=this,e=t.C_,n=r.Ul.rl(),o=r.Ul.Ml.safari&&(n.ipad||n.iphone);e.bind(k,(function(){t.F_(!0,this,o)})).bind(M,(function(){t.F_(!1,this,o)})),e.bind(N,(function(){var e,n,r=a(this),i=t.G_,s=t.E_;i&&i.MQ()?(o&&s.hide(),r.removeClass(v),t.I_()):(o&&s.show(),r.addClass(v),t.J_(),(n=(e=t.w_)&&e.find(R)[t.B_.fillType])&&!n.checked&&(n.checked=!0,a(n).trigger(I)))})),u.bind(D,(function(e){27===e.keyCode&&(t.G_&&t.G_.MQ()?t.I_():t.close(),r.Ul.nl(e))}))},e.prototype.OT=function(){var t=this,e=t.C_,n=t.B_,o=t.kj.CH,r=o?"3px":"0px",i=o?"24px":"18px";e&&(e.css([w,T],[n.x,n.y]),t.Ao(),t.H_(),t.D_.css(A,r),t.E_.css(S,i),t.hZ())},e.prototype.J_=function(){var t,e,n,o,r,i,a,s=this,l=s.kj;s.G_||(s.G_=new F(l.parent.xv(),l),s.w_=s.G_.yo()),e=(t=s.C_).css(w),n=t.css(T),o=parseFloat(n),i=s.G_,a=s.B_,i.z_=a.fillType,isNaN(o)||(r=o+t.height()+2),s.w_.css([w,T],[e,r]),i.Ao(),i.QQ(),i.v_.unbind(E).bind(E,(function(t,e){a.fillType=e}))},e.prototype.I_=function(){var t=this.G_;t&&(t.y_(),t.close())},e.prototype.hZ=function(){var t=this.G_,e=this.C_;t&&(t.MQ()&&e.trigger(N),e.trigger(M))},e.prototype.close=function(){var e,n=this.kj;this.hZ(),u.unbind(D),t.prototype.close.call(this),(e=n.Xs)&&(e.style.cursor="default"),n&&n.zt()},e}(r.Go),e.K_=P},"./dist/plugins/fill/fill.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n("./dist/plugins/fill/drag-fill.js"),n("./dist/plugins/fill/fill-event.js"),o(n("./dist/plugins/fill/fill-ui.js")),o(n("./dist/plugins/fill/fill.js")),o(n("./dist/plugins/fill/fill.ns.js"))},"./dist/plugins/fill/fill.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function U(t){return!q(t)&&u.Na(t)}function q(t){return"string"==typeof t}function Y(t){var e=[t];return e.rowCount=1,e.colCount=v(t),e}function X(t){return t}function Z(t,e,n,r){var i=Y(e),a=Y(n),s=Y([r]),l=t?o.Common.qc(i,a,s,!0,X,c,c,c):o.Common.sc(i,a,s,!0,c,c,c),u=l&&l[0][0];return typeof u===T?o.Common.o.Lma(u,13):u}function Q(t){return t.toLowerCase()}function J(t){var e,n=t.length,o=1;if(n>1)for(o=t[1]-t[0],e=2;e<n;e++)if(o!==t[e]-t[e-1]){o=0;break}return o}function $(t,e){return t>0?(t-1)%e:e-Math.abs(t)%e-1}function K(t){for(var e="",n=0;n<t;)e+="0",n++;return e}function tt(t,e){return 12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth())}function et(t,e){var n,o=t.length,r=!0;for(n=2;n<o&&(r=e===tt(t[n-1],t[n]));n++);return r}function nt(t){return"0"===t[0]}function ot(t,e,n){var o,r,i,a,s,l=n?1:2,u=n?2:1;return e.every((function(e){return!!(o=e.match(t.Yyb))&&(r=o[l],(s=r.length)>t.Zyb&&nt(r)&&(t.Zyb=s),i=parseInt(r,10),a=o[u],d(t.Qyb)&&(t.Qyb=a),a!==t.Qyb?(t.$yb=!0,t.Qyb=c,t.Pyb=[]):t.Pyb.push(i),!0)}))}function rt(t){t.forEach((function(t){t&&t.dispose()}))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("@grapecity/js-calc"),a=n("SheetsCalc"),s=n("./dist/plugins/fill/fill.ns.js"),l=!!i,u=o.Common.j,c=null,f=void 0,h=Math.floor,p=r.kf,d=u.Fa,g=u.Pa,m=o.Common.k,y=m.Eb,v=m.ac,C=o.Common.l,b=C.Ra,w=C.Xb,T="number",x="date",S="string",A=new o.Common.ResourceManager(s.SR),I=A.getResource.bind(A),function(t){t[t.copyCells=0]="copyCells",t[t.fillSeries=1]="fillSeries",t[t.fillFormattingOnly=2]="fillFormattingOnly",t[t.fillWithoutFormatting=3]="fillWithoutFormatting",t[t.clearValues=4]="clearValues",t[t.auto=5]="auto"}(e.AutoFillType||(e.AutoFillType={})),function(t){t[t.left=0]="left",t[t.right=1]="right",t[t.up=2]="up",t[t.down=3]="down"}(e.FillDirection||(e.FillDirection={})),function(t){t[t.column=0]="column",t[t.row=1]="row"}(e.FillSeries||(e.FillSeries={})),function(t){t[t.direction=0]="direction",t[t.linear=1]="linear",t[t.growth=2]="growth",t[t.date=3]="date",t[t.auto=4]="auto"}(e.FillType||(e.FillType={})),function(t){t[t.day=0]="day",t[t.weekday=1]="weekday",t[t.month=2]="month",t[t.year=3]="year"}(e.FillDateUnit||(e.FillDateUnit={})),R=function(){function t(t){this.e_=[],this.f_=[],this.Oyb=[],this.Nc=c,this.Pyb=[],this.Qyb=c,this.g_=d(t)?-1:t}return t.prototype.h_=function(){return v(this.e_)},t.prototype.Ey=function(){var t,e,n=this,o=[],r=n.f_;for(t=0;t<v(r);t++)e=r[t],o.push("object"===n.Nc?n.Wh(e):e);return o},t.prototype.i_=function(){var t,e,n,o=this.e_;if(v(o)>0){for(e=[],n=void 0,-1===(t=this.g_)&&(t=o[0]),n=0;n<v(o);n++)e[n]=o[n]-t+1;return e}return c},t.prototype.j_=function(){var t=this.f_;return v(t)?t:c},t.prototype.Eb=function(t,e,n){if(!U(n))throw Error(I().Exp_NumberOnly);var o=this;d(o.Nc)&&(o.Nc=n instanceof Date?x:T),y(o.e_,t,e),y(o.f_,t,g(n))},t.prototype.Sb=function(t,e){var n=this,o=d(n.Nc);U(e)?(o&&(e instanceof Date?n.Nc=x:n.Nc=T),n.f_.push(g(e))):o&&(n.Nc=q(e)?S:"default"),n.e_.push(t),n.Oyb.push(e)},t.prototype.k_=function(t){return this.Nc===x?this.Wh(t):t},t.prototype.Wh=function(t){var e=c;if(t instanceof Date)e=t;else if(i)try{e=i.Convert.Wh(t)}catch(n){e=t}return e},t}(),k=function(){function t(t){this.Ryb=-1,this.Syb=[],this.Tyb=-1,this.kj=t}return t.prototype.no=function(){this.kj=c},t.prototype.Uyb=function(){var t=this.kj;return t.parent&&t.parent.Txb()||[]},t.prototype.Vyb=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g=t.length,m=!1;if(t&&g>0)for(e=Q(t[0]),n=this.Uyb(),o=void 0,r=void 0,i=void 0,a=void 0,s=void 0,l=void 0,o=0;o<n.length;o++)if((a=(i=(r=n[o]).map((function(t){return Q(t)}))).indexOf(e))>=0){for(s=a,u=i.length,c=void 0,f=void 0,h=void 0,p=1;p<g;p++){if(f=Q(t[p]),!((c=i.indexOf(f))>=0)){m=!1;break}if(h=c-s+u,l){if(l!==h){m=!1;break}}else m=!0,l=h,s=c}if(d=1===g,m||d){m=!0,this.Ryb=a,this.Syb=r,this.Tyb=d?1:l;break}}return m},t.prototype.ge=function(t){var e=this.Syb,n=this.Ryb,o=this.Tyb,r=e.length;return e[(n+o*$(t,r))%r]},t}(),M=function(){function t(){this.Uk="",this.Wyb="",this.Tyb=0,this.Xyb=1,this._padding=""}return t.prototype.ge=function(t){var e=this.Tyb*(t-1)+this.Xyb,n=this._padding.length,o=""+Math.abs(e),r=o.length,i=this._padding+o,a=i.length;return o=r>n?o:i.substr(a-n),this.Uk+o+this.Wyb},t}(),E=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.azb=0,e.Nc=x,e}return W(e,t),e}(N=function(){function t(){}return t.prototype.match=function(t){return!1},t.prototype.getTargetValue=function(t,e,n,o,r){},t.prototype.resetProp=function(){},t.prototype._yb=function(t,e){return t.indexOf(e+1)},t.prototype.dispose=function(){},t}()),D=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return W(e,t),e.prototype.match=function(t){var e=this.azb=tt(t[0],t[1]),n=function(t){return t.every((function(t){return 1===t.getDate()}))}(t),o=t.length,r=!0;return n&&o>2&&(r=et(t,e)),n&&r},e.prototype.getTargetValue=function(t,e){var n=t.Oyb[0],o=n.getFullYear(),r=e-1,i=n.getMonth()+this.azb*r;return new Date(o+parseInt(i/12,10),i%12,1)},e}(E),O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return W(e,t),e.prototype.match=function(t){var e=this.azb=tt(t[0],t[1]),n=function(t){return t.every((function(t){var e=t.getFullYear(),n=t.getMonth();return t.getDate()===new Date(e,n+1,0).getDate()}))}(t),o=t.length,r=!0;return n&&o>2&&(r=et(t,e)),n&&r},e.prototype.getTargetValue=function(t,e){var n=t.Oyb[0],o=n.getFullYear(),r=e-1,i=n.getMonth()+this.azb*r,a=o+parseInt(i/12,10),s=i%12;return new Date(a,s,function(t,e){return new Date(t,e+1,0).getDate()}(a,s))},e}(E),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return W(e,t),e.prototype.match=function(t){var e,n,o,r,i,a=!1;return function(t){return t.every((function(t){var e=t.getHours(),n=t.getMinutes(),o=t.getSeconds();return 0!==e||0!==n||0!==o}))}(t)||(e=this.azb=tt(t[0],t[1]),o=(n=function(t){var e=0;return t.every((function(t){var n=t.getDate();return e||(e=n),e===n}))?e:0}(t))>0,r=t.length,i=!0,this.bzb=n,o&&r>2&&(i=et(t,e)),a=o&&i),a},e.prototype.getTargetValue=function(t,e){var n=t.Oyb[0],o=n.getFullYear(),r=e-1,i=n.getMonth()+this.azb*r,a=o+parseInt(i/12,10);return new Date(a,i%12,this.bzb)},e}(E),F=function(t){function e(){var e=t.call(this)||this;return e.Yyb=c,e.Pyb=[],e.Qyb=c,e.$yb=!1,e.Zyb=0,e.Nc=S,e.t_=!1,e.czb=!1,e.dzb=new M,e}return W(e,t),e.prototype.resetProp=function(){this.Pyb=[],this.Zyb=0,this.Qyb=c,this.$yb=!1,this.t_=!1,this.czb=!1},e.prototype.getInternal=function(t){var e,n,o=!1,r=t[0];for(n=1;n<t.length;n++)if(e=t[n],1!==Math.abs(e-r)){o=!0;break}return o},e}(N),P=function(t){function e(e){var n=t.call(this)||this;return n.ezb=new k(e),n}return W(e,t),e.prototype.dispose=function(){var t=this;t.ezb&&(t.ezb.no(),t.ezb=c)},e.prototype.match=function(t){return this.ezb.Vyb(t)},e.prototype.getTargetValue=function(t,e,n,o,r){var i,a=t.Oyb.length,s=this._yb(n,o),l=c;return-1!==s&&(i=a*r+s+1,l=this.ezb.ge(i)),l},e}(F),_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Yyb=/^\d+$/,e}return W(e,t),e.prototype.match=function(t){var e,n,o=this;return t.every((function(t){return!!t.match(o.Yyb)&&((n=t.length)>o.Zyb&&nt(t)&&(o.Zyb=n),e=parseInt(t,10),o.Pyb.push(e),!0)}))},e.prototype.getTargetValue=function(t,e,n,o,r){var i,a=t.Oyb,s=this.dzb,l=J(this.Pyb),u=a.length,f=0!==l,h=f?0:$(e,u),p=this._yb(n,o),d=c;return this.t_=f,this.czb=this.getInternal(t.e_),-1!==p&&(s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=K(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},e}(F),L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Yyb=/^(.*\D+)(\d+)$/,e}return W(e,t),e.prototype.match=function(t){return ot(this,t,!1)},e.prototype.getTargetValue=function(t,e,n,o,r){var i,a=t.Oyb,s=this.dzb,l=J(this.Pyb),u=a.length,f=0!==l,h=f?0:$(e,u),p=this._yb(n,o),d=c;return this.t_=f,this.czb=this.getInternal(t.e_),-1!==p&&(s.Uk=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=K(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},e}(F),B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Yyb=/^(\d+)(\D+.*)$/,e}return W(e,t),e.prototype.match=function(t){return ot(this,t,!0)},e.prototype.getTargetValue=function(t,e,n,o,r){var i,a=t.Oyb,s=this.dzb,l=J(this.Pyb),u=a.length,f=0!==l,h=f?0:$(e,u),p=this._yb(n,o),d=c;return this.t_=f,this.czb=this.getInternal(t.e_),-1!==p&&(s.Wyb=this.Qyb,s.Tyb=l,s.Xyb=this.Pyb[h],s._padding=K(this.Zyb),i=u*r+p+1,d=s.ge(i)),d},e}(F),G=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return W(e,t),e.prototype.getTargetValue=function(t,e,n){return Z(!0,t.j_(),n,e)},e}(N),H=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.t_=!0,e}return W(e,t),e.prototype.getTargetValue=function(t,e,n,o){var r=t.Oyb;return r[$(e,r.length)]},e}(N),V=function(){function t(t){this.fzb=[new D,new O,new j],this.gzb=[new P(t),new _,new L,new B],this.hzb=new G,this.izb=new H}return t.prototype.getRule=function(t,e){var n,o,r,i=[],a=this.izb;for(t===x?(i=this.fzb,a=this.hzb):t===S?i=this.gzb:t===T&&(a=this.hzb),n=0;n<i.length;n++)if(r=void 0,(o=i[n]).resetProp(),o.match(e)){if(r=o.$yb,d(r)||!1===r)return o;if(!0===r)return a}return a},t.prototype.no=function(){var t=this;t.fzb&&(rt(t.fzb),t.fzb=c),t.gzb&&(rt(t.gzb),t.gzb=c),t.hzb&&(t.hzb.dispose(),t.hzb=c),t.izb&&(t.izb.dispose(),t.izb=c)},t}(),e.Gyb=V,z=function(){function t(t){this.kj=t,this.AX=!1,this.cLb=[]}return t.prototype.D$=function(t,e,n,o,r){var i=t?1:2;d(o)&&d(r)?this.E$(e,n,i):this.E$(e,n,i,o,r,c)},t.prototype.E$=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,C,b,w,T,x,S,A=this,R=A.kj,k=R.Tq(t),M=k.row,N=k.col,E=k.rowCount,D=k.colCount;if(R.ITa.MTa(M,N,E,D))throw Error(I().Exp_RangeContainsMergedCell);for(h=0,d=(p=1===e)?D:E,g=p?M:N,m=p?M+E:N+D,y=(f=arguments.length>3)?1:d,b=(C=this.kj.mm.A$).row===M&&C.rowCount===E&&C.col>N||C.col===N&&C.colCount===D&&C.row>M,a=g;a<m;a++)if(w=b&&f?N+D-1:N,T=b&&f?M+E-1:M,(x=p?A.l_(a,w,1,y,e):A.l_(T,a,y,1,e))&&x.h_())for(u=x.e_[0],f?(c=b?x.f_[v(x.f_)-1]:x.f_[0],s=A.m_(b,c,d,n,o,r,i),b&&(h=d-v(s),u=x.e_[v(x.e_)-1])):s=A.n_(x,d,n),l=0;l<v(s);l++)S=x.k_(s[l]),p?A.o_(R,a,u,a,N+h+l,S,n):A.o_(R,u,a,M+h+l,a,S,n)},t.prototype.l_=function(t,e,n,o,r){for(var i,a=c,s=this.kj,l=1===r,u=l?e+o-1:t+n-1,f=l?e:t;u>=f;)U(i=l?s.getValue(t,u):s.getValue(u,e))&&(a||(a=new R(f)),a.Eb(0,u,i)),u--;return a},t.prototype.m_=function(t,e,n,o,r,i,a){var s,l,u,c=[],f=e,h=r>=0,p=d(i);for(s=0;s<n;s++)l=f>=i,u=f<=i,t&&(p||h&&l||!h&&u)?(c.unshift(f),1===o?f-=r:2===o?f/=r:3!==o||d(a)||(f=this.p_(!0,a,e,f,r,s+1))):!t&&(p||h&&u||!h&&l)&&(c.push(f),1===o?f+=r:2===o?f*=r:3!==o||d(a)||(f=this.p_(!1,a,e,f,r,s+1)));return c},t.prototype.n_=function(t,e,n){var o,r=[],i=1===n;if(i||2===n){for(1===t.h_()&&t.Sb(t.e_[0]+1,i?t.k_(t.f_[0]+1):t.Ey()[0]),o=0;o<e;o++)r.push(Z(!!i,t.j_(),t.i_(),o+1));return r}return c},t.prototype.B$=function(t,e,n,o,r){var i=this.kj,a=i.ITa,s=i.Tq(t),l=s.row,u=s.col,c=s.rowCount,f=s.colCount,h=i.Tq(i.mm.A$),p=h.row,d=h.col;if(a.qu(p,d,h.rowCount,h.colCount)||a.qu(l,u,c,f))throw Error(I().Exp_ChangeMergedCell);return this.q_(h,c,f,e,n,!(l<p||u<d),o,r)},t.prototype.q_=function(t,e,n,o,r,i,a,s){var l,u,d,g,m=this,y=i?1:-1,v=t.row,C=t.col,b=t.rowCount,w=t.colCount;if(1===o){if(l=h(n/w),u=n%w,!r)for(g=1;g<l;g++)d=p(v,C+g*y*w,b,w),m.r_(t,d,o,4,r,i,f,f,f,a,s);if(r&&l>1&&0===u&&(l-=1,u=w),l>0&&u>0)return d=p(v,i?C+l*w:C-l*w+w-u,b,u),m.r_(t,d,o,4,r,i,c,i?0:w-u,f,a,s)}else{if(l=h(e/b),u=e%b,m.AX||(d=p(v+y*b,C,e-b,n),m.dLb(t,d,y)),!r)for(g=1;g<l;g++)d=p(v+g*y*b,C,b,w),m.r_(t,d,o,4,r,i,c,c,!0,a,s);if(r&&l>1&&0===u&&(l-=1,u=b),l>0&&u>0)return d=p(i?v+l*b:v-l*b+b-u,C,u,w),m.r_(t,d,o,4,r,i,i?0:b-u,c,!0,a,s)}},t.prototype.r_=function(t,e,n,o,r,i,a,s,l,u,f){var h,p,g,m,y,v,C,b,w,A,I,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,Y,X,Z,Q,J,$=this,K=$.kj,tt=1===n,et=tt?t.row:t.col,nt=tt?t.col:t.row,ot=tt?e.row:e.col,rt=tt?e.col:e.row,it=tt?t.rowCount:t.colCount,at=tt?t.colCount:t.rowCount,st=tt?e.colCount:e.rowCount;for(m=0;m<it;m++){for(v=c,C=c,b=0,I=w=et+m,k=A=ot+m,M=(tt?s:a)||0,N=tt?0:M,E=tt?c:l,D=c;b<at;)if(F=c,P=O=nt+b,_=j=rt+b-M,tt||(w=O,O=I,A=j,j=k),g=K.ITa.findSpan(w,O),(h=K.getFormula&&K.getFormula(w,O))&&""!==h||(F=K.getValue(w,O)),(L=$.AX)&&d(D)&&(D=!1===i?K.getValue(nt+at-1,O):K.getValue(w,O)),L||4!==o||!U(F)&&!q(F)||(v||(v=new R),p=U(F)?F instanceof Date?x:T:S,C||(C=p),C!==p))if(!L&&F&&v&&v.h_()){if(y=$.s_(tt,t,e,I,k,v,r,i,N,E,u,f),r&&y)return y;v=c,C=c}else{if(L||!g||g&&(tt?g.row:g.col)===I)if(B=_===rt+st-1,G=L?D:F,r){if(L)return G;if(g&&B||!g&&(B&&i||!i&&_===rt))return F}else _<rt+st&&_>=rt&&(L||tt||!tt&&!(l&&K.Ps&&K.Ps(_)))&&(L&&-1!==$.cLb.indexOf(A)||$.o_(K,w,O,A,j,G,o,u,f));g?b+=tt?g.colCount:g.rowCount:b++}else v.Sb(P,F),g?b+=tt?g.colCount:g.rowCount:b++;if($.AX)for(H=t.row,V=t.col,z=t.rowCount,W=t.colCount,Y=void 0,X=void 0,Z=!1===i?-1:1,Q=1;Q<z;Q++)for(Y=H+Z*Q,J=0;J<W;)X=V+J,-1===$.cLb.indexOf(Y)&&$.o_(K,H,V,Y,X,D,o,u,f),J++;if(v&&v.h_()&&(y=$.s_(tt,t,e,I,k,v,r,i,N,E,u,f),r&&!d(y)))return y}return c},t.prototype.dLb=function(t,e,n){var o,r,i,a,s,l,u,c=this,f=c.kj,h=f.tables,p=t.union(e),d=p.row,g=p.rowCount,m=t.row,y=t.col,v=t.rowCount,C=t.colCount;if(h)for(o=h.s$(m,y,v,C),r=0;r<o.length;r++)if(i=o[r].xr,a=c.cLb,s=void 0,i&&i.isFiltered&&i.isFiltered()){for(l=0;l<g;l++)s=d+n*l,i.isRowFilteredOut(s)&&c.cLb.push(s);if(a.length>0){c.AX=!0;break}}if(u=f.xr,!0!==c.AX&&u&&u.isFiltered&&u.isFiltered()){for(a=c.cLb,s=void 0,l=0;l<g;l++)s=d+n*l,u.isRowFilteredOut(s)&&c.cLb.push(s);a.length>0&&(c.AX=!0)}},t.prototype.o_=function(t,e,n,o,r,i,s,u,f){var h,p,d,g=t.ITa;l&&(t.hasFormula(e,n)||t.hasFormula(o,r))&&(t.setFormula(o,r,c),0!==s&&4!==s||(h=t.Bj(),t.getFormula(e,n)&&a.CalcOperatorAdjustor.copyFormula(h,e,n,h,o,r,1,1))),t.setValue(o,r,i),d=f?0:64,u&&(d|=128),d|=1024,t.copyTo(e,n,o,r,1,1,d),t.removeSpan(o,r,3),(p=g.findSpan(e,n))&&e===p.row&&n===p.col&&t.Sq(o,r,p.rowCount,p.colCount,3)},t.prototype.s_=function(t,e,n,o,r,i,a,s,l,u,f,h){var p,d,g,m,y,v,C,b,w,T,A,I,R,k,M,N,E=this,D=E.kj,O=t?n.col:n.row,j=t?e.col:e.row,F=t?n.colCount:n.rowCount,P=t?e.colCount:e.rowCount;if(l=l||0,y=i.h_(),v=(O-j-l)/P,C=E.t_(i.e_,i.f_),b=i.Nc,C){for(g=[],d=0;d<y;d++)g[d]=d+1;p=y}else m=i.e_[0],p=i.e_[y-1]-m+1,1===y&&b!==S&&i.Sb(i.e_[0]+1,i.k_(i.f_[0]+1)),g=i.i_();for(d=0;d<p;d++)if(w=i.Oyb,T=void 0,A=void 0,I=void 0,b!==x&&b!==S||(T=D.Fyb&&D.Fyb.getRule(b,w)),T?(A=T.getTargetValue(i,p*v+d+1,g,d,v),C=T.t_?T.t_:C,R=!!T.czb&&T.czb,I=C&&!R):(A=Z(!0,i.j_(),g,p*v+d+1),I=C),k=O+F-1,N=(M=I?i.e_[d]:m+d)+v*P,a){if(C&&(s&&N===k||!s&&N===O)||!C&&N+l===k)return i.k_(A)}else N<O+F&&N>=O&&(t?E.o_(D,o,M,r,N,i.k_(A),4,f,h):u&&D.Ps&&D.Ps(N)||E.o_(D,M,o,N,r,i.k_(A),4,f,h));return c},t.prototype.t_=function(t,e){var n,o,r,i=v(e);if(i<=1||v(t)!==i)return!1;for(n=t[1]-t[0],o=e[1]-e[0],r=2;r<i;r++)if(t[r]-t[r-1]!==n||e[r]-e[r-1]!==o)return!1;return!0},t.prototype.C$=function(t,e){var n,o=this.kj,r=o.ITa.getSpans(),i=o.Tq(t),a=i.row,s=i.col,l=i.rowCount,u=i.colCount;n=0===e?p(a,s+u-1,l,1):1===e?p(a,s,l,1):p(2===e?a+l-1:a,s,1,u),(n=o.su(r,n))&&this.u_(n,a,s,l,u,e)},t.prototype.u_=function(t,e,n,o,r,i){var a,s,l,u,c,f,d,g,m=t.row,y=t.col,v=t.rowCount,C=t.colCount,b=this.kj.ITa;if(0===i?(g=b.MTa(e,n,o,r-C),f=0,d=-1*C,l=r,u=C,c=1):1===i?(g=b.MTa(e,n+C,o,r-C),f=0,d=C,l=r,u=C,c=1):2===i?(g=b.MTa(e,n,o-v,r),f=-1*v,d=0,l=o,u=v,c=0):(g=b.MTa(e+v,n,o-v,r),f=v,d=0,l=o,u=v,c=0),g)throw Error(I().Exp_TargetContainsMergedCells);if(l%u!=0)throw Error(I().Exp_MergedCellsIdentical);for(a=h(l/u),s=1;s<a;s++)this.r_(t,p(m+s*f,y+s*d,v,C),c,0)},t.prototype.p_=function(t,e,n,o,r,i){var a=t?-1:1,s=h(i*r),l=Math.abs(r),u=w(e>1?n:o);if(0===e)u.setDate(u.getDate()+a*r);else if(1===e)for(;l>0;)u.setDate(u.getDate()+a*(r>0?1:-1)),6!==u.getDay()&&0!==u.getDay()&&l--;else 2===e?u.setMonth(u.getMonth()+a*s):u.setFullYear(u.getFullYear()+a*s);return b(u)},t}(),e.z$=z},"./dist/plugins/fill/fill.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/fill/fill.res.en.js");e.SR={en:o}},"./dist/plugins/fill/fill.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CopyCells="Copy Cells",e.FillSeries="Fill Series",e.FillFormattingOnly="Fill Formatting Only",e.FillWithoutFormatting="Fill Without Formatting",e.Exp_NumberOnly="Only works for Numbers",e.Exp_RangeContainsMergedCell="Range should not have merged cells.",e.Exp_TargetContainsMergedCells="Target range should not have merged cells.",e.Exp_MergedCellsIdentical="This operation requires the merged cells to be identically sized.",e.Exp_FillRangeContainsMergedCell="Cannot fill range that contains a merged cell.",e.Exp_FillCellsReadOnly="The cells you are trying to fill are protected and therefore read-only.",e.Exp_ChangeMergedCell="Cannot change part of merged cell.",e.Exp_ColumnReadOnly="The column you are trying to change is protected and therefore read-only.",e.Exp_RowReadOnly="The row you are trying to change is protected and therefore read-only.",e.Exp_CellReadOnly="The cell you are trying to change is protected and therefore read-only.",e.Exp_RangeIsNull="range is null",e.Exp_ChangePartOfArray="Cannot change part of an array."},"./dist/plugins/filter/filter-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function M(t,e){var n,o;return t?(o=e.tables.findByName(t))&&(n=o.rowFilter()):n=e.rowFilter(),n}function N(t,e,n,o,r){return{sheet:t,sheetName:t.name(),table:e,tableCol:n,filterValues:o,conditionInfo:0===y(o)&&r?r.toJSON():v}}function E(t,e,n,o){return{sheet:t,sheetName:t.name(),col:e,filterValues:n,conditionInfo:0===y(n)&&o?o.toJSON():v}}function D(t,e,n,o,i){var a=n?t-n.range().col:-1;n?e.Wq(r.Events.TableFiltering,N(e,n,a,o,i)):e.Wq(r.Events.RangeFiltering,E(e,t,o,i))}function O(t,e,n,o,i,a){var s=o?e-o.range().col:-1;t.filter(e),o?n.Wq(r.Events.TableFiltered,N(n,o,s,i,a)):n.Wq(r.Events.RangeFiltered,E(n,e,i,a))}function j(t,e){t.suspendPaint();var n=r.Commands.bWa(t.name());return t.ITa.undo(e[n]),t.resumePaint(),!0}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/filter/filter-ns.js"),r=n("Core"),i=n("Common"),a=n("./dist/plugins/filter/filter.js"),s=n("ConditionalFormatting"),l=i.Common.j.Fa,i.Common.j.Ba,u=r.Commands.ActionBase,c="sortFilter",f="filterTextSelectAction",h="filterByCondition",p="clearFilter",d="contextmenuFilterForSheet",g="contextmenuFilterForTable",m=r.Commands.h4,y=i.Common.k.ac,v=void 0,C=null,b=new i.Common.ResourceManager(o.SR),w=b.getResource.bind(b),T=function(t){function e(e,n){var o=t.call(this,e,n)||this,r=o;return r.zZ=r.VQ.cmdOption,r.zZ.rowFilter=M(r.zZ.tableName,r.kj),o}return k(e,t),e.prototype.execute=function(){var t,e=this,n=e.zZ.rowFilter,o=e.zZ.colIndex,i=e.zZ.compareFunction,a=e.zZ.isAsc,s=!l(e.zZ.tableName),u=e.zZ.color,c=e.zZ.isBackColor,f={groupSort:e.zZ.groupSort,ignoreHidden:e.zZ.ignoreHidden};e.kj.suspendPaint(),e.kj.ITa.startTransaction();try{u!==v?n.sortColumnByColor(o,a,u,c,f,s):n.eLb(o,a,i,f,s)}finally{t=r.Commands.bWa(e.kj.name()),e.VQ[t]=e.kj.ITa.endTransaction(),e.kj.resumePaint()}},e.prototype.undo=function(){return j(this.kj,this.VQ)},e}(u),r.Commands[c]={canUndo:!0,execute:function(t,e,n){return m(t,T,e,n)}},x=function(t){function e(e,n){var o=t.call(this,e,n)||this,r=o;return r.zZ=r.VQ.cmdOption,o}return k(e,t),e.prototype.execute=function(){var t,e,n=this,o=n.zZ.colIndex,i=n.VQ.cmdOption.tableName,a=M(i,n.kj);a&&(i&&(t=n.kj.tables.findByName(i)),n.kj.suspendPaint(),n.kj.ITa.startTransaction(),function(t,e,n){var o,i;n?(i=t-n.range().col,o={sheet:e,sheetName:e.name(),table:n,tableCol:i},e.Wq(r.Events.TableFilterClearing,o)):(o={sheet:e,sheetName:e.name(),col:t},e.Wq(r.Events.RangeFilterClearing,o))}(o,n.kj,t),a.removeFilterItems(o),function(t,e,n){var o,i;n?(i=t-n.range().col,o={sheet:e,sheetName:e.name(),table:n,tableCol:i},e.Wq(r.Events.TableFilterCleared,o)):(o={sheet:e,sheetName:e.name(),col:t},e.Wq(r.Events.RangeFilterCleared,o))}(o,n.kj,t),e=r.Commands.bWa(n.kj.name()),n.VQ[e]=n.kj.ITa.endTransaction(),n.kj.resumePaint())},e.prototype.undo=function(){return j(this.kj,this.VQ)},e}(u),r.Commands[p]={canUndo:!0,execute:function(t,e,n){return m(t,x,e,n)}},S=function(t){function e(e,n){return t.call(this,e,n)||this}return k(e,t),e.prototype.execute=function(){var t,e,n,o,i,a,l,u,c,f=this,h=f.VQ.cmdOption.colIndex,p=f.VQ.cmdOption.checkedValues,d=f.VQ.cmdOption.allValuesLength,g=y(p),m=w().Blanks,v=f.VQ.cmdOption.tableName,b=f.kj,T=M(v,b);if(T){if(v&&(t=b.tables.findByName(v)),b.suspendPaint(),b.ITa.startTransaction(),D(h,b,t,p,C),T.removeFilterItems(h),g!==d){for(e=[],n=0;n<g;n++)i=void 0,a=(o=p[n]).text,l=o.value,u=o.type,a===m&&(a=""),(i=new s.Condition(2))._ps.expected=a,i._ps.compareType=0,i._ps.useWildCards=!1,"date"===u&&(i.jzb=!0,i.Ygc=l),e.push(i);T.addFilterItem(h,e)}O(T,h,b,t,p,C),c=r.Commands.bWa(b.name()),f.VQ[c]=b.ITa.endTransaction(),b.resumePaint()}},e.prototype.undo=function(){return j(this.kj,this.VQ)},e}(u),r.Commands[f]={canUndo:!0,execute:function(t,e,n){return m(t,S,e,n)}},A=function(t){function e(e,n){return t.call(this,e,n)||this}return k(e,t),e.prototype.execute=function(){var t,e,n=this,o=n.VQ.cmdOption.colIndex,i=n.VQ.cmdOption.condition,a=n.VQ.cmdOption.tableName,s=M(a,n.kj);s&&(a&&(t=n.kj.tables.findByName(a)),n.kj.suspendPaint(),n.kj.ITa.startTransaction(),D(o,n.kj,t,[],i),s.removeFilterItems(o),s.addFilterItem(o,i),O(s,o,n.kj,t,[],i),e=r.Commands.bWa(n.kj.name()),n.VQ[e]=n.kj.ITa.endTransaction(),n.kj.resumePaint())},e.prototype.undo=function(){return j(this.kj,this.VQ)},e}(u),r.Commands[h]={canUndo:!0,execute:function(t,e,n){return m(t,A,e,n)}},I=function(t){function e(e,n){return t.call(this,e,n)||this}return k(e,t),e.prototype.execute=function(){var t,e,n,o,i,u=this.kj,c=this.VQ.cmdOption,f=c.selection,h=c.activeRow,p=c.activeCol,d=c.expectedText;u.ITa.startTransaction(),u.rowFilter()?(t=void 0,(n=(e=u.rowFilter()).range).contains(h,p,1,1)?(D(p,u,v,[d],C),t=new s.Condition(s.ConditionType.textCondition,{compareType:0,expected:d}),e.addFilterItem(p,t),O(e,p,u,v,[d],C)):n.row-1!==h||l(e.qZ[p])?(u.rowFilter().unfilter(),u.rowFilter(new a.HideRowFilter(f))):(o=u.getText(n.row,p),D(p,u,v,[d],C),t=new s.Condition(s.ConditionType.textCondition,{compareType:0,expected:o}),e.addFilterItem(p,t),O(e,p,u,v,[d],C))):u.rowFilter(new a.HideRowFilter(f)),i=r.Commands.bWa(u.name()),this.VQ[i]=u.ITa.endTransaction()},e.prototype.undo=function(){return j(this.kj,this.VQ)},e}(u),r.Commands[d]={canUndo:!0,execute:function(t,e,n){return m(t,I,e,n)}},R=function(t){function e(e,n){return t.call(this,e,n)||this}return k(e,t),e.prototype.execute=function(){var t,e,n,o,i,a=this.kj,u=this.VQ.cmdOption,c=u.tableName,f=u.expectedText,h=u.activeCol,p=u.activeRow;a.ITa.startTransaction(),t=M(c,a),e=a.tables.findByName(c),t&&e&&(n=e.range(),e.showHeader()&&n.row===p&&!l(t.qZ[h-n.col])&&(f=a.getText(p+1,h)),D(h,a,v,[f],C),o=new s.Condition(s.ConditionType.textCondition,{compareType:0,expected:f}),t.removeFilterItems(h),t.addFilterItem(h,o),O(t,h,a,v,[f],C),i=r.Commands.bWa(a.name()),this.VQ[i]=a.ITa.endTransaction())},e.prototype.undo=function(){return j(this.kj,this.VQ)},e}(u),r.Commands[g]={canUndo:!0,execute:function(t,e,n){return m(t,R,e,n)}},r.Commands.fVa=function(t){t.register(c,r.Commands[c]),t.register(f,r.Commands[f]),t.register(h,r.Commands[h]),t.register(p,r.Commands[p]),t.register(d,r.Commands[d]),t.register(g,r.Commands[g])}},"./dist/plugins/filter/filter-button-images.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c";e.getFilterButtonImageSrc=function(t){return 0===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg==":1===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAALLSURBVHjadJNtaNVlGMav+/kfjy3GTDfcsQW1CMrhWSZ6AsmXmflFDts5/0eYA52i02M6tdBIRQQJBLX8Yg4xYlMEJaHphzxKzoiaZptN0MBtacyXoYIobUgT/fXhtOMS+vBw89wXXPfLdd0CLNxwyACF648YYH7tnuEYAeQbv3CA/EeHBcivazbAUo1fv6hwfYtJEjDy2XP//8vpGbA9ZiE7xQ6USs3S7sUx9YHNbMqYn1IerGmQ3pr8uYXsNUAqnZ+LvqHJAA2BeIoGT6DJbMqBbAwArR77vs4/uhOje9BxlXEcww13pXDvtwaoes1MB6iz8xfxGkIIiLCUIEXaDTxiFJOmKp5YxDcciS6jVpRi8g1H87PVgLYslwO0GYzf+x377ubwXoLKafXEE/WUTfC9tBIhwNTJdAPkw4R1fdkkOmJW1/LAYNBV54iDJK8HH7NPd+/9MTqeWER//62YHxrrJvCDydd99Z/tpjLboz7znQF2/vSfufwY9Ne1e9r9JtHKaUvxqWY3UgXX23dNbccOlhQUFxUN9GweVsaWIQNZRfkeByidrnDxRD19N29U5AnChkMO0BMYAwRA4GkPAKuZc/2F8JWTDlB716sCIm9PXcz1K9+/lCc4erstABQmP3U8LBvlV2VJr8yyIHMSv+LUk1QmCzADBjQnrB0dT9TT0/243NfqXx8szwaAzq6Q1bDJnWnrmlKV3EZVchvvJbfQ2nqmDLDqD0/YXFqs8t0l/Haxu3j+vOPDO9ifu4P9jwPAeSk6RE/RpHc+4KefL8waYWEDrOPX9ol/cycA1KH7pvCTsxFAPxZGXQ1YmDhlgNIHsoWQd5wONw4JxgfhwmeKXSUjXbq0Oi/j80el28UjqpdqK1ivcCB7KJwXTuHKcwWAPtPCoJkShy7kjKU3dIXLAvQyVdq1C3WVXNbE2RgUOphuqVXH3T8DAFTcPgRQEEuLAAAAAElFTkSuQmCC":2===t?o+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAJKSURBVHjanJJfSJNhFMaf9/02R9MFCVZLUOgfpLMCmwrd7KIIm6X4fXoTY1oXltaN86oEi4xodtNNeNMHJZQ0gpDQmUKEyUAiyKCFW4PNtSFMoyKJSp4uputbJIUX5+K855zfe85zDkhiza4u2+HXn4M64dcBvw5BTotLtyDJ49KvI2fapK/Q/8qkwAjYiEHj4rrBG+ft4p+AB51f8pKazxxDY/djhLYj95bJLKG5fR+w5whUVxNUtR6qOiHUrmABNH3AkgcoqsBM11O56gvVUy2GV6CQNA/WjFdkMpnyhYV0NjZOAf6ksQMZCGQL3e526fUWm0kKrlAJRT7CUXeac+Gp3bRTaJpHXsReoLl3yGQAKPUtlaJh8yHxKI0s+C3xLHHXwjIqlbXtTKc/lKTScaRSFItMAWReB4WtdfdMJCVJTI18xihLNzFCyWXC4WxjMpksjiOK5BytjXIGUH0XCowjkFsESeF27BQLSy9F/2FK0ip6wa2VtV7OxxNF8XgciUQCKpMCZFoaRdQ6PXIHshvQDtACUJDARA/tVTVe6rHrSs97mMPh16j3vQECvpKc4iSLWzrGqXWMrahnx6h1jP5oPRf8Ho1FLA5nG/c7vayq8TIajdoikRi0nqCEdn9gDaCQLNVOXZOuk310nbhCV0Mvhx+OWlbhykGnh+Hou20sy2rUdLtbAJxUfs9PwW9PQM4qjuqjfDEd6ssX+VP56kdZ/+s80H9nZJcBYDxT6x8b+vspDw4Fbf+TuC7gpn7ZtoFCSdJE0vxrAN8Jcr/DWZzEAAAAAElFTkSuQmCC":3===t?o+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMuSURBVHjaZJN/aNR1GMefz+f7/d6P3aZGDGVKERLDbXdMJAQhlr+ujWo62g5DpUBiEyJjpxi0ZRtyDSQvV0cDd2uw213b1EHiFjbGZq5bIbc5dTuyybRyK+ZCDrG0evWHdwfWHx8+PDwPz/vzeb2fR451DGvpQB2ODJvnP24zDkewD7Zct6h9qD1j4TzPWNgsip80isbCxuS7vzinGm5aZwcwbwVPGoAhgAIEsAAN2NKxSscmYKRvE1iRPrY3Vt7Ski4WQKaJOmbjyF3WS//3jfr4hVXGEA55J5aXc+ZMdF0yOZWbFtCAKtx5zCUQLQBk32svPFJ8eHN16u+fCn6fv+MErKWlRWdvPzr9QpUVnIroxravlYz0tTvWdi9XRFGA6ugKOMPh7qHu7u5Ue3s7ra2tBIMnaG4+Sl1dHTU1NZSXl7P42x39zRxKYl82mYD8Q0wA8bjFmv855Xqzdu/swsICDx78xfz8r0xMXKa+/iBer5fx8W+PDi22PjH43pKSoi2bzIS+reVlUYCVn18q11hl9vb2GIFAgFQqxczMDKFQCK/Xy8WLF4ozkN2e00o8O07YA1KpxCUCyKYSUX1fxDQgc3NzRjAY/DMej+Pz+ejpiTkzAAEpqfpEJHeP2PZJXO32VBsbKryydY3IPZB1a3IVIH6/n1AoREVFBWmQjzknK7aLHm4bWXs5cel48uq0ziQGolE9e/uG8vsPceDttygrK8s2cBfkZ9zQ8syGbeaVyQmp3v8VNXWDvFo3SPX+8/hqzxEPjqiD9X5eqqoiN8fFjzeu5wHidh9xZTjIgZr1BqAaWi6Zm3e8z/OVDZS90kBv74AdUH7/IbZu3oJps0h8N7N62IXpLt2VnVbZWfKc+jTx+aM/3bti85RuZ3RsvBjQxFgWO9VnTSebzB+SMyvhtMMTFsv9+l4r26Czq0sxcV9F+3eprnOJwumr14ozpMMfnLV/duQjPdeDmiTiaGrutLs3Nhjujc86sxD/uHs/DxCPjFrbXly0N7ZEbR9GcPb0jz4NS/q/1P/nwlOFlYpOrZ4UkeUiOt8nRk6xyGNzT3YXTGBZeqEcgP53ACxeTBjELwuFAAAAAElFTkSuQmCC":4===t?o+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMNSURBVHjalJNfaFt1FMfP796bm9hublCwa93AVd3W5d67ddisFFw1lovUl7r0jx2rWWW6prpCkzfrUwjVFx0LwSrYPtiO0YJPDsuwIOJKq1PL0q43iZ3OuUp04p8owmbl40PXMgaCPnzhcPjCOef7PV8BxD6WETrKjXcviUbjTlW870/ta9mqfiqv1kuRQePjk68pkj4FSfX66HRA8ujfDPapvveWN4n1xKAC5H9CB3SRo767m9uhvRxQUGXAEXOt3uCodViWpT4Yi+tC1Rrhj99/luV8QQ43unrkxWaNVSqvXSNgHSeQSqU2A4Zt2xUdHR3bp6amwp8uTNU91jRgij2PAWg1da+sTwmeGTv768TExN8jIyOk0xlOnTpNMpkiFovR3t6O67rcuPHDJkCtr6U7zVH/gffPKrwravLzC75EIkGxWOTWrVWKxR+Zn79EPB7HdV3m5uYaAK12/xfmxm0P1uwW62D36p77nzdXVr4Txwn5h4aGVkqlEp6XJ5PJ4LouMzMzDYAGiPXkGwGJLGIAyqmPYod6sEM9vziRF0xALMvS0+n0zdnZWTo7O5mcnNwHaNevi27bqN0v+w1pWyj5AOUEjygn1I3VeLzaund/xfj4uAASi8WWM5kMLS0tAAYgV69+K5cvvyq/zZ7TpG1hzZaqbZbsDR3DPnSi2n6ka0uhUJB8Pt+QSCTo7++nqamJ204YXV1PG5aF2nFxUgn7PlGAWIefVXYoihVufcBWorLZrOTz+YMDAwN/tba2UlZWRi6Xq7itmQbb9JnU25qMvvmRAKrmoafEqY/edOqf2bljV/iebDYrgPT29q6Ew2FM06RQKFQMDw+L4ziabaP3nXwpIBy9oACVnBblHOh52N4Vqaxr7jYAFQwGty4uLm72PE/3PK8yt+QZuawnjgSN0TOiDj36nCmP9364pjiY1hJ67RX8F5dMBUjtW7Xav+Xh3PRnIiK6CF/qd/66886YHvW3Sfh8lQHfy11Z2MCegBgioknbCZQTPr1l71di/IcUqjsgLfHzvn8GACNDKumTxWELAAAAAElFTkSuQmCC":5===t?o+"fvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAANBSURBVHjaXJNfSGR1HMXP73fvdcYdo7Vy1KRlZ9DdnOvv5uTODK0s1mxDyKIYSRYoUwQikkgzPUS0RuW6QRCEuIiM/XuxNdiH6m17WnZFCMSHtjuOszONf0ZnGgW1iLbw9DBl0sPhy3k5HDjfD0h6w/VvSJJC8a5sOPeUYQ1TIjAuPOc+kN6Kae2JthodGBCVrSEdpmXAd8pJUrb2julgiWgJ9MMXABIXYADApQA0ACLc8Jjg9bAkKbhbD5LimDTgNQn15sc6SZD1onyPZIAUSyQOSS124oLzDxL7hwRJjaTIFbYcUJ5xB0lYp29oZ8+OypZnPhfvkXiHdGz8nHHs7++6e+vede6UiiiVio69vR2v1+2S5slqQRJ4XvdXkBS7O+uuUv43bO79UvPZp4nfr8/N/Tk7O8urVz9cu3x5zH6x76Xvuru7f+zq6joIhUKFYrHYSBJA4yVBUm5sbWPm15nqH1bvOpRScnBwcL1QKPD+/b+4vV3k0tIy4/E4I5EIFxcXu0nKckDwWUlSV6peqGCUW/mvJUmoNr82MTHBg4MD2rbNqakpRiIR3r59a5ykzOc3QBJob5txkZSbuQ00h/q5ub7htZSJ9NYmlDLF5OQkFxYW2NfXx/n5+YskhWk2G0p9IV5BXgDBAZ1k5Z07tx6wAlHmcjlHjrUim13D8vIaYrEYr12bZmdnJ0k6ygvVHi0GOD2SpHGPhApGmclkKjKZ15HJpHHzJrV4PM6RkRF2dHQwm83WeTweMTw8cCwA1YKkUwWjVMEofaFXeS99w1CksKwWIxaLsaenh1VVVUyn0yf8fmBoKCpIoqeBAr3n50DywdXVlWorEGUqufp0imnpM8eEaZpaPB5nOBymrutMpVKuM2dGdQvjGh+icfFxCCA0YJB0tKC9Mpn8qTKZhLSS0BOJUWmaprBtu8K2bW1lZeVR27alUq3SwpDBh2t1fAUN/eepkYfCOvW26/grWxNB6XukvYJJwgKE+c1zUs270TQdkmq4WeKtTwS+hETiCgUJafrb/89CWTU9/8JT9k2UnP7HN1Ag+OQV8Ps6Yb78vigj/a08ahGCaGzql/zIrbmhy/9IzAmSztMvzJz8ewAvdf7cUVI5hQAAAABJRU5ErkJggg==":6===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}},"./dist/plugins/filter/filter-dialog.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht,Vt,zt,Wt,Ut,qt,Yt,Xt,Zt,Qt,Jt,$t,Kt,te,ee,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function de(t){return typeof t===xt?JSON.stringify(t):r.Common.pc.bc(r.Common.pc.ec(t))}function ge(t,e,n,o){var r;try{if(n.suspendPaint(),!o)return;r={tableName:o.sj?o.sj.name():g,colIndex:t,condition:e},n.wu().execute({cmd:"filterByCondition",sheetName:n.name(),cmdOption:r})}finally{n.resumePaint()}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("ConditionalFormatting"),a=n("CellTypes"),s=n("./dist/plugins/filter/filter-button-images.js"),l=n("./dist/plugins/filter/filter-ns.js"),u=r.Common.CultureManager,c=r.Common.l,f=r.Common.j.Ba,h=r.Common.u.Ob,p=r.Common.u.Pb,d=null,g=void 0,m=o.Ul.Nl,y=o.Ul,v=r.Common.k.ac,C=y.nl,b="left",w="top",T="float",x="relative",S="gc-no-user-select",A="gc-filter-dialog-style",I="position",R="gc-ui-filter-subitem-item",k="gc-ui-filter-allDate-item",M="gc-filter-alldates-arrow",E="ui-state-hover ",N="gc-filter-item-hover",D="gc-filter-hover form-control well ui-state-hover gc-filter-item-hover",O="gc-filter-button-hover "+E,j="gc-filter-submenu-check",F="gc-filter-submenu-check-img",P="gc-filter-allDate-check-img",_="gc-filter-alldates-list",L="gc-filter-addDates-container",B="gc-filter-subMenu-wrap",G="top10_dialog",H="custom_dialog",V="gc-sub-color-sort",z="gc-sub-color-filter",W="automatic",U="gc-filter-dialog-color-title",q="gc-color-item",Y="color-checked-wrap",X="gc-color-item-list",Z="gc-filter-sort",Q="#86BFA0",J="#000000",$="#FFFFFF",K="border-box",tt="data-isCheck",et="inline-block",nt="content-box",ot="#top10-item",rt="#gc-color-dialog-selected",it="#gc-color-dialog-noFill",at="thin solid rgb(160,160,160)",st="data-checked",lt="gc-filter-dialog-close",ut="1px solid #c2c2c2",ct="gc-filter-top10-rank-illegal",ft="1px solid #e0e0e0",ht="data-isNeedDialog",pt="data-isCustom",dt="data-conditionType",gt="data-operatorType",mt="data-colIndex",yt="data-colorType",vt="data-color",Ct="<div class=",bt="<span class=",wt="<img class=",Tt="<li class=",xt="object",St="</span><span>",At="</div></div>",It="display",Rt="box-sizing",kt="none",Mt="width",Nt="height",Et="padding",Dt="border",Ot="click",jt="mouseover",Ft="mouseout",Pt="inherit",_t="backgroundColor",Lt="#f0f0f0",Bt="margin",Gt=Bt+"Top",Ht=Bt+"Right",Vt="font-size",zt=[[1,"Equal","E",1,0],[1,"NotEqual","N",1,1],[1,"GreaterThan","G",1,2],[1,"GreaterOrEquals","O",1,3],[1,"LessThan","L",1,4],[1,"LessThanOrEquals","Q",1,5],[1,"Between","W",0,1],[1,"Top10","T",8,0],[0,"AboveAverage","A",10,0],[0,"BelowAverage","O",10,1],[1,"Custom","F",1,0]],Wt=[[1,"Equal","E",2,0],[1,"NotEqual","N",2,1],[1,"Begin","I",2,2],[1,"End","T",2,4],[1,"Contain","A",2,6],[1,"NotContain","D",2,7],[1,"Custom","F",2,0]],Ut=[[1,"Equal","E",5,0],[1,"Before","B",5,2],[1,"After","A",5,4],[1,"Between","W",0,1],[0,"Tomorrow","T",6,2],[0,"Today","O",6,0],[0,"Yesterday","D",6,1],[0,"NextWeek","K",6,9],[0,"ThisWeek","H",6,7],[0,"LastWeek","L",6,8],[0,"NextMonth","M",6,6],[0,"ThisMonth","S",6,4],[0,"LastMonth","N",6,5],[0,"NextQuarter","N",6,10],[0,"ThisQuarter","N",6,11],[0,"LastQuarter","N",6,12],[0,"NextYear","N",6,13],[0,"ThisYear","N",6,14],[0,"LastYear","N",6,15],[0,"YearToDate","A",6,0,6],[0,"AllDates","P",6,1],[1,"Custom","F",6,0]],Jt=[["Q1","1",6,0,2],["Q2","B",6,1,2],["Q3","A",6,2,2],["Q4","4",6,3,2],["Jan","J",6,0,3],["Feb","F",6,1,3],["Mar","M",6,2,3],["Apr","A",6,3,3],["May","Y",6,4,3],["Jun","U",6,5,3],["Jul","L",6,6,3],["Aug","T",6,7,3],["Sep","S",6,8,3],["Oct","O",6,9,3],["Nov","N",6,10,3],["Dec","D",6,11,3]],$t=["IsEquals-0-1","NotEquals-1-11","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",qt="IsBeginWith-2-2","NotBeginWith-3-2",Yt="IsEndWith-4-2",Xt="NotEndWith-5-2",Zt="IsContain-6-2",Qt="NotContains-7-2"],Kt=["IsEquals-0-2","NotEquals-1-11","IsGreaterThan-2-1","IsGreaterOrEqual-3-1","IsLess-4-1","LessOrEqual-5-1",qt,"NotBeginWith-3-2",Yt,Xt,Zt,Qt],te=["IsEquals-0-5","NotEquals-1-5","IsAfter-4-5","AfterOrEqual-5-5","IsBefore-2-5","BeforeOrEqual-3-5",qt,"NotBeginWith-4-2",Yt,Xt,Zt,Qt],ee=new r.Common.ResourceManager(l.SR),ne=ee.getResource.bind(ee),ie=function(t){function e(e,n,o,r,i,a){var s=t.call(this,e,n,o,r,i,a)||this;return s.SXa=zt,s}return pe(e,t),e.prototype.OXa=function(){this.WXa(this.SXa)},e}(re=function(t){function e(e,n,o,r,i,a){return t.call(this,e,n,o,r,i,a)||this}return pe(e,t),e.prototype.yl=function(t){this.OXa()},e.prototype.LXa=function(){var t=this;t.JXa.bind(jt,(function(t){C(t)})).bind(Ft,(function(t){C(t)})),o.GC$("."+R,t.JXa[0]).bind(jt,(function(t){o.GC$("."+R).removeClass(D),o.GC$(this).addClass(D),C(t)})).bind(Ft,(function(t){o.GC$(this).removeClass(D),C(t)})).bind(Ot,(function(e){o.GC$(this).attr("id")!==L&&t.PXa(o.GC$(this)),C(e)})),this.QXa&&this.QXa()},e.prototype.r$a=function(t){return t!==g&&"TRUE"===t||"FALSE"===t},e.prototype.RXa=function(){var t,e,n,r,i,a,s,l,u,c,f,h,p=this.xr.rZ[this.HXa.col],d=this.SXa,m=!1;if(p&&p.length>0)for(a=(p=p[0]).compareType(),s=p.expected(),r=p.expectTypeId(),10===(i=p.conType())&&(a=p.type()),8===i&&(a=0),this.r$a(s)&&(i=11),0===i&&(l=p.item1().compareType(),u=p.item2().compareType(),5===Math.max(l,u)&&3===Math.min(l,u)&&(m=!0)),c=0,f=v(d);c<f;c++){if((e=0===i&&d[c][3]===i&&m||d[c][3]===i&&0!==i||11===i&&(1===d[c][3]||2===d[c][3]))&&8===i){t=c;break}if(n=d[c][4]===a&&!m||6===d[c][3]&&s===d[c][4]||m,e&&n&&(isNaN(r)||0===r)){t=c;break}}isNaN(r)||6!==r||(t=19),isNaN(r)||2!==r&&3!==r||(t=20,this.TXa&&this.TXa(Jt,s,r)),t!==g&&0!==t?h=o.GC$("."+R)[t]:!p||3===i||t!==g||2===i&&0===a?0===t&&5===i&&(h=o.GC$("."+R)[t]):h=o.GC$("."+R)[v(d)-1],o.GC$(h).attr(tt,1),o.GC$(h).find("."+F).css([It],[et])},e.prototype.mXa=function(){var t=o.GC$("."+R).removeClass(D)[0];o.GC$(t).addClass(D)},e.prototype.UXa=function(t){var e;if(0!==t)e=t;else switch(this.Nc){case"NumberFilter":e=1;break;case"TextFilter":e=2;break;case"DateFilter":e=5}return e},e.prototype.VXa=function(t,e,n,o){var r,i=this.kj;switch(t){case G:r=new ce(i.parent.xv(),i,this.HXa,G);break;case H:r=new he(i.parent.xv(),i,this.HXa,H,this.IXa.fY,o,e,n,this.UXa(e))}r&&r.OT()},e.prototype.PXa=function(t){var e,n,o=this.HXa.col,r=parseInt(t.attr(ht),10),a=parseInt(t.attr(dt),10),s=parseInt(t.attr(gt),10),l=parseInt(t.attr("data-expectTypeId"),10),u=parseInt(t.attr(pt),10),c=parseInt(t.attr(tt),10);return isNaN(l)||(r=0,u=0),0===r&&1===c?(this.WW(),void this.IXa.close()):1===r?(this.IXa.close(),e=8===a&&0===s?G:H,void this.VXa(e,a,s,u)):(n=new i.Condition(a),10===a?n.type(s):n.compareType(s),6!==a||isNaN(l)?6===a&&(n=new i.Condition(a)).expected(s):((n=new i.Condition(a)).expectTypeId(l),n.expected(s)),void this.NXa(o,n))},e.prototype.OXa=function(){},e.prototype.WXa=function(t){var e,n,r="";for(e=0,n=t.length;e<n;e++)r+=e===n-1?this.XXa(t[e],1):this.XXa(t[e],0);this.JXa.html(r),o.GC$(this.FXa).append(this.JXa),this.YXa(),this.RXa()},e.prototype.YXa=function(){var t=this.FXa.offsetHeight-2,e=this.FXa.offsetTop;o.GC$("."+R+",."+k).css([Et,Nt,"line-height","white-space","clear",Dt,Mt,Nt,Vt,Bt],["0 10px 0 0",t,t,"nowrap","both",kt,"auto","auto","12px",0]),this.JXa.css([b,w],["100%",e]),o.GC$(".gc-filter-hotkey").css(["text-decoration"],["underline"]),o.GC$("."+j).css([It,Mt,"textAlign"],[et,"24px","center"]),o.GC$("."+j+" img").css([It,"verticalAlign"],[et,"text-bottom"]),o.GC$("."+F+",."+P).hide(),o.GC$("#"+L).css([I],[x]),o.GC$("."+M).css(["marginLeft",Mt,Nt,"background-position"],["5px","16px","16px","center bottom"]),o.GC$("#"+_).css([I,It,Mt],["absolute","none","auto"])},e.prototype.XXa=function(t,e){var n=t[0],o=ne()[t[1]],r=t[3],i=t[4];return Ct+'"'+R+'" '+pt+'="'+e+'" '+ht+' ="'+n+'" '+dt+'="'+r+'" '+gt+'="'+i+'">'+Ct+'"'+Z+'">'+bt+'"'+j+'">'+wt+'"'+F+'" src="'+this.zW(11)+'">'+St+o+"</span>"+At},e.prototype.vXa=function(){var t=o.GC$("."+N,this.JXa[0]).removeClass(D),e=o.GC$("."+R);0===t.index()?o.GC$(e[e.length-1]).addClass(D):o.GC$(e[t.index()-1]).addClass(D)},e.prototype.wXa=function(){var t=o.GC$("."+N,this.JXa[0]);t.length>0&&t[0].nextSibling?(t.removeClass(D),o.GC$(t[0].nextSibling).addClass(D)):this.mXa()},e}(oe=function(){function t(t,e,n,r,i,a){var s=this;s.Nc=g,s.EXa=a,s.FXa=t,s.kj=r,s.GXa=o.GC$(t),s.xo=e,s.P$a=!1,s.HXa=n,s.xr=n.rowFilter,s.IXa=i,s.JXa=d}return t.prototype.ad=function(){this.yl(this.KXa()),this.LXa()},t.prototype.zW=function(t){return s.getFilterButtonImageSrc(t)},t.prototype.KXa=function(){var t=o.GC$(m("div")).attr("id","gc-ui-filter-subitems-container_"+this.EXa);return t.addClass(A+" "+S+" "+B),t.css([I,It,Rt],["absolute",kt,K]),this.JXa=t,o.GC$(this.FXa).append(this.JXa),t},t.prototype.cXa=function(){return"none"!==this.JXa[0].style.display},t.prototype.Ao=function(){o.GC$("."+B).hide(),this.JXa.show(),this.MXa()},t.prototype.hT=function(){this.JXa.hide(),this.JXa.find("."+D).removeClass(D)},t.prototype.OWa=function(t){return this.Nc=t,this},t.prototype.MXa=function(t){var e,n,o,r,i=this.GXa.offset(),a=this.IXa.AWa.offset(),s=document.documentElement,l=a.left,u=a.top,c=s.clientWidth,f=s.clientHeight,h=this.JXa.width(),p=this.JXa.height(),d=this.GXa.parent().parent().offset(),g=d.top,m=this.xo.offset();m.left+this.xo.width()+h-l>c?(e=-1*(h+2)+"px",o=!1):(e=this.xo.width()+"px",o=!0),n=g+(r=i.top-m.top)+p-u>f?u+f-p-d.top-6:r,n+="px",this.JXa.css([b,w],[e,n]),t&&t.call(this,o)},t.prototype.NXa=function(t,e){ge(t,e,this.kj,this.xr),this.IXa.close()},t.prototype.oXa=function(){o.GC$("."+N,this.JXa[0]).trigger(Ot)},t.prototype.WW=function(){var t,e=this.HXa,n=this.kj,o=e.col,r=e.rowFilter;r&&(t={rowFilter:r,colIndex:o},n.wu().execute({cmd:"clearFilter",sheetName:n.name(),cmdOption:t}))},t.prototype.tXa=function(){return this.hT(),d},t.prototype.uXa=function(){this.cXa()||(this.Ao(),this.mXa())},t.prototype.yl=function(t){},t.prototype.LXa=function(){},t.prototype.mXa=function(){},t.prototype.wXa=function(){},t.prototype.vXa=function(){},t}())),e.WWa=ie,ae=function(t){function e(e,n,o,r,i,a){var s=t.call(this,e,n,o,r,i,a)||this;return s.SXa=Wt,s}return pe(e,t),e.prototype.OXa=function(){this.WXa(Wt)},e}(re),e.XWa=ae,se=function(t){function e(e,n,o,r,i,a){var s=t.call(this,e,n,o,r,i,a)||this;return s.SXa=Ut,s}return pe(e,t),e.prototype.OXa=function(){this.WXa(Ut)},e.prototype.XXa=function(t,e){var n=t[0],o=ne()[t[1]],r=t[3],i=t[4];return"AllDates"===t[1]?'<div id="'+L+'" class="'+R+'" '+pt+'="'+e+'" '+ht+' ="'+n+'" '+dt+'="'+r+'" '+gt+'="'+i+'">'+Ct+'"'+Z+'">'+bt+'"'+j+'">'+wt+'"'+F+'" src="'+this.zW(11)+'">'+St+o+"</span>"+bt+'"'+M+' gc-filterDialog-rightArrow"></span></div>'+this.ZXa()+"</div>":"YearToDate"===t[1]?Ct+'"'+R+'" data-expectTypeId="'+t[5]+'" '+pt+'="'+e+'" '+ht+' ="'+n+'" '+dt+'="'+r+'" '+gt+'="'+i+'">'+Ct+'"'+Z+'">'+bt+'"'+j+'">'+wt+'"'+F+'" src="'+this.zW(11)+'">'+St+o+"</span>"+At:Ct+'"'+R+'" '+pt+'="'+e+'" '+ht+' ="'+n+'" '+dt+'="'+r+'" '+gt+'="'+i+'">'+Ct+'"'+Z+'">'+bt+'"'+j+'">'+wt+'"'+F+'" src="'+this.zW(11)+'">'+St+o+"</span>"+At},e.prototype.Ao=function(){o.GC$("."+B).hide(),this.JXa.show(),this.MXa(this.$Xa)},e.prototype.$Xa=function(t){var e,n,r,i,a,s,l,u,c;this.JXa.show(),e=o.GC$("#"+_),n=o.GC$("#"+L),r=this.JXa,l=(s=document.documentElement).clientWidth,u=s.clientHeight,c=this.IXa.AWa.offset().top,i=r.offset().left+r.width()+e.width()>l?-1*e.width()+"px":t?r.width()+"px":-1*e.width()+"px",a=n.offset().top+e.height()-c>u?c+u-e.height()-n.offset().top-5:0,a+="px",e.css([b,w],[i,a])},e.prototype.ZXa=function(){var t,e='<div id="'+_+'" class="'+A+'">';for(t=0;t<v(Jt);t++)e+=Ct+'"'+k+'" data-expectTypeId="'+Jt[t][4]+'" '+dt+'="6"  '+gt+'="'+Jt[t][3]+'">'+Ct+'"'+Z+'">'+bt+'"'+j+'">'+wt+'"'+P+'" src="'+this.zW(11)+'">'+St+ne()[Jt[t][0]]+"</span>"+At;return e+"</div>"},e.prototype.mXa=function(){var t,e;this._Xa()?(t=o.GC$("."+k).removeClass(D),o.GC$(t[0]).addClass(D)):(e=o.GC$("."+R).removeClass(D)[0],o.GC$(e).addClass(D))},e.prototype._Xa=function(){var t=o.GC$("#"+_);return 0!==t.length&&t.css(It)!==kt},e.prototype.aYa=function(){o.GC$("#"+_).hide(),o.GC$("."+k).removeClass(D)},e.prototype.QXa=function(){var t=this;o.GC$("."+k,t.JXa[0]).bind(jt,(function(){o.GC$(this).addClass(D),o.GC$("#"+L).addClass(D)})).bind(Ft,(function(){o.GC$(this).removeClass(D)})).bind(Ot,(function(e){t.PXa(o.GC$(this)),C(e)})),o.GC$("#"+L,t.JXa[0]).bind(jt,(function(){o.GC$("#"+_).show()})).bind(Ft,(function(){t.aYa()})).bind(Ot,(function(e){o.GC$("#"+_).show(),t.mXa(),C(e)}))},e.prototype.bYa=function(){var t=o.GC$("#"+L);return 0!==t.length&&t.hasClass(D)},e.prototype.TXa=function(t,e,n){var r,i,a;for(i=0;i<v(t);i++)if(t[i][3]===e&&t[i][4]===n){r=i;break}a=o.GC$("."+k)[r],o.GC$(a).attr(tt,1),o.GC$(a).find("."+P).css([It],[et]).attr(tt,1)},e.prototype.oXa=function(){(this._Xa()?o.GC$("."+N,o.GC$("#"+_)[0]):o.GC$("."+N,this.JXa[0])).trigger(Ot)},e.prototype.tXa=function(){var t=d;return this._Xa()?(this.aYa(),t=this):this.hT(),t},e.prototype.uXa=function(){var t=this.cXa(),e=this._Xa();t?!e&&this.bYa()&&(o.GC$("#"+_).show(),this.mXa()):(this.Ao(),this.mXa())},e.prototype.vXa=function(){var t,e,n,r;this._Xa()?(t=o.GC$("."+N,o.GC$("#"+_)[0]).removeClass(D),e=o.GC$("."+k),0===t.index()?o.GC$(e[e.length-1]).addClass(D):o.GC$(e[t.index()-1]).addClass(D)):(n=o.GC$("."+N,this.JXa[0]).removeClass(D),r=o.GC$("."+R),0===n.index()?o.GC$(r[r.length-1]).addClass(D):o.GC$(r[n.index()-1]).addClass(D))},e.prototype.wXa=function(){var t,e,n;this._Xa()?(t=o.GC$("."+N,o.GC$("#"+_)[0]).removeClass(D),e=o.GC$("."+k),t.index()===e.length-1?o.GC$(e[0]).addClass(D):o.GC$(e[t.index()+1]).addClass(D)):(n=o.GC$("."+N,this.JXa[0])).length>0&&n[0].nextSibling?(n.removeClass(D),o.GC$(n[0].nextSibling).addClass(D)):this.mXa()},e}(re),e.YWa=se,le=function(t){function e(e,n,o,r,i,a){return t.call(this,e,n,o,r,i,a)||this}return pe(e,t),e.prototype.yl=function(){this.cYa(this.IXa._Wa,this.IXa.aXa)},e.prototype.dYa=function(){var t,e,n,o,r,i=this.xr.zZ;if(i&&i.color!==g){if(e=i.isBackColor?0:1,n=i.color,o=this.IXa._Wa,r=this.IXa.aXa,"{"===n[0]?n=JSON.parse(n):""!==n&&(n=de(n)),""===n&&0===e&&o[W]===g)return g;if(""===n&&0!==e&&r[W]===g)return g;t={colorType:e,color:n}}return t},e.prototype.eYa=function(){var t,e=this.xr.rZ[this.HXa.col];return e&&e.length>0&&3===e[0].conType()&&(t={colorType:e[0].compareType(),color:e[0].expected()}),t},e.prototype.cYa=function(t,e){this.fYa(t,e),this.gYa()},e.prototype.hYa=function(t,e){this.IXa.DXa(t,e),this.IXa.close()},e.prototype.iYa=function(t){var e,n,o;this.IXa.close(),e=this.kj,o=t?this.IXa._Wa:this.IXa.aXa,this.d$a&&(n=this.d$a.color),new fe(e.parent.xv(),e,this.HXa,this.EXa,o,t,n).OT()},e.prototype.jYa=function(t,e){var n=new i.Condition(3),o=this.HXa.col,r=e?0:1,a=this.eYa();return a&&a.colorType===r&&a.color===t?(this.WW(),void this.IXa.close()):(n.compareType(r),n.expected(t),void this.NXa(o,n))},e.prototype.gYa=function(){o.GC$("."+U,this.JXa[0]).css([Nt,"line-height","textIndent","whiteSpace"],["32px","32px","8px","nowrap"]),o.GC$("."+X,this.JXa[0]).css(["listStyle","padding",Nt,"lineHeight",Dt,"whiteSpace",Mt,Bt,Vt,Rt],[kt,"2px 0","23px","23px","1px solid transparent","nowrap","140px",0,"12px","content-box"]),o.GC$("."+q,this.JXa[0]).css([Mt,Dt,Ht,Nt,Rt,"whiteSpace",T],["75px","1px solid rgb(130,130,130)","24px","22px",K,"nowrap",b]),o.GC$("."+Y,this.JXa[0]).css([It,Mt,Nt,"verticalAlign",Bt,"textAlign",T],[et,"22px","22px","middle","0 3px 0 2px","center",b]),o.GC$("."+Y+" img",this.JXa[0]).css([Gt,It],["3px",kt]),o.GC$(".gc-color-dialog-more-color",this.JXa[0]).css([Et],["0 5px 0 0"]),o.GC$("."+Y+" img.checked",this.JXa[0]).css([Gt,It],["3px","block"])},e.prototype.fYa=function(t,e){var n,r,i,a;this.EXa===V?(n=ne().SortCellTitle,r=ne().SortFontTitle,i=this.dYa()):this.EXa===z&&(n=ne().FilterCellTitle,r=ne().FilterFontTitle,i=this.eYa()),this.d$a=i,a=this.kYa(n,t[W],t.data,0,i),""!==(a+=this.kYa(r,e[W],e.data,1,i))?this.JXa.html(a):this.P$a=!0,o.GC$(this.FXa).append(this.JXa),this.JXa.find("canvas").forEach((function(t,e,n){var r,i,a,s=t;r="{"===s.textContent[0]?JSON.parse(s.textContent):s.textContent,s.width=73,s.height=20,i=s.getContext("2d"),a=function(){i.fillRect(0,0,73,20)},o.To.setFillStyle(i,r,0,0,73,20,a)}))},e.prototype.kYa=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d=!1,m="checked";for(l in r&&o===r.colorType&&""!==r.color?i=de(r.color):r&&""===r.color&&o===r.colorType&&(i=r.color),a=Ct+"'"+U+"'>"+t+"</div><ul class='"+(0===o?"gc-filter-color-dialog-background":"gc-filter-color-dialog-font")+"' style='padding: 7px 0 0 0;margin:0'>",s=0,n)n.hasOwnProperty(l)&&s<5&&(u="",i!==g&&i===l&&(u=m,d=!0),a+=Tt+'"'+X+'" '+mt+'="'+n[l]+'" '+yt+'="'+o+'">'+bt+'"'+Y+'">'+wt+'"'+u+'" src="'+this.zW(11)+'"></span>'+Ct+'"'+q+'"><canvas>'+l+"</canvas></div></li>",s++);return 0===s&&i===g||e===g&&1===s?a="":(e!==g&&(c=0===o?ne().NoFill:ne().Automatic,f="",i!==g&&""===i&&(f=m,d=!0),a+=Tt+'"'+X+'" '+mt+'="'+W+'" '+yt+'="'+o+'" '+vt+' = "">'+bt+'"'+Y+'"><img  class="'+f+'" src="'+this.zW(11)+'"></span>'+Ct+'"'+Z+'">'+c+"</div></li>"),5===s&&(h="",d||i===g||(h=m),p=0===o?ne().CellColor:ne().FontColor,a+=Tt+'"'+X+'" '+mt+'="more_color" '+yt+'="'+o+'" >'+bt+'"'+Y+'">'+wt+'"'+h+'" src="'+this.zW(11)+'"></span>'+Ct+'"'+Z+' gc-color-dialog-more-color">'+p+"</div></li>"),a+="</ul>")},e.prototype.mXa=function(){var t=o.GC$("."+X,this.JXa[0]).removeClass(D)[0];o.GC$(t).addClass(D)},e.prototype.LXa=function(){var t=this;t.JXa.bind(jt,(function(t){C(t)})).bind(Ft,(function(t){C(t)})),o.GC$("."+X,t.JXa[0]).bind(Ot,(function(){var e,n=o.GC$(this).find("canvas"),r=o.GC$(this).attr(mt),i=o.GC$(this).attr(yt),a=!1;return n&&n.length>0?"{"===(e=n.text())[0]&&(e=JSON.parse(e)):e=o.GC$(this).attr(vt),0===(i=parseInt(i,10))&&(a=!0),"more_color"===r?void t.iYa(a):void(t.EXa===V?t.hYa(e,a):t.EXa===z&&t.jYa(e,a))})).bind(jt,(function(e){o.GC$("."+X,t.JXa[0]).removeClass(D),o.GC$(this).addClass(D),C(e)})).bind(Ft,(function(t){o.GC$(this).removeClass(D),C(t)}))},e.prototype.kzb=function(t){var e=0;return t.forEach((function(t,n){o.GC$(t).hasClass(N)&&(e=n)})),e},e.prototype.vXa=function(){var t,e=o.GC$("."+X,this.JXa[0]),n=this.kzb(e);0===n?o.GC$(e.removeClass(D)[e.length-1]).addClass(D):(t=e.removeClass(D)[n-1],o.GC$(t).addClass(D))},e.prototype.wXa=function(){var t,e=o.GC$("."+X,this.JXa[0]),n=this.kzb(e);n===e.length-1?this.mXa():(t=e.removeClass(D)[n+1],o.GC$(t).addClass(D))},e}(oe),e.ZWa=le,ue=function(t){function e(e,n,o,r){var i,a,s=n.parent;return(i=a=t.call(this,e,y.vl(s&&s.qo),!0)||this).kj=n,i.lYa=i.Cj+"_OK",i.mYa=i.Cj+"_Cancel",i.nYa=i.Cj+"_Close",i.HXa=o,i.xr=o.rowFilter,i.EXa=r,i.xo=i.yo(),a}return pe(e,t),e.prototype.OT=function(){},e.prototype.Fva=function(){this.Ao(),this.yl(),this.oYa(),this.BPa()},e.prototype.yl=function(){},e.prototype.BPa=function(){var t=this,e=t.xo.width(),n=t.xo.height(),o=t.AWa.width(),r=t.AWa.height();this.xo.css([I,b,w],["fixed",(o-e)/2+"px",(r-n)/2+"px"])},e.prototype.oYa=function(){var t=this;o.GC$("#"+t.lYa).bind(Ot,(function(){t.pYa()&&t.close()})),o.GC$("#"+t.mYa).bind(Ot,(function(){t.qYa(),t.close()})),o.GC$("#"+t.nYa).bind(Ot,(function(){t.qYa(),t.close()})).bind(jt,(function(){this.style.backgroundColor="#E81123",this.style.color="white"})).bind(Ft,(function(){this.style.backgroundColor=Pt,this.style.color=Pt})),o.GC$("#"+t.lYa+", #"+t.mYa).bind(jt,(function(){o.GC$(this).addClass(O)})).bind(Ft,(function(){o.GC$(this).removeClass(O)})),o.GC$(document).bind("resize",(function(){t.BPa()}))},e.prototype.PXa=function(t){var e=this.HXa;ge(e.col,t,this.kj,e.rowFilter)},e.prototype.pYa=function(){return!0},e.prototype.qYa=function(){},e}(o.Go),e.rYa=ue,ce=function(t){function e(e,n,o,r){var i=t.call(this,e,n,o,r)||this,a=i;return a.Vo=230,a._v=140,a.HXa=o,a.xr=a.HXa.rowFilter,a.EXa=r,a.sYa=a.tYa(),a.Fva(),i}return pe(e,t),e.prototype.tYa=function(){var t={rank:0,item:10},e=this.xr.rZ[this.HXa.col];return e&&e.length>0&&8===e[0].conType()&&(t={rank:e[0].type(),item:e[0].expected()}),t},e.prototype.yl=function(){var t=this.uYa();this.yo().html(t),this.setStyle(),this.LXa()},e.prototype.vYa=function(t){1===t.value.length?t.value=t.value.replace(/[^1-9]/g,""):t.value=t.value.replace(/\D/g,"")},e.prototype.LXa=function(){var t=this;o.GC$(ot).bind("keyup",(function(){o.GC$(this).removeClass(ct),t.vYa(this)})).bind("paste",(function(){o.GC$(this).removeClass(ct),t.vYa(this)}))},e.prototype.pYa=function(){var t=parseInt(o.GC$("#top10-rank").val(),10),e=parseInt(o.GC$(ot).val(),10),n=new i.Condition(8),r=!1;return e?(r=!0,n.type(t),n.expected(e),this.PXa(n)):o.GC$(ot).addClass(ct).focus(),r},e.prototype.uYa=function(){var t,e="";return t=1===this.sYa.rank?'<select id="top10-rank"><option value="0">'+ne().top+'</option><option value="1" selected = "selected">'+ne().bottom+"</option></select>":'<select id="top10-rank"><option value="0" selected="selected">'+ne().top+'</option><option value="1">'+ne().bottom+"</option></select>",e+'<div class="gc-popup ui-widget '+A+'"><div class="ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix"><span class="gc-filter-dialog-title">'+ne().Top10Filter+'</span><span id="'+this.nYa+'" class="gc-filter-dialog-close">Ã</span></div><div id="top10-desc"><div class="top10-show-text">'+ne().Show+'</div><div class="ui-dialog-hr"></div></div><div class="top10-wrap">'+t+'<input id="top10-item" class="gc-filter-top10-rank" type="text"  value="'+this.sYa.item+'" /></div><div class="top10-footer top10-wrap"><input type="button" id="'+this.lYa+'" value="'+ne().OK+'"><input id="'+this.mYa+'" type="button" class="gc-filter-dialog-close" value="'+ne().Cancel+'"/></div></div>'},e.prototype.setStyle=function(){o.GC$(".gc-popup",this.xo[0]).css([_t,Mt,Nt],[Lt,this.Vo,this._v]),o.GC$(".ui-dialog-titlebar",this.xo[0]).css({height:"34px",background:"white",fontSize:"12px",fontWeight:"normal",color:"#222",border:"none",borderRadius:"0"}),o.GC$(".gc-filter-dialog-title",this.xo[0]).css({float:"left",height:"34px",lineHeight:"34px",display:et,marginLeft:"15px"}),o.GC$(".top10-show-text",this.xo[0]).css({float:"left"}),o.GC$(".ui-dialog-hr",this.xo[0]).css({position:"absolute",left:"24px",right:"0",margin:"0 5px",height:"12px",borderBottom:ft,borderWidth:"thin"}),o.GC$("#top10-desc",this.xo[0]).css({height:"24px",lineHeight:"24px",marginLeft:"15px",position:x,fontSize:"10px"}),o.GC$("#"+this.nYa,this.xo[0]).css({float:"right",fontSize:"18px",width:"36px",height:"34px",lineHeight:"34px",textAlign:"center"}),o.GC$("#top10-rank",this.xo[0]).css({width:"120px",marginRight:"20px",height:"21px",textIndent:"5px",fontSize:"inherit",padding:"0",marginBottom:0}),o.GC$(ot,this.xo[0]).css({width:"60px",textIndent:"5px",padding:0,height:"21px",margin:0,fontSize:"inherit",display:et}),o.GC$(".top10-wrap",this.xo[0]).css({padding:"0px 12px",textAlign:"right",color:"#9B9C9C",fontSize:"13px"}),o.GC$(".top10-footer",this.xo[0]).css({padding:"20px 12px 12px"}),o.GC$("#"+this.lYa+", #"+this.mYa).css({width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:ut,padding:0,display:et}),o.GC$("#"+this.lYa,this.xo[0]).css({marginRight:"12px"})},e}(ue),fe=function(t){function e(e,n,o,r,i,a,s){var l=t.call(this,e,n,o,r)||this,u=l;return u.Vo=416,u._v=100,u.wYa=36,u.xYa=24,u.yYa=8,u.zYa=7,u.EXa=r,u.AYa=i,u.Xba=a?0:1,u.BYa=typeof s!==xt&&s?de(s):s,u.CYa=d,u.DYa=d,u.Fva(),l}return pe(e,t),e.prototype.yl=function(){var t,e,n=this.EYa();this.xo.append(n),t=o.GC$("#color-spread-wrap",this.xo[0])[0],this.e$a=this.f$a(),e=this.FYa(t),this.GYa(t,e),this.LXa(this.CYa,this.DYa)},e.prototype.f$a=function(){return"#D3F0E0"},e.prototype.FYa=function(t){var e,n,r=this.AYa.colorNumber,i=!1;return n=this.wYa*this.zYa+4,Math.ceil(r/this.zYa)>this.yYa?(e=this.xYa*this.zYa,i=!0,n+=20):e=this.xYa*Math.ceil(r/this.zYa),o.GC$(t).height(e),o.GC$(t).width(n),i},e.prototype.HYa=function(t,e,n){var o,r,i;t.suspendPaint(),o=t.options,r=e.options,o.showHorizontalScrollbar=!1,o.allowContextMenu=!1,o.showVerticalScrollbar=n,o.scrollbarMaxAlign=!0,o.tabStripVisible=!1,o.allowUserResize=!1,o.allowUserDragDrop=!1,o.allowUserDragFill=!1,o.allowUserZoom=!1,o.grayAreaBackColor="#fff",r.colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor="transparent",r.selectionBorderColor="transparent",r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.isProtected=!0,e.setColumnCount(this.zYa+2),i=this.AYa.colorNumber,e.setRowCount(Math.ceil(i/this.zYa)+1),e.defaults.rowHeight=21,e.defaults.colWidth=36,e.setColumnWidth(0,2),e.setColumnWidth(this.zYa+1,2),e.setRowHeight(0,2),t.resumePaint()},e.prototype.IYa=function(t,e){var n,o,r,i,a;for(a in e.suspendPaint(),n=(this.zYa-this.AYa.colorNumber)*this.wYa/2,e.setColumnWidth(0,n),this.AYa.data)this.AYa.data.hasOwnProperty(a)&&(o=(i=this.JYa(o,r)).row,r=i.col,this.Bba(o,r,a,e));e.resumePaint()},e.prototype.Bba=function(t,e,n,o){var r=new a.Button;r.buttonBackColor("{"===n[0]?JSON.parse(n):n),r.marginLeft(3),r.marginTop(3),r.marginRight(3),r.marginBottom(3),o.setCellType(t,e,r,3),n===this.BYa&&this.g$a(o,t,e,this.e$a)},e.prototype.JYa=function(t,e){return t===g&&e===g?(t=1,e=1):e<this.zYa?e+=1:(t+=1,e=1),{row:t,col:e}},e.prototype.KYa=function(t,e){var n,o,r,i;for(i in e.suspendPaint(),n=g,o=g,this.AYa.data)this.AYa.data.hasOwnProperty(i)&&(n=(r=this.JYa(n,o)).row,o=r.col,this.Bba(n,o,i,e));e.resumePaint()},e.prototype.g$a=function(t,e,n,r){var i,a;t.suspendPaint(),this.h$a&&((i=t.getStyle(this.h$a.row,this.h$a.col,3)).backColor="#ffffff",i.borderLeft=new o.LineBorder(Q,o.LineStyle.empty),i.borderTop=new o.LineBorder(Q,o.LineStyle.empty),i.borderRight=new o.LineBorder(Q,o.LineStyle.empty),i.borderBottom=new o.LineBorder(Q,o.LineStyle.empty),t.setStyle(this.h$a.row,this.h$a.col,i,3)),this.h$a={row:e,col:n},(a=t.getStyle(e,n,3)).backColor=r,a.borderLeft=new o.LineBorder(Q,o.LineStyle.thin),a.borderTop=new o.LineBorder(Q,o.LineStyle.thin),a.borderRight=new o.LineBorder(Q,o.LineStyle.thin),a.borderBottom=new o.LineBorder(Q,o.LineStyle.thin),t.setStyle(e,n,a,3),t.resumePaint()},e.prototype.GYa=function(t,e){var n,r=new o.Workbook(t);r.jDc=!0,n=r.getActiveSheet(),this.CYa=r,this.DYa=n,this.HYa(r,n,e),this.AYa.colorNumber<this.zYa?this.IYa(r,n):this.KYa(r,n)},e.prototype.B_a=function(){var t,e=g;for(t in this.AYa.data)if(this.AYa.data.hasOwnProperty(t)){e=t;break}return"{"===e[0]?JSON.parse(e):e},e.prototype.EYa=function(){var t,e,n,r,i,a,s=o.GC$(m("div")).addClass("gc-popup ui-widget gc-filter-color-dialog-style "+A+" "+S);return s.css({backgroundColor:"#f0f0f0"}),t=this.LYa(),s.append(t),e=this.MYa(),s.append(e),n=o.GC$(m("div")).css([Et],["0 12px"]),(r=this.NYa())!==g&&n.append(r),i=this.OYa(),n.append(i),a=this.PYa(),n.append(a),s.append(n),s.append(this.QYa()),s},e.prototype.LYa=function(){var t=o.GC$(m("div")),e=o.GC$(m("span")),n=o.GC$(m("span")).attr("id",this.nYa);return t.css([Mt,Nt,_t,Et,Rt],["100%","34px","#fff","0 0 0 12px",K]),e.css(["float",Nt,"lineHeight",It],[b,"34px","34px",et]).html(ne().ColorTitle),n.css(["float",Nt,"lineHeight",It,Vt,Mt,"textAlign"],["right","34px","34px",et,"18px","36px","center"]).html("Ã").addClass(lt),t.append(e),t.append(n),t},e.prototype.MYa=function(){var t,e=o.GC$(m("div")),n=o.GC$(m("div"));return 0===this.Xba&&this.EXa===V?t=ne().SortCell:0===this.Xba&&this.EXa===z?t=ne().FilterCell:1===this.Xba&&this.EXa===V?t=ne().SortFont:1===this.Xba&&this.EXa===z&&(t=ne().FilterFont),e.css(Et,"0 12px"),n.css([Nt,"lineHeight"],["24px","24px"]).html(t),e.append(n),e},e.prototype.NYa=function(){var t,e,n,r=g;return this.AYa[W]!==g&&(t=""===this.BYa,e=1===this.Xba?ne().Automatic:ne().NoFill,(n=o.GC$(m("div")).html(e)).attr("id","gc-color-dialog-noFill"),t?(n.attr(st,"checked"),n.css([_t,Et,Dt,"textAlign","margin"],["rgb(134,191,160)","0 12px",at,"center","5px 0"])):n.css([_t,Et,Dt,"textAlign","margin"],["transparent","0 12px",at,"center","5px 0"]),r=n),r},e.prototype.OYa=function(){var t=o.GC$(m("div")).attr("id","color-spread-wrap");return t.css([_t,Et,Dt,Mt,"box-sizing"],["#fff","6px","1px solid rgb(160,160,160)","288px",nt]),t},e.prototype.PYa=function(){var t,e=this,n=o.GC$(m("div")),r=o.GC$(m("div")).html(ne().Selected),i=m("canvas"),a=o.GC$(i).attr("id","gc-color-dialog-selected");return n.css([I,Et,Rt,Bt,Nt],[x,"0 12px",nt,"12px 0","16px"]),r.css([T,Mt,"text-align"],[b,"60px","center"]),t=1===e.Xba?J:$,e.BYa===g&&(e.BYa=e.B_a()),""!==e.BYa&&(t=e.BYa),a.css([I,b,Dt],["absolute","70px",at]),i.width=188,i.height=16,e.Zgc(a,t),n.append(r),n.append(a),n},e.prototype.Zgc=function(t,e){var n,r,i=typeof e===xt?JSON.stringify(e):e;t.text(i),n=t[0].getContext("2d"),r=function(){n.fillRect(0,0,188,16)},o.To.setFillStyle(n,"{"===i[0]?JSON.parse(i):i,0,0,188,16,r)},e.prototype.pYa=function(){var t,e=o.GC$(it);return t=1===e.length&&"checked"===e.attr(st)?"":this.BYa,this.RYa(t),!0},e.prototype.RYa=function(t){var e=0===this.Xba;this.EXa===V?this.SYa(t,e):this.EXa===z&&this.TYa(t,e)},e.prototype.SYa=function(t,e,n){var r,i,a=this.HXa,s=a.rowFilter,l=this.kj;s&&l&&l.hK()&&(""!==t&&(t=de(t)),n=n!==g&&n,r=a.col,i={sheet:l,sheetName:l.Cj,col:r,ascending:n,color:t,isBackColor:e,cancel:!1},l.Wq(o.Events.RangeSorting,i),!1===i.cancel&&(l.suspendPaint(),s.sortColumnByColor(r,n,t,e),l.resumePaint(),l.Wq(o.Events.RangeSorted,i)))},e.prototype.TYa=function(t,e){var n=new i.Condition(3),o=e?0:1;n.compareType(o),n.expected(t),this.PXa(n)},e.prototype.LXa=function(t,e){var n=this;o.GC$(it).bind(Ot,(function(){var t=1===n.Xba?J:$;n.Zgc(o.GC$(rt),t),o.GC$(this).css(_t,"rgb(134,191,160)"),o.GC$(this).attr(st,"checked")})),t.bind(o.Events.ButtonClicked,(function(t,r){var i,a=r.row,s=r.col,l=e.getCellType(a,s);n.g$a(e,a,s,n.e$a),i=l.buttonBackColor(),n.Zgc(o.GC$(rt),i),o.GC$(it).css(_t,"transparent").attr(st,""),n.BYa=i})),t.bind(o.Events.TouchToolStripOpening,(function(t,e){e.handled=!0}))},e.prototype.QYa=function(){var t=o.GC$(m("div")),e=o.GC$(m("input")).attr({type:"button",value:ne().OK,id:this.lYa}),n=o.GC$(m("input")).attr({type:"button",value:ne().Cancel,id:this.mYa}).addClass(lt),r={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:ut,padding:"0",display:et,margin:"0"};return t.addClass("color-custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),e.css(r).css({marginRight:"12px"}),n.css(r),t.append(e[0]),t.append(n[0]),t},e}(ue),he=function(t){function e(e,n,o,r,i,a,s,l,u){var c=t.call(this,e,n,o,r)||this,f=c;return f.Vo=840,f._v=260,f.HXa=o,f.xr=f.HXa.rowFilter,f.EXa=r,f.UYa=a,f.fY=i,f.VYa=s,f.WYa=u,f.XYa=l,f.YYa(a),f.Fva(),c}return pe(e,t),e.prototype.yl=function(){var t=this,e=t.ZYa(this.sYa);t.xo.append(e),o.GC$(".gc-popup",this.xo[0]).css([_t,Mt,Nt,Vt],[Lt,this.Vo,this._v,"12px"]),t.LXa()},e.prototype.LXa=function(){var t=this;o.GC$(".filter-custom-select-input").bind("change",(function(){var t=o.GC$(this).find("option")[this.selectedIndex];o.GC$(this).parent().find("input").val(o.GC$(t).text()).attr("gc-data",o.GC$(this).val())})),o.GC$(".filter-custom-select-first-option").bind("click",(function(t){t.stopPropagation(),t.preventDefault(),o.GC$(this).parent().trigger("change")})),o.GC$("#first-condition-expected input, #sec-condition-expected input").bind("change",(function(){var e=o.GC$(this).val(),n=-1;t.fY.forEach((function(t,o){t.text===e&&(n=o)})),o.GC$(this).attr("gc-data",n)}))},e.prototype.F_a=function(t,e,n){var o,r,i=t.val();return 0===n&&2===e?i:(o=t.attr("gc-data"),(r=this.fY[o])?r.value:11!==e||isNaN(+i)?i:parseFloat(i))},e.prototype.pYa=function(){var t=parseInt(o.GC$("#filter-logical-wrap input:checked").val(),10),e=this.$Ya(t),n=!1;return e?(this.PXa(e),n=!0):o.GC$("#first-condition-type").focus(),n},e.prototype.$V=function(t,e){var n,o,r,a,s=t.val().trim();return s?(o=parseInt(s.split("-")[0],10),n=parseInt(s.split("-")[1],10),r=this.F_a(e,n,o),a=new i.Condition(n),this.r$a(r)&&a.conType(2),a.compareType(o),"string"===f(r)&&(r=p(r)),a.expected(r),a.treatNullValueAsZero(!1),a.ignoreCase(!0),"string"===f(r)&&-1===r.indexOf("*")&&-1===r.indexOf("?")?a.useWildCards(!1):"string"!==f(r)||-1===r.indexOf("*")&&-1===r.indexOf("?")||(a.conType(2),a.useWildCards(!0)),a):d},e.prototype.$Ya=function(t){var e,n=this.$V(o.GC$("#first-condition-type"),o.GC$("#first-condition-expected input")),r=this.$V(o.GC$("#sec-condition-type"),o.GC$("#sec-condition-expected input"));return r?((e=new i.Condition(0)).compareType(t),e.item1(n),e.item2(r)):e=n,e},e.prototype.b$a=function(){var t=this.HXa,e=t.rowFilter,n=this.kj.getText(t.row,t.col);return e&&e.range.row<=0&&(n=this.kj.getText(t.row,t.col,t.sheetArea)),n},e.prototype.ZYa=function(t){var e,n,r,i,a,s=this.b$a(),l=o.GC$(m("div")).addClass("gc-popup ui-widget "+A);return l.css({backgroundColor:"#f0f0f0"}),l.append(this._Ya()),l.append(this.aZa(s)),e=this.bZa("first-condition-type","first-condition-expected",t.compareType1||0,t.expected1,t.conType1,!0),l.append(e),l.append(this.cZa(t.logic)),n=this.bZa("sec-condition-type","sec-condition-expected",t.compareType2,t.expected2,t.conType2),l.append(n),n.css([I,Et],[x,"0 0 12px 35px"]),r=o.GC$(m("div")),i=o.GC$(m("p")).html(ne().Explain1).css({margin:"0"}),a=o.GC$(m("p")).html(ne().Explain2).css({margin:"0"}),r.append(i),r.append(a),r.css({fontSize:"10px",textIndent:"12px"}),l.append(r),l.append(this.dZa()),l},e.prototype.bZa=function(t,e,n,r,i,a){var s=o.GC$(m("div"));return s.css([I,Et],[x,"0 0 12px 35px"]),s.append(this.eZa(n,i,a).attr("id",t)),s.append(this.fZa(this.fY,r).attr("id",e)),s},e.prototype._Ya=function(){var t=o.GC$(m("div")),e=o.GC$(m("span")),n=o.GC$(m("span")).attr("id",this.nYa);return t.css([Mt,Nt,_t,Et,Rt],["100%","34px","#fff","0 0 0 12px",K]),e.css(["float",Nt,"lineHeight",It],[b,"34px","34px",et]).html(ne().CustomTitle),n.css(["float",Nt,"lineHeight",It,Vt,Mt,"textAlign"],["right","34px","34px",et,"18px","36px","center"]).html("Ã").addClass(lt),t.append(e),t.append(n),t},e.prototype.cZa=function(t){var e=o.GC$(m("div")),n=o.GC$(m("input")).attr({name:"filter-logical",id:"filter-dialog-and",type:"radio"}).val(1).css([Mt,It],["unset",et]),r=o.GC$(m("input")).attr({name:"filter-logical",id:"filter-dialog-or",type:"radio"}).val(0).css([Mt,It],["unset",et]),i=o.GC$(m("label")).attr({for:"filter-dialog-and"}).html(ne().And).css([Ht,"font-weight",Vt,It,"margin-bottom",Et],["10px","inherit","13px",et,"0","0"]),a=o.GC$(m("label")).attr({for:"filter-dialog-or"}).html(ne().Or).css([Ht,"font-weight",Vt,It,"margin-bottom",Et],["10px","inherit","13px",et,"0","0"]);return e.attr("id","filter-logical-wrap"),e.css({padding:"0 0 0 40px",height:"30px"}),0===t?(r.prop("checked",!0),n.prop("checked",!1)):(r.prop("checked",!1),n.prop("checked",!0)),e.append(n),e.append(i),e.append(r),e.append(a),e},e.prototype.aZa=function(t){var e,n,r,i=o.GC$(m("div")),a=o.GC$(m("div")).html(ne().ShowRows);return i.css(Et,"0 12px"),a.css([Nt,"lineHeight"],["24px","24px"]),i.append(a),e=o.GC$(m("div")),n=o.GC$(m("div")),t?((r=o.GC$(m("div")).html(h(t))).css([T,"maxWidth","textOverflow","whiteSpace","overflow"],[b,"300px","ellipsis","nowrap","hidden"]),e.css({height:"24px",lineHeight:"24px",marginLeft:"15px",fontSize:"10px"}),n.css({overflow:"hidden",margin:"0 5px",height:"12px",borderBottom:ft,borderWidth:"thin"}),e.append(r)):(e.css({height:"12px",lineHeight:"2px",marginLeft:"15px",fontSize:"10px"}),n.css({margin:"0 5px",height:"2px",borderBottom:ft,borderWidth:"thin"})),e.append(n),i.append(e),i},e.prototype.eZa=function(t,e,n){var r,i,a,s,l,u,c,f=[],h=!1;for(f=6===this.VYa||5===this.VYa?te:1===this.VYa?$t:Kt,i={height:"25px",width:"230px",marginBottom:0,marginRight:"12px",fontSize:"inherit",padding:0,boxSizing:"border-box"},(r=o.GC$(m("select"))).css(i),a="<option>&nbsp;</option>",u=!1,t===g&&(a='<option selected="selected" >&nbsp;</option>'),c=0;c<f.length;c++)l=!1,(s=f[c].split("-"))[2]&&(u=!1,(e===parseInt(s[2],10)||6===this.WYa&&5===parseInt(s[2],10)||11===parseInt(s[2],10))&&(u=!0),u&&t===parseInt(s[1],10)&&(l=!0)),l?(h=!0,a+='<option selected="selected" value="'+s[1]+"-"+s[2]+'">'+ne()[s[0]]+"</option>"):a+='<option value="'+s[1]+"-"+s[2]+'">'+ne()[s[0]]+"</option>";return r[0].innerHTML=a,o.GC$("option",r[0]).css({height:"20px"}),!h&&n&&o.GC$(o.GC$("option",r[0])[1]).attr("selected","selected"),r},e.prototype.I$a=function(t){var e=h(t);return e&&e.length>100&&(e=e.substr(0,100)+"..."),e},e.prototype.fZa=function(t,e){var n,r,i,a,s,l=-1,h=e,p=o.GC$(m("div")),g=o.GC$(m("select")).addClass("filter-custom-select-input"),y=o.GC$(m("input")),v=ne().Blanks;for(p.css([I,b,"top"],["absolute","278px","0"]),y.css([I,b,w,Mt,"textIndent",Dt,Nt,Rt,"outline",Et,Bt],["absolute","2px","2px","518px","5px",0,"21px",K,kt,0,0]),g.css({height:"25px",width:"540px",margin:0,padding:0}),r="",i=!0,a=0;a<t.length;a++)t[a].text===v&&t[a].value===d||(s=this.I$a(t[a].text),"date"===f(t[a].value)&&(n||(n=u.q4(u.culture()).DateTimeFormat),s=c.Vb(t[a].value,n.shortDatePattern)),t[a].value+""==e+""&&(l=a,h=s),i?(r+='<option class="filter-custom-select-first-option" value="'+a+'">'+s+"</option>",i=!i):r+='<option value="'+a+'">'+s+"</option>");return g[0].innerHTML=r,g[0].selectedIndex=-1,"date"===f(h)&&(n||(n=u.q4(u.culture()).DateTimeFormat),h=c.Vb(h,n.shortDatePattern)),y.attr("gc-data",l).val(h),p.append(g),p.append(y),p},e.prototype.dZa=function(){var t=o.GC$(m("div")),e=o.GC$(m("input")).attr({type:"button",value:ne().OK,id:this.lYa}),n=o.GC$(m("input")).attr({type:"button",value:ne().Cancel,id:this.mYa}).addClass(lt),r={width:"75px",height:"23px",lineHeight:"21px",fontSize:"12px",backgroundColor:"#E1E1E1",border:ut,padding:0,display:et};return t.addClass("custom-footer").css({textAlign:"right",padding:"10px 12px 12px"}),e.css(r).css({marginRight:"12px"}),n.css(r),t.append(e[0]),t.append(n[0]),t},e.prototype.YYa=function(t){var e=this,n=e.xr.rZ[e.HXa.col],o={conType1:2,conType2:g,compareType1:0,compareType2:g,expected1:g,expected2:g,logic:1};n=n&&n.length?n[0]:d,e.sYa=e.gZa(o,t,n)},e.prototype._Za=function(t,e){var n,o,r=u.q4(u.culture()).DateTimeFormat,i={},a=t.expectTypeId();if(0===a)i=t.getExConditionDateScope(t.expected());else if(6===a)n=new Date,o=new Date,n.setMonth(0,1),n.setHours(0,0,0,0),o.setHours(23,59,59,59),i={from:n,to:o};else if(3===a)return e.conType1=this.WYa,e.compareType1=this.XYa,e.expected1=g,e;return e.conType1=5,e.conType2=5,e.compareType1=5,e.compareType2=2,e.expected1=c.Vb(i.from,r.shortDatePattern),e.expected2=c.Vb(i.to,r.shortDatePattern),e},e.prototype.gZa=function(t,e,n){var o,r,i,a,s,l=n&&(n.conType()===this.VYa||11===n.conType()&&(1===this.VYa||2===this.VYa)),u=n&&(n.compareType()===this.XYa||0===n.conType());return!n||1!==e||6!==n.conType()||0!==n.expectTypeId()&&6!==n.expectTypeId()&&3!==n.expectTypeId()?(o=!0,1===this.WYa&&n&&0===n.conType()&&(r=n.item1().compareType(),i=n.item2().compareType(),5===Math.max(r,i)&&3===Math.min(r,i)||(o=!1)),1===e||l&&u&&o?n&&0===n.conType()?(this.VYa=this.WYa,t.conType1=n.item1().conType(),t.conType2=n.item2().conType(),t.compareType1=n.item1().compareType(),t.compareType2=n.item2().compareType(),t.expected1=n.item1().expected(),t.expected2=n.item2().expected(),t.logic=n.compareType()):n&&0!==n.conType()&&3!==n.conType()&&(a=n.compareType(),s=n.conType(),t.conType1=s,t.expected1=n.expected(),t.compareType1=a):0===this.VYa?(this.VYa=this.WYa,1===this.WYa?(t.conType1=1,t.conType2=1,t.compareType1=3,t.compareType2=5):5===this.WYa&&(t.conType1=5,t.compareType1=5,t.conType2=5,t.compareType2=3)):1===this.VYa&&this.s$a(n)?(t.conType1=this.WYa,t.compareType1=this.XYa,t.expected1=n.expected()):(t.conType1=this.WYa,t.compareType1=this.XYa,t.expected1=g),t):this._Za(n,t)},e.prototype.r$a=function(t){return t!==g&&"TRUE"===t||"FALSE"===t},e.prototype.s$a=function(t){if(!t)return!1;var e=!1,n=t.expected();return 1===t.conType()&&this.r$a(n)&&(e=!0),e},e}(ue)},"./dist/plugins/filter/filter-ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/filter/filter.res.en.js");e.SR={en:o}},"./dist/plugins/filter/filter-ui.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function Gt(t,e){r.GC$(t).addClass(e)}function Ht(t,e){return"object"==typeof t?JSON.stringify(t):(t=e.getColor(t),o.Common.pc.bc(o.Common.pc.ec(t)))}function Vt(t,e){var n,o,r={date:0,number:1,string:2,boolean:3,blank:4},i=t.value,a=e.value,s=t.type,l=e.type;if(s!==l)return r[s]<r[l]?-1:1;if("date"===s&&"date"===l){if((n=i.getFullYear())<(o=a.getFullYear()))return 1;if(n>o)return-1}return i>a?1:i<a?-1:0}function zt(t,e,n,o,r){if(t){var i=void 0;"string"==typeof t?(i=r[t])===St&&(i=r[t]=Ht(t,n)):i=JSON.stringify(t),e.data[i]===St&&e.colorNumber++,e.data[i]=o}else e[At]=At}function Wt(t,e){r.GC$(t).removeClass(e)}function Ut(t,e,n){t.css([lt,ut],[e+U,n+U])}function qt(t){r.GC$(t).css(["border",nt,it,"outline"],[0,0,0,st])}function Yt(t){return t.concat([])}function Xt(t,e){var n,r,i,a,s;if(y(t)||""===t||"number"==typeof t&&isNaN(t))return"blank";if(n=gt(t),r="number"==typeof t,"General"===e||y(e)){if(n)return"date"}else if(!u(e)&&(n||r))return i=/dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|zzz|zz|z|ggg|gg|g|ee|e/,a=/AM|PM/,s=new o.Formatter.GeneralFormatter(e),i.test(e)&&!s.hasFormatedColor()&&!a.test(e)?"date":"number";return pt(t)}function Zt(t,e,n,o,r){var i,a,s,l,u,c;if(e&&t)return u=[],(i=t.format(n))&&(a=(c=i.split("/"))[0]||"",s=c[1]||"",l=c[2]||""),u.push({value:a,level:0,status:o}),u.push({value:s,level:1,status:o}),u.push({value:l,level:2,status:o}),{key:e,value:n,children:u,status:o,type:r}}function Qt(t,e,n,o,r,i,a){if(e){var s=[];return s.push({value:e,level:t.outlineColumn&&t.outlineColumn.XQa(r)?t.getCell(o,r).textIndent():0,status:i}),{key:e,value:n,children:s,status:i,type:a}}}function Jt(t){var e,n,r,i,a,s,l,u,c,f;if(y(t)&&(t=""),(e=new o.Formatter.GeneralFormatter(t).formatters)&&!(e.length<=0)&&(n=e[0]))return i=(r=o.Common.CultureManager.getCultureInfo())&&r.id,a=n.localeIDFormatPart,s=n.dbNumberFormatPart,l=a&&a.Wc||i,u=o.Common.CultureManager.LZa(l,function(t){var e,n,o,r="",i=!1;for(e=0,n=t.length;e<n;e++)'"'===(o=t[e])&&(i=!i),"E"===o||i||(r+=o.toLowerCase());return r}(t)),c=a&&a.Kc||"",f=s&&s.Kc||"",new o.Formatter.GeneralFormatter(f+c+u)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("./dist/plugins/filter/filter-dialog.js"),a=n("./dist/plugins/filter/filter-button-images.js"),s=n("./dist/plugins/filter/filter-ns.js"),l=o.Common.q,u=r.Ul.lHb,c=o.Common.u.Ob,f=o.Formatter.lxb,h=r.Ul.Nl,p=r.Ul,d=p.nl,g=o.Common.k.ac,m=null,y=o.Common.j.Fa,v=parseFloat,C=r.GC$.inArray,b="gc-filterOK",w="gc-filterCancel",T="gc-filterSearch",x="gc-filterCheckAll",S="gc-filterUnCheckAll",I="gc-filter-button",R="gc-filter-item-link ",k="gc-filter-sort",N="gc-filter-button-hover "+(M="ui-state-hover "),O=(A="gc-filter-hover")+" form-control well "+(D=M+(E="gc-filter-item-hover")),j=" ui-corner-all ",F="ui-button-disabled",P=" ui-state-disabled",_="gc-filter-button-disable",L="gc-sub-color-filter",B="gc-sub-content-flter",G="gc-sub-color-sort",H=" gc-filter-check",V="gc-filter-check-outerDiv",z="gc-filter-button-active",W=".ui-filter-dialog",U="px",q="font-size",Y="string",X="javascript:void(0)",Z="mouseout",Q="click",J="keydown",$="div",K="mousedown",tt="mouseover",et="mouseup",ot=(nt="margin")+"Left",rt=nt+"Top",it="padding",at="display",st="none",lt="width",ut="height",ct="left",ft="box-sizing",ht="content-box",pt=o.Common.j.Ba,dt=o.Common.l.Xb,gt=o.Common.l.Ska,mt="gc-sortASC-tr",yt="gc-sortDEC-tr",vt="gc-sort-color-tr",Ct="clear_filter",bt="gc-color-filter",wt="gc-major_filter",Tt="gc-search-tr",xt="gc-filter-function-tr",St=void 0,At="automatic",It="TextFilter",Rt="NumberFilter",kt="DateFilter",Mt="gc-filter-choose-area",Nt="filter-button-tr",Et="gc-majorFilter",Dt="gc-filterDialog-rightArrow",Ot="gc-filter-disable-item",function(t){t[t.true=1]="true",t[t.false=2]="false",t[t.undefined=2]="undefined",t[t.null=3]="null"}(jt||(jt={})),Ft=new o.Common.ResourceManager(s.SR),Pt=Ft.getResource.bind(Ft),_t=function(){function t(t,e,n,o,r,i,a,s){var l=this;l.rowFilter=t,l.row=e,l.col=n,l.sheetArea=o,l.x=r,l.y=i,l.width=a,l.height=s}return t.prototype.ko=function(){var t=this.rowFilter,e=this.col,n=t.getSortState(e);return t?t.isFiltered(e)?[3,4,5][n]:n:0},t}(),e.eY=_t,Lt=function(t){function e(e,n,o,r){var i,a,s=n.parent;return(i=a=t.call(this,e,p.vl(s&&s.qo))||this).pxb={},i.fY=[],i.hY=[],i.gY=[],i.CWa=[],i.a$a=[],i.fLb=[],i.gLb=[],i.hLb=!1,i.iLb=!1,i.DWa={Number:0,Text:0,Date:0},i.EWa="",i.FWa=m,i.sheet=n,i.filterButtonInfo=o,i.lY=237,i.mY=410,i.U$a=26,i.nY=191,i.oY=150,i.lzb=1.2,i.rEscape=/[\-\[\]{}()+.,\\\^$|#\s]/g,i.elementList=[],i.activeItemIndex=m,i.xo=i.yo(),i.GWa=i.HWa(),i.IWa=i.JWa(),i.V$a=r,i.W$a=i.X$a(),i.wY(),i.xY(),a}return Bt(e,t),e.prototype.X$a=function(){var t=this,e=[],n=this.V$a,o=t.mY,r=t.U$a;return n.sortByValue?e=e.concat([1,1]):(e=e.concat([0,0]),o-=2*r),n.sortByColor?e=e.concat([1]):(e=e.concat([0]),o-=r),!0===n.filterByValue||!0===n.filterByColor?e=e.concat([1]):(e=e.concat([0]),o-=r),!0===n.filterByColor?e=e.concat([1]):(e=e.concat([0]),o-=r),!0===n.filterByValue?e=e.concat([1]):(e=e.concat([0]),o-=r),!0===n.listFilterArea?e=e.concat([1,1,1]):(e=e.concat([0,0,0]),o-=254),t.mY=o,e},e.prototype.OT=function(){var t,e=this,n=e.sheet.parent,o=e.filterButtonInfo,i=e.xo;e.yY=!!n&&n.options.useTouchLayout,e.zY(o.col),e.itemList&&e.itemList.length>0&&e.AY(e.dataSource),e.KWa(),e.LWa(),1===r.GC$("#"+wt).length&&(e.MWa=e.NWa(r.GC$("#"+wt)[0].children[2]),e.MWa.OWa(e.EWa).ad()),1===r.GC$("#"+bt).length&&(e.PWa=e.QWa(r.GC$("#"+bt)[0].children[2],L),e.PWa.ad()),1===r.GC$("#"+vt).length&&(e.RWa=e.QWa(r.GC$("#"+vt)[0].children[2],G),e.RWa.ad()),i.hide(),e.Ao((function(){e.elementList.length>0&&r.GC$(e.elementList[0]).focus()})),e.BY(e.yY),(t=o.x+o.width-i.width()-6)<5&&(t=5),i.css([ct,"top"],[t,o.y+o.height]),e.Do(),e.QQ(),e.MY(),setTimeout((function(){e.xo.focus()})),e.sheet.mm.uC()},e.prototype.BY=function(t){var e,n,o,i,a,s,l,u,c,f,h,p,d,g,m,y,C,w,x=this;t&&(e=x.lY*x.lzb,n=x.mY*x.lzb,o=e-x.lY,i=n-x.mY,Ut(x.xo,e,n),a=r.GC$("."+k),s=v(a.css("paddingTop"))+i/30,l=r.GC$("."+I),u=v(l.css(lt))+o/4,c=v(l.css(ut))+i/8,f=r.GC$("#"+b),h=v(f.css(ot))+o/2,p=r.GC$("#"+T),d=v(p.css(lt))+o,g=v(p.css(ut))+i/8,m=r.GC$("."+V),y=v(m.css(rt))+i/10,C=r.GC$("#"+S),w=v(C.css(ot))+o,a.css(it,s+U+" 6px"),Ut(l,u,c),f.css(ot,h+U),Ut(p,d,g),m.css(rt,y+U),C.css(ot,w+U))},e.prototype.close=function(){var e=this,n=e.sheet;e.xo.hide(),e.hXa&&(e.hXa.no(),e.hXa=null),t.prototype.close.call(e),r.GC$(e.CY).remove(),r.GC$(e.DY).remove(),n.GZ=null,n&&n.zt()},e.prototype.Y$a=function(){1===r.GC$("#"+mt).length&&this.Z$a(),1===r.GC$("#"+vt).length&&this.$$a()},e.prototype.Z$a=function(){var t=this,e=t.elementList,n=t.EY("gc-sortASC",Pt().SortAscending),o=t.EY("gc-sortDES",Pt().SortDescending),i=r.GC$("#"+mt)[0],s=r.GC$("#"+yt)[0];r.GC$(i.children[0]).append(r.GC$(h("img")).attr("src",a.getFilterButtonImageSrc(6))),r.GC$(s.children[0]).append(r.GC$(h("img")).attr("src",a.getFilterButtonImageSrc(7))),r.GC$(i.children[1]).append(n),r.GC$(s.children[1]).append(o),e.push(i),e.push(s)},e.prototype.$$a=function(){var t=this,e=t.elementList,n=t.EY("gc-sortColor",Pt().SortColor),o=r.GC$("#"+vt)[0],i=t.SWa(),a=this.TWa(i),s=r.GC$(h("span"));s.addClass(Dt),r.GC$(o.children[0]).append(a),r.GC$(o.children[1]).append(n),r.GC$(o.children[2]).append(s),e.push(o)},e.prototype._$a=function(t){var e,n=this.elementList,o=this.EY("gc-filter-color",Pt().FilterColor),i=r.GC$("#"+bt)[0],a=r.GC$(h("span"));a.addClass(Dt),e=this.TWa(t.isShowColorFilterSelect),r.GC$(i.children[0]).append(e),r.GC$(i.children[1]).append(o),r.GC$(i.children[2]).append(a),n.push(i)},e.prototype.a_a=function(t){var e,n=this,o=n.sheet,i=n.filterButtonInfo.col,a=n.TWa(t.isShowMajorCheck),s=r.GC$("#"+wt)[0];o.outlineColumn&&o.outlineColumn.XQa(i)&&r.GC$(s).addClass(Ot+P),r.GC$(s.children[0]).append(a),n.EY(Et,"").appendTo(s.children[1]),(e=r.GC$(h("span"))).addClass(Dt),r.GC$(s.children[2]).append(e),n.elementList.push(s)},e.prototype.b_a=function(){var t,e,n,o,i=1===r.GC$("#"+bt).length,a=1===r.GC$("#"+wt).length;(i||a)&&(e=(t=this).elementList,n=r.GC$("#"+Ct)[0],t.UWa(n),e.push(n),o=t.VWa(),i&&t._$a(o),a&&t.a_a(o))},e.prototype.c_a=function(){var t=this;t.V$a.listFilterArea&&(t.d_a(),t.e_a(),t.f_a())},e.prototype.f_a=function(){var t=I+" gc-filter-button-default ui-button ui-state-default"+j+"btn btn-default",e=r.GC$("#"+Nt)[0],n=h("button"),o=h("button"),i=r.GC$(n).text(Pt().OK).css(q,"1em").attr("id",b),a=r.GC$(o).text(Pt().Cancel).css(q,"1em").attr("id",w);Gt(n,t),Gt(o,t),r.GC$(e.children[1]).append(i).append(a),this.elementList.push(n),this.elementList.push(o)},e.prototype.e_a=function(){var t,e=this,n=e.VWa(),o=r.GC$("#"+Mt)[0],i=r.GC$(h("img")).attr("src",a.getFilterButtonImageSrc(11)).addClass("gc-filter-checked");i.css(["verticalAlign","margin-top"],["top","4px"]),n.isShowSelectCheck||i.css([at],[st]),Gt((t=e.itemList=r.GC$(h($)).css([lt,ut,ft],[e.nY,e.oY,ht]))[0],"gc-filter-item-container"),r.GC$(o.children[0]).append(i).css([at],["inline-block"]),r.GC$(o.children[1]).append(t)},e.prototype.d_a=function(){var t,e,n,o=this,i=r.GC$(h($)).css([nt,it],[0,0]),a=r.GC$(h($)).appendTo(i),s=r.GC$("#"+Tt)[0],l=r.GC$(h("input")).attr({type:"search",placeholder:Pt().Search,id:T}).appendTo(a);Gt(i[0],"gc-search-outer-div ui-widget-header"+j+"ui-multiselect-header ui-helper-clearfix"),o.elementList.push(l[0]),t=r.GC$(h($)).appendTo(i),e=o.FY(x,Pt().CheckAll,"gc-check-image ui-icon ui-icon-check"),n=o.FY(S,Pt().UncheckAll,"gc-uncheck-image ui-icon ui-icon-closethick"),Gt(t[0],V),t.append(e).append(n),r.GC$(s.children[1]).append(i)},e.prototype.xY=function(){var t=this;t.Y$a(),t.b_a(),t.c_a()},e.prototype.NWa=function(t){var e=this,n=m;switch(this.EWa){case Rt:n=new i.WWa(t,e.xo,e.filterButtonInfo,e.sheet,e,B);break;case It:n=new i.XWa(t,e.xo,e.filterButtonInfo,e.sheet,e,B);break;case kt:n=new i.YWa(t,e.xo,e.filterButtonInfo,e.sheet,e,B)}return n},e.prototype.QWa=function(t,e){var n=this,o=m;return e===L?o=new i.ZWa(t,n.xo,n.filterButtonInfo,n.sheet,n,L):e===G&&(o=new i.ZWa(t,n.xo,n.filterButtonInfo,n.sheet,n,G)),o},e.prototype.SWa=function(){var t=this.filterButtonInfo,e=!1,n=t.rowFilter.zZ;return n!==m&&n.color!==St&&t.col===n.index&&(e=!0),e},e.prototype.TWa=function(t){var e=r.GC$(h("div")),n=r.GC$(h("img")).attr("src",a.getFilterButtonImageSrc(11)).addClass("gc-filter-checked");return t||n.css([at],[st]),e.append(n),e},e.prototype.HWa=function(){var t=this,e=t.filterButtonInfo,n=e.rowFilter,o=e.col,r=t.sheet.getText(t.filterButtonInfo.row,o,e.sheetArea);return n&&n.range.row<=0?r=t.sheet.getText(e.row,o,e.sheetArea):r||(r=t.sheet.getText(0,o,1)),""===r&&1===t.sheet.options.colHeaderAutoText?r="(Column "+(o+1)+")":""===r&&(r="(Column "+p.xq(o+1)+")"),'"'+r},e.prototype.UWa=function(t){var e,n=this;n.IWa?(e=a.getFilterButtonImageSrc(12),r.GC$(t).addClass("gc-filter-item")):(e=a.getFilterButtonImageSrc(13),r.GC$(t).addClass(Ot+P)),r.GC$(t.children[0]).append(r.GC$(h("img")).attr("src",e).css([lt],["18px"])),n.v$a("gc-clearFilter",n.GWa,r.GC$(t.children[1]))},e.prototype.i$a=function(t){return 0===t.conType()&&0===t.item1().compareType()&&0===t.item2().compareType()&&5===t.item1().conType()&&5===t.item2().conType()},e.prototype.VWa=function(){var t,e,n,o=this,r=!1,i=!1,a=!1,s=o.filterButtonInfo,l=s.col,u=s.rowFilter.rZ[l];return u&&u.length>0&&(t=(u=u[0]).conType(),0===(e=u.compareType())&&3!==t&&o.V$a.listFilterArea?a=!0:0!==e||3===t||o.V$a.listFilterArea?0!==e&&3!==t?r=!0:3===t&&(i=!0):r=!0,n=this.i$a(u),(5===t&&0===e||n)&&(a=!1,r=!0)),{isShowColorFilterSelect:i,isShowMajorCheck:r,isShowSelectCheck:a}},e.prototype.JWa=function(){var t=!1,e=this.filterButtonInfo,n=e.col,o=e.rowFilter.rZ[n];return o&&o.length>0&&(t=!0),t},e.prototype.$Wa=function(){var t=Math.max(this.DWa.Date,this.DWa.Number,this.DWa.Text);return t===this.DWa.Text?It:t===this.DWa.Number?Rt:t===this.DWa.Date?kt:void 0},e.prototype.KWa=function(){var t,e=this.$Wa();this.EWa=e,t=Pt()[e],r.GC$("#"+Et).text(t)},e.prototype.WW=function(){var t,e=this.filterButtonInfo,n=this.sheet,o=e.col,r=e.rowFilter;r&&(t={tableName:r.sj?r.sj.name():St,colIndex:o},n.wu().execute({cmd:"clearFilter",sheetName:n.name(),cmdOption:t}),this.close())},e.prototype.LWa=function(){var t,e=!1,n=this._Wa,o=this.aXa,r=n.colorNumber,i=o.colorNumber;n.automatic&&r++,o.automatic&&i++,(r!==St&&r>1||i!==St&&i>1)&&(e=!0),t=this.VWa(),e||(!t.isShowColorFilterSelect&&this.bXa(bt),!this.SWa()&&this.bXa(vt))},e.prototype.bXa=function(t){r.GC$("#"+t).addClass(Ot+P).find("."+Dt)},e.prototype.wY=function(){var t,e,n,o,i,a,s,l=this,u=l.xo,c=" gc-sort-container ui-menu-item",f=l.table=r.GC$(h("table")).css([it,at],[0,"table"]).attr({cellspacing:0,cellpadding:0});for(Gt(f[0],"gc-layout-table"),n=[mt,yt,vt,Ct,bt,wt,Tt],o=l.W$a,t=0;t<9;t++)if(1===o[t])for(i=h("tr"),a=r.GC$(i).appendTo(f),t<6&&(r.GC$(i).attr("id",n[t]).css([at,ut,q],["table-row","26px","9pt"]),r.GC$(i).addClass(xt)),6===t&&r.GC$(i).attr("id",n[t]),7===t&&r.GC$(i).attr("tabindex",0).attr("id",Mt),8===t&&r.GC$(i).attr("id",Nt),qt(i),e=0;e<3;e++)s=h("td"),r.GC$(s).appendTo(a),qt(s),0===e?Gt(s,"gc-layout-table-first-column"):2===e?Gt(s,"gc-layout-table-last-column"):1===e&&(0===t?Gt(s,"gc-filter-sort-asc-container"+c+"gc-layout-table-middle-column"):1===t&&Gt(s,"gc-filter-sort-desc-container"+c+"gc-layout-table-middle-column"));l.table.appendTo(u),u.css(["box-shadow",lt,ut,ft],["rgba(0, 0, 0, 0.15) 2px 4px 5px",l.lY+U,l.mY+U,ht]),Gt(u[0],"gc-filter-dialog-style gc-no-user-select"),u.appendTo(l.zo())},e.prototype.QQ=function(){var t,e,n,o=this,i=!1,a=!1,s=r.GC$("."+I);r.GC$("#"+mt).bind(et,(function(t){i&&(i=!1,o.JY(!0),o.close(),d(t))})).bind(K,(function(t){d(t),i=!0})),r.GC$("#"+yt).bind(et,(function(t){a&&(a=!1,o.JY(!1),o.close(),d(t))})).bind(K,(function(t){d(t),a=!0})),r.GC$("."+xt).bind(tt,(function(){o.MWa&&r.GC$(this).attr("id")!==wt&&o.MWa.cXa()&&(o.MWa.hT(),o.FWa=m,Wt(r.GC$("#"+wt)[0],O)),o.PWa&&r.GC$(this).attr("id")!==bt&&o.PWa.cXa()&&(o.PWa.hT(),o.FWa=m,Wt(r.GC$("#"+bt)[0],O)),o.RWa&&r.GC$(this).attr("id")!==vt&&o.RWa.cXa()&&(o.RWa.hT(),o.FWa=m,Wt(r.GC$("#"+vt)[0],O)),!r.GC$(this).hasClass(P.trim())&&r.GC$(this).index()<6&&Gt(this,O)})).bind(Z,(function(){o.MWa&&r.GC$(this).attr("id")===wt&&(clearTimeout(t),o.MWa.cXa())||o.PWa&&r.GC$(this).attr("id")===bt&&(clearTimeout(e),o.PWa.cXa())||o.RWa&&r.GC$(this).attr("id")===vt&&(clearTimeout(n),o.RWa.cXa())||Wt(this,O)})),r.GC$("#"+Ct).bind(Q,(function(){o.IWa&&o.WW()})),r.GC$("#"+wt).bind(tt,(function(){r.GC$(this).hasClass(Ot)||(t=setTimeout((function(){o.FWa=o.MWa,o.FWa.Ao()}),500))})),r.GC$("#"+bt).bind(tt,(function(){r.GC$(this).hasClass(Ot)||(e=setTimeout((function(){o.FWa=o.PWa,o.FWa.Ao()}),500))})),r.GC$("#"+vt).bind(tt,(function(){r.GC$(this).hasClass(Ot)||(n=setTimeout((function(){o.FWa=o.RWa,o.FWa.Ao()}),500))})),r.GC$("#"+x).bind(K,(function(t){d(t)})).bind(et,(function(t){o.KY(t,!0)})),r.GC$("#"+S).bind(K,(function(t){d(t)})).bind(et,(function(t){o.KY(t,!1)})),r.GC$("#"+T).bind(J,(function(t){13===(t.which||t.keyCode)&&t.preventDefault()})).bind("keyup",(function(t){C(t.keyCode,[9,37,38,39,40])<0&&(o.NY(),o.MY())})).bind("search",(function(t){o.NY(),o.MY()})),s.bind(tt,(function(){Gt(this,N)})).bind(Z,(function(){Wt(this,N)})),s.bind(K,(function(){Wt(this,N),Gt(this,z)})).bind(Z,(function(){Wt(this,z)})),r.GC$("#"+b).bind(Q,(function(){var t,e,n,r,i,a,s;if(o.dXa(),t=o.fLb,e=[],n=o.hY,r=t.length,i=n.length,o.hLb){for(a=0;a<(r>i?r:i);a++)n[a]&&e.push(n[a]),!t[a]||t[a].repeat||t[a].noCheck||e.push(t[a]);o.hY=e}s=o.hY,o.sheet.suspendPaint(),o.PY(s),o.sheet.resumePaint(),o.close()})),r.GC$("#"+w).bind(Q,(function(){o.close()})),o.xo.bind("mousewheel",(function(t){d(t)})).bind("DOMMouseScroll",(function(t){d(t)})).bind(J+W,(function(t){o.QY(t)})).bind("keyup"+W,(function(t){d(t)})),o.itemList&&o.itemList.length>0&&(o.hXa.bind(r.Events.TopRowChanged,(function(t,e){o.fXa(e)})),o.hXa.bind(r.Events.CellClick,(function(t,e){o.gXa(e)})),o.hXa.bind(r.Events.TouchToolStripOpening,(function(t,e){e.handled=!0})))},e.prototype.fXa=function(t){var e,n,o,r,i,a,s,l,u;t.oldTopRow>t.newTopRow||(e=this,o=(n=t.sheet).parent,r=t.newTopRow,i=n.jt(1).length,a=e.itemList.width(),s=e.iXa,l=n.getColumnWidth(s),o.options.showVerticalScrollbar&&(a-=22),u=Math.max(n.getColumnCount()*l,a),e.PZa(n,u,l,r,i))},e.prototype.PZa=function(t,e,n,o,i,a){var s,l,u,c=0,f=0,h=t.parent,p=this.iXa,d=o+i,g=t.outlineColumn.WZa(),m=Math.min(d,t.getRowCount());for(s=o;s<m;s++)l=a&&a[s].name||t.getText(s,p),u=g[s].cellContent.left,(f=r.Vn.Xn(l)+u-e)>0&&f>c&&(c=f);c>0&&(t.addColumns(t.getColumnCount(),Math.ceil(c/n)),h.options.showHorizontalScrollbar=!0)},e.prototype.gXa=function(t){var e,n,o,i,a,s,l,u,c,f=this,p=t.sheet,d=t.row,m=t.sheetArea,y=f.iXa;f.activeItemIndex=d,e=f.eXa.outlineColumn.getCheckStatus(),"add_current"===f.dataSource[0].key&&0===d&&(1===e[0]?f.hLb=!0:f.hLb=!1),p.suspendPaint(),!t.ignoreClick&&p.yt&&((o=(n=p.yt.cellTypeHitInfo)&&n.outlineColumnHitInfo)&&o.indicator||(p.outlineColumn.getCheckStatus(d,y)===f.dataSource[d].status&&p.outlineColumn.setCheckStatus(d,f.MZa(f.dataSource[d].status)),f.DZa())),p.CH&&p.m_a("transparent"),i=r.GC$("."+E,this.xo[0]),g(i)>0?Wt(i,D):f.jXa(p),s=(a=p.getStyle(d,y,m))&&a.clone()||new r.Style,Gt(l=r.GC$(h($)),O),this.xo.append(l),u=l.css("backgroundColor"),c=l.css("color"),l.remove(),s.backColor=u,s.foreColor=c,p.setStyle(d,-1,s),p.resumePaint(),f.dXa(),f.MY()},e.prototype.DZa=function(){for(var t=this.eXa.outlineColumn.getCheckStatus(),e=0;e<t.length;)this.dataSource[e].status=t[e],e++},e.prototype.MZa=function(t){return 1===t?2:1},e.prototype.jXa=function(t){var e,n,o=t.getRowCount(),r=this.iXa;for(e=0;e<o;e++)if((n=t.getActualStyle(e,r)).backColor||n.foreColor){n.foreColor=n.backColor=void 0,t.setStyle(e,-1,n);break}},e.prototype.dXa=function(){var t,e,n,o,r,i,a,s,l,u=this,c=u.eXa.outlineColumn.getCheckStatus(),f=0,h=u.gY||u.hY,p=u.CWa,d=0;for("add_current"===u.dataSource[0].key&&(f=1),u.hY=[],e=0;e<p.length&&(t=p[e],!(d>=h.length));e++)if(t.key===h[d].text){for(d++,n=t.children,o=St,r=0;r<n.length;r++)i=n[r],a=c[f],!1!==i.show&&(f+=1),o=a||o,3!==a&&(i.status=a);if(2!==o)u.hY.push({text:t.key,value:t.value,type:t.type});else if((s=u.gLb)[e])if(s[e].value===t.value)u.gLb[e]=null;else for(l=e+1;l<s.length;){if(s[l]&&s[l].value===t.value){u.gLb[l]=null;break}l++}}},e.prototype.KY=function(t,e){var n=this,o=n.eXa,r=jt[e];o.suspendPaint(),o.outlineColumn.Wlb(r),o.resumePaint(),n.DZa(),n.hY=e?Yt(n.gY):[],!e&&n.hLb&&(n.hLb=!1),e&&n.iLb&&(o.outlineColumn.Kia.QR[0].checkBox.checkStatus=0,o.outlineColumn.refresh()),n.MY(),d(t)},e.prototype.kXa=function(t){switch(t){case wt:this.FWa=this.MWa;break;case bt:this.FWa=this.PWa;break;case vt:this.FWa=this.RWa}},e.prototype.lXa=function(t){var e=this;e.FWa=t,e.FWa.Ao(),e.FWa.mXa()},e.prototype.nXa=function(t){var e,n,o,i=g(t);0!==i&&(e=this,o=(n=t.attr("id"))===mt,1===i?o||n===yt?(e.JY(o),e.close()):n===w?e.close():n===wt?e.FWa!==m?e.FWa.oXa():e.lXa(e.MWa):n===bt?e.lXa(e.PWa):n===vt?e.lXa(e.RWa):n===Ct?e.WW():r.GC$("#"+b).trigger(Q):2===g(t)||3===g(t)?e.FWa&&e.FWa.oXa():r.GC$("#"+b).trigger(Q))},e.prototype.pXa=function(){var t,e,n,o,r=this.CWa,i=this.gY,a=0,s=[];for(t=0;t<r.length;t++)if(r[t].key===i[a].text)for(a++,e=r[t].children,n=0;n<e.length;n++)!1!==(o=e[n]).show&&s.push(o.value||r[t].key);return s},e.prototype.qXa=function(t,e,n){var o,r,i=this,a=i.elementList;return!g(e)&&y(i.activeItemIndex)?o=a[0]:(g(e)?Wt(e,D):i.jXa(i.eXa),r=i.pXa(),o=4===t?i.rXa(r,e,n):i.sXa(r,e,t)),o},e.prototype.sXa=function(t,e,n){var o,r,i,a,s=this,l=s.elementList,u=e[0],c=l.length-2,f=Yt(l),h=s.activeItemIndex||0,p=0;for(r=0;r<g(t);r++)f.splice(-2,0,t[r]);if(a=3===n,(i=u?C(u,f):c+h)>=0){for(o=a?f[i+1]:f[i-1],h=h||0,p=a?i+1:i-1,C(o,t)>=0&&g(e)>0&&(i=a?i+h:h+(l.length-2),o=a?f[i+1]:f[i],p=a?i+1:i);a&&i<g(f)&&s.RY(o);)p=i+1,o=f[(i+=1)+1];if(!a){for(;i>0&&s.RY(o);)p=i-1,o=f[(i-=1)-1];o||(o=f[g(f)-1])}o||(o=f[0])}return typeof o===Y?p-c:o},e.prototype.rXa=function(t,e,n){var o,r,i=this,a=i.elementList,s=e[0],l=Yt(a),u=i.activeItemIndex||0;if(l.splice(-2,0,t[u]),g(e)){if((r=C(s,l))>=0){for(o=n?l[r-1]||l[g(l)-1]:l[r+1];n&&r>0&&i.RY(o);)o=l[(r-=1)-1];for(;!n&&i.RY(o)&&r<g(l);)o=l[(r+=1)+1]}}else o=n?a[a.length-3]:i.RY(a[a.length-2])?a[a.length-1]:a[a.length-2];return o||(o=l[0]),typeof o===Y?u:o},e.prototype.QY=function(t){var e,n,o,i=this,a=r.GC$("."+E,i.xo[0]),s=t.which||t.keyCode,l=C(s,[27,13,38,40,9,37,39]);a.length>0&&(e=a.attr("id")),0===l?(i.close(),d(t)):1===l?this.nXa(a):l>4?(5===l?(i.FWa===m&&i.kXa(e),i.FWa!==m&&(i.FWa=i.FWa.tXa())):6===l&&(i.FWa===m&&i.kXa(e),i.FWa===m||i.FWa.P$a||i.FWa.uXa()),d(t)):l>1&&i.FWa!==m&&i.FWa.cXa()?(2===l||4===l&&t.shiftKey?i.FWa.vXa():(3===l||4===l&&!t.shiftKey)&&i.FWa.wXa(),d(t)):l>1&&("number"==typeof(n=i.qXa(l,a,t.shiftKey))?(a=n,i.gXa({sheet:i.eXa,row:a,sheetArea:3,ignoreClick:!0}),i.eXa.Yq(a,i.iXa),r.GC$("#"+Mt).focus(),d(t)):((o=(a=r.GC$(n)).attr("id"))!==T&&o!==b&&o!==w?a.find("a").focus():a.focus(),Gt(a,A+" "+D),d(t)))},e.prototype.RY=function(t){return typeof t!==Y&&(t=r.GC$(t),0!==g(t)&&!!(t.hasClass(F)||t.hasClass(P)||t.hasClass(_)))},e.prototype.PY=function(t){var e,n,o,r,i=this,a=i.sheet;if(a)try{if(a.suspendPaint(),!(n=(e=i.filterButtonInfo).rowFilter))return;o=e.col,r={tableName:n.sj?n.sj.name():St,colIndex:o,checkedValues:t,allValuesLength:g(i.fY)},a.wu().execute({cmd:"filterTextSelectAction",sheetName:a.name(),cmdOption:r})}finally{a.resumePaint()}},e.prototype.NY=function(){var t,e,n,o,i,a,s,u,c,f,h,p,d,m,y,v=this,C=r.GC$.trim(r.GC$("#"+T).val().toLowerCase()),b=v.CWa,w=v.a$a,x={},S=v.gLb;if(S.forEach((function(t){t&&t.repeat&&delete t.repeat})),C){for(n=[],o=void 0,(e=l.ub(C))||(o=RegExp(C.replace(v.rEscape,"\\$&"),"gi")),t=0;t<b.length;t++)for(a=(i=b[t]).children,s=0;s<a.length;s++){if(u=a[s],c=i.key,f=i.type,h=u.value||c,(p=e&&l.sb(e).exec(h))&&0===p.index||!e&&-1!==h.search(o)){if(n.push({text:c,value:i.value,type:f}),(d=S[t])&&d.value===i.value)d.repeat=!0;else for(m=t+1;m<S.length;){if((y=S[m]).value===i.value){y.repeat=!0;break}m++}x[c]=!0;break}S[t]&&S[t].repeat&&delete S[t].repeat}v.jLb=!0,v.gY=Yt(n),v.fLb=S,v.hY=Yt(n),v.HY(x)}else if(g(w)){for(this.iLb=!1,t=0;t<w.length;t++)1!==w[t].status&&(w[t].status=1);v.gY=Yt(v.fY),v.hY=Yt(v.fY),v.AXa(w),v.dataSource=w}else this.iLb=!1,v.a$a=Yt(v.dataSource)},e.prototype.EY=function(t,e){var n=r.GC$(h("a"));return n.attr({id:t,href:X}).text(e).css([at,it,"cursor",nt,"text-decoration","text-align",q,"outline",ut],["block","0 6px","default","0px 0 1px 2px",st,ct,"12px",st,"inherit"]),Gt(n[0],R+k+j),n},e.prototype.v$a=function(t,e,n){var o,i,a,s=Pt().Clear,l=r.GC$(h("a")).html(s.replace("{0}",'"'));l.attr({id:t,href:X}).css([at,it,"cursor",nt,"text-decoration","text-align",q,"outline",ut,"white-space"],["inline","0 6px","default","0px 0 1px 2px",st,ct,"12px",st,"inherit","nowrap"]),n.append(l),o=n.width()-l[0].offsetWidth,a='<span class="filterName">'+c(e)+'</span><span style="vertical-align: top">"</span>',i=s.replace("{0}",a),l.html(i),r.GC$(".filterName",l[0]).css(["max-width","overflow","text-overflow",at,"vertical-align"],[o+"px","hidden","ellipsis","inline-block","text-bottom"]),Gt(l[0],R+k+j)},e.prototype.FY=function(t,e,n){var o=h("span"),i=r.GC$(h("span")).text(e),a=h("a"),s=r.GC$(a);return Gt(o,"gc-check-uncheck-all "+n),s.attr({href:X,id:t}).css(["float",ot,it,q,ut],[ct,"7px","0","12px","16px"]).append(r.GC$(o)).append(i),Gt(a,H+H+"-style"),s},e.prototype.xXa=function(t){return"date"===t?void this.DWa.Date++:"number"===t||"boolean"===t?void this.DWa.Number++:"string"===t?void this.DWa.Text++:void 0},e.prototype.yXa=function(){var t=this.DWa.Date,e=this.DWa.Number,n=this.DWa.Text,o=t+e+n;return o>t&&o>e&&o>n?"mix":o===t?"type":o===e?"number":o===n?"text":void 0},e.prototype.YZa=function(t){var e,n=!0,o=t.rZ[this.filterButtonInfo.col];return o&&o.length>0&&(o=o[0],e=this.i$a(o),(0!==o.compareType()||e||0===o.compareType()&&5===o.conType())&&(n=!1)),n},e.prototype.qxb=function(t){var e,n=this.pxb[t];return y(n)&&(e=t.replace(/(\[[^h^m^s]+\])|(General)/gi,""),n=f.Lc(e),this.pxb[t]=n),n},e.prototype.T0=function(t,e){return"number"===pt(e)&&"string"===pt(t)&&this.qxb(t)?dt(e):e},e.prototype.Q$a=function(t,e,n,o,r,i){zt(t!==m&&t.backColor,n,o,r,i),zt(t!==m&&t.foreColor,e,o,r,i)},e.prototype.zY=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this,v=y.filterButtonInfo.rowFilter;if(v){if(o=(n=(e=y.sheet).Tq(v.range)).col,r={},i=[],a={},s=[],u=e.currentTheme(),c={},f={data:{},colorNumber:0},h={data:{},colorNumber:0},p=e.outlineColumn&&e.outlineColumn.XQa(t),d=y.V$a.sortByColor||y.V$a.filterByColor,y.hasBlank=!1,t>=o&&t<o+n.colCount)for(g=0;g<n.rowCount;g++)m=n.row+g,(e.getRowHeight(m)>0||!v.isFiltered()||v.ima(m,t))&&d&&(l=e.getActualStyle(m,t,3,!1,!1,!0),this.Q$a(l,h,f,u,m,c)),y.u$a(r,a,i,m,t,s);y._Wa=f,y.aXa=h,p||(i.sort(Vt),s.sort(Vt)),y.fY=i,y.gLb=s,y.gY=Yt(i),y.CWa=y.zXa(t,a,i),y.a$a=y.dataSource}},e.prototype.$gc=function(t,e,n){var o,r=this.sheet;return n||((o=r.getActualStyle(t,e))&&o._autoFormatter&&o._autoFormatter.formatCached?o._autoFormatter.formatCached:void 0)},e.prototype.u$a=function(t,e,n,o,r,i){var a,s,l,c,f,h,p,d,g,m=this,y=m.sheet,v=m.filterButtonInfo.rowFilter,C=y.getText(o,r),b=y.getValue(o,r);a=C=C?C.trim():C,s=Pt().Blanks,l=y.getRowHeight(o)>0,c=m.YZa(v),f=y.outlineColumn&&y.outlineColumn.XQa(r),(h=y.getFormatter(o,r))&&!u(h)&&(b=m.T0(h,b)),d="date"===(p=Xt(b,m.$gc(o,r,h))),m.xXa(p),1===m.DWa.Date&&(m.XZa=Jt(h)),d&&(a=v.mzb.format(b)),g=c&&(l||!v.isFiltered(r)||f&&y.getRowVisible(o,3,!0)&&!v.WY(o,r)),""!==C||!l&&v.isFiltered()&&!v.ima(o,r)?t[a]||y.getRowVisible(o,3,!0)&&y.Yr(o)&&(g?(e[C]=!0,m.hY.push({text:C,value:b,type:p}),i.push({text:C,value:b,type:p})):i.push({text:C,value:b,noCheck:!0,type:p}),(l||!v.isFiltered()||v.ima(o,r))&&(n.push({text:C,value:b,type:p}),t[a]=!0)):m.hasBlank||(m.hasBlank=!0,n.push({text:s,value:b,type:p}),g?(e[s]=!0,m.hY.push({text:s,value:b,type:p}),i.push({text:s,value:b,type:p})):i.push({text:s,value:b,noCheck:!0,type:p}))},e.prototype.zXa=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m=this,y=[],v=[],C=m.sheet,b=C.Tq(m.filterButtonInfo.rowFilter.range),w=C.outlineColumn;if(w&&w.XQa(t))for(l=0;l<n.length;l++)h=n[l].text,p=n[l].value,d=n[l].type,s=jt[!!e[h]],u=Qt(C,h,p,b.row+l,t,s,d),y.push(u),(f=u.children[0])&&!1!==f.show&&v.push({name:f.value||u.key,level:f.level,status:f.status});else for(l=0;l<n.length;l++)switch(h=n[l].text,p=n[l].value,d=n[l].type){case"date":for(s=jt[!!e[h]],o=(c=(u=Zt(m.XZa,h,p,s,d)).children)[0].value,r=c[1].value||c[0].value,c[0].show=c[1].show=!0,o===i&&(c[0].show=!1,r===a&&(c[1].show=!1)),i=o,a=r,y.push(u),f=u.children,g=0;g<3;g++)f[g]&&!1!==f[g].show&&v.push({name:f[g].value||u.key,level:f[g].level,status:f[g].status});break;case"number":case"string":case"boolean":case"blank":case"array":case"object":s=jt[!!e[h]],u=Qt(C,h,p,b.row+l,t,s,d),y.push(u),(f=u.children[0])&&!1!==f.show&&v.push({name:f.value||u.key,level:f.level,status:f.status})}return m.dataSource=v,y},e.prototype.AY=function(t){var e=this,n=e.itemList,o=new r.Workbook(n[0]);o.jDc=!0,e.hXa=o,e.eXa=o.getActiveSheet(),e.iXa=0,e.AXa(t),e.DZa()},e.prototype.AXa=function(t){var e,n,o,i,a,s,l=this,u=l.hXa,c=l.itemList,f=c.width(),h=c.height();l.hXa.sheets.length>0&&(l.hXa.removeSheet(0),l.eXa=St),u.addSheet(0,new r.Worksheet("sheet1")),e=l.eXa=u.sheets[0],u.suspendEvent(),e.suspendPaint(),n=u.options,o=e.options,n.allowContextMenu=!1,n.showHorizontalScrollbar=!1,n.showVerticalScrollbar=!1,n.scrollbarMaxAlign=!0,n.tabStripVisible=!1,n.allowUserResize=!1,n.allowUserDragDrop=!1,n.allowUserDragFill=!1,n.allowUserZoom=!1,n.grayAreaBackColor="white",o.colHeaderVisible=!1,o.rowHeaderVisible=!1,o.selectionBackColor="transparent",o.selectionBorderColor="transparent",o.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},o.isProtected=!0,e.defaults.rowHeight=20,e.defaults.colWidth=10,e.setRowCount(0===t.length?0:t.length+1),(i=new r.Style).font='12px "Segoe UI", Calibri, Thonburi, Arial, Verdana, sans-serif, "Mongolian Baiti", "Microsoft Yi Baiti", "Javanese Text"',e.setDefaultStyle(i),e.outlineColumn.options({columnIndex:l.iXa,showIndicator:!0,showCheckBox:!0}),e.showRowOutline(!1),e.setColumnCount(1),t.length>0&&l.jLb?(l.jLb=!1,t.unshift({name:Pt().add_current_filter,level:0,status:0,key:"add_current",value:"add_current",children:[]}),l.iLb=!0):0===t.length&&(l.jLb=!1),l.BXa(e,t),20*t.length>h&&(u.options.showVerticalScrollbar=!0,f-=22),a=e.jt(1).length,l.PZa(e,f,10,0,a,t),!u.options.showVerticalScrollbar&&u.options.showHorizontalScrollbar&&(h-=22,20*t.length>h&&(u.options.showVerticalScrollbar=!0,f-=22)),s=Math.ceil(f/10),e.addColumns(e.getColumnCount(),s-1),e.outlineColumn.refresh(),e.resumePaint(),u.resumeEvent()},e.prototype.BXa=function(t,e){var n,o,r,i,a,s,l;if(0!==e.length){if(n=this,o=0,i=0,a=t.outlineColumn,s=n.iXa,t.suspendPaint(),t.autoGenerateColumns=!1,t.bindColumn(0,"name"),t.setDataSource(e),"text"!==(l=n.yXa())&&"number"!==l||a&&a.XQa(n.filterButtonInfo.col))for(i=0;i<e.length;i++)o=e[i].level,t.getCell(i,s).textIndent(o);else t.getCell(-1,s).textIndent(o);for(a.refresh(),i=0;i<e.length;i++)r=e[i].status,a.CXa(i,r);t.resumePaint()}},e.prototype.HY=function(t){var e=this;e.zXa(e.filterButtonInfo.col,t,e.gY),e.AXa(e.dataSource)},e.prototype.JY=function(t){var e,n,o,i,a=this,s=a.filterButtonInfo,l=s.rowFilter,u=a.sheet,c=u.Tq(a.filterButtonInfo.rowFilter.range);l&&u&&u.hK()&&(e=u.oec(c,!0,null),n=s.col,o={sheet:u,sheetName:u.name(),col:n,ascending:t,range:c,compareFunction:St,groupSort:e.groupSort,ignoreHidden:e.ignoreHidden,cancel:!1},u.Wq(r.Events.RangeSorting,o),!1===o.cancel&&(i={tableName:l.sj?l.sj.name():St,colIndex:n,compareFunction:o.compareFunction,groupSort:o.groupSort,ignoreHidden:o.ignoreHidden,isAsc:t},u.wu().execute({cmd:"sortFilter",sheetName:u.name(),cmdOption:i}),u.Wq(r.Events.RangeSorted,o)))},e.prototype.DXa=function(t,e,n){var o,i,a,s=this.filterButtonInfo,l=s.rowFilter,u=this.sheet;l&&u&&u.hK()&&(""!==t&&(t=Ht(t,u.currentTheme())),n=n!==St&&n,o=s.col,i={sheet:u,sheetName:u.Cj,col:o,ascending:n,color:t,isBackColor:e,cancel:!1},u.Wq(r.Events.RangeSorting,i),!1===i.cancel&&(a={tableName:l.sj?l.sj.name():St,colIndex:o,isAsc:n,color:t,isBackColor:e},u.wu().execute({cmd:"sortFilter",sheetName:u.name(),cmdOption:a}),u.Wq(r.Events.RangeSorted,i)))},e.prototype.MY=function(){var t=r.GC$("#"+b),e=F+P+" "+_;this.hLb||g(this.hY)>0?(t.prop("disabled",!1),Wt(t[0],e)):(t.prop("disabled",!0),Gt(t[0],e))},e}(r.Go),e.gZ=Lt},"./dist/plugins/filter/filter.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/filter/filter-ns.js")),n("./dist/plugins/filter/filter-actions.js"),o(n("./dist/plugins/filter/filter-ui.js")),o(n("./dist/plugins/filter/filter.js"))},"./dist/plugins/filter/filter.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function j(t,e,n,o){var r,i;for(i=0;i<b(t);i++)if((r=t[i])&&r.row===e&&r.col===n&&r.sheetArea===o)return r;return u}function F(t,e){var n,o=L(t),r=t.compareType();2===o||7===o?(n=t.jzb,-1!==y(e,"T")||n?-1===y(e,"DT")&&n&&e.push("DT"):e.push("T")):3===o?0===r&&-1===y(e,"BC")?e.push("BC"):1===r&&-1===y(e,"FC")&&e.push("FC"):-1===y(e,"V")&&e.push("V")}function P(t){return t.getColumnCount()}function _(t,e){return t.getRowCount(e)}function L(t){return t.conType()}function B(t,e,n){var r,i,a=t.typeName;a&&a!==w?(r=o.getTypeFromString(a))&&(i=new r):i=new M,i&&(e.xr=i,i.kj=e,i.fromJSON(t,n),i.reFilter())}function G(t){var e,n=[],o=Object.keys(t);for(e=0;e<o.length;e++)n.push(+o[e]);return n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("ConditionalFormatting"),a=n("./dist/plugins/filter/filter-ui.js"),s=n("./dist/plugins/filter/filter-ns.js"),l=n("./dist/plugins/filter/filter-button-images.js"),u=null,c=void 0,f=i.$V,h=o.kf,p=r.Common.j.Fa,d=r.Common.j.Ca,g=parseInt,m=r.Common.k,y=m.Cb,v=m.Bb,C=m.Fb,b=m.ac,w="HideRowFilter",T=o.GC$,x=T.each,S=new r.Common.ResourceManager(s.SR),A=S.getResource.bind(S),I={rowFilter:function(t){var e=this,n=e.xr;return b(arguments)?(e.ITa.gVa(n,0),n&&n.reset(),(n=e.xr=t)&&(e.xr.kj=e),e.$p(),e):n},iZ:function(){var t,e,n,o,r,i,s,l,u,c,f=this,p=[],d=f.rowFilter(),g=d&&d.range,m=f.tables;if(g&&(o=g.row,i=void 0,s=(r=g.col)<0?P(f):r+g.colCount,e=r<0?0:r,o<1?(t=_(f,1)-1,i=1):(t=o-1,i=3),t>=0))for(;e<s;)d.filterButtonVisible(e)?(l=f.ITa.getSpans(h(t,e,1,1),i),u=void 0,(n=new a.eY(d)).sheetArea=i,n.row=t,b(l)?(u=l[0],n.row=u.row,n.col=u.col,e+=u.colCount):(n.col=e,e++),p.push(n)):e++;return m&&(c=m.all(),x(c,(function(o,r){if(t=r.headerIndex(),r&&r.showHeader()&&t>=0){var i=r.range(),s=void 0;for(s=0;s<i.colCount;s++)e=i.col+s,r.filterButtonVisible(s)&&(n=new a.eY(r.rowFilter(),t,e,3),p.push(n))}}))),p},jZ:function(){var t=this,e=t.kZ;return e||(e=t.kZ=t.iZ()),e},Ps:function(t,e){var n=this.filterRowsVisibleInfo;return p(e)&&(e=3),!(3!==e&&2!==e||!n||n.lZ(t))},Nu:function(){return this.filterRowsVisibleInfo.mZ()},oK:function(t,e){var n=this,o=n.zoom(),r=n.parent,i=o>1?1:o,a=3===e||e===c?n.defaults.rowHeight:n.defaults.colHeaderRowHeight,s=g(""+Math.min(20,a)*i);return r&&r.options.useTouchLayout&&(s=g(""+a*o)),{x:t.x+t.width-s,y:t.y+t.height-s,width:s,height:s}}},T.extend(o.Worksheet.prototype,I),function(t){t[t.filter=0]="filter",t[t.unfilter=1]="unfilter"}(e.FilterActionType||(e.FilterActionType={})),R={sortByValue:!0,sortByColor:!0,filterByColor:!0,filterByValue:!0,listFilterArea:!0},k=function(){function t(t){var e=this;e.range=t,e.reset(),e.typeName="",e.filterHandler=u}return t.prototype.no=function(){this.kj=u,this.sj=u},t.prototype.filterButtonVisible=function(t,e){var n,o,r,i,a,s,l,u,f,h,d,g=this,m=g.range;if(!p(m)){if(n=g.kj,o=g.oZ(m),r=g.pZ(m,n),i=arguments,a=g.qZ,s=t>=o&&t<r,l=b(i),f=typeof(u=i[0]),0===l){for(h=o;h<r;h++)if(a[h]||a[h]===c)return!0;return!1}if(d=t,1===l){if("number"===f)return s&&a[d]===c&&(a[d]=!0),a[d];if("boolean"===f)for(n&&n.ITa.gVa(g,3),h=o;h<r;h++)a[h]=u}else 2===l&&s&&(n&&n.ITa.gVa(g,4),a[d]=e);return n&&n.$p(),g}},t.prototype.oZ=function(t){return t.col<0?0:t.col},t.prototype.pZ=function(t,e){return e&&t.col<0?P(e):t.col+t.colCount},t.prototype.addFilterItem=function(t,e){var n,o=this,r=o.kj,a=o.range,s=o.rZ,l=s[t];if(p(e))throw Error(A().Exp_FilterItemIsNull);if(t<-1||t>=P(r))throw Error(A().Exp_InvalidColumnIndex);if(a){if(r.ITa.gVa(o,5),t<(a=r.Tq(a)).col||t>=a.col+a.colCount)return;if(l||(l=[]),e instanceof i.Condition)l.push(e);else if(d(e))for(n=0;n<e.length;n++)l.push(e[n]);s[t]=l}},t.prototype.removeFilterItems=function(t,e){this.kj.ITa.gVa(this,6),this.NX(t),this.unfilter(t,e)},t.prototype.NX=function(t){var e=this.rZ;this.sZ(t),e[t]&&e.splice(t,1,u)},t.prototype.unfilter=function(t,e){var n,o,r,i=this,a=i.kj;if(a){if(a.ITa.gVa(i,2),n=[],o=i.Je,r=void 0,p(t))for(r=b(o)-1;r>=0;r--)n.push(o[r]),i.OX(o[r]);else n.push(t),i.OX(t),i.reFilter(e);e||i.tZ(a,1,n)}},t.prototype.uZ=function(t){var e,n,o,r,i,a,s=this,l=s.range;if(s.OX(t),s.rZ[t]&&l){if(-1!==(e=l.col)&&(t<e||t>=e+l.colCount))return;for(n=(l=s.kj.Tq(l)).row,o=l.rowCount,r=s.vZ(t,n,o),i=void 0,(a=s.wZ(n,o,t,r)).forEach((function(t){t.nxb()})),i=n;i<n+o;i++)s.isRowFilteredOut(i)||s.xZ(a,i,t,r);a.forEach((function(t){t.oxb()})),s.RX(t,!0)}},t.prototype.vZ=function(t,e,n){var o,r,i,a,s,l,u,c,f=this,h=f.kj,p=function(t){var e,n,o,r,i=[];for(e=0;e<b(t);e++)0===L(n=t[e])?(o=n.item1(),r=n.item2(),o&&F(o,i),r&&F(r,i)):F(n,i);return i}(f.rZ[t]),d={},g=b(p);for(o=e;o<e+n;o++){for(s={},r=0;r<g;r++)"T"===(i=p[r])?(l=h.getText(o,t),s[i]=l?l.trim():l):"DT"===i?(u=h.getValue(o,t),c=f.mzb,s[i]=c.format(u)):"BC"===i?(a=h.getActualStyle(o,t,3,!1,!1,!0))&&(s[i]=a.backColor):"FC"===i?(a=h.getActualStyle(o,t,3,!1,!1,!0))&&(s[i]=a.foreColor):"V"===i&&(s[i]=h.getValue(o,t));d[o]=s}return d},t.prototype.filter=function(t,e){var n,o,r=this,i=r.kj,a=r.rZ;if(i){if(i.ITa.gVa(r,7),o=[],p(t))for(n=0;n<b(a);n++)a[n]&&(o.push(n),r.uZ(n));else{if(!a[t])return;o.push(t),r.uZ(t)}e||r.tZ(i,0,o)}},t.prototype.tZ=function(t,e,n){var o,r=this;t.AR&&t.AR(),o=r.SX(e,n),r.filterHandler&&r.filterHandler(o),r.onFilter(o),t.$p()},t.prototype.SX=function(t,e){var n,o,r,i=this,a=i.kj,s=i.range,l=[],u=[];if(s)for(r=void 0,r=o=(n=a.Tq(s)).row;r<o+n.rowCount;r++)i.isRowFilteredOut(r)?u.push(r):l.push(r);return{action:t,sheet:a,range:s,filteredRows:l,filteredOutRows:u,columns:e}},t.prototype.onFilter=function(t){},t.prototype.isFiltered=function(t){var e=this.Je;return arguments.length?v(e,t):e.length>0},t.prototype.isRowFilteredOut=function(t){var e,n,o=this,r=o.range;return!(!o.isFiltered()||!r||(e=r.row,n=o.LX[t],-1!==e&&(t<e||t>=e+r.rowCount)||b(n)>=b(o.Je)))},t.prototype.reset=function(){var t=this,e=t.kj;e&&e.ITa.gVa(t,8),t.zZ=u,t.unfilter(),t.rZ=[],t.Je=[],t.yZ=[],t.LX={},t.qZ={}},t.prototype.Dl=function(t,e,n){var o,r,i,a=!1,s=this.kj,l=this.range;return l&&(o=(l=s.Tq(l,n)).row,i=e>=(r=l.col)&&e<r+l.colCount,(1===n&&t===_(s,n)-1&&o-1<0&&i||3===n&&t===o-1&&i)&&(a=!0)),a},t.prototype.getFilterItems=function(t){return this.rZ[t]||[]},t.prototype.getFilteredItems=function(){return this.yZ},t.prototype.sortColumn=function(t,e){this.eLb(t,e,null)},t.prototype.eLb=function(t,e,n,o,r){var i,a,s=this,l=s.kj;if(l){i=l.Tq(s.range),l.suspendPaint();try{l.ITa.gVa(s,1),a={index:t,ascending:e,compareFunction:n},l.sortRange(i.row,i.col,i.rowCount,i.colCount,!0,[a],o,u,r)&&(s.zZ=a,s.isFiltered(t)&&s.reFilter())}finally{l.resumePaint()}}},t.prototype.sortColumnByColor=function(t,e,n,o,r,i){var a,s,l=this,c=l.kj;c&&(a=c.Tq(l.range),c.suspendPaint(),c.ITa.gVa(l,1),s={index:t,ascending:e,color:n,isBackColor:o},c.sortRange(a.row,a.col,a.rowCount,a.colCount,!0,[s],r,u,i)&&(l.zZ=s,l.isFiltered(t)&&l.reFilter()),c.resumePaint())},t.prototype.getSortState=function(t){var e=this.zZ,n=0;return e&&e.index===t&&(n=e.ascending?1:2),n},t.prototype.reFilter=function(t){var e,n=this,o=n.Je,r=b(o);for(n.kj.ITa.gVa(n,13),n.LX={},n.yZ=[],n.Je=[],e=0;e<r;e++)n.filter(o[e],t)},t.prototype.openFilterDialog=function(){},t.prototype.QX=function(t,e){var n=this.LX,o=n[t];p(o)?o=[e]:(v(o,e)&&C(o,e),o.push(e)),n[t]=o},t.prototype.PX=function(t){var e=this.yZ;v(e,t)||e.push(t)},t.prototype.OX=function(t){var e,n,o=this,r=o.LX;if(o.range&&o.isFiltered(t)){for(n in o.RX(t,!1),r)n&&((e=r[n])&&v(e,t)&&(C(e,t),b(e)||(r[n]=c)));o.sZ(t)}},t.prototype.RX=function(t,e){var n=this.Je;if(e){if(b(n)){if(n[b(n)-1]===t)return;C(n,t)}n.push(t)}else C(n,t)},t.prototype.sZ=function(t){var e,n,o=this.rZ,r=o.length,i=[],a=[];for(e=0;e<r;e++)e===t?i=i.concat(o[e]):a=a.concat(o[e]);for(n=i.length,e=0;e<n;e++)v(a,i[e])||C(this.yZ,i[e])},t.prototype.wZ=function(t,e,n,o){var r,i,a,s=this,l=s.rZ[n],u={},f=[];for(r=0;r<b(l);r++)2!==L(i=l[r])||0!==i.compareType()||i.forceValue2Text()||i.useWildCards()||i.ignoreCase()||i.ignoreBlank()?f.push(i):i.jzb?u[s.mzb.format(i.Ygc)]=i:u[i.expected()]=i;for(r=t;r<t+e;r++)a=s.isRowFilteredOut(r),u[o[r].T]===c&&u[o[r].DT]===c||(s.QX(r,n),a||s.PX(i));return f},t.prototype.xZ=function(t,e,n,o){var r,i,a,s,l,u,c=this,f=c.range;for(r=0;r<b(t);r++)if(a=(i=t[r]).item1(),s=i.item2(),l=void 0,u=void 0,0===L(i)?(a&&(l=c.AZ(a,e,n,f,o)),s&&(u=c.AZ(s,e,n,f,o))):l=c.AZ(i,e,n,f,o),i.evaluate(c.kj,e,n,l,u)){c.QX(e,n),c.PX(i);break}},t.prototype.AZ=function(t,e,n,o,r){var i,a,s,l=u,c=L(t),f=t.compareType(),p=r[e];return 8!==c&&10!==c||(i=[],(s=(a=this.kj.Tq(o)).col)<=n&&n<s+a.colCount&&i.push(h(a.row,n,a.rowCount,1)),t.ranges(i)),2===c||7===c?l=p.T:3===c?0===f?l=p.BC:1===f&&(l=p.FC):l=p.V,l},t.prototype.E0a=function(t,e){var n,o,r,i=this.Je;return!!b(i)&&(o=this.LX[t],r=b(o),p(o)||r<0?n=!0:n=y(o,e)<0,n)},t.prototype.WY=function(t,e){var n,o,r,i,a=this.Je;return!!b(a)&&(n=-1,o=y(a,e),r=this.LX[t],i=b(r),o>0&&(n=a[o-1]),n>-1?!!i&&n===r[i-1]:!i)},t.prototype.ima=function(t,e){var n,o,r,i=this.Je;return!b(i)||(n=y(i,e),o=this.LX[t],(r=b(o)||0)>=b(i)||!(n<0||r<b(i)-1)&&(!o||y(o,e)<0))},t.prototype.rI=function(t,e,n){var o,r,i,a,s,l,u,f,p,d=this,g=d.range;if(g){if(o=_(d.kj)-e-1,r=g.row,i=g.col,a=g.rowCount,s=g.colCount,r>-1&&(o=r+a-1,t<r||n&&t===r&&0===t?d.BZ(h(r+e,i,a,s)):t<r+a&&d.BZ(h(r,i,a+e,s))),l=d.LX,d.isFiltered()&&l){for(u=[],f=void 0,f=0;f<b(l);f++)u.push(f);for(u.sort(),f=0;f<b(u);f++)(p=u[f])>=t&&p<=o&&(l[p+e]=l[p],l[p]=c)}d.reFilter()}},t.prototype.tI=function(t,e){var n,o,r,i,a,s,l,u,c,f,p,d=this,g=d.sj?d.sj.dataRange():d.range;if(g){if(n=g.row,o=g.col,r=g.rowCount,i=g.colCount,a=0,s=-1,l=0,t>=0&&d.CZ()){for(u=0;u<e;u++)u+t<=d.DZ()&&a++;d.DZ(d.DZ()+a)}for(o>-1&&(t<=o?(s=o,l=i,d.BZ(h(n,o+e,r,i))):t<o+i&&(s=t,l=i-(t-o),d.BZ(h(n,o,r,i+e)))),s<0&&(s=0,l=P(d.kj)-e),u=s+l-1;u>=s;u--)u>=t&&(c=u+e,(f=y(d.Je,u))>=0&&(d.Je[f]=c),p=d.rZ[u],b(p)&&(C(d.rZ,u),d.rZ[c]=p));d.reFilter()}},t.prototype.GR=function(t,e){var n,o,r,i,a,s,l,f,p,d,g=this,m=g.range,y=g.kj;if(m){if(n=0,o=_(y)+e-1,r=m.row,i=m.col,a=m.rowCount,s=m.colCount,r>-1&&(n=r,o=r+a-1,t<=r?y.$Bb?(g.BZ(h(t,i,a,s)),delete y.$Bb):r===t+1||r+a<=t+e?g.BZ(u):r<t+e?g.BZ(h(t,i,r+a-(t+e),s)):g.BZ(h(r-e,i,a,s)):t<r+a&&g.BZ(h(r,i,a-Math.min(r+a-t,e),s))),l=g.LX,g.isFiltered()&&l)for(f=n;f<=o;f++)f>=t&&f<t+e?l[f]=c:f>=t+e&&((d=l[p=f])&&(l[p-e]=d,l[p]=c));g.kj.filterRowsVisibleInfo.C_a(Math.min(r,t),a),g.reFilter()}},t.prototype.BZ=function(t){this.kj.ITa.gVa(this,14),this.range=t},t.prototype.EZ=function(t){var e,n,o,r,i,a,s,l,f,h,p,d,g=this,m=g.kj,y=g.range;if(y)if(t){if(!t.equals(y)){if(o=y.col,r=y.colCount,i=t.col,a=t.colCount,s=P(m),g.isFiltered()&&!(o<0&&i<0))for(o<0&&(o=0,r=s),i<0&&(i=0,a=s),e=0;e<r;e++)(i>(n=o+e)||n>=i+a)&&g.removeFilterItems(n);if(l=y.row,f=y.rowCount,h=t.row,p=t.rowCount,d=_(m),g.isFiltered()&&g.LX&&!(l<0&&h<0))for(l<0&&(l=0,f=d),h<0&&(h=0,p=d),e=0;e<f;e++)(h>(n=l+e)||n>=h+p)&&(g.LX[n]=c)}}else g.reset();!g.CZ()||t&&t.contains(-1,g.DZ())||(g.zZ=u),g.BZ(t)},t.prototype.HR=function(t,e){var n,o,r,i,a,s,l,c,f=this,p=f.range,d=f.DZ(),g=t+e;if(p){for(t>=0&&f.CZ()&&(d>=t&&d<g?f.DZ(-1):d>=g&&f.DZ(d-e)),n=p.row,o=p.col,r=p.rowCount,o<0?(o=0,i=P(f.kj)+e):i=p.colCount,a=o;a<o+i;a++)a>=t&&(a<g?f.removeFilterItems(a):(s=a-e,l=y(f.Je,a),c=f.rZ[a],l>=0&&(f.Je[l]=s),b(c)&&(C(f.rZ,a),f.rZ[s]=c)));o>=0&&(t<o?g<=o?f.BZ(h(n,o-e,r,i)):g<=o+i?f.BZ(h(n,t,r,o+i-g)):f.BZ(u):t<o+i&&(g<=o+i?f.BZ(h(n,o,r,i-e)):f.BZ(h(n,o,r,t-o)))),f.reFilter()}},t.prototype.CZ=function(){var t=this.zZ;return!!t&&t.index>-1&&0!==this.getSortState(t.index)},t.prototype.DZ=function(t){var e,n=this,o=n.zZ;return b(arguments)?(o?o.index=t:n.zZ={index:t,ascending:!1},e=n):e=o?o.index:-1,e},t.prototype.$b=function(t,e,n,o){var r,i,a,s=this,l=s.range;l&&(r=h(t,e,n,o),s.filterButtonVisible()?(i=l.row-1,a=l.rowCount+1,i<0&&(i=-1,a=-1),r.containsRange(h(i,l.col,a,l.colCount))&&s.unfilter()):r.containsRange(l)&&s.unfilter())},t.prototype.fromJSON=function(t,e){var n,o,r,i,a,s,l,u,d,g,m,y,v,C,w,x,S;if(t){for(n=this,o=t.range,r=t.filterItemMap,i=n.rZ,a=t.sortInfo,s=t.showFilterButton,l=t.filterButtonVisibleInfo,o&&(n.range=h(o.row,o.col,o.rowCount,o.colCount)),t.dialogVisibleInfo&&(n.g_a=T.extend({},R,t.dialogVisibleInfo)),u=0;u<b(r);u++)for(y=(m=r[u]).conditions,d=0;d<b(y);d++)(v=y[d])&&(C=f(),x=i[w=m.index],C.fromJSON(v,e),x||(x=i[w]=[]),x.push(C));for(g=t.filteredColumns||t.filteredColMap,u=0;u<b(g);u++)p(g[u])||n.Je.push(g[u]);if(a&&a.color===c?n.zZ={index:a.index,ascending:a.ascending}:a&&a.color!==c&&(n.zZ={index:a.index,ascending:a.ascending,color:a.color,isBackColor:a.isBackColor}),s!==c)if(S=n.range,l)n.qZ=l;else if(S)for(u=n.oZ(S);u<n.pZ(S,n.kj);u++)n.qZ[u]=s}},t.prototype.toJSON=function(){var t,e,n,o,r,i,a,s,l,c,f=this,h={},p=f.range,d=f.qZ,g=f.rZ,m=f.Je,y=f.zZ,v=[],C=0,w=f.typeName;if(p&&(h.range=p),w&&(h.typeName=w),f.g_a){for(n in e={},f.g_a)f.g_a.hasOwnProperty(n)&&!1===f.g_a[n]&&(e[n]=!1);h.dialogVisibleInfo=e}for(t=0;t<b(g);t++)if(o=g[t]){for(r=[],i=void 0,i=0;i<b(o);i++)r.push(o[i]?o[i].toJSON():u);v[C]={index:t,conditions:r},C++}if(b(v)&&(h.filterItemMap=v),b(m)&&(h.filteredColumns=m),y&&(h.sortInfo=y),d){for(t in h.filterButtonVisibleInfo=T.extend({},d),a=!1,d)if(d[t]){a=!0;break}h.showFilterButton=a}for(s=[],c=f.kj.getRowCount(),l=0;l<c;l++)f.isRowFilteredOut(l)&&s.push(l);return s.length>0&&(h.filteredOutRows=s),h},t.prototype.TX=function(t){var e=t.options;return!e.isProtected||e.protectionOptions.allowFilter},t.prototype.hitTest=function(t,e,n){var o,r,i,s,l,c,f,h,p,d,g,m,y,v,C,b,w=this.kj;if(w){if(o=t.rowViewportIndex,r=t.colViewportIndex,i=t.hitTestType,s=w.it(r),1===i?(l=w.ut().findY(n),c=s.findX(e),f=1):3===i&&(l=w.jt(o).findY(n),c=s.findX(e),f=3),!l||!c)return u;if(h=l.row,p=c.col,d=w.getSpan(h,p,f),g=w.jZ(),d){if(m=d.row,y=d.col,h!==m+d.rowCount-1||p!==y+d.colCount-1)return u;h=m,p=y}return g&&((v=j(g,h,p,f))&&(C=w.getCellRect(h,p,o,r),(b=w.oK(C,f)).x<=e&&e<=b.x+b.width&&b.y<=n&&n<=b.y+b.height))?new a.eY(v.rowFilter,v.row,v.col,v.sheetArea,b.x,b.y,b.width,b.height):u}},t}(),e.RowFilterBase=k,M=function(t){function e(e){var n=t.call(this,e)||this;return n.typeName=w,n.g_a=T.extend({},R),n.mzb=new r.Formatter.GeneralFormatter("yyyy/mm/dd"),n}return O(e,t),e.prototype.onFilter=function(t){var e=this.kj;e&&(this.FZ(e,t.filteredRows,t.filteredOutRows),e.au())},e.prototype.filterDialogVisibleInfo=function(t){if(0===arguments.length)return this.g_a||(this.g_a=T.extend({},R)),this.g_a;if(t){var e={};return t.sortByValue!==c&&(e.sortByValue=!!t.sortByValue),t.sortByColor!==c&&(e.sortByColor=!!t.sortByColor),t.filterByColor!==c&&(e.filterByColor=!!t.filterByColor),t.filterByValue!==c&&(e.filterByValue=!!t.filterByValue),t.listFilterArea!==c&&(e.listFilterArea=!!t.listFilterArea),T.extend(this.g_a,e),this}},e.prototype.FZ=function(t,e,n){var r,i=t.filterRowsVisibleInfo;i&&(r=i.D4(e,n),t.recalcRows&&t.recalcRows(r),t.ITa.zgc({type:o.AxisInfoChangeType.filterRows,index:r}))},e.prototype.openFilterDialog=function(t){var e,n=this,o=n.kj;n.TX(o)&&(e=new a.gZ(o.parent.xv(),o,t,n.filterDialogVisibleInfo()),o.GZ=e,e.OT())},e}(k),e.HideRowFilter=M,N=function(){function t(){this.hZ()}return t.prototype.lZ=function(t){if(this.empty)return!0;var e=this.rowsVisibleInfo[t];return!!p(e)||e},t.prototype.D4=function(t,e){var n,o,r,i,a,s,l,f,h=[],p=this.rowsVisibleInfo;for(n=0,o=t.length;n<o;n++)(i=p[r=t[n]])!==c&&i!==u&&h.push(r),delete p[r];for(a=0,s=e.length;a<s;a++)(f=p[l=e[a]])!==c&&f!==u||h.push(l),p[l]=!1;return this.empty=!1,h},t.prototype.hZ=function(){this.rowsVisibleInfo={},this.empty=!0},t.prototype.C_a=function(t,e){var n,o,r=this.rowsVisibleInfo;for(o=t;o<e;o++)n=r[o+t],p(n)||delete r[o+t]},t.prototype.mZ=function(){return!this.empty},t.prototype.clone=function(){var e=new t;return e.rowsVisibleInfo=T.extend({},this.rowsVisibleInfo),e.empty=this.empty,e},t}(),E={init:function(){var t=this;t.xr=u,t.filterRowsVisibleInfo=new N,t.Wr.push({Xr:function(e){return t.filterRowsVisibleInfo.lZ(e)}})},processMouseDown:function(t){var e=t.hitInfo.filterButtonHitInfo;e&&(e.rowFilter.openFilterDialog(e),t.r=!0)},onLayoutChanged:function(t){var e,n=this,o=t.changeType,r=t.row,i=t.rowCount,a=t.col,s=t.colCount,l=n.xr;return"invalidateLayout"===o?void(n.kZ=u):void(l&&(e=n.ITa,"addRows"===o?e.hVa(r,i,t.rowExpand):"deleteRows"===o?e.iVa(r,i):"addColumns"===o?e.jVa(a,s):"deleteColumns"===o?e.kVa(a,s):"clear"===o&&l.range&&e.lVa(r,a,i,s)))},dispose:function(){var t=this._filterDialiog;t&&t.close()},toJson:function(t,e){var n=this.xr,o=e&&e.ignoreStyle;n&&!o&&(t.rowFilter=n.toJSON())},fromJson:function(t,e,n){var o=t.rowFilter,r=n&&n.ignoreStyle;o&&!r&&B(o,this,e)},paintCell:function(t){var e,n,r,i,s,u,c,f,h=this,p=t.cell,d=p.width,g=p.height,m=p.cellLayout,y=h.vu(),C=h.jZ(),b=t.ctx;if((!m||!v([],m))&&C&&d>0&&g>0&&(e=j(C,p.row,p.col,t.sheetArea))){n=new a.eY(e.rowFilter,e.row,e.col,e.sheetArea,p.x,p.y,d,g),i=(r=h.oK(new o.Rect(n.x,n.y,n.width,n.height),n.sheetArea)).width,s=r.height,u=r.x,c=r.y,f=l.getFilterButtonImageSrc(n.ko()),b.save(),b.rect(n.x,n.y,n.width,n.height),b.clip(),b.beginPath(),b.lineWidth=1,b.fillStyle="#FFFFFF",b.strokeStyle="#CCCCCC",b.fillRect(u+1,c+1,i-3,s-3),b.strokeRect(u+1-.5,c+2-.5,i-3,s-4);try{y.ko(f)?b.drawImage(y.lo(f),u,c+1,i-3,s-3):y.fo(f)}catch(t){}b.beginPath(),b.restore()}}},o.Worksheet.$n("filter",E),D={init:function(){o.Commands.fVa(this.commandManager())}},o.Workbook.$n("filter",D),T.extend(o.lUa.prototype,{gVa:function(t,e){var n,o,r,i,a=this,s=a.zTa;if(s){switch(s.mVa||(s.mVa=[]),n={type:e,rowFilter:t},e){case 0:o=void 0,o=t?{range:t.range,typeName:t.typeName,Je:t.Je.concat([]),yZ:t.yZ.concat([]),rZ:t.rZ.concat([]),LX:T.extend({},t.LX),qZ:T.extend({},t.qZ),zZ:T.extend({},t.zZ)}:u,r=a.kj.filterRowsVisibleInfo.clone(),n.HUa={rowFilter:o,filterRowsVisibleInfo:r};break;case 2:case 7:n.HUa={Je:t.Je.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 1:n.HUa=t.zZ;break;case 3:n.HUa=T.extend({},t.qZ);break;case 4:i=arguments[2],n.HUa={col:i,val:t.qZ[i]};break;case 5:case 6:n.HUa={rZ:t.rZ.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone(),Je:t.Je.concat([])};break;case 8:n.HUa={range:t.range,Je:t.Je.concat([]),yZ:t.yZ.concat([]),LX:T.extend({},t.LX),qZ:T.extend({},t.qZ),zZ:T.extend({},t.zZ),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 9:case 10:n.HUa={range:t.range,LX:T.extend({},t.LX),Je:t.Je.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 11:case 12:n.HUa={range:t.range,zZ:T.extend({},t.zZ),rZ:t.rZ.concat([]),Je:t.Je.concat([]),filterRowsVisibleInfo:a.kj.filterRowsVisibleInfo.clone()};break;case 13:n.HUa={filteredInRowsWithColIndexs:T.extend({},t.LX),filteredItems:t.yZ.concat([]),filteredColumns:t.Je.concat([])};break;case 14:n.HUa={range:t.range}}s.mVa.push(n)}},nVa:function(t){var e=this.kj,n=t.rowFilter,r=t.HUa,i=!1,a=e.filterRowsVisibleInfo.rowsVisibleInfo;if(n||0===t.type){switch(t.type){case 0:r.rowFilter?e.xr=T.extend(n,r.rowFilter):e.xr=r.rowFilter,e.filterRowsVisibleInfo=r.filterRowsVisibleInfo,i=!0;break;case 1:n.zZ=r;break;case 3:n.qZ=r;break;case 4:n.qZ[r.col]=r.val;break;case 5:case 6:n.rZ=r.rZ,n.Je=r.Je,e.filterRowsVisibleInfo=r.filterRowsVisibleInfo,i=!0;break;case 2:case 7:n.Je=r.Je,e.filterRowsVisibleInfo=r.filterRowsVisibleInfo,i=!0;break;case 8:T.extend(n,r),e.filterRowsVisibleInfo=r.filterRowsVisibleInfo,i=!0;break;case 9:case 10:n.range=r.range,n.LX=r.LX,n.Je=r.Je,e.filterRowsVisibleInfo=r.filterRowsVisibleInfo,i=!0;break;case 11:case 12:n.range=r.range,n.zZ=r.zZ,n.rZ=r.rZ,n.Je=r.Je,e.filterRowsVisibleInfo=r.filterRowsVisibleInfo,i=!0;break;case 13:n.LX=r.filteredInRowsWithColIndexs,n.yZ=r.filteredItems,n.Je=r.filteredColumns;break;case 14:n.range=r.range}i&&this.zgc({type:o.AxisInfoChangeType.filterRows,index:G(a)})}},oVa:function(t){var e;for(e=b(t)-1;e>=0;e--)this.nVa(t[e])},hVa:function(t,e,n){var o=this.kj.xr;o&&(this.gVa(o,9),o.rI(t,e,n))},iVa:function(t,e){var n=this.kj.xr;n&&(this.gVa(n,10),n.GR(t,e))},jVa:function(t,e){var n=this.kj.xr;n&&(this.gVa(n,11),n.tI(t,e))},kVa:function(t,e){var n=this.kj.xr;n&&(this.gVa(n,12),n.HR(t,e))},lVa:function(t,e,n,o){var r=this.kj.xr;r&&r.$b(t,e,n,o)}}),o.lUa.$n("filter",{undo:function(t){var e=t.mVa;b(e)&&this.oVa(e)}})},"./dist/plugins/filter/filter.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidColumnIndex="Invalid column index.",e.SortAscending="Sort Ascending",e.SortDescending="Sort Descending",e.OK="OK",e.Cancel="Cancel",e.Search="Search",e.CheckAll="Check all",e.UncheckAll="Uncheck all",e.Blanks="(Blanks)",e.Exp_FilterItemIsNull="FilterItem is null.",e.Show="Show",e.ShowRows="Show rows where:",e.And="And",e.Or="Or",e.SortColor="Sort By Color",e.FilterColor="Filter By Color",e.FilterCellTitle="Filter By Cell Color",e.FilterFontTitle="Filter By Font Color",e.SortCellTitle="Sort By Cell Color",e.SortFontTitle="Sort By Font Color",e.FontColor="More Font Colors...",e.CellColor="More Cell Colors...",e.NoFill="No Fill",e.Automatic="Automatic",e.Clear="Clear Filter From {0}",e.TextFilter="Text Filters",e.DateFilter="Date Filters",e.NumberFilter="Number Filters",e.Custom="Custom Filter...",e.Equal="Equals...",e.NotEqual="Does Not Equal...",e.GreaterThan="Greater Than...",e.GreaterOrEquals="Greater Than Or Equal To...",e.LessThan="Less Than...",e.LessThanOrEquals="Less Than Or Equal To...",e.Between="Between...",e.Top10="Top 10...",e.AboveAverage="Above Average",e.BelowAverage="Below Average",e.Begin="Begins With...",e.End="Ends With...",e.Contain="Contains...",e.NotContain="Does Not Contain...",e.Before="Before...",e.After="After...",e.Tomorrow="Tomorrow",e.Today="Today",e.Yesterday="Yesterday",e.NextWeek="Next Week",e.ThisWeek="This Week",e.LastWeek="Last Week",e.NextMonth="Next Month",e.ThisMonth="This Month",e.LastMonth="Last Month",e.NextQuarter="Next Quarter",e.ThisQuarter="This Quarter",e.LastQuarter="Last Quarter",e.NextYear="Next Year",e.ThisYear="This Year",e.LastYear="Last Year",e.YearToDate="Year To Date",e.AllDates="All Dates in Period",e.Top10Filter="Top 10 Auto Filter",e.CustomTitle="Custom AutoFilter",e.ColorTitle="Available Cell Colors",e.top="top",e.bottom="bottom",e.SortCell="Select a cell color to sort by:",e.SortFont="Select a font color to sort by:",e.FilterCell="Select a cell color to filter by:",e.FilterFont="Select a font color to filter by:",e.Selected="Selected:",e.IsEquals="equals",e.NotEquals="does not equal",e.IsGreaterThan="is greater than",e.IsGreaterOrEqual="is greater than or equal to",e.IsLess="is less than",e.LessOrEqual="is less than or equal to",e.IsBeginWith="begins with",e.NotBeginWith="does not begin with",e.IsEndWith="ends with",e.NotEndWith="does not end with",e.IsContain="contains",e.NotContains="does not contain",e.IsAfter="is after",e.AfterOrEqual="is after or equal to",e.IsBefore="is before",e.BeforeOrEqual="is before or equal to",e.Q1="Quarter 1",e.Q2="Quarter 2",e.Q3="Quarter 3",e.Q4="Quarter 4",e.Jan="January",e.Feb="February",e.Mar="March",e.Apr="April",e.May="May",e.Jun="June",e.Jul="July",e.Aug="August",e.Sep="September",e.Oct="October",e.Nov="November",e.Dec="December",e.Explain1="Use ? to represent any single character",e.Explain2="Use * to represent any series of characters",e.Year="",e.Day="",e.add_current_filter="Add current selection to filter"},"./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js":function(t,e,n){"use strict";var o,r,i,a,s=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/stateful.js"),r=n("./dist/plugins/floatingObject/drawing/common.js"),i=null,a=function(t){function e(e){return t.call(this,e)||this}return s(e,t),Object.defineProperty(e.prototype,"ChartFormat",{get:function(){var t=this;return r.UnitHelper.isNullOrUndefined(t.Kb)&&(t.Kb=t.GetDefaultFormat()),t.Kb},set:function(t){var e,n=this;r.UnitHelper.isNullOrUndefined(n.Kb)||n.Kb.SetParentForChildren(t),e=n.Kb,n.Kb=t,r.UnitHelper.isNullOrUndefined(e)||(n.Kb.ParentStateful=e.ParentStateful)},enumerable:!0,configurable:!0}),e.prototype.CreateFormat=function(){return i},e.prototype.GetDefaultFormat=function(){return this.CreateFormat()},e.prototype.GetFormatInternal=function(){return this.Kb},e.prototype.FromShapeProperties=function(t){var e=this;r.UnitHelper.isNullOrUndefined(t)?e.ClearFormat():(r.UnitHelper.isNullOrUndefined(e.Kb)&&(e.Kb=e.CreateFormat()),e.Kb.FromOOModel(t))},e.prototype.ToShapeProperties=function(){return r.UnitHelper.isNullOrUndefined(this.Kb)?i:this.Kb.ToOOModel()},e.prototype.Delete=function(){r.UnitHelper.isNullOrUndefined(this.Kb)||(this.Kb.ParentStateful=i)},e.prototype.ClearFormat=function(){var t=this;r.UnitHelper.isNullOrUndefined(t.Kb)||(t.Kb.SetParentForChildren(i),t.Kb.ParentStateful=i,t.Kb=i)},e}(o.StatefullBase),e.StatefulChartElementBase=a},"./dist/plugins/floatingObject/drawing/chart.ns.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/floatingObject/drawing/drawingInterface.js")),o(n("./dist/plugins/floatingObject/drawing/stateful.js")),o(n("./dist/plugins/floatingObject/drawing/common.js")),o(n("./dist/plugins/floatingObject/drawing/color.js")),o(n("./dist/plugins/floatingObject/drawing/colorData.js")),o(n("./dist/plugins/floatingObject/drawing/colorFormat.js")),o(n("./dist/plugins/floatingObject/drawing/effects.js")),o(n("./dist/plugins/floatingObject/drawing/fillFormat.js")),o(n("./dist/plugins/floatingObject/drawing/fontData.js")),o(n("./dist/plugins/floatingObject/drawing/fontFormat.js")),o(n("./dist/plugins/floatingObject/drawing/gradient.js")),o(n("./dist/plugins/floatingObject/drawing/lineFormat.js")),o(n("./dist/plugins/floatingObject/drawing/picture.js")),o(n("./dist/plugins/floatingObject/drawing/threeDFormat.js")),o(n("./dist/plugins/floatingObject/drawing/StatefulChartElementBase.js"))},"./dist/plugins/floatingObject/drawing/color.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/plugins/floatingObject/drawing/common.js"),i=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),a=o.Common.pc,s=r.UnitHelper.isNullOrUndefined,l=null,u=function(){function t(t,e,n,o){var r=this;r.value=t,r.state=e,r.name=n,r.knownColor=o}return t.FromKnownColor=function(e){return new t(0,t.StateKnownColorValid,l,e)},t.FromIndexedColor=function(e,n){var o=t.IndexedColors;return o||(o=t.IndexedColors=[4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4278190080,4294967295,4294901760,4278255360,4278190335,4294967040,4294902015,4278255615,4286578688,4278222848,4278190208,4286611456,4286578816,4278222976,4290822336,4286611584,4288256511,4288230246,4294967244,4291624959,4284874854,4294934656,4278216396,4291611903,4278190208,4294902015,4294967040,4278255615,4286578816,4286578688,4278222976,4278190335,4278242559,4291624959,4291624908,4294967193,4288269567,4294941132,4291598847,4294954137,4281558783,4281584844,4288269312,4294953984,4294940928,4294927872,4284901017,4288059030,4278203238,4281571686,4278203136,4281545472,4288230144,4288230246,4281545625,4281545523,t.FromKnownColor(c.WindowText).ToArgb(),t.FromKnownColor(c.Window).ToArgb()]),t.FromArgb(o[e]).GetTintColor(n)},t.FromArgb=function(e){return new t(e,t.StateARGBValueValid,l,0)},t.FromArgbs=function(e,n,o,r){return t.CheckByte(e,"alpha"),t.CheckByte(n,"red"),t.CheckByte(o,"green"),t.CheckByte(r,"blue"),new t(t.MakeArgb(e,n,o,r),t.StateARGBValueValid,l,0)},t.FromBaseColor=function(e,n){return t.CheckByte(e,"alpha"),new t(t.MakeArgb(e,n.R,n.G,n.B),t.StateARGBValueValid,l,0)},t.FromRgb=function(e,n,o){return t.FromArgbs(255,e,n,o)},t.CheckByte=function(t,e){if(t<0||t>255)throw Error("InvalidEx2BoundArgument")},t.MakeArgb=function(t,e,n,o){return Math.pow(2,24)*t+(e<<16|n<<8|o)},Object.defineProperty(t.prototype,"Transparent",{get:function(){return t.FromKnownColor(c.Transparent)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"R",{get:function(){return this.Value>>16&255},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"G",{get:function(){return this.Value>>8&255},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"B",{get:function(){return 255&this.Value},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"A",{get:function(){return this.Value>>24&255},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsKnownColor",{get:function(){return 0!=(this.state&t.StateKnownColorValid)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsEmpty",{get:function(){return 0===this.state},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsNamedColor",{get:function(){return 0!=(this.state&t.StateNameValid)||this.IsKnownColor},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsSystemColor",{get:function(){return!!this.IsKnownColor&&(!(this.knownColor>26)||this.knownColor>167)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Name",{get:function(){var e,n=this;return 0!=(n.state&t.StateNameValid)?n.name:n.IsKnownColor?(e=h.KnownColorToName(n.knownColor),s(e)?"":e):n.value.toString(16)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Value",{get:function(){var e=this;return 0!=(e.state&t.StateValueMask)?e.value:e.IsKnownColor?h.KnownColorToArgb(e.knownColor):t.NotDefinedValue},enumerable:!0,configurable:!0}),t.prototype.Equals=function(e){return e instanceof t&&this.Value===e.Value},t.prototype.GetTintColor=function(e){var n,o=this;return 0===e?o:(n=a.jc({r:o.R,g:o.G,b:o.B},e),t.FromArgbs(n.a,n.r,n.g,n.b))},t.prototype.GetBrightness=function(){var t=this.R/255,e=this.G/255,n=this.B/255,o=t,r=t;return e>o&&(o=e),n>o&&(o=n),e<r&&(r=e),n<r&&(r=n),(o+r)/2},t.prototype.GetHue=function(){var t,e,n,o,r,i,a,s=this;return s.R===s.G&&s.G===s.B?0:(t=s.R/255,o=0,(e=s.G/255)>(r=t)&&(r=e),(n=s.B/255)>r&&(r=n),e<(i=t)&&(i=e),n<i&&(i=n),a=r-i,t===r?o=(e-n)/a:e===r?o=2+(n-t)/a:n===r&&(o=4+(t-e)/a),(o*=60)<0&&(o+=360),o)},t.prototype.GetSaturation=function(){var t=this.R/255,e=this.G/255,n=this.B/255,o=t,r=t;return e>o&&(o=e),n>o&&(o=n),e<r&&(r=e),n<r&&(r=n),o===r?0:(o+r)/2<=.5?(o-r)/(o+r):(o-r)/(2-o-r)},t.prototype.ToArgb=function(){return this.Value},t.prototype.ToKnownColor=function(){return this.knownColor},t.prototype.ToString=function(){var e=this,n="ARGBColor";return n+=" [",0!=(e.state&t.StateNameValid)||0!=(e.state&t.StateKnownColorValid)?n+=e.Name:0!=(e.state&t.StateValueMask)?(n+="A=",n+=e.A,n+=", R=",n+=e.R,n+=", G=",n+=e.G,n+=", B=",n+=e.B):n+="Empty",n+"]"},t.StateKnownColorValid=1,t.StateARGBValueValid=2,t.StateValueMask=2,t.StateNameValid=8,t.NotDefinedValue=0,t}(),e.ARGBColor=u,r.ChartUtility.Kqa=function(t,e){var n,o,s=e.ColorType;return s===i.ColorType.Index?u.FromIndexedColor(e.Value,e.Tint):s===i.ColorType.Theme?(n=r.ChartUtility.toThemeColorString(e.Value,e.Tint),o=a.ec(t.getColor(n)),e.Transparency&&(o.a=parseInt(255*(1-e.Transparency)+"",10)),u.FromArgbs(o.a,o.r,o.g,o.b)):s===i.ColorType.Auto?u.FromKnownColor(c.WindowText):s===i.ColorType.None?new u:u.FromArgb(e.Value).GetTintColor(e.Tint)},function(t){t[t.ActiveBorder=1]="ActiveBorder",t[t.ActiveCaption=2]="ActiveCaption",t[t.ActiveCaptionText=3]="ActiveCaptionText",t[t.AliceBlue=28]="AliceBlue",t[t.AntiqueWhite=29]="AntiqueWhite",t[t.AppWorkspace=4]="AppWorkspace",t[t.Aqua=30]="Aqua",t[t.Aquamarine=31]="Aquamarine",t[t.Azure=32]="Azure",t[t.Beige=33]="Beige",t[t.Bisque=34]="Bisque",t[t.Black=35]="Black",t[t.BlanchedAlmond=36]="BlanchedAlmond",t[t.Blue=37]="Blue",t[t.BlueViolet=38]="BlueViolet",t[t.Brown=39]="Brown",t[t.BurlyWood=40]="BurlyWood",t[t.ButtonFace=168]="ButtonFace",t[t.ButtonHighlight=169]="ButtonHighlight",t[t.ButtonShadow=170]="ButtonShadow",t[t.CadetBlue=41]="CadetBlue",t[t.Chartreuse=42]="Chartreuse",t[t.Chocolate=43]="Chocolate",t[t.Control=5]="Control",t[t.ControlDark=6]="ControlDark",t[t.ControlDarkDark=7]="ControlDarkDark",t[t.ControlLight=8]="ControlLight",t[t.ControlLightLight=9]="ControlLightLight",t[t.ControlText=10]="ControlText",t[t.Coral=44]="Coral",t[t.CornflowerBlue=45]="CornflowerBlue",t[t.Cornsilk=46]="Cornsilk",t[t.Crimson=47]="Crimson",t[t.Cyan=48]="Cyan",t[t.DarkBlue=49]="DarkBlue",t[t.DarkCyan=50]="DarkCyan",t[t.DarkGoldenrod=51]="DarkGoldenrod",t[t.DarkGray=52]="DarkGray",t[t.DarkGreen=53]="DarkGreen",t[t.DarkKhaki=54]="DarkKhaki",t[t.DarkMagenta=55]="DarkMagenta",t[t.DarkOliveGreen=56]="DarkOliveGreen",t[t.DarkOrange=57]="DarkOrange",t[t.DarkOrchid=58]="DarkOrchid",t[t.DarkRed=59]="DarkRed",t[t.DarkSalmon=60]="DarkSalmon",t[t.DarkSeaGreen=61]="DarkSeaGreen",t[t.DarkSlateBlue=62]="DarkSlateBlue",t[t.DarkSlateGray=63]="DarkSlateGray",t[t.DarkTurquoise=64]="DarkTurquoise",t[t.DarkViolet=65]="DarkViolet",t[t.DeepPink=66]="DeepPink",t[t.DeepSkyBlue=67]="DeepSkyBlue",t[t.Desktop=11]="Desktop",t[t.DimGray=68]="DimGray",t[t.DodgerBlue=69]="DodgerBlue",t[t.Firebrick=70]="Firebrick",t[t.FloralWhite=71]="FloralWhite",t[t.ForestGreen=72]="ForestGreen",t[t.Fuchsia=73]="Fuchsia",t[t.Gainsboro=74]="Gainsboro",t[t.GhostWhite=75]="GhostWhite",t[t.Gold=76]="Gold",t[t.Goldenrod=77]="Goldenrod",t[t.GradientActiveCaption=171]="GradientActiveCaption",t[t.GradientInactiveCaption=172]="GradientInactiveCaption",t[t.Gray=78]="Gray",t[t.GrayText=12]="GrayText",t[t.Green=79]="Green",t[t.GreenYellow=80]="GreenYellow",t[t.Highlight=13]="Highlight",t[t.HighlightText=14]="HighlightText",t[t.Honeydew=81]="Honeydew",t[t.HotPink=82]="HotPink",t[t.HotTrack=15]="HotTrack",t[t.InactiveBorder=16]="InactiveBorder",t[t.InactiveCaption=17]="InactiveCaption",t[t.InactiveCaptionText=18]="InactiveCaptionText",t[t.IndianRed=83]="IndianRed",t[t.Indigo=84]="Indigo",t[t.Info=19]="Info",t[t.InfoText=20]="InfoText",t[t.Ivory=85]="Ivory",t[t.Khaki=86]="Khaki",t[t.Lavender=87]="Lavender",t[t.LavenderBlush=88]="LavenderBlush",t[t.LawnGreen=89]="LawnGreen",t[t.LemonChiffon=90]="LemonChiffon",t[t.LightBlue=91]="LightBlue",t[t.LightCoral=92]="LightCoral",t[t.LightCyan=93]="LightCyan",t[t.LightGoldenrodYellow=94]="LightGoldenrodYellow",t[t.LightGray=95]="LightGray",t[t.LightGreen=96]="LightGreen",t[t.LightPink=97]="LightPink",t[t.LightSalmon=98]="LightSalmon",t[t.LightSeaGreen=99]="LightSeaGreen",t[t.LightSkyBlue=100]="LightSkyBlue",t[t.LightSlateGray=101]="LightSlateGray",t[t.LightSteelBlue=102]="LightSteelBlue",t[t.LightYellow=103]="LightYellow",t[t.Lime=104]="Lime",t[t.LimeGreen=105]="LimeGreen",t[t.Linen=106]="Linen",t[t.Magenta=107]="Magenta",t[t.Maroon=108]="Maroon",t[t.MediumAquamarine=109]="MediumAquamarine",t[t.MediumBlue=110]="MediumBlue",t[t.MediumOrchid=111]="MediumOrchid",t[t.MediumPurple=112]="MediumPurple",t[t.MediumSeaGreen=113]="MediumSeaGreen",t[t.MediumSlateBlue=114]="MediumSlateBlue",t[t.MediumSpringGreen=115]="MediumSpringGreen",t[t.MediumTurquoise=116]="MediumTurquoise",t[t.MediumVioletRed=117]="MediumVioletRed",t[t.Menu=21]="Menu",t[t.MenuBar=173]="MenuBar",t[t.MenuHighlight=174]="MenuHighlight",t[t.MenuText=22]="MenuText",t[t.MidnightBlue=118]="MidnightBlue",t[t.MintCream=119]="MintCream",t[t.MistyRose=120]="MistyRose",t[t.Moccasin=121]="Moccasin",t[t.NavajoWhite=122]="NavajoWhite",t[t.Navy=123]="Navy",t[t.OldLace=124]="OldLace",t[t.Olive=125]="Olive",t[t.OliveDrab=126]="OliveDrab",t[t.Orange=127]="Orange",t[t.OrangeRed=128]="OrangeRed",t[t.Orchid=129]="Orchid",t[t.PaleGoldenrod=130]="PaleGoldenrod",t[t.PaleGreen=131]="PaleGreen",t[t.PaleTurquoise=132]="PaleTurquoise",t[t.PaleVioletRed=133]="PaleVioletRed",t[t.PapayaWhip=134]="PapayaWhip",t[t.PeachPuff=135]="PeachPuff",t[t.Peru=136]="Peru",t[t.Pink=137]="Pink",t[t.Plum=138]="Plum",t[t.PowderBlue=139]="PowderBlue",t[t.Purple=140]="Purple",t[t.Red=141]="Red",t[t.RosyBrown=142]="RosyBrown",t[t.RoyalBlue=143]="RoyalBlue",t[t.SaddleBrown=144]="SaddleBrown",t[t.Salmon=145]="Salmon",t[t.SandyBrown=146]="SandyBrown",t[t.ScrollBar=23]="ScrollBar",t[t.SeaGreen=147]="SeaGreen",t[t.SeaShell=148]="SeaShell",t[t.Sienna=149]="Sienna",t[t.Silver=150]="Silver",t[t.SkyBlue=151]="SkyBlue",t[t.SlateBlue=152]="SlateBlue",t[t.SlateGray=153]="SlateGray",t[t.Snow=154]="Snow",t[t.SpringGreen=155]="SpringGreen",t[t.SteelBlue=156]="SteelBlue",t[t.Tan=157]="Tan",t[t.Teal=158]="Teal",t[t.Thistle=159]="Thistle",t[t.Tomato=160]="Tomato",t[t.Transparent=27]="Transparent",t[t.Turquoise=161]="Turquoise",t[t.Violet=162]="Violet",t[t.Wheat=163]="Wheat",t[t.White=164]="White",t[t.WhiteSmoke=165]="WhiteSmoke",t[t.Window=24]="Window",t[t.WindowFrame=25]="WindowFrame",t[t.WindowText=26]="WindowText",t[t.Yellow=166]="Yellow",t[t.YellowGreen=167]="YellowGreen"}(c=e.KnownColor||(e.KnownColor={})),f=function(t){t[1]=4290032820,t[2]=4288263377,t[3]=4278190080,t[4]=4289440683,t[5]=4293980400,t[6]=4288716960,t[7]=4285098345,t[8]=4293125091,t[9]=4294967295,t[10]=4278190080,t[11]=4278190080,t[12]=4285361517,t[13]=4281571839,t[14]=4294967295,t[15]=4278216396,t[16]=4294244348,t[17]=4290760155,t[18]=4278190080,t[19]=4294967265,t[20]=4278190080,t[21]=4293980400,t[22]=4278190080,t[23]=4291348680,t[24]=4294967295,t[25]=4284769380,t[26]=4278190080,t[168]=4293980400,t[169]=4294967295,t[170]=4288716960,t[171]=4290367978,t[172]=4292338930,t[173]=4293980400,t[174]=4281571839},h=function(){function t(){}return t.ArgbToKnownColor=function(e){var n,o;for(this.EnsureColorTable(),n=0;n<t.colorTable.length;n++)if(t.colorTable[n]===e&&!(o=u.FromArgb(n)).IsSystemColor)return o;return u.FromArgb(e)},t.Encode=function(t,e,n,o){return e<<16|n<<8|o|t<<24},t.EnsureColorNameTable=function(){s(t.colorNameTable)&&t.InitColorNameTable()},t.EnsureColorTable=function(){s(t.colorTable)&&this.InitColorTable()},t.InitColorNameTable=function(){var e,n=[];for(e in c)c.hasOwnProperty(e)&&(n[c[e]]=e);t.colorNameTable=n},t.InitColorTable=function(){var e=[];f(e),e[27]=16777215,e[28]=-984833,e[29]=-332841,e[30]=-16711681,e[31]=-8388652,e[32]=-983041,e[33]=-657956,e[34]=-6972,e[35]=-16777216,e[36]=-5171,e[37]=-16776961,e[38]=-7722014,e[39]=-5952982,e[40]=-2180985,e[41]=-10510688,e[42]=-8388864,e[43]=-2987746,e[44]=-32944,e[45]=-10185235,e[46]=-1828,e[47]=-2354116,e[48]=-16711681,e[49]=-16777077,e[50]=-16741493,e[51]=-4684277,e[52]=-5658199,e[53]=-16751616,e[54]=-4343957,e[55]=-7667573,e[56]=-11179217,e[57]=-29696,e[58]=-6737204,e[59]=-7667712,e[60]=-1468806,e[61]=-7357301,e[62]=-12042869,e[63]=-13676721,e[64]=-16724271,e[65]=-7077677,e[66]=-60269,e[67]=-16728065,e[68]=-9868951,e[69]=-14774017,e[70]=-5103070,e[71]=-1296,e[72]=-14513374,e[73]=-65281,e[74]=-2302756,e[75]=-460545,e[76]=-10496,e[77]=-2448096,e[78]=-8355712,e[79]=-16744448,e[80]=-5374161,e[81]=-983056,e[82]=-38476,e[83]=-3318692,e[84]=-11861886,e[85]=-16,e[86]=-989556,e[87]=-1644806,e[88]=-3851,e[89]=-8586240,e[90]=-1331,e[91]=-5383962,e[92]=-1015680,e[93]=-2031617,e[94]=-329006,e[95]=-2894893,e[96]=-7278960,e[97]=-18751,e[98]=-24454,e[99]=-14634326,e[100]=-7876870,e[101]=-8943463,e[102]=-5192482,e[103]=-32,e[104]=-16711936,e[105]=-13447886,e[106]=-331546,e[107]=-65281,e[108]=-8388608,e[109]=-10039894,e[110]=-16777011,e[111]=-4565549,e[112]=-7114533,e[113]=-12799119,e[114]=-8689426,e[115]=-16713062,e[116]=-12004916,e[117]=-3730043,e[118]=-15132304,e[119]=-655366,e[120]=-6943,e[121]=-6987,e[122]=-8531,e[123]=-16777088,e[124]=-133658,e[125]=-8355840,e[126]=-9728477,e[127]=-23296,e[128]=-47872,e[129]=-2461482,e[130]=-1120086,e[131]=-6751336,e[132]=-5247250,e[133]=-2396013,e[134]=-4139,e[135]=-9543,e[136]=-3308225,e[137]=-16181,e[138]=-2252579,e[139]=-5185306,e[140]=-8388480,e[141]=-65536,e[142]=-4419697,e[143]=-12490271,e[144]=-7650029,e[145]=-360334,e[146]=-744352,e[147]=-13726889,e[148]=-2578,e[149]=-6270419,e[150]=-4144960,e[151]=-7876885,e[152]=-9807155,e[153]=-9404272,e[154]=-1286,e[155]=-16711809,e[156]=-12156236,e[157]=-2968436,e[158]=-16744320,e[159]=-2572328,e[160]=-40121,e[161]=-12525360,e[162]=-1146130,e[163]=-663885,e[164]=-1,e[165]=-657931,e[166]=-256,e[167]=-6632142,t.colorTable=e},t.KnownColorToArgb=function(t){return this.EnsureColorTable(),t<=c.MenuHighlight?this.colorTable[t]:0},t.KnownColorToName=function(e){return this.EnsureColorNameTable(),e<=c.MenuHighlight?t.colorNameTable[e]:l},t.IsKnowColor=function(e){return t.EnsureColorTable(),-1!==t.colorTable.indexOf(e)},t}(),e.KnownColorTable=h},"./dist/plugins/floatingObject/drawing/colorData.js":function(t,e,n){"use strict";var o,r,i;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),function(t){t[t.None=0]="None",t[t.ColorType=1]="ColorType",t[t.Value=2]="Value",t[t.Tint=4]="Tint",t[t.All=7]="All"}(r=e.ColorDataFlag||(e.ColorDataFlag={})),i=function(){function t(){}return t.ConvertHexStringToInt=function(t){return parseInt(t,16)},t.prototype.Equals=function(t){return this.ColorType===t.ColorType&&this.Value===t.Value&&this.Tint===t.Tint},t.prototype.Clone=function(){return this},t.prototype.Compose=function(t,e){void 0===e&&(e=!0),t.Flag!==r.None&&(e?this.ConflictCompose(t):this.NonConflictCompose(t))},t.prototype.ConflictCompose=function(t){var e=this;(t.Flag&r.ColorType)===r.ColorType&&e.ColorType!==t.ColorType&&(e.ColorType=t.ColorType,e.Value=0,e.Tint=0),(t.Flag&r.Value)===r.Value&&(e.Value=t.Value),(t.Flag&r.Tint)===r.Tint&&(e.Tint=t.Tint),e.Flag|=t.Flag},t.prototype.NonConflictCompose=function(t){var e=this;(e.Flag&r.ColorType)!==r.ColorType&&(t.Flag&r.ColorType)===r.ColorType&&(e.ColorType=t.ColorType,e.Value=t.Value,e.Tint=t.Tint,e.Flag=t.Flag)},t.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},t.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},t.prototype.Compare=function(t,e){var n,o=this,i=!1;return(o.Flag&r.ColorType)===r.ColorType&&(n=(t.Flag&r.ColorType)!==r.ColorType||o.ColorType!==t.ColorType,e?n?(o.Flag=r.None,i=!0):((o.Flag&r.Value)===r.Value&&(((t.Flag&r.Value)!==r.Value||o.Value!==t.Value)&&(o.Flag=r.None,i=!0)),(o.Flag&r.Tint)===r.Tint&&(((t.Flag&r.Tint)!==r.Tint||o.Tint!==t.Tint)&&(o.Flag=r.None,i=!0))):n||((o.Flag&r.Value)===r.Value&&((t.Flag&r.Value)!==r.Value||o.Value!==t.Value||(o.Flag&=~r.Value,i=!0)),(o.Flag&r.Tint)===r.Tint&&((t.Flag&r.Tint)!==r.Tint||o.Tint!==t.Tint||(o.Flag&=~r.Tint,i=!0)),o.Flag===r.ColorType&&(o.Flag=r.None,i=!0))),i},t.prototype.UpdateDefaultValueFlag=function(){this.ColorType===o.ColorType.None?this.Flag=r.None:this.Flag=r.All},t.prototype.UpdateFlagFromBottom=function(){},t.prototype.ClearFlag=function(){this.Flag=r.None},t.prototype.SetFullFlag=function(){this.Flag=r.All},t.prototype.IsFullFlag=function(){return this.Flag===r.All},t}(),e.ColorData=i},"./dist/plugins/floatingObject/drawing/colorFormat.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function v(t){delete t.hslClr,delete t.prstClr,delete t.scrgbClr,delete t.srgbClr,delete t.sysClr}function C(t,e,n){e.length>0&&(t.lumMod=e),n.length>0&&(t.lumOff=n)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/plugins/floatingObject/drawing/colorData.js"),i=n("./dist/plugins/floatingObject/drawing/color.js"),a=n("./dist/plugins/floatingObject/drawing/common.js"),s=n("./dist/plugins/floatingObject/drawing/stateful.js"),l=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),u=o.Common.pc,c=a.UnitHelper.isNullOrUndefined,f=a.ShapeConstants.DefaultTransparent,h=a.ShapeConstants.PositionConver,p=null,d=Math.abs,g=Math.floor,e.createColorFormatFromRGB=function(t,e,n){var o=new m(t);return o.ColorType=e,o.RGB=n,o},e.createColorFormat=function(t,e,n,o){var r=new m(t);return r.ColorType=e,r.ObjectThemeColor=n,o&&(r.TintAndShade=o),r},m=function(t){function e(e,n){var o,r,i=t.call(this,n)||this;return void 0===n&&(n=p),(o=i).Hqa=l.ColorSchemeIndex.None,o.Iqa=p,o.Yba=0,o.Jqa=0,o.Gqa=f,o.xc=e,o.hqa=n,(r=o.xc.DrawingType)===l.DrawingType.Shape?o.Xba=l.SolidColorType.Theme:r===l.DrawingType.Chart?o.Xba=l.SolidColorType.Automatic:r===l.DrawingType.Picture&&(o.Xba=l.SolidColorType.None),o}return y(e,t),e.prototype.setColor=function(t,e){var n,o,r=this;t&&function(t,e){return t.getColor(e)!==e}(t.currentTheme(),e)?(n=a.ChartUtility.fromThemeColorString(e))&&(r.ObjectThemeColor=n.index,void 0!==n.tint&&(r.Brightness=n.tint)):(o=u.ec(e),r.RGB=i.ARGBColor.FromArgbs(o.a,o.r,o.g,o.b))},e.prototype.GetColorData=function(){var t,e,n,o,a=this,s=new r.ColorData;if(s.ColorType=l.ColorType.RGB,(t=a.Xba)===l.SolidColorType.None)s.ColorType=l.ColorType.None;else if(t===l.SolidColorType.Automatic){if(s.ColorType=l.ColorType.Auto,e=a.GetAutoColorFormat(),!c(e))return e.GetColorData()}else t===l.SolidColorType.RGB?c(a.Iqa)||(s.ColorType=l.ColorType.RGB,n=this.Iqa,1!==(o=1-a.Gqa)&&(n=i.ARGBColor.FromArgbs(parseInt(255*o,10),n.R,n.G,n.B)),s.Value=n.ToArgb(),s.Tint=a.Yba||a.Jqa):t===l.SolidColorType.Theme&&(s.ColorType=l.ColorType.Theme,s.Value=a.Hqa,s.Tint=a.Yba||a.Jqa,s.Transparency=a.Gqa);return s},e.prototype.HasOwnColor=function(){return this.GetState(l.ColorFormatStates.ObjectThemeColor)||this.GetState(l.ColorFormatStates.RGB)||this.GetAutoColorFormat()!==p},e.prototype.GetAutoColorFormat=function(){if(this.ColorType===l.SolidColorType.Automatic&&!c(this.AutoColorFormat)){var t=this.AutoColorFormat();if(!c(t)&&t.ColorType!==l.SolidColorType.Automatic)return t}return p},e.prototype.OnParentChanged=function(t){this.hqa=t},e.prototype.ClearModel=function(){var t,e;for(this.Lqa=p,t=0,e=this.Children;t<e.length;t++)e[t].ClearModel()},e.prototype.CalcBrightness=function(t,e){return t&&t.length>0&&e&&e.length>0?e[0]/h:t&&t.length>0?t[0]/h-1:0},e.prototype.CalcLumModeOff=function(t,e){var n=this;n.Brightness>0?(t.push(g((1-n.Brightness)*h)),e.push(g(n.Brightness*h))):n.Brightness<0&&t.push(g((1+n.Brightness)*h))},e.prototype.FromCT_ColorProperties=function(t){var e,n,o,r,s,u,f,h,p=this;p.Lqa=t,c(t)?p.ColorType=l.SolidColorType.None:c(t.schemeClr)?c(t.srgbClr)||c(t.srgbClr.val)||3!==t.srgbClr.val.length?c(t.scrgbClr)?c(t.sysClr)?c(t.prstClr)||(f=t.prstClr,h=a.ChartUtility.GetPresetColorRGB(f.val),p.RGB=i.ARGBColor.FromRgb(h[0],h[1],h[2]),p.Brightness=p.CalcBrightness(f.lumMod,f.lumOff),!c(f.alpha)&&f.alpha.length>0&&p.FromTransparency(f.alpha[0])):(u=(s=t.sysClr).val,c(u)?c(s.lastClr)||3!==s.lastClr.length||(p.RGB=i.ARGBColor.FromRgb(s.lastClr[0],s.lastClr[1],s.lastClr[2])):p.RGB=i.ARGBColor.FromKnownColor(u),p.Brightness=p.CalcBrightness(s.lumMod,s.lumOff),!c(s.alpha)&&s.alpha.length>0&&p.FromTransparency(s.alpha[0])):(r=t.scrgbClr,p.RGB=i.ARGBColor.FromRgb(r.r,r.g,r.b)):(o=t.srgbClr,p.RGB=i.ARGBColor.FromRgb(o.val[0],o.val[1],o.val[2]),p.Brightness=p.CalcBrightness(o.lumMod,o.lumOff),!c(o.alpha)&&o.alpha.length>0&&p.FromTransparency(o.alpha[0]),!c(o.tint)&&o.tint.length>0&&p.FromTint(o.tint[0])):(e=t.schemeClr,p.ObjectThemeColor=e.val,p.Brightness=p.CalcBrightness(e.lumMod,e.lumOff),p.Yba=0,!c(e.tint)&&e.tint.length>0&&p.FromTint(e.tint[0]),!c(e.alpha)&&e.alpha.length>0&&p.FromTransparency(e.alpha[0]),(n=e.shade)&&n.length&&p.FromShade(n[0]))},e.prototype.ToCT_ColorProperties=function(t){var e,n,o,r,i=this,s=i.Lqa||t,u=[],h=[],d=s.schemeClr;return d&&a.ChartUtility.removeEmptyArrayProperties(d),i.ColorType===l.SolidColorType.Theme?(v(s),d||(d=s.schemeClr={}),d.val=i.ObjectThemeColor,i.CalcLumModeOff(u,h),C(d,u,h),i.TintAndShade>0?d.tint=[i.ToTint()]:i.TintAndShade<0&&(d.shade=[i.ToShade()]),i.Transparency!==f&&(d.alpha=[i.ToTransparency()])):i.ColorType===l.SolidColorType.RGB&&(v(s),delete s.schemeClr,e=p,i.Iqa&&i.Iqa.IsKnownColor&&(e=i.Iqa.ToKnownColor()),c(e)?((o=s.srgbClr={}).val=[i.RGB.R,i.RGB.G,i.RGB.B],i.CalcLumModeOff(u,h),C(o,u,h),i.Transparency!==f&&(o.alpha=[i.ToTransparency()]),i.TintAndShade>0?o.tint=[i.ToTint()]:i.TintAndShade<0&&(o.shade=[i.ToShade()])):((n=s.sysClr={}).val=e,n.lastClr=[i.RGB.R,i.RGB.G,i.RGB.B],i.CalcLumModeOff(u,h),C(n,u,h),i.Transparency!==f&&(n.alpha=[i.ToTransparency()]))),r=t&&t.colorFillType,c(r)||(s.colorFillType=r),s},e.prototype.FromTint=function(t){this.TintAndShade=1-t/h},e.prototype.FromShade=function(t){this.TintAndShade=t/h-1},e.prototype.ToTint=function(){return g(d((1-this.TintAndShade)*h))},e.prototype.ToShade=function(){return g(d((1+this.TintAndShade)*h))},e.prototype.FromTransparency=function(t){this.Transparency=1-t/h},e.prototype.ToTransparency=function(){return g((1-this.Transparency)*h)},e.prototype.Clone=function(){var t=this,n=new e(t.xc);return n.Jqa=t.Jqa,n.Xba=t.Xba,n.xc=t.xc,n.Iqa=t.Iqa,n.Hqa=t.Hqa,n.Yba=t.Yba,n.AutoColorFormat=t.AutoColorFormat,n},e.prototype.FromOOModel=function(t){this.FromCT_ColorProperties(t)},e.prototype.ToOOModel=function(){var t=this.ColorType;return t===l.SolidColorType.Automatic?{}:t===l.SolidColorType.None?{colorFillType:l.ColorFillType.NoFillProperties}:this.ToCT_ColorProperties({colorFillType:0})},e.prototype.Color_FromOOModel=function(t){this.FromCT_ColorProperties(t)},e.prototype.Color_ToOOModel=function(){return this.ToCT_ColorProperties({})},e.prototype.GradientStop_FromOOModel=function(t){this.FromCT_ColorProperties(t)},e.prototype.GradientStop_ToOOModel=function(){return this.ToCT_ColorProperties({})},e.prototype.ColorData_FromOOModel=function(t){t.ColorType===l.ColorType.Index?this.RGB=i.ARGBColor.FromArgb(t.Value):t.ColorType===l.ColorType.Theme&&(this.ObjectThemeColor=t.Value,this.TintAndShade=t.Tint)},e.prototype.ColorData_ToOOModel=function(){var t=this,e=new r.ColorData;return t.ColorType===l.SolidColorType.RGB?(e.Value=t.RGB.Value,e.ColorType=l.ColorType.RGB):t.ColorType===l.SolidColorType.Theme&&(e.Value=t.ObjectThemeColor,e.Tint=t.TintAndShade,e.ColorType=l.ColorType.Theme),e},Object.defineProperty(e.prototype,"Brightness",{get:function(){return this.GetState(l.ColorFormatStates.Brightness)||c(this.hqa)?this.Jqa:this.hqa.Brightness},set:function(t){if(t<-1||t>1)throw Error();this.Jqa=t,this.Dirty(l.ColorFormatStates.Brightness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ObjectThemeColor",{get:function(){return this.GetState(l.ColorFormatStates.ObjectThemeColor)||c(this.hqa)?this.Hqa:this.hqa.ObjectThemeColor},set:function(t){var e=this,n={13:1,14:0,15:3,16:2};c(n[t])||(t=n[t]),e.Hqa=t,e.Dirty(l.ColorFormatStates.ObjectThemeColor),e.ColorType=l.SolidColorType.Theme,e.Iqa=p,e.UnDirty(l.ColorFormatStates.RGB),e.Jqa=0,e.Dirty(l.ColorFormatStates.Brightness)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RGB",{get:function(){var t=this;return t.HasOwnColor()||c(t.hqa)?t.xc.Kqa(t.GetColorData()):t.hqa.RGB},set:function(t){var e=this;e.Iqa=t,e.Transparency=1-t.A/255,e.Dirty(l.ColorFormatStates.RGB),e.ColorType=l.SolidColorType.RGB,e.Hqa=l.ColorSchemeIndex.None,e.Dirty(l.ColorFormatStates.ObjectThemeColor),e.Jqa=0,e.Yba=0,e.Dirty(l.ColorFormatStates.Brightness),e.Dirty(l.ColorFormatStates.TintAndShade)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TintAndShade",{get:function(){var t=this;return t.GetState(l.ColorFormatStates.TintAndShade)||c(t.hqa)?t.Yba:t.hqa.TintAndShade},set:function(t){this.Yba=t,this.Dirty(l.ColorFormatStates.TintAndShade)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(l.ColorFormatStates.Transparency)||c(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){t=Math.max(0,Math.min(1,t)),this.Gqa=t,this.Dirty(l.ColorFormatStates.Transparency)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorType",{get:function(){var t=this;return t.GetState(l.ColorFormatStates.ColorType)||c(t.hqa)?t.Xba:t.hqa.ColorType},set:function(t){this.Xba=t,this.Dirty(l.ColorFormatStates.ColorType)},enumerable:!0,configurable:!0}),e}(s.StatefullBase),e.ColorFormat=m},"./dist/plugins/floatingObject/drawing/common.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E;function D(t){return"number"==typeof t||t instanceof Date}function O(t,e,n){n.configurable=!0,n.enumerable=!0,Object.defineProperty(t,e,n)}function j(t){if(null==t)return!0;if(Array.isArray(t))return 0===t.length;if(t instanceof Date)return!1;if("object"!=typeof t)return!1;for(var e in t)return!1;return!0}function F(t,e){var n,o;if(j(t))return null;for(n in t)e.indexOf(n)>=0||(o=t[n],Array.isArray(o)?0!==o.length&&null!==P(o,e)||delete t[n]:"object"==typeof o&&(null===(o=F(o,e))&&delete t[n]));return j(t)?null:t}function P(t,e){var n=[],o=t.length;return t.forEach((function(t){var o=F(t,e);null!==o&&n.push(o)})),n.length<o&&[].splice.apply(t,[].concat(0,o,n)),n.length?t:null}function _(t){delete t.solidFill,delete t.pattFill,delete t.blipFill,delete t.gradFill,delete t.noFill,delete t.grpFill,delete t.uFill,delete t.uFillTx}function L(t){return 8===t||!R.Is3DChart(t)&&(R.IsBarChart(t)||R.IsColumnChart(t)||R.IsLineChart(t))}function B(t){var e,n,o,r=t.ChartType;if(0!==r)return L(r);for(n=0,o=(e=t.SeriesCollection.AllSers).length;n<o;n++)if(L(e[n].ChartType))return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),i=n("SheetsCalc"),a=n("./node_modules/util/util.js"),s=n("@grapecity/js-calc"),l=o.Common.l,u=null,c=void 0,f=Math.max,h=Math.min,p=Math.floor,d=Math.log,g=Math.pow,m=Math.ceil,y=Math.abs,v=function(){function t(){}return t.FromOADate=l.Xb,t.ToOADate=l.Ra,t.OADateMinAsDouble=-657435,t.OADateMaxAsDouble=2958466,t}(),e.DateTimeExtension=v,C=function(){function t(){}return t.log=function(t,e){return d(t)/d(e)},t.round=function(t,e){var n=g(10,e);return Math.round(t*n)/n},t.isNaNOrInfinite=function(t){return isNaN(t)||!isFinite(t)},t.GetTriangleAngle=function(t,e,n){var o,r;return 0===t&&0===e?0:(o=(t*t+n*n-e*e)/y(2*t*n),r=0,t<0&&e>0?r=90:t<0&&e<0?r=180:t>0&&e<0&&(r=270),180*Math.acos(o)/Math.PI+r)},t.INT32_MAX_VALUE=2147483647,t.DOUBLE_MAX_VALUE=Number.MAX_VALUE,t.DOUBLE_MIN_VALUE=-Number.MAX_VALUE,t}(),e.NumberExtension=C,b=function(){function t(){}return t.pointToPixel=function(t){return function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n}(96*t/72,2)},t.IsNullOrEmpty=function(e){return t.isNullOrUndefined(e)||""===e},t.IsNegativeInfinity=function(t){return t===Number.NEGATIVE_INFINITY},t.IsPositiveInfinity=function(t){return t===Number.POSITIVE_INFINITY},t.isNullOrUndefined=function(t){return t===c||t===u},t}(),e.UnitHelper=b,w=function(){function t(t,e,n,o){var r=this;r.Row=t,r.Column=e,r.RowCount=n,r.ColumnCount=o}return Object.defineProperty(t.prototype,"Left",{get:function(){return this.Column},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Top",{get:function(){return this.Row},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Right",{get:function(){return this.Column+this.ColumnCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Bottom",{get:function(){return this.Row+this.RowCount},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsFullColumn",{get:function(){return 0===this.Row&&this.RowCount===C.INT32_MAX_VALUE},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsFullRow",{get:function(){return 0===this.Column&&this.ColumnCount===C.INT32_MAX_VALUE},enumerable:!0,configurable:!0}),t.prototype.Intersect=function(t){var e=this,n=t,o=f(e.Column,n.Column),r=f(e.Row,n.Row),i=h(e.Right,n.Right),a=h(e.Bottom,n.Bottom);o>=i||r>=a?(e.Column=0,e.Row=0,e.ColumnCount=0,e.RowCount=0):(e.Column=o,e.Row=r,e.ColumnCount=i-o,e.RowCount=a-r)},t.prototype.IntersectsWith=function(t){var e=this,n=t;return!(e.Left>=n.Right||e.Right<=n.Left||e.Top>=n.Bottom||e.Bottom<=n.Top)},t}(),e.CellRect=w,T=function(){function t(t,e){this.Worksheet=t,this.tpa=e,this.UpdateRects()}return t.prototype.UpdateRects=function(){var t,e,n,o,r,i,a,s,l,u,c,f=this;for(f.upa=[],r=(o=f.Worksheet).getRowCount(),i=o.getColumnCount(),a=0;a<f.tpa.length;a++){if(s=(n=f.tpa[a]).Row,l=n.Column,t=n.RowCount,e=n.ColumnCount,(s<0||t<0||l<0||e<0)&&((s<0||t<0)&&(s=0,t=C.INT32_MAX_VALUE),(l<0||e<0)&&(l=0,e=C.INT32_MAX_VALUE),f.tpa[a]=new w(s,l,t,e)),(0!==s||t!==C.INT32_MAX_VALUE)&&(s<0||t<=0||s+t>1048576))throw Error();if((0!==l||e!==C.INT32_MAX_VALUE)&&(l<0||e<=0||l+e>16384))throw Error()}for(u=0,c=f.tpa;u<c.length;u++)n=c[u],t=h(n.Bottom,r+1)-n.Top,e=h(n.Right,i+1)-n.Left,f.upa.push(new w(n.Row,n.Column,t,e))},Object.defineProperty(t.prototype,"Row",{get:function(){var t=this.upa[0].Row;return t<0?0:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Column",{get:function(){var t=this.upa[0].Column;return t<0?0:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RowCount",{get:function(){var t=this,e=t.upa[0].RowCount,n=t.upa[0].Row;return e<0||n<0?t.Worksheet.getRowCount():e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ColumnCount",{get:function(){var t=this.upa[0].ColumnCount,e=this.upa[0].Column,n=this.Worksheet.getColumnCount();return t<0||e<0?n:t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EntireRow",{get:function(){var e,n,o=[];for(e=0;e<this.upa.length;e++)(n=this.upa[e]).Column=-1,n.ColumnCount=-1,o.push(n);return new t(this.Worksheet,o)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EntireColumn",{get:function(){var e,n,o=[];for(e=0;e<this.upa.length;e++)(n=this.upa[e]).Row=-1,n.RowCount=-1,o.push(n);return new t(this.Worksheet,o)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){var t=this;return t.Worksheet.vpa(t.Row,t.Column,t.RowCount,t.ColumnCount)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Areas",{get:function(){var e,n,o,r=[];for(e=0,n=this.upa;e<n.length;e++)o=n[e],r.push(new t(this.Worksheet,[o]));return r},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Hidden",{get:function(){return this.Worksheet.wpa(this.tpa)},enumerable:!0,configurable:!0}),t}(),e.Range=T,function(t){t[t.Row=1]="Row",t[t.Column=2]="Column",t[t.RowIsRelative=4]="RowIsRelative",t[t.ColumnIsRelative=8]="ColumnIsRelative",t[t.LastRowIsRelative=16]="LastRowIsRelative",t[t.LastColumnIsRelative=32]="LastColumnIsRelative",t[t.Range=64]="Range",t[t.Error=128]="Error"}(x||(x={})),S=function(){function t(t,e,n,o,r){var i=this;i.WorksheetName=t,i.Row=e,i.Column=n,void 0!==o&&(i.LastRow=o),void 0!==r&&(i.LastColumn=r)}return Object.defineProperty(t.prototype,"Row",{get:function(){return(this.Kind&x.Row)===x.Row?this.cj:0},set:function(t){this.cj=t,this.Kind|=x.Row},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Column",{get:function(){return(this.Kind&x.Column)===x.Column?this.Lk:0},set:function(t){this.Lk=t,this.Kind|=x.Column},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RowCount",{get:function(){var t=this;return t.IsRange?(t.Kind&x.Row)===x.Row?t.RowIsRelative&&t.LastRowIsRelative||!t.RowIsRelative&&!t.LastRowIsRelative?t.LastRow-t.Row+1:-1:t.Worksheet.getRowCount():1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ColumnCount",{get:function(){var t=this;return t.IsRange?(t.Kind&x.Column)===x.Column?t.ColumnIsRelative&&t.LastColumnIsRelative||!t.ColumnIsRelative&&!t.LastColumnIsRelative?t.LastColumn-t.Column+1:-1:t.Worksheet.getColumnCount():1},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastColumn",{get:function(){var t=this;return t.IsRange?(t.Kind&x.Column)===x.Column?t.xpa:t.Worksheet.getColumnCount()-1:t.Column},set:function(t){this.xpa=t,this.Kind|=x.Column|x.Range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastRow",{get:function(){var t=this;return t.IsRange?(t.Kind&x.Row)===x.Row?t.ypa:t.Worksheet.getRowCount()-1:t.Row},set:function(t){this.ypa=t,this.Kind|=x.Row|x.Range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"RowIsRelative",{get:function(){return(this.Kind&(x.Row|x.RowIsRelative))==(x.Row|x.RowIsRelative)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ColumnIsRelative",{get:function(){return(this.Kind&(x.Column|x.ColumnIsRelative))==(x.Column|x.ColumnIsRelative)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastRowIsRelative",{get:function(){return this.IsRange?(this.Kind&(x.Row|x.LastRowIsRelative))==(x.Row|x.LastRowIsRelative):this.RowIsRelative},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"LastColumnIsRelative",{get:function(){return this.IsRange?(this.Kind&(x.Column|x.LastColumnIsRelative))==(x.Column|x.LastColumnIsRelative):this.ColumnIsRelative},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsRange",{get:function(){return(this.Kind&x.Range)===x.Range},set:function(t){t?this.Kind|=x.Range:this.Kind&=~x.Range},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsError",{get:function(){return"#REF"===this.WorksheetName},enumerable:!0,configurable:!0}),t.prototype.GetSourceRange=function(t,e){var n=this,o=n.Row,r=n.Column,i=n.LastRow,a=n.LastColumn;return new w(o,r,i-o+1,a-r+1)},t.prototype.ToR1C1Text=function(t){var e,n,o,r,i,s;return t===c&&(t=u),n=(e=this).Yw,a.isNullOrUndefined(n)?(e.Kind&x.Error)===x.Error?e.GetPrevText(t)+"#REF!":(o="",(e.Kind&x.Row)===x.Row&&(r=e.Row,o+=e.RowIsRelative?0===r?"R":"R["+r+"]":"R"+(r+1)),(e.Kind&x.Column)===x.Column&&(i=e.Column,o+=e.ColumnIsRelative?0===i?"C":"C["+i+"]":"C"+(i+1)),e.IsRange&&(s=!1,(e.Kind&(x.Row|x.Column))!=(x.Row|x.Column)&&((e.Kind&x.Row)===x.Row?e.RowIsRelative===e.LastRowIsRelative&&e.Row===e.LastRow&&(s=!0):e.ColumnIsRelative===e.LastColumnIsRelative&&e.Column===e.LastColumn&&(s=!0)),s||(o+=":",(e.Kind&x.Row)===x.Row&&(r=e.LastRow,o+=e.LastRowIsRelative?0===r?"R":"R["+r+"]":"R"+(r+1)),(e.Kind&x.Column)===x.Column&&(i=e.LastColumn,o+=e.LastColumnIsRelative?0===i?"C":"C["+i+"]":"C"+(i+1)))),e.GetPrevText(t)+o):n},t.prototype.ToA1Text=function(t,e,n){var o,r,i,s,l;return n===c&&(n=u),r=(o=this).Yw,a.isNullOrUndefined(r)?(o.Kind&x.Error)===x.Error?o.GetPrevText(n)+"#REF!":(i="",(o.Kind&x.Column)===x.Column&&(l=o.Column,o.ColumnIsRelative?l+=e:i+="$",isNaN(l)||(i+=o.GetColumnIndexInA1Letter(l))),(o.Kind&x.Row)===x.Row&&(s=o.Row,o.RowIsRelative?s+=t:i+="$",i+=""+(s+1)),o.IsRange&&(i+=":",(o.Kind&x.Column)===x.Column&&(l=o.LastColumn,o.LastColumnIsRelative?l+=e:i+="$",isNaN(l)||(i+=o.GetColumnIndexInA1Letter(l))),(o.Kind&x.Row)===x.Row&&(s=o.LastRow,o.LastRowIsRelative?s+=t:i+="$",i+=""+(s+1))),o.GetPrevText(n)+i):r},t.prototype.GetPrevText=function(t){var e,n=this,o="";return n.Workbook>0&&(o="["+n.Workbook+"]"),e=n.WorksheetName,b.isNullOrUndefined(e)&&(e=t),e&&(o+=b.isNullOrUndefined(n.LastWorksheetName)?e:e+":"+n.LastWorksheetName),o?((n.IsSpecialSheetName(e)||n.IsSpecialSheetName(n.LastWorksheetName))&&(o="'"+o.replace("'","''")+"'"),o+="!"):""===e&&(o="!"),o},t.prototype.IsSpecialSheetName=function(e){var n,o;if(!b.isNullOrUndefined(e)){if(e===t.ErrorWorksheetName)return!1;for(n=0;n<e.length;n++)if(!((o=e[n])>="A"&&o<="Z"||o>="a"&&o<="z"||o>="0"&&o<="9"||"_"===o))return!0}return!1},t.prototype.GetColumnIndexInA1Letter=function(t){for(var e=[],n=0;(n=t%26,!isNaN(n))&&(e.unshift("ABCDEFGHIJKLMNOPQRSTUVWXYZ"[n]),0!==(t=parseInt(t/26+"",10)));)t--;return e.join("")},t.ErrorWorksheetName="#REF",t}(),e.Reference=S,e.ChartConstants={XValuesMinMax:"XValuesMinMax",ValuesMinMax:"ValuesMinMax",PrimaryValuesMinMax:"PrimaryValuesMinMax",SecondaryValuesMinMax:"SecondaryValuesMinMax",PrimaryXValuesMinMax:"PrimaryXValuesMinMax",SecondaryXValuesMinMax:"SecondaryXValuesMinMax",Collection:"Collection",Restore:"Restore",ChartType:"ChartType",AxisGroup:"AxisGroup",AreAllXValuesDateTime:"AreAllXValuesDateTime",XValuesFormula:"XValuesFormula",XValues:"XValues",CategoryNames:"CategoryNames",CategoryType:"CategoryType",SecondaryPlot:"SecondaryPlot",SplitType:"SplitType",SplitValue:"SplitValue",IsMultiLevelXValues:"IsMultiLevelXValues",PlotOrder:"PlotOrder",FIELD_TYPE_CELLRANGE:"CELLRANGE",FIELD_TYPE_SERIESNAME:"SERIESNAME",FIELD_TYPE_CATEGORYNAME:"CATEGORYNAME",FIELD_TYPE_VALUE:"VALUE",FIELD_TYPE_XVALUE:"XVALUE",FIELD_TYPE_YVALUE:"YVALUE",FIELD_TYPE_BUBBLESIZE:"BUBBLESIZE",FIELD_TYPE_PERCENTAGE:"PERCENTAGE",FIELD_TYPE_TXLINK:"TxLink",FIELD_TEXT_CELLRANGE:"[CELLRANGE]",FIELD_TEXT_SERIESNAME:"[SERIES NAME]",FIELD_TEXT_CATEGORYNAME:"[CATEGORY NAME]",FIELD_TEXT_VALUE:"[VALUE]",FIELD_TEXT_XVALUE:"[XVALUE]",FIELD_TEXT_YVALUE:"[YVALUE]",FIELD_TEXT_BUBBLESIZE:"[BUBBLE SIZE]",CHART_LATIN_HEAD_FONT:"+mj-lt",CHART_LATIN_BODY_FONT:"+mn-lt",CHART_EA_HEAD_FONT:"+mj-ea",CHART_EA_BODY_FONT:"+mn-ea",CHART_CS_HEAD_FONT:"+mj-cs",CHART_CS_BODY_FONT:"+mn-cs",DefaultLineColorBrightness:.85,DefaultMarkerSize:7},e.ShapeConstants={ShapeTypePrefix:"Shape",PositiveFixedAngleConvert:6e4,PositionConver:1e5,CropPositionConver:1e3,ShadeConver:2e5,DefaultBrightness:.5,RelativeRectConver:1e3,DefaultTransparent:0,PositiveFixedPercentageConvert:1e5,DefaultOffset:2.07995176},A=["","Dotted-5%","Dotted-10%","Dotted-20%","Dotted-25%","Dotted-30%","Dotted-40%","Dotted-50%","Dotted-60%","Dotted-70%","Dotted-75%","Dotted-80%","Dotted-90%","HorizontalStripes-Dark","VerticalStripes-Dark","DiagonalStripes-DarkDownward","DiagonalStripes-DarkUpward","SmallCheckerBoard","Trellis","HorizontalStripes-Light","VerticalStripes-Light","DiagonalStripes-LightDownward","DiagonalStripes-LightUpward","SmallGrid","DottedDiamondGrid","DiagonalStripes-WideDownward","DiagonalStripes-WideUpward","Stripes-Slashes","Stripes-Backslashes","VerticalStripes-Narrow","HorizontalStripes-Narrow","VerticalStripes-AlternatingVerticalLines","HorizontalStripes-AlternatingHorizontalLines","LargeConfetti","LargeGrid","HorizontalBrick","LargeCheckerBoard","SmallConfetti","ZigZag","SolidDiamondGrid","DiagonalBrick","OutlinedDiamondGrid","Plaid","Sphere","Weave","DottedGrid","Divot","Shingle","Wave"],function(t){t[t["background 1"]=0]="background 1",t[t["background 2"]=2]="background 2",t[t["text 1"]=1]="text 1",t[t["text 2"]=3]="text 2",t[t["accent 1"]=4]="accent 1",t[t["accent 2"]=5]="accent 2",t[t["accent 3"]=6]="accent 3",t[t["accent 4"]=7]="accent 4",t[t["accent 5"]=8]="accent 5",t[t["accent 6"]=9]="accent 6",t[t.hyperlink=10]="hyperlink",t[t.followedhyperlink=11]="followedhyperlink"}(I||(I={})),R=function(){function t(){}return t.Kqa=function(t,e){},t.Yra=function(t,e){return e===r.ThemeFont.Major?t.getFont("Headings"):e===r.ThemeFont.Minor?t.getFont("Body"):""},t.colorFormatToString=function(e,n,o,r){var i=e&&e.Color;return t.colorFormatToStringImp(i,n,o,r)},t.colorFormatToStringImp=function(e,n,o,i){var a,s;if(e&&e.ColorType!==r.SolidColorType.None){if(n&&(a=e.GetColorData()).ColorType===r.ColorType.Theme)return t.toThemeColorString(a.Value,a.Tint);if(s=e.RGB)return o?"rgba("+s.R+","+s.G+","+s.B+","+s.A/255+")":"rgb("+s.R+","+s.G+","+s.B+")"}else if(e&&e.ColorType===r.SolidColorType.None&&i)return"";return"transparent"},t.getFillFormatResult=function(e,n,o,r,i){var a,s,l,u,c;return 1===(e&&e.Type)?(a={},s=e&&e.PatternColor,l=e&&e.Color,u=t.colorFormatToStringImp(s,n,o,r),c=t.colorFormatToStringImp(l,n,o,r),i?(a.type="Pattern",a.color=c,a.pattern=[],a.pattern.push({style:{fill:u},content:A[e.Pattern]})):(a.type=e.Pattern,a.foregroundColor=u,a.backgroundColor=c),a):t.colorFormatToString(e,n,o,r)},t.getTransparencyFromColorFormat=function(t,e){var n,o=t&&t.Color;if(o&&(o.ColorType!==r.SolidColorType.None||e)){if(!b.isNullOrUndefined(o.Transparency))return parseFloat(o.Transparency.toFixed(2));if(n=o.RGB)return parseFloat((n.A/255).toFixed(2))}return 0},t.toThemeColorString=function(t,e){return I[t]+" "+parseInt(100*e+"",10)},t.fromThemeColorString=function(t){var e,n=t.split(" "),o=n.length,r=n[0].toLowerCase(),i=n[1],a=n[2];if("hyperlink"===r||"followedhyperlink"===r){if(1===o)return{index:I[r],tint:0};if(2===o)return{index:I[r],tint:parseInt(i,10)/100}}if(o>=2&&(e=I[r+" "+i])!==c){if(2===o)return{index:e,tint:0};if(3===o)return{index:e,tint:parseInt(a,10)/100}}},t.InitPresetColors=function(){var e=t.presetColors;e[r.ST_PresetColorVal.aliceBlue]=[240,248,255],e[r.ST_PresetColorVal.antiqueWhite]=[250,235,215],e[r.ST_PresetColorVal.aqua]=[0,255,255],e[r.ST_PresetColorVal.aquamarine]=[127,255,212],e[r.ST_PresetColorVal.azure]=[240,255,255],e[r.ST_PresetColorVal.beige]=[245,245,220],e[r.ST_PresetColorVal.bisque]=[255,228,196],e[r.ST_PresetColorVal.black]=[0,0,0],e[r.ST_PresetColorVal.blanchedAlmond]=[255,235,205],e[r.ST_PresetColorVal.blue]=[0,0,255],e[r.ST_PresetColorVal.blueViolet]=[138,43,226],e[r.ST_PresetColorVal.brown]=[165,42,42],e[r.ST_PresetColorVal.burlyWood]=[222,184,135],e[r.ST_PresetColorVal.cadetBlue]=[95,158,160],e[r.ST_PresetColorVal.chartreuse]=[127,255,0],e[r.ST_PresetColorVal.chocolate]=[210,105,30],e[r.ST_PresetColorVal.coral]=[255,127,80],e[r.ST_PresetColorVal.cornflowerBlue]=[100,149,237],e[r.ST_PresetColorVal.cornsilk]=[255,248,220],e[r.ST_PresetColorVal.crimson]=[220,20,60],e[r.ST_PresetColorVal.cyan]=[0,255,255],e[r.ST_PresetColorVal.darkBlue]=[0,0,139],e[r.ST_PresetColorVal.darkCyan]=[0,139,139],e[r.ST_PresetColorVal.darkGoldenrod]=[184,134,11],e[r.ST_PresetColorVal.darkGray]=[169,169,169],e[r.ST_PresetColorVal.darkGreen]=[0,100,0],e[r.ST_PresetColorVal.darkGrey]=[169,169,169],e[r.ST_PresetColorVal.darkKhaki]=[189,183,107],e[r.ST_PresetColorVal.darkMagenta]=[139,0,139],e[r.ST_PresetColorVal.darkOliveGreen]=[85,107,47],e[r.ST_PresetColorVal.darkOrange]=[255,140,0],e[r.ST_PresetColorVal.darkOrchid]=[153,50,204],e[r.ST_PresetColorVal.darkRed]=[139,0,0],e[r.ST_PresetColorVal.darkSalmon]=[233,150,122],e[r.ST_PresetColorVal.darkSeaGreen]=[143,188,143],e[r.ST_PresetColorVal.darkSlateBlue]=[72,61,139],e[r.ST_PresetColorVal.darkSlateGray]=[47,79,79],e[r.ST_PresetColorVal.darkSlateGrey]=[47,79,79],e[r.ST_PresetColorVal.darkTurquoise]=[0,206,209],e[r.ST_PresetColorVal.darkViolet]=[148,0,211],e[r.ST_PresetColorVal.deepPink]=[255,20,147],e[r.ST_PresetColorVal.deepSkyBlue]=[0,191,255],e[r.ST_PresetColorVal.dimGray]=[105,105,105],e[r.ST_PresetColorVal.dimGrey]=[105,105,105],e[r.ST_PresetColorVal.dkBlue]=[0,0,139],e[r.ST_PresetColorVal.dkCyan]=[0,139,139],e[r.ST_PresetColorVal.dkGoldenrod]=[184,134,11],e[r.ST_PresetColorVal.dkGray]=[169,169,169],e[r.ST_PresetColorVal.dkGreen]=[0,100,0],e[r.ST_PresetColorVal.dkGrey]=[169,169,169],e[r.ST_PresetColorVal.dkKhaki]=[189,183,107],e[r.ST_PresetColorVal.dkMagenta]=[139,0,139],e[r.ST_PresetColorVal.dkOliveGreen]=[85,107,47],e[r.ST_PresetColorVal.dkOrange]=[255,140,0],e[r.ST_PresetColorVal.dkOrchid]=[153,50,204],e[r.ST_PresetColorVal.dkRed]=[139,0,0],e[r.ST_PresetColorVal.dkSalmon]=[233,150,122],e[r.ST_PresetColorVal.dkSeaGreen]=[143,188,139],e[r.ST_PresetColorVal.dkSlateBlue]=[72,61,139],e[r.ST_PresetColorVal.dkSlateGray]=[47,79,79],e[r.ST_PresetColorVal.dkSlateGrey]=[47,79,79],e[r.ST_PresetColorVal.dkTurquoise]=[0,206,209],e[r.ST_PresetColorVal.dkViolet]=[148,0,211],e[r.ST_PresetColorVal.dodgerBlue]=[30,144,255],e[r.ST_PresetColorVal.firebrick]=[178,34,34],e[r.ST_PresetColorVal.floralWhite]=[255,250,240],e[r.ST_PresetColorVal.forestGreen]=[34,139,34],e[r.ST_PresetColorVal.fuchsia]=[255,0,255],e[r.ST_PresetColorVal.gainsboro]=[220,220,220],e[r.ST_PresetColorVal.ghostWhite]=[248,248,255],e[r.ST_PresetColorVal.gold]=[255,215,0],e[r.ST_PresetColorVal.goldenrod]=[218,165,32],e[r.ST_PresetColorVal.gray]=[128,128,128],e[r.ST_PresetColorVal.green]=[0,128,0],e[r.ST_PresetColorVal.greenYellow]=[173,255,47],e[r.ST_PresetColorVal.grey]=[128,128,128],e[r.ST_PresetColorVal.honeydew]=[240,255,240],e[r.ST_PresetColorVal.hotPink]=[255,105,180],e[r.ST_PresetColorVal.indianRed]=[205,92,92],e[r.ST_PresetColorVal.indigo]=[75,0,130],e[r.ST_PresetColorVal.ivory]=[255,255,240],e[r.ST_PresetColorVal.khaki]=[240,230,140],e[r.ST_PresetColorVal.lavender]=[230,230,250],e[r.ST_PresetColorVal.lavenderBlush]=[255,240,245],e[r.ST_PresetColorVal.lawnGreen]=[124,252,0],e[r.ST_PresetColorVal.lemonChiffon]=[255,250,205],e[r.ST_PresetColorVal.lightBlue]=[173,216,230],e[r.ST_PresetColorVal.lightCoral]=[240,128,128],e[r.ST_PresetColorVal.lightCyan]=[224,255,255],e[r.ST_PresetColorVal.lightGoldenrodYellow]=[250,250,210],e[r.ST_PresetColorVal.lightGray]=[211,211,211],e[r.ST_PresetColorVal.lightGreen]=[144,238,144],e[r.ST_PresetColorVal.lightGrey]=[211,211,211],e[r.ST_PresetColorVal.lightPink]=[255,182,193],e[r.ST_PresetColorVal.lightSalmon]=[255,160,122],e[r.ST_PresetColorVal.lightSeaGreen]=[32,178,170],e[r.ST_PresetColorVal.lightSkyBlue]=[135,206,250],e[r.ST_PresetColorVal.lightSlateGray]=[119,136,153],e[r.ST_PresetColorVal.lightSlateGrey]=[119,136,153],e[r.ST_PresetColorVal.lightSteelBlue]=[176,196,222],e[r.ST_PresetColorVal.lightYellow]=[255,255,224],e[r.ST_PresetColorVal.lime]=[0,255,0],e[r.ST_PresetColorVal.limeGreen]=[50,205,50],e[r.ST_PresetColorVal.linen]=[250,240,230],e[r.ST_PresetColorVal.ltBlue]=[173,216,230],e[r.ST_PresetColorVal.ltCoral]=[240,128,128],e[r.ST_PresetColorVal.ltCyan]=[224,255,255],e[r.ST_PresetColorVal.ltGoldenrodYellow]=[250,250,120],e[r.ST_PresetColorVal.ltGray]=[211,211,211],e[r.ST_PresetColorVal.ltGreen]=[144,238,144],e[r.ST_PresetColorVal.ltGrey]=[211,211,211],e[r.ST_PresetColorVal.ltPink]=[255,182,193],e[r.ST_PresetColorVal.ltSalmon]=[255,160,122],e[r.ST_PresetColorVal.ltSeaGreen]=[32,178,170],e[r.ST_PresetColorVal.ltSkyBlue]=[135,206,250],e[r.ST_PresetColorVal.ltSlateGray]=[119,136,153],e[r.ST_PresetColorVal.ltSlateGrey]=[119,136,153],e[r.ST_PresetColorVal.ltSteelBlue]=[176,196,222],e[r.ST_PresetColorVal.ltYellow]=[255,255,224],e[r.ST_PresetColorVal.magenta]=[255,0,255],e[r.ST_PresetColorVal.maroon]=[128,0,0],e[r.ST_PresetColorVal.medAquamarine]=[102,205,170],e[r.ST_PresetColorVal.medBlue]=[0,0,205],e[r.ST_PresetColorVal.mediumAquamarine]=[102,205,170],e[r.ST_PresetColorVal.mediumBlue]=[0,0,205],e[r.ST_PresetColorVal.mediumOrchid]=[186,85,211],e[r.ST_PresetColorVal.mediumPurple]=[147,112,219],e[r.ST_PresetColorVal.mediumSeaGreen]=[60,179,113],e[r.ST_PresetColorVal.mediumSlateBlue]=[123,104,238],e[r.ST_PresetColorVal.mediumSpringGreen]=[0,250,154],e[r.ST_PresetColorVal.mediumTurquoise]=[72,209,204],e[r.ST_PresetColorVal.mediumVioletRed]=[199,21,133],e[r.ST_PresetColorVal.medOrchid]=[186,85,211],e[r.ST_PresetColorVal.medPurple]=[147,112,219],e[r.ST_PresetColorVal.medSeaGreen]=[60,179,113],e[r.ST_PresetColorVal.medSlateBlue]=[123,104,238],e[r.ST_PresetColorVal.medSpringGreen]=[0,250,154],e[r.ST_PresetColorVal.medTurquoise]=[72,209,204],e[r.ST_PresetColorVal.medVioletRed]=[199,21,133],e[r.ST_PresetColorVal.midnightBlue]=[25,25,112],e[r.ST_PresetColorVal.mintCream]=[245,255,250],e[r.ST_PresetColorVal.mistyRose]=[255,228,225],e[r.ST_PresetColorVal.moccasin]=[255,228,181],e[r.ST_PresetColorVal.navajoWhite]=[255,222,173],e[r.ST_PresetColorVal.navy]=[0,0,128],e[r.ST_PresetColorVal.oldLace]=[253,245,230],e[r.ST_PresetColorVal.olive]=[128,128,0],e[r.ST_PresetColorVal.oliveDrab]=[107,142,35],e[r.ST_PresetColorVal.orange]=[255,165,0],e[r.ST_PresetColorVal.orangeRed]=[255,69,0],e[r.ST_PresetColorVal.orchid]=[218,112,214],e[r.ST_PresetColorVal.paleGoldenrod]=[238,232,170],e[r.ST_PresetColorVal.paleGreen]=[152,251,152],e[r.ST_PresetColorVal.paleTurquoise]=[175,238,238],e[r.ST_PresetColorVal.paleVioletRed]=[219,112,147],e[r.ST_PresetColorVal.papayaWhip]=[255,239,213],e[r.ST_PresetColorVal.peachPuff]=[255,218,185],e[r.ST_PresetColorVal.peru]=[205,133,63],e[r.ST_PresetColorVal.pink]=[255,192,203],e[r.ST_PresetColorVal.plum]=[221,160,221],e[r.ST_PresetColorVal.powderBlue]=[176,224,230],e[r.ST_PresetColorVal.purple]=[128,0,128],e[r.ST_PresetColorVal.red]=[255,0,0],e[r.ST_PresetColorVal.rosyBrown]=[188,143,143],e[r.ST_PresetColorVal.royalBlue]=[65,105,225],e[r.ST_PresetColorVal.saddleBrown]=[139,69,19],e[r.ST_PresetColorVal.salmon]=[250,128,114],e[r.ST_PresetColorVal.sandyBrown]=[244,164,96],e[r.ST_PresetColorVal.seaGreen]=[46,139,87],e[r.ST_PresetColorVal.seaShell]=[255,245,238],e[r.ST_PresetColorVal.sienna]=[160,82,45],e[r.ST_PresetColorVal.silver]=[192,192,192],e[r.ST_PresetColorVal.skyBlue]=[135,206,235],e[r.ST_PresetColorVal.slateBlue]=[106,90,205],e[r.ST_PresetColorVal.slateGray]=[112,128,144],e[r.ST_PresetColorVal.slateGrey]=[112,128,144],e[r.ST_PresetColorVal.snow]=[255,250,250],e[r.ST_PresetColorVal.springGreen]=[0,255,127],e[r.ST_PresetColorVal.steelBlue]=[70,130,180],e[r.ST_PresetColorVal.tan]=[210,180,140],e[r.ST_PresetColorVal.teal]=[0,128,128],e[r.ST_PresetColorVal.thistle]=[216,191,216],e[r.ST_PresetColorVal.tomato]=[255,99,71],e[r.ST_PresetColorVal.turquoise]=[64,224,208],e[r.ST_PresetColorVal.violet]=[238,130,238],e[r.ST_PresetColorVal.wheat]=[245,222,179],e[r.ST_PresetColorVal.white]=[255,255,255],e[r.ST_PresetColorVal.whiteSmoke]=[245,245,245],e[r.ST_PresetColorVal.yellow]=[255,255,0],e[r.ST_PresetColorVal.yellowGreen]=[154,205,50]},t.GetPresetColorRGB=function(e){return t.presetColors[e]},t.GetDimensioin=function(t){return{0:-1,1:2,33:2,34:2,35:2,36:2,11:3,48:3,57:2,58:2}[t]||1},t.AreValuesAllNum=function(t,e,n){var o,r,i;if(b.isNullOrUndefined(e))return null;for(o=t.getArray(e.row,e.col,e.rowCount,e.colCount),r=!0,i=0;i<o.length;i++)if(!this.AreAllNumbers(o[i],n)){r=!1;break}return r},t.AreValuesDateTime=function(e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,w;if(b.isNullOrUndefined(n)||0===n.length)return!1;for(r=!0,a=this.GetStylesFromCellRefers(e,n,o),s=this.GetValuesFromCellRefers(e,n,o),l=0;l<a.length;l++){for(c=(u=a[l]).length,f=u[0]&&u[0].length,h=0;h<f;h++){for(p=0;p<c;p++)if(d=u[p][h],i=s[l]&&s[l][p]&&s[l][p][h],!b.isNullOrUndefined(i)&&!(i instanceof Date)&&(b.isNullOrUndefined(d)||!t.IsDatesOrTimesNumberFormat(d.FormatCode)||!D(i))){r=!1;break}if(!r)break}if(!r)break}if(r){for(g=0,m=s;g<m.length;g++)for(y=0,v=m[g];y<v.length;y++)if(C=v[y],!b.isNullOrUndefined(C))for(w=0;w<C.length;w++)if(i=C[w],!b.isNullOrUndefined(i))return!0;return!1}return!1},t.AreAllNumbers=function(t,e){var n,o,r,i,a,s;if(!t)return!1;for(n=!0,o=0,r=t;o<r.length;o++)if(a=D(i=r[o]),s=e&&(null===i||i&&i._error),!a&&!s){n=!1;break}return n},t.AreAllNull=function(t){var e,n,o=!0;for(e=0,n=t;e<n.length;e++)if(null!=n[e]){o=!1;break}return o},t.AreAllDate=function(t){var e,n;for(e=0,n=t;e<n.length;e++)if(!(n[e]instanceof Date))return!1;return!0},t.TryAllToNumbers=function(t,e,n){var o,r,i,a,l,u;if(b.isNullOrUndefined(t)||0===t.length)return!1;for(o=!0,r=[],i=t.length,a=0;a<i;a++)l=t[a],b.isNullOrUndefined(l)?n||r.push(l):(u={value:void 0},this.TryToDouble(l,u)?r.push(u.value):(s.Convert&&s.Convert.jja(l)?r.push(Number.NaN):r.push(0),o=!1));return Array.prototype.push.apply(e,r),o},t.TryToDouble=function(t,e,n){var o,r,i,a,s=u;if(!t)return e.value=0,!0;o=typeof t;try{if("number"===o)s=t;else if("string"===o&&n){if(0===(t=t.trim()).length)return e.value=0,!0;if(r=".",",",i=!1,"%"===t.charAt(t.length-1)&&(i=!0,t=t.substr(0,t.length-1)),"$"===t[0]||"$"===t[t.length-1])return!1;if(t.indexOf(r)!==t.lastIndexOf(r))return!1;if(t.length>=2&&"0"===t[0]&&"x"===t[1])return!1;if(s=+t,C.isNaNOrInfinite(s)){if(a=t.charCodeAt(0),a|=32,t.length>4&&a>=96&&a<=122&&!{JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12}[(t[0]+t[1]+t[2]).toUpperCase()])return!1;if("/"===t[0]||"/"===t[t.length-1])return!1;if("#"===t[0]||"#"===t[t.length-1])return!1;if(s=new Date(t),C.isNaNOrInfinite(s.valueOf()))return!1;s=v.ToOADate(s)}i&&(s/=100)}else if("boolean"===o)s=t?1:0;else{if(!(t instanceof Date))return!1;s=v.ToOADate(t)}}catch(t){return!1}return e.value=s,!0},t.IsBarChart=function(t){return t===r.ChartType.barClustered||t===r.ChartType.barClustered3D||t===r.ChartType.barStacked||t===r.ChartType.barStacked100||t===r.ChartType.barStacked1003D||t===r.ChartType.barStacked3D},t.zpa=function(e){var n,o=t.chartTypeDict;if(!o)for(n in o=t.chartTypeDict={},r.ChartType)o[r.ChartType[n]]=n.toLowerCase();return o[e]},t.IsColumnChart=function(e){return t.zpa(e).indexOf("column")>=0},t.IsAnyPieChart=function(t){return this.IsPieChart(t)||this.IsDoughnutChart(t)||this.IsOfPieChart(t)},t.IsFunnelChart=function(t){return t===r.ChartType.funnel},t.IsPieChart=function(e){return t.zpa(e).indexOf("pie")>=0},t.IsPieOrDoughnutChart=function(t){return this.IsPieChart(t)||this.IsDoughnutChart(t)},t.IsRadarChart=function(t){return t===r.ChartType.radar||t===r.ChartType.radarFilled||t===r.ChartType.radarMarkers},t.IsOfPieChart=function(t){return t===r.ChartType.pieOfPie||t===r.ChartType.barOfPie},t.IsStackedChart=function(e){return t.zpa(e).indexOf("stacked")>=0},t.IsStacked100Chart=function(e){return t.zpa(e).indexOf("stacked100")>=0},t.IsLineChart=function(t){return t===r.ChartType.line3D||t===r.ChartType.line||t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100||t===r.ChartType.lineStacked||t===r.ChartType.lineStacked100},t.IsLineMarkerChart=function(t){return t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100},t.IsLineSeries=function(t){return t===r.ChartType.line||t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100||t===r.ChartType.lineStacked||t===r.ChartType.lineStacked100||t===r.ChartType.xyScatterLines||t===r.ChartType.xyScatterLinesNoMarkers||t===r.ChartType.xyScatterSmooth||t===r.ChartType.xyScatterSmoothNoMarkers||t===r.ChartType.radar||t===r.ChartType.radarMarkers},t.IsMarkerSeries=function(t){return t===r.ChartType.lineMarkers||t===r.ChartType.lineMarkersStacked||t===r.ChartType.lineMarkersStacked100||t===r.ChartType.radarMarkers||t===r.ChartType.xyScatter||t===r.ChartType.xyScatterLines||t===r.ChartType.xyScatterSmooth},t.IsErrorBarSeries=function(e){return!t.Is3DChart(e)&&(t.IsBarChart(e)||t.IsAreaChart(e)||t.IsLineChart(e)||t.IsColumnChart(e)||t.IsScatterChart(e)||t.IsBubbleChart(e))},t.IsTrendlineSeries=function(e){return!t.Is3DChart(e)&&!t.IsStackedChart(e)&&(e===r.ChartType.barClustered||e===r.ChartType.columnClustered||e===r.ChartType.line||e===r.ChartType.lineMarkers||e===r.ChartType.area||t.IsScatterChart(e)||t.IsBubbleChart(e))},t.IsFillSeries=function(t){return!this.IsLineSeries(t)&&t!==r.ChartType.xyScatter},t.IsAreaChart=function(e){return t.zpa(e).indexOf("area")>=0},t.IsScatterChart=function(e){return t.zpa(e).indexOf("scatter")>=0},t.IsSurfaceChart=function(e){return t.zpa(e).indexOf("surface")>=0},t.IsBubbleChart=function(e){return t.zpa(e).indexOf("bubble")>=0},t.IsSmoothLine=function(e){return t.zpa(e).indexOf("smooth")>=0},t.Is3DChart=function(e){var n=t.zpa(e);return n.indexOf("3d")>=0&&e!==r.ChartType.bubble3DEffect||this.IsSurfaceChart(e)||n.indexOf("cylinder")>=0||n.indexOf("cone")>=0||n.indexOf("pyramid")>=0},t.IsSurface3DChart=function(t){return t===r.ChartType.surface||t===r.ChartType.surfaceWireframe},t.IsDoughnutChart=function(t){return t===r.ChartType.doughnut||t===r.ChartType.doughnutExploded},t.IsExplodedChart=function(t){return t===r.ChartType.pieExploded3D||t===r.ChartType.doughnutExploded||t===r.ChartType.pieExploded},t.HasSeriesAx=function(t){return t===r.ChartType.column3D||t===r.ChartType.area3D||t===r.ChartType.line3D||this.IsSurfaceChart(t)},t.IsStockChart=function(e){return t.zpa(e).indexOf("stock")>=0},t.IsTreeMap=function(t){return t===r.ChartType.treemap},t.IsSunburstChart=function(t){return t===r.ChartType.sunburst},t.IsSunburstOrTreemapChart=function(e){return t.IsTreeMap(e)||t.IsSunburstChart(e)},t.IsStockHLC=function(t){return t===r.ChartType.stockHLC},t.IsBuiltInComboChart=function(t){return this.IsStockChart(t)},t.ConvertToTextUnderlineType=function(t){var e=r.TextUnderlineType.None;return t===r.UnderlineType.Single?e=r.TextUnderlineType.Single:t===r.UnderlineType.Double&&(e=r.TextUnderlineType.Double),e},t.ToUnderlineType=function(t){var e=r.UnderlineType.None;return t===r.TextUnderlineType.Single?e=r.UnderlineType.Single:t===r.TextUnderlineType.Double&&(e=r.UnderlineType.Double),e},t.MapToGroupType=function(t){return{12:9,13:9,14:9,15:3,16:3,17:3,6:3,18:8,19:8,20:8,21:2,22:2,23:2,9:11,24:11,25:11,26:11,27:11,28:11,5:4,10:12,29:12,30:12,32:12,31:5,4:5,1:14,33:14,34:14,35:14,36:14,8:7,37:7,38:7,39:1,40:1,7:1,3:10,41:10,2:13,42:13,43:13,44:6,45:6,46:6,47:6,11:14,48:14,49:11,50:11,51:11,52:11}[t]||E.UnKnown},t.HasSeriesLines=function(t){return this.IsOfPieChart(t)},t.HasHiLoLines=function(t){return this.IsStockChart(t)},t.HasUpDownBars=function(t){return t===r.ChartType.stockOHLC||t===r.ChartType.stockVOHLC},t.RangeToReferences=function(e){var n,o,r,i=[];for(n=0,o=e.Areas;n<o.length;n++)r=o[n],i.push(t.CreateReference(r.Worksheet.name(),r.Row,r.Column,r.RowCount,r.ColumnCount));return i},t.CreateReference=function(t,e,n,o,r){return 1===o&&1===r?new S(t,e,n):new S(t,e,n,e+o-1,n+r-1)},t.ReferencesToFormula=function(t,e){var n,o;if(e===c&&(e=!1),b.isNullOrUndefined(t)||0===t.length)return u;for(n=[],o=0;o<t.length;o++)o>0&&n.push(","),e?n.push(t[o].ToR1C1Text()):n.push(t[o].ToA1Text(0,0));return n.join("")},t.getRangeInfoByFormula=function(t,e){var n,o;return e&&((n=i.formulaToRanges(t,e,0,0)[0])&&(o=t.parent.getSheetFromName(n.sheetName)))?{sheet:o,range:n.ranges&&n.ranges[0]}:{range:{}}},t.isContinuousRange=function(t,e,n){if(t.sheet!==e.sheet)return!1;var o,r,i,a,s,l,u,c,f,h;if(n){if(i=(o=t.range).rowCount,a=o.col,s=o.colCount,c=(l=e.range).rowCount,f=l.col,i===c&&a+s===f)return!0}else if(i=(o=t.range).rowCount,r=o.row,s=o.colCount,h=(l=e.range).colCount,u=o.row,s===h&&r+i===u)return!0},t.GetValuesFromCellRefers=function(t,e,n){var o,r,i,a,s=[];if(b.isNullOrUndefined(e)||0===e.length||e.some((function(t){return t.IsError})))return s;for(o=0,r=e;o<r.length;o++)i=r[o],a=this.GetValuesFromCellRefer(t,i,n),b.isNullOrUndefined(a)||s.push(a);return s},t.GetValuesFromCellRefer=function(t,e,n){var o=t.Apa(e.WorksheetName);return b.isNullOrUndefined(o)?u:n?o.Bpa(e.Row,e.Column,e.RowCount,e.ColumnCount,!0):o.Cpa(e.Row,e.Column,e.RowCount,e.ColumnCount,!0)},t.GetStylesFromCellRefers=function(t,e,n){var o,r,i,a,s=[];if(b.isNullOrUndefined(e)||0===e.length||e.some((function(t){return t.IsError})))return s;for(o=0,r=e;o<r.length;o++)i=r[o],a=this.GetStylesFromCellRefer(t,i,n),b.isNullOrUndefined(a)||s.push(a);return s},t.GetStylesFromCellRefer=function(t,e,n){var o=t.Apa(e.WorksheetName);return b.isNullOrUndefined(o)?u:n?o.Dpa(e.Row,e.Column,e.RowCount,e.ColumnCount):o.Epa(e.Row,e.Column,e.RowCount,e.ColumnCount)},t.GetPrimaryAxises=function(t){var e,n=[];return t.axes&&t.axes.length>0&&(e=t.axes[0],n.push(e.axId),n.push(e.crossAx),n.axisGroup=e.AxisGroup),n},t.GetAxises=function(e,n){var o,i,a,s,l=t.GetPrimaryAxises(e);if(n===r.AxisGroup.primary)return l;if(o=[],!b.isNullOrUndefined(e.axes))for(i=0,a=e.axes.filter((function(t){return l.indexOf(t.axId)<0}));i<a.length;i++)s=a[i],o.push(s.axId);return o},t.GetCategoryAxises=function(t){var e,n,o,r=[];for(e=0,n=t.chartGroups;e<n.length;e++)o=n[e],!b.isNullOrUndefined(o.axId)&&o.axId.length>0&&r.push(o.axId[0]);return r},t.GetIs2016ChartByPlotArea=function(e){return!!t.Get2016ChartType(e)},t.GetIs2016ChartByChartType=function(t){return 53===t||54===t||55===t||56===t||57===t||58===t||59===t||60===t},t.Get2016ChartType=function(t){var e,n=t&&t.plotAreaRegion&&t.plotAreaRegion.series;return n&&n.length>0&&(e=n[0].layoutId),e},t.GetChartType=function(e){var n,o,i,a,s,l,u=t.Get2016ChartType(e);if(u)return t.GetChartTypeBy2016InnerChartType(u);if(n=this.GetStockChartType(e),!b.isNullOrUndefined(n))return n;for(o=[],i=0,a=e.chartGroups;i<a.length;i++)s=a[i],l=t.GetChartTypeByChartBase(s),o.indexOf(l)<0&&o.push(l);return 0===o.length?r.ChartType.columnClustered:o.length>1?r.ChartType.combo:o[0]},t.GetStockChartType=function(e){var n=t.GetStockChart(e);if(0===n.length)return u;if(!b.isNullOrUndefined(e.chartGroups)&&e.chartGroups.length>1){if(3===n[0].ser.length)return r.ChartType.stockVHLC;if(4===n[0].ser.length)return r.ChartType.stockVOHLC}else{if(3===n[0].ser.length)return r.ChartType.stockHLC;if(4===n[0].ser.length)return r.ChartType.stockOHLC}return u},t.GetChartTypeByChartBase=function(e,n){return n===c&&(n=u),e.chartType===r.CT_ChartType.CT_BarChart||e.chartType===r.CT_ChartType.CT_Bar3DChart?t.GetChartTypeByBarChart(e):e.chartType===r.CT_ChartType.CT_AreaChart||e.chartType===r.CT_ChartType.CT_Area3DChart?t.GetChartTypeByAreaChart(e):e.chartType===r.CT_ChartType.CT_LineChart||e.chartType===r.CT_ChartType.CT_Line3DChart?t.GetChartTypeByLineChart(e,n):[r.CT_ChartType.CT_PieChart,r.CT_ChartType.CT_Pie3DChart,r.CT_ChartType.CT_DoughnutChart,r.CT_ChartType.CT_OfPieChart].indexOf(e.chartType)>=0?t.GetChartTypeByPieChart(e):e.chartType===r.CT_ChartType.CT_RadarChart?t.GetChartTypeByRadarChart(e,n):e.chartType===r.CT_ChartType.CT_ScatterChart?t.GetChartTypeByScatterChart(e,n):e.chartType===r.CT_ChartType.CT_BubbleChart?t.GetChartTypeByBubbleChart(e):e.chartType===r.CT_ChartType.CT_SurfaceChart||e.chartType===r.CT_ChartType.CT_Surface3DChart?t.GetChartTypeBySurfaceChart(e):r.ChartType.columnClustered},t.GetChartTypeBy2016InnerChartType=function(t){if(!b.isNullOrUndefined(t))switch(t){case r.CT_ChartType.CT_BoxWhisker:return r.ChartType.boxWhisker;case r.CT_ChartType.CT_Funnel:return r.ChartType.funnel;case r.CT_ChartType.CT_ParetoLine:return r.ChartType.paretoLine;case r.CT_ChartType.CT_RegionMap:return r.ChartType.regionMap;case r.CT_ChartType.CT_Sunburst:return r.ChartType.sunburst;case r.CT_ChartType.CT_Treemap:return r.ChartType.treemap;case r.CT_ChartType.CT_Waterfall:return r.ChartType.waterfall;case r.CT_ChartType.CT_ClusteredColumn:return r.ChartType.clusteredColumn}return r.CT_ChartType.CT_Treemap},t.Get2016InnerChartTypeByChartType=function(t){if(!b.isNullOrUndefined(t))switch(t){case r.ChartType.boxWhisker:return r.CT_ChartType.CT_BoxWhisker;case r.ChartType.funnel:return r.CT_ChartType.CT_Funnel;case r.ChartType.paretoLine:return r.CT_ChartType.CT_ParetoLine;case r.ChartType.regionMap:return r.CT_ChartType.CT_RegionMap;case r.ChartType.sunburst:return r.CT_ChartType.CT_Sunburst;case r.ChartType.treemap:return r.CT_ChartType.CT_Treemap;case r.ChartType.waterfall:return r.CT_ChartType.CT_Waterfall;case r.ChartType.clusteredColumn:return r.CT_ChartType.CT_ClusteredColumn}return r.CT_ChartType.CT_Treemap},t.GetChartTypeByBarChart=function(t){var e=t.chartType===r.CT_ChartType.CT_Bar3DChart;if(b.isNullOrUndefined(t.grouping))return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered3D:r.ChartType.columnClustered3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered:r.ChartType.columnClustered;switch(t.grouping){case r.ST_BarGrouping.percentStacked:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked1003D:r.ChartType.columnStacked1003D:t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked100:r.ChartType.columnStacked100;case r.ST_BarGrouping.clustered:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered3D:r.ChartType.columnClustered3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered:r.ChartType.columnClustered;case r.ST_BarGrouping.standard:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered3D:r.ChartType.column3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barClustered:r.ChartType.columnClustered;case r.ST_BarGrouping.stacked:return e?t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked3D:r.ChartType.columnStacked3D:t.barDir===r.ST_BarDir.bar?r.ChartType.barStacked:r.ChartType.columnStacked}return r.ChartType.columnClustered},t.GetChartTypeByAreaChart=function(t){var e=t.chartType===r.CT_ChartType.CT_Area3DChart;if(b.isNullOrUndefined(t.grouping))return e?r.ChartType.area3D:r.ChartType.area;switch(t.grouping){case r.ST_Grouping.percentStacked:return e?r.ChartType.areaStacked1003D:r.ChartType.areaStacked100;case r.ST_Grouping.standard:return e?r.ChartType.area3D:r.ChartType.area;case r.ST_Grouping.stacked:return e?r.ChartType.areaStacked3D:r.ChartType.areaStacked}return r.ChartType.area},t.GetChartTypeByLineChart=function(t,e){var n=t.chartType===r.CT_ChartType.CT_Line3DChart,o=t.marker;if(b.isNullOrUndefined(t.grouping)){if(n)return r.ChartType.line3D}else switch(t.grouping){case r.ST_Grouping.percentStacked:return n?r.ChartType.line3D:o?r.ChartType.lineMarkersStacked100:r.ChartType.lineStacked100;case r.ST_Grouping.standard:return n?r.ChartType.line3D:o?r.ChartType.lineMarkers:r.ChartType.line;case r.ST_Grouping.stacked:return n?r.ChartType.line3D:o?r.ChartType.lineMarkersStacked:r.ChartType.lineStacked;default:return r.ChartType.area}return o?r.ChartType.lineMarkers:r.ChartType.line},t.GetChartTypeByPieChart=function(t){return t.chartType===r.CT_ChartType.CT_PieChart?r.ChartType.pie:t.chartType===r.CT_ChartType.CT_Pie3DChart?r.ChartType.pie3D:t.chartType===r.CT_ChartType.CT_OfPieChart?t.ofPieType===r.ST_OfPieType.bar?r.ChartType.barOfPie:r.ChartType.pieOfPie:t.chartType===r.CT_ChartType.CT_DoughnutChart?r.ChartType.doughnut:r.ChartType.pie},t.GetChartTypeByRadarChart=function(t,e){var n=e&&e.marker&&e.marker.symbol&&e.marker.symbol===r.MarkerStyle.MarkerStyleNone;if(!b.isNullOrUndefined(t.radarStyle))switch(t.radarStyle){case r.ST_RadarStyle.standard:case r.ST_RadarStyle.marker:return n?r.ChartType.radar:r.ChartType.radarMarkers;case r.ST_RadarStyle.filled:return r.ChartType.radarFilled}return 2},t.GetChartTypeByScatterChart=function(t,e){var n,o,i,a,s,l,u=t.scatterStyle;return b.isNullOrUndefined(u)?r.ChartType.xyScatter:(n={0:1,1:36,2:35,3:r.ChartType.xyScatter,4:34,5:33},o=u,a=4===((i=e||t.ser[0])&&i.marker&&i.marker.symbol),l=(s=i&&i.spPr&&i.spPr.ln)&&s.noFill,2===o?l?o=3:a&&(o=1):5===o&&a&&(o=4),n[o])},t.GetChartTypeByBubbleChart=function(t){return t.bubble3D?r.ChartType.bubble3DEffect:r.ChartType.bubble},t.GetChartTypeBySurfaceChart=function(t){return t.chartType===r.CT_ChartType.CT_Surface3DChart?t.wireframe?r.ChartType.surfaceWireframe:r.ChartType.surface:t.wireframe?r.ChartType.surfaceTopViewWireframe:r.ChartType.surfaceTopView},t.GetTextFieldTypeString=function(t){return{0:e.ChartConstants.FIELD_TYPE_CELLRANGE,1:e.ChartConstants.FIELD_TYPE_SERIESNAME,2:e.ChartConstants.FIELD_TYPE_CATEGORYNAME,3:e.ChartConstants.FIELD_TYPE_VALUE,4:e.ChartConstants.FIELD_TYPE_XVALUE,5:e.ChartConstants.FIELD_TYPE_YVALUE,6:e.ChartConstants.FIELD_TYPE_BUBBLESIZE,7:e.ChartConstants.FIELD_TYPE_PERCENTAGE,8:e.ChartConstants.FIELD_TYPE_TXLINK}[t]||""},t.GetTextFieldTypeText=function(t){return{0:e.ChartConstants.FIELD_TEXT_CELLRANGE,1:e.ChartConstants.FIELD_TEXT_SERIESNAME,2:e.ChartConstants.FIELD_TEXT_CATEGORYNAME,3:e.ChartConstants.FIELD_TEXT_VALUE,4:e.ChartConstants.FIELD_TEXT_XVALUE,5:e.ChartConstants.FIELD_TEXT_YVALUE,6:e.ChartConstants.FIELD_TEXT_BUBBLESIZE}[t]||""},t.GetTextFieldType=function(t){var n=r.TextFieldType.CellRange;switch(t){case e.ChartConstants.FIELD_TYPE_CELLRANGE:n=r.TextFieldType.CellRange;break;case e.ChartConstants.FIELD_TYPE_SERIESNAME:n=r.TextFieldType.SeriesName;break;case e.ChartConstants.FIELD_TYPE_CATEGORYNAME:n=r.TextFieldType.CategoryName;break;case e.ChartConstants.FIELD_TYPE_VALUE:n=r.TextFieldType.Value;break;case e.ChartConstants.FIELD_TYPE_XVALUE:n=r.TextFieldType.XValue;break;case e.ChartConstants.FIELD_TYPE_YVALUE:n=r.TextFieldType.YValue;break;case e.ChartConstants.FIELD_TYPE_BUBBLESIZE:n=r.TextFieldType.BubbleSize;break;case e.ChartConstants.FIELD_TYPE_PERCENTAGE:n=r.TextFieldType.Percentage;break;case e.ChartConstants.FIELD_TYPE_TXLINK:n=r.TextFieldType.TxLink}return n},t.GetPrimaryPieChart=function(t){return t[0]},t.GetPlotAreaCharts=function(t,e){return t.chartGroups?t.chartGroups.filter((function(t){return t.chartType===e})):[]},t.GetAreaChart=function(e){return t.GetPlotAreaCharts(e,4)},t.GetArea3DChart=function(e){var n=t.GetPlotAreaCharts(e,5);return n.length>0?n[0]:u},t.GetBarChart=function(e){return t.GetPlotAreaCharts(e,6)},t.GetBar3DChart=function(e){var n=t.GetPlotAreaCharts(e,7);return n.length>0?n[0]:u},t.GetLineChart=function(e){return t.GetPlotAreaCharts(e,8)},t.GetLine3DChart=function(e){var n=t.GetPlotAreaCharts(e,9);return n.length>0?n[0]:u},t.GetStockChart=function(e){return t.GetPlotAreaCharts(e,0)},t.GetRadarChart=function(e){return t.GetPlotAreaCharts(e,2)},t.GetScatterChart=function(e){return t.GetPlotAreaCharts(e,1)},t.GetPieCharts=function(t){var e=[10,11,12,13];return t.chartGroups?t.chartGroups.filter((function(t){return e.indexOf(t.chartType)>=0})):[]},t.GetPieChart=function(e){return t.GetPlotAreaCharts(e,10)},t.GetPie3DChart=function(e){var n=t.GetPlotAreaCharts(e,11);return n.length>0?n[0]:u},t.GetDoughnutChart=function(e){return t.GetPlotAreaCharts(e,12)},t.GetOfPieChart=function(e){return t.GetPlotAreaCharts(e,13)},t.GetSurfaceChart=function(e){return t.GetSurface3DChartOrChart(e,14)},t.GetSurface3DChart=function(e){return t.GetSurface3DChartOrChart(e,15)},t.GetSurface3DChartOrChart=function(e,n){var o=t.GetPlotAreaCharts(e,n);return o.length>0?o[0]:u},t.GetBubbleChart=function(e){return t.GetPlotAreaCharts(e,3)},t.GetAxes=function(t,e){return t.axes.filter((function(t){return t.axisType===e}))},t.removeEmptyArrayProperties=function(t){var e,n;for(e in t)t.hasOwnProperty(e)&&(n=t[e],Array.isArray(n)&&0===n.length&&delete t[e])},t.allSeriesIsScatterOrBubble=function(e){var n,o,r,i,a=e.ChartType;if(t.IsBubbleChart(a)||t.IsScatterChart(a))return!0;if(0===a&&(o=(n=e.SeriesCollection.AllSers).length)>0){if(r=n[0].ChartType,i=void 0,t.IsBubbleChart(r)){for(i=1;i<o;i++)if(!t.IsBubbleChart(n[i].ChartType))return!1;return!0}if(t.IsScatterChart(r)){for(i=1;i<o;i++)if(!t.IsScatterChart(n[i].ChartType))return!1;return!0}}return!1},t.getLineFormatInfo=function(e,n,o,r,i){var s,l,c,f=e&&e.Format&&e.Format.Line;return f?(l={},(s=f.Weight)>=0&&(l.width=s),c=t.colorFormatToString(f,n,o,r),o||(l.transparency=t.getTransparencyFromColorFormat(f,i)),(c||""===c&&r)&&(l.color=c),a.isNullOrUndefined(f.DashStyle)||(l.dashStyle=f.DashStyle),l):u},t.isSupportConnectedLineChartType=function(t){return t===r.ChartType.line||t===r.ChartType.lineMarkers||t===r.ChartType.xyScatterLines||t===r.ChartType.xyScatterLinesNoMarkers||t===r.ChartType.xyScatterSmooth||t===r.ChartType.xyScatterSmoothNoMarkers},t.isSupportConnected=function(e,n){var o,r,i;if(t.isSupportConnectedLineChartType(e)||t.IsRadarChart(e))return!0;if(0===e)for(o=n.SeriesCollection.AllSers,r=0;r<o.length;r++)if(i=o[r].ChartType,t.isSupportConnectedLineChartType(i)||t.IsRadarChart(i))return!0;return!1},t.isSupportGaps=function(t){return t!==r.ChartType.sunburst&&t!==r.ChartType.treemap&&t!==r.ChartType.lineMarkersStacked&&t!==r.ChartType.lineMarkersStacked100&&t!==r.ChartType.lineStacked&&t!==r.ChartType.lineStacked100},t.IsDatesOrTimesNumberFormat=function(e){var n,o,r,i,a,s,l,c;if(!e||0===e.length)return!1;if("["===(e=e.toUpperCase().trim())[0]){if(-1===(n=e.indexOf("]"))||n===e.length-1)return!1;e=e.substr(n+1)}for(o=-1,r=0,i=!1,a=u,s=0;s<e.length;s++){if("["===(c=e[s]))do{c=e[s],s++}while(s<e.length&&"]"!==c);if("Y"===c||"D"===c||"M"===c||"H"===c||"S"===c)i?r++:0!==s&&"\\"===e[s-1]||(i=!0,o=s,r=1);else{if(i=!1," "===c&&a)return!0;0!==r&&(l=e.substr(o,r),o=s,r=0,a=(b.isNullOrUndefined(a)||a)&&t.IsValidDateOrTimeFormatPattern(l))}}return 0!==r&&s===e.length&&(l=e.substr(o,r),a=(b.isNullOrUndefined(a)||a)&&t.IsValidDateOrTimeFormatPattern(l)),a},t.IsValidDateOrTimeFormatPattern=function(t){var e,n,o,r,i,a={Y:4,D:4,M:5,H:2,S:2};if(!t)return!1;for(e={},n=0;n<t.length;n++)e[o=t[n]]?e[o]=e[o]+1:e[o]=1;for(r in e)if(e.hasOwnProperty(r)){if(void 0===(i=a[r]))return!1;if(e[r]>i)return!1}return!0},t.presetColors={},t.defineProperty=O,t.simpleJSONObject=F,t.umb=_,t}(),e.ChartUtility=R,R.InitPresetColors(),k=function(){function t(){}return t.InitGradientStopPresetColor=function(t,e){},t.InitGradientStopTwoColor=function(t,e){},t.InitGradientTwoColorCornerStops=function(t,e){},t.InitGradientTwoColorCenterStops=function(t,e){},t.InitGradientOneColorCornerStops=function(t,e){},t.InitGradientOneColorCenterStops=function(t,e){},t.InitGradientStopOneColor=function(t,e){},t.InitGradientStops=function(t,e,n){},t.GetGradientAngle=function(t,e){var n=0;switch(t){case r.GradientStyle.GradientHorizontal:1===e?n=90:2===e||4===e?n=270:3===e&&(n=90);break;case r.GradientStyle.GradientVertical:1===e||3===e?n=0:2!==e&&4!==e||(n=180);break;case r.GradientStyle.GradientDiagonalUp:1===e||3===e?n=45:2!==e&&4!==e||(n=225);break;case r.GradientStyle.GradientDiagonalDown:1===e||3===e?n=135:2!==e&&4!==e||(n=315);break;case r.GradientStyle.GradientFromCorner:case r.GradientStyle.GradientFromCenter:n=135}return n},t.GetTintAndShadeByDegree=function(t){return 2*(t-.5)},t.ToLum=function(t){return 1e5-p(2e5*(1-t))},t.FromLum=function(t){return 1-(1e5-t)/2e5},t}(),e.ShapeUtility=k,M=function(){function t(){}return t.CalculateValidMinimum=function(t,e,n,o,r,i){return n?t===C.DOUBLE_MAX_VALUE||t<=0?e===C.DOUBLE_MIN_VALUE||e<=0?t=1:e<1?t=e/o:1===e?t=1/o:1<e&&(t=1):e<=t?e===C.DOUBLE_MIN_VALUE||e<=0||(e<1&&r&&!i?t=e/o:1===e&&r&&!i?t=1/o:1<e&&(r||!i)&&(t=1)):r&&(t=1):t===C.DOUBLE_MAX_VALUE?e===C.DOUBLE_MIN_VALUE?t=0:e<0?t=2*e:0===e?t=-1:0<e&&(t=0):e<=t&&(e===C.DOUBLE_MIN_VALUE||(e<0&&r&&!i?e!==t&&(t=2*e):0===e&&r&&!i?t=-1:0<e&&(r||!i)&&(t=0))),t},t.CalculateValidMaximum=function(t,e,n,o){return n?e<=t&&(t<1?e=1:1===t?e=o:1<t&&(e=t*o)):e<=t&&(t<0?e=0:0===t?e=1:0<t&&e!==t&&(e=2*t)),e},t.calcMinMax=function(t,e,n,o){var r,i,a=e-t,s=.05*a,l=o.ChartType;return n?(r=t,i=e,e<1&&(r=i=1)):t>=0?(i=e,B(o)&&(i+=s),6*a>e?r=0:(r=t-a/2,(R.IsScatterChart(l)||R.IsBubbleChart(l))&&(r=t))):e<=0?(r=t,B(o)&&(r-=s),6*a+t>0?i=0:(i=e+a/2,(R.IsScatterChart(l)||R.IsBubbleChart(l))&&(i=e))):(r=t-s,i=e+s),{Min:r,Max:i}},t.CalculateMinimum2=function(t,e,n,o,r){return o?g(r,p(C.log(t,r))):p(t/n)*n},t.Gpa={},t.CalculateMaximum2=function(t,e,n,o,r){return o?g(r,m(C.log(e,r))):m(e/n)*n},t.CalculateMajorUnit=function(t,e,n,o,r,i){var a,s=y(e-t);return r?a=i:(s/(a=g(10,p(C.log(s,10))))<=1.6?a/=5:s/a<=4?a/=2:s/a>8&&(a*=2),n||(a=f(a,o))),a},t.CalculateMinorUnit=function(t,e,n,o){return o?n:n/5},t.GenerateAxisId=function(){for(var t=0;;)if(t=p(9e7*Math.random())+1e7,!this.Gpa[t]){this.Gpa[t]=!0;break}return t},t}(),e.AxisUtility=M,N=function(){function t(){}return Object.defineProperty(t.prototype,"ChartFormat",{get:function(){return b.isNullOrUndefined(this.Kb)&&(this.Kb=this.GetDefaultFormat()),this.Kb},enumerable:!0,configurable:!0}),t.prototype.CreateFormat=function(){return u},t.prototype.GetDefaultFormat=function(){return this.CreateFormat()},t.prototype.GetFormatInternal=function(){return this.Kb},t.prototype.FromShapeProperties=function(t){var e=this;b.isNullOrUndefined(t)?e.ClearFormat():(b.isNullOrUndefined(e.Kb)&&(e.Kb=e.CreateFormat()),e.Kb.FromOOModel(t))},t.prototype.ToShapeProperties=function(){return b.isNullOrUndefined(this.Kb)?u:this.Kb.ToOOModel()},t.prototype.Delete=function(){b.isNullOrUndefined(this.Kb)||(this.Kb.ParentStateful=u)},t.prototype.ClearFormat=function(){var t=this;b.isNullOrUndefined(t.Kb)||(t.Kb.SetParentForChildren(u),t.Kb.ParentStateful=u,t.Kb=u)},t}(),e.ChartElementBase=N,function(t){t[t.BevelNone=0]="BevelNone",t[t.BevelRelaxedInset=1]="BevelRelaxedInset",t[t.BevelCircle=2]="BevelCircle",t[t.BevelSlope=3]="BevelSlope",t[t.BevelCross=4]="BevelCross",t[t.BevelAngle=5]="BevelAngle",t[t.BevelSoftRound=6]="BevelSoftRound",t[t.BevelConvex=7]="BevelConvex",t[t.BevelCoolSlant=8]="BevelCoolSlant",t[t.BevelDivot=9]="BevelDivot",t[t.BevelRiblet=10]="BevelRiblet",t[t.BevelHardEdge=11]="BevelHardEdge",t[t.BevelArtDeco=12]="BevelArtDeco"}(e.BevelType||(e.BevelType={})),function(t){t[t.UnKnown=0]="UnKnown",t[t.Area3DGroup=1]="Area3DGroup",t[t.Bar3DGroup=2]="Bar3DGroup",t[t.Column3DGroup=3]="Column3DGroup",t[t.Line3DGroup=4]="Line3DGroup",t[t.Pie3DGroup=5]="Pie3DGroup",t[t.SurfaceGroup=6]="SurfaceGroup",t[t.AreaGroup=7]="AreaGroup",t[t.BarGroup=8]="BarGroup",t[t.ColumnGroup=9]="ColumnGroup",t[t.DoughnutGroup=10]="DoughnutGroup",t[t.LineGroup=11]="LineGroup",t[t.PieGroup=12]="PieGroup",t[t.RadarGroup=13]="RadarGroup",t[t.XYGroup=14]="XYGroup"}(E=e.ChartGroupType||(e.ChartGroupType={}))},"./dist/plugins/floatingObject/drawing/drawingInterface.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.noStrike=0]="noStrike",t[t.sngStrike=1]="sngStrike",t[t.dblStrike=2]="dblStrike"}(e.ST_TextStrikeType||(e.ST_TextStrikeType={})),function(t){t[t.rnd=0]="rnd",t[t.sq=1]="sq",t[t.flat=2]="flat"}(e.ST_LineCap||(e.ST_LineCap={})),function(t){t[t.email=0]="email",t[t.screen=1]="screen",t[t.print=2]="print",t[t.hqprint=3]="hqprint",t[t.none=4]="none"}(e.ST_BlipCompression||(e.ST_BlipCompression={})),function(t){t[t.shape=0]="shape",t[t.circle=1]="circle",t[t.rect=2]="rect"}(e.ST_PathShadeType||(e.ST_PathShadeType={})),function(t){t[t.legacyMatte=0]="legacyMatte",t[t.legacyPlastic=1]="legacyPlastic",t[t.legacyMetal=2]="legacyMetal",t[t.legacyWireframe=3]="legacyWireframe",t[t.matte=4]="matte",t[t.plastic=5]="plastic",t[t.metal=6]="metal",t[t.warmMatte=7]="warmMatte",t[t.translucentPowder=8]="translucentPowder",t[t.powder=9]="powder",t[t.dkEdge=10]="dkEdge",t[t.softEdge=11]="softEdge",t[t.clear=12]="clear",t[t.flat=13]="flat",t[t.softmetal=14]="softmetal"}(e.ST_PresetMaterialType||(e.ST_PresetMaterialType={})),function(t){t[t.maxMin=0]="maxMin",t[t.minMax=1]="minMax"}(e.ST_Orientation||(e.ST_Orientation={})),function(t){t[t.between=0]="between",t[t.midCat=1]="midCat"}(e.ST_CrossBetween||(e.ST_CrossBetween={})),function(t){t[t.TwoCellAnchor=0]="TwoCellAnchor",t[t.OneCellAnchor=1]="OneCellAnchor",t[t.AbsoluteAnchor=2]="AbsoluteAnchor",t[t.RelSizeAnchor=3]="RelSizeAnchor",t[t.AbsSizeAnchor=4]="AbsSizeAnchor"}(e.AnchorType||(e.AnchorType={})),function(t){t[t.SolidColorFillProperties=0]="SolidColorFillProperties",t[t.PatternFillProperties=1]="PatternFillProperties",t[t.GradientFillProperties=2]="GradientFillProperties",t[t.BlipFillProperties=3]="BlipFillProperties",t[t.GroupFillProperties=4]="GroupFillProperties",t[t.NoFillProperties=5]="NoFillProperties"}(e.ColorFillType||(e.ColorFillType={})),function(t){t[t.CT_StockChart=0]="CT_StockChart",t[t.CT_ScatterChart=1]="CT_ScatterChart",t[t.CT_RadarChart=2]="CT_RadarChart",t[t.CT_BubbleChart=3]="CT_BubbleChart",t[t.CT_AreaChart=4]="CT_AreaChart",t[t.CT_Area3DChart=5]="CT_Area3DChart",t[t.CT_BarChart=6]="CT_BarChart",t[t.CT_Bar3DChart=7]="CT_Bar3DChart",t[t.CT_LineChart=8]="CT_LineChart",t[t.CT_Line3DChart=9]="CT_Line3DChart",t[t.CT_PieChart=10]="CT_PieChart",t[t.CT_Pie3DChart=11]="CT_Pie3DChart",t[t.CT_DoughnutChart=12]="CT_DoughnutChart",t[t.CT_OfPieChart=13]="CT_OfPieChart",t[t.CT_SurfaceChart=14]="CT_SurfaceChart",t[t.CT_Surface3DChart=15]="CT_Surface3DChart",t[t.CT_BoxWhisker=16]="CT_BoxWhisker",t[t.CT_Funnel=17]="CT_Funnel",t[t.CT_ParetoLine=18]="CT_ParetoLine",t[t.CT_RegionMap=19]="CT_RegionMap",t[t.CT_Sunburst=20]="CT_Sunburst",t[t.CT_Treemap=21]="CT_Treemap",t[t.CT_Waterfall=22]="CT_Waterfall",t[t.CT_ClusteredColumn=23]="CT_ClusteredColumn"}(e.CT_ChartType||(e.CT_ChartType={})),function(t){t[t.CT_CatAx=0]="CT_CatAx",t[t.CT_DateAx=1]="CT_DateAx",t[t.CT_SerAx=2]="CT_SerAx",t[t.CT_ValAx=3]="CT_ValAx"}(e.CT_AxisType||(e.CT_AxisType={})),function(t){t[t.CT_HiddenScene3dExtension=0]="CT_HiddenScene3dExtension",t[t.CT_HiddenFillPropertiesExtension=1]="CT_HiddenFillPropertiesExtension",t[t.CT_HiddenLinePropertiesBaseExtension=2]="CT_HiddenLinePropertiesBaseExtension",t[t.CT_HiddenShape3dExtension=3]="CT_HiddenShape3dExtension",t[t.CT_OfficeArtExtension=4]="CT_OfficeArtExtension"}(e.CT_HiddenExtensionType||(e.CT_HiddenExtensionType={})),function(t){t[t.major=0]="major",t[t.minor=1]="minor",t[t.none=2]="none"}(e.ST_FontCollectionIndex||(e.ST_FontCollectionIndex={})),function(t){t[t.aliceBlue=0]="aliceBlue",t[t.antiqueWhite=1]="antiqueWhite",t[t.aqua=2]="aqua",t[t.aquamarine=3]="aquamarine",t[t.azure=4]="azure",t[t.beige=5]="beige",t[t.bisque=6]="bisque",t[t.black=7]="black",t[t.blanchedAlmond=8]="blanchedAlmond",t[t.blue=9]="blue",t[t.blueViolet=10]="blueViolet",t[t.brown=11]="brown",t[t.burlyWood=12]="burlyWood",t[t.cadetBlue=13]="cadetBlue",t[t.chartreuse=14]="chartreuse",t[t.chocolate=15]="chocolate",t[t.coral=16]="coral",t[t.cornflowerBlue=17]="cornflowerBlue",t[t.cornsilk=18]="cornsilk",t[t.crimson=19]="crimson",t[t.cyan=20]="cyan",t[t.darkBlue=21]="darkBlue",t[t.darkCyan=22]="darkCyan",t[t.darkGoldenrod=23]="darkGoldenrod",t[t.darkGray=24]="darkGray",t[t.darkGreen=25]="darkGreen",t[t.darkGrey=26]="darkGrey",t[t.darkKhaki=27]="darkKhaki",t[t.darkMagenta=28]="darkMagenta",t[t.darkOliveGreen=29]="darkOliveGreen",t[t.darkOrange=30]="darkOrange",t[t.darkOrchid=31]="darkOrchid",t[t.darkRed=32]="darkRed",t[t.darkSalmon=33]="darkSalmon",t[t.darkSeaGreen=34]="darkSeaGreen",t[t.darkSlateBlue=35]="darkSlateBlue",t[t.darkSlateGray=36]="darkSlateGray",t[t.darkSlateGrey=37]="darkSlateGrey",t[t.darkTurquoise=38]="darkTurquoise",t[t.darkViolet=39]="darkViolet",t[t.deepPink=40]="deepPink",t[t.deepSkyBlue=41]="deepSkyBlue",t[t.dimGray=42]="dimGray",t[t.dimGrey=43]="dimGrey",t[t.dkBlue=44]="dkBlue",t[t.dkCyan=45]="dkCyan",t[t.dkGoldenrod=46]="dkGoldenrod",t[t.dkGray=47]="dkGray",t[t.dkGreen=48]="dkGreen",t[t.dkGrey=49]="dkGrey",t[t.dkKhaki=50]="dkKhaki",t[t.dkMagenta=51]="dkMagenta",t[t.dkOliveGreen=52]="dkOliveGreen",t[t.dkOrange=53]="dkOrange",t[t.dkOrchid=54]="dkOrchid",t[t.dkRed=55]="dkRed",t[t.dkSalmon=56]="dkSalmon",t[t.dkSeaGreen=57]="dkSeaGreen",t[t.dkSlateBlue=58]="dkSlateBlue",t[t.dkSlateGray=59]="dkSlateGray",t[t.dkSlateGrey=60]="dkSlateGrey",t[t.dkTurquoise=61]="dkTurquoise",t[t.dkViolet=62]="dkViolet",t[t.dodgerBlue=63]="dodgerBlue",t[t.firebrick=64]="firebrick",t[t.floralWhite=65]="floralWhite",t[t.forestGreen=66]="forestGreen",t[t.fuchsia=67]="fuchsia",t[t.gainsboro=68]="gainsboro",t[t.ghostWhite=69]="ghostWhite",t[t.gold=70]="gold",t[t.goldenrod=71]="goldenrod",t[t.gray=72]="gray",t[t.green=73]="green",t[t.greenYellow=74]="greenYellow",t[t.grey=75]="grey",t[t.honeydew=76]="honeydew",t[t.hotPink=77]="hotPink",t[t.indianRed=78]="indianRed",t[t.indigo=79]="indigo",t[t.ivory=80]="ivory",t[t.khaki=81]="khaki",t[t.lavender=82]="lavender",t[t.lavenderBlush=83]="lavenderBlush",t[t.lawnGreen=84]="lawnGreen",t[t.lemonChiffon=85]="lemonChiffon",t[t.lightBlue=86]="lightBlue",t[t.lightCoral=87]="lightCoral",t[t.lightCyan=88]="lightCyan",t[t.lightGoldenrodYellow=89]="lightGoldenrodYellow",t[t.lightGray=90]="lightGray",t[t.lightGreen=91]="lightGreen",t[t.lightGrey=92]="lightGrey",t[t.lightPink=93]="lightPink",t[t.lightSalmon=94]="lightSalmon",t[t.lightSeaGreen=95]="lightSeaGreen",t[t.lightSkyBlue=96]="lightSkyBlue",t[t.lightSlateGray=97]="lightSlateGray",t[t.lightSlateGrey=98]="lightSlateGrey",t[t.lightSteelBlue=99]="lightSteelBlue",t[t.lightYellow=100]="lightYellow",t[t.lime=101]="lime",t[t.limeGreen=102]="limeGreen",t[t.linen=103]="linen",t[t.ltBlue=104]="ltBlue",t[t.ltCoral=105]="ltCoral",t[t.ltCyan=106]="ltCyan",t[t.ltGoldenrodYellow=107]="ltGoldenrodYellow",t[t.ltGray=108]="ltGray",t[t.ltGreen=109]="ltGreen",t[t.ltGrey=110]="ltGrey",t[t.ltPink=111]="ltPink",t[t.ltSalmon=112]="ltSalmon",t[t.ltSeaGreen=113]="ltSeaGreen",t[t.ltSkyBlue=114]="ltSkyBlue",t[t.ltSlateGray=115]="ltSlateGray",t[t.ltSlateGrey=116]="ltSlateGrey",t[t.ltSteelBlue=117]="ltSteelBlue",t[t.ltYellow=118]="ltYellow",t[t.magenta=119]="magenta",t[t.maroon=120]="maroon",t[t.medAquamarine=121]="medAquamarine",t[t.medBlue=122]="medBlue",t[t.mediumAquamarine=123]="mediumAquamarine",t[t.mediumBlue=124]="mediumBlue",t[t.mediumOrchid=125]="mediumOrchid",t[t.mediumPurple=126]="mediumPurple",t[t.mediumSeaGreen=127]="mediumSeaGreen",t[t.mediumSlateBlue=128]="mediumSlateBlue",t[t.mediumSpringGreen=129]="mediumSpringGreen",t[t.mediumTurquoise=130]="mediumTurquoise",t[t.mediumVioletRed=131]="mediumVioletRed",t[t.medOrchid=132]="medOrchid",t[t.medPurple=133]="medPurple",t[t.medSeaGreen=134]="medSeaGreen",t[t.medSlateBlue=135]="medSlateBlue",t[t.medSpringGreen=136]="medSpringGreen",t[t.medTurquoise=137]="medTurquoise",t[t.medVioletRed=138]="medVioletRed",t[t.midnightBlue=139]="midnightBlue",t[t.mintCream=140]="mintCream",t[t.mistyRose=141]="mistyRose",t[t.moccasin=142]="moccasin",t[t.navajoWhite=143]="navajoWhite",t[t.navy=144]="navy",t[t.oldLace=145]="oldLace",t[t.olive=146]="olive",t[t.oliveDrab=147]="oliveDrab",t[t.orange=148]="orange",t[t.orangeRed=149]="orangeRed",t[t.orchid=150]="orchid",t[t.paleGoldenrod=151]="paleGoldenrod",t[t.paleGreen=152]="paleGreen",t[t.paleTurquoise=153]="paleTurquoise",t[t.paleVioletRed=154]="paleVioletRed",t[t.papayaWhip=155]="papayaWhip",t[t.peachPuff=156]="peachPuff",t[t.peru=157]="peru",t[t.pink=158]="pink",t[t.plum=159]="plum",t[t.powderBlue=160]="powderBlue",t[t.purple=161]="purple",t[t.red=162]="red",t[t.rosyBrown=163]="rosyBrown",t[t.royalBlue=164]="royalBlue",t[t.saddleBrown=165]="saddleBrown",t[t.salmon=166]="salmon",t[t.sandyBrown=167]="sandyBrown",t[t.seaGreen=168]="seaGreen",t[t.seaShell=169]="seaShell",t[t.sienna=170]="sienna",t[t.silver=171]="silver",t[t.skyBlue=172]="skyBlue",t[t.slateBlue=173]="slateBlue",t[t.slateGray=174]="slateGray",t[t.slateGrey=175]="slateGrey",t[t.snow=176]="snow",t[t.springGreen=177]="springGreen",t[t.steelBlue=178]="steelBlue",t[t.tan=179]="tan",t[t.teal=180]="teal",t[t.thistle=181]="thistle",t[t.tomato=182]="tomato",t[t.turquoise=183]="turquoise",t[t.violet=184]="violet",t[t.wheat=185]="wheat",t[t.white=186]="white",t[t.whiteSmoke=187]="whiteSmoke",t[t.yellow=188]="yellow",t[t.yellowGreen=189]="yellowGreen"}(e.ST_PresetColorVal||(e.ST_PresetColorVal={})),function(t){t[t.percentStacked=0]="percentStacked",t[t.standard=1]="standard",t[t.stacked=2]="stacked"}(e.ST_Grouping||(e.ST_Grouping={})),function(t){t[t.none=0]="none",t[t.line=1]="line",t[t.lineMarker=2]="lineMarker",t[t.marker=3]="marker",t[t.smooth=4]="smooth",t[t.smoothMarker=5]="smoothMarker"}(e.ST_ScatterStyle||(e.ST_ScatterStyle={})),function(t){t[t.standard=0]="standard",t[t.marker=1]="marker",t[t.filled=2]="filled"}(e.ST_RadarStyle||(e.ST_RadarStyle={})),function(t){t[t.percentStacked=0]="percentStacked",t[t.clustered=1]="clustered",t[t.standard=2]="standard",t[t.stacked=3]="stacked"}(e.ST_BarGrouping||(e.ST_BarGrouping={})),function(t){t[t.bar=0]="bar",t[t.col=1]="col"}(e.ST_BarDir||(e.ST_BarDir={})),function(t){t[t.pie=0]="pie",t[t.bar=1]="bar"}(e.ST_OfPieType||(e.ST_OfPieType={})),function(t){t[t.b=0]="b",t[t.l=1]="l",t[t.r=2]="r",t[t.t=3]="t"}(e.ST_AxPos||(e.ST_AxPos={})),function(t){t[t.OuterShadowEffect=0]="OuterShadowEffect",t[t.InnerShadowEffect=1]="InnerShadowEffect",t[t.PresetShadowEffect=2]="PresetShadowEffect"}(e.ShadowEffectType||(e.ShadowEffectType={})),function(t){t[t.BarSer=0]="BarSer",t[t.AreaSer=1]="AreaSer",t[t.LineSer=2]="LineSer",t[t.PieSer=3]="PieSer",t[t.RadarSer=4]="RadarSer",t[t.ScatterSer=5]="ScatterSer",t[t.BubbleSer=6]="BubbleSer",t[t.SurfaceSer=7]="SurfaceSer",t[t.boxWhisker=16]="boxWhisker",t[t.funnel=17]="funnel",t[t.paretoLine=18]="paretoLine",t[t.regionMap=19]="regionMap",t[t.sunburst=20]="sunburst",t[t.treemap=21]="treemap",t[t.waterfall=22]="waterfall",t[t.clusteredColumn=23]="clusteredColumn"}(e.SeriesType||(e.SeriesType={})),function(t){t[t.InvertSolidFillFmt=0]="InvertSolidFillFmt",t[t.SeriesDataLabelsRange=1]="SeriesDataLabelsRange",t[t.ChartDispNaAsBlank=2]="ChartDispNaAsBlank"}(e.ExtDataType||(e.ExtDataType={})),function(t){t[t.RegularTextRun=0]="RegularTextRun",t[t.TextLineBreak=1]="TextLineBreak",t[t.TextField=2]="TextField"}(e.TextParagraphElementType||(e.TextParagraphElementType={})),function(t){t[t.None=0]="None",t[t.Font=1]="Font",t[t.Fill=2]="Fill",t[t.Border=4]="Border",t[t.Alignment=8]="Alignment",t[t.Protection=16]="Protection",t[t.FormatCode=32]="FormatCode",t[t.All=63]="All"}(e.StyleDataFlag||(e.StyleDataFlag={})),function(t){t[t.None=-4142]="None",t[t.LT1=0]="LT1",t[t.DK1=1]="DK1",t[t.LT2=2]="LT2",t[t.DK2=3]="DK2",t[t.Accent1=4]="Accent1",t[t.Accent2=5]="Accent2",t[t.Accent3=6]="Accent3",t[t.Accent4=7]="Accent4",t[t.Accent5=8]="Accent5",t[t.Accent6=9]="Accent6",t[t.Hlink=10]="Hlink",t[t.FolHlink=11]="FolHlink"}(e.ColorSchemeIndex||(e.ColorSchemeIndex={})),function(t){t[t.None=0]="None",t[t.Major=1]="Major",t[t.Minor=2]="Minor"}(e.ThemeFont||(e.ThemeFont={})),function(t){t[t.Empty=0]="Empty",t[t.Row=1]="Row",t[t.Column=2]="Column",t[t.RowIsRelative=4]="RowIsRelative",t[t.ColumnIsRelative=8]="ColumnIsRelative",t[t.LastRowIsRelative=16]="LastRowIsRelative",t[t.LastColumnIsRelative=32]="LastColumnIsRelative",t[t.Range=64]="Range",t[t.Error=128]="Error"}(e.ReferenceKind||(e.ReferenceKind={})),function(t){t[t.Shape=0]="Shape",t[t.Chart=1]="Chart",t[t.Picture=2]="Picture",t[t.Connector=3]="Connector",t[t.GroupShape=4]="GroupShape"}(e.DrawingType||(e.DrawingType={})),function(t){t[t.TextureTopLeft=0]="TextureTopLeft",t[t.TextureTop=1]="TextureTop",t[t.TextureTopRight=2]="TextureTopRight",t[t.TextureLeft=3]="TextureLeft",t[t.TextureCenter=4]="TextureCenter",t[t.TextureRight=5]="TextureRight",t[t.TextureBottomLeft=6]="TextureBottomLeft",t[t.TextureBottom=7]="TextureBottom",t[t.TextureBottomRight=8]="TextureBottomRight"}(e.TextureAlignment||(e.TextureAlignment={})),function(t){t[t.TextureTypeNone=0]="TextureTypeNone",t[t.TexturePreset=1]="TexturePreset",t[t.TextureUserDefined=2]="TextureUserDefined"}(e.TextureType||(e.TextureType={})),function(t){t[t.Solid=0]="Solid",t[t.Patterned=1]="Patterned",t[t.Gradient=2]="Gradient",t[t.Textured=3]="Textured",t[t.Background=4]="Background",t[t.Picture=5]="Picture",t[t.Group=6]="Group"}(e.FillType||(e.FillType={})),function(t){t[t.GradientEarlySunset=0]="GradientEarlySunset",t[t.GradientLateSunset=1]="GradientLateSunset",t[t.GradientNightfall=2]="GradientNightfall",t[t.GradientDaybreak=3]="GradientDaybreak",t[t.GradientHorizon=4]="GradientHorizon",t[t.GradientDesert=5]="GradientDesert",t[t.GradientOcean=6]="GradientOcean",t[t.GradientCalmWater=7]="GradientCalmWater",t[t.GradientFire=8]="GradientFire",t[t.GradientFog=9]="GradientFog",t[t.GradientMoss=10]="GradientMoss",t[t.GradientPeacock=11]="GradientPeacock",t[t.GradientWheat=12]="GradientWheat",t[t.GradientParchment=13]="GradientParchment",t[t.GradientMahogany=14]="GradientMahogany",t[t.GradientRainbow=15]="GradientRainbow",t[t.GradientRainbowII=16]="GradientRainbowII",t[t.GradientGold=17]="GradientGold",t[t.GradientGoldII=18]="GradientGoldII",t[t.GradientBrass=19]="GradientBrass",t[t.GradientChrome=20]="GradientChrome",t[t.GradientChromeII=21]="GradientChromeII",t[t.GradientSilver=22]="GradientSilver",t[t.GradientSapphire=23]="GradientSapphire"}(e.PresetGradientType||(e.PresetGradientType={})),function(t){t[t.TexturePapyrus=0]="TexturePapyrus",t[t.TextureCanvas=1]="TextureCanvas",t[t.TextureDenim=2]="TextureDenim",t[t.TextureWovenMat=3]="TextureWovenMat",t[t.TextureWaterDroplets=4]="TextureWaterDroplets",t[t.TexturePaperBag=5]="TexturePaperBag",t[t.TextureFishFossil=6]="TextureFishFossil",t[t.TextureSand=7]="TextureSand",t[t.TextureGreenMarble=8]="TextureGreenMarble",t[t.TextureWhiteMarble=9]="TextureWhiteMarble",t[t.TextureBrownMarble=10]="TextureBrownMarble",t[t.TextureGranite=11]="TextureGranite",t[t.TextureNewsprint=12]="TextureNewsprint",t[t.TextureRecycledPaper=13]="TextureRecycledPaper",t[t.TextureParchment=14]="TextureParchment",t[t.TextureStationery=15]="TextureStationery",t[t.TextureBlueTissuePaper=16]="TextureBlueTissuePaper",t[t.TexturePinkTissuePaper=17]="TexturePinkTissuePaper",t[t.TexturePurpleMesh=18]="TexturePurpleMesh",t[t.TextureBouquet=19]="TextureBouquet",t[t.TextureCork=20]="TextureCork",t[t.TextureWalnut=21]="TextureWalnut",t[t.TextureOak=22]="TextureOak",t[t.TextureMediumWood=23]="TextureMediumWood"}(e.PresetTexture||(e.PresetTexture={})),function(t){t[t.GradientColorNone=0]="GradientColorNone",t[t.GradientOneColor=1]="GradientOneColor",t[t.GradientTwoColors=2]="GradientTwoColors",t[t.GradientPresetColors=3]="GradientPresetColors",t[t.GradientMultiColor=4]="GradientMultiColor"}(e.GradientColorType||(e.GradientColorType={})),function(t){t[t.none=0]="none",t[t.dottedPercent5=1]="dottedPercent5",t[t.dottedPercent10=2]="dottedPercent10",t[t.dottedPercent20=3]="dottedPercent20",t[t.dottedPercent25=4]="dottedPercent25",t[t.dottedPercent30=5]="dottedPercent30",t[t.dottedPercent40=6]="dottedPercent40",t[t.dottedPercent50=7]="dottedPercent50",t[t.dottedPercent60=8]="dottedPercent60",t[t.dottedPercent70=9]="dottedPercent70",t[t.dottedPercent75=10]="dottedPercent75",t[t.dottedPercent80=11]="dottedPercent80",t[t.dottedPercent90=12]="dottedPercent90",t[t.darkHorizontal=13]="darkHorizontal",t[t.darkVertical=14]="darkVertical",t[t.darkDownwardDiagonal=15]="darkDownwardDiagonal",t[t.darkUpwardDiagonal=16]="darkUpwardDiagonal",t[t.smallCheckerBoard=17]="smallCheckerBoard",t[t.trellis=18]="trellis",t[t.lightHorizontal=19]="lightHorizontal",t[t.lightVertical=20]="lightVertical",t[t.lightDownwardDiagonal=21]="lightDownwardDiagonal",t[t.lightUpwardDiagonal=22]="lightUpwardDiagonal",t[t.smallGrid=23]="smallGrid",t[t.dottedDiamond=24]="dottedDiamond",t[t.wideDownwardDiagonal=25]="wideDownwardDiagonal",t[t.wideUpwardDiagonal=26]="wideUpwardDiagonal",t[t.dashedUpwardDiagonal=27]="dashedUpwardDiagonal",t[t.dashedDownwardDiagonal=28]="dashedDownwardDiagonal",t[t.narrowVertical=29]="narrowVertical",t[t.narrowHorizontal=30]="narrowHorizontal",t[t.dashedVertical=31]="dashedVertical",t[t.dashedHorizontal=32]="dashedHorizontal",t[t.largeConfetti=33]="largeConfetti",t[t.largeGrid=34]="largeGrid",t[t.horizontalBrick=35]="horizontalBrick",t[t.largeCheckerBoard=36]="largeCheckerBoard",t[t.smallConfetti=37]="smallConfetti",t[t.zigZag=38]="zigZag",t[t.solidDiamond=39]="solidDiamond",t[t.diagonalBrick=40]="diagonalBrick",t[t.outlinedDiamond=41]="outlinedDiamond",t[t.plaid=42]="plaid",t[t.sphere=43]="sphere",t[t.weave=44]="weave",t[t.dottedGrid=45]="dottedGrid",t[t.divot=46]="divot",t[t.shingle=47]="shingle",t[t.wave=48]="wave"}(e.PatternType||(e.PatternType={})),function(t){t[t.GradientHorizontal=0]="GradientHorizontal",t[t.GradientVertical=1]="GradientVertical",t[t.GradientDiagonalUp=2]="GradientDiagonalUp",t[t.GradientDiagonalDown=3]="GradientDiagonalDown",t[t.GradientFromCorner=4]="GradientFromCorner",t[t.GradientFromTitle=5]="GradientFromTitle",t[t.GradientFromCenter=6]="GradientFromCenter"}(e.GradientStyle||(e.GradientStyle={})),function(t){t[t.short=0]="short",t[t.medium=1]="medium",t[t.long=2]="long"}(e.ArrowheadLength||(e.ArrowheadLength={})),function(t){t[t.none=0]="none",t[t.triangle=1]="triangle",t[t.stealth=2]="stealth",t[t.diamond=3]="diamond",t[t.oval=4]="oval",t[t.open=5]="open"}(e.ArrowheadStyle||(e.ArrowheadStyle={})),function(t){t[t.narrow=0]="narrow",t[t.medium=1]="medium",t[t.wide=2]="wide"}(e.ArrowheadWidth||(e.ArrowheadWidth={})),function(t){t[t.solid=0]="solid",t[t.squareDot=1]="squareDot",t[t.dash=2]="dash",t[t.longDash=3]="longDash",t[t.dashDot=4]="dashDot",t[t.longDashDot=5]="longDashDot",t[t.longDashDotDot=6]="longDashDotDot",t[t.sysDash=7]="sysDash",t[t.sysDot=8]="sysDot",t[t.sysDashDot=9]="sysDashDot",t[t.dashDotDot=10]="dashDotDot",t[t.roundDot=11]="roundDot"}(e.LineDashStyle||(e.LineDashStyle={})),function(t){t[t.flat=2]="flat",t[t.square=1]="square",t[t.round=0]="round"}(e.LineCapStyle||(e.LineCapStyle={})),function(t){t[t.round=0]="round",t[t.miter=1]="miter",t[t.bevel=2]="bevel"}(e.LineJoinStyle||(e.LineJoinStyle={})),function(t){t[t.LineSingle=0]="LineSingle",t[t.LineThinThin=1]="LineThinThin",t[t.LineThinThick=2]="LineThinThick",t[t.LineThickThin=3]="LineThickThin",t[t.LineThickBetweenThin=4]="LineThickBetweenThin"}(e.LineStyle||(e.LineStyle={})),function(t){t[t.PictureAutomatic=0]="PictureAutomatic",t[t.PictureGrayscale=1]="PictureGrayscale",t[t.PictureBlackAndWhite=2]="PictureBlackAndWhite",t[t.PictureWatermark=3]="PictureWatermark"}(e.PictureColorType||(e.PictureColorType={})),function(t){t[t.Shadow1=0]="Shadow1",t[t.Shadow2=1]="Shadow2",t[t.Shadow3=2]="Shadow3",t[t.Shadow4=3]="Shadow4",t[t.Shadow5=4]="Shadow5",t[t.Shadow6=5]="Shadow6",t[t.Shadow7=6]="Shadow7",t[t.Shadow8=7]="Shadow8",t[t.Shadow9=8]="Shadow9",t[t.Shadow10=9]="Shadow10",t[t.Shadow11=10]="Shadow11",t[t.Shadow12=11]="Shadow12",t[t.Shadow13=12]="Shadow13",t[t.Shadow14=13]="Shadow14",t[t.Shadow15=14]="Shadow15",t[t.Shadow16=15]="Shadow16",t[t.Shadow17=16]="Shadow17",t[t.Shadow18=17]="Shadow18",t[t.Shadow19=18]="Shadow19",t[t.Shadow20=19]="Shadow20",t[t.Shadow21=20]="Shadow21",t[t.Shadow22=21]="Shadow22",t[t.Shadow23=22]="Shadow23",t[t.Shadow24=23]="Shadow24",t[t.Shadow25=24]="Shadow25",t[t.Shadow26=25]="Shadow26",t[t.Shadow27=26]="Shadow27",t[t.Shadow28=27]="Shadow28",t[t.Shadow29=28]="Shadow29",t[t.Shadow30=29]="Shadow30",t[t.Shadow31=30]="Shadow31",t[t.Shadow32=31]="Shadow32",t[t.Shadow33=32]="Shadow33",t[t.Shadow34=33]="Shadow34",t[t.Shadow35=34]="Shadow35",t[t.Shadow36=35]="Shadow36",t[t.Shadow37=36]="Shadow37",t[t.Shadow38=37]="Shadow38",t[t.Shadow39=38]="Shadow39",t[t.Shadow40=39]="Shadow40",t[t.Shadow41=40]="Shadow41",t[t.Shadow42=41]="Shadow42",t[t.Shadow43=42]="Shadow43"}(e.ShadowType||(e.ShadowType={})),function(t){t[t.ShadowStyleInnerShadow=0]="ShadowStyleInnerShadow",t[t.ShadowStyleOuterShadow=1]="ShadowStyleOuterShadow"}(e.ShadowStyle||(e.ShadowStyle={})),function(t){t[t.SoftEdgeTypeNone=0]="SoftEdgeTypeNone",t[t.SoftEdgeType1=1]="SoftEdgeType1",t[t.SoftEdgeType2=2]="SoftEdgeType2",t[t.SoftEdgeType3=3]="SoftEdgeType3",t[t.SoftEdgeType4=4]="SoftEdgeType4",t[t.SoftEdgeType5=5]="SoftEdgeType5",t[t.SoftEdgeType6=6]="SoftEdgeType6"}(e.SoftEdgeType||(e.SoftEdgeType={})),function(t){t[t.CameraLegacyObliqueTopLeft=0]="CameraLegacyObliqueTopLeft",t[t.CameraLegacyObliqueTop=1]="CameraLegacyObliqueTop",t[t.CameraLegacyObliqueTopRight=2]="CameraLegacyObliqueTopRight",t[t.CameraLegacyObliqueLeft=3]="CameraLegacyObliqueLeft",t[t.CameraLegacyObliqueFront=4]="CameraLegacyObliqueFront",t[t.CameraLegacyObliqueRight=5]="CameraLegacyObliqueRight",t[t.CameraLegacyObliqueBottomLeft=6]="CameraLegacyObliqueBottomLeft",t[t.CameraLegacyObliqueBottom=7]="CameraLegacyObliqueBottom",t[t.CameraLegacyObliqueBottomRight=8]="CameraLegacyObliqueBottomRight",t[t.CameraLegacyPerspectiveTopLeft=9]="CameraLegacyPerspectiveTopLeft",t[t.CameraLegacyPerspectiveTop=10]="CameraLegacyPerspectiveTop",t[t.CameraLegacyPerspectiveTopRight=11]="CameraLegacyPerspectiveTopRight",t[t.CameraLegacyPerspectiveLeft=12]="CameraLegacyPerspectiveLeft",t[t.CameraLegacyPerspectiveFront=13]="CameraLegacyPerspectiveFront",t[t.CameraLegacyPerspectiveRight=14]="CameraLegacyPerspectiveRight",t[t.CameraLegacyPerspectiveBottomLeft=15]="CameraLegacyPerspectiveBottomLeft",t[t.CameraLegacyPerspectiveBottom=16]="CameraLegacyPerspectiveBottom",t[t.CameraLegacyPerspectiveBottomRight=17]="CameraLegacyPerspectiveBottomRight",t[t.CameraOrthographicFront=18]="CameraOrthographicFront",t[t.CameraIsometricTopUp=19]="CameraIsometricTopUp",t[t.CameraIsometricTopDown=20]="CameraIsometricTopDown",t[t.CameraIsometricBottomUp=21]="CameraIsometricBottomUp",t[t.CameraIsometricBottomDown=22]="CameraIsometricBottomDown",t[t.CameraIsometricLeftUp=23]="CameraIsometricLeftUp",t[t.CameraIsometricLeftDown=24]="CameraIsometricLeftDown",t[t.CameraIsometricRightUp=25]="CameraIsometricRightUp",t[t.CameraIsometricRightDown=26]="CameraIsometricRightDown",t[t.CameraIsometricOffAxis1Left=27]="CameraIsometricOffAxis1Left",t[t.CameraIsometricOffAxis1Right=28]="CameraIsometricOffAxis1Right",t[t.CameraIsometricOffAxis1Top=29]="CameraIsometricOffAxis1Top",t[t.CameraIsometricOffAxis2Left=30]="CameraIsometricOffAxis2Left",t[t.CameraIsometricOffAxis2Right=31]="CameraIsometricOffAxis2Right",t[t.CameraIsometricOffAxis2Top=32]="CameraIsometricOffAxis2Top",t[t.CameraIsometricOffAxis3Left=33]="CameraIsometricOffAxis3Left",t[t.CameraIsometricOffAxis3Right=34]="CameraIsometricOffAxis3Right",t[t.CameraIsometricOffAxis3Bottom=35]="CameraIsometricOffAxis3Bottom",t[t.CameraIsometricOffAxis4Left=36]="CameraIsometricOffAxis4Left",t[t.CameraIsometricOffAxis4Right=37]="CameraIsometricOffAxis4Right",t[t.CameraIsometricOffAxis4Bottom=38]="CameraIsometricOffAxis4Bottom",t[t.CameraObliqueTopLeft=39]="CameraObliqueTopLeft",t[t.CameraObliqueTop=40]="CameraObliqueTop",t[t.CameraObliqueTopRight=41]="CameraObliqueTopRight",t[t.CameraObliqueLeft=42]="CameraObliqueLeft",t[t.CameraObliqueRight=43]="CameraObliqueRight",t[t.CameraObliqueBottomLeft=44]="CameraObliqueBottomLeft",t[t.CameraObliqueBottom=45]="CameraObliqueBottom",t[t.CameraObliqueBottomRight=46]="CameraObliqueBottomRight",t[t.CameraPerspectiveFront=47]="CameraPerspectiveFront",t[t.CameraPerspectiveLeft=48]="CameraPerspectiveLeft",t[t.CameraPerspectiveRight=49]="CameraPerspectiveRight",t[t.CameraPerspectiveAbove=50]="CameraPerspectiveAbove",t[t.CameraPerspectiveBelow=51]="CameraPerspectiveBelow",t[t.CameraPerspectiveAboveLeftFacing=52]="CameraPerspectiveAboveLeftFacing",t[t.CameraPerspectiveAboveRightFacing=53]="CameraPerspectiveAboveRightFacing",t[t.CameraPerspectiveContrastingLeftFacing=54]="CameraPerspectiveContrastingLeftFacing",t[t.CameraPerspectiveContrastingRightFacing=55]="CameraPerspectiveContrastingRightFacing",t[t.CameraPerspectiveHeroicLeftFacing=56]="CameraPerspectiveHeroicLeftFacing",t[t.CameraPerspectiveHeroicRightFacing=57]="CameraPerspectiveHeroicRightFacing",t[t.CameraPerspectiveHeroicExtremeLeftFacing=58]="CameraPerspectiveHeroicExtremeLeftFacing",t[t.CameraPerspectiveHeroicExtremeRightFacing=59]="CameraPerspectiveHeroicExtremeRightFacing",t[t.CameraPerspectiveRelaxed=60]="CameraPerspectiveRelaxed",t[t.CameraPerspectiveRelaxedModerately=61]="CameraPerspectiveRelaxedModerately",t[t.PresetCameraNone=62]="PresetCameraNone"}(e.PresetCamera||(e.PresetCamera={})),function(t){t[t.LightingTopLeft=0]="LightingTopLeft",t[t.LightingTop=1]="LightingTop",t[t.LightingTopRight=2]="LightingTopRight",t[t.LightingLeft=3]="LightingLeft",t[t.LightingNone=4]="LightingNone",t[t.LightingRight=5]="LightingRight",t[t.LightingBottomLeft=6]="LightingBottomLeft",t[t.LightingBottom=7]="LightingBottom",t[t.LightingBottomRight=8]="LightingBottomRight"}(e.PresetLightingDirection||(e.PresetLightingDirection={})),function(t){t[t.LightRigLegacyFlat1=0]="LightRigLegacyFlat1",t[t.LightRigLegacyFlat2=1]="LightRigLegacyFlat2",t[t.LightRigLegacyFlat3=2]="LightRigLegacyFlat3",t[t.LightRigLegacyFlat4=3]="LightRigLegacyFlat4",t[t.LightRigLegacyNormal1=4]="LightRigLegacyNormal1",t[t.LightRigLegacyNormal2=5]="LightRigLegacyNormal2",t[t.LightRigLegacyNormal3=6]="LightRigLegacyNormal3",t[t.LightRigLegacyNormal4=7]="LightRigLegacyNormal4",t[t.LightRigLegacyHarsh1=8]="LightRigLegacyHarsh1",t[t.LightRigLegacyHarsh2=9]="LightRigLegacyHarsh2",t[t.LightRigLegacyHarsh3=10]="LightRigLegacyHarsh3",t[t.LightRigLegacyHarsh4=11]="LightRigLegacyHarsh4",t[t.LightRigThreePoint=12]="LightRigThreePoint",t[t.LightRigBalanced=13]="LightRigBalanced",t[t.LightRigSoft=14]="LightRigSoft",t[t.LightRigHarsh=15]="LightRigHarsh",t[t.LightRigFlood=16]="LightRigFlood",t[t.LightRigContrasting=17]="LightRigContrasting",t[t.LightRigMorning=18]="LightRigMorning",t[t.LightRigSunrise=19]="LightRigSunrise",t[t.LightRigSunset=20]="LightRigSunset",t[t.LightRigChilly=21]="LightRigChilly",t[t.LightRigFreezing=22]="LightRigFreezing",t[t.LightRigFlat=23]="LightRigFlat",t[t.LightRigTwoPoint=24]="LightRigTwoPoint",t[t.LightRigGlow=25]="LightRigGlow",t[t.LightRigBrightRoom=26]="LightRigBrightRoom"}(e.LightRigType||(e.LightRigType={})),function(t){t[t.Category=0]="Category",t[t.Value=1]="Value",t[t.SeriesAxis=2]="SeriesAxis"}(e.AxisType||(e.AxisType={})),function(t){t[t.high=0]="high",t[t.low=1]="low",t[t.nextToAxis=2]="nextToAxis",t[t.none=3]="none"}(e.TickLabelPosition||(e.TickLabelPosition={})),function(t){t[t.ScaleLogarithmic=0]="ScaleLogarithmic",t[t.ScaleLinear=1]="ScaleLinear"}(e.ScaleType||(e.ScaleType={})),function(t){t[t.days=0]="days",t[t.months=1]="months",t[t.years=2]="years"}(e.TimeUnit||(e.TimeUnit={})),function(t){t[t.cross=0]="cross",t[t.inside=1]="inside",t[t.none=2]="none",t[t.outside=3]="outside"}(e.TickMark||(e.TickMark={})),function(t){t.hundreds="hundreds",t.thousands="thousands",t.tenThousands="tenThousands",t.hundredThousands="hundredThousands",t.millions="millions",t.tenMillions="tenMillions",t.hundredMillions="hundredMillions",t.billions="billions",t.trillions="trillions"}(e.DisplayUnit||(e.DisplayUnit={})),function(t){t.automatic="auto",t.maximum="max",t.minimum="min"}(e.AxisCrossPoint||(e.AxisCrossPoint={})),function(t){t[t.AutomaticScale=0]="AutomaticScale",t[t.CategoryScale=1]="CategoryScale",t[t.TimeScale=2]="TimeScale",t[t.ValueScale=3]="ValueScale"}(e.CategoryType||(e.CategoryType={})),function(t){t[t.primary=0]="primary",t[t.secondary=1]="secondary"}(e.AxisGroup||(e.AxisGroup={})),function(t){t[t.ConeToPoint=0]="ConeToPoint",t[t.ConeToMax=1]="ConeToMax",t[t.Box=2]="Box",t[t.Cylinder=3]="Cylinder",t[t.PyramidToPoint=4]="PyramidToPoint",t[t.PyramidToMax=5]="PyramidToMax"}(e.BarShape||(e.BarShape={})),function(t){t[t.combo=0]="combo",t[t.xyScatter=1]="xyScatter",t[t.radar=2]="radar",t[t.doughnut=3]="doughnut",t[t.pie3D=4]="pie3D",t[t.line3D=5]="line3D",t[t.column3D=6]="column3D",t[t.area3D=7]="area3D",t[t.area=8]="area",t[t.line=9]="line",t[t.pie=10]="pie",t[t.bubble=11]="bubble",t[t.columnClustered=12]="columnClustered",t[t.columnStacked=13]="columnStacked",t[t.columnStacked100=14]="columnStacked100",t[t.columnClustered3D=15]="columnClustered3D",t[t.columnStacked3D=16]="columnStacked3D",t[t.columnStacked1003D=17]="columnStacked1003D",t[t.barClustered=18]="barClustered",t[t.barStacked=19]="barStacked",t[t.barStacked100=20]="barStacked100",t[t.barClustered3D=21]="barClustered3D",t[t.barStacked3D=22]="barStacked3D",t[t.barStacked1003D=23]="barStacked1003D",t[t.lineStacked=24]="lineStacked",t[t.lineStacked100=25]="lineStacked100",t[t.lineMarkers=26]="lineMarkers",t[t.lineMarkersStacked=27]="lineMarkersStacked",t[t.lineMarkersStacked100=28]="lineMarkersStacked100",t[t.pieOfPie=29]="pieOfPie",t[t.pieExploded=30]="pieExploded",t[t.pieExploded3D=31]="pieExploded3D",t[t.barOfPie=32]="barOfPie",t[t.xyScatterSmooth=33]="xyScatterSmooth",t[t.xyScatterSmoothNoMarkers=34]="xyScatterSmoothNoMarkers",t[t.xyScatterLines=35]="xyScatterLines",t[t.xyScatterLinesNoMarkers=36]="xyScatterLinesNoMarkers",t[t.areaStacked=37]="areaStacked",t[t.areaStacked100=38]="areaStacked100",t[t.areaStacked3D=39]="areaStacked3D",t[t.areaStacked1003D=40]="areaStacked1003D",t[t.doughnutExploded=41]="doughnutExploded",t[t.radarMarkers=42]="radarMarkers",t[t.radarFilled=43]="radarFilled",t[t.surface=44]="surface",t[t.surfaceWireframe=45]="surfaceWireframe",t[t.surfaceTopView=46]="surfaceTopView",t[t.surfaceTopViewWireframe=47]="surfaceTopViewWireframe",t[t.bubble3DEffect=48]="bubble3DEffect",t[t.stockHLC=49]="stockHLC",t[t.stockOHLC=50]="stockOHLC",t[t.stockVHLC=51]="stockVHLC",t[t.stockVOHLC=52]="stockVOHLC",t[t.boxWhisker=53]="boxWhisker",t[t.funnel=54]="funnel",t[t.paretoLine=55]="paretoLine",t[t.regionMap=56]="regionMap",t[t.sunburst=57]="sunburst",t[t.treemap=58]="treemap",t[t.waterfall=59]="waterfall",t[t.clusteredColumn=60]="clusteredColumn"}(e.ChartType||(e.ChartType={})),function(t){t[t.exponential=0]="exponential",t[t.linear=1]="linear",t[t.logarithmic=2]="logarithmic",t[t.movingAverage=3]="movingAverage",t[t.polynomial=4]="polynomial",t[t.power=5]="power"}(e.TrendlineType||(e.TrendlineType={})),function(t){t[t.bestFit=0]="bestFit",t[t.below=1]="below",t[t.center=2]="center",t[t.insideBase=3]="insideBase",t[t.insideEnd=4]="insideEnd",t[t.left=5]="left",t[t.outsideEnd=6]="outsideEnd",t[t.right=7]="right",t[t.above=8]="above"}(e.DataLabelPosition||(e.DataLabelPosition={})),function(t){t[t.MarkerStyleCircle=0]="MarkerStyleCircle",t[t.MarkerStyleDash=1]="MarkerStyleDash",t[t.MarkerStyleDiamond=2]="MarkerStyleDiamond",t[t.MarkerStyleDot=3]="MarkerStyleDot",t[t.MarkerStyleNone=4]="MarkerStyleNone",t[t.MarkerStylePicture=5]="MarkerStylePicture",t[t.MarkerStylePlus=6]="MarkerStylePlus",t[t.MarkerStyleSquare=7]="MarkerStyleSquare",t[t.MarkerStyleStar=8]="MarkerStyleStar",t[t.MarkerStyleTriangle=9]="MarkerStyleTriangle",t[t.MarkerStyleX=10]="MarkerStyleX",t[t.MarkerStyleAutomatic=11]="MarkerStyleAutomatic"}(e.MarkerStyle||(e.MarkerStyle={})),function(t){t[t.both=0]="both",t[t.minus=1]="minus",t[t.plus=2]="plus"}(e.ErrorBarType||(e.ErrorBarType={})),function(t){t[t.custom=0]="custom",t[t.fixedValue=1]="fixedValue",t[t.percentage=2]="percentage",t[t.standardDeviation=3]="standardDeviation",t[t.standardError=4]="standardError"}(e.ErrorBarValueType||(e.ErrorBarValueType={})),function(t){t[t.Stretch=0]="Stretch",t[t.Stack=1]="Stack",t[t.StackScale=2]="StackScale"}(e.DrawingPictureType||(e.DrawingPictureType={})),function(t){t[t.SizeIsArea=0]="SizeIsArea",t[t.SizeIsWidth=1]="SizeIsWidth"}(e.SizeRepresents||(e.SizeRepresents={})),function(t){t[t.SplitByPosition=0]="SplitByPosition",t[t.SplitByValue=1]="SplitByValue",t[t.SplitByPercentValue=2]="SplitByPercentValue",t[t.SplitByCustomSplit=3]="SplitByCustomSplit"}(e.ChartSplitType||(e.ChartSplitType={})),function(t){t[t.custom=0]="custom",t[t.top=1]="top",t[t.right=2]="right",t[t.left=3]="left",t[t.bottom=4]="bottom",t[t.topRight=5]="topRight"}(e.LegendPosition||(e.LegendPosition={})),function(t){t[t.rows=0]="rows",t[t.columns=1]="columns"}(e.RowCol||(e.RowCol={})),function(t){t[t.circle=0]="circle",t[t.dash=1]="dash",t[t.diamond=2]="diamond",t[t.dot=3]="dot",t[t.none=4]="none",t[t.picture=5]="picture",t[t.plus=6]="plus",t[t.square=7]="square",t[t.star=8]="star",t[t.triangle=9]="triangle",t[t.x=10]="x"}(e.SymbolShape||(e.SymbolShape={})),function(t){t[t.solid=0]="solid",t[t.dot=1]="dot",t[t.dash=2]="dash",t[t.lgDash=3]="lgDash",t[t.dashDot=4]="dashDot",t[t.lgDashDot=5]="lgDashDot",t[t.lgDashDotDot=6]="lgDashDotDot",t[t.sysDash=7]="sysDash",t[t.sysDot=8]="sysDot",t[t.sysDashDot=9]="sysDashDot",t[t.sysDashDotDot=10]="sysDashDotDot"}(e.LineType||(e.LineType={})),function(t){t[t.Baseline=0]="Baseline",t[t.Superscript=1]="Superscript",t[t.Subscript=2]="Subscript"}(e.VertAlignType||(e.VertAlignType={})),function(t){t[t.MoveAndSize=0]="MoveAndSize",t[t.Move=1]="Move",t[t.FreeFloating=2]="FreeFloating"}(e.Placement||(e.Placement={})),function(t){t[t.All=0]="All",t[t.Chart=1]="Chart",t[t.PlotArea=2]="PlotArea",t[t.Series=3]="Series",t[t.SeriesCollection=4]="SeriesCollection",t[t.Point=5]="Point",t[t.DataLabel=6]="DataLabel",t[t.DataMarker=7]="DataMarker",t[t.CategoryAxis=8]="CategoryAxis",t[t.ValueAxis=9]="ValueAxis",t[t.SeriesAxis=10]="SeriesAxis",t[t.Lengend=11]="Lengend",t[t.FloorWall=12]="FloorWall",t[t.SideWall=13]="SideWall",t[t.BackWall=14]="BackWall",t[t.ChartTitle=15]="ChartTitle",t[t.AxisTitle=16]="AxisTitle",t[t.ChartGroup=17]="ChartGroup"}(e.ChartElements||(e.ChartElements={})),function(t){t[t.PNG=0]="PNG",t[t.JPG=1]="JPG",t[t.JPEG=2]="JPEG",t[t.EMF=3]="EMF"}(e.ImageType||(e.ImageType={})),function(t){t[t.None=0]="None",t[t.Automatic=1]="Automatic",t[t.RGB=2]="RGB",t[t.Theme=3]="Theme"}(e.SolidColorType||(e.SolidColorType={})),function(t){t[t.None=0]="None",t[t.Words=1]="Words",t[t.Single=2]="Single",t[t.Double=3]="Double",t[t.Heavy=4]="Heavy",t[t.Dotted=5]="Dotted",t[t.DottedHeavy=6]="DottedHeavy",t[t.Dash=7]="Dash",t[t.DashHeavy=8]="DashHeavy",t[t.DashLong=9]="DashLong",t[t.DashLongHeavy=10]="DashLongHeavy",t[t.DotDash=11]="DotDash",t[t.DotDashHeavy=12]="DotDashHeavy",t[t.DotDotDash=13]="DotDotDash",t[t.DotDotDashHeavy=14]="DotDotDashHeavy",t[t.Wavy=15]="Wavy",t[t.WavyHeavy=16]="WavyHeavy",t[t.WavyDouble=17]="WavyDouble"}(e.TextUnderlineType||(e.TextUnderlineType={})),function(t){t[t.ReflectionTypeNone=0]="ReflectionTypeNone",t[t.ReflectionType1=1]="ReflectionType1",t[t.ReflectionType2=2]="ReflectionType2",t[t.ReflectionType3=3]="ReflectionType3",t[t.ReflectionType4=4]="ReflectionType4",t[t.ReflectionType5=5]="ReflectionType5",t[t.ReflectionType6=6]="ReflectionType6",t[t.ReflectionType7=7]="ReflectionType7",t[t.ReflectionType8=8]="ReflectionType8",t[t.ReflectionType9=9]="ReflectionType9"}(e.ReflectionType||(e.ReflectionType={})),function(t){t[t.CellRange=0]="CellRange",t[t.SeriesName=1]="SeriesName",t[t.CategoryName=2]="CategoryName",t[t.Value=3]="Value",t[t.XValue=4]="XValue",t[t.YValue=5]="YValue",t[t.BubbleSize=6]="BubbleSize",t[t.Percentage=7]="Percentage",t[t.TxLink=8]="TxLink"}(e.TextFieldType||(e.TextFieldType={})),function(t){t[t.None=0]="None",t[t.Single=1]="Single",t[t.Double=2]="Double",t[t.SingleAccounting=3]="SingleAccounting",t[t.DoubleAccounting=4]="DoubleAccounting"}(e.UnderlineType||(e.UnderlineType={})),function(t){t[t.None=0]="None",t[t.Auto=1]="Auto",t[t.RGB=2]="RGB",t[t.Index=3]="Index",t[t.Theme=4]="Theme"}(e.ColorType||(e.ColorType={})),function(t){t[t.connected=0]="connected",t[t.gaps=1]="gaps",t[t.zero=2]="zero"}(e.DisplayBlanksAs||(e.DisplayBlanksAs={})),function(t){t[t.Color=1]="Color",t[t.PatternColor=2]="PatternColor",t[t.BeginArrowheadLength=4]="BeginArrowheadLength",t[t.BeginArrowheadStyle=8]="BeginArrowheadStyle",t[t.BeginArrowheadWidth=16]="BeginArrowheadWidth",t[t.DashStyle=32]="DashStyle",t[t.EndArrowheadLength=64]="EndArrowheadLength",t[t.EndArrowheadStyle=128]="EndArrowheadStyle",t[t.EndArrowheadWidth=256]="EndArrowheadWidth",t[t.InsetPen=512]="InsetPen",t[t.Pattern=1024]="Pattern",t[t.Style=2048]="Style",t[t.Transparency=4096]="Transparency",t[t.Visible=8192]="Visible",t[t.Weight=16384]="Weight",t[t.CapStyle=32768]="CapStyle",t[t.JoinStyle=65536]="JoinStyle"}(e.LineFormatStates||(e.LineFormatStates={})),function(t){t[t.Brightness=1]="Brightness",t[t.ObjectThemeColor=2]="ObjectThemeColor",t[t.RGB=4]="RGB",t[t.TintAndShade=8]="TintAndShade",t[t.ColorType=16]="ColorType",t[t.Transparency=32]="Transparency"}(e.ColorFormatStates||(e.ColorFormatStates={})),function(t){t[t.PictureShape=0]="PictureShape",t[t.PictureFill=1]="PictureFill",t[t.TextureFill=2]="TextureFill"}(e.PictureFormatType||(e.PictureFormatType={}))},"./dist/plugins/floatingObject/drawing/effects.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/stateful.js"),r=n("./dist/plugins/floatingObject/drawing/common.js"),i=n("./dist/plugins/floatingObject/drawing/colorFormat.js"),a=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),function(t){t[t.Blur=1]="Blur",t[t.Offset=2]="Offset",t[t.Size=4]="Size",t[t.Transparency=8]="Transparency",t[t.Type=16]="Type"}(s||(s={})),l=r.UnitHelper.isNullOrUndefined,u=Math.floor,c=Math.sqrt,function(t){t[t.Blur=1]="Blur",t[t.Obscured=2]="Obscured",t[t.OffsetX=4]="OffsetX",t[t.OffsetY=8]="OffsetY",t[t.RotateWithShape=16]="RotateWithShape",t[t.Size=32]="Size",t[t.Style=64]="Style",t[t.Transparency=128]="Transparency",t[t.Type=256]="Type",t[t.Visible=512]="Visible"}(f||(f={})),h=function(t){function e(e,n){var o=t.call(this,n)||this,i=o;return i.Ira=5,i.Jra=!1,i.Kra=r.ShapeConstants.DefaultOffset,i.Lra=r.ShapeConstants.DefaultOffset,i.Mra=!1,i.Oz=100,i.Gqa=0,i.bz=!1,i.presetShadowOffset=-6,i.xc=e,i.hqa=n,o}return y(e,t),e.prototype.OnStyleChange=function(){var t=this;t.Ira=0,t.Kra=0,t.Lra=0,t.Oz=100,t.Gqa=0,t.UnDirty(f.Type),t.Style===a.ShadowStyle.ShadowStyleInnerShadow?t.Mra=!1:t.Style===a.ShadowStyle.ShadowStyleOuterShadow&&(t.Mra=!0)},e.prototype.OnTypeChange=function(){var t=this;t.Ira=5,t.Kra=t.presetShadowOffset,t.Lra=t.presetShadowOffset,t.Oz=100,t.Gqa=.5,t.UnDirty(f.Style)},e.prototype.GetDefaultColor=function(){var t=new i.ColorFormat(this.xc,this.hqa&&this.hqa.Nra);return t.ColorType=a.SolidColorType.None,t},e.prototype.IncrementOffsetX=function(t){this.OffsetX+=t},e.prototype.IncrementOffsetY=function(t){this.OffsetY+=t},e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e.prototype.ToCT_PresetShadowEffect=function(){var t=this,e=t.OffsetX,n=t.OffsetY,o=c(e*e+n*n),i={dist:0,dir:0};return i.dist=o,i.dir=u(r.NumberExtension.GetTriangleAngle(e,n,o)*r.ShapeConstants.PositiveFixedAngleConvert),i.prst=t.Type,t.ToCT_Color(i),i},e.prototype.ToCT_InnerShadowEffect=function(){var t=this,e=t.OffsetX,n=t.OffsetY,o=c(e*e+n*n),i={blurRad:0,dist:0,dir:0};return i.blurRad=t.Blur,i.dist=o,0===e&&0===n||(i.dir=u(r.NumberExtension.GetTriangleAngle(e,n,o)*r.ShapeConstants.PositiveFixedAngleConvert)),i.scrgbClr=t.ToCT_ScRgbColor(),i},e.prototype.ToCT_OuterShadowEffect=function(){var t=this,e=t.OffsetX,n=t.OffsetY,o=c(e*e+n*n),i={blurRad:0,dist:0,dir:0,sx:1e5,sy:1e5,kx:0,ky:0,algn:a.TextureAlignment.TextureBottom,rotWithShape:!0};return i.blurRad=t.Blur,i.dist=o,0===e&&0===n||(i.dir=u(r.NumberExtension.GetTriangleAngle(e,n,o)*r.ShapeConstants.PositiveFixedAngleConvert)),i.rotWithShape=!0===t.RotateWithShape,i.sx=u(t.Size*r.ShapeConstants.RelativeRectConver),i.sy=u(t.Size*r.ShapeConstants.RelativeRectConver),i.scrgbClr=t.ToCT_ScRgbColor(),i},e.prototype.ToCT_Color=function(t){var e,n,o,i,s,c=this;l(c.Nra)||(c.Nra.ColorType===a.SolidColorType.Theme?((i={}).val=c.Nra.ObjectThemeColor,0!==c.Nra.Brightness&&(e=u(1e5*c.Nra.Brightness),i.lumMod=[e],n=u(1e5*(1-c.Nra.Brightness)),i.lumOff=[n]),c.Nra.TintAndShade>0&&c.Nra.TintAndShade<1&&(o=u(c.Nra.TintAndShade*r.ShapeConstants.ShadeConver),i.shade=[o]),t.schemeClr=i):c.Nra.ColorType===a.SolidColorType.RGB&&((s={}).val=[c.Nra.RGB.R,c.Nra.RGB.G,c.Nra.RGB.B],0!==c.Nra.Brightness&&(e=u(1e5*c.Nra.Brightness),s.lumMod=[e],n=u(1e5*(1-c.Nra.Brightness)),s.lumOff=[n]),0!==c.Transparency&&(o=u(c.Transparency*r.ShapeConstants.PositiveFixedPercentageConvert),s.alpha=[o]),t.srgbClr=s))},e.prototype.ToCT_ScRgbColor=function(){var t,e={};return 0!==this.Transparency&&(t=u(this.Transparency*r.ShapeConstants.PositiveFixedPercentageConvert),e.alpha=[t]),e},e.prototype.SetState=function(e,n){t.prototype.SetState.call(this,e,n),e!==f.Blur&&e!==f.OffsetX&&e!==f.OffsetY&&e!==f.RotateWithShape&&e!==f.Size&&e!==f.Transparency||this.GetState(f.Style)||(this.Wqa=a.ShadowStyle.ShadowStyleOuterShadow)},Object.defineProperty(e.prototype,"ForeColor",{get:function(){var t=this;return l(t.Nra)&&(t.Nra=t.GetDefaultColor()),t.Nra},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Obscured",{get:function(){var t=this;return t.GetState(f.Obscured)||l(t.hqa)?t.Jra:t.hqa.Obscured},set:function(t){this.Jra=t,this.SetState(f.Obscured,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Blur",{get:function(){var t=this;return t.GetState(f.Blur)||l(t.hqa)?t.Ira:t.hqa.Blur},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Blue",{set:function(t){this.Ira=t,this.SetState(f.Blur,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetX",{get:function(){var t=this;return t.GetState(f.OffsetX)||l(t.hqa)?t.Kra:t.hqa.OffsetX},set:function(t){this.Kra=t,this.SetState(f.OffsetX,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"OffsetY",{get:function(){var t=this;return t.GetState(f.OffsetY)||l(t.hqa)?t.Lra:t.hqa.OffsetY},set:function(t){this.Lra=t,this.SetState(f.OffsetY,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotateWithShape",{get:function(){var t=this;return t.GetState(f.RotateWithShape)||l(t.hqa)?t.Mra:t.hqa.RotateWithShape},set:function(t){var e=this;e.Style===a.ShadowStyle.ShadowStyleInnerShadow||e.GetState(f.Type)||(e.Mra=t,e.SetState(f.RotateWithShape,!0))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this;return t.GetState(f.Size)||l(t.hqa)?t.Oz:t.hqa.Size},set:function(t){this.Oz=t,this.SetState(f.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Style",{get:function(){var t=this;return t.GetState(f.Style)||l(t.hqa)?t.Wqa:t.hqa.Style},set:function(t){var e=this;e.Style!==t&&e.OnStyleChange(),e.Wqa=t,e.SetState(f.Style,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(f.Transparency)||l(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){this.Gqa=t,this.SetState(f.Transparency,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){var t=this;return t.GetState(f.Type)||l(t.hqa)?t.Nc:t.hqa.Type},set:function(t){this.Nc=t,this.SetState(f.Type,!0),this.OnTypeChange()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){var t=this;return t.GetState(f.Visible)||l(t.hqa)?t.bz:t.hqa.Visible},set:function(t){var e=this;e.bz=t,e.SetState(f.Visible,!0),!1===t||e.GetState(f.Style)||(e.Wqa=a.ShadowStyle.ShadowStyleOuterShadow)},enumerable:!0,configurable:!0}),e}(o.StatefullBase),e.ShadowFormat=h,p=function(t){function e(e){return t.call(this,e)||this}return y(e,t),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e}(o.StatefullBase),e.SoftEdgeFormat=p,d=function(t){function e(e,n){var o=t.call(this,n)||this,r=o;return r.Oz=100,r.Nc=a.ReflectionType.ReflectionType1,r.presetShadowOffset=-6,r.xc=e,r.hqa=n,o}return y(e,t),Object.defineProperty(e.prototype,"Blur",{get:function(){var t=this;return t.GetState(s.Blur)||l(t.hqa)?t.Ira:t.hqa.Blur},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Blue",{set:function(t){this.Ira=t,this.SetState(s.Blur,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Offset",{get:function(){var t=this;return t.GetState(s.Offset)||l(t.hqa)?t.UP:t.hqa.Offset},set:function(t){this.UP=t,this.SetState(s.Offset,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this;return t.GetState(s.Size)||l(t.hqa)?t.Oz:t.hqa.Size},set:function(t){this.Oz=t,this.SetState(s.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(s.Transparency)||l(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){this.Gqa=t,this.SetState(s.Transparency,!0)},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e.prototype.OnTypeChange=function(){var t=this;t.Ira=5,t.UP=t.presetShadowOffset,t.Oz=100,t.Gqa=.5},e}(o.StatefullBase),e.ReflectionFormat=d,function(t){t[t.Color=1]="Color",t[t.Radius=2]="Radius",t[t.Transparency=4]="Transparency"}(g||(g={})),m=function(t){function e(e,n){var o=t.call(this,n)||this;return o.xc=e,o.hqa=n,o}return y(e,t),Object.defineProperty(e.prototype,"Color",{get:function(){var t=this;return l(t.tE)&&(t.tE=t.GetDefaultColor()),t.tE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Radius",{get:function(){var t=this;return t.GetState(g.Radius)||l(t.hqa)?t.radius:t.hqa.Radius},set:function(t){this.radius=t,this.Dirty(g.Radius)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.GetState(g.Transparency)||l(t.hqa)?t.Gqa:t.hqa.Transparency},set:function(t){this.Gqa=t,this.Dirty(g.Transparency)},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa},e.prototype.GetDefaultColor=function(){var t=new i.ColorFormat(this.xc,this.hqa&&this.hqa.Color);return t.ColorType=a.SolidColorType.None,t},e.prototype.SetState=function(e,n){var o=this;t.prototype.SetState.call(o,e,n),e!==g.Radius&&e!==g.Transparency||o.tE&&o.tE.ColorType===a.SolidColorType.None&&(o.tE.ColorType=a.SolidColorType.RGB)},e.prototype.ToCT_Color=function(t){var e,n,o,i,s,c,f,h=this,p=h.tE;l(p)||(i=p.ColorType,s=p.Brightness,i===a.SolidColorType.Theme?((c={}).val=p.ObjectThemeColor,0!==s&&(e=u(1e5*s),c.lumMod=[e],n=u(1e5*(1-s)),c.lumOff=[n]),p.TintAndShade>0&&p.TintAndShade<1&&(o=u(p.TintAndShade*r.ShapeConstants.ShadeConver),c.shade=[o]),t.schemeClr=c):i===a.SolidColorType.RGB&&((f={}).val=[p.RGB.R,p.RGB.G,p.RGB.B],0!==s&&(e=u(1e5*s),f.lumMod=[e],n=u(1e5*(1-s)),f.lumOff=[n]),0!==h.Transparency&&(o=u(h.Transparency*r.ShapeConstants.PositiveFixedPercentageConvert),f.alpha=[o]),t.srgbClr=f))},e}(o.StatefullBase),e.GlowFormat=m},"./dist/plugins/floatingObject/drawing/fillFormat.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/stateful.js"),r=n("./dist/plugins/floatingObject/drawing/common.js"),i=n("./dist/plugins/floatingObject/drawing/colorFormat.js"),a=n("./dist/plugins/floatingObject/drawing/gradient.js"),s=n("./dist/plugins/floatingObject/drawing/picture.js"),l=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),u=r.ShapeConstants,c=u.PositiveFixedPercentageConvert,f=u.PositiveFixedAngleConvert,h=u.PositionConver,p=r.ShapeUtility,d=r.UnitHelper,g=d.isNullOrUndefined,m=null,y=Math.floor,v="The specified value is out of range",function(t){t[t.GradientStops=1]="GradientStops",t[t.GradientStyle=2]="GradientStyle",t[t.GradientColorType=4]="GradientColorType",t[t.Pattern=8]="Pattern",t[t.PresetTexture=16]="PresetTexture",t[t.RotateWithObject=32]="RotateWithObject",t[t.TextureAlignment=64]="TextureAlignment",t[t.TextureHorizontalScale=128]="TextureHorizontalScale",t[t.TextureName=256]="TextureName",t[t.TextureOffsetX=512]="TextureOffsetX",t[t.TextureOffsetY=1024]="TextureOffsetY",t[t.TextureTile=2048]="TextureTile",t[t.TextureType=4096]="TextureType",t[t.TextureVerticalScale=8192]="TextureVerticalScale",t[t.Transparency=16384]="Transparency",t[t.Type=32768]="Type",t[t.Visible=65536]="Visible",t[t.Color=131072]="Color",t[t.PatternColor=262144]="PatternColor",t[t.PictureFormat=524288]="PictureFormat",t[t.GradientDegree=1048576]="GradientDegree",t[t.GradientAngle=2097152]="GradientAngle",t[t.GradientVariant=4194304]="GradientVariant",t[t.PresetGradientType=8388608]="PresetGradientType"}(C||(C={})),b=function(t){function e(e,n,o,r){var i=t.call(this,n)||this,u=i;return u.dqa=!0,u.eqa=l.ST_PathShadeType.rect,u.wE=l.PatternType.none,u.fqa=!0,u.bz=!0,u.gqa=m,u.xc=e,u.Nc=l.FillType.Solid,u.hqa=n,u.iqa=o,u.xo=r,u.jqa=new s.PictureFormat(l.PictureFormatType.PictureFill,n&&n.PictureFormat),u.jqa.Container=r,u.kqa=1,u.lqa=1,u.mqa=new a.GradientStops(u.xc),i}return w(e,t),Object.defineProperty(e.prototype,"Parent",{get:function(){return this.hqa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PictureFormat",{get:function(){return this.jqa},set:function(t){var e,n=this;g(n.jqa)||n.jqa.SetParentForChildren(t),e=n.jqa,n.jqa=t,g(e)||(n.jqa.ParentStateful=e.ParentStateful)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PatternColor",{get:function(){return this.PatternColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.ColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientAngle",{get:function(){var t=this;if(!t.IsDirty(C.GradientAngle)&&!g(t.hqa))return t.hqa.GradientAngle;if(t.GradientStyle===l.GradientStyle.GradientFromCenter||t.GradientStyle===l.GradientStyle.GradientFromCorner)throw Error();return t.nqa},set:function(t){this.nqa=t,this.Dirty(C.GradientAngle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientColorType",{get:function(){return this.GetGradientColorType()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientDegree",{get:function(){var t=this;return t.IsDirty(C.GradientDegree)||g(t.hqa)?t.oqa:t.hqa.GradientDegree},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientStops",{get:function(){var t=this;return t.IsDirty(C.GradientStops)||g(t.hqa)?t.mqa:t.hqa.GradientStops},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientStyle",{get:function(){var t=this;return t.IsDirty(C.GradientStyle)||g(t.hqa)?t.qqa:t.hqa.GradientStyle},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientVariant",{get:function(){var t=this;return t.IsDirty(C.GradientVariant)||g(t.hqa)?t.sqa:t.hqa.GradientVariant},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pattern",{get:function(){var t=this;return t.IsDirty(C.Pattern)||g(t.hqa)?t.wE:t.hqa.Pattern},set:function(t){this.wE=t,this.Dirty(C.Pattern)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetGradientType",{get:function(){var t=this;return t.IsDirty(C.PresetGradientType)||g(t.hqa)?t.wqa:t.hqa.PresetGradientType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotateWithObject",{get:function(){var t=this;return t.IsDirty(C.RotateWithObject)||g(t.hqa)?t.fqa:t.hqa.RotateWithObject},set:function(t){this.fqa=t,this.Dirty(C.RotateWithObject)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureAlignment",{get:function(){var t=this;return t.IsDirty(C.TextureAlignment)||g(t.hqa)?t.yqa:t.hqa.TextureAlignment},set:function(t){this.yqa=t,this.Dirty(C.TextureAlignment)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureHorizontalScale",{get:function(){var t=this;return t.IsDirty(C.TextureHorizontalScale)||g(t.hqa)?t.kqa:t.hqa.TextureHorizontalScale},set:function(t){this.kqa=t,this.Dirty(C.TextureHorizontalScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureOffsetX",{get:function(){var t=this;return t.IsDirty(C.TextureOffsetX)||g(t.hqa)?t.zqa:t.hqa.TextureOffsetX},set:function(t){this.zqa=t,this.Dirty(C.TextureOffsetX)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureOffsetY",{get:function(){var t=this;return t.IsDirty(C.TextureOffsetY)||g(t.hqa)?t.Aqa:t.hqa.TextureOffsetY},set:function(t){this.Aqa=t,this.Dirty(C.TextureOffsetY)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TextureVerticalScale",{get:function(){var t=this;return t.IsDirty(C.TextureVerticalScale)||g(t.hqa)?t.lqa:t.hqa.TextureVerticalScale},set:function(t){this.lqa=t,this.Dirty(C.TextureVerticalScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){var t=this;return t.IsDirty(C.Transparency)||g(t.hqa)?t.ColorInternal.Transparency:t.hqa.Transparency},set:function(t){this.ColorInternal.Transparency=t,this.Dirty(C.Transparency)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){var t=this;return t.IsDirty(C.Type)||g(t.hqa)?t.Nc:t.hqa.Type},set:function(t){this.Nc=t,this.Dirty(C.Type)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){var t=this;return t.IsDirty(C.Visible)||g(t.hqa)?t.bz:t.hqa.Visible},set:function(t){this.bz=t,this.Dirty(C.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorInternal",{get:function(){var t=this;return g(t.tE)&&(t.tE=new i.ColorFormat(t.xc,g(t.hqa)?m:t.hqa.Color),t.tE.AutoColorFormat=t.iqa),t.tE},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PatternColorInternal",{get:function(){var t=this;return g(t.Bqa)&&(t.Bqa=new i.ColorFormat(t.xc,g(t.hqa)?m:t.hqa.PatternColor)),t.Bqa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetTexture",{get:function(){var t=this;return t.IsDirty(C.PresetTexture)||g(t.hqa)?t.Cqa:t.hqa.PresetTexture},set:function(t){this.Cqa=t,this.Dirty(C.PresetTexture)},enumerable:!0,configurable:!0}),e.prototype.GetGradientColorType=function(){var t,e,n,o,r=[];for(t=0,e=this.mqa.GradientStopList;t<e.length;t++)n=e[t],this.FindInColorStops(n.Color,r)||r.push(n.Color);return 0===(o=r.length)?l.GradientColorType.GradientColorNone:1===o?l.GradientColorType.GradientOneColor:2===o?l.GradientColorType.GradientTwoColors:l.GradientColorType.GradientMultiColor},e.prototype.FindInColorStops=function(t,e){var n,o,r,i;for(n=0,o=e;n<o.length;n++)if((i=(r=o[n]).ColorType)===t.ColorType)if(i===l.SolidColorType.Theme){if(r.ObjectThemeColor===t.ObjectThemeColor&&r.TintAndShade===t.TintAndShade)return!0}else if(i===l.SolidColorType.RGB&&r.RGB.Equals(t.RGB)&&r.TintAndShade===t.TintAndShade)return!0;return!1},e.prototype.pqa=function(t){this.oqa=t,this.Dirty(C.GradientDegree)},e.prototype.Fpa=function(t){this.mqa=t,this.Dirty(C.GradientStops)},e.prototype.rqa=function(t){this.qqa=t,this.Dirty(C.GradientStyle)},e.prototype.tqa=function(t){this.sqa=t,this.Dirty(C.GradientVariant)},e.prototype.uqa=function(t){if(t===l.PatternType.none)throw Error(v);var e=this;e.Pattern===l.PatternType.none&&e.vqa(l.FillType.Patterned),e.wE=t,e.Dirty(C.Pattern)},e.prototype.xqa=function(t){this.wqa=t,this.Dirty(C.PresetGradientType)},e.prototype.vqa=function(t){this.Nc=t,this.Dirty(C.Type)},e.prototype.InitGradientInfo=function(t,e,n){if(t===l.GradientStyle.GradientFromTitle)throw Error(v);var o=this;o.rqa(t),o.tqa(e),o.vqa(l.FillType.Gradient),o.xqa(n)},e.prototype.OneColorGradient=function(t,e,n){if(n<0||n>1)throw Error(v);var o=this;o.InitGradientInfo(t,e,l.PresetGradientType.GradientEarlySunset),o.pqa(n),p.InitGradientStops(o.xc,o,l.GradientColorType.GradientOneColor)},e.prototype.TwoColorGradient=function(t,e){this.InitGradientInfo(t,e,l.PresetGradientType.GradientEarlySunset),p.InitGradientStops(this.xc,this,l.GradientColorType.GradientTwoColors)},e.prototype.PresetGradient=function(t,e,n){this.InitGradientInfo(t,e,n),p.InitGradientStops(this.xc,this,l.GradientColorType.GradientPresetColors)},e.prototype.Patterned=function(t){this.SetPatternColor(),this.vqa(l.FillType.Patterned),this.uqa(t)},e.prototype.SetPatternColor=function(){var t=this;t.Color.ObjectThemeColor=l.ColorSchemeIndex.LT1,t.PatternColor.ObjectThemeColor=l.ColorSchemeIndex.Accent1,t.Color.ClearModel(),t.PatternColor.ClearModel()},e.prototype.Solid=function(){this.vqa(l.FillType.Solid),g(this.tE)||this.tE.ClearModel()},e.prototype.ClearColor=function(){this.tE=m},e.prototype.GetState=function(e,n){var o=this;return void 0===n&&(n=!1),e!==C.Color||g(o.tE)?e!==C.PatternColor||g(o.Bqa)?t.prototype.GetState.call(o,e,n):o.Bqa.IsDirtyIncludingParent(n):o.tE.IsDirtyIncludingParent(n)},e.prototype.IsDirtyIncludingParent=function(e){void 0===e&&(e=!1);var n=this;return!(g(n.Bqa)||!n.Bqa.IsDirtyIncludingParent())||!(g(n.tE)||!n.tE.IsDirtyIncludingParent())||!g(n.mqa)&&n.mqa.Count>0||!(g(n.jqa)||!n.jqa.IsDirtyIncludingParent())||t.prototype.IsDirtyIncludingParent.call(n,e)},e.prototype.OnParentChanged=function(t){var e=this;e.hqa=t,g(e.hqa)?(g(e.tE)||(e.tE.ParentStateful=m),g(e.Bqa)||(e.Bqa.ParentStateful=m)):(g(e.tE)||(e.tE.ParentStateful=e.hqa.Color),g(e.Bqa)||(e.Bqa.ParentStateful=e.hqa.PatternColor))},e.prototype.FromOOModel=function(t,e){if(g(e))throw Error("colorFillType not provided!");var n=this;n.gqa=t,e===l.ColorFillType.SolidColorFillProperties?(n.ColorInternal.FromOOModel(n.gqa),n.Nc=l.FillType.Solid,n.SetState(C.Type,!0)):e===l.ColorFillType.PatternFillProperties?(n.FromCT_PatternFillProperties(t),n.Nc=l.FillType.Patterned,n.SetState(C.Type,!0)):e===l.ColorFillType.GradientFillProperties?(n.FromCT_GradientFillProperties(t),n.Nc=l.FillType.Gradient,n.SetState(C.Type,!0)):e===l.ColorFillType.BlipFillProperties?(n.jqa.FromOOModel(t),n.Nc=l.FillType.Picture,n.SetState(C.Type,!0)):e===l.ColorFillType.GroupFillProperties?(n.Nc=l.FillType.Group,n.SetState(C.Type,!0)):e===l.ColorFillType.NoFillProperties&&(n.Nc=l.FillType.Solid,n.SetState(C.Type,!0))},e.prototype.ToOOModel=function(t){var e;if(this.Visible)switch(this.Type){case l.FillType.Solid:e=this.ToCT_SolidColorFillProperties();break;case l.FillType.Patterned:e=this.ToCT_PatternFillProperties();break;case l.FillType.Gradient:e=this.ToCT_GradientFillProperties();break;case l.FillType.Textured:e=this.ToCT_TileFillProperties();break;case l.FillType.Background:break;case l.FillType.Picture:e=this.ToCT_PictureFillProperties();break;case l.FillType.Group:e={colorFillType:l.ColorFillType.GroupFillProperties}}else e={colorFillType:l.ColorFillType.NoFillProperties};return e},e.prototype.FromCT_PatternFillProperties=function(t){this.uqa(t.prst),this.ColorInternal.FromOOModel(t.bgClr),this.PatternColorInternal.FromOOModel(t.fgClr)},e.prototype.ToCT_PatternFillProperties=function(){var t,e=this;return e.xc.DrawingType===l.DrawingType.GroupShape?m:((t={colorFillType:l.ColorFillType.PatternFillProperties}).prst=e.Pattern,e.PatternColorInternal.ColorType!==l.SolidColorType.None&&(t.fgClr=e.PatternColorInternal.Color_ToOOModel()),e.Color.ColorType!==l.SolidColorType.None&&(t.bgClr=e.Color.Color_ToOOModel()),t)},e.prototype.FromCT_GradientFillProperties=function(t){var e=this;e.Fpa(new a.GradientStops(e.xc)),e.mqa.FromOOModel(t.gsLst),e.RotateWithObject=t.rotWithShape,g(t.path)?g(t.lin)||(e.FromCT_LinearShadeProperties(t.lin),e.FromTitleCT_RelativeRect(t.tileRect)):e.FromCT_PathShadeProperties(t.path)},e.prototype.ToCT_GradientFillProperties=function(){var t=this,e={colorFillType:l.ColorFillType.GradientFillProperties};return e.rotWithShape=t.RotateWithObject,!g(t.GradientStops)&&t.GradientStops.Count>0&&(e.gsLst=t.GradientStops.ToOOModel()),t.GradientStyle===l.GradientStyle.GradientFromCenter||t.GradientStyle===l.GradientStyle.GradientFromCorner?e.path=t.ToCT_PathShadeProperties():e.lin=t.ToCT_LinearShadeProperties(),e.tileRect=t.ToTitleCT_RelativeRect(),e},e.prototype.ToCT_PictureFillProperties=function(){return this.jqa.ToOOModel()},e.prototype.FromTitleCT_RelativeRect=function(t){var e=this;g(t)||(t.l===-c&&t.t===-c?e.tqa(1):t.t===-c&&t.r===-c?e.tqa(2):t.l===-c&&t.b===-c?e.tqa(3):t.r===-c&&t.b===-c&&e.tqa(4))},e.prototype.ToTitleCT_RelativeRect=function(){var t={l:0,r:0,t:0,b:0},e=this.GradientVariant;return this.GradientStyle===l.GradientStyle.GradientFromCorner&&(1===e?(t.l=-c,t.t=-c):2===e?(t.t=-c,t.r=-c):3===e?(t.l=-c,t.b=-c):4===e&&(t.r=-c,t.b=-c)),t},e.prototype.FromCT_LinearShadeProperties=function(t){this.GradientAngle=t.ang/f,this.Vkb=!0,this.dqa=t.scaled},e.prototype.ToCT_LinearShadeProperties=function(){return{ang:y(this.GradientAngle*f),scaled:this.dqa}},e.prototype.FromCT_PathShadeProperties=function(t){g(t)||(this.eqa=t.path,this.FromCT_RelativeRect(t.fillToRect))},e.prototype.ToCT_PathShadeProperties=function(){return{path:this.eqa,fillToRect:this.ToCT_RelativeRect()}},e.prototype.FromCT_RelativeRect=function(t){var e,n;g(t)||(e=.5*c,n=this,t.l===e&&t.t===e&&t.r===e&&t.b===e?n.rqa(l.GradientStyle.GradientFromCenter):t.r===c&&t.b===c?(n.rqa(l.GradientStyle.GradientFromCorner),n.tqa(1)):t.l===c&&t.b===c?(n.rqa(l.GradientStyle.GradientFromCorner),n.tqa(2)):t.r===c&&t.t===c?(n.rqa(l.GradientStyle.GradientFromCorner),n.tqa(3)):t.l===c&&t.t===c&&(n.rqa(l.GradientStyle.GradientFromCorner),n.tqa(4)))},e.prototype.ToCT_RelativeRect=function(){var t,e={l:0,r:0,t:0,b:0},n=.5*c;return this.GradientStyle===l.GradientStyle.GradientFromCenter?(e.l=n,e.t=n,e.r=n,e.b=n):this.GradientStyle===l.GradientStyle.GradientFromCorner&&(1===(t=this.GradientVariant)?(e.r=c,e.b=c):2===t?(e.l=c,e.b=c):3===t?(e.t=c,e.r=c):4===t&&(e.l=c,e.t=c)),e},e.prototype.ToCT_SolidColorFillProperties=function(){return this.ColorInternal.ToOOModel()},e.prototype.ToCT_TileFillProperties=function(){var t=this.jqa.ToOOModel();return t.tile=this.ToCT_TileInfoProperties(),t},e.prototype.ToCT_TileInfoProperties=function(){var t=this;return{algn:t.TextureAlignment,tx:t.TextureOffsetX,ty:t.TextureOffsetY,sx:y(t.TextureHorizontalScale*h),sy:y(t.TextureVerticalScale*h)}},e.prototype.Clone=function(){var t=this,n=new e(t.xc,t.hqa,t.iqa,t.xo);return g(t.Bqa)||(n.Bqa=t.Bqa.Clone()),g(t.tE)||(n.tE=t.tE.Clone()),n.oqa=t.oqa,n.dqa=t.dqa,n.mqa=t.mqa,n.sqa=t.sqa,n.wE=t.wE,n.wqa=t.wqa,n.Cqa=t.Cqa,n.Dqa=t.Dqa,n.Eqa=t.Eqa,n.Nc=t.Nc,n.nqa=t.nqa,n.fqa=t.fqa,n.yqa=t.yqa,n.kqa=t.kqa,n.zqa=t.zqa,n.Aqa=t.Aqa,n.Fqa=t.Fqa,n.lqa=t.lqa,n.Gqa=t.Gqa,n.bz=t.bz,n.rpa=t.rpa,n.hqa=t.hqa,n},e}(o.StatefullBase),e.FillFormat=b},"./dist/plugins/floatingObject/drawing/fontData.js":function(t,e,n){"use strict";var o,r,i,a,s,l;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/common.js"),r=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),i=n("./dist/plugins/floatingObject/drawing/colorData.js"),a=o.UnitHelper.isNullOrUndefined,function(t){t[t.None=0]="None",t[t.Color=1]="Color",t[t.Size=2]="Size",t[t.Name=4]="Name",t[t.Family=8]="Family",t[t.CharSet=16]="CharSet",t[t.Scheme=32]="Scheme",t[t.Bold=64]="Bold",t[t.Italic=128]="Italic",t[t.Underline=256]="Underline",t[t.Strike=512]="Strike",t[t.VertAlign=1024]="VertAlign",t[t.Shadow=2048]="Shadow",t[t.Outline=4096]="Outline",t[t.Condense=8192]="Condense",t[t.Extend=16384]="Extend",t[t.All=32767]="All"}(s||(s={})),l=function(){function t(){var t=this;t.Flag=s.None,t.Size=0,t.Family=0,t.CharSet=0,t.Scheme=r.ThemeFont.None,t.Underline=r.UnderlineType.None,t.VertAlign=r.VertAlignType.Baseline}return t.prototype.Equals=function(t){if(a(t))return!1;var e=this;return e.Size===t.Size&&e.Color.Equals(t.Color)&&e.Name===t.Name&&e.Family===t.Family&&e.CharSet===t.CharSet&&e.Scheme===t.Scheme&&e.Bold===t.Bold&&e.Italic===t.Italic&&e.Underline===t.Underline&&e.Strike===t.Strike&&e.VertAlign===t.VertAlign&&e.Shadow===t.Shadow&&e.Outline===t.Outline&&e.Condense===t.Condense&&e.Extend===t.Extend&&e.NotUsed===t.NotUsed},t.prototype.Clone=function(){var e=new t,n=this;return e.Color=n.Color,e.Size=n.Size,e.Name=n.Name,e.Family=n.Family,e.CharSet=n.CharSet,e.Scheme=n.Scheme,e.Bold=n.Bold,e.Italic=n.Italic,e.Underline=n.Underline,e.Strike=n.Strike,e.VertAlign=n.VertAlign,e.Shadow=n.Shadow,e.Outline=n.Outline,e.Condense=n.Condense,e.Extend=n.Extend,e.Flag=n.Flag,e.NotUsed=n.NotUsed,e},t.prototype.UpdateDefaultValueFlag=function(){var t=this,e=s.None;t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==i.ColorDataFlag.None&&(e|=s.Color),0!==t.Size&&(e|=s.Size),a(t.Name)||(e|=s.Name),0!==t.Family&&(e|=s.Family),0!==t.CharSet&&(e|=s.CharSet),t.Scheme!==r.ThemeFont.None&&(e|=s.Scheme),t.Bold&&(e|=s.Bold),t.Italic&&(e|=s.Italic),t.Underline!==r.UnderlineType.None&&(e|=s.Underline),t.Strike&&(e|=s.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(e|=s.VertAlign),t.Shadow&&(e|=s.Shadow),t.Outline&&(e|=s.Outline),t.Condense&&(e|=s.Condense),t.Extend&&(e|=s.Extend),t.Flag=e},t.prototype.UpdateFlagFromBottom=function(){var t=this;t.Color.UpdateFlagFromBottom(),t.Color.Flag===i.ColorDataFlag.None?t.Flag&=~s.Color:t.Flag|=s.Color},t.prototype.UpdateDefaultValueFlagForDxf=function(){var t=this,e=t.Flag,n=s.None;(e&s.Bold)===s.Bold&&(n|=s.Bold),(e&s.Italic)===s.Italic&&(n|=s.Italic),t.Color.UpdateDefaultValueFlag(),t.Color.Flag!==i.ColorDataFlag.None&&(n|=s.Color),0!==t.Size&&(n|=s.Size),a(t.Name)||(n|=s.Name),0!==t.Family&&(n|=s.Family),0!==t.CharSet&&(n|=s.CharSet),t.Scheme!==r.ThemeFont.None&&(n|=s.Scheme),t.Underline!==r.UnderlineType.None&&(n|=s.Underline),t.Strike&&(n|=s.Strike),t.VertAlign!==r.VertAlignType.Baseline&&(n|=s.VertAlign),t.Shadow&&(n|=s.Shadow),t.Outline&&(n|=s.Outline),t.Condense&&(n|=s.Condense),t.Extend&&(n|=s.Extend),t.Flag=n},t.prototype.Compose=function(t,e){void 0===e&&(e=!0),t.Flag!==s.None&&(e?this.ConflictCompose(t):this.NonConflictCompose(t))},t.prototype.ConflictCompose=function(t){var e=this,n=t.Flag;(n&s.Color)===s.Color&&e.Color.Compose(t.Color),(n&s.Size)===s.Size&&(e.Size=t.Size),(n&s.Name)===s.Name&&(e.Name=t.Name),(n&s.Family)===s.Family&&(e.Family=t.Family),(n&s.CharSet)===s.CharSet&&(e.CharSet=t.CharSet),(n&s.Scheme)===s.Scheme?e.Scheme=t.Scheme:(n&s.Name)===s.Name&&(e.Scheme=r.ThemeFont.None,n&=~s.Scheme),(n&s.Bold)===s.Bold&&(e.Bold=t.Bold),(n&s.Italic)===s.Italic&&(e.Italic=t.Italic),(n&s.Underline)===s.Underline&&(e.Underline=t.Underline),(n&s.Strike)===s.Strike&&(e.Strike=t.Strike),(n&s.VertAlign)===s.VertAlign&&(e.VertAlign=t.VertAlign),(n&s.Shadow)===s.Shadow&&(e.Shadow=t.Shadow),(n&s.Outline)===s.Outline&&(e.Outline=t.Outline),(n&s.Condense)===s.Condense&&(e.Condense=t.Condense),(n&s.Extend)===s.Extend&&(e.Extend=t.Extend),e.Flag|=n},t.prototype.NonConflictCompose=function(t){var e=this,n=e.Flag;e.Color.Compose(t.Color,!1),(n&s.Size)!==s.Size&&(e.Size=t.Size),(n&s.Name)!==s.Name&&(e.Name=t.Name),(n&s.Family)!==s.Family&&(e.Family=t.Family),(n&s.CharSet)!==s.CharSet&&(e.CharSet=t.CharSet),(n&s.Scheme)!==s.Scheme&&(e.Scheme=t.Scheme),(n&s.Bold)!==s.Bold&&(e.Bold=t.Bold),(n&s.Italic)!==s.Italic&&(e.Italic=t.Italic),(n&s.Underline)!==s.Underline&&(e.Underline=t.Underline),(n&s.Strike)!==s.Strike&&(e.Strike=t.Strike),(n&s.VertAlign)!==s.VertAlign&&(e.VertAlign=t.VertAlign),(n&s.Shadow)!==s.Shadow&&(e.Shadow=t.Shadow),(n&s.Outline)!==s.Outline&&(e.Outline=t.Outline),(n&s.Condense)!==s.Condense&&(e.Condense=t.Condense),(n&s.Extend)!==s.Extend&&(e.Extend=t.Extend),e.Flag|=t.Flag},t.prototype.RemoveDuplicateStyle=function(t){return this.Compare(t,!1)},t.prototype.RemoveDifferentStyle=function(t){return this.Compare(t,!0)},t.prototype.Compare=function(t,e){var n,o,r,a=this,l=a.Flag,u=t.Flag,c=[],f=!1;if((l&s.Color)===s.Color&&((n=(u&s.Color)!==s.Color)||(e?(f=a.Color.RemoveDifferentStyle(t.Color),n=a.Color.Flag===i.ColorDataFlag.None):(f=a.Color.RemoveDuplicateStyle(t.Color),n=a.Color.Flag!==i.ColorDataFlag.None)),(e?n:!n)&&c.push(s.Color)),(l&s.Size)===s.Size&&(n=(u&s.Size)!==s.Size||a.Size!==t.Size,(e?n:!n)&&c.push(s.Size)),(l&s.Name)===s.Name&&(n=(u&s.Name)!==s.Name||a.Name!==t.Name,(e?n:!n)&&c.push(s.Name)),(l&s.Family)===s.Family&&(n=(u&s.Family)!==s.Family||a.Family!==t.Family,(e?n:!n)&&c.push(s.Family)),(l&s.CharSet)===s.CharSet&&(n=(u&s.CharSet)!==s.CharSet||a.CharSet!==t.CharSet,(e?n:!n)&&c.push(s.CharSet)),(l&s.Scheme)===s.Scheme&&(n=(u&s.Scheme)!==s.Scheme||a.Scheme!==t.Scheme,(e?n:!n)&&c.push(s.Scheme)),(l&s.Bold)===s.Bold&&(n=(u&s.Bold)!==s.Bold||a.Bold!==t.Bold,(e?n:!n)&&c.push(s.Bold)),(l&s.Italic)===s.Italic&&(n=(u&s.Italic)!==s.Italic||a.Italic!==t.Italic,(e?n:!n)&&c.push(s.Italic)),(l&s.Underline)===s.Underline&&(n=(u&s.Underline)!==s.Underline||a.Underline!==t.Underline,(e?n:!n)&&c.push(s.Underline)),(l&s.Strike)===s.Strike&&(n=(u&s.Strike)!==s.Strike||a.Strike!==t.Strike,(e?n:!n)&&c.push(s.Strike)),(l&s.VertAlign)===s.VertAlign&&(n=(u&s.VertAlign)!==s.VertAlign||a.VertAlign!==t.VertAlign,(e?n:!n)&&c.push(s.VertAlign)),(l&s.Shadow)===s.Shadow&&(n=(u&s.Shadow)!==s.Shadow||a.Shadow!==t.Shadow,(e?n:!n)&&c.push(~s.Shadow)),(l&s.Outline)===s.Outline&&(n=(u&s.Outline)!==s.Outline||a.Outline!==t.Outline,(e?n:!n)&&c.push(s.Outline)),(l&s.Condense)===s.Condense&&(n=(u&s.Condense)!==s.Condense||a.Condense!==t.Condense,(e?n:!n)&&c.push(s.Condense)),(l&s.Extend)===s.Extend&&(n=(u&s.Extend)!==s.Extend||a.Extend!==t.Extend,(e?n:!n)&&c.push(s.Extend)),(o=c.length)>0)for(f=!0,r=0;r<o;r++)l&=~c[r];return a.Flag=l,f},t.prototype.ClearFlag=function(){this.Color.ClearFlag(),this.Flag=s.None},t.prototype.SetFullFlag=function(){this.Color.SetFullFlag(),this.Flag=s.All},t.prototype.IsFullFlag=function(){return this.Flag===s.All&&this.Color.IsFullFlag()},t}(),e.FontData=l},"./dist/plugins/floatingObject/drawing/fontFormat.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./dist/plugins/floatingObject/drawing/stateful.js"),i=n("./dist/plugins/floatingObject/drawing/common.js"),a=n("./dist/plugins/floatingObject/drawing/fillFormat.js"),s=n("./dist/plugins/floatingObject/drawing/fontData.js"),l=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),u=o.Common.j,c=u.za,f=i.ChartUtility,h=f.umb,p=i.ChartConstants,d=i.UnitHelper,g=d.isNullOrUndefined,m=null,y=void 0,v=function(){function t(t){this.Hpa=t}return Object.defineProperty(t.prototype,"Formula",{get:function(){return this.GetFormula(!1)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"FormulaR1C1",{get:function(){return this.GetFormula(!0)},set:function(t){t!==this.Formula&&this.UpdateTextByFormulas(t,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Parent",{get:function(){return this.Hpa},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ReferingText",{get:function(){return this.GetReferingText()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Worksheet",{get:function(){return this.Hpa.sheet()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"TextRefer",{get:function(){return this.Ipa},set:function(t){this.SetTextRefer(t)},enumerable:!0,configurable:!0}),t.prototype.SetTextRefer=function(t,e){e===y&&(e=!0),this.SetTextReferInternal(t,e),this.OnSetTextRefer(t)},t.prototype.OnSetTextRefer=function(t){},t.prototype.GetReferingText=function(){var t,e,n="";if(!g(this.Ipa))for(t=0,e=this.GetTextList(this.Ipa);t<e.length;t++)n+=e[t];return n},t.prototype.GetTextList=function(t){var e,n,o,r,i=[],a=this.Worksheet;for(g(t.WorksheetName)&&(t.WorksheetName=a.name()),e=a.Apa(t.WorksheetName),n=t.Row;n<=t.LastRow;n++)for(o=t.Column;o<=t.LastColumn;o++)r=e.Jpa(n,o).Text,i.push(g(r)?"":r);return i},t.prototype.SetTextReferInternal=function(t,e){this.Ipa=t},t.prototype.GetFormula=function(t){var e,n;return t===y&&(t=!1),(e=this.Ipa)?(n=this.Worksheet.name(),t?e.ToR1C1Text(n):e.ToA1Text(0,0,n)):""},t.prototype.UpdateTextByFormulas=function(t,e){var n;e===y&&(e=!1),n=this.Worksheet.Kpa(t,0,0,e).references,this.Ipa=n?n[0]:m},t}(),e.ReferenceText=v,C=function(t){function e(e,n,o,r){var i,a=t.call(this,e)||this;return n===y&&(n=m),o===y&&(o=m),r===y&&(r=m),(i=a).Lpa=m,i.Mpa=m,i.Npa=o||"",i.Opa=r,i.InitRichTextFields(n),a}return N(e,t),e.prototype.InitRichTextFields=function(t){var e=this,n=new R(e.Hpa,e.Opa);g(e.Lpa)||e.Lpa.Font.SetParentForChildren(n.Font),e.Lpa=n,e.Lpa.Font.ParentStateful=t,g(e.Npa)||e.Lpa.AddParagraph(e.Npa)},Object.defineProperty(e.prototype,"TextBody",{get:function(){return this.Lpa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Font",{get:function(){return this.Lpa.Font},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return g(this.TextRefer)?this.Lpa.Text:this.ReferingText},set:function(t){this.SetTextInternal(t)},enumerable:!0,configurable:!0}),e.prototype.SetTextInternal=function(t){this.SetTextReferInternal(m),this.UpdateTextBody(t)},e.prototype.UpdateTextBody=function(t){this.Lpa.Clear();var e=g(t)?this.Npa:t;g(e)||this.Lpa.AddParagraph(e)},e.prototype.OnSetTextRefer=function(e){t.prototype.OnSetTextRefer.call(this,e),this.UpdateTextBody(m)},e.prototype.FromOOModel=function(t){var e=this;e.Mpa=t,e.InitRichTextFields(e.Lpa.Font.ParentStateful),g(t.rich)||e.Lpa.FromOOModel(t.rich),!g(t.strRef)&&t.strRef.f&&e.UpdateTextByFormulas(t.strRef.f)},e.prototype.ToOOModel=function(t){var e=this,n=g(e.Mpa)?{}:e.Mpa;return g(e.Ipa)?n.rich=this.Lpa.ToOOModel(t):(n.strRef={f:e.Formula},n.rich=e.Lpa.ToOOModel(t)),n},e.prototype.SetParagraphSplitFlag=function(t){var e,n,o=this.Lpa;for(e=0,n=o.Count;e<n;e++)o.Get(e).SplitSpaceFlag=t},e.prototype.UpdateFiledElementTextLink=function(t){var e,n,o,r,i,a,s=this.Lpa;for(e=0,n=s.Count;e<n;e++)for(r=0,i=(o=s.Get(e)).Count;r<i;r++)if(a=o.Get(r),!g(a)&&a.Type===l.TextFieldType.TxLink)return void a.UpdateTextByFormulas(t)},e}(v),e.DrawingText=C,b={Bold:1,Color:2,Italic:4,Name:8,OutlineFont:16,Shadow:32,Size:64,Strikethrough:128,Subscript:256,Superscript:512,ThemeFont:1024,Underline:2048},w=function(t){function e(e,n,o){var r;return n===y&&(n=m),o===y&&(o=m),(r=t.call(this,n)||this).Ora=l.ThemeFont.None,r.Pra=m,r.Qra=m,r.Rra=m,r.xc=e,r.Zpa=new a.FillFormat(e,n&&n.FillInternal),r.hqa=n,o&&(g(o.Size)||(r.Oz=o.Size),g(o.Bold)||(r.Sra=o.Bold)),r}return N(e,t),Object.defineProperty(e.prototype,"Bold",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Bold)?t.Bold:this.Sra},set:function(t){this.Sra=t,this.SetState(b.Bold,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.FillInternal.Color},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Italic",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Italic)?t.Italic:this.Tra},set:function(t){this.Tra=t,this.SetState(b.Italic,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){var t=this.hqa;return t&&!this.HasOwnFont()?t.Name:this.GetOwnFont()},set:function(t){this.SetFont(t),this.ClearOOFontNames()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Size)?t.Size:this.Oz},set:function(t){this.Oz=t,this.SetState(b.Size,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Strikethrough",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Strikethrough)?t.Strikethrough:this.Ura},set:function(t){this.Ura=t,this.SetState(b.Strikethrough,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Subscript",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Subscript)?t.Subscript:this.Vra},set:function(t){this.Vra=t,this.SetState(b.Subscript,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Superscript",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Superscript)?t.Superscript:this.Wra},set:function(t){this.Wra=t,this.SetState(b.Superscript,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Underline",{get:function(){var t=this.hqa;return t&&!this.GetState(b.Underline)?t.Underline:this.Xra},set:function(t){this.Xra=t,this.SetState(b.Underline,!0)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ThemeFont",{get:function(){var t=this.hqa;return t&&!this.GetState(b.ThemeFont)?t.ThemeFont:this.Ora},set:function(t){this.SetThemeFont(t),this.ClearOOFontNames()},enumerable:!0,configurable:!0}),e.prototype.IsDirtyIncludingParent=function(e){return!(!this.Zpa||!this.Zpa.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},e.prototype.HasOwnFont=function(){return this.IsDirty(b.Name)||this.IsDirty(b.ThemeFont)},e.prototype.OnParentChanged=function(t){this.hqa=t,this.Zpa&&(this.Zpa.ParentStateful=t&&t.FillInternal)},e.prototype.GetOwnFont=function(){return this.Ora===l.ThemeFont.None?this.Cj:this.xc.Yra(this.Ora)},e.prototype.SetFont=function(t){var e=this;t===p.CHART_CS_HEAD_FONT||t===p.CHART_EA_HEAD_FONT||t===p.CHART_LATIN_HEAD_FONT?e.SetThemeFont(l.ThemeFont.Major):t===p.CHART_CS_BODY_FONT||t===p.CHART_EA_BODY_FONT||t===p.CHART_LATIN_BODY_FONT?e.SetThemeFont(l.ThemeFont.Minor):(e.Cj=t,e.SetState(b.Name,!0),e.Ora=l.ThemeFont.None,e.SetState(b.ThemeFont,!1))},e.prototype.SetThemeFont=function(t){var e=this;e.Ora=t,e.SetState(b.ThemeFont,!0),e.Cj=m,e.SetState(b.Name,!1)},e.prototype.ClearOOFontNames=function(){this.Qra=m,this.Rra=m,this.Pra=m},e.prototype.GetActualFormat=function(){var t,n,o=new e(this.xc);for(t in b)if(n=b[t],this.IsDirty(n))switch(n){case b.Bold:o.Bold=this.Bold;break;case b.Italic:o.Italic=this.Italic;break;case b.Name:o.Name=this.Name;break;case b.Size:o.Size=this.Size;break;case b.Strikethrough:o.Strikethrough=this.Strikethrough;break;case b.Subscript:o.Superscript=this.Superscript;break;case b.Superscript:o.Subscript=this.Subscript;break;case b.ThemeFont:o.ThemeFont=this.ThemeFont;break;case b.Underline:o.Underline=this.Underline}return o},Object.defineProperty(e.prototype,"FillInternal",{get:function(){var t=this;return t.Zpa||(t.Zpa=new a.FillFormat(t.xc,t.hqa&&t.hqa.FillInternal)),t.Zpa},enumerable:!0,configurable:!0}),e.prototype.TextCharacterProperties_FromOOModel=function(t){var e,n=this;n.SuspendClearChildrenState(),n.Zra=t,g(t.latin)||(n.Qra=t.latin.typeface),g(t.ea)||(n.Pra=t.ea.typeface),g(t.cs)||(n.Rra=t.cs.typeface),n.Qra?n.SetFont(n.Qra):n.Pra?n.SetFont(n.Pra):n.Rra&&n.SetFont(n.Rra),g(t.sz)||(e=t.sz,n.Oz!==e&&(n.Size=e)),g(t.b)||(n.Bold=t.b),g(t.i)||(n.Italic=t.i),g(t.strike)||(n.Strikethrough=t.strike===l.ST_TextStrikeType.sngStrike||t.strike===l.ST_TextStrikeType.dblStrike),g(t.u)||(n.Underline=t.u),g(t.baseline)||0===t.baseline?n.Subscript=!1:n.Subscript=!0,g(t.solidFill)?g(t.noFill)?g(t.blipFill)?g(t.gradFill)?g(t.pattFill)?n.SetFillField(m):n.FillInternal.FromOOModel(t.pattFill,l.ColorFillType.PatternFillProperties):n.FillInternal.FromOOModel(t.gradFill,l.ColorFillType.GradientFillProperties):n.FillInternal.FromOOModel(t.blipFill,l.ColorFillType.BlipFillProperties):n.FillInternal.Color.ColorType=l.SolidColorType.None:n.FillInternal.FromOOModel(t.solidFill,l.ColorFillType.SolidColorFillProperties),n.ResumeClearChilrenState()},e.prototype.AdjustStateful=function(t,e){g(t)||(t.SetParentForChildren(e),g(e)||(e.ParentStateful=t.ParentStateful),t.ParentStateful=m)},e.prototype.SetFillField=function(t){this.AdjustStateful(this.Zpa,t),this.Zpa=t},e.prototype.TextCharacterProperties_ToOOModel=function(){var t,e,n,o,r=this;return r.IsDirtyIncludingParent(!0)?(t=r.Zra||{},r.IsPropDirtyIncludingParent(b.Name,!0)?(e=r.Name,g(t.latin)&&(t.latin={}),t.latin.typeface=e):r.IsPropDirtyIncludingParent(b.ThemeFont,!0)&&r.ThemeFont!==l.ThemeFont.None?(g(t.latin)&&(t.latin={}),t.latin.typeface=r.ThemeFont===l.ThemeFont.Major?p.CHART_LATIN_HEAD_FONT:p.CHART_LATIN_BODY_FONT):(r.Qra||r.Pra||r.Rra)&&(r.Qra&&(g(t.latin)&&(t.latin={}),t.latin.typeface=r.Qra),r.Pra&&(g(t.ea)&&(t.ea={}),t.ea.typeface=r.Pra),r.Rra&&(g(t.cs)&&(t.cs={}),t.cs.typeface=r.Rra)),r.IsPropDirtyIncludingParent(b.Size,!0)&&r.Size>1?t.sz=r.Size:delete t.sz,r.IsPropDirtyIncludingParent(b.Bold,!0)&&(t.b=r.Bold),r.IsPropDirtyIncludingParent(b.Italic,!0)&&(t.i=r.Italic),r.IsPropDirtyIncludingParent(b.Strikethrough,!0)&&(t.strike=r.Strikethrough?l.ST_TextStrikeType.sngStrike:l.ST_TextStrikeType.noStrike),r.IsPropDirtyIncludingParent(b.Underline,!0)&&(t.u=r.Underline),r.Subscript&&g(t.baseline)?t.baseline=-25e3:r.Superscript&&g(t.baseline)?t.baseline=3e4:r.Subscript||r.Superscript||delete t.baseline,h(t),!g(r.Zpa)&&r.Zpa.IsDirtyIncludingParent(!0)&&((o=(n=r.Zpa.ToOOModel()).colorFillType)===l.ColorFillType.SolidColorFillProperties?t.solidFill=n:o===l.ColorFillType.PatternFillProperties?t.pattFill=n:o===l.ColorFillType.GradientFillProperties?t.gradFill=n:o===l.ColorFillType.BlipFillProperties?t.blipFill=n:o===l.ColorFillType.NoFillProperties&&(t.noFill=!0),delete n.colorFillType),t):{}},e.prototype.FromOOModel=function(t){var e=this;e.Bold=t.Bold,e.Italic=t.Italic,e.Name=t.Name,t.Scheme!==l.ThemeFont.None&&(e.ThemeFont=t.Scheme),e.Size=t.Size,e.Underline=f.ConvertToTextUnderlineType(t.Underline),e.Strikethrough=t.Strike,e.Subscript=(t.VertAlign&l.VertAlignType.Subscript)===l.VertAlignType.Subscript,e.Superscript=(t.VertAlign&l.VertAlignType.Superscript)===l.VertAlignType.Superscript,e.FillInternal.ColorInternal.ColorData_FromOOModel(t.Color)},e.prototype.ToOOModel=function(){var t,e=this,n=new s.FontData;return n.Bold=e.Bold,n.Italic=e.Italic,n.Name=e.Name,n.Scheme=e.ThemeFont,n.Size=e.Size,n.Underline=f.ToUnderlineType(e.Underline),n.Strike=e.Strikethrough,e.Subscript?n.VertAlign=l.VertAlignType.Subscript:e.Superscript&&(n.VertAlign=l.VertAlignType.Superscript),(t=e.Zpa)&&t.ColorInternal.IsDirtyIncludingParent(!0)&&t.ColorInternal.ColorType!==l.SolidColorType.None&&(n.Color=t.ColorInternal.ColorData_ToOOModel()),n},e}(r.StatefullBase),e.FontFormat=w,T=function(){function t(t,e){var n=this;n.xc=t,n.$ra=e,n._font=new w(t),n._font.ParentStateful=e.Font}return Object.defineProperty(t.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsCustomText",{get:function(){return!1},enumerable:!0,configurable:!0}),t.prototype.Delete=function(){this.$ra.DeleteElement(this),this.$ra=m},t.prototype.FromOOModel=function(t){},t.prototype.ToOOModel=function(){},t}(),e.DrawingTextElement=T,x=function(t){function e(e,n,o){var r=t.call(this,e,o)||this,i=r;return i._ra=m,i._text=n,i.xc=e,i.elementType=l.TextParagraphElementType.RegularTextRun,r}return N(e,t),Object.defineProperty(e.prototype,"Text",{get:function(){return this._text},set:function(t){this._text=t},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){var e=this;e._ra=t,e._text=t.t,g(t.rPr)?e._font=new w(e.xc,e._font.ParentStateful):e._font.TextCharacterProperties_FromOOModel(t.rPr)},e.prototype.ToOOModel=function(){var t=this._ra||{elementType:l.TextParagraphElementType.RegularTextRun};return t.t=this.Text,t.rPr=this._font.TextCharacterProperties_ToOOModel(),t},e}(T),e.DrawingTextRun=x,S=function(t){function e(e,n,o){var r=t.call(this,e,o)||this,i=r;return i.Nc=n,i.Hpa=e,i.asa=new v(i.Hpa),i.elementType=l.TextParagraphElementType.TextField,r}return N(e,t),Object.defineProperty(e.prototype,"Type",{get:function(){return this.Nc},set:function(t){this.Nc=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Text",{get:function(){return this.Type===l.TextFieldType.TxLink?this.asa.ReferingText:f.GetTextFieldTypeText(this.Type)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Worksheet",{get:function(){return this.Hpa&&this.Hpa.Parent},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){var e=this;e.Lqa=t,e.Type=f.GetTextFieldType(t.type),g(t.rPr)?e._font=new w(e.xc,e._font.ParentStateful):e._font.TextCharacterProperties_FromOOModel(t.rPr)},e.prototype.kLb=function(){return("{"+this.lLb(8)+"-"+this.lLb(4)+"-"+this.lLb(4)+"-"+this.lLb(4)+"-"+this.lLb(12)+"}").toUpperCase()},e.prototype.lLb=function(t){return Math.random().toString(16).slice(-t)},e.prototype.ToOOModel=function(){var t=this,e=t.Lqa||{elementType:l.TextParagraphElementType.TextField};return(g(e.id)||e.id&&!/{[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}}/.test(e.id))&&(e.id=this.kLb()),e.type=f.GetTextFieldTypeString(t.Type),g(e.rPr)&&(e.rPr={}),e.rPr=t._font.TextCharacterProperties_ToOOModel(),e.t=t.Text,e},e.prototype.UpdateTextByFormulas=function(t,e){this.asa.UpdateTextByFormulas(t,e)},e}(T),e.DrawingTextField=S,A=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.elementType=l.TextParagraphElementType.TextLineBreak,o}return N(e,t),Object.defineProperty(e.prototype,"Text",{get:function(){return"\r\n"},enumerable:!0,configurable:!0}),e.prototype.FromOOModel=function(t){this.Lqa=t},e.prototype.ToOOModel=function(){return this.Lqa||{elementType:l.TextParagraphElementType.TextLineBreak}},e}(T),e.DrawingLineBreak=A,I=function(){function t(t,e){var n=this;n.bsa=m,n.csa=" ",n.xc=t,n.Lpa=e,n._font=new w(t),n._font.ParentStateful=n.Lpa.Font,n.rM=[]}return Object.defineProperty(t.prototype,"SplitSpaceFlag",{get:function(){return this.csa},set:function(t){this.csa=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Text",{get:function(){var t,e,n,o="";for(t=0,e=this.rM;t<e.length;t++)n=e[t],g(n.Text)||(o+=n.Text);return o},set:function(t){this.Clear(),this.AddRun(t)},enumerable:!0,configurable:!0}),t.prototype.Get=function(t){return this.rM[t]},Object.defineProperty(t.prototype,"Count",{get:function(){return this.rM.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),t.prototype.AddRun=function(t,e){return this.AddRunInternal(t,e)},t.prototype.AddField=function(t){return this.AddFieldInternal(t)},t.prototype.Clear=function(){var t,e;for(t=0,e=this.rM;t<e.length;t++)e[t].Font.ParentStateful=m;this.rM.length=0},t.prototype.FromOOModel=function(t){var e,n,o,r,i,a,s,u=this;if(u.bsa=t,t.pPr&&t.pPr.defRPr&&u._font.TextCharacterProperties_FromOOModel(t.pPr.defRPr),t.elements)for(e=t.elements.length,n=u.rM=[],o=u.xc,r=0;r<e;r++)s=void 0,(a=(i=t.elements[r]).elementType)===l.TextParagraphElementType.RegularTextRun?s=new x(o,i.t,u):a===l.TextParagraphElementType.TextLineBreak?s=new A(o,u):a===l.TextParagraphElementType.TextField&&(s=new S(o,f.GetTextFieldType(i.type),u)),s&&(s.FromOOModel(i),n.push(s))},t.prototype.AddRunInternal=function(t,e){var n,o;return e===y&&(e=-1),n=new x(this.xc,t,this),o=this.rM,e<0||e>=o.length?o.push(n):o.splice(e,0,n),n},t.prototype.AddFieldInternal=function(t){var e=new S(this.xc,t,this);return this.rM.push(e),e},t.prototype.ToOOModel=function(){var t,e,n,o,r,i=this,a=i.bsa||{elements:[]};for(a.pPr||(a.pPr={}),t=a.pPr,g(i._font)||(t.defRPr=i._font.TextCharacterProperties_ToOOModel()),e=a.elements=[],n=0,r=(o=i.rM).length;n<r;n++)e.push(o[n].ToOOModel());return(i.xc.DrawingType===l.DrawingType.Chart||g(i.bsa))&&g(a.endParaRPr)&&(a.endParaRPr={}),a},t.prototype.To2016ChartOOModel=function(){var t,e,n,o,r,i=this,a=i.bsa||{elements:[]};for(a.pPr||(a.pPr={}),t=a.pPr,g(i._font)||(t.defRPr=i._font.TextCharacterProperties_ToOOModel()),e=a.elements=[],n=0,r=(o=i.rM).length;n<r;n++)e.push(o[n].ToOOModel());return g(i._font)||(a.endParaRPr=i._font.TextCharacterProperties_ToOOModel()),a},t.prototype.Delete=function(){var t,e=this;for(t=e.rM.length-1;t>=0;t--)e.DeleteElement(e.rM[t]);e.Lpa.DeleteParagraph(e),e.Lpa=m},t.prototype.DeleteElement=function(t){t.Font.ParentStateful=m;var e=this.rM.indexOf(t);e>=0&&this.rM.splice(e,1)},t}(),e.DrawingTextParagraph=I,R=function(){function t(t,e){this.dsa=[],this.esa=m,this.xc=t,this.Opa=e,this._font=new w(t,m,e),this.kO=void 0}return Object.defineProperty(t.prototype,"Text",{get:function(){var t,e,n="";for(t=0,e=this.dsa;t<e.length;t++)""!==n&&(n+="\r\n"),n+=e[t].Text;return n},set:function(t){this.Clear(),this.AddParagraph(t)},enumerable:!0,configurable:!0}),t.prototype.Get=function(t){return this.dsa[t]},Object.defineProperty(t.prototype,"Count",{get:function(){return this.dsa.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Font",{get:function(){return this._font},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Rotation",{get:function(){return this.kO},set:function(t){this.kO=t},enumerable:!0,configurable:!0}),t.prototype.setFontColor=function(t,e){var n,o=this,r=o.dsa.length;for(o._font&&o._font.Color.setColor(t,e),n=0;n<r;n++)o.dsa[n].Font.Color.setColor(t,e)},t.prototype.setFontTransparency=function(t){var e,n=this,o=n.dsa.length;for(n._font&&(n._font.Color.Transparency=t),e=0;e<o;e++)n.dsa[e].Font.Color.Transparency=t},t.prototype.updateFont=function(t,e,n,o){var r=[this._font];this.dsa.forEach((function(t){r.push(t.Font)})),r.forEach((function(r){r&&(r.Name=t,r.Size=e,r.Bold=n,r.Italic=o)}))},t.prototype.AddParagraph=function(t,e){var n,o;return e===y&&(e=-1),n=new I(this.xc,this),g(t)||n.AddRun(t),o=this.dsa,e<0||e>=o.length?o.push(n):o.splice(e,0,n),n},t.prototype.Clear=function(){var t,e;for(t=0,e=this.dsa;t<e.length;t++)e[t].Font.ParentStateful=m;this.dsa.length=0},t.prototype.ToOOModel=function(t){var e,n,o,r,i,a=this,s=a.esa||{p:[]},l=this.dsa,u=l.length;if(0===u&&!this._font.IsDirtyIncludingParent())return m;if(e=s.p=[],u>0)for(n=0;n<u;n++)o=l[n],e.push(t?o.To2016ChartOOModel():o.ToOOModel());else(r=new I(a.xc,a).ToOOModel()).pPr.defRPr=a._font.TextCharacterProperties_ToOOModel(),e.push(r);return g(s.bodyPr)&&(s.bodyPr={}),i=this.Rotation,g(i)||(s.bodyPr.rot=i),g(s.lstStyle)&&(s.lstStyle={}),s},t.prototype.FromOOModel=function(t){var e,n,o,r,i,a,s,l,u,f,h,p,d,y=this;for(y.esa=t,e=0,n=y.dsa;e<n.length;e++)n[e].Clear();if(y.dsa.length=0,o=new w(y.xc,m,y.Opa),(r=y._font)&&(r.SetParentForChildren(o),o.ParentStateful=r.ParentStateful,r.ParentStateful=m),y._font=o,t.p&&t.p.length)for(i=t.p[0].pPr,a=t.p[0].endParaRPr,s=void 0,i&&i.defRPr&&!c(i.defRPr)?s=i.defRPr:a&&!c(a)&&(s=a),s&&y._font.TextCharacterProperties_FromOOModel(s),l=0,u=t.p;l<u.length;l++)f=u[l],(h=new I(y.xc,y)).FromOOModel(f),y.dsa.push(h);(p=t.bodyPr)&&(d=p.rot,g(d)||(this.kO=d))},t.prototype.Delete=function(){for(var t=this.dsa,e=t.length-1;e>=0;e--)this.DeleteParagraph(t[e])},t.prototype.DeleteParagraph=function(t){t.Font.ParentStateful=m;var e=this.dsa.indexOf(t);e>=0&&this.dsa.splice(e,1)},t}(),e.DrawingTextBody=R,k=function(t){function e(e,n){var o=t.call(this)||this,r=o;return r.Format1=e,r.Format2=n,o}return N(e,t),Object.defineProperty(e.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Brightness",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.Brightness,!1)?t.Format2.Brightness:t.Format1.Brightness},set:function(t){this.Format1.Brightness=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorType",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.ColorType,!1)?t.Format2.ColorType:t.Format1.ColorType},set:function(t){this.Format1.ColorType=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ObjectThemeColor",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.ObjectThemeColor,!1)?t.Format2.ObjectThemeColor:t.Format1.ObjectThemeColor},set:function(t){this.Format1.ObjectThemeColor=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RGB",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.RGB,!1)?t.Format2.RGB:t.Format1.RGB},set:function(t){this.Format1.RGB=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TintAndShade",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(l.ColorFormatStates.TintAndShade,!1)?t.Format2.TintAndShade:t.Format1.TintAndShade},set:function(t){this.Format1.TintAndShade=t},enumerable:!0,configurable:!0}),e.prototype.GetState=function(){},e.prototype.SetState=function(){},e.prototype.IsDirtyIncludingParent=function(){},e.prototype.IsPropDirtyIncludingParent=function(t,e){return this.Stateful1.IsPropDirtyIncludingParent(t,e)||this.Stateful2.IsPropDirtyIncludingParent(t,e)},e.prototype.Dirty=function(){},e.prototype.UnDirty=function(){},e.prototype.SuspendClearChildrenState=function(){},e.prototype.ResumeClearChilrenState=function(){},e.prototype.AddChildInternal=function(){},e.prototype.RemoveChildInternal=function(){},e}(r.StatefullBase),e.ComboColorFormat=k,M=function(t){function e(e,n){var o=t.call(this)||this,r=o;return r.Format1=e,r.Format2=n,o}return N(e,t),Object.defineProperty(e.prototype,"Stateful1",{get:function(){return this.Format1},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Stateful2",{get:function(){return this.Format2},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Bold",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Bold,!1)?t.Format2.Bold:t.Format1.Bold},set:function(t){this.Format1.Bold=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return new k(this.Format1.Color,this.Format2.Color)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Italic",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Italic,!1)?t.Format2.Bold:t.Format1.Bold},set:function(t){this.Format1.Bold=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Name",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Name,!1)?t.Format2.Name:t.Format1.Name},set:function(t){this.Format1.Name=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Size",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Size,!1)?t.Format2.Size:t.Format1.Size},set:function(t){this.Format1.Size=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Strikethrough",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Strikethrough,!1)?t.Format2.Strikethrough:t.Format1.Strikethrough},set:function(t){this.Format1.Strikethrough=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Subscript",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Subscript,!1)?t.Format2.Subscript:t.Format1.Subscript},set:function(t){this.Format1.Subscript=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Superscript",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Superscript,!1)?t.Format2.Superscript:t.Format1.Superscript},set:function(t){this.Format1.Superscript=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ThemeFont",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.ThemeFont,!1)?t.Format2.ThemeFont:t.Format1.ThemeFont},set:function(t){this.Format1.ThemeFont=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Underline",{get:function(){var t=this;return!g(t.Format2)&&t.Stateful2.IsPropDirtyIncludingParent(b.Underline,!1)?t.Format2.Underline:t.Format1.Underline},set:function(t){this.Format1.Underline=t},enumerable:!0,configurable:!0}),e.prototype.GetState=function(){},e.prototype.SetState=function(){},e.prototype.IsDirtyIncludingParent=function(){},e.prototype.IsPropDirtyIncludingParent=function(t,e){return this.Stateful1.IsPropDirtyIncludingParent(t,e)||this.Stateful2.IsPropDirtyIncludingParent(t,e)},e.prototype.Dirty=function(){},e.prototype.UnDirty=function(){},e.prototype.SuspendClearChildrenState=function(){},e.prototype.ResumeClearChilrenState=function(){},e.prototype.AddChildInternal=function(){},e.prototype.RemoveChildInternal=function(){},e}(r.StatefullBase),e.ComboFontFormat=M},"./dist/plugins/floatingObject/drawing/gradient.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f;function h(t,e,n){var o=new c(t);return o.Position=e,o.Color=n,o}function p(t){return r.ARGBColor.FromArgb(t)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/common.js"),r=n("./dist/plugins/floatingObject/drawing/color.js"),i=n("./dist/plugins/floatingObject/drawing/colorFormat.js"),a=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),s=o.ShapeConstants.PositionConver,l=o.ShapeUtility,u=void 0,c=function(){function t(t){this.nzb=t,this.tE=new i.ColorFormat(this.nzb)}return Object.defineProperty(t.prototype,"Color",{get:function(){return this.tE},set:function(t){this.tE=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Position",{get:function(){return this.SH},set:function(t){this.SH=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Transparency",{get:function(){return this.tE.Transparency},set:function(t){this.tE.Transparency=t},enumerable:!0,configurable:!0}),t.prototype.FromOOModel=function(t){this.Position=t.pos/s,this.tE.FromOOModel(t)},t.prototype.ToOOModel=function(){var t=this.tE.ToOOModel();return t.pos=Math.round(this.Position*s),t},t}(),e.GradientStop=c,f=function(){function t(t){this.Nqa=t,this.Oqa=[]}return t.prototype.Item=function(t){return this.Oqa[t]},Object.defineProperty(t.prototype,"Count",{get:function(){return this.Oqa.length},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GradientStopList",{get:function(){return this.Oqa},enumerable:!0,configurable:!0}),t.prototype.Delete=function(t){-1===t&&(t=this.Count-1),this.Oqa.splice(t,1)},t.prototype.Insert=function(t,e,n,o,i){n===u&&(n=0),o===u&&(o=-1),i===u&&(i=0);var a=new c(this.Nqa);a.Color.RGB=r.ARGBColor.FromArgb(t),a.Position=e,a.Transparency=n,a.Color.Brightness=i,o<0?this.Oqa.push(a):this.Oqa.splice(o,0,a)},t.prototype.FromOOModel=function(t){var e,n,o,r;for(e=0,n=t.gs;e<n.length;e++)o=n[e],(r=new c(this.Nqa)).FromOOModel(o),this.GradientStopList.push(r)},t.prototype.ToOOModel=function(){var t,e,n,o={gs:[]};for(t=0,e=this.Oqa;t<e.length;t++)n=e[t],o.gs.push(n.ToOOModel());return o},t}(),e.GradientStops=f,l.InitGradientStopPresetColor=function(t,e){var n,o,r,s,l,u,c,f,d,g,m,y,v,C=e.GradientStops.GradientStopList;switch(e.PresetGradientType){case a.PresetGradientType.GradientEarlySunset:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),o=h(t,.3,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6684815))),r=h(t,.64999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12189798))),s=h(t,.89999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16711680))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16744960))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l);break;case a.PresetGradientType.GradientLateSunset:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(0))),o=h(t,.2,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(64))),r=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(4194368))),s=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(9371712))),l=h(t,.89999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15889152))),u=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16760576))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u);break;case a.PresetGradientType.GradientNightfall:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(0))),o=h(t,.39999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(660108))),r=h(t,.7,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1580231))),s=h(t,.88,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(7341524))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(9190801))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l);break;case a.PresetGradientType.GradientDaybreak:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6201087))),o=h(t,.39999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8766207))),r=h(t,.7,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12900075))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16772090))),C.push(n),C.push(o),C.push(r),C.push(s);break;case a.PresetGradientType.GradientHorizon:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14478325))),o=h(t,.08,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8628163))),r=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(7770041))),s=h(t,.21001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8628163))),l=h(t,.52,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),u=h(t,.56,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10249571))),c=h(t,.58,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8400941))),f=h(t,.71001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12603982))),d=h(t,.94,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15456980))),g=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(5580316))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f),C.push(d),C.push(g);break;case a.PresetGradientType.GradientDesert:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16555979))),o=h(t,.87,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16298057))),r=h(t,.78999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16298057))),s=h(t,.37,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16705522))),l=h(t,.33,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16339616))),u=h(t,.31,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12912713))),c=h(t,.17999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(11812485))),f=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16298057))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f);break;case a.PresetGradientType.GradientOcean:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(251048))),o=h(t,.25,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2217696))),r=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(34790))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(23743))),C.push(n),C.push(o),C.push(r),C.push(s);break;case a.PresetGradientType.GradientCalmWater:n=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13421823))),o=h(t,.41001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),r=h(t,.32,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10053375))),s=h(t,.195,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13408767))),l=h(t,.8999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),u=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13421823))),c=h(t,.59,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),f=h(t,.68,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10053375))),d=h(t,.805,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13408767))),g=h(t,.91001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10079487))),m=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13421823))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f),C.push(d),C.push(g),C.push(m);break;case a.PresetGradientType.GradientFire:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16773632))),o=h(t,.45,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16742912))),r=h(t,.7,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16712448))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(5048328))),C.push(n),C.push(o),C.push(r),C.push(s);break;case a.PresetGradientType.GradientFog:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8685764))),o=h(t,.53,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13950719))),r=h(t,.83,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13950719))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(9874324))),C.push(n),C.push(o),C.push(r),C.push(s);break;case a.PresetGradientType.GradientMoss:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14543823))),o=h(t,.25,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10270830))),r=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1403667))),s=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14543823))),l=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10270830))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l);break;case a.PresetGradientType.GradientPeacock:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3381759))),o=h(t,.16,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(52428))),r=h(t,.47,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10066431))),s=h(t,.60001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3041170))),l=h(t,.71001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3355596))),u=h(t,.81,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1143039))),c=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(26265))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c);break;case a.PresetGradientType.GradientWheat:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16509639))),o=h(t,.17999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16705522))),r=h(t,.36,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16435069))),s=h(t,.61,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16492925))),l=h(t,.82001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16503964))),u=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16705522))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u);break;case a.PresetGradientType.GradientParchment:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16773073))),o=h(t,.64999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15789013))),r=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13747103))),C.push(n),C.push(o),C.push(r);break;case a.PresetGradientType.GradientMahogany:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14070172))),o=h(t,.15,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13934188))),r=h(t,.35,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10900776))),s=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6696978))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(14070172))),u=h(t,.85,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13934188))),c=h(t,.65,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10900776))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c);break;case a.PresetGradientType.GradientRainbow:n=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10879915))),o=h(t,.395,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(530939))),r=h(t,.32499,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1740104))),s=h(t,.24,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16776960))),l=h(t,.135,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15613719))),u=h(t,.6,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15210342))),c=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10879915))),f=h(t,.60501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(530939))),d=h(t,.67501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(1740104))),g=h(t,.76,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16776960))),m=h(t,.865,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15613719))),y=h(t,.94,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15210342))),v=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10879915))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f),C.push(d),C.push(g),C.push(m),C.push(y),C.push(v);break;case a.PresetGradientType.GradientRainbowII:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16724889))),o=h(t,.25,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16737843))),r=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16776960))),s=h(t,.75,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(108431))),l=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(3368703))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l);break;case a.PresetGradientType.GradientGold:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15129772))),o=h(t,.12,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15128458))),r=h(t,.3,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13085772))),s=h(t,.45,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15128458))),l=h(t,.77,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13085772))),u=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15129772))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u);break;case a.PresetGradientType.GradientGoldII:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16508078))),o=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12423722))),r=h(t,.21001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12423722))),s=h(t,.63,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16508078))),l=h(t,.67,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(12423722))),u=h(t,.69,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8609303))),c=h(t,.82001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(10651977))),f=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16442295))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f);break;case a.PresetGradientType.GradientBrass:n=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),o=h(t,.87,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),r=h(t,.72,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),s=h(t,.57001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),l=h(t,.42,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),u=h(t,.28,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),c=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8541696))),f=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16754688))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f);break;case a.PresetGradientType.GradientChrome:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),o=h(t,.16,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2039583))),r=h(t,.17999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),s=h(t,.42,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6513507))),l=h(t,.53,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13619151))),u=h(t,.66,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13619151))),c=h(t,.75999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2039583))),f=h(t,.78999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),d=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8355711))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f),C.push(d);break;case a.PresetGradientType.GradientChromeII:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(13355979))),o=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6250335))),r=h(t,.21001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(6250335))),s=h(t,.63,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),l=h(t,.67,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(11711154))),u=h(t,.69,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(2697513))),c=h(t,.82001,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(7829367))),f=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15395562))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f);break;case a.PresetGradientType.GradientSilver:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))),o=h(t,.03501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),r=h(t,.16,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),s=h(t,.235,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),l=h(t,.42501,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),u=h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),c=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),f=h(t,.965,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),d=h(t,.84,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),g=h(t,.765,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(15132390))),m=h(t,.575,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(8225942))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f),C.push(d),C.push(g),C.push(m);break;case a.PresetGradientType.GradientSapphire:n=h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),o=h(t,.13,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),r=h(t,.28,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),s=h(t,.42999,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),l=h(t,.58,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),u=h(t,.72,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),c=h(t,.87,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(130))),f=h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(18431))),C.push(n),C.push(o),C.push(r),C.push(s),C.push(l),C.push(u),C.push(c),C.push(f)}},l.InitGradientStopTwoColor=function(t,e){var n,o,r=e.GradientStyle;return r===a.GradientStyle.GradientFromCenter?void this.InitGradientTwoColorCenterStops(t,e):r===a.GradientStyle.GradientFromCorner?void this.InitGradientTwoColorCornerStops(t,e):(n=e.GradientStops.GradientStopList,void(1===(o=e.GradientVariant)||2===o?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))))):3===o?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===o&&(n.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),n.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))))))},l.InitGradientTwoColorCornerStops=function(t,e){var n=e.GradientStops.GradientStopList;n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))))},l.InitGradientTwoColorCenterStops=function(t,e){var n=e.GradientStops.GradientStopList,o=e.GradientVariant;1===o?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215))))):2===o?(n.push(h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):3===o?(n.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,.5,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),n.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===o&&(n.push(h(t,0,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))),n.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),n.push(h(t,1,i.createColorFormatFromRGB(t,a.SolidColorType.RGB,p(16777215)))))},l.InitGradientOneColorCornerStops=function(t,e){var n=i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(e.GradientDegree)),o=e.GradientStops.GradientStopList;o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,n))},l.InitGradientOneColorCenterStops=function(t,e){var n=i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,this.GetTintAndShadeByDegree(e.GradientDegree)),o=e.GradientStops.GradientStopList,r=e.GradientVariant;1===r?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,n))):2===r?(o.push(h(t,0,n)),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):3===r?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,.5,n)),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===r&&(o.push(h(t,0,n)),o.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,n)))},l.InitGradientStopOneColor=function(t,e){var n,o,r,s=e.GradientStyle;return s===a.GradientStyle.GradientFromCenter?void this.InitGradientOneColorCenterStops(t,e):s===a.GradientStyle.GradientFromCorner?void this.InitGradientOneColorCornerStops(t,e):(n=this.GetTintAndShadeByDegree(e.GradientDegree),o=e.GradientStops.GradientStopList,void(1===(r=e.GradientVariant)||2===r?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,n)))):3===r?(o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,n))),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1)))):4===r&&(o.push(h(t,.5,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,0,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1))),o.push(h(t,1,i.createColorFormat(t,a.SolidColorType.Theme,a.ColorSchemeIndex.Accent1,n))))))},l.InitGradientStops=function(t,e,n){var o=this;if(e.Fpa(new f(t)),n===a.GradientColorType.GradientOneColor)o.InitGradientStopOneColor(t,e);else if(n===a.GradientColorType.GradientTwoColors)o.InitGradientStopTwoColor(t,e);else{if(n!==a.GradientColorType.GradientPresetColors)throw Error();o.InitGradientStopPresetColor(t,e)}e.GradientAngle=o.GetGradientAngle(e.GradientStyle,e.GradientVariant)}},"./dist/plugins/floatingObject/drawing/lineFormat.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function h(t,e,n){return t>=e&&t<=n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/stateful.js"),r=n("./dist/plugins/floatingObject/drawing/common.js"),i=n("./dist/plugins/floatingObject/drawing/fillFormat.js"),a=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),s=r.ChartUtility.umb,l=r.UnitHelper.isNullOrUndefined,u=null,c=function(t){function e(e,n,o){var r=t.call(this,n)||this,s=r;return s.Pqa=a.ArrowheadLength.medium,s.Qqa=a.ArrowheadStyle.none,s.Rqa=a.ArrowheadWidth.medium,s.Sqa=a.LineDashStyle.solid,s.Tqa=a.ArrowheadLength.medium,s.Uqa=a.ArrowheadStyle.none,s.Vqa=a.ArrowheadWidth.medium,s.Wqa=a.LineStyle.LineSingle,s.bz=!0,s.Xqa=-1,s.Yqa=u,s.xc=e,s.hqa=n,s.iqa=o,s.vmb=a.LineCapStyle.flat,s.wmb=a.LineJoinStyle.round,s.Zpa=new i.FillFormat(e,n&&n.FillInternal,o),r}return f(e,t),Object.defineProperty(e.prototype,"PatternColor",{get:function(){return this.FillInternal.PatternColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Color",{get:function(){return this.FillInternal.ColorInternal},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BeginArrowheadLength",{get:function(){return this.IsDirty(a.LineFormatStates.BeginArrowheadLength)||l(this.hqa)?this.Pqa:this.hqa.BeginArrowheadLength},set:function(t){this.Pqa=t,this.Dirty(a.LineFormatStates.BeginArrowheadLength)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BeginArrowheadStyle",{get:function(){return this.IsDirty(a.LineFormatStates.BeginArrowheadStyle)||l(this.hqa)?this.Qqa:this.hqa.BeginArrowheadStyle},set:function(t){this.Qqa=t,this.Dirty(a.LineFormatStates.BeginArrowheadStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"BeginArrowheadWidth",{get:function(){return this.IsDirty(a.LineFormatStates.BeginArrowheadWidth)||l(this.hqa)?this.Rqa:this.hqa.BeginArrowheadWidth},set:function(t){this.Rqa=t,this.Dirty(a.LineFormatStates.BeginArrowheadWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DashStyle",{get:function(){return this.IsDirty(a.LineFormatStates.DashStyle)||l(this.hqa)?this.Sqa:this.hqa.DashStyle},set:function(t){h(t,0,11)&&(this.Sqa=t,this.Dirty(a.LineFormatStates.DashStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CapStyle",{get:function(){return this.IsDirty(a.LineFormatStates.CapStyle)||l(this.hqa)?this.vmb:this.hqa.CapStyle},set:function(t){h(t,0,2)&&(this.vmb=t,this.Dirty(a.LineFormatStates.CapStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"JoinStyle",{get:function(){return this.IsDirty(a.LineFormatStates.JoinStyle)||l(this.hqa)?this.wmb:this.hqa.JoinStyle},set:function(t){h(t,0,2)&&(this.wmb=t,this.Dirty(a.LineFormatStates.JoinStyle))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndArrowheadLength",{get:function(){return this.IsDirty(a.LineFormatStates.EndArrowheadLength)||l(this.hqa)?this.Tqa:this.hqa.EndArrowheadLength},set:function(t){this.Tqa=t,this.Dirty(a.LineFormatStates.EndArrowheadLength)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndArrowheadStyle",{get:function(){return this.IsDirty(a.LineFormatStates.EndArrowheadStyle)||l(this.hqa)?this.Uqa:this.hqa.EndArrowheadStyle},set:function(t){this.Uqa=t,this.Dirty(a.LineFormatStates.EndArrowheadStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"EndArrowheadWidth",{get:function(){return this.IsDirty(a.LineFormatStates.EndArrowheadWidth)||l(this.hqa)?this.Vqa:this.hqa.EndArrowheadWidth},set:function(t){this.Vqa=t,this.Dirty(a.LineFormatStates.EndArrowheadWidth)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"InsetPen",{get:function(){return this.IsDirty(a.LineFormatStates.InsetPen)||l(this.hqa)?this.Zqa:this.hqa.InsetPen},set:function(t){this.Zqa=t,this.Dirty(a.LineFormatStates.InsetPen)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Pattern",{get:function(){return this.FillInternal.Pattern},set:function(t){this.FillInternal.uqa(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetGradientType",{get:function(){return this.FillInternal.PresetGradientType},enumerable:!0,configurable:!0}),e.prototype.xqa=function(t){this.FillInternal.xqa(t)},Object.defineProperty(e.prototype,"GradientAngle",{get:function(){return this.FillInternal.GradientAngle},set:function(t){this.FillInternal.GradientAngle=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientColorType",{get:function(){return this.FillInternal.GradientColorType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientDegree",{get:function(){return this.FillInternal.GradientDegree},enumerable:!0,configurable:!0}),e.prototype.pqa=function(t){this.FillInternal.pqa(t)},Object.defineProperty(e.prototype,"GradientStops",{get:function(){return this.FillInternal.GradientStops},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"GradientStyle",{get:function(){return this.FillInternal.GradientStyle},enumerable:!0,configurable:!0}),e.prototype.rqa=function(t){this.FillInternal.rqa(t)},Object.defineProperty(e.prototype,"GradientVariant",{get:function(){return this.FillInternal.GradientVariant},enumerable:!0,configurable:!0}),e.prototype.tqa=function(t){this.FillInternal.tqa(t)},Object.defineProperty(e.prototype,"Style",{get:function(){return this.IsDirty(a.LineFormatStates.Style)||l(this.hqa)?this.Wqa:this.hqa.Style},set:function(t){this.Wqa=t,this.Dirty(a.LineFormatStates.Style)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Transparency",{get:function(){return this.FillInternal.Transparency},set:function(t){this.FillInternal.Transparency=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){return this.IsDirty(a.LineFormatStates.Visible)||l(this.hqa)?this.bz:this.hqa.Visible},set:function(t){this.bz=t,this.Dirty(a.LineFormatStates.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Weight",{get:function(){return this.IsDirty(a.LineFormatStates.Weight)||l(this.hqa)?this.Xqa:this.hqa.Weight},set:function(t){this.Xqa=t,this.Dirty(a.LineFormatStates.Weight)},enumerable:!0,configurable:!0}),e.prototype.OneColorGradient=function(t,e,n){this.FillInternal.OneColorGradient(t,e,n)},e.prototype.TwoColorGradient=function(t,e){this.FillInternal.TwoColorGradient(t,e)},e.prototype.PresetGradient=function(t,e,n){this.FillInternal.PresetGradient(t,e,n)},e.prototype.Solid=function(){this.FillInternal.Solid()},e.prototype.Patterned=function(t){this.FillInternal.Patterned(t)},Object.defineProperty(e.prototype,"FillInternal",{get:function(){var t=this;return t.Zpa||(t.Zpa=new i.FillFormat(t.xc,t.hqa&&t.hqa.FillInternal,t.iqa)),t.Zpa},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Type",{get:function(){return this.FillInternal.Type},enumerable:!0,configurable:!0}),e.prototype.GetState=function(e,n){var o=this.Zpa;if(o){if(e===a.LineFormatStates.Color&&o.Color)return o.Color.IsDirtyIncludingParent(n);if(e===a.LineFormatStates.PatternColor&&o.PatternColor)return o.PatternColor.IsDirtyIncludingParent(n)}return t.prototype.GetState.call(this,e,n)},e.prototype.IsDirtyIncludingParent=function(e){var n=this.Zpa;return!(!n||!n.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},e.prototype.OnParentChanged=function(t){this.hqa=t;var e=this.Zpa;e&&t&&(e.ParentStateful=t.FillInternal)},e.prototype.FromOOModel=function(t){this.Yqa=t,this.FromCT_LineProperties(t)},e.prototype.ToOOModel=function(){return this.ToCT_LineProperties()},e.prototype.FromCT_LineProperties=function(t){var e=this;l(t.solidFill)?l(t.pattFill)?l(t.gradFill)?l(t.noFill)||(e.FillInternal.ColorInternal.ColorType=a.SolidColorType.None):e.FillInternal.FromOOModel(t.gradFill,a.ColorFillType.GradientFillProperties):e.FillInternal.FromOOModel(t.pattFill,a.ColorFillType.PatternFillProperties):e.FillInternal.FromOOModel(t.solidFill,a.ColorFillType.SolidColorFillProperties),l(t.headEnd)||e.FromCT_LineEndProperties(t.headEnd),l(t.tailEnd)||e.FromCT_TailLineEndProperties(t.tailEnd),!l(t.w)&&t.w>=0?e.Weight=t.w:l(t.solidFill)&&l(t.gradFill)?(e.Xqa=-1,e.UnDirty(a.LineFormatStates.Weight)):e.Weight=1,l(t.cmpd)||(e.Style=t.cmpd),e.Round=!!t.round,l(t.prstDash)?e.UnDirty(a.LineFormatStates.DashStyle):e.DashStyle=t.prstDash,l(t.cap)||(e.CapStyle=t.cap),t.bevel?e.JoinStyle=a.LineJoinStyle.bevel:t.round?e.JoinStyle=a.LineJoinStyle.round:t.miter&&(e.JoinStyle=a.LineJoinStyle.miter)},e.prototype.ToCT_LineProperties=function(){var t,e,n,o,r=this,i=r.Yqa;return r.IsDirtyIncludingParent()||l(i)?(s(t=i||{}),r.bz?l(r.Zpa)||((e=r.Zpa.ToOOModel()).colorFillType===a.ColorFillType.SolidColorFillProperties?t.solidFill=e:e.colorFillType===a.ColorFillType.PatternFillProperties?t.pattFill=e:e.colorFillType===a.ColorFillType.GradientFillProperties?t.gradFill=e:e.colorFillType===a.ColorFillType.NoFillProperties&&(t.noFill=!0),delete e.colorFillType):t.noFill=!0,(n=r.ToCT_HeadLineEndProperties())&&(t.headEnd=n),(n=r.ToCT_TailLineEndProperties())&&(t.tailEnd=n),r.Weight>=0&&(t.w=r.Weight),r.GetState(a.LineFormatStates.Style,!0)&&(t.cmpd=r.Style),r.GetState(a.LineFormatStates.DashStyle,!0)&&(t.prstDash=r.DashStyle),r.Round&&(t.round=!0),r.GetState(a.LineFormatStates.CapStyle,!0)&&(t.cap=r.CapStyle),delete t.bevel,delete t.round,delete t.miter,r.GetState(a.LineFormatStates.JoinStyle,!0)&&((o=r.JoinStyle)===a.LineJoinStyle.bevel?t.bevel={}:o===a.LineJoinStyle.round?t.round=!0:o===a.LineJoinStyle.miter&&(t.miter={lim:0})),t):i},e.prototype.FromCT_LineEndProperties=function(t){var e=this;e.Qqa=t.type,e.Rqa=t.w,e.Pqa=t.len,e.SetState(a.LineFormatStates.BeginArrowheadStyle,!0),e.SetState(a.LineFormatStates.BeginArrowheadWidth,!0),e.SetState(a.LineFormatStates.BeginArrowheadLength,!0)},e.prototype.ToCT_HeadLineEndProperties=function(){var t={w:a.ArrowheadWidth.medium,len:a.ArrowheadLength.medium},e=this,n=!1;return e.GetState(a.LineFormatStates.BeginArrowheadStyle,!0)&&(t.type=e.BeginArrowheadStyle,n=!0),e.GetState(a.LineFormatStates.BeginArrowheadWidth,!0)&&(t.w=e.BeginArrowheadWidth,n=!0),e.GetState(a.LineFormatStates.BeginArrowheadLength,!0)&&(t.len=e.BeginArrowheadLength,n=!0),n?t:u},e.prototype.FromCT_TailLineEndProperties=function(t){if(!l(t)){var e=this;e.Uqa=t.type,e.Vqa=t.w,e.Tqa=t.len,e.SetState(a.LineFormatStates.EndArrowheadStyle,!0),e.SetState(a.LineFormatStates.EndArrowheadWidth,!0),e.SetState(a.LineFormatStates.EndArrowheadLength,!0)}},e.prototype.ToCT_TailLineEndProperties=function(){var t={w:a.ArrowheadWidth.medium,len:a.ArrowheadLength.medium},e=!1,n=this;return n.GetState(a.LineFormatStates.EndArrowheadStyle,!0)&&(t.type=n.EndArrowheadStyle,e=!0),n.GetState(a.LineFormatStates.EndArrowheadWidth,!0)&&(t.w=n.EndArrowheadWidth,e=!0),n.GetState(a.LineFormatStates.EndArrowheadLength,!0)&&(t.len=n.EndArrowheadLength,e=!0),e?t:u},e.prototype.Clone=function(){var t=this,n=new e(t.xc);return n.Zpa=t.Zpa&&t.Zpa.Clone(),n.Pqa=t.Pqa,n.Qqa=t.Qqa,n.Rqa=t.Rqa,n.Sqa=t.Sqa,n.Tqa=t.Tqa,n.Uqa=t.Uqa,n.Vqa=t.Vqa,n.Zqa=t.Zqa,n.bz=t.bz,n.Xqa=t.Xqa,n.rpa=t.rpa,n.hqa=t.hqa,n},e}(o.StatefullBase),e.LineFormat=c},"./dist/plugins/floatingObject/drawing/picture.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/stateful.js"),r=n("./dist/plugins/floatingObject/drawing/common.js"),i=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),a=r.ShapeConstants.PositionConver,s=r.ShapeUtility.FromLum,l=r.ShapeUtility.ToLum,u=r.UnitHelper.isNullOrUndefined,c=null,f=void 0,h=function(){function t(t){var e=this;e.qva=0,e.rva=0,e.sva=0,e.tva=0,e.xo=t}return Object.defineProperty(t.prototype,"PictureHeight",{get:function(){return this.tva},set:function(t){this.tva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PictureOffsetX",{get:function(){return this.qva},set:function(t){this.qva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PictureOffsetY",{get:function(){return this.rva},set:function(t){this.rva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"PictureWidth",{get:function(){return this.sva},set:function(t){this.sva=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeHeight",{get:function(){return this.xo.Height},set:function(t){this.xo.Height=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeLeft",{get:function(){return this.xo.Left},set:function(t){this.xo.Left=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeTop",{get:function(){return this.xo.Top},set:function(t){this.xo.Top=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ShapeWidth",{get:function(){return this.xo.Width},set:function(t){this.xo.Width=t},enumerable:!0,configurable:!0}),t.prototype.Clone=function(){var e=this,n=new t(e.xo);return n.tva=e.tva,n.qva=e.qva,n.rva=e.rva,n.sva=e.sva,n},t}(),e.Crop=h,p=function(t){function e(e,n){var o;return e===f&&(e=i.PictureFormatType.PictureShape),n===f&&(n=c),(o=t.call(this,n)||this).Jqa=r.ShapeConstants.DefaultBrightness,o.Xba=i.PictureColorType.PictureAutomatic,o.uva=r.ShapeConstants.DefaultBrightness,o.vva=r.ShapeConstants.DefaultTransparent,o.wva=e,o.hqa=n,o.xva=o.wva===i.PictureFormatType.PictureShape,o}return d(e,t),Object.defineProperty(e.prototype,"Brightness",{get:function(){return this.IsDirty(1)||u(this.hqa)?this.Jqa:this.hqa.Brightness},set:function(t){if(t<0||t>1)throw Error();this.Jqa=t,this.Dirty(1)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ColorType",{get:function(){return this.IsDirty(2)||u(this.hqa)?this.Xba:this.hqa.ColorType},set:function(t){t===i.PictureColorType.PictureAutomatic?(this.Jqa=r.ShapeConstants.DefaultBrightness,this.uva=r.ShapeConstants.DefaultBrightness):t===i.PictureColorType.PictureWatermark&&(this.Jqa=.85,this.uva=.15),this.Xba=t,this.Dirty(2)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Contrast",{get:function(){return this.IsDirty(4)||u(this.hqa)?this.uva:this.hqa.Contrast},set:function(t){if(t<0||t>1)throw Error();this.uva=t,this.Dirty(4)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Crop",{get:function(){var t=this;return t.yva||(t.yva=new h(t.zva)),t.yva},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropBottom",{get:function(){return this.Crop.ShapeTop+this.Crop.ShapeHeight},set:function(t){this.Crop.ShapeHeight=t-this.Crop.ShapeTop},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropLeft",{get:function(){return this.Crop.ShapeLeft},set:function(t){this.Crop.ShapeLeft=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropRight",{get:function(){return this.Crop.ShapeLeft+this.Crop.ShapeWidth},set:function(t){this.Crop.ShapeWidth=t-this.Crop.ShapeLeft},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"CropTop",{get:function(){return this.Crop.ShapeTop},set:function(t){this.Crop.ShapeTop=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TransparencyColor",{get:function(){return this.IsDirty(8)||u(this.hqa)?this.vva:this.hqa.TransparencyColor},set:function(t){this.vva=t,this.Dirty(8)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"TransparentBackground",{get:function(){return this.IsDirty(16)||u(this.hqa)?this.xva:this.hqa.TransparentBackground},set:function(t){this.xva=t;var e=this.zva.Fill;t&&(e.Transparency=1),e.Solid(),this.Dirty(16)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Container",{get:function(){return this.zva},set:function(t){if(this.zva=t,t){var e=this.Crop;e.PictureWidth=t.Width,e.PictureHeight=t.Height}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PicFill",{get:function(){return this.IsDirty(32)||u(this.hqa)?this.Ava:this.hqa.PicFill},set:function(t){this.Ava=t,this.Dirty(32)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PicType",{get:function(){return this.IsDirty(64)||u(this.hqa)?this.Bva:this.hqa.PicType},set:function(t){this.Bva=t,this.Dirty(64)},enumerable:!0,configurable:!0}),e.prototype.ClearModel=function(){var t,e;for(this.Tpa=c,t=0,e=this.Children;t<e.length;t++)e[t].ClearModel()},Object.defineProperty(e.prototype,"PictureFormatType",{get:function(){return this.wva},set:function(t){this.wva=t},enumerable:!0,configurable:!0}),e.prototype.HasOwnPicture=function(){return this.IsDirty(1)||this.IsDirty(2)||this.IsDirty(4)||this.IsDirty(8)||this.IsDirty(16)},e.prototype.SetPictureInfo=function(t,e,n){this.PicFill=t,this.PicType=e,this.PictureFormatType=n},e.prototype.IncrementBrightness=function(t){this.Brightness+=t},e.prototype.IncrementContrast=function(t){this.Contrast+=t},e.prototype.FromOOModel=function(t){var e,n=this;n.Tpa=t,u(t)||(n.FromCT_Blip(t.blip),e=n.zva,u(e)||(u(t.tile)||(n.PictureFormatType=i.PictureFormatType.TextureFill),n.Crop.PictureWidth=e.Width,n.Crop.PictureHeight=e.Height,n.PictureFormatType===i.PictureFormatType.PictureShape?n.FromCT_RelativeRect(t.srcRect):n.PictureFormatType===i.PictureFormatType.PictureFill&&n.FromCT_RelativeRect(t.stretch.fillRect)))},e.prototype.ToOOModel=function(){var t,e,n=this,o=n.Tpa||{};return o.colorFillType=i.ColorFillType.BlipFillProperties,o.blip=n.ToCT_Blip(),t=n.zva,u(t)||((e=n.PictureFormatType)===i.PictureFormatType.PictureShape?(o.srcRect=n.ToCT_RelativeRect(),o.stretch={},o.stretch.fillRect={l:0,r:0,t:0,b:0}):e===i.PictureFormatType.PictureFill?(o.stretch={},o.stretch.fillRect=n.ToCT_RelativeRect(),o.srcRect={l:0,r:0,t:0,b:0}):e===i.PictureFormatType.TextureFill&&(o.stretch=c,o.srcRect=c)),o},e.prototype.FromCT_Blip=function(t){if(!u(t)){var e=this;e.FromCT_ColorChangeEffect(t.clrChange),e.FromCT_LuminanceEffect(t.lum),u(t.grayscl)?u(t.biLevel)||(e.ColorType=i.PictureColorType.PictureBlackAndWhite):e.ColorType=i.PictureColorType.PictureGrayscale,e.FromCT_BlipBlob(t.blipBlob)}},e.prototype.ToCT_Blip=function(){var t=this,e=t.Tpa&&t.Tpa.blip||{cstate:i.ST_BlipCompression.none};return t.TransparencyColor!==r.ShapeConstants.DefaultTransparent&&(e.clrChange=t.ToCT_ColorChangeEffect()),t.Brightness===r.ShapeConstants.DefaultBrightness&&t.Contrast===r.ShapeConstants.DefaultBrightness||(e.lum=t.ToCT_LuminanceEffect()),t.ColorType===i.PictureColorType.PictureGrayscale?e.grayscl={}:t.ColorType===i.PictureColorType.PictureBlackAndWhite&&(e.biLevel={thresh:5e4}),e.blipBlob=t.ToCT_BlipBlob(),e},e.prototype.FromCT_ColorChangeEffect=function(t){t&&t.clrFrom&&t.clrFrom.srgbClr&&this.FromColorByteArr(t.val)},e.prototype.ToCT_ColorChangeEffect=function(){var t=this.ToColorByteArr(this.vva);return{useA:!0,clrFrom:{srgbClr:{val:t}},clrTo:{srgbClr:{val:t,alpha:[0]}}}},e.prototype.FromColorByteArr=function(t){this.vva=0|t[2]<<16|t[1]<<8|t[0]},e.prototype.ToColorByteArr=function(t){var e=[];return e[3]=Math.floor(t/(1<<24)),t%=1<<24,e[2]=Math.floor(t/65536),t%=65536,e[1]=Math.floor(t/256),t%=256,e[0]=Math.floor(t),e},e.prototype.FromCT_LuminanceEffect=function(t){t&&(this.Brightness=s(t.bright),this.Contrast=s(t.contrast))},e.prototype.ToCT_LuminanceEffect=function(){return{bright:l(this.Brightness),contrast:l(this.Contrast)}},e.prototype.FromCT_BlipBlob=function(t){if(t){var e=this;e.Ava=t.blob,e.Dirty(32),e.Bva=t.type,e.Dirty(64)}},e.prototype.ToCT_BlipBlob=function(){var t=this,e=t.Tpa&&t.Tpa.blip&&t.Tpa.blip.blipBlob||{type:i.ImageType.PNG};return e.blob=t.PicFill,e.type=t.PicType,e},e.prototype.FromCT_RelativeRect=function(t){var e,n,o,r,i,s,l,c=this.zva;u(t)||u(c)||(e=t.l/a,n=t.r/a,o=t.t/a,r=t.b/a,s=(i=this.Crop).PictureWidth=c.Width/(1-e-n),l=i.PictureHeight=c.Height/(1-o-r),i.PictureOffsetX=(s-c.Width)/2-e*s,i.PictureOffsetY=(l-c.Height)/2-o*l)},e.prototype.ToCT_RelativeRect=function(){var t,e,n,o,r=this.zva,i=this.Crop,s=i.ShapeHeight,l=i.ShapeWidth;return u(r)||0===s||0===l?{l:0,r:0,t:0,b:0}:(t=i.PictureWidth,e=i.PictureHeight,n=i.PictureOffsetX,o=i.PictureOffsetY,{l:((t-l)/2-n)/t*a,r:((t-l)/2+n)/t*a,t:((e-s)/2-o)/e*a,b:((e-s)/2+o)/e*a})},e.prototype.Clone=function(){var t=this,n=new e;return n.Jqa=t.Jqa,n.uva=t.uva,n.Xba=t.Xba,t.yva&&(n.yva=t.yva.Clone()),n.Ava=t.Ava,n.wva=t.wva,n.Bva=t.Bva,n.zva=t.zva,n.vva=t.vva,n.xva=t.xva,n},e.prototype.OnParentChanged=function(t){this.hqa=t},e}(o.StatefullBase),e.PictureFormat=p},"./dist/plugins/floatingObject/drawing/stateful.js":function(t,e,n){"use strict";var o,r,i;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common").Common.j,r=o.Fa,i=function(){function t(t){var e=this;e.oi=[],e.qpa=0,e.rpa=0,e.spa=t,e.spa&&e.spa.AddChildInternal(e)}return t.prototype.SetState=function(t,e){var n=this,o=t;e?n.rpa|=o:n.rpa&=~o,n.IsClearChildrenStateSuspended||n.oi.forEach((function(e){e.SetState(t,!1)}))},t.prototype.GetState=function(t,e){var n=this,o=t,i=(o&n.rpa)===o;return i||!e||r(n.spa)||(i=n.spa.GetState(t,!0)),i},t.prototype.OnStateChanged=function(t){},t.prototype.Dirty=function(t){this.SetState(t,!0)},t.prototype.UnDirty=function(t){this.SetState(t,!1)},t.prototype.UnDirtyAll=function(){this.rpa=0},t.prototype.IsDirty=function(t){return this.GetState(t)},t.prototype.IsPropDirtyIncludingParent=function(t,e){var n=this;return!!n.GetState(t)||!(!e||r(n.spa))&&n.spa.IsPropDirtyIncludingParent(t,!0)},t.prototype.IsDirtyIncludingParent=function(t){var e=this;return e.rpa>0||!(!t||r(e.spa))&&e.spa.IsDirtyIncludingParent(!0)},t.prototype.AddChildInternal=function(t){var e=this.oi;-1===e.indexOf(t)&&e.push(t)},t.prototype.RemoveChildInternal=function(t){var e=this.oi,n=e.indexOf(t);-1!==n&&e.splice(n,1)},t.prototype.SetParentForChildren=function(t){this.oi.slice(0).forEach((function(e){e.ParentStateful=t}))},t.prototype.OnParentChanged=function(t){},t.prototype.SuspendClearChildrenState=function(){this.qpa++},t.prototype.ResumeClearChilrenState=function(){this.qpa--},Object.defineProperty(t.prototype,"ParentStateful",{get:function(){return this.spa},set:function(t){var e=this;t!==e.spa&&(e.spa&&e.spa.RemoveChildInternal(this),e.spa=t,e.spa&&e.spa.AddChildInternal(this),e.OnParentChanged(t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Children",{get:function(){return this.oi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"IsClearChildrenStateSuspended",{get:function(){return this.qpa>0},enumerable:!0,configurable:!0}),t}(),e.StatefullBase=i},"./dist/plugins/floatingObject/drawing/threeDFormat.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/floatingObject/drawing/common.js"),r=n("./dist/plugins/floatingObject/drawing/stateful.js"),i=n("./dist/plugins/floatingObject/drawing/drawingInterface.js"),a=o.ShapeConstants.PositiveFixedAngleConvert,s=o.UnitHelper.isNullOrUndefined,function(t){t[t.BevelBottomDepth=1]="BevelBottomDepth",t[t.BevelBottomInset=2]="BevelBottomInset",t[t.BevelBottomType=4]="BevelBottomType",t[t.BevelTopDepth=8]="BevelTopDepth",t[t.BevelTopInset=16]="BevelTopInset",t[t.BevelTopType=32]="BevelTopType",t[t.ContourColor=64]="ContourColor",t[t.ContourWidth=128]="ContourWidth",t[t.Depth=256]="Depth",t[t.ExtrusionColor=512]="ExtrusionColor",t[t.ExtrusionColorType=1024]="ExtrusionColorType",t[t.FieldOfView=2048]="FieldOfView",t[t.LightAngle=4096]="LightAngle",t[t.Perspective=8192]="Perspective",t[t.PresetCamera=16384]="PresetCamera",t[t.PresetExtrusionDirection=32768]="PresetExtrusionDirection",t[t.PresetLighting=65536]="PresetLighting",t[t.PresetLightingDirection=131072]="PresetLightingDirection",t[t.PresetLightingSoftness=262144]="PresetLightingSoftness",t[t.PresetMaterial=524288]="PresetMaterial",t[t.PresetThreeDFormat=1048576]="PresetThreeDFormat",t[t.ProjectText=2097152]="ProjectText",t[t.RotationX=4194304]="RotationX",t[t.RotationY=8388608]="RotationY",t[t.RotationZ=16777216]="RotationZ",t[t.Visible=33554432]="Visible",t[t.Z=67108864]="Z",t[t.AutoScale=134217728]="AutoScale",t[t.DepthPercent=268435456]="DepthPercent",t[t.HeightPercent=536870912]="HeightPercent",t[t.RightAngleAxes=1073741824]="RightAngleAxes"}(l=e.ThreeDFormatStates||(e.ThreeDFormatStates={})),function(t){t[t.ExtrusionColorAutomatic=0]="ExtrusionColorAutomatic",t[t.ExtrusionColorCustom=1]="ExtrusionColorCustom"}(u||(u={})),c=null,f=function(t){function e(e,n){var r=t.call(this,n)||this,a=r;return a.$qa=o.BevelType.BevelNone,a._qa=o.BevelType.BevelNone,a.ara=u.ExtrusionColorAutomatic,a.bra=45,a.bz=!0,a.cra=c,a.dra=!0,a.era=100,a.fra=100,a.gra=!0,a.xc=e,a.hra=30,a.hqa=n,a.ira(i.PresetCamera.PresetCameraNone),r}return h(e,t),e.prototype.ira=function(t){this.jra=t,this.Dirty(l.PresetCamera)},e.prototype.InitDicCameraType=function(){var t=this.cra=[];t[i.PresetCamera.CameraLegacyObliqueTopLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueTop]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueTopRight]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueFront]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueRight]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueBottomLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueBottom]=[0,0,0],t[i.PresetCamera.CameraLegacyObliqueBottomRight]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveTopLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveTop]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveTopRight]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveFront]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveRight]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveBottomLeft]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveBottom]=[0,0,0],t[i.PresetCamera.CameraLegacyPerspectiveBottomRight]=[0,0,0],t[i.PresetCamera.CameraOrthographicFront]=[0,0,0],t[i.PresetCamera.CameraIsometricTopUp]=[314.7191,324.6037,60.16242],t[i.PresetCamera.CameraIsometricTopDown]=[45.28088,324.6037,299.8376],t[i.PresetCamera.CameraIsometricBottomUp]=[45.28088,35.39627,60.16242],t[i.PresetCamera.CameraIsometricBottomDown]=[314.7191,35.39627,299.8376],t[i.PresetCamera.CameraIsometricLeftUp]=[45,325,0],t[i.PresetCamera.CameraIsometricLeftDown]=[45,35,0],t[i.PresetCamera.CameraIsometricRightUp]=[315,35,0],t[i.PresetCamera.CameraIsometricRightDown]=[315,325,0],t[i.PresetCamera.CameraIsometricOffAxis1Left]=[64,18,0],t[i.PresetCamera.CameraIsometricOffAxis1Right]=[334,18,0],t[i.PresetCamera.CameraIsometricOffAxis1Top]=[306.5457,301.2619,57.6425],t[i.PresetCamera.CameraIsometricOffAxis2Left]=[26,18,0],t[i.PresetCamera.CameraIsometricOffAxis2Right]=[296,18,0],t[i.PresetCamera.CameraIsometricOffAxis2Top]=[53.45424,301.2619,302.3575],t[i.PresetCamera.CameraIsometricOffAxis3Left]=[64,342,0],t[i.PresetCamera.CameraIsometricOffAxis3Right]=[334,342,0],t[i.PresetCamera.CameraIsometricOffAxis3Bottom]=[306.5457,58.73808,302.3575],t[i.PresetCamera.CameraIsometricOffAxis4Left]=[26,342,0],t[i.PresetCamera.CameraIsometricOffAxis4Right]=[296,342,0],t[i.PresetCamera.CameraIsometricOffAxis4Bottom]=[53.45424,58.73808,57.64252],t[i.PresetCamera.CameraObliqueTopLeft]=[0,0,0],t[i.PresetCamera.CameraObliqueTop]=[0,0,0],t[i.PresetCamera.CameraObliqueTopRight]=[0,0,0],t[i.PresetCamera.CameraObliqueLeft]=[0,0,0],t[i.PresetCamera.CameraObliqueRight]=[0,0,0],t[i.PresetCamera.CameraObliqueBottomLeft]=[0,0,0],t[i.PresetCamera.CameraObliqueBottom]=[0,0,0],t[i.PresetCamera.CameraObliqueBottomRight]=[0,0,0],t[i.PresetCamera.CameraPerspectiveFront]=[0,0,0],t[i.PresetCamera.CameraPerspectiveLeft]=[20,0,0],t[i.PresetCamera.CameraPerspectiveRight]=[340,0,0],t[i.PresetCamera.CameraPerspectiveAbove]=[0,340,0],t[i.PresetCamera.CameraPerspectiveBelow]=[0,20,0],t[i.PresetCamera.CameraPerspectiveAboveLeftFacing]=[14.33758,39.30647,341.1238],t[i.PresetCamera.CameraPerspectiveAboveRightFacing]=[345.6624,39.30647,18.87615],t[i.PresetCamera.CameraPerspectiveContrastingLeftFacing]=[43.93887,10.39642,356.4465],t[i.PresetCamera.CameraPerspectiveContrastingRightFacing]=[316.0611,10.39642,3.553517],t[i.PresetCamera.CameraPerspectiveHeroicLeftFacing]=[14.29302,348.9837,2.626817],t[i.PresetCamera.CameraPerspectiveHeroicRightFacing]=[345.7069,348.9837,357.3732],t[i.PresetCamera.CameraPerspectiveHeroicExtremeLeftFacing]=[34.46068,8.12245,357.0914],t[i.PresetCamera.CameraPerspectiveHeroicExtremeRightFacing]=[325.5393,8.12245,2.9086],t[i.PresetCamera.CameraPerspectiveRelaxed]=[0,309.5601,0],t[i.PresetCamera.CameraPerspectiveRelaxedModerately]=[0,324.844,0]},e.prototype.SetPresetCamera=function(t){this.jra=t,this.Dirty(l.PresetCamera)},e.prototype.UpdatePresetCamera=function(){this.jra===i.PresetCamera.PresetCameraNone&&this.SetPresetCamera(i.PresetCamera.CameraOrthographicFront)},e.prototype.IncrementRotationX=function(t){this.RotationX+=t},e.prototype.IncrementRotationY=function(t){this.RotationY+=t},e.prototype.IncrementRotationZ=function(t){this.RotationZ+=t},e.prototype.ResetRotation=function(){var t=this;t.RotationX=0,t.RotationY=0,t.RotationZ=0},e.prototype.Clone=function(){var t=this,n=new e(t.xc);return n.pra=t.pra,n.qra=t.qra,n.$qa=t.$qa,n.rra=t.rra,n.sra=t.sra,n._qa=t._qa,s(t.tra)||(n.tra=t.tra.Clone()),n.ura=t.ura,n.ora=t.ora,s(t.vra)||(n.vra=t.vra.Clone()),n.ara=t.ara,n.bra=t.bra,n.wra=t.wra,n.hra=t.hra,n.jra=t.jra,n.xra=t.xra,n.yra=t.yra,n.zra=t.zra,n.Ara=t.Ara,n.Bra=t.Bra,n.Cra=t.Cra,n.Dra=t.Dra,n.kra=t.kra,n.lra=t.lra,n.mra=t.mra,n.bz=t.bz,n.nra=t.nra,n.rpa=t.rpa,n.hqa=t.hqa,n},e.prototype.IsDirtyIncludingParent=function(e){var n=this;return!(!n.tra||!n.tra.IsDirtyIncludingParent(e))||!(!n.vra||!n.vra.IsDirtyIncludingParent(e))||t.prototype.IsDirtyIncludingParent.call(this,e)},e.prototype.OnParentChanged=function(t){var e=this;e.hqa=t,s(e.hqa)&&(e.tra&&(e.tra.ParentStateful=c),e.vra&&(e.vra.ParentStateful=c))},e.prototype.FromOOModel=function(t){var e=this;e.Lqa=t,e.FromCT_Scene3D(e.Lqa.Scene3D),e.FromCT_View3D(e.Lqa.View3D),e.FromCT_Shape3D(e.Lqa.Shape3D)},e.prototype.ToOOModel=function(t){var e=this,n=e.Lqa||{};return n.View3D=e.ToCT_View3D(),e.PresetCamera!==i.PresetCamera.PresetCameraNone&&(n.Scene3D=e.ToCT_Scene3D()),(e.IsPropDirtyIncludingParent(l.Depth,!0)||e.IsPropDirtyIncludingParent(l.Z,!0))&&(n.Shape3D=e.ToCT_Shape3D()),n},e.prototype.FromCT_View3D=function(t){var e=this;s(t)||(s(t.hPercent)||(e._HeightPercent=t.hPercent),s(t.depthPercent)||(e._DepthPercent=t.depthPercent),s(t.rotX)||(e.RotationY=t.rotX),s(t.rotY)||(e.RotationX=t.rotY),s(t.rAngAx)?e._RightAngleAxes=!1:e._RightAngleAxes=t.rAngAx,s(t.perspective)||(e.Perspective=t.perspective/2))},e.prototype.ToCT_View3D=function(){var t=this,e=t.Lqa&&t.Lqa.View3D||{};return!t._AutoScale&&t.IsDirty(l.HeightPercent)&&(e.hPercent=t._HeightPercent),t.IsDirty(l.DepthPercent)&&(e.depthPercent=t._DepthPercent),t.IsDirty(l.RotationY)&&(e.rotX=t.RotationY),t.IsDirty(l.RotationX)&&(e.rotY=t.RotationX),t.IsDirty(l.RightAngleAxes)&&(e.rAngAx=t._RightAngleAxes),!t._RightAngleAxes&&t.IsDirty(l.Perspective)&&(e.perspective=2*t.Perspective),e},e.prototype.FromCT_Scene3D=function(t){s(t)||this.FromCT_Camera(t.camera)},e.prototype.ToCT_Scene3D=function(){var t=this,e=t.Lqa,n=e&&e.Scene3D||{};return n.camera=t.ToCT_Camera(),!s(n.camera)&&s(n.lightRig)&&(n.lightRig=t.ToDefaultCT_LightRig()),s(n.camera)&&s(n.backdrop)&&s(n.lightRig)?c:n},e.prototype.GetActualCT_Scene3D=function(){var t=this;return s(t.Lqa)||s(t.Lqa.Scene3D)?s(t.hqa)?c:t.GetActualCT_Scene3D():t.Lqa.Scene3D},e.prototype.FromCT_Shape3D=function(t){var e=this;s(t)||(0!==t.extrusionH&&(e.Depth=t.extrusionH,e.Dirty(l.Depth)),0!==t.z&&(e.Z=t.z,e.Dirty(l.Z)))},e.prototype.ToCT_Shape3D=function(){var t=this,e=t.Lqa,n=e&&e.Shape3D||{z:0,extrusionH:0,contourW:0,prstMaterial:i.ST_PresetMaterialType.warmMatte};return n.extrusionH=t.Depth,n.z=t.Z,n},e.prototype.ToDefaultCT_LightRig=function(){return{rig:i.LightRigType.LightRigThreePoint,dir:i.PresetLightingDirection.LightingTopLeft}},e.prototype.FromCT_Camera=function(t){s(t)||(this.ira(t.prst),s(t.rot)||this.FromCameraCT_SphereCoords(t.rot))},e.prototype.ToCT_Camera=function(){var t,e,n=this;return n.xc.DrawingType===i.DrawingType.Shape||n.xc.DrawingType===i.DrawingType.GroupShape?((t={zoom:1e5}).prst=n.PresetCamera,t.rot=n.ToCameraCT_SphereCoords(),t):(e=n.Lqa)&&e.Scene3D&&e.Scene3D.camera||c},e.prototype.FromCameraCT_SphereCoords=function(t){var e=this;s(t)||(e.RotationX=t.lon/a,e.RotationY=t.lat/a,e.RotationZ=t.rev/a)},e.prototype.ToCameraCT_SphereCoords=function(){var t,e,n,o,r=this;return 0===r.RotationX&&0===r.RotationY&&0===r.RotationZ?c:(t={},e=r.RotationX,n=r.RotationY,o=r.RotationZ,t.lon=e*a,t.lat=n*a,t.rev=o*a,t)},Object.defineProperty(e.prototype,"Perspective",{get:function(){var t=this;return t.Dirty(l.Perspective),s(t.hqa)?t.hra:t.hqa.Perspective},set:function(t){this.hra=t,this.Dirty(l.Perspective)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"PresetCamera",{get:function(){var t=this;return t.Dirty(l.PresetCamera),s(t.hqa)?t.jra:t.hqa.PresetCamera},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotationX",{get:function(){var t=this;return t.Dirty(l.RotationX),s(t.hqa)?t.Visible?t.kra:0:t.hqa.RotationX},set:function(t){var e=this;t!==e.kra&&(e.kra=t,e.Dirty(l.RotationX),e.UpdatePresetCamera())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotationY",{get:function(){var t=this;return t.Dirty(l.RotationY),s(t.hqa)?t.Visible?t.lra:0:t.hqa.RotationY},set:function(t){var e=this;if(e.xc.DrawingType===i.DrawingType.Chart){if(t<-90&&t>=180)return}else if(t<0&&t>=360)return;e.lra=t,e.Dirty(l.RotationY),e.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"RotationZ",{get:function(){var t=this;return t.Dirty(l.RotationZ),s(t.hqa)?t.Visible?t.mra:0:t.hqa.RotationZ},set:function(t){var e=this;t!==e.mra&&(e.mra=t,e.Dirty(l.RotationZ),e.UpdatePresetCamera())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Visible",{get:function(){var t=this;return t.Dirty(l.Visible),s(t.hqa)?t.bz:t.hqa.Visible},set:function(t){this.bz=t,this.Dirty(l.Visible)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Z",{get:function(){var t=this;return t.Dirty(l.Z),s(t.hqa)?t.Visible?t.nra:0:t.hqa.Z},set:function(t){var e=this;e.nra=t,e.Dirty(l.Z),e.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"Depth",{get:function(){var t=this;return t.Dirty(l.Depth),s(t.hqa)?t.Visible?t.ora:0:t.hqa.Depth},set:function(t){var e=this;e.ora=t,e.Dirty(l.Depth),e.UpdatePresetCamera()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"DicCameraType",{get:function(){var t=this;return s(t.cra)&&t.InitDicCameraType(),t.cra},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_InternalVisible",{get:function(){return this.bz},set:function(t){this.bz=t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_AutoScale",{get:function(){return this.dra},set:function(t){this.dra=t,this.Dirty(l.AutoScale)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_DepthPercent",{get:function(){return this.era},set:function(t){t>=20&&t<=2e3&&(this.era=t,this.Dirty(l.DepthPercent))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_HeightPercent",{get:function(){return this.fra},set:function(t){t>=5&&t<=500&&(this.fra=t,this.Dirty(l.HeightPercent))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"_RightAngleAxes",{get:function(){return this.gra},set:function(t){this.gra=t,this.Dirty(l.RightAngleAxes)},enumerable:!0,configurable:!0}),e}(r.StatefullBase),e.ThreeDFormat=f},"./dist/plugins/floatingObject/floatingobject-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function L(t){var e=t.wr,n=!1;return e&&e.zR().forEach((function(t){t&&t[I]()&&(n=!0)})),n}function B(t){var e,n=t,o=n.kj;return!!n.canUndo()&&(n.Lz(o,!0),e=r.Commands.bWa(o.name()),o.ITa.undo(n.VQ[e]),n.Mz(o,!0),!0)}function G(t){var e=[];return t.wr.zR().forEach((function(t){t[I]()&&e.push(t[R]())})),e}function H(t,e,n){var o,r,a,s,u=t.BR(),c=u.fromSheet;for(u.fromSheet=t,u.isCutting=n,o=new i.yR,r=0,a=0;a<l(e);a++)(s=t.wr.NR(e[a]))&&(o.push(s),r++);return c&&(c.CR=null),t.CR=o,r>0}function V(t){var e;switch(t.typeName){case"0":case"1":break;case"2":e="Chart "}return e}function z(t){var e=[];return t.wr.zR().forEach((function(t){t[I]()&&e.push(t[R]())})),e}function W(t){return function(e,n){var o,i,a=r.Commands.bT(e,n),s=0;return t===P.left?s=-1:t===P.right&&(s=1),o=0,t===P.up?o=-1:t===P.down&&(o=1),i=G(a),l(i)>0&&a.wu().execute({cmd:b,sheetName:a.name(),floatingObjects:i,offsetX:s,offsetY:o})}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("./dist/plugins/floatingObject/floatingobject.js"),a=r.GC$,s=a.isArray,l=o.Common.k.ac,u=Math.min,c=o.Common.j.Fa,f="unSelectAllFloatingObjects",h="deleteFloatingObjects",p="navigationNextFloatingObject",d="navigationPreviousFloatingObject",g="cutFloatingObjects",m="copyFloatingObjects",y="pasteFloatingObjects",v="dragCopyFloatingObjects",C="selectAllFloatingObjects",b="moveFloatingObjects",w="moveFloatingObjectsUp",T="moveFloatingObjectsDown",x="moveFloatingObjectsLeft",S="moveFloatingObjectsRight",A="resizeFloatingObjects",I="isSelected",R="name",k=r.Commands.h4,M=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _(e,t),e.prototype.canExecute=function(){return!!L(this.kj)},e.prototype.canUndo=function(){var t=r.Commands.bWa(this.kj.name()),e=this.VQ[t],n=e&&e.CUa;return!!(n&&l(n)>0)||!!((n=e&&e.EUa)&&l(n)>0)},e}(r.Commands.ActionBase),e.FloatingObjectUndoActionBase=M,N=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.execute=function(){var t,e,n,o,i,a=this,u=!1,c=a.kj,f=a.VQ,h=f.floatingObjects;if(a.canExecute()&&s(h)){for(c.ITa.startTransaction(),a.Lz(c,!0),t=c.wr,e=0,n=l(h);e<n;e++)(o=t.NR(h[e]))&&(i=c.slicers,a.zS(o)&&i&&i.vV(o[R]()),t.Fb(h[e],!0),o[I](!1));c.GJ(),a.Mz(c,!0),f[r.Commands.bWa(c.name())]=c.ITa.endTransaction(),u=l(h)>0}return u},e.prototype.undo=function(){var t,e=this,n=e.VQ,o=e.kj;return!!e.canUndo()&&(e.Lz(o,!0),t=r.Commands.bWa(o.name()),o.ITa.undo(n[t]),o.EJ(),e.Mz(o,!0),!0)},e.prototype.zS=function(t){return t&&"Slicer"===t.typeName},e}(M),e.DeleteFloatingObjectUndoAction=N,E=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.canExecute=function(){return!0},e.prototype.execute=function(){var t,e,n,o,i,a=this,u=!1,c=a.VQ,f=c.floatingObjects,h=a.kj;if(a.canExecute()&&s(f)){for(h.ITa.startTransaction(),a.Lz(h,!0),t=h.wr,e=0,n=l(f);e<n;e++)(o=t.NR(f[e])).allowMove()&&(i=o.position(),o.position(new r.Point(i.x+c.offsetX,i.y+c.offsetY)));a.Mz(h,!0),c[r.Commands.bWa(h.name())]=h.ITa.endTransaction(),u=l(f)>0}return u},e.prototype.undo=function(){return B(this)},e}(M),e.MovingFloatingObjectUndoAction=E,D=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.execute=function(){var t,e,n,o,i,a=this,u=!1,c=a.VQ,f=c.floatingObjects,h=a.kj;if(function(t,e){var n,o,r=l(e);if(l(e)>0)for(n=0;n<r;n++)(o=t.wr.NR(e[n]))&&o.isSelected(!0)}(h,f),a.canExecute()&&s(f)){for(h.ITa.startTransaction(),a.Lz(h,!0),t=h.wr,e=0,n=l(f);e<n;e++)i=(o=t.NR(f[e])).position(),o.width(o.width()+c.offsetWidth),o.height(o.height()+c.offsetHeight),o.position(new r.Point(i.x+c.offsetX,i.y+c.offsetY));a.Mz(h,!0),c[r.Commands.bWa(h.name())]=h.ITa.endTransaction(),u=l(f)>0}return u},e.prototype.undo=function(){return B(this)},e}(M),e.ResizingFloatingObjectUndoAction=D,O=function(t){function e(){var e=t.call(this)||this;return e.kj=null,e}return _(e,t),e.prototype.canExecute=function(){var t=this.VQ.floatingObjects;return!!(l(t)>0&&this.ES(t))},e.prototype.canUndo=function(){var t=r.Commands.bWa(this.kj.name()),e=this.VQ[t],n=e&&e.CUa;return!!(n&&l(n)>0)},e.prototype.ES=function(t){var e,n,o,r=this.kj,i=r.wr;for(e=0,n=l(t);e<n;e++)if((o=i.NR(t[e]))&&!r.ER(o))return!1;return!0},e.prototype.zS=function(t){return t&&"Slicer"===t.typeName},e}(r.Commands.ActionBase),e.FloatingObjectCopyPasteUndoAction=O,j=function(t){function e(e,n){var o=t.call(this)||this,r=o;return r.OFFSET=15,r.kj=e,r.VQ=n,c(n.clipboardFloatingObjectData)&&(n.clipboardFloatingObjectData=n.fromSheet.CR),o}return _(e,t),e.prototype.execute=function(){var t,e,n,o,i,a,s,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,k,M,N,E,D,O,j,F,P=this,_=P.VQ,B=_.floatingObjects;if(P.canExecute()){for(t=P.kj,e=_.fromSheet,t.ITa.startTransaction(),P.Lz(t,!0),n=[],o=t.wr,i=_.clipboardFloatingObjectData,void 0===_.Jl&&(L(t)&&o.zR().forEach((function(t){t&&t[I]()&&n.push(t)})),_.Jl=P.kj.getActiveRowIndex(),_.GS=P.kj.getActiveColumnIndex()),L(t)&&o.zR().forEach((function(t){t&&t[I]()&&t[I](!1)})),a=[],s=void 0,c=void 0,h=f=Number.MAX_VALUE,p=f,d=[],c=l(B),s=0;s<c;s++)g=i.find(B[s]).position(),h=u(h,g.x),p=u(p,g.y),d.push(new r.Point(g.x-h,g.y-p));if(m=0,y=0,n.length)v=f,C=f,n.forEach((function(t){if(t){var e=t.position();v=u(v,e.x),C=u(C,e.y)}})),m=v<f?v+P.OFFSET:0,y=C<f?C+P.OFFSET:0;else{for(b=0;b<_.Jl;b++)y+=t.Yr(b,3);for(w=0;w<_.GS;w++)m+=t.$r(w,3)}for(c=l(B),s=0;s<c;s++)T=d[s],a.push(new r.Point(m+T.x,y+T.y));for(x=_.isCutting,S=e.wr,A=[],k=[],c=l(B),s=0;s<c;s++)(N=(M=i.find(B[s])).clone(t)).sheet(t),A.push(N),k.push(M);if(E=!1,D={sheet:t,sheetName:t.name(),objects:A,cancel:!1},t.Wq(r.Events.ClipboardPasting,D),!D.cancel){for(s=0;s<c;s++)N=A[s],O=void 0,j=!1,M=k[s],!x||S.NR(B[s])||o.NR(B[s])?(j=N.name()===M.name())&&(F=V(N),O=P.zS(N)?t.slicers.HS(N[R]()):o.FS(F)):O=M.name(),j&&N[R](O),P.zS(N)&&(t.slicers.Cz(N),N.width(M.width()),N.height(M.height())),N.isVisible(!0),N.position(a[s]),N[I](!0),o.Sb(N);t.Wq(r.Events.ClipboardPasted,{sheet:t,sheetName:t.name(),objects:A}),E=!0}return P.Mz(t,!0),_[r.Commands.bWa(t.name())]=t.ITa.endTransaction(),E||(_.vgc=!0),E}return!1},e.prototype.undo=function(){var t,e,n=this;return!!n.canUndo()&&(t=n.kj,n.Lz(t,!0),e=r.Commands.bWa(t.name()),t.ITa.undo(n.VQ[e]),n.Mz(t,!0),!0)},e}(O),e.ClipboardPasteFloatingObjectUndoAction=j,F=function(t){function e(e,n){var o=t.call(this)||this,r=o;return r.kj=e,r.VQ=n,o}return _(e,t),e.prototype.execute=function(){var t,e,n,o,i,a,s,u,c=this,f=!1,h=c.VQ,p=h.floatingObjects,d=c.kj;if(c.canExecute()){for(d.ITa.startTransaction(),c.Lz(d,!0),t=d.wr,e=l(p),n=0;n<e;n++)(o=t.NR(p[n]))&&((i=o.clone(d)).sheet(d),a=o.position(),i.position(new r.Point(a.x+h.offsetX,a.y+h.offsetY)),i[R](t.FS()),i[I](!0),o[I](!1),c.zS(i)&&d.slicers&&(s=i,u=d.slicers.HS(s.columnName()),s[R](u),d.slicers.Cz(s)),t.Sb(i));c.Mz(d,!0),h[r.Commands.bWa(d.name())]=d.ITa.endTransaction(),f=!0}return f},e.prototype.undo=function(){var t,e=this,n=e.kj;return!!e.canUndo()&&(e.Lz(n,!0),t=r.Commands.bWa(n.name()),n.ITa.undo(e.VQ[t]),e.Mz(n,!0),!0)},e}(O),e.DragCopyFloatingObjectUndoAction=F,r.Commands[f]={canUndo:!1,execute:function(t,e){var n=r.Commands.bT(t,e);return!!L(n)&&(n.suspendPaint(),n.uQ(),n.GJ(),n.resumePaint(),!0)}},r.Commands[C]={canUndo:!1,execute:function(t,e){var n=r.Commands.bT(t,e);n.isEditing()||(n.suspendPaint(),n.wr.zR().forEach((function(t){t[I](!0)})),n.resumePaint())}},r.Commands[h]={canUndo:!0,execute:function(t,e,n){var o,i=r.Commands.bT(t,e);return n||(e.cmd||(e.cmd=h),e.floatingObjects||(o=G(i),e.floatingObjects=o)),l(e.floatingObjects)>0&&k(t,N,e,n)}},r.Commands[p]={canUndo:!1,execute:function(t,e){var n,o,i,a,s,l,u,c=r.Commands.bT(t,e);if(L(c)){for(c.suspendPaint(),n=void 0,o=void 0,i=void 0,a=void 0,l=(s=c.wr.zR()).length,a=0;a<l;a++){if(u=s[a],o||(o=u),n){i=u;break}u&&u[I]()&&(n=u)}return c.uQ(),i||(i=o),i&&i[I](!0),c.resumePaint(),!0}return!1}},r.Commands[d]={canUndo:!1,execute:function(t,e){var n,o,i,a,s,l,u=r.Commands.bT(t,e);if(L(u)){for(u.suspendPaint(),n=void 0,o=void 0,i=void 0,s=(a=u.wr.zR()).length,i=0;i<s;i++)if(l=a[i],n||(n=l),n[I]())o=l;else if(l[I]()||(o=l),l[I]())break;return o&&(u.uQ(),o[I](!0)),u.resumePaint(),!0}return!1}},r.Commands[g]={canUndo:!1,execute:function(t,e){var n,o,i,a,s=r.Commands.bT(t,e),u=z(s);if(l(u)>0){if(n=u.map((function(t){return s.wr.NR(t)})),o={sheet:s,sheetName:s.name(),objects:n,cancel:!1},s.Wq(r.Events.ClipboardChanging,o),!o.cancel)return H(s,u,!0)&&(s.Sob&&s.Sob(),r.Commands.Yxb(s.parent)),i={cmd:h,sheetName:s.name(),floatingObjects:u},a=s.wu().execute(i),s.Wq(r.Events.ClipboardChanged,{sheet:s,sheetName:s.name(),objects:n}),a;e.vgc=!0}return!1}},r.Commands[m]={canUndo:!1,execute:function(t,e){var n,o,i,a=r.Commands.bT(t,e),s=z(a);if(l(s)>0){if(n=s.map((function(t){return a.wr.NR(t)})),o={sheet:a,sheetName:a.name(),objects:n,cancel:!1},a.Wq(r.Events.ClipboardChanging,o),!o.cancel)return(i=H(a,s,!1))&&(a.Sob&&a.Sob(),r.Commands.Yxb(a.parent)),a.Wq(r.Events.ClipboardChanged,{sheet:a,sheetName:a.name(),objects:n}),i;e.vgc=!0}return!1}},r.Commands[y]={canUndo:!0,execute:function(t,e,n){var o,i,a,s,u=r.Commands.bT(t,e);return!u.isEditing()&&(!!(a=(i=(o=u.BR()).fromSheet)&&i.CR)&&(s=[],a.each((function(t){s.push(t[R]())})),0!==l(s)&&!u.Js&&(n||(e.cmd||(e.cmd=y),e.floatingObjects||(e.floatingObjects=s,e.fromSheet=i,e.isCutting=o.isCutting)),l(e.floatingObjects)>0&&k(t,j,e,n))))}},r.Commands[v]={canUndo:!0,execute:function(t,e,n){return k(t,F,e,n)}},function(t){t[t.left=0]="left",t[t.up=1]="up",t[t.right=2]="right",t[t.down=3]="down"}(P||(P={})),r.Commands[x]=W(P.left),r.Commands[w]=W(P.up),r.Commands[S]=W(P.right),r.Commands[T]=W(P.down),r.Commands[b]={canUndo:!0,execute:function(t,e,n){return(0!==e.offsetX||0!==e.offsetY)&&k(t,E,e,n)}},r.Commands[A]={canUndo:!0,execute:function(t,e,n){return k(t,D,e,n)}},r.Commands.JR=function(t){var e=r.Ul.sl(),n=!e,o=e;t.register(f,r.Commands[f],27,!1,!1,!1,!1),t.register(C,r.Commands[C],65,n,!1,!1,o),t.register(h,r.Commands[h],e?8:46,!1,!1,!1,!1),t.register(p,r.Commands[p],9,!1,!1,!1,!1),t.register(d,r.Commands[d],9,!1,!0,!1,!1),t.register(g,r.Commands[g],88,n,!1,!1,o),t.register(m,r.Commands[m],67,n,!1,!1,o),t.register(v,r.Commands[v]),t.register(y,r.Commands[y],86,n,!1,!1,o),t.register(b,r.Commands[b]),t.register(w,r.Commands[w],38,!1,!1,!1,!1),t.register(T,r.Commands[T],40,!1,!1,!1,!1),t.register(x,r.Commands[x],37,!1,!1,!1,!1),t.register(S,r.Commands[S],39,!1,!1,!1,!1),t.register(A,r.Commands[A])}},"./dist/plugins/floatingObject/floatingobject-touch.js":function(t,e,n){"use strict";var o,r,i,a,s,l;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Touch"),r=n("Core"),i=n("./dist/plugins/floatingObject/floatingobject.js"),a=r.Ul.nl,s=function(){function t(t,e,n){var r,i,a=this;a.yM=new o.jR(a),a.DQ=new o.kR(t,"FL_"+e.name,a.yM,2,200),a.BQ=n,a.CQ=new l(t,e),r=a.CQ,(i=a.DQ)._M=function(){return e.YR.isSelected()},i.bN=function(){return!0},i.dN=function(t){return r.jQ(t)},i.eN=function(t){return r.lQ(t)},i.fN=function(t){return r.pQ(t)},i.hN=function(t){return r.qQ(t)},i.iN=function(t){return r.sQ(t)}}return t.prototype.EQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!0)},t.prototype.FQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!1)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),l=function(){function t(t,e){var n=this;n.MS=e,n.YR=e.YR,n.NS=t,n.hQ=new o.TP(e.kj)}return t.prototype.OS=function(t){var e,n=new o.oP(t.X,t.Y),i=r.GC$(this.NS).offset();return i&&(e=document.body,n.X+=i.left+e.clientLeft||0,n.Y+=i.top+e.clientTop||0),n},t.prototype.jQ=function(t){t.DO=3},t.prototype.lQ=function(t,e){var n=this,o=e?t.rN:n.OS(t.rN);n.MS.AD({target:t.GP,isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}}),e||n.hQ.OP()},t.prototype.pQ=function(t,e){var n=this,o=e?t.rN:n.OS(t.rN),r=t.dP.rO,i=n.MS.kj,a=i.parent;1!==r&&a&&a.options.allowUserZoom&&!e?(i.mm.O3=!1,n.MS.rS(),n.hQ.PP(r)):n.MS.BD({isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}})},t.prototype.qQ=function(t,e){var n=this,o=e?t.rN:n.OS(t.rN),r=t.dP.rO,i=n.MS.kj.parent;1!==r&&i&&i.options.allowUserZoom&&!e?n.hQ.SP(r):this.MS.CD({isTouch:!0,button:0,pageX:o.X,pageY:o.Y,stopPropagation:function(){}})},t.prototype.sQ=function(e,n){var o,i=this,a={e:{rN:n?e.rN:i.OS(e.rN)},r:null};if(t.ao(i,"preProcessTapped",a),!a.r)try{(o=i.MS.kj).suspendPaint(),i.YR.isSelected()||(o.uQ(),i.YR.isSelected(!0),o.Wq(r.Events.FloatingElementSelected,{type:"floatingObject"}),r.Vl.Zl(o)),o.clearSelection()}finally{o.resumePaint()}},t}(),e.FloatingObjectTouchEventHandler=l,r.Zn(l),r.Rxb.touch&&i.FloatingObjectRender.$n("touch",{init:function(t){var e=this;(e.wR=new s(t,e,e.kj.parent.BQ)).EQ()},dispose:function(){var t=this.wR;t&&t.FQ()},preProcessMouseDown:function(t){var e=t.e,n=this.wR;n&&!e.isTouch&&n.GQ(e)&&(a(e),t.r=!0)},preProcessMouseMove:function(t){var e=t.e,n=this.wR;n&&!e.isTouch&&n.IQ(e)&&(a(e),t.r=!0)},preProcessMouseUp:function(t){var e=t.e,n=this.wR;n&&!e.isTouch&&n.HQ(e)&&(a(e),t.r=!0)}})},"./dist/plugins/floatingObject/floatingobject.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/floatingObject/picture.js")),o(n("./dist/plugins/floatingObject/floatingobject.js")),o(n("./dist/plugins/floatingObject/floatingobject-actions.js")),o(n("./dist/plugins/floatingObject/floatingobject-touch.js")),o(n("./dist/plugins/floatingObject/floatingobject.ns.js"));var r=n("./dist/plugins/floatingObject/drawing/chart.ns.js");e.Drawing=r},"./dist/plugins/floatingObject/floatingobject.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt;function ot(t,e,n,o,r){var i=r[R.mHc](),a=r[R.oHc](),s=r[R.qHc](),l=r[R.sHc]();return t<=i&&e<=a&&n>=s&&o>=l}function rt(t,e){var n=this;return e||(e={}),o.GC$.each(t,(function(t,o){var r=n[o],i=r.call(n);r.isDefault(i)||(e[o]=i)})),e}function it(t,e){if(e){var n=this;o.GC$.each(t,(function(t,o){e[o]!==w&&n[o].call(n,e[o],!1)}))}}function at(t){var e=t;return function(t,n){var o=this,r=o.sheet();e===R.$Hc&&(o.KR=!0),r&&r.$p(),o.onPropertyChanged(e,t,n)}}function st(t){var e=t;return function(t,n){var o=this,r=o.sheet();r&&(ut(o),r.$p()),o.onPropertyChanged(e,t,n)}}function lt(t){var e=t;return function(t,n){var o=this,r=o.sheet();r&&(bt(o),r.$p()),o.onPropertyChanged(e,t,n)}}function ut(t){var e,n,r,i,a=t.sheet();function s(e,n,o,r){var i=0,s=e.call(t);return i=n.call(t,a,0,s),ct.call(t,e,o,r),i+o.call(t)}a&&(e=s(t[R.mHc],ft,t[R.nHc],a.getRowHeight),n=s(t[R.oHc],ht,t[R.pHc],a.getColumnWidth),r=t.x(),i=t.y(),r===n&&i===e||(t.x(n,!1),t.y(e,!1),t.onPropertyChanged("position",new o.Point(n,e),new o.Point(r,i))))}function ct(t,e,n){var o=this,r=e.call(o),i=n.call(o.sheet(),t.call(o),3);i>0&&i--,r>i&&e.call(o,i,!1)}function ft(t,e,n,o){var r,i=0;for(r=e;r<n&&!((i+=t.getRowHeight(r,3))>o);r++);return i}function ht(t,e,n,o){var r,i=0;for(r=e;r<n&&!((i+=t.getColumnWidth(r,3))>o);r++);return i}function pt(t){var e=t.sheet();function n(e,n,o,r,i){var a=gt(t,e,n),s=a.index;r.call(t,a.offset,!1),-1===a.offset&&(s+=1,r.call(t,0),s===i&&(s=i-1)),o.call(t,s,!1)}e&&(n(!0,t.y(),t[R.mHc],t[R.nHc],e.getRowCount()),n(!1,t.x(),t[R.oHc],t[R.pHc],e.getColumnCount()))}function dt(t){function e(e,n,o,r){var i=gt(t,e,n);o.call(t,i.index,!1),r.call(t,i.offset,!1)}t.sheet()&&(e(!0,t.y()+t[R.jGc](),t[R.qHc],t[R.rHc]),e(!1,t.x()+t[R.iGc](),t[R.sHc],t[R.tHc]))}function gt(t,e,n){var o,r,i=0,a=0,s=t.sheet(),l=e?s.getRowCount():s.getColumnCount();for(o=0;o<l;o++){if((a=(i+=r=e?s.getRowHeight(o,3):s.getColumnWidth(o,3))-n)>0){a=a>0?r-a:-1;break}if(0===a){a=0,o+=1;break}}return o>=l&&(o=l-1,a=e?s.getRowHeight(o,3):s.getColumnWidth(o,3)),{offset:a,index:o}}function mt(t,e){t&&(t.style.zIndex=e+"")}function yt(t){var e=t.PR;return f(e)&&(e=t.Cka),e}function vt(t){var e=t.sheet();t.isNeedToUpdateLayout=!0,e.QP(e.Dr())}function Ct(t,e,n){return n&&n.width>0&&n.height>0&&(n.x===t||n.y===e||n.contains(t,e))}function bt(t){var e,n,o,r,i=t.sheet();function a(e,n,o,r,a,s){var l=0,u=e.call(t),c=n.call(t);return l=o.call(t,i,u,c),u===c?(ct.call(t,n,s,r),l=s.call(t)-a.call(t)):(r.call(i,u,3)>0&&(l-=a.call(t)),ct.call(t,n,s,r),l+=s.call(t)),l}i&&(e=a(t[R.mHc],t[R.qHc],ft,i.getRowHeight,t[R.nHc],t[R.rHc]),(n=a(t[R.oHc],t[R.sHc],ht,i.getColumnWidth,t[R.pHc],t[R.tHc]))<0&&(n=0),e<0&&(e=0),(o=t[R.iGc]())!==n&&(t[R.iGc](n,!1),t.onPropertyChanged(R.iGc,n,o)),(r=t[R.jGc]())!==e&&(t[R.jGc](e,!1),t.onPropertyChanged(R.jGc,e,r)))}function wt(t){return X.indexOf(t)>=0}function Tt(t){return function(e,n){this.onPropertyChanged(t,e,n)}}function xt(t,e){return function(n,o){var r=this,i=r.sheet();i&&(e&&It(r),Rt(r),Nt(r),i.$p()),r.onPropertyChanged(t,n,o)}}function St(t,e,n,o){var r=this,i=t.call(r),a=e.call(r);n<=i?r.dynamicMove()&&(t.call(r,i+o),e.call(r,a+o)):n<a&&r.dynamicSize()&&e.call(r,a+o)}function At(t,e,n,o,r,i,a){var s,l=this,u=t.call(l),c=n.call(l);r<=u?a<u?l.dynamicMove()&&(t.call(l,u-i),n.call(l,c-i)):a<c&&(s=c-u+1-(a-u+1),l.dynamicMove()&&(t.call(l,r),e.call(l,0)),l.dynamicSize()&&n.call(l,r+s-1)):r<=c&&(a<c?l.dynamicSize()&&n.call(l,c-i):l.dynamicSize()&&(n.call(l,r),o.call(l,0)))}function It(t){var e=kt(t,t[R.jGc]()),n=Mt(t,t[R.iGc]());t[R.iGc]()>n&&t[R.iGc](n,!1),t[R.jGc]()>e&&t[R.jGc](e,!1)}function Rt(t){var e,n,o=t.x()+t[R.iGc](),r=Mt(t,o);o>r&&t.x(S(0,r-t[R.iGc]()),!1),t.x()<0&&t.x(0,!1),(e=t.y()+t[R.jGc]())>(n=kt(t,e))&&t.y(S(0,n-t[R.jGc]()),!1),t.y()<0&&t.y(0,!1)}function kt(t,e){var n,o=t.sheet();return o?(n=o.getRowCount(),ft(o,0,n,e)):R.gHc}function Mt(t,e){var n,o=t.sheet();return o?(n=o.getColumnCount(),ht(o,0,n,e)):R.gHc}function Nt(t){pt(t),dt(t)}function Et(t,e,n,o,r,i,a){var s,l=0,u=a?i.getRowHeight:i.getColumnWidth;for(s=t;s<e;s++)l+=x(u.call(i,s)*r);return(l-=x((n||0)*r))+x((o||0)*r)}function Dt(t,e,n,o){var r,i=0;for(r=0;r<t;r++)i+=o?n.getRowHeight(r,3):n.getColumnWidth(r,3);return i+e}function Ot(t){var e=o.GC$(t),n=e.position();return new o.Rect(n.left,n.top,e[R.iGc](),e[R.jGc]())}function jt(t,e,n,r,i,a){o.GC$(t).css([R.OLb,R.fGc,R.iGc,R.jGc],[[r-1],[n-1],i,a]).addClass(R.QHc).appendTo(e)}function Ft(t){var e,n,o,r,i,a=t,s=a.kj,l=a.WE,u=a.aS,c=s.frozenTrailingRowCount(),f=s.frozenTrailingColumnCount(),h=s.am(),p=h.Ft(l,u),d=a.YR,g=d[R.mHc](),m=d[R.oHc](),y=d[R.qHc](),v=d[R.sHc](),C=s.frozenRowCount(),b=s.frozenColumnCount(),w=s.getRowCount(3)-c-1,T=s.getColumnCount(3)-f-1;return l===R.fHc?(C>0&&(e=s.getViewportTopRow(l),(g<C||e===C)&&(p.y-=h.fs,p[R.jGc]+=h.fs)),c>0&&(n=s.getViewportBottomRow(l),y>w&&n===w&&(p[R.jGc]+=h.gs))):l===R.fHc-1?(y>=(e=s.getViewportTopRow(l+1))||e===C)&&(i=h.Ft(l+1,u),p[R.jGc]+=i[R.jGc]):l===R.fHc+1&&((g<=(n=s.getViewportBottomRow(l-1))||n===w)&&(i=h.Ft(l-1,u),p.y=i.y,p[R.jGc]+=i[R.jGc])),u===R.fHc?(b>0&&(o=s.getViewportLeftColumn(u),(m<b||o===b)&&(p.x-=h.hs,p[R.iGc]+=h.hs)),s.frozenTrailingColumnCount()>0&&(r=s.getViewportRightColumn(u),(v>T||r===T)&&(p[R.iGc]+=h.js))):u===R.fHc-1?(v>=(o=s.getViewportLeftColumn(u+1))||o===b)&&(i=h.Ft(l,u+1),p[R.iGc]+=i[R.iGc]):u===R.fHc+1&&((m<=(r=s.getViewportRightColumn(u-1))||r===T)&&(i=h.Ft(l,u-1),p.x=i.x,p[R.iGc]+=i[R.iGc])),p}function Pt(t,e,n,r,i){var a=Ot(t);o.GC$(t).css([R.OLb,R.fGc,R.iGc,R.jGc],[a.y+n,a.x+e,a[R.iGc]+r,a[R.jGc]+i])}function _t(t){var e,n,r,i,a,s,l,u,c,f,h,p,d=t;if(d.bS)for(p in e=d.$F,n=Ft(d),r=d.cS,void 0,a=function(t,e,n){var r,i,a,s,l=t.$R;switch(e){case _:r=A(l[R.gIc]+l[R.iIc],n.x),i=A(l[R.hIc]+l[R.jIc],n.y),a=I(n.x-l[R.gIc]-l[R.iIc]),s=I(n.y-l[R.hIc]-l[R.jIc]);break;case L:r=l[R.gIc],i=A(l[R.hIc]+l[R.jIc],n.y),a=l[R.iIc],s=I(n.y-l[R.hIc]-l[R.jIc]);break;case B:r=A(l[R.gIc],n.x),i=A(l[R.hIc]+l[R.jIc],n.y),a=I(n.x-l[R.gIc]),s=I(n.y-l[R.hIc]-l[R.jIc]);break;case G:r=A(l[R.gIc]+l[R.iIc],n.x),i=l[R.hIc],a=I(n.x-l[R.gIc]-l[R.iIc]),s=l[R.jIc];break;case H:r=A(l[R.gIc],n.x),i=l[R.hIc],a=I(n.x-l[R.gIc]),s=l[R.jIc];break;case V:r=A(l[R.gIc]+l[R.iIc],n.x),i=A(l[R.hIc],n.y),a=I(n.x-l[R.gIc]-l[R.iIc]),s=I(n.y-l[R.hIc]);break;case z:r=l[R.gIc],i=A(l[R.hIc],n.y),a=l[R.iIc],s=I(n.y-l[R.hIc]);break;case W:r=A(l[R.gIc],n.x),i=A(l[R.hIc],n.y),a=I(n.x-l[R.gIc]),s=I(n.y-l[R.hIc])}return new o.Rect(r,i,a,s)}(d,(i=d.$R).direction,e=new o.Point(e.x-n.x,e.y-n.y)),i.endX=a.x,i.endY=a.y,i.endWidth=a[R.iGc],i.endHeight=a[R.jGc],s=Ot(r),l=a.y-s.y,Pt(r,u=a.x-s.x,l,c=a[R.iGc]-s[R.iGc],f=a[R.jGc]-s[R.jGc]),h=d.dS)C(h,p)&&Pt(h[p].moveResizeDiv,u,l,c,f)}function Lt(t,e){var n=t.kj;n&&(!1===n.RF(e)&&o.Ul.nl(e))}function Bt(t,e,n){var r=o.GC$(t),i=o.GC$(t).position();r.css([R.OLb,R.fGc],[i[R.OLb]+n,i[R.fGc]+e])}function Gt(t){var e,n,r,i,a,s,l,u=t,c=u.hS&&u._R;if(c&&!u.cS){for(s in e=u.iS=g(R.VKb),u.cS=g(R.VKb),u.dS={},u.gS.jS.each((function(t){var e,n=t.YR;n&&n.name()!==u.YR.name()&&n.isSelected()&&!u.dS[n.name()]&&(e=t._R,u.dS[n.name()]={offsetX:e.x-c.x,offsetY:e.y-c.y,height:e[R.jGc],width:e[R.iGc],moveResizeDiv:g(R.VKb)})})),n=Ft(u),o.GC$(e).css([R.dHc,R.OLb,R.fGc,R.iGc,R.jGc,R.HHc],[R.EHc,n.y,n.x,n[R.iGc],n[R.jGc],"rgba(255,255,255,0.01)"]).addClass(R.PHc).bind(R.eIc,(function(t){u.BD(t)})).bind(R.fIc,(function(t){u.CD(t)})),r=c.y-n.y,i=c.x-n.x,jt(u.cS,e,i,r,c[R.iGc],c[R.jGc]),a=u.dS)C(a,s)&&jt((l=a[s]).moveResizeDiv,u.iS,i+l.offsetX,r+l.offsetY,l[R.iGc],l[R.jGc]);u.Ks&&o.GC$(u.Ks).append(u.iS)}}function Ht(t){var e=t;e.RB||(o.GC$(v).bind(R.eIc+R.iHc,(function(t){e.BD(t)})).bind(R.fIc+R.iHc,(function(t){e.CD(t)})),e.RB=!0)}function Vt(t,e,n,r,i,a,s,l,u,c){var h,p,d,g,m=t,y=o.GC$(n,m.hS),v=K.mS;e?y.css([R.fGc,R.OLb,R.gGc,R.hGc,R.iGc,R.jGc,R.DGc],[r,i,a,s,v,v,l]).addClass(R.LHc).attr("resizeDirection",u):zt(m,n),c&&(h=o.GC$(m.hS),p=0,d=0,f(r)||(p=r),f(i)||(d=i),f(a)||(p=h.width()-a-v),f(s)||(d=h.height()-s-v),g=new o.Rect(p,d,v,v),c.push({rect:g,cursor:l,direction:u}))}function zt(t,e){o.GC$(e,t.hS).removeClass(R.LHc).addClass(R.MHc)}function Wt(t,e){o.GC$(R.RHc,e).removeClass(R.LHc).addClass(R.MHc),t.ZR=!1}function Ut(t,e,n,o){var r,i,a,s,l,u,c,f,h=t.kj,p=new y,d=h.wr;return d.isNeedToUpdateLayout&&(function(t){t.zR().forEach((function(t){t.dynamicMove()?ut(t):pt(t),t.dynamicSize()?bt(t):dt(t)}))}(d),d.isNeedToUpdateLayout=!1),r=h.am(),i=h.ss,a=h.it(n),s=h.jt(e),a.length<=0||s.length<=0||(l=a[0],u=a[a.length-1],c=s[0],f=s[s.length-1],d.zR().forEach((function(t){var e,n,d,g,m,y,v,C,b,w,T,x,S,A,I;if(t&&t.isVisible()){if(e=void 0,n=void 0,d=t[R.mHc](),g=t[R.oHc](),m=t[R.qHc](),y=t[R.sHc](),t.fixedPosition())e=(v=t.position()).x*o+r.kt,n=v.y*o+r.nt;else{if(C=a.findCol(g))e=C.x;else if(g<l.col)for(e=l.x,b=l.col-1;b>=g;b--)e-=i._m(b);else for(e=u.x+u[R.iGc],w=u.col+1;w<=g;w++)e+=i._m(w);if(e+=t[R.pHc]()*o,T=s.findRow(d))n=T.y;else if(d<c.row)for(n=c.y,x=c.row-1;x>=d;x--)n-=i.Sl(x);else for(n=f.y+f[R.jGc],S=f.row+1;S<=d;S++)n+=i.Sl(S);n+=t[R.nHc]()*o}void 0,void 0,A=t.wxb(o),I=t.xxb(o),function(t,e,n,o,r){var i,a,s;if(t.rowOutlines)for(i=!0,s=e;s<=o;s++)if(!t.rowOutlines.isCollapsed(s)){i=!1;break}if(t.columnOutlines)for(a=!0,s=n;s<=r;s++)if(!t.columnOutlines.isCollapsed(s)){a=!1;break}return i||a}(h,d,g,m,y)||p.push({name:t.name(),x:e,y:n,width:A,height:I})}}))),p}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/floatingObject/floatingobject.ns.js"),a=function(){function t(){this.rM={}}return t.prototype.push=function(t){this.rM[function(t){return"string"==typeof t[R.jHc]?t[R.jHc]:t[R.jHc]()}(t)]=t},t.prototype.remove=function(t){delete this.rM[t]},t.prototype.find=function(t){return this.rM[t]},t.prototype.empty=function(){delete this.rM,this.rM={}},t.prototype.each=function(t){var e,n=this.rM;for(e in n)n.hasOwnProperty(e)&&t(n[e])},t.prototype.isEmpty=function(){var t,e=this.rM;for(t in e)if(e.hasOwnProperty(t))return!1;return!0},t}(),e.yR=a,s=new r.Common.ResourceManager(i.SR),l=s.getResource.bind(s),u=r.Common.j,c=r.Common.D,f=u.Fa,h=u.Ma,p=o.Ul.Pl,d=o.Ul.Ol,g=o.Ul.Nl,m=o.Ul.Rl,y=a,v=document,C=c,b=null,w=void 0,T=Math.ceil,x=Math.floor,S=Math.max,A=Math.min,I=Math.abs,k=(R={VKb:"div",cHc:"on",dHc:"z-index",dGc:"move",eHc:"unselectable",fHc:1,JLb:"border",gHc:9007199254740992,hHc:"floatingObjects",iHc:".gcFloatingObject",jHc:"name",kHc:"scroll",hFc:"x",lHc:"y",iGc:"width",jGc:"height",mHc:"startRow",nHc:"startRowOffset",oHc:"startColumn",pHc:"startColumnOffset",qHc:"endRow",rHc:"endRowOffset",sHc:"endColumn",tHc:"endColumnOffset",uHc:"isSelected",vHc:"isLocked",wHc:"isVisible",xHc:"canPrint",yHc:"dynamicSize",zHc:"dynamicMove",AHc:"fixedPosition",BHc:"allowResize",CHc:"allowMove",DHc:700,EHc:701,FHc:"position",GHc:"absolute",HHc:"background",IHc:"gc-no-user-select",JHc:"gc-floatingobject-selected",KHc:"gc-floatingobject-unselected",LHc:"gc-floatingobject-resize-indicator-select",MHc:"gc-floatingobject-resize-indicator-unSelect",NHc:"gc-floatingobject-content-container",OHc:"gc-floatingobject-container",PHc:"gc-floatingobject-moving-container",QHc:"gc-floatingobject-moving-div",RHc:".gc-floatingobject-resize-indicator",SHc:"gc-floatingobject-resize-indicator",THc:"gc-floatingobject-absolute",UHc:"gc-floatingobject-top",VHc:"gc-floatingobject-middle",WHc:"gcfloatingobject-bottom",XHc:"gc-floatingobject-left",YHc:"gc-floatingobject-center",ZHc:"gc-floatingobject-right",$Hc:"content",HGc:"gc-no-user-select",_Hc:"100%",aIc:"gc-floatingobject-background-cover",bIc:".fos",fGc:"left",cIc:"center",gGc:"right",OLb:"top",dIc:"middle",hGc:"bottom",VGc:"-resize",DGc:"cursor",eIc:"mousemove",fIc:"mouseup",gIc:"startX",hIc:"startY",iIc:"startWidth",jIc:"startHeight",kIc:"endX",lIc:"endY",mIc:"startTopRow",nIc:"startLeftColumn"}).VKb+"."+R.SHc,M=k+"."+R.UHc+"."+R.XHc,N=k+"."+R.VHc+"."+R.XHc,E=k+"."+R.WHc+"."+R.XHc,D=k+"."+R.UHc+"."+R.YHc,O=k+"."+R.WHc+"."+R.YHc,j=k+"."+R.UHc+"."+R.ZHc,F=k+"."+R.VHc+"."+R.ZHc,P=k+"."+R.WHc+"."+R.ZHc,_=R.OLb+R.fGc,L=R.OLb+R.cIc,B=R.OLb+R.gGc,G=R.dIc+R.fGc,H=R.dIc+R.gGc,V=R.hGc+R.fGc,z=R.hGc+R.cIc,W=R.hGc+R.gGc,(function(){var t=this;t.uQ=function(){var t=this.wr;t&&t.zR().forEach((function(t){t.isSelected(!1)}))},t.AR=function(){var t=this.wr;t&&(t.isNeedToUpdateLayout=!0)},t.BR=function(){var t=this,e=t.parent,n=t.tv,o=e&&e.tv;return n||(n=t.tv=o||{fromSheet:b,isCutting:!1}),n},t.ex=function(){var t=this.BR(),e=t&&t.fromSheet;e&&(e.CR=b),t.fromSheet=b,t.isCutting=!1},t.DR=function(t){var e=this.options;return!e.isProtected||!t.isLocked()||e.protectionOptions.allowEditObjects},t.ER=function(t){var e=this.options;return!e.isProtected||!t.isLocked()||e.protectionOptions.allowEditObjects},t.isPasteFloatingObject=function(){var t=this.BR().fromSheet,e=this.CR;return!e&&t&&(e=t.CR),e&&!e.isEmpty()},t.IR=function(t,e){var n=this;return n.FR||(n.FR=[]),n.FR[t]||(n.FR[t]=[]),n.FR[t][e]||(n.FR[t][e]=new tt(n)),n.FR[t][e]},t.QP=function(t,e){var n,o,r,i,a=this;if(!a.fI&&a.wr&&a.yl&&a.yl.bm())for(n=a.am(),void 0,e!==b&&void 0!==e||(e=a.zoom()),o=0;o<=2;o++)for(r=0;r<=2;r++)n.Ft(o,r)&&((i=a.IR(o,r))&&i.yl(o,r,e))}}).call(o.Worksheet.prototype),e.toJsonFn=rt,e.fromJsonFn=it,e.propertyRefreshCallback=at,U=function(){function t(t,e){this.kj=t,this.g3=e}return t.prototype.no=function(){this.kj=b},t.prototype.add=function(t,e,n,o,r,i,a,s){var l,u=this;return"1"===u.g3?l=J.ozb(t,e,n,o,r,i):"0"===u.g3&&(l=t),u.kj.wr.Sb(l),l},t.prototype.get=function(t){return this.kj.wr.NR(t)},t.prototype.remove=function(t){this.kj.wr.Fb(t)},t.prototype.clear=function(){return this.kj.wr.$b(this.g3)},t.prototype.all=function(){return this.kj.wr.zR(this.g3)},t.prototype.zIndex=function(t,e){return this.kj.wr.PR(t,e)},t.prototype.tTa=function(t,e,n){this.all().forEach((function(o){var r=n?o.startRow():o.startColumn(),i=n?o.endRow():o.endColumn();e<r||t>i||!o.dynamicSize()||bt(o),ut(o)}))},t}(),e.FloatingObjectCollection=U,q=function(){function t(t){var e=this;e.sheet(t),function(t){var e=t.sheet();e&&(o.GC$(v.body).bind("scroll"+R.iHc,(function(){var t=e.parent&&e.parent.getActiveSheet();t&&t.wr&&e.QP(t.Dr())})),e.Fu(o.Events.ColumnChanged+R.iHc,(function(e,n){var o=n.propertyName;o!==R.iGc&&o!==R.wHc||vt(t)})),e.Fu(o.Events.RowChanged+R.iHc,(function(e,n){var o=n.propertyName;o!==R.jGc&&o!==R.wHc||vt(t)})),e.Fu(o.Events.ColumnWidthChanged+R.iHc,(function(){vt(t)})),e.Fu(o.Events.RowHeightChanged+R.iHc,(function(){vt(t)})))}(e),e.QR={}}return t.prototype.Dka=function(t){this.zR().forEach((function(e){!function(t,e){f(t.PR)&&(t.Cka+=e)}(e,t)}))},t.prototype.Sb=function(t,e){var n,o=this,r=o.sheet();if(r.suspendPaint(),!(n=t.name()))throw r.resumePaint(),Error(l().Exp_FloatingObjectNameEmptyError);if(o.QR[n]){if(!e)throw r.resumePaint(),Error(l().Exp_FloatingObjectHasSameNameError);n=o.FS(n+"__"),t.name(n)}r.ITa.AUa(),o.Dka(-1),t.sheet(r),o.QR[n]=t,r.Zoa(t),r.resumePaint()},t.prototype.NR=function(t){return this.QR[t]},t.prototype.Fb=function(t,e){var n,r,i,a=this;return!!t&&(n=a.sheet(),r=a.NR(t),n.ITa.AUa(),n.suspendPaint(),e?(i={sheet:n,sheetName:n.name(),floatingObject:r,cancel:!1},n.Wq(o.Events.FloatingObjectRemoving,i),!1===i.cancel&&(delete a.QR[t],n.Wq(o.Events.FloatingObjectRemoved,{sheet:n,sheetName:n.name(),floatingObject:r}))):delete a.QR[t],n.resumePaint(),!0)},t.prototype.U3=function(t,e){var n,o=this,r=o.sheet();if(r.suspendPaint(),!e)throw Error(l().Exp_FloatingObjectNameEmptyError);if(o.QR[e])throw Error(l().Exp_FloatingObjectHasSameNameError);n=o.QR[t],delete o.QR[t],o.QR[e]=n,n.onNameChanged&&n.onNameChanged(t,e),r.resumePaint()},t.prototype.$b=function(t){var e=this,n=e.sheet();n.suspendPaint(),o.GC$.each(this.QR,(function(n,o){t&&t!==o.g3||e.Fb(o.name())})),n.resumePaint()},t.prototype.zR=function(t){var e=[];return o.GC$.each(this.QR,(function(n,o){t&&t!==o.g3||e.push(o)})),e},t.prototype.PR=function(t,e){var n=isNaN(e),o=this.NR(t);if(o){if(n)return yt(o);!function(t,e){t.PR=e,t.qo.forEach((function(t){for(var n=t.parentElement;-1===n.className.indexOf(R.OHc);)n=n.parentElement;mt(n,e)}))}(o,e)}if(n)return-1},t.prototype.toJSON=function(){var t=[];return this.zR().forEach((function(e){var n,o;e instanceof J&&e.hga()&&(n=e.toJSON(),o=e.PR,isNaN(o)||(n.zIndex=o),t.push(n))})),t},t.prototype.fromJSON=function(t,e){var n,r,i,a,s,l,u,c,h,p;if(t&&0!==t.length)for(n=0;n<t.length;n++)i=void 0,(r=t[n])&&(a=void 0,s=r.floatingObjectType,"0"===(l=o.Ul.Ol(s)?s+"":r.typeName)?i=new J:"1"===l?i=J.ozb():(a=o.getTypeFromString(l))&&(i=new a),i&&(h=(c=(u=this.sheet())&&u.parent)&&c.GBb,i.fromJSON(r,e,h),this.Sb(i),p=r.zIndex,f(p)||(i.PR=p)))},t.prototype.no=function(t){o.GC$(v.body).unbind("scroll"+R.iHc);var e=this,n=e.sheet();n&&(n.Gu(o.Events.ColumnChanged+R.iHc),n.Gu(o.Events.RowChanged+R.iHc),n.Gu(o.Events.ColumnWidthChanged+R.iHc),n.Gu(o.Events.RowHeightChanged+R.iHc)),!1!==t&&(e.QR&&o.GC$.each(e.QR,(function(e,n){n.no(t)})),e.sheet(b))},t.prototype.hitTest=function(t,e,n){var o,r,i,a,s=this.sheet(),l=s.am(),u=b;if(l)for(o=0;o<=2;o++)for(r=0;r<=2;r++)if((i=l.Ft(o,r))&&i.contains(t,e)&&((a=s.IR&&s.IR(o,r))&&a.jS.each((function(o){var r=o.YR;r&&r.isVisible()&&(s.DR(r)||n)&&Ct(t,e,o.Tka)&&(u?yt(u.floatingObject)<yt(r)&&(u.floatingobject=r):u={x:t,y:e,floatingObject:r,yl:o})})),u))return u;return u},t.prototype.FS=function(t){var e,n;for(t||(t="FloatingObject"),n=t+""+(e=1);this.NR(n);)n=t+""+ ++e;return n},t}(),e.FloatingObjectModel=q,Y={sheet:p("sheet",w)},o.GC$.extend(q.prototype,Y),X=["dotted","dashed","solid","double","groove","ridge","inset","outset"],Z=[R.jHc,R.hFc,R.lHc,R.iGc,R.jGc,R.mHc,R.nHc,R.oHc,R.pHc,R.qHc,R.rHc,R.sHc,R.tHc,R.xHc,R.uHc,R.vHc,R.wHc,R.zHc,R.yHc,R.AHc,R.BHc,R.CHc,"alt"],Q=[["sheet",b,function(){!function(t){var e,n,o,r;It(t),Rt(t),e=t[R.mHc](),n=t[R.oHc](),f(e)||f(n)?pt(t):ut(t),o=t[R.qHc](),r=t[R.sHc](),f(o)||f(r)?dt(t):bt(t)}(this)}],[R.jHc,w,function(t,e){var n,o=this,r=o.sheet();r&&((n=r.wr).NR(e)===o&&n.U3(e,t)),o.onPropertyChanged("name",t,e)},function(t){var e;if(d(t)&&("string"!=typeof t||""===t))throw Error(l().Exp_FloatingObjectNameEmptyError);return this,t!==this.name()&&(!(e=this.sheet())||!e.wr.NR(t))}],[R.hFc,0,xt(R.hFc,!1)],[R.lHc,0,xt(R.lHc,!1)],[R.jGc,0,xt(R.jGc,!0)],[R.iGc,0,xt(R.iGc,!0)],[R.mHc,w,st(R.mHc)],[R.nHc,0,st(R.nHc)],[R.oHc,w,st(R.oHc)],[R.pHc,0,st(R.pHc)],[R.qHc,w,lt(R.qHc)],[R.rHc,0,lt(R.rHc)],[R.sHc,w,lt(R.sHc)],[R.tHc,0,lt(R.tHc)],[R.uHc,!1,at(R.uHc)],[R.vHc,!0,Tt(R.vHc)],[R.xHc,!0,Tt(R.xHc)],[R.wHc,!0,at(R.wHc)],[R.zHc,!0,function(t,e){Tt(R.zHc).call(this,t,e)},function(t){return"boolean"==typeof t&&(t||this.dynamicSize(!1,!1),!this.fixedPosition())}],[R.yHc,!0,function(t,e){Tt(R.yHc).call(this,t,e)},function(t){return"boolean"==typeof t&&this.dynamicMove()&&!this.fixedPosition()}],[R.AHc,!1,function(t,e){var n=this;t&&(n.dynamicMove(!1,!1),n.dynamicSize(!1,!1)),n.onPropertyChanged(R.AHc,t,e)}],[R.BHc,!0,at(R.BHc)],[R.CHc,!0,at(R.CHc)],["alt","",Tt("alt")]],J=function(){function t(t,e,n,o,r){var i=this;i.LR={startRowOffset:w,startColumnOffset:w,endRowOffset:w,endColumnOffset:w},i.typeName="0",i.g3="0",i.name(t),i.x(e||0,!1),i.y(n||0,!1),i[R.iGc](o||0,!1),i[R.jGc](r||0,!1),i.qo=[],i.KR=!1,i.Cka=R.DHc}return t.prototype.position=function(t){var e,n,r=this,i=r.sheet();return 0===arguments.length?new o.Point(r.x(),r.y()):(e=r.x(),n=r.y(),!h(t,o.Point)||e===t.x&&n===t.y||(r.x(t.x,!1),r.y(t.y,!1),Rt(r),Nt(r),i&&i.$p(),r.onPropertyChanged("position",t,new o.Point(e,n))),r)},t.prototype.cloneContent=function(){var t,e,n=this.content();return n?(t=void 0,n.cloneNode?t=n.cloneNode(!0):((e=g(R.VKb)).innerHTML=n.outerHTML,t=e.firstChild),o.GC$(t).removeAttr("id")[0]):b},t.prototype.refreshContent=function(t){var e,n,r,i,a,s,l=this;l.KR&&t&&((e=o.GC$(t)).empty(),n=l.cloneContent(),r=R._Hc,i=R._Hc,a="",s="",n&&n.style&&(a=n.style.width,s=n.style.height),""!==a&&(r=a),""!==s&&(i=s),n!==b?(o.GC$(n).css({width:r,height:i}).addClass(R.aIc).addClass(R.IHc).attr(R.eHc,R.cHc).appendTo(t),e.css(R.HHc,"")):e.css(R.HHc,""),l.KR=!1)},t.prototype.toJSON=function(){var t,e=this,n=rt.call(e,Z),r=e.LR;for(t in r)f(r[t])||(n[t]=r[t]);return n.typeName=e.typeName,n[R.$Hc]=o.GC$(g(R.VKb)).append(e.cloneContent()).html(),n},t.prototype.fromJSON=function(t,e){var n,r;t&&((n=this).TR=!0,it.call(this,Z,t,e),f(t[R.mHc])&&Nt(n),t.content&&((r=g(R.VKb)).innerHTML=t.content,n.content(o.GC$(r.firstChild)[0])),n.TR=w)},t.prototype.clone=function(e){var n=this,r=o.getTypeFromString(n.typeName),i=r?new r:new t,a=JSON.stringify(n.toJSON());return i.fromJSON(JSON.parse(a)),i.content(n.cloneContent()),i},t.prototype.onPropertyChanged=function(t,e,n){var o,r=this;r.TR||(o=r.sheet())&&(o.ITa.BUa(r,t,n),r.Wq({sheet:o,sheetName:o.name(),floatingObject:r,propertyName:t}))},t.prototype.Wq=function(t){var e,n=this.sheet();n&&(n.Wq(o.Events.FloatingObjectChanged,t),t.propertyName===R.uHc&&(e={sheet:t.sheet,sheetName:t.sheetName,floatingObject:t.floatingObject},n.Wq(o.Events.FloatingObjectSelectionChanged,e)))},t.prototype.rI=function(t,e){var n=this;t=T(t),e=T(e),St.call(n,n[R.mHc],n[R.qHc],t,e)},t.prototype.GR=function(t,e){var n=this,o=t+e-1;At.call(n,n[R.mHc],n[R.nHc],n[R.qHc],n[R.rHc],t,e,o)},t.prototype.tI=function(t,e){var n=this;t=T(t),e=T(e),St.call(n,n[R.oHc],n[R.sHc],t,e)},t.prototype.HR=function(t,e){var n,o=this;n=(t=T(t))+(e=T(e))-1,At.call(o,o[R.oHc],o[R.pHc],o[R.sHc],o[R.tHc],t,e,n)},t.prototype.getHost=function(t,e){var n,o,r=this.qo.concat();if(!f(t)&&!f(e)){for(n=0;n<r.length;n++)if((o=r[n]).rowViewportIndex===t&&o.columnViewportIndex===e)return o;return b}return r},t.prototype.UR=function(t,e,n){var o=this.qo;t&&o.indexOf(t)<0&&(t.rowViewportIndex=e,t.columnViewportIndex=n,o.push(t))},t.prototype.VR=function(t){var e=this.qo,n=e.indexOf(t);n>=0&&e.splice(n,1)},t.prototype.WR=function(t,e){var n,r,i,a,s,l,u=g(R.VKb);return o.GC$(u).addClass(R.HGc).addClass(R.NHc).attr(R.eHc,R.cHc).css(R.FHc,R.GHc),n=this.cloneContent(),r=R._Hc,i=R._Hc,a="",s="",(l=n&&n.style)&&(a=l.width,s=l.height),""!==a&&(r=a),""!==s&&(i=s),n!==b&&o.GC$(n).css({width:r,height:i}).addClass(R.aIc).addClass(R.HGc).attr(R.eHc,R.cHc).appendTo(u),this.UR(u,t,e),u},t.prototype.hga=function(){return!0},t.prototype.no=function(t){},t.prototype.Toa=function(){ut(this),bt(this)},t.prototype.wxb=function(t){var e,n,o=this;return 1===t?x(o.width()):(e=Dt(o.startColumn(),o.startColumnOffset(),o.sheet(),!1),n=gt(o,!1,e+o[R.iGc]()),Et(o.startColumn(),n.index,o.startColumnOffset(),n.offset,t,o.sheet(),!1))},t.prototype.xxb=function(t){var e,n,o=this;return 1===t?x(o.height()):(e=Dt(o.startRow(),o.startRowOffset(),o.sheet(),!0),n=gt(o,!0,e+o[R.jGc]()),Et(o.startRow(),n.index,o.startRowOffset(),n.offset,t,o.sheet(),!0))},t}(),e.FloatingObject=J,$={content:p(R.$Hc,b,at(R.$Hc))},o.GC$.each(Q,(function(t,e){$[e[0]]=p(e[0],e[1],e[2],e[3])})),o.GC$.extend(J.prototype,$),K=function(){function t(t,e){this.XR="";var n=this;n.YR=t,n.name=t?t.name():"",n.kj=e,n.RB=!1,n.ZR=!1}return t.prototype.gV=function(t){var e,n,r,i,a,s,l=o.GC$(t.target).attr("resizeDirection");if(l)return l;if(e=o.GC$(this.hS).offset(),n=t.pageX-e.left,r=t.pageY-e.top,i=this.pmb)for(a=0;a<i.length;a++)if((s=i[a]).rect.contains(n,r))return s.direction},t.prototype.smb=function(t){var e,n,r,i,a,s,l=t.target;if(o.GC$(l).attr("resizeDirection"))return l.style.cursor;if(e=o.GC$(this.hS).offset(),n=t.pageX-e.left,r=t.pageY-e.top,i=this.pmb)for(a=0;a<i.length;a++)if((s=i[a]).rect.contains(n,r))return s.cursor},t.prototype.AD=function(e){var n,r,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=d.YR,y=g.ITa.Ky,v=d.WE,C=d.aS;if(g.ER(m)&&g.endEdit()&&(g.zt(!0),n={e:e,r:b},t.ao(d,"preProcessMouseDown",n),!n.r)){if(0===e.button||2===e.button){if(r=m.isSelected(),e.ctrlKey||e.shiftKey?m.isSelected(!r):r||(g.uQ(),m.isSelected(!0)),r||o.Vl.Zl(g),y&&y.vQ(),g.EJ(),g.hm&&g.hm(),2===e.button)return;if(i=g.mm,a=g.Vs(),s=d.gV(e),l=new o.Point(e.pageX-a.left,e.pageY-a.top),u=function(t,e){if(!t._R)return b;var n={inMoving:!1};return e||(n.inMoving=!0),n}(d,s),!m.allowMove()&&(!m.allowResize()||u.inMoving))return;d.$F=l,d.pS=!0,d.bS=u,u.inMoving?((c={}).startTopRow=g.getViewportTopRow(v),c.startLeftColumn=g.getViewportLeftColumn(C),c.startX=l.x,c.startY=l.y,d.eS=c):(Gt(d),f={},h=Ot(d.cS),f.startX=h.x,f.startY=h.y,f.startWidth=h[R.iGc],f.startHeight=h[R.jGc],f.startTopRow=g.getViewportTopRow(v),f.startLeftColumn=g.getViewportLeftColumn(C),f.cursor=d.smb(e),f.direction=s,d.$R=f),Ht(d),p=g.hitTest(l.x,l.y),i.rG={KG:p.rowViewportIndex,MG:p.colViewportIndex,sG:p.hitTestType},i.$F=l,i.qG(),i.O3=!0,g.Wq(o.Events.FloatingElementSelected,{type:"floatingObject"})}return!1}},t.prototype.BD=function(e){var n,r,i,a,s,l,u,c,f=this,h=f.kj,p=f.hS,d=f.iS;if(h.ER(f.YR))return n={e:e,r:b},t.ao(f,"preProcessMouseMove",n),n.r?void((r=n.cursor)&&o.GC$(p).css(R.DGc,r)):(a=(i=f.YR).isLocked()&&h.options.isProtected,o.GC$(p).css(R.DGc,a||!i.allowMove()?"default":R.dGc),h.dG?(p&&o.GC$(p).css(R.DGc,"default"),!0):(s=h.mm,l=h.Vs(),u=new o.Point(e.pageX-l.left,e.pageY-l.top),f.pS?(f.bS.inMoving?(f.qS=!0,Gt(f),function(t,e,n){var o,r,i,a,s=t,l=s.cS;if(l)for(a in Bt(l,o=n.x-e.x,r=n.y-e.y),i=s.dS)C(i,a)&&Bt(i[a].moveResizeDiv,o,r)}(f,f.$F,u),o.GC$(d).css(R.DGc,R.dGc)):f.YR.allowResize()&&(f.kv=!0,_t(f),o.GC$(d).css(R.DGc,f.$R[R.DGc])),(f.qS||f.kv)&&(f.$F=u,s.$F=u,s.NG(),o.GC$(v.body).addClass(R.IHc).attr(R.eHc,R.cHc))):(c=h.parent).options.enableAccessibility&&c.dgc(i.alt()),!1))},t.prototype.CD=function(e){var n,r,i,a,s,l=this,u=l.kj,c=u.mm,f=l.YR,h=l.hS,p=l.bS;if(u.ER(f)&&(n={e:e,r:b},t.ao(l,"preProcessMouseUp",n),!n.r))return u.dG?(o.GC$(h).css(R.DGc,R.dGc),!0):(c.O3=!1,c.RG(),r=u.Vs(),i=new o.Point(e.pageX-r.left,e.pageY-r.top),(a=l.eS)&&(a.endX=i.x,a.endY=i.y),p&&(s=f.fixedPosition(),p.inMoving&&l.qS?(s&&function(t){var e,n,o,r,i,a,s,l,u,c,f,h=t,p=h.eS;p&&(e=h.YR,r=(o=(n=h.kj).am())[R.iGc]-o.Br-o.zr,i=o[R.jGc]-o.Cr-o.Ar,a=p.startX,s=p.startY,l=e.position().x,u=e.position().y,c=e[R.iGc](),f=e[R.jGc](),l+p.endX-a<0&&(p.endX=a-l),u+p.endY-s<0&&(p.endY=s-u),l+c+p.endX-a>r&&(p.endX=r+a-l-c),u+f+p.endY-s>i&&(p.endY=i+s-u-f),p.startTopRow=n.getViewportTopRow(h.WE),p.startLeftColumn=n.getViewportLeftColumn(h.aS))}(l),e.ctrlKey?function(t){var e,n,o,r,i,a,s,l=t,u=l.kj,c=l.eS;if(c){if(e=m(u,c[R.mIc],u.getViewportTopRow(l.WE),!0),n=m(u,c[R.nIc],u.getViewportLeftColumn(l.aS),!1),o=c[R.kIc]-c[R.gIc]+(c[R.kIc]>c[R.gIc]?n:-1*n),r=c[R.lIc]-c[R.hIc]+(c[R.lIc]>c[R.hIc]?e:-1*e),0===o&&0===r)return;for(s in(i=[]).push(l.YR.name()),a=l.dS)C(a,s)&&i.push(s);u.wu().execute({cmd:"dragCopyFloatingObjects",sheetName:u.name(),floatingObjects:i,offsetX:o,offsetY:r})}}(l):function(t){var e,n,o,r,i,a,s,l=t,u=l.kj,c=l.eS,f=u.zoom();if(c){for(s in e=m(u,c[R.mIc],u.getViewportTopRow(l.WE),!0),n=m(u,c[R.nIc],u.getViewportLeftColumn(l.aS),!1),o=c[R.kIc]-c[R.gIc]+(c[R.kIc]>c[R.gIc]?n:-1*n),r=c[R.lIc]-c[R.hIc]+(c[R.lIc]>c[R.hIc]?e:-1*e),o/=f,r/=f,(i=[]).push(l.YR.name()),a=l.dS)C(a,s)&&i.push(s);u.wu().execute({cmd:"moveFloatingObjects",sheetName:u.name(),floatingObjects:i,offsetX:o,offsetY:r})}}(l)):l.kv&&(s&&function(t){var e,n,r,i,a,s=t,l=s.$R;l&&(r=(n=(e=s.kj).am())[R.iGc]-n.Br-n.zr,i=n[R.jGc]-n.Cr-n.Ar,a=(a=new o.Rect(l.endX,l.endY,l.endWidth,l.endHeight)).getIntersect(0,0,r,i),l.endX=a.x,l.endY=a.y,l.endWidth=a[R.iGc],l.endHeight=a[R.jGc],l.startTopRow=e.getViewportTopRow(s.WE),l.startLeftColumn=e.getViewportLeftColumn(s.aS))}(l),function(t){var e,n,o,r,i,a,s,l,u,c=t,f=c.kj,h=f.zoom(),p=c.YR,d=c.$R;if(d){for(u in e=m(f,d[R.mIc],f.getViewportTopRow(c.WE),!0),n=m(f,d[R.nIc],f.getViewportLeftColumn(c.aS),!1),o=d[R.kIc]-d[R.gIc]+(d[R.kIc]>d[R.gIc]?n:-1*n),o/=h,r=d[R.lIc]-d[R.hIc]+(d[R.lIc]>d[R.hIc]?e:-1*e),r/=h,i=(d.endWidth+n)/h-p[R.iGc](),a=(d.endHeight+e)/h-p[R.jGc](),(s=[]).push(p.name()),l=c.dS)C(l,u)&&s.push(u);f.wu().execute({cmd:"resizeFloatingObjects",sheetName:f.name(),floatingObjects:s,offsetX:o,offsetY:r,offsetWidth:i,offsetHeight:a})}}(l)),o.GC$(v.body).removeClass(R.IHc)),l.rS(),!1)},t.prototype.rS=function(){var t=this;t.$R=b,t.eS=b,t.dS=b,o.GC$(t.iS).remove(),t.cS=b,t.pS=!1,function(t){var e=t;e.RB&&(e.RB=!1,o.GC$(v).unbind(R.eIc+R.iHc).unbind(R.fIc+R.iHc))}(t),t.qS=!1,t.kv=!1},t.prototype.yl=function(t,e){var n,r,i,a,s,l,u,c=this,f=c.YR,h=c.kj;if(f){if(n=!1,c.sS=t,!(r=c.hS)){if(t.width<=0||t.height<=0)return;r=c.hS=function(t){var e,n,r,i,a,s,l,u,c=g(R.VKb),f=o.GC$(c),h=t;return f.addClass(R.OHc).addClass(R.IHc).attr(R.eHc,R.cHc).css(R.dHc,R.DHc).bind("mousedown",(function(t){h.AD(t)})).bind(R.eIc,(function(t){h.BD(t)})).bind(R.fIc,(function(t){h.CD(t)})),c.addEventListener("mousewheel",(function(t){Lt(h,t)}),!1),c.addEventListener("DOMMouseScroll",(function(t){Lt(h,t)}),!1),e=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.UHc+" "+R.XHc+" "+R.THc),n=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.UHc+" "+R.YHc+" "+R.THc),r=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.UHc+" "+R.ZHc+" "+R.THc),i=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.VHc+" "+R.XHc+" "+R.THc),a=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.VHc+" "+R.ZHc+" "+R.THc),s=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.WHc+" "+R.XHc+" "+R.THc),l=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.WHc+" "+R.YHc+" "+R.THc),u=o.GC$(g(R.VKb)).addClass(R.SHc+" "+R.WHc+" "+R.ZHc+" "+R.THc),f.append(e).append(n).append(r).append(i).append(a).append(s).append(l).append(u),K.ao(h,"init",c),c}(c),function(t,e){mt(e,yt(t))}(f,r),(i=h.parent)&&((a=c.Ks=i.xv())&&o.GC$(a).append(r))}(s=c.kS)||(s=c.kS=f.WR(c.WE,c.aS),"1"===f.typeName?(c.lS=g(R.VKb),o.GC$(c.lS).addClass(R.IHc+" "+R.NHc).attr(R.eHc,R.cHc),r.appendChild(c.lS),c.lS.appendChild(s)):(r.appendChild(s),n=!0)),c.lS&&(function(t,e,n){var r,i,a,s,l=t.lS,u=t.YR,c=u.borderWidth(),f=u.borderStyle(),h=o.Rm.Om(u.sheet(),u.borderColor()),p=u.borderRadius(),d=0,g=x(K.mS/2+1);wt(f)&&!u.noFill()||(c=0),c<g&&(d=g-c),r=d,i=d,a=d,s=d,g=S(c,g),e.x<0?r+=e.x-g:(r+=e.x<g?e.x-g:0,s=n[R.iGc]-r-e[R.iGc]-2-2*c),e.y<0?i+=e.y-g:(i+=e.y<g?e.y-g:0,a=n[R.jGc]-i-e[R.jGc]-2-2*c),o.GC$(l).css([R.FHc,R.fGc,R.OLb,R.hGc,R.gGc,R.JLb+"-width",R.JLb+"-style",R.JLb+"-color",R.JLb+"-radius"],[R.GHc,r,i,a,s,c,f,h,p])}(c,e,t),e.x=0,e.y=0),l=o.GC$(s),o.GC$(r).css([R.OLb,R.fGc,R.iGc,R.jGc],[t.y,t.x,t[R.iGc],t[R.jGc]]),l.css([R.OLb,R.fGc,R.iGc,R.jGc],[e.y,e.x,e[R.iGc],e[R.jGc]]),c.Tka=t,f.refreshContent&&f.refreshContent(s),c.lS&&function(t){var e,n,r,i,a,s,l,u,c,f=t,h=f.YR,p=h.qmb||h.src(),d=h.pictureStretch(),g=o.Rm.Om(h.sheet(),h.backColor()),m=f.kS;p&&m&&(e=o.GC$(m),f.XR!==p&&(f.XR=p,e.css([R.HHc+"-image",R.HHc+"-repeat"],["url('"+p+"')","no-repeat"])),e.css(R.HHc+"-color",g),d!==b&&d!==w&&h.oS&&(n=h.getOriginalWidth(),r=h.getOriginalHeight(),i=e[R.iGc](),a=e[R.jGc](),l=void 0,(s=h.rmb)&&(u=i/s.width,c=a/s.height,l={position:-(u*s.left)+"px "+-(c*s.top)+"px",size:u+"px "+c+"px"}),o.Ul.ql(m,i,a,n,r,d,l)))}(c),f.isSelected()?(l.removeClass(R.KHc).addClass(R.JHc),f.allowResize()?function(t,e){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y;o.GC$(R.RHc,e).removeClass(R.MHc),r=Ot((n=t).hS),i=n.kS,a=n.YR,n.lS&&(i=n.lS),s=K.mS,u=(l=Ot(i)).x,c=l.y,f=r[R.jGc]-l.y-l[R.jGc],h=r[R.iGc]-l.x-l[R.iGc],p=0,d=s+2,g=x(s/2+1),"1"===a.typeName&&(m=a.borderWidth(),wt(a.borderStyle())||(m=0),m>=g&&(p=m-g),f=r[R.jGc]-c-l[R.jGc]-m,h=r[R.iGc]-u-l[R.iGc]-m,u+=m,c+=m),y=[],u>0?(Vt(n,c>0,M,p,p,w,w,"nw"+R.VGc,_,y),Vt(n,r[R.jGc]>0,N,p,(l[R.jGc]-d)/2+c,w,w,"w"+R.VGc,G,y),Vt(n,f>0,E,p,w,w,p,"ne"+R.VGc,V,y)):(zt(n,M),zt(n,N),zt(n,E)),Vt(n,c>0,D,(l[R.iGc]-d)/2+u,p,w,w,"n"+R.VGc,L,y),Vt(n,f>0,O,(l[R.iGc]-d)/2+u,w,w,p,"n"+R.VGc,z,y),h>0?(Vt(n,c>0,j,w,p,p,w,"sw"+R.VGc,B,y),Vt(n,r[R.jGc]>0,F,w,(l[R.jGc]-d)/2+c,p,w,"w"+R.VGc,H,y),Vt(n,f>0,P,w,w,p,p,"se"+R.VGc,W,y)):(zt(n,j),zt(n,F),zt(n,P)),n.ZR=!0,n.pmb=y}(c,r):c.ZR&&Wt(c,r)):(l.removeClass(R.JHc).addClass(R.KHc),Wt(c,r)),n&&(u=s.firstChild,h.Wq(o.Events.FloatingObjectLoaded,{sheet:h,sheetName:h.name(),floatingObject:f,element:u}))}},t.prototype.no=function(){var e=this,n=e.YR,r=e.hS,i=e.iS,a=e.kS;t.ao(e,"dispose"),a&&n.VR&&(n.VR(a),n.no(!1)),r&&(o.GC$(r).remove(),e.hS=b),i&&(o.GC$(i).remove(),e.iS=b)},t.mS=7,t}(),e.FloatingObjectRender=K,o.Zn(K),tt=function(){function t(t){this.kj=t,this.jS=new y}return t.prototype.no=function(){var t=this.jS;t.each((function(t){t.no()})),t.empty(),this.kj=b},t.prototype.yl=function(t,e,n){var r,i,a,s,l,u,c,f,h,p;if(!(t<0||e<0)){for(i=(r=this).kj,a=r.jS,s=i.wr,l=Ut(r,t,e,n),u=[],a.each((function(t){l.find(t.name)||u.push(t)})),f=u.length,c=0;c<f;c++)(h=u[c]).gS=b,a.remove(h.name),h.no();p=i.parent&&i.parent.options.useTouchLayout,K.mS=p?11:7,l.each((function(n){var l,u,c,f,h,p,d,g,m,y,v,C,b,w,T=s.NR(n.name),A=x(K.mS/2+1);T&&"1"===T.typeName&&(l=T.borderWidth(),wt(T.borderStyle())||(l=0),l>A&&(A=l)),u=function(t,e,n){var r,i,a,s,l,u=t.kj,c=u.it(n),f=0,h=0,p=0,d=0;return c&&c.length>0&&(r=c[0],i=c[c.length-1],f=r.x,p=i.x+i[R.iGc]-f),(a=u.jt(e))&&a.length>0&&(s=a[0],l=a[a.length-1],h=s.y,d=l.y+l[R.jGc]-h),u.am().Ft(e,n).getIntersect(f,h,p,d)||new o.Rect(0,0,0,0)}(r,t,e),c=n.x-A-1,f=n.y-A-1,h=n[R.iGc]+2*A+2,g=n[R.jGc]+2*A+2,m=h,C=-1*A-1,(y=f-(p=S(u.y,f))+(y=A))<=0?(g+=y,g+=C):y<A&&y>0&&(g-=A-y),(v=c-(d=S(u.x,c))+(v=A))<=0?(m+=v,m+=C):v<A&&v>0&&(m-=A-v),(b=a.find(n.name))||((b=new K(s.NR(n.name),i)).gS=r,a.push(b)),b._R=n,b.WE=t,b.aS=e,w=new o.Rect(u.x,u.y,u[R.iGc],u[R.jGc]),b.yl(new o.Rect(d,p,m,g).getIntersectRect(w)||new o.Rect(d,p,0,0),new o.Rect(v,y,n[R.iGc],n[R.jGc]))}))}},t}(),et={init:function(){var t=this,e=t.$oa=[];t.Zoa=function(t){e.forEach((function(e){e.Wva&&e.Wva(t)}))},t.wr=t.ITa.wr,t.pictures=new U(t,"1"),t.floatingObjects=new U(t,"0")},dispose:function(t){var e=this;(function(t,e){var n,o,r,i,a,s,l,u=t.FR;if(u){for(n=void 0,o=void 0,void 0,i=void 0,r=u.length,n=0;n<r;n++)if(a=u[n]){for(i=a.length,o=0;o<i;o++)(s=a[o])&&s.no();a.length=0}u.length=0,t.FR=b}(l=t.wr)&&!1!==e&&l.no()})(e,t.clearCache),e.wr&&o.GC$.each(e.wr.zR(),(function(e,n){n.no(t.clearCache)})),!1!==t.clearCache&&(e.pictures&&(e.pictures.no(),e.pictures=b),e.floatingObjects&&(e.floatingObjects.no(),e.floatingObjects=b),e.QP=b,e.Zoa=b,e.IR=b),e.unbind(o.Events.TableFiltered+R.bIc),e.unbind(o.Events.RangeFiltered+R.bIc),e.unbind(o.Events.FloatingElementSelected+R.bIc)},setHost:function(t){if(t){var e=this;e.bind(o.Events.TableFiltered+R.bIc,(function(){e.AR()})),e.bind(o.Events.RangeFiltered+R.bIc,(function(){e.AR()})),e.bind(o.Events.FloatingElementSelected+R.bIc,(function(t,n){"floatingObject"!==n.type&&e.uQ()}))}},onLayoutChanged:function(t){var e=t.changeType,n=t.row,o=t.rowCount,r=t.col,i=t.colCount,a=this.wr;"addRows"===e?function(t,e,n){t.zR().forEach((function(t){t.rI(e,n)}))}(a,n,o):"deleteRows"===e?function(t,e,n){var o,r,i=[];for(t.zR().forEach((function(o){ot(e,-1,e+n-1,t.sheet().getColumnCount(),o)&&(o.dynamicMove()||o.dynamicSize())?i.push(o):o.GR(e,n)})),r=i.length,o=0;o<r;o++)t.Fb(i[o].name())}(a,n,o):"addColumns"===e?function(t,e,n){t.zR().forEach((function(t){t.tI(e,n)}))}(a,r,i):"deleteColumns"===e&&function(t,e,n){var o,r,i=[];for(t.zR().forEach((function(o){ot(-1,e,t.sheet().getRowCount(),e+n-1,o)&&(o.dynamicMove()||o.dynamicSize())?i.push(o):o.HR(e,n)})),r=i.length,o=0;o<r;o++)t.Fb(i[o].name())}(a,r,i)},paint:function(t){var e=t.clipRect;this.QP(e)},lastNonNullRowAndCol:function(){var t=0,e=0,n=this.wr;return n&&n.zR().forEach((function(n){n&&(n[R.qHc]()>t&&(t=n[R.qHc]()),n[R.sHc]()>e&&(e=n[R.sHc]()))})),{lastNonNullRow:t,lastNonNullCol:e}},toJson:function(t,e){var n;e&&e.ignoreStyle||(n=this.wr.toJSON()).length>0&&(t.floatingObjects=n)},fromJson:function(t,e,n){var o,r,i;n&&n.ignoreStyle||((o=this).wr=new q(o),o.ITa.wr=o.wr,r=t&&t.floatingObjectArray,(i=e?r&&r.floatingObjects:t.floatingObjects)&&o.wr.fromJSON(i,e))},preProcessMouseDown:function(t){var e,n,o=t.e,r=this.Vs(),i=o.pageX-r.left,a=o.pageY-r.top;!this.Cw&&this.Cva&&((n=(e=this.hitTest(i,a))&&e.formulaRangeHitInfo)&&(n.inBorder||n.inTopLeft||n.inTopRight||n.inBottomLeft||n.inBottomRight))||this.uQ()},processKeyDown:function(t){var e,n,o,r=this.wr;if(r)for(n=void 0,o=(e=r.zR()).length,n=0;n<o;n++)if(e[n].isSelected())return void(t.r=!0)},onGroupChanged:function(t){this.floatingObjects.tTa(t.start,t.end,t.isRow),this.pictures.tTa(t.start,t.end,t.isRow)}},o.Worksheet.$n(R.hHc,et),nt={init:function(){o.Commands.JR(this.commandManager())}},o.Workbook.$n(R.hHc,nt),o.GC$.extend(o.lUa.prototype,{BUa:function(t,e,n){var o,r=this.zTa;r&&((o=r.CUa)||(o=r.CUa=[]),o.push({type:"property",floatingObject:t,name:e,value:n}))},AUa:function(){var t,e,n,r=this.zTa;r&&((t=r.CUa)||(t=r.CUa=[]),e={},n=this.wr,o.GC$.each(n.QR,(function(t,n){e[t]=n})),t.push({type:"collection",floatingObjects:e}))},DUa:function(t){var e,n,o,r,i,a,s;if(t)for(e=this.wr,n=t.length-1;n>=0;n--)"collection"===(o=t[n]).type?e.QR=o.floatingObjects:"property"===o.type&&(r=["startRow","startRowOffset","startColumn","startColumnOffset","endRow","endRowOffset","endColumn","endColumnOffset"],i=o.floatingObject,a=o.name,s=o.value,i[a](s),r.indexOf(a)>=0&&(ut(i),bt(i),i.sheet().$p()))}}),o.lUa.$n(R.hHc,{init:function(){this.wr=new q(this.kj)},undo:function(t){var e=t.CUa;e&&this.DUa(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.wr&&(e.wr.no(),e.wr=b)}})},"./dist/plugins/floatingObject/floatingobject.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/floatingObject/floatingobject.res.en.js");e.SR={en:o}},"./dist/plugins/floatingObject/floatingobject.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_FloatingObjectHasSameNameError="The current worksheet already has a floating object with the same name.",e.Exp_FloatingObjectNameEmptyError="Floating object must have name"},"./dist/plugins/floatingObject/picture.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function x(t){return"number"==typeof t&&!isNaN(t)}function S(t){var e,n,r=t,i=r.src(),a=r.sheet();r.bt||(r.bt=new o.oo((function(){S(r)}))),e=r.bt;try{e.ko(i)?(r.oS=!0,n=e.lo(i),r.KS=n.width,r.LS=n.height,r.tmb&&r.tmb%90==0&&(r.qmb=function(t,e,n,o){var r,i,a=e,s=n;return 90!==o&&270!==o||(a=n,s=e),(r=document.createElement("canvas")).width=a,r.height=s,(i=r.getContext("2d")).translate(a/2,s/2),i.rotate(o/180*Math.PI),i.translate(-a/2,-s/2),i.drawImage(t,0,0,e,n,(a-e)/2,(s-n)/2,e,n),i.setTransform(1,0,0,1,0,0),r.toDataURL()}(n,n.width,n.height,r.tmb)),r.JS&&(r.width(n.width,!0),r.height(n.height,!0),r.JS=!1),r.isVisible()&&a&&a.repaint()):e.fo(i)}catch(t){}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("./dist/plugins/floatingObject/floatingobject.js"),i=o.Ul.Nl,a=o.Ul.Pl,s=o.GC$,l=null,u=void 0,v=[c="src",f="backColor",p="borderRadius",d="borderWidth",g="borderStyle",y="noFill",m="borderColor",h="pictureStretch"],r.FloatingObject.ozb=function(t,e,n,o,r,i){return new C(t,e,n,o,r,i)},C=function(t){function e(e,n,o,r,i,a){var s=t.call(this,e,o,r,i,a)||this,u=s;return u.typeName="1",u.g3="1",u.bt=l,u.oS=!1,u.JS=!1,"string"==typeof n&&(u.JS=!i||!a,u.src(n)),s}return T(e,t),e.prototype.onPropertyChanged=function(t,e,n){var o,r=this;r.TR||(o=r.sheet())&&(o.ITa.BUa(r,t,n),this.Wq({sheet:o,sheetName:o.name(),picture:r,propertyName:t}))},e.prototype.toJSON=function(){var e,n,o,i=this,a=t.prototype.toJSON.call(this);return r.toJsonFn.call(i,v,a),a.originalWidth=i.getOriginalWidth(),a.originalHeight=i.getOriginalHeight(),i.tmb&&(a.rot=i.tmb),(e=i.rmb)&&(n=e.left,o=e.top,a.srcRect={l:n,t:o,r:1-n-e.width,b:1-o-e.height}),delete a.content,a},e.prototype.fromJSON=function(e,n,o){var i,a,s,l;e&&((i=this).TR=!0,o&&(x(e.x)&&x(e.y)&&x(e.width)&&x(e.height)&&(e.endRow=null,e.endRowOffset=null,e.endColumn=null,e.endColumnOffset=null)),t.prototype.fromJSON.call(this,e,n),r.fromJsonFn.call(i,v,e,n),e.rot&&(i.tmb=e.rot),i.oS=!1,(a=e.srcRect)&&(s=a.l,l=a.t,i.rmb={left:s,top:l,width:1-s-a.r,height:1-l-a.b}),S(i),i.TR=u)},e.prototype.clone=function(){var t=new e,n=JSON.stringify(this.toJSON());return t.fromJSON(JSON.parse(n)),t},e.prototype.getOriginalWidth=function(){return this.KS},e.prototype.getOriginalHeight=function(){return this.LS},e.prototype.nS=function(t){return["dotted","dashed","solid","double","groove","ridge","inset","outset"].indexOf(t)>=0},e.prototype.WR=function(t,e){var n=i("div");return s(n).addClass("gc-floatingobject-content-container").addClass("gc-no-user-select").attr("unselectable","on").css("position","absolute"),this.UR(n,t,e),n},e.prototype.Wq=function(t){var e,n=this.sheet();n&&(n.Wq(o.Events.PictureChanged,t),"isSelected"===t.propertyName&&(e={sheet:t.sheet,sheetName:t.sheetName,picture:t.picture},n.Wq(o.Events.PictureSelectionChanged,e)))},e.prototype.no=function(t){var e=this;e.bt&&!1!==t&&(e.bt.no(),e.bt=l)},e}(r.FloatingObject),e.Picture=C,b=[[c,u,function(t,e){var n=this;n.oS=!1,S(n),n.srccallback||(n.srccallback=r.propertyRefreshCallback(c)),n.srccallback.call(n,t,e)}],[f,l,r.propertyRefreshCallback(f)],[p,-1,r.propertyRefreshCallback(p),x],[d,1,r.propertyRefreshCallback(d),x],[g,"none",function(t,e){var n=this;n.nS(t)||n.borderWidth(0),n.bscallback||(n.bscallback=r.propertyRefreshCallback(g)),n.bscallback.call(n,t,e)}],[y,u],[m,l,r.propertyRefreshCallback(m)],[h,0,r.propertyRefreshCallback(h)]],w=C.prototype,s.each(b,(function(t,e){w[e[0]]=a(e[0],e[1],e[2],e[3])}))},"./dist/plugins/formulaTextbox/formulaTextBox.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/formulaTextbox/formulatextbox.js")),o(n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js")),n("./dist/plugins/formulaTextbox/formulatextbox-event.js"),n("./dist/plugins/formulaTextbox/formulatextbox-actions.js"),n("./dist/plugins/formulaTextbox/formulatextbox-render.js")},"./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js":function(t,e,n){"use strict";var o,r,i,a;function s(t){var e=o.Ul.Nl("textarea");return o.GC$(e).css({display:"none"}),o.GC$(t).append(e),e}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("./dist/plugins/formulaTextbox/formulatextbox.js"),e.W4=s,i=function(){function t(){var t=this;t.nT=-1,t.Mk=-1,t._text="",t.Q2=-1,t.kj=null,t.MH=!1,t.R2=-1,t.I0=null,t.OC=null,t.f1=null}return t.prototype.$b=function(){var t=this;t.S2(),t.nT=-1,t.Mk=-1,t._text="",t.Q2=-1,t.MH=!1,t.R2=-1,t.kj=null,t.OC=null,t.f1=null},t.prototype.S2=function(){var t,e,n=this;n.kj.Js||(t=n.kj.getCellType(n.nT,n.Mk),e={sheet:n.kj,row:n.nT,col:n.Mk,sheetArea:3},n.I0&&n.I0.firstChild&&t.deactivateEditor(n.I0.firstChild.firstChild,e)),o.GC$(n.I0).remove(),n.I0=null},t.prototype.T2=function(t){var e=this,n=t.Cw;n&&(e._text=n.text(),e.nT=t.getActiveRowIndex(),e.Mk=t.getActiveColumnIndex(),e.Q2=n.caret(),e.MH=n.MH,e.R2=n.C1(),e.V4=n.V4,e.C5=n.C5,e.Nfa=n.Nfa,e.kj=t,e.OC=t.parent,e.f1=t.mm.bG())},t.prototype.VF=function(t){var e=this;t.Cw&&(e._text=t.Cw.text(),e.Q2=t.Cw.caret(),e.MH=t.Cw.MH,e.R2=t.Cw.C1())},t.prototype.U2=function(t){var e=this,n=t.Cw;n&&(n.V4=e.V4,n.C5=e.C5,n.Nfa=e.Nfa,n.text(e._text),n.caret(e.Q2),e.MH&&(n.B1(),n.C1(e.R2)))},t.prototype.V2=function(t){var e,n=t.oldSheet,o=this,r=n&&n.Cw;if(r)if(r.close(),(!o.kj||o.kj.Js)&&r.M0()||o.C5!==r.C5){o.T2(n),e=n.getValue(n.Jl,n.Kl,3),n.suspendEvent();try{if(!n.endEdit(!0))return}finally{n.resumeEvent()}n.setValue(n.Jl,n.Kl,e,3,!0),n.Px=1,t.needTriggerSheetChange=!1}else o._text&&(o.VF(n),r.destroy(),n.Cw=null,t.needTriggerSheetChange=!1)},t.prototype.W2=function(t){var e,n=t.oldSheet,o=t.newSheet,i=this;o.Js||(i.I0&&""===i._text&&(n.GJ(),i.$b()),i._text&&i.kj===o?(o.Px=0,o.zt(),o.suspendEvent(),i.V4?(e=s(o.parent.qo),r.J0(o,e),o.Px=2,o.yl.uH()):o.startEdit(!1),o.resumeEvent(),i.U2(o),i.VK(o,i.nT,i.Mk),n.GJ(),i.$b()):i._text&&!i.I0?(o.Px=1,n.Px=1,i.X2(o),o.EJ()):i._text&&i.kj!==o&&(o.Px=1,n.Px=1,i.X2(o),n.GJ(),o.EJ()))},t.prototype.X2=function(t){var e,n,i,a,s,l,u,c=this,f=c.kj;f.Js||(e=c.nT,n=c.Mk,i=f.getCellType(e,n),a={sheet:f,row:e,col:n,sheetArea:3,canvasOffset:this.f1},i.isImeAware(a)&&(t.Px=1,s=i.a5(a),c.I0&&c.S2(),c.I0=s,o.GC$(s).css("position","absolute"),l=f.getCellRect(e,n),o.GC$(s).attr("id","across"),u=f.getActualStyle(e,n),i.d5(s,u,l,a),(c.OC&&c.OC.getHost()||document.body).insertBefore(s,null),c.V4&&o.GC$(s).css({display:"none"}),r.J0(t,i.getEditingElement(),!0),s.firstChild&&!c.V4&&i.focus(s.firstChild.firstChild),c.U2(t),i.g5(s,u,l,a)))},t.prototype.VK=function(t,e,n){var o,r=t.getCellType(e,n),i=t.BF,a=t.am(),s=t.getActualStyle(e,n),l=t.getCellRect(e,n);l&&l.width>0&&l.height>0&&l.x>=a.kt&&l.y>=a.nt&&l.x+l.width<=a.lt+a.js&&l.y+l.height<=a.ot+a.gs&&(o={sheet:t,row:e,col:n,sheetArea:3},i&&i.parentNode&&r.g5(i.parentNode.parentNode,s,l,o,!0))},t}(),a=function(){function t(){}return t.Q0=function(e,n){t.H0||(t.H0=new i),t.H0.V2(n)},t.R0=function(e,n){t.H0||(t.H0=new i),t.H0.W2(n)},t}(),e.G0=a},"./dist/plugins/formulaTextbox/formulatextbox-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u;function c(t){var e=t.Cw,n=t.mm;return e.MH?n.E2:n.E2={anchorRow:t.Jl,anchorCol:t.Kl,leadingRow:t.Qr,leadingCol:t.Rr}}function f(t,e,n,r,a){var s,u,f,h,p,d,g,m,y,v,C,b,w=t.Cw,T=t.parent,x=T&&T.options;if(w&&w.M0()&&x&&x.allowUserEditFormula&&x.enableFormulaTextbox){switch(u=(s=c(t)).anchorRow,f=s.anchorCol,h=s.leadingRow,p=s.leadingCol,l(r)&&(r=u),l(a)&&(a=f),d=t.mm,e){case 3:C=t.iy(r,a,n,h);break;case 4:C=t.hy(r,a,n,h);break;case 1:C=t.HJ(r,a,n,p);break;case 2:C=t.LJ(r,a,n,p);break;case 5:C=t.OJ();break;case 6:C=t.NJ()}C&&(g=C.row,m=C.col,y=C.leadingCellRow?C.leadingCellRow:g,v=C.leadingCellCol?C.leadingCellCol:m,t.IJ(g,m)&&(s.anchorRow=g,s.anchorCol=m,s.leadingRow=y,s.leadingCol=v,(b=i.C2(d.kj,o.kf(g,m,1,1)))&&w.v1(b,!1,!0),g>=0&&m>=0&&t.Yq(g,m)))}}function h(t,e,n){var r,a,s,l,u,f,h,p,d=t.Cw,g=t.parent,m=g&&g.options;d&&d.M0()&&m&&m.allowUserEditFormula&&m.enableFormulaTextbox&&(r=t.mm,s=(a=c(t)).anchorRow,l=a.anchorCol,d.MH?(f=d.m1(),u=i.L0(t,f.text)):u=o.kf(s,l,1,1),u&&(h=t.UJ(u,e,n,s,l),(p=i.C2(r.kj,h))&&d.v1(p,!0,!1)))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/formulaTextbox/formulatextbox.js"),a=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),s=void 0,l=r.Common.j.Fa,o.Commands.Ox=function(t,e){if(t){if(2===t.Px)return!1;var n=t.Cw;return n&&n.M0()?(f(t,e,!1),!0):(n&&(t=u.O2(t)),t.yx(e,!1),!0)}return!1},o.Commands.Qx=function(t,e,n,o){if(t){if(2===t.Px)return!1;var r=t.Cw;return r&&r.M0()?(f(t,e,!1,n,o),!0):(r&&(t=u.O2(t)),t.yx(e,!1,n,o),!0)}return!1},o.Commands.Rx=function(t,e,n){if(t){if(2===t.Px)return!1;var o=t.Cw;return o&&o.M0()?(h(t,e,n),!0):(o&&(t=u.O2(t)),!!t.endEdit()&&(t.Sx(e,n),!0))}return!1},u=function(){function t(){}return t.fv=function(e){return t.O2(e)},t.Xx=function(e){return t.O2(e)},t.Yx=function(e){return t.O2(e)},t.O2=function(e){var n=e,o=a.G0.H0;return o&&o._text&&(n=o.kj,t.G2(n)),n},t.G2=function(t,e){var n,o;void 0===e&&(e=!0),n=t.parent,(o=a.G0.H0)&&o._text&&n.hw(t,e)},t.Zx=function(e,n,r){var a,s,l=!1,u=e.Cw;return u&&u.M0()?((a=c(e)).anchorRow=n,a.leadingRow=n,(s=i.C2(e,o.kf(a.anchorRow,a.anchorCol,1,1)))&&u.v1(s,!1,!0),e.mq(r),l=!0):u&&(e=t.O2(e)),{sheet:e,r:l}},t._x=function(e,n,r){var a,s,l=!1,u=e.Cw;return u&&u.M0()?((a=c(e)).anchorRow=n,a.leadingRow=n,(s=i.C2(e,o.kf(a.anchorRow,a.anchorCol,1,1)))&&u.v1(s,!1,!0),e.mq(r),l=!0):u&&(e=t.O2(e)),{sheet:e,r:l}},t.pzb=function(e,n){var o=!1,r=n?5:6,i=e.Cw,a=e.Jl,s=e.Kl;return i&&i.M0()?(i.MH||(e.mm.E2={anchorRow:a,anchorCol:s,leadingRow:e.Qr,leadingCol:e.Rr}),f(e,r,!1,a,s),o=!0):i&&(e=t.O2(e)),{sheet:e,r:o}},t.ay=function(e){return t.pzb(e,!0)},t.by=function(e){return t.pzb(e,!1)},t.ey=function(e){return t.O2(e)},t.gy=function(e){return t.O2(e)},t.jy=function(e){var n,o,r,l=a.G0.H0;if(l&&l._text&&(e=l.kj,n=l.nT,o=l.Mk,t.G2(e,!1),i.K0(e),e.Sr(n,o,s,s,1),e.isEditing()))return r=e.getValue(n,o,3),!!e.gv(!0,void 0,void 0,!0)&&(e.setValue(n,o,r,3,!0),!0)},t}(),o.Commands.Wx=u},"./dist/plugins/formulaTextbox/formulatextbox-event.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("@grapecity/js-calc"),i=n("SheetsCalc"),a=n("./dist/plugins/formulaTextbox/formulatextbox.js"),s=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),l=o.GC$.extend,u=null,c=void 0,f=Math.max,h=Math.min,l(o.iI.prototype,{D2:function(t){var e,n,r,i,s,l,u,f,h,p,d,g,m,y,v,C,b,w=this,T=w.kj,x=T.Cw;x&&(w.Kka(),e=T.frozenRowCount(),n=T.frozenColumnCount(),(r=x.MH)&&w.E2||(w.E2={anchorRow:-1,anchorCol:-1,leadingRow:-1,leadingCol:-1}),i=T.getRowCount(),s=T.getColumnCount(),l=t.hitTestType,u=t.row,f=t.col,h=w.shift,p=w.ctrl,g=(d=w.E2).anchorRow,m=d.anchorCol,y=-1,v=-1,0===l?(y=e?T.ar():T.lq,v=n?T.$q():T.qq,C=o.kf(-1,-1,-1,-1),x.v1(a.C2(T,C),h,!p),w.OG=!0):1===l?(y=e?T.ar():T.lq,v=f,C=T.Jx(0,f,i-1,f,!0),h&&m>=0&&(C=T.Jx(0,f,i-1,m,!0)),C=o.kf(-1,C.col,-1,C.colCount),x.v1(a.C2(T,C),h,!p),w.OG=!0):2===l?(y=u,v=n?T.$q():T.qq,C=T.Jx(u,0,u,s-1,!0),h&&g>=0&&(C=T.Jx(u,0,g,s-1,!0)),C=o.kf(C.row,-1,C.rowCount,-1),x.v1(a.C2(T,C),h,!p),w.OG=!0):3===l&&(y=u,v=f,u!==c&&f!==c&&((b=t.tableSelectInfo&&t.tableSelectInfo.tableSelection)?C=b:(C=T.Jx(u,f,u,f,!0),C=o.kf(C.row,C.col,1,1),h&&g>=0&&m>=0&&(C=T.Jx(u,f,g,m,!0))),x.v1(a.C2(T,C),h,!p)),w.OG=!0),w.DG=w.OG,h&&r||(d.anchorRow=y,d.anchorCol=v,d.leadingRow=y,d.leadingCol=v),w.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},w.qG())},F2:function(t){var e,n,r=!1,i=s.G0.H0;if(i&&i.I0)if(e=i.kj,(n=t.Cw)&&e.setFormula(i.nT,i.Mk,n.text()),e!==t){if(o.Commands.Wx.G2(e),!e.endEdit())return;r=!0}else n&&(n.destroy(),t.Cw=u),i.$b();return r},EG:function(){var t,e=this,n=e.rG;n&&e.OG&&(3===(t=n.sG)?e.H2():2===t?e.I2():1===t&&e.J2())},H2:function(){var t,e,n,o=this,r=o.E2,i=r.anchorRow,s=r.anchorCol,l=o.fH(),u=o.gH();i>=0&&s>=0&&l>=0&&u>=0&&(e=(t=o.kj).Jx(l,u,i,s,!0),(n=a.C2(t,e))&&t.Cw.v1(n,!0,!1)),o.NG()},I2:function(){var t,e,n,r=this,i=r.E2.anchorRow,s=r.fH();i>=0&&s>=0&&(e=(t=r.kj).Jx(s,0,i,t.getColumnCount()-1,!0),e=o.kf(e.row,-1,e.rowCount,-1),(n=a.C2(t,e))&&t.Cw.v1(n,!0,!1)),r.NG()},J2:function(){var t,e,n,r=this,i=r.E2.anchorCol,s=r.gH();i>=0&&s>=0&&(e=(t=r.kj).Jx(0,s,t.getRowCount()-1,i,!0),e=o.kf(-1,e.col,-1,e.colCount),(n=a.C2(t,e))&&t.Cw.v1(n,!0,!1)),r.NG()},yH:function(){var t=this;t.RG(),t.rG=u,t.OG=!1,t.DG=!1},iG:function(t){var e,n,o,r,i,s,l,u,c=this,f=c.kj,h=c._oa(),p=t.formulaRangeHitInfo;p&&p.inBorder&&h&&(h.MH&&h.NH(),h.close(),(n=(e=p.paramRange)&&e.text)&&((o=a.L0(f,n))&&(c.Kka(),r=f.Tq(o),i=t.row,s=t.col,i<r.row&&(i=r.row),i>=r.row+r.rowCount&&(i=r.row+r.rowCount-1),s<r.col&&(s=r.col),s>=r.col+r.colCount&&(s=r.col+r.colCount-1),l=i-r.row,u=s-r.col,c.OG=!0,c.FG=!0,c.K2={paramRange:e,fromRange:o,rowOffset:l,colOffset:u},c.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},c.qG())))},GG:function(){var t,e,n,r,i,s,l,u,c,p,d,g,m,y,v,C,b,w,T,x,S=this;S.OG&&S.FG&&(t=S.fH(),e=S.gH(),t>=0&&e>=0&&(r=(n=S.K2).fromRange,i=n.rowOffset,s=n.colOffset,l=n.toRow,u=n.toCol,p=e,(c=t)===l&&p===u||(n.toRow=c,n.toCol=p,g=(d=S.kj).getRowCount(),m=d.getColumnCount(),y=r.row,v=r.col,C=r.rowCount,b=r.colCount,w=y<0?-1:f(0,h(g-C,t-i)),T=v<0?-1:f(0,h(m-b,e-s)),(x=a.C2(d,o.kf(w,T,C,b)))&&S._oa().D1(n.paramRange.index,x,!0))),S.NG())},zH:function(){var t,e=this;e.RG(),e.OG=!1,e.FG=!1,e.K2=u,(t=e._oa()).onRangeMoved&&t.onRangeMoved()},jG:function(t){var e,n,o,r,i,s,l,u,c,f,h,p=this,d=p.kj,g=p._oa(),m=t.formulaRangeHitInfo;if(m&&g&&(g.MH&&g.NH(),n=(e=m.paramRange)&&e.text,e&&n&&(o=a.L0(d,n)))){if(p.Kka(),r=o.row,i=o.row<0?-1:o.row+o.rowCount-1,s=o.col,l=o.col<0?-1:o.col+o.colCount-1,m.inTopLeft)u=i,c=l,f=r,h=s;else if(m.inTopRight)u=i,c=s,f=r,h=l;else if(m.inBottomLeft)u=r,c=l,f=i,h=s;else{if(!m.inBottomRight)return;u=r,c=s,f=i,h=l}p.OG=!0,p.HG=!0,p.L2={paramRange:e,anchorRow:u,anchorCol:c,toRow:f,toCol:h},p.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},p.qG()}},kG:function(t,e){var n=t.Cw;return n&&n.M0()?(this.D2(e),!0):!!this.F2(t)},IG:function(){var t,e,n,r,i,s,l,u,c,p,d,g,m,y,v,C,b,w,T,x=this;x.OG&&x.HG&&(t=x.fH(),e=x.gH(),t>=0&&e>=0&&(r=(n=x.L2).anchorRow,i=n.anchorCol,s=n.toRow,l=n.toCol,c=e,(u=t)===s&&c===l||(n.toRow=u,n.toCol=c,d=(p=x.kj).getRowCount(),g=p.getColumnCount(),y=i<0?g-1:i,v=h(m=r<0?d-1:r,u),C=h(y,c),b=f(m,u)-v+1,w=f(y,c)-C+1,0===v&&b===d&&(v=-1,b=-1),0===C&&w===g&&(C=-1,w=-1),(T=a.C2(p,o.kf(v,C,b,w)))&&x._oa().D1(n.paramRange.index,T,!0))),x.NG())},AH:function(){var t,e,n=this;n.RG(),n.OG=!1,n.HG=!1,n.L2=u,(t=n._oa()).V4&&(t.W0=1,-1!==(e=t.text().lastIndexOf(",",t.caret()))&&(t.W0=e+1)),t.onRangeResized&&t.onRangeResized()},vr:function(t,e,n){var o,r,i,l,c,f,h,p,d,g,m,y=this.kj,v=this._oa(),C=v&&v.l1();if(!C||0===C.length||!v.UQa)return u;if(o=t.rowViewportIndex,r=t.colViewportIndex,this.qH(o,r,e,n))return u;for(f=C.length-1;f>=0;f--)if(!1!==(i=C[f]).allowDrag&&((!(h=s.G0.H0)||!h._text)&&(l=a.L0(y,i.text)))){if(5,p=(c=y.getRangeRect(o,r,l)).x-2,d=c.x+c.width+1-5,g=c.y-2,m=c.y+c.height+1-5,p+5<=e&&e<d&&(g+1<=n&&n<=g+3||m+1<=n&&n<=m+3))return{paramRange:i,inBorder:!0};if(g+5<=n&&n<m&&(p+1<=e&&e<=p+3||d+1<=e&&e<=d+3))return{paramRange:i,inBorder:!0};if(d<=e&&e<d+5&&m<=n&&n<m+5)return{paramRange:i,inBottomRight:!0};if(p<=e&&e<p+5&&m<=n&&n<m+5)return{paramRange:i,inBottomLeft:!0};if(d<=e&&e<d+5&&g<=n&&n<g+5)return{paramRange:i,inTopRight:!0};if(p<=e&&e<p+5&&g<=n&&n<g+5)return{paramRange:i,inTopLeft:!0}}return u},_oa:function(){var t=this.kj;return t.Cw||t.Cva},ly:function(){var t,e,n,o,a,s,l,c,f,h,p,d,g=this,m=g.kj,y=m.Cw;if(y)if(t=m.Jl,e=m.Kl,o=(n=m.parent)&&1===n.options.referenceStyle,a=new i.SheetParserContext(m,o,r.pf(t,e)),s=new r.Parser,y.MH)for(f=y.u1(),h=0;h<f.length;h++){l=f[h];try{c=s.parse(a,l.text)}catch(t){c=u}c&&1===c.type&&(g.M2(c,t,e,!0,!0),y.D1(l.index,s.unparse(a,c)))}else{if(!(l=y.m1()))return;try{c=s.parse(a,l.text)}catch(t){c=u}if(!c)return;1!==c.type||c.sf()?1===c.type&&(g.N2(c,t,e),y.D1(l.index,s.unparse(a,c))):(p=l.textOffset+l.text.lastIndexOf(":"),y.caret()<=p?(g.M2(c,t,e,!0,!1),d=s.unparse(a,c),y.D1(l.index,d),y.caret(l.textOffset+d.lastIndexOf(":"))):(g.M2(c,t,e,!1,!0),y.D1(l.index,s.unparse(a,c))))}},M2:function(t,e,n,o,r){var i,a,s=t.rowRelative,l=t.columnRelative;o&&(s&&l?(t.rowRelative=!1,t.columnRelative=!1,t.row+=e,t.column+=n):s?(t.columnRelative=!0,t.column-=n):l?(t.rowRelative=!0,t.columnRelative=!1,t.row-=e,t.column+=n):(t.columnRelative=!0,t.column-=n)),i=t.endRowRelative,a=t.endColumnRelative,r&&(i&&a?(t.endRowRelative=!1,t.endColumnRelative=!1,t.endRow+=e,t.endColumn+=n):i?(t.endColumnRelative=!0,t.endColumn-=n):a?(t.endRowRelative=!0,t.endColumnRelative=!1,t.endRow-=e,t.endColumn+=n):(t.endColumnRelative=!0,t.endColumn-=n))},N2:function(t,e,n){var o=t.rowRelative,r=t.columnRelative;o&&r?(t.rowRelative=!1,t.columnRelative=!1,t.row+=e,t.column+=n):o?(t.columnRelative=!0,t.column-=n):r?(t.rowRelative=!0,t.columnRelative=!1,t.row-=e,t.column+=n):(t.columnRelative=!0,t.column-=n)},Kka:function(){var t,e=this.kj.Cw;e&&((t=e.qo)&&e.Cia(t)&&e.Jka())}})},"./dist/plugins/formulaTextbox/formulatextbox-render.js":function(t,e,n){"use strict";var o,r,i,a,s,l;function u(t,e,n,o,s,u){var c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P=t.kj,_=P.mm,L=u&&u.l1(),B=L&&L.length;if(!(B<=0)&&(c=t.VI(n,o,s))){for(e.save(),e.rect(c.x,c.y,c.width,c.height),e.clip(),e.beginPath(),f=[],h=_.isFormulaRangeHoving,p=_.tH,d=_.FG,g=_.K2,m=_.HG,y=_.L2,x=0;x<B;x++)if(C=(v=L[x]).text,b=v.ranges&&v.ranges.length>0?v.ranges:[i.L0(P,C)]){if((S=a.G0.H0)&&S.kj)if(l.Bb(C,"!")){if(A=l.Ib(C,"!"),P.name()!==A&&"'"+P.name()+"'"!==A)continue}else if(I=l.Ib(C,"["),R=P.tables,!(P.getCustomNames()[I]||R&&R.findByName(I)))continue;for(w=t.XI(n,o,b,c),k=0;k<w.length;k++)(M=w[k])&&M.width>0&&M.height>0&&(T=u.o1(x),u.t1(v)?(h&&p.paramRange.index===x&&(e.beginPath(),e.lineWidth=2,e.strokeStyle=T,e.rect(M.x+1,M.y+1,M.width-3,M.height-3),e.stroke()),t.fJ(e,M,T)):h&&p.paramRange.index===x||d&&g.paramRange.index===x||m&&y.paramRange.index===x?(e.beginPath(),e.lineWidth=2,e.strokeStyle=T,e.rect(M.x+1,M.y+1,M.width-3,M.height-3),e.stroke()):(e.beginPath(),e.lineWidth=2,e.strokeStyle=T,e.rect(M.x,M.y,M.width-1,M.height-1),e.stroke()),u.n1(v)&&((N=r.Common.pc.ec(T)).a=.1,e.beginPath(),e.fillStyle=r.Common.pc.bc(N),e.fillRect(M.x+1,M.y+1,M.width-3,M.height-3)),f.push({rect:M,color:T,allowDrag:v.allowDrag}))}if(f.length>0&&u.UQa)for(E=f.length,x=0;x<E;x++)M=f[x].rect,T=f[x].color,5,D=M.x-2,O=M.x+M.width+1-5,j=M.y-2,F=M.y+M.height+1-5,!1!==f[x].allowDrag&&((S=a.G0.H0)&&S._text||(e.beginPath(),e.fillStyle=T,e.fillRect(D,j,5,5),e.fillRect(O,j,5,5),e.fillRect(D,F,5,5),e.fillRect(O,F,5,5)));e.beginPath(),e.restore()}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/formulaTextbox/formulatextbox.js"),a=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),s=o.GC$.extend,l=r.Common.u,s(o.oJ.prototype,{uH:function(){var t,e,n=this,o=n.kj;o.Xq>0||(t=o.am(),e=n.bm(),n.Mx(t.x,t.y,t.width,t.height),n.Pw(e))}}),o.Worksheet.$n("formulatextboxrender",{paintAdornment:function(t){var e,n,o,r=this,i=t.ctx,a=t.clipRect,s=r.yl,l=r.am(),c=r.mm._oa();if(c)for(n=0;n<=2;n++)for(o=0;o<=2;o++)(e=l.Ft(n,o))&&0!==e.width&&0!==e.height&&u(s,i,n,o,a,c)}})},"./dist/plugins/formulaTextbox/formulatextbox.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B;function G(t){return t.getActiveSheet()}function H(t){var e,n=[];return a.GC$.each(t,(function(t,o){(e=o.description())&&(e.name=t,n.push(e))})),n}function V(t){var e=o.getMapping()&&o.getMapping().builtInFunctionsMapping;return e&&e[t]&&e[t].alias||t}function z(t,e,n){var r,i,s,l,u,c=t.parent,f=c&&c.options;(e&&f&&f.allowUserEditFormula&&f.enableFormulaTextbox||n)&&(t.Cw&&t.Cw.destroy(),t.Cw=new B(e,null,c),r=t.Cw.text(),i=t.getFormulaInformation(t.Jl,t.Kl),"="!==r[0]||i&&i.hasFormula||(r="'"+r,t.Cw.text(r)),s=t.Cw,l=t.mm,u=t.yl,s.bind("AppendStarted",(function(){s.close();var e=t.Px;1!==e&&(t.Px=1,t.Cu(e,1))})),s.bind("AppendEnded",(function(){u.uH()})),s.bind(R,(function(e,n){if(!t.Js){if(n&&n.type!==x){l.Qw(n);var o=t.Jl,r=t.Kl,i=t.getCellType(o,r);t.Wq(a.Events.EditChange,{sheet:t,sheetName:t.name(),row:o,col:r,editingText:i.getEditorValue(t.BF)})}u.uH(),t.Wq(a.Events.FormulaTextBoxTextChanged,{sheet:t,sheetName:t.name(),text:s.text()})}})),s.bind("CaretChanged",(function(){u.uH(),t.Wq(a.Events.FormulaTextBoxCaretChanged,{sheet:t,sheetName:t.name(),caret:s.caret()})})),s.add(function(){var t=[];return a.GC$.each(o.sR()._h,(function(e,n){o.Functions.bi[e]&&(n.name=e,t.push(n))})),t}()),s.add(H(o.Functions.ci)),s.add(H(t.Su).concat(H(c.Su))),u.uH())}function W(t){t.Cw&&(t.Cw.destroy(),t.Cw=l,t.yl.uH());var e=t.parent&&t.parent.CF;g.activeElement===(e&&e.qo)&&t.mm.Qq()}function U(t){var e,n=["FILTER","RANDARRAY","SEQUENCE","SORT","SORTBY","UNIQUE"];for(e=0;e<n.length;e++)if(t===n[e])return!0}function q(t){return"gcAttachedFormulaTextBox"===t.target.getAttribute("gcuielement")}Object.defineProperty(e,"__esModule",{value:!0}),o=n("@grapecity/js-calc"),r=n("SheetsCalc"),i=n("Common"),a=n("Core"),s=n("./dist/plugins/formulaTextbox/formulatextbox-acrosssheet.js"),l=null,u=void 0,c=Math.max,f=Math.min,h=a.GC$.extend,p=a.Ul.Nl,d=window,g=document,m=i.Common.u,y=a.Ul.nl,v=a.Ul.Ml,C=v.msie&&parseInt(v.version,10)<10,b=m.Nb,w="formulatextbox",T="gcUIElement",x="input",S="Â ",A=".gcFormulaTextBoxInternal",I=".gcFormulaTextBox",R="TextChanged",k="CaretChanged",M={left:37,right:39,up:38,down:40,tab:9,enter:13,pup:33,pdn:34,end:35,home:36,esc:27},N=["#0000ff","#008000","#9900cc","#800000","#00cc33","#cc6600","#cc0099"],E='url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAJSSURBVDhPY3hILqBYZ/eqV81LXpbNfp7S/yS0+Z5p+olD5x5OWXGyYcaBmql7yifuLOnbBkRFPVuACKIFqjNzwv2Qhhue5ReByK/qYlDtxb///n35+efd1z/PP/wB6vn2+/f7b79ffgIhiBaoTlPP5I2bN2/asmX7jh3Hjh+ft3wLUOfX779ef/h+6+nHtXsuffrx+/bj16euvwQiiBaETiAy904NTasGantRkvA8wetpsO0NJ839htKb9l/Jal6T3rgytX4FEEG0QHXuOnbr55+/P379AyIg40m8x8uZ3U+aC49bKn64eHzX0es4Xds0Y9ejl++vPXx3+f77Nx9/3PU3e5YR/CTM4WGs53pVPqBrgX6+8+QNFtdmNq0q6NpU1LOpe/6+o+fvH3fR36XCc9dE/KG3EdDNQPaF7VunLTuY0bA0omg2RAtUZ1LNUohjgCEJDJVtdlpPty6dr8x3yUDsvoPqRm2hqcp8Jy+9WbH/7cQ1EB0wnXEVCyBBt+fc8+NXXy9Yf/znz5/31swFaliiKjBZme/yrSe7z36YsuZBy4KbEC1QnRFFcxKqFgP1A1Fq7ZKcpqU1EzYuWX/kxIa1/WBtizYcAwqG5E71SZsA0QLVGZI3A+Lax+/+ACMwvHDmsn1v1xx8e+jSp83HXgP1ALmztryYsv4ZEEG0QHUGZk+FuHbHqadABORO3fC8Z/mdvmU3Oxdd9cuY1LX0VsOci/WzQQiiBaET4lQgii1fEFU6F4iAXgC6JShnakDWZKBmoDshCKIFqpMMQK7Ohw8BTajNa73pg9oAAAAASUVORK5CYII=")',D="background",O="background-repeat",j="text-before",F="caret-before",e.C2=function(t,e){var n,o,i,u,c,f,h,p,d,g,m;return e?(n=t.Cw,u=(i=(o=s.G0.H0)&&o.kj||t).Jl,c=i.Kl,h=(f=t.parent)&&1===f.options.referenceStyle,p=15,t.Cw&&t.Cw.Nfa&&(p=0),e.row<0&&e.col<0&&(e=new a.Range(0,-1,t.getRowCount(),-1)),g=(d=t.tables)&&d.find(e.row,e.col),o&&o.Nfa&&(p=0),n&&!n.V4&&function(t,e){if(!t)return!1;var n=!1,o=!1;if(1===e.rowCount){if(t.hasHeadersRow()&&e.row===t.startRow())return!0;if(t.hasTotalsRow()&&e.row===t.endRow())return!0}else t.hasHeadersRow()&&e.row===t.startRow()&&(e.rowCount===t.dataRange().rowCount+1&&(n=!0),t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1+1&&(n=!0)),e.row===t.dataRange().row&&(e.rowCount===t.dataRange().rowCount&&(n=!0),t.hasTotalsRow()&&e.rowCount===t.dataRange().rowCount+1&&(n=!0));return e.col+e.colCount<=t.startColumn()+t.dataRange().colCount&&(o=!0),n&&o}(g,e)?(o&&o._text&&o.kj!==t&&(u=c=-1),r.rangeToFormulaWithStructReference(t,e,u,c,p,h,g)):(m=r.rangeToFormula(e,u,c,p,h),(o&&o._text||t.Cw&&t.Cw.V4&&t.Cw.ria)&&(m=function(t){var e=t.name();return r.jma(e.split(""),!1)?e:"'"+function(t){return t.replace(/'/g,"''")}(e)+"'"}(t)+"!"+m),m)):l},a.Events.FormulaTextBoxTextChanged="FormulaTextBoxTextChanged",a.Events.FormulaTextBoxCaretChanged="FormulaTextBoxCaretChanged",d.Yl.km.push((function(t,e){var n,o=s.G0;!e&&t.endEdit&&o&&((n=o.H0)&&n.I0&&t.Cw&&(t.Cw&&t.Cw.destroy(),t.Cw=l,n.$b()))})),e.J0=z,e.K0=W,e.L0=function(t,e){var n,o,i,a;if(!e)return l;i=(o=(n=s.G0.H0)&&n.kj||t).Jl,a=o.Kl;try{return r.formulaToRange(t,e,i,a)}catch(t){}return l},h(a.DC.prototype,{bE:function(t){return!(t&&t.Cw&&t.Cw.M0())}}),a.Worksheet.$n(w,{startEdit:function(t){z(this,t.element)},endEdit:function(){W(this)}}),P=a.DC.prototype,_=P.dE,a.DC.$n(w,{preProcessMouseDbClick:function(t){var e=G(this.OC),n=e?e.Cw:void 0,o=n&&n.M0(),r=s.G0.H0;o?t.r=!1:r&&r.I0&&r.$b()}}),P.dE=function(){var t=G(this.OC).Cw,e=s.G0.H0,n=e&&e._text;return _.call(this)&&!n&&!t},L=1,B=function(){function t(t,e,n){var o,r,i,l=this,u=t;if(l.V4=!1,l.Nfa=!1,l.ria=!0,l.Ac=[],l.Bc=[],l._gc=[],e&&e.rangeSelectMode&&(!0===e.absoluteReference&&(l.Nfa=!0),!1===e.needSheetName&&(l.ria=!1),l.V4=!0,l.D5=!1,l.E5=!1,l.cga=t,o=function(t,e){var n,o,r,i,s,l,u,c,f,h,d=a.GC$(t);return d.attr("contenteditable","false"),n=p("table"),a.GC$(n).css("border-spacing","0"),a.GC$(n).css("width","100%"),d.append(n),o=p("tbody"),n.appendChild(o),r=document.createElement("tr"),o.appendChild(r),i=document.createElement("td"),a.GC$(i).css("padding-right","0px"),r.appendChild(i),s=document.createElement("td"),a.GC$(s).css("width","23px"),a.GC$(s).css("padding-right","0px"),r.appendChild(s),l=d.width()-a.GC$(s).width(),u=p("div"),c=p("div"),a.GC$(c).width(l),a.GC$(c).css({"overflow-y":"auto","overflow-x":"hidden",height:"20px"}),c.appendChild(u),i.appendChild(c),f=p("div"),s.appendChild(f),a.GC$(u).css({display:"inline-block",float:"left",height:"auto",outline:"none"}),a.GC$(u).width(l),a.GC$(u).attr("contenteditable","true"),a.GC$(u).attr("spellcheck","false"),(h=a.GC$(f)).css({display:"block",float:"right",width:"23px",height:"23px",background:E,"background-repeat":"no-repeat"}),h.bind("click",(function(){e.D5?(e.OC.Wq("RangeSelectEnding",e),e.endSelectMode()):e.startSelectMode()})),{contentDiv:u,button:f}}(t,l),u=o.contentDiv,l.sia=o.button,l.tia=t,l.C5=L,L++),l.UQa=!0,l.ad(n&&n.getHost()||g.body),u&&l.N0(u),n&&(l.O0=!0,l.P0(n),l.OC.Gu(a.Events.FormulatextboxActiveSheetChanging,s.G0.Q0),l.OC.Fu(a.Events.FormulatextboxActiveSheetChanging,s.G0.Q0),l.OC.Gu(a.Events.FormulatextboxActiveSheetChanged,s.G0.R0),l.OC.Fu(a.Events.FormulatextboxActiveSheetChanged,s.G0.R0)),r=l.text(),l.S0=l.T0(r),l.Cia(u)){l.V0(l.S0);try{(i=d.getSelection()).selectAllChildren(u),i.rangeCount>0&&i.collapseToEnd()}catch(t){}a.GC$(l.qo).data(j,r)}}return t.prototype.j5=function(t){var e,n,o,r,i,a,l=this;l.O1(),l.UF(),l.E5=!0,e=s.W4(l.OC.qo),(n=l.a1()).suspendPaint(),z(n,e,!0),(o=n.Cw).V4=!0,o.C5=l.C5,o.Nfa=l.Nfa,o.ria=l.ria,t&&(l.text(t),l.caret(t.length)),r=l.text(),(i=l.caret())<=0&&(i=r.length),l.focus(),l.caret(i),l.MH=!0,l.W0=1,-1!==(a=r.lastIndexOf(",",i))&&(l.W0=a+1),r||(l.text("="),r="=",l.caret(1),i=1),0!==r.indexOf("=")&&(r="="+r,i++),o.text(r),o.caret(i),o.MH=l.MH,o.W0=l.W0,n.resumePaint()},t.prototype.startSelectMode=function(t){var e,n=t;n&&0!==n.indexOf("=")&&(n="="+n),(e=this).V4=!0,e.D5=!0,a.GC$(e.sia).css([D,O],['url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAARCAIAAACw+gCQAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAItSURBVDhPY3hILqBYZ/eqVxDUuvRl/cKXZbNf5E59ntT3DIgi2p/6NT5xq35iV/YYiCyLHkG0IHQuOvR/1t6/03b+mbD1d/eGXy2rf9Yu/wFE5Yu+Fc79mjXza+rUz0BkmHoWogXFTqCFVfNfQmwLa3vqVfsYiBzA9sCRftIJiBaozuYZO+89eAREt+4+AKIbt+9fvXkPiC5du3P28s0T564dOnV579Hz2w6cSaqcDdEC1Vk/ZQtQQ2vv7MaumbUd0+o6ZzT3zmnunQ1kF9T0pZe2J+U3x+U0bNx9MqZ4CkQLVGdB6xKgDaX1/b/+/PnyE4E+ff/z8uPvR29/3X35MzCxfPW2o2HZPRAtUJ2lXSuADkstann/9febz7/ff/3zLDP4Spj9Pjs1oE6gthvPfnpEFS7deDAwrRWiBaozv3kh0D8RadVAlFvZvWLDrjvRrk+bCrdpCS1ZsyOpoMU9ssA5NBeo0zuhDqIFqjO9Zubhk1eA6MT5G+eu3H78/PVFX/OnxQnrNQTuPnyx9+hFoA+B2uav2ecaVQ7RAtUZVzQBKH3g+KXTl24fdjE44mp4yFbtSYrfGg3+yQocQLTryEWgzgVr9zmEFkK0QHWGZbbvPHQOiI6cvnb5wMENhjJPE30eB1k9dFIDaruy/wAwPoA6563eaxOQDdEC1YkG1hvKrNKVuOEA0nYr2Pp5qA1UAglg1wkEW03lF2kI3wy1xaoNCHDqJAjI1fnwIQDHT83/UVFPcQAAAABJRU5ErkJggg==")',"no-repeat"]),e.j5(n)},t.prototype.endSelectMode=function(){this.D5=!1,this.H5(),a.GC$(this.sia).css([D,O],[E,"no-repeat"])},t.prototype.H5=function(){var t=this.a1();t&&(t.gv(!0,u,!0),t.repaint())},t.prototype.rgc=function(t){this._gc=[t]},t.prototype.ahc=function(){return this._gc},t.prototype.destroy=function(){var t=this;t.D5&&t.H5(),t._gc=l,t.MH=!1,t.W0=-1,t.X0(),t.Y0(),a.GC$(t.Z0).remove(),a.GC$(t.$0).remove(),a.GC$(t._0).remove()},t.prototype.bind=function(t,e,n){var o=this.qo;o&&t&&(t=t.split(/\s+/).join(I+" "),a.GC$(o).bind(t+I,e,n))},t.prototype.unbind=function(t,e){var n=this.qo;n&&t&&(t=t.split(/\s+/).join(I+" "),a.GC$(n).unbind(t+I,e))},t.prototype.unbindAll=function(){var t=this.qo;t&&a.GC$(t).unbind(I)},t.prototype.caret=function(t){var e,n,o=this,r=o.qo;if(r)return e=g.activeElement===r,n=a.GC$(r),0===arguments.length?e?o.b1(r).end:n.data(F):void(t!==o.caret()&&(e?(o.c1(r,t),n.data(F,o.b1(r).end)):n.data(F,t),o.Wq(k,{})))},t.prototype.b1=function(t){var e,n,o,r=-1,i=-1;return this.d1(t)?(r=t.selectionStart,i=t.selectionEnd):this.Cia(t)&&((e=d.getSelection()).rangeCount>0&&((o=(n=e.getRangeAt(0)).cloneRange()).selectNodeContents(t),o.setEnd(n.endContainer,n.endOffset),i=(""+o).length,(o=n.cloneRange()).selectNodeContents(t),o.setEnd(n.startContainer,n.startOffset),r=(""+o).length,o.detach())),{start:r,end:i}},t.prototype.c1=function(t,e){var n,o,r,i;this.d1(t)?t.setSelectionRange(e,e):this.Cia(t)&&((r=this.e1(t,e))&&(n=d.getSelection(),o=g.createRange(),(i=r.node)&&1===i.childNodes.length?o.setStart(i.firstChild,r.offset):i.lastChild&&i.lastChild.length&&o.setStart(i.lastChild,i.lastChild.length),o.collapse(!0),n.removeAllRanges(),n.addRange(o),this.V4&&(t.parentElement.scrollTop=t.parentElement.scrollHeight)))},t.prototype.text=function(t){var e,n,o,r,i,l,u,c=this,f=c.qo,h=c.a1();if(!f||!h||h.Js)return"";if(e=c.d1(f),n=c.Cia(f),0===arguments.length){if(o="",e)o=f.value;else if(n){if(f.getElementsByClassName("gcsj-func-gray-formula").length>0)return"";(o=(o=C?a.Ul.Woa(f):f.innerText).replace(/\r\n?/g,"\n")).indexOf(S)>=0&&(o=a.Ul.Ika(o,S," "))}return o}null!=t||(t=""),t!==c.text()&&(r=c.mLb(t),c.S0=r?c.T0(r):c.T0(t),e?f.value=t:n&&(i=c.nLb(c.S0,t),c.V0(i),c.caret(t.length)),l={},(u=s.G0.H0)&&u._text&&(l={sheet:u.kj,editor:u.I0&&u.I0.firstChild.firstChild,canvasOffset:u.f1}),c.Wq(R,l)),c.oLb&&c.pLb()},t.prototype.autoComplete=function(t){return 0===arguments.length?this.g1:void(this.g1=t)},t.prototype.showHelp=function(t){return 0===arguments.length?this.h1:void(this.h1=t)},t.prototype.add=function(t){var e,n;if(t)if(a.GC$.isArray(t))for(e=t.length,n=0;n<e;n++)this.Sb(t[n]);else this.Sb(t)},t.prototype.Sb=function(t){var e,n,o,r,i=t&&b(V(t.name));if(i){for(n=(e=this.i1).length,o=0;o<n;o++){if((r=b(e[o].name))===i)return;if(r>i)break}e.splice(o,0,t)}},t.prototype.remove=function(t){var e,n,o;if(t)for(t=b(t),n=(e=this.i1).length,o=0;o<n;o++)if(b(e[o].name)===t){e.splice(o,1);break}},t.prototype.workbook=function(t){var e=this;return 0===arguments.length?e.OC:void(t===l?e.V4&&e.H5():(e.P0(t),e.j1()))},t.prototype.P0=function(t){var e;t&&((e=this).OC&&e.Y0(),e.qo&&(e.OC=t))},t.prototype.l1=function(){var t,e,n,o=[],r=this.S0,i=r&&r.length,a=0,s=0;if(i>0)for(n=0;n<i;n++)e=(t=r[n]).text,11===t.type&&(o.push({textOffset:a,text:e,ranges:t.ranges,index:s,allowDrag:t.allowDrag}),s++),a+=e.length;return o},t.prototype.m1=function(){var t,e,n,o,r,i=this.qo,a=this.l1();if(i&&a&&a.length>0)for(t=this.caret(),e=a.length,n=void 0,o=void 0,r=0;r<e;r++){if((o=(n=a[r]).textOffset)<t&&t<=o+n.text.length)return n;if(o>=t)break}return l},t.prototype.n1=function(t){var e,n,o;return!!t&&(e=this.caret(),n=t.text,(o=t.textOffset)<e&&e<=o+n.length)},t.prototype.o1=function(t){var e,n,o,r,i,a,s,l=this.l1(),u=l.length;if(t<0||u<=t)return"";for(e=[],o=0,r=0;r<u;r++){for(n=l[r],i=!1,a=0;a<e.length;a++)if(e[a].text.replace(/\s+/g,"").toUpperCase()===n.text.replace(/\s+/g,"").toUpperCase()){i=!0;break}if(i){if(t===r){o=a;break}}else if(e.push(n),t===r){o=e.length-1;break}}return(s=N)[o%s.length]},t.prototype.M0=function(){var t,e,n;return!!this.MH||!!this.V4||!!(t=this.s1(this.caret()))&&(e=t.type,n=t.text,1===e||8===e||7===e&&"%"!==n||5===e||9===e||15===e)},t.prototype.t1=function(t){if(!t||!this.MH)return!1;var e=this.W0,n=this.caret(),o=t.textOffset;return e<=o&&o<n},t.prototype.u1=function(){var t,e,n=[],o=this.l1(),r=o.length;if(r>0)for(e=0;e<r;e++)t=o[e],this.t1(t)&&n.push(t);return n},t.prototype.v1=function(t,e,n){var o,r,a,l,u,c,f,h,p,d,g,m=this,y=m.qo;if(t&&y){if(!m.MH){if(!m.M0())return;e=!1,m.MH=!0,m.W0=m.caret(),m.Wq("AppendStarted",{})}o=m.W0,r=m.text(),a=m.caret(),r||(r="=",o=m.W0=1,a=1),l=a,n&&(e=!1,r=r.substr(0,o)+r.substr(a),m.S0=m.T0(r),l=a=o),u=m.s1(a),e?(c=(c=r.substr(0,a)).substr(0,c.length-u.text.length)).length>=o&&(u.text=t,l=c.length+t.length):(f=m.S0,h=i.Common.k.Cb(f,u),p=m.V4&&f.length>1&&h===f.length-1&&11===u.type,a>o||p?(f.splice(h+1,0,{text:this.w1(),type:8}),f.splice(h+2,0,{text:t,type:11}),t=","+t):f.splice(h+1,0,{text:t,type:11}),l=a+t.length),m.z1(),d={},(g=s.G0.H0)&&g._text&&(d={sheet:g.kj,editor:g.I0&&g.I0.firstChild.firstChild,canvasOffset:g.f1}),m.Wq(R,d),m.caret(l)}},t.prototype.NH=function(){var t=this;t.MH&&(t.MH=!1,t.W0=-1,t.Wq("AppendEnded",{}))},t.prototype.B1=function(){this.MH=!0,this.W0=this.caret()},t.prototype.C1=function(t){return void 0!==t&&(this.W0=t),this.W0},t.prototype.D1=function(t,e,n){var o,r,i,a,s,l,u,c=this;if(c.qo&&!(t<0)&&e){for(o="",r=!1,a=(i=c.S0)&&i.length,l=0,u=0;u<a;u++){if(11===(s=i[u]).type&&l++===t){i[u]={text:e,type:11},r=!0;break}o+=s.text}r&&(c.z1(),c.Wq(R,{}),n?c.caret(c.text().length):c.caret(o.length+e.length))}},t.prototype.j1=function(){var t,e,n=this;n.OC&&(t=n.qo,n.OC&&t&&(t.setAttribute(T,"gcAttachedFormulaTextBox"),n.V4||(n.OC.CF=n),n.OC.Fu(a.Events.FormulatextboxEditStarted,n,n.E1),n.OC.Fu(a.Events.FormulatextboxEnterCell,n,n.F1),n.OC.Fu(a.Events.FormulatextboxEditEnded,n,n.G1),n.OC.Fu(a.Events.FormulatextboxActiveSheetChanged,n,n.H1),n.OC.Fu(a.Events.FormulatextboxRangeChanged,n,n.I1),n.OC.Fu(a.Events.FormulaTextBoxTextChanged,n,n.J1),n.OC.Fu(a.Events.FormulaTextBoxCaretChanged,n,n.K1),n.OC.Fu(a.Events.ValueChanged,n,n.qLb),(e=G(n.OC))&&!n.V4&&n.text(n.L1(e,e.Jl,e.Kl)),n.Fu(R,n,n.M1),n.Fu(k,n,n.N1)))},t.prototype.refresh=function(t){var e,n=this.OC,o=this;n&&((e=G(n))&&!o.V4&&(o.OG=!!t||o.OG,o.text(o.L1(e,e.Jl,e.Kl)),o.OG=!1))},t.prototype.Y0=function(){var t=this,e=t.OC;!t.O0&&e&&(t.V4||(e.CF=null,e.Gu(a.Events.FormulatextboxEditStarted,t.E1),e.Gu(a.Events.FormulatextboxEnterCell,t.F1),e.Gu(a.Events.FormulatextboxEditEnded,t.G1),e.Gu(a.Events.FormulatextboxActiveSheetChanged,t.H1),e.Gu(a.Events.FormulatextboxRangeChanged,t.I1),e.Gu(a.Events.FormulaTextBoxTextChanged,t.J1),e.Gu(a.Events.FormulaTextBoxCaretChanged,t.K1),e.Gu(a.Events.ValueChanged,t.qLb),t.Gu(R,t.M1),t.Gu(k,t.N1)),t.text("")),t.OC=null},t.prototype.O1=function(){var t,e,n=this;n.OG||(n.OG=!0,(e=(t=this.OC)&&G(t))&&!e.isEditing()?(n.V4||e.EF(null,e.Jl,e.Kl,null,null,!1,null),n.Q1=!0):n.Q1=!1,n.OG=!1,n.R1||n.S1())},t.prototype.rLb=function(){var t=this,e=t.qo,n=t.sLb;e.insertBefore(n,e.firstChild),n.innerText=t.oLb},t.prototype.tLb=function(t,e){t&&(this.uLb!==e&&(this.uLb=e,t.style.display=e?"":"none"))},t.prototype.pLb=function(){var t,e=this,n=e.qo;e.Cia(n)?((t=e.sLb)||((t=e.sLb=p("span")).className="gcsj-func-gray-formula"),e.tLb(t,!0),e.rLb()):n.placeholder=e.oLb},t.prototype.vLb=function(){var t,e=this;e.oLb&&(e.oLb="",t=e.qo,e.Cia(t)?e.tLb(e.sLb,!1):t.placeholder="")},t.prototype.UF=function(){var t,e,n,o,r,i,a=this,s=a.OC,l=s&&G(s);l&&(t=l.Cw,a.Q1&&t&&(e=t.text(),(n=a.text())!==e&&(o=a.caret(),r=l.getFormulaInformation(l.getActiveRowIndex(),l.getActiveColumnIndex()),a.text(e),r.isArrayFormula&&(o>=n.length&&(o-=1),o=c(0,o-1)),a.caret(o))),(a.Q1&&t||a.V4)&&(2!==(i=l.Px)&&(l.Px=2,l.Cu(i,2))))},t.prototype.L1=function(t,e,n){var o,r,i,s,l,u="";if(t){if(r=(o=t.parent)&&o.options,(i=t.getFormulaInformation(e,n))&&i.hasFormula){if(u="="+i.formulaWithCulture,i.isDynamicArray)return this.oLb=u,"";this.oLb="",i.isArrayFormula&&(u="{"+u+"}")}else s=t.getActualStyle(e,n),u="string"==typeof(l=t.getValue(e,n))&&s.quotePrefix||u.length>0&&"="===u[0]&&r&&r.allowUserEditFormula?"'"+l:a.Ul.Il(s,l,t)||"";this.vLb()}return u},t.prototype.H1=function(t,e){var n,o,r=t.data;r.OG||(n=e.newSheet,r.V4||(r.OG=!0,r.close(),e&&(o=n,r.text(r.L1(o,o.Jl,o.Kl))),r.OG=!1))},t.prototype.E1=function(t){var e,n,o,r=t.data;r.OG||(o=(n=(e=r.OC)&&G(e))&&n.Cw)&&r.V4===o.V4&&r.C5===o.C5&&(r.vLb(),r.OG=!0,r.text(o.text()),r.OG=!1)},t.prototype.F1=function(t,e){var n=t.data;n.V4||n.OG||(n.OG=!0,e&&n.text(n.L1(e.sheet,e.row,e.col)),n.OG=!1)},t.prototype.I1=function(t,e){var n,o,r,i,s,l=t.data;l.OG||l.V4||(l.OG=!0,e&&(n=e.sheet,o=e.row,r=e.col,i=e.rowCount,s=e.colCount,new a.Range(o,r,i,s).contains(n.Jl,n.Kl)&&l.text(l.L1(n,n.Jl,n.Kl))),l.OG=!1)},t.prototype.G1=function(t,e){var n=t.data;return n.V4&&n.D5&&n.E5?void(e.ignore=!0):void(n.OG||(n.OG=!0,n.close(),e&&e.sheet.Cw&&!e.sheet.Cw.V4&&!n.V4&&n.text(n.L1(e.sheet,e.row,e.col)),n.OG=!1))},t.prototype.qLb=function(e,n){var o=n.sheet,r=o&&o.parent&&o.parent.CF;r&&r.e2()===n.row&&r.f2()===n.col&&r.a1()===o&&e.data instanceof t&&(n.text=o.getText(n.row,n.col),e.data.J1(e,n))},t.prototype.J1=function(t,e){var n,o=t.data;o.OG||(!e.sheet.Cw||o.V4===e.sheet.Cw.V4&&o.C5===e.sheet.Cw.C5)&&(o.OG=!0,e&&(n=o.caret(),o.text(e.text),o.caret(n)),o.OG=!1)},t.prototype.K1=function(t,e){var n=t.data;n.OG||(!e.sheet.Cw||n.V4===e.sheet.Cw.V4&&n.C5===e.sheet.Cw.C5)&&(n.OG=!0,e&&n.caret(e.caret),n.OG=!1)},t.prototype.M1=function(t){var e,n,o,r,i,a,s,l,u=t.data;if(!u.OG&&(n=(e=u.OC)&&G(e))){if(n.isEditing()||(u.O1(),u.focus()),u.OG=!0,o=n.Jl,r=n.Kl,i=n.Cw,a=n.getCellType(o,r),i){if(u.V4!==i.V4||u.C5!==i.C5)return;s=i.caret(),i.text(u.text()),i.caret(s)}else l={sheet:n,row:o,col:r,sheetArea:3},a.setEditorValue(n.BF,u.text(),l);u.OG=!1}},t.prototype.N1=function(t){var e,n,o,r=t.data;r.OG||(n=(e=r.OC)&&G(e))&&n.isEditing()&&((!(o=n.Cw)||r.V4===o.V4&&r.C5===o.C5)&&(r.OG=!0,o&&(o.caret(r.caret()),r.S1()),r.OG=!1))},t.prototype.ad=function(t){var e,n,o,r=this;r.T1=!1,r.U1=!1,r.MH=!1,r.W0=-1,r.i1=[],r.g1=!0,r.h1=!0,r.V1=!0,(e=p("div")).className="gcsj-func-ac-popup",e.style.display="none",e.setAttribute(T,"gcFuncACPopup"),t.insertBefore(e,l),r.Z0=e,r.R1=!1,(n=p("div")).className="gcsj-func-help-popup",n.style.display="none",n.setAttribute(T,"gcFuncHelpPopup"),t.insertBefore(n,l),r.$0=n,r.W1=!1,a.GC$(e).bind("mouseover",(function(){r.V1=!1})).bind("mouseout",(function(){r.V1=!0})),a.GC$(n).bind("mouseover",(function(){r.V1=!1})).bind("mouseout",(function(){r.V1=!0})),a.GC$(e).bind("scroll",(function(){r.X1&&clearTimeout(r.X1),r.X1=d.setTimeout((function(){r.qo&&r.qo.focus()}),100)})),(o=p("div")).style.display="none",o.setAttribute(T,"gcFuncHelpDiv"),t.insertBefore(o,l),r._0=o,r.OC=null,r.OG=!1,r.Q1=!1,r.O0=!1},t.prototype.N0=function(t){var e,n,o;t&&(n=(e=this).Cia(t),(e.d1(t)||n)&&(o=a.GC$(t),e.qo&&e.X0(),e.qo=t,v&&(v.msie||v.chrome)?n||C||v.chrome?(e.Fu("focus",(function(){o.data(j,e.text())})),e.Fu("click",(function(){o.focus()})),"input keydown keyup cut paste".split(" ").forEach((function(t){e.Fu(t,(function(){e.Y1()}))}))):e.Fu(x,(function(){e.Z1()})):e.Fu(x,(function(){if(n){var t=e.qo.lastChild;v.chrome&&t&&"BR"===t.tagName&&e.qo.removeChild(t)}e.Z1()})),e.Fu("keydown",(function(t){var o,r,i,s=t.ctrlKey,l=t.shiftKey,u=t.altKey,c=t.metaKey,f=s||l||u||c,h=t.keyCode;!f&&e.R1&&(h===M.down?(e._1(1),y(t)):h===M.up?(e._1(-1),y(t)):h===M.tab&&(e.a2(),y(t))),h===M.esc&&e.close(),e.b2(t),r=(o=G(e.OC)).mm.LH(t),e.V4&&r&&((i=o.Cw)&&i.MH&&i.NH()),n&&(r?(8===h?q(t)&&a.uHb.processBackspaceAndLeftArrowKeyEvent(t,!0):46===h&&q(t)&&a.uHb.processDeleteAndRightArrowKeyEvent(t,!0),e.Jka()):13===h&&(s||u)?(q(t)&&function(){var t,e,n,o=d.getSelection();o.rangeCount>0&&(t=o.getRangeAt(0),(e=g.createElement("span")).innerHTML="<br/>â",t.insertNode(e),(n=g.createRange()).setStartAfter(e),n.setEndAfter(e),n.collapse(!1),o.removeAllRanges(),o.addRange(n))}(),e.Jka(!0)):37===h?q(t)&&a.uHb.processBackspaceAndLeftArrowKeyEvent(t,!1):39===h&&q(t)&&a.uHb.processDeleteAndRightArrowKeyEvent(t,!1),n&&s&&(90===h||89===h)&&y(t))})),e.Fu("keyup",(function(t){var o,r,i,a;e.b2(t),o=e.text(),n&&(r=void 0,i=t.keyCode,(a=t.ctrlKey)&&90===i?(r=e.Ac.pop()||"",e.text(r),e.Bc.push(o)):a&&89===i&&((r=e.Bc.pop())&&(e.text(r),e.Ac.push(o))))})),e.Fu("focus",(function(t){v&&v.mozilla&&!e.qo.innerText&&(e.qo.innerText=""),e.b2(t),e.V4&&e.D5&&(e.E5=!0,e.j5())})),e.Fu("blur",(function(){e.V1&&e.close(),e.V4&&(e.H5(),e.E5=!1)})),e.Fu("mousedown",(function(){e.E5=!0,e.uLb&&(e.vLb(),e.wLb=!0),e.O1()})),e.Fu("mouseup",(function(){if(e.wLb){e.wLb=!1;var t=e.qo,n=d.getSelection();t!==n.anchorNode&&n.selectAllChildren(t)}e.UF()})),e.Fu("click",(function(t){var n,o,r;e.MH&&e.NH(),(r=(o=(n=e.OC)&&G(n))&&o.Cw)&&r.MH&&!r.V4&&r.NH(),e.b2(t)})),e.Fu("compositionstart",(function(){e.T1=!0})),e.Fu("compositionend",(function(){e.T1=!1,(v.edge||v.chrome)&&e.Y1()}))))},t.prototype.X0=function(){var t,e=this,n=e.qo;n&&((t=a.GC$(n)).removeData(j),t.removeData(F),t.removeAttr(T),e.nu(),e.unbindAll(),e.V4&&(a.GC$(e.cga).empty(),e.cga=l),e.qo=l)},t.prototype.Y1=function(){var t=this,e=a.GC$(t.qo),n=t.text();e.data(j)!==n&&(t.T1||e.data(j,n),t.Z1())},t.prototype.b2=function(t){if(v&&v.msie){setTimeout(function(t,e){return function(){t.d2(t,e)}}(this,t),10)}else this.d2(this,t)},t.prototype.d2=function(t,e){var n,o,r,i,s,l=e.keyCode,u=l===M.left||l===M.right||l===M.home||l===M.end||l===M.pdn||l===M.pup||l===M.tab||l===M.enter;if(t.g1||(u=u||l===M.up||l===M.down),n=void 0!==e.button,u||n){if(o=t.qo,r=a.GC$(o),(i=t.b1(o)).start!==i.end)return;s=i.end,r.data(F)!==s&&(r.data(F,s),t.Wq(k,{}),t.S1())}},t.prototype.e2=function(){return this.OC?G(this.OC).Jl:u},t.prototype.f2=function(){return this.OC?G(this.OC).Kl:u},t.prototype.a1=function(){if(this.OC)return G(this.OC)},t.prototype.parseInternal=function(t,e,n,i){var a,s,l=[];return t&&"="===t[0]&&function(t,e){var n,o=0;for(n=0;n<t.length;n++)t[n]===e&&o++;return o}(t,'"')%2!=1?(a=new o.Parser,s=r.qzb(a,t,e,n,i,!0),l=this.i2(s)):(l.push({text:t,type:17}),l)},t.prototype.T0=function(t){return this.parseInternal(t,this.a1(),this.e2(),this.f2())},t.prototype.Z1=function(){var t,e,n,o=this,r=o.text();return"\n"!==r&&r.indexOf("\n")>=0?void o.Wq(R,{type:x}):(t=o.qo,e=a.GC$(t),o.U1=!0,o.S0=o.T0(r),o.Cia(t)?o.T1||("\n"===r?(e.empty(),o.Wq(R,{type:x})):(n=o.caret(),o.V0(o.S0),o.Wq(R,{type:x}),o.caret(n))):o.Wq(R,{type:x}),n=o.caret(),e.data(F)!==n&&(e.data(F,n),o.Wq(k,{})),o.c2(),void(o.R1||o.S1()))},t.prototype.j2=function(){return i.Common.CultureManager.q4().NumberFormat},t.prototype.h2=function(){var t=this.j2();return t&&t.arrayGroupSeperator||";"},t.prototype.l2=function(){var t=this.j2();return t&&t.arrayListSeparator||","},t.prototype.w1=function(){var t=this.j2();return t&&t.listSeparator||","},t.prototype.g2=function(){var t=this.j2();return t&&t.numberDecimalSeparator||"."},t.prototype.i2=function(t){var e,n,o,r,a=[],s=[],l=this.h2(),u=this.l2(),c=!1;for(e=0;e<t.length;e++)e>0&&e<t.length-1&&";"===t[e-1].text&&","===t[e].text&&"ARRAYROW"===t[e+1].text||(n=t[e],o=this.m2(n,s),r=n.text,2===o?a.push({text:r,type:o}):c&&8===o&&","===r?a.push({text:u,type:9}):c&&8===o&&";"===r?a.push({text:l,type:10}):8===o?a.push({text:r,type:o}):3===o?("ARRAY"===r&&(c=!0),a.push({text:"{",type:3})):4===o?"ARRAY"===r?(c=!1,a.push({text:"}",type:4})):a.push({text:r,type:4}):6===o?a.push({text:")",type:o}):13===o?a.push({text:i.Common.o.nb(r),type:o,ranges:n.ranges,allowDrag:n.canDrag}):null!==o&&a.push({text:r,type:o,ranges:n.ranges,allowDrag:n.canDrag}));return a},t.prototype.m2=function(t,e){var n,o=t.type,r=t.subType,i=t.text,a=t.value;if(1===o){if(1===r)return"ARRAY"===i||"ARRAYROW"===i?(e.push(3),3):(e.push(5),"@"===a||"("===a.trim()?5:2);if(2===r){if(")"===a.trim())return 6;if(e.length>0){if(3===(n=e[e.length-1]))return e.pop(),4;if(5===n)return e.pop(),6}}if("="===a.trim())return 1}else if(3===o){if(0===r)return 8}else{if(5===o||6===o||4===o)return 7;if(0===o)return 7===r||0===r?11:5===r?12:4===r?13:3===r?14:6===r?16:14;if(7===o)return 15;if(8===o)return 17}return 17},t.prototype.z1=function(){var t,e=this,n=e.qo,o=e.S0,r="",i=o&&o.length;for(t=0;t<i;t++)r+=o[t].text;e.d1(n)?n.value=r:e.Cia(n)&&e.V0(o)},t.prototype.d1=function(t){var e=t&&t.tagName;return"TEXTAREA"===e||"INPUT"===e},t.prototype.Cia=function(t){return t&&"DIV"===t.tagName&&"true"===t.contentEditable},t.prototype.Dia=function(t){return"gcEditingInput"===a.GC$(t).attr(T)},t.prototype.bW=function(t){return t&&"="===t[0]},t.prototype.Fu=function(t,e,n){var o=this.qo;o&&t&&(t=t.split(/\s+/).join(A+" "),a.GC$(o).bind(t+A,e,n))},t.prototype.Gu=function(t,e){var n=this.qo;n&&t&&(t=t.split(/\s+/).join(A+" "),a.GC$(n).unbind(t+A,e))},t.prototype.nu=function(){var t=this.qo;t&&a.GC$(t).unbind(A)},t.prototype.Wq=function(t,e){var n=this.qo;n&&a.GC$(n).trigger(t,e)},t.prototype.s1=function(t){var e,n,o,r,i;if(t<=0)return l;if((n=(e=this.S0)&&e.length)>0)for(o=0,r=void 0,i=0;i<n;i++)if((o+=(r=e[i]).text.length)>=t)return r;return l},t.prototype.n2=function(){var t,e,n,o,r,i=this.OC;if(i&&((t=G(i))&&(e=t.getCalcService().allowDynamicArray,n=t.Cw))){for(r=(o=[].concat(n.i1)).length-1;r>=0;r--)!e&&o[r]&&U(o[r].name)?o.splice(r,1):o[r].isFunc=!0;return o.concat(this.o2(i,t)).concat(this.q2(i.sheets))}return this.i1},t.prototype.o2=function(t,e){var n,o=[],r=e.getCustomNames();return r&&a.GC$.each(r,(function(t,e){o.push({name:e.Cj,description:e.kT})})),(n=t.getCustomNames())&&a.GC$.each(n,(function(t,e){o.push({name:e.Cj,description:e.kT})})),o},t.prototype.q2=function(t){var e=[];return t.forEach((function(t){var n,r,i=t.tables;if(i&&(n=i.all()))for(r=0;r<n.length;r++)e.push({name:n[r].name(),description:o.sR().Fbx_TableName_Description+n[r].name()})})),e},t.prototype.s2=function(t,e){var n,o,r,i;for(t=b(t),m.Bb(t,"[")&&(t=t.substr(t.lastIndexOf("[")+1),t=m.Gb(t,"@","")),n=[],o=e&&e.length,i=0;i<o;i++)r=e[i],0===b(V(r.name)).indexOf(t)&&n.push(r);return n},t.prototype.t2=function(){var t,e,n,o,r,i=this.caret();if(i<=0)return"";if((e=(t=this.S0)&&t.length)>0)for(n=0,o=void 0,r=0;r<e;r++){if(n+(o=t[r]).text.length>=i)return o.text.substring(0,i-n);n+=o.text.length}return""},t.prototype.u2=function(){var t,e,n,o,r,i,a,s,u,c=this.caret(),f=this.S0,h=f&&f.length,p=[],d=0;for(e=0;e<h;e++){if(t=f[e],p.push(t),6===t.type)for(n=0;p.length>0;)if(6===(o=p.pop()).type&&n++,5===o.type&&n--,0===n){p.length>0&&((o=p[p.length-1])&&2===o.type&&p.pop());break}if((d+=t.text.length)>=c)break}if(p.length>0)for(r=0;p.length>0;)if(8===(t=p.pop()).type)r++;else if(2===t.type){for(i=b(t.text),s=(a=this.n2())&&a.length,u=void 0,e=0;e<s;e++)if(u=a[e],b(V(u.name))===i)return{func:u,activeParamterIndex:r,isFunc:u.isFunc};break}return l},t.prototype.c2=function(){var t,e,n,o,r,i,s,l,u=this,c=u.v2();if(u.g1&&u.bW(u.text())&&c&&c.length>0&&!u.MH&&!u.T1&&!u.V4){for(u.w2(),t=u.Z0,c.length>8?(t.style.height="204px",t.style.overflowY="scroll"):(t.style.height="auto",t.style.overflowY=""),e="",n=c.length,o=void 0,r=0;r<n;r++)e+="<div class='gcsj-func-ac-row'><div class='gcsj-func-ac-row-name' isFunc="+(o=c[r]).isFunc+">"+V(o.name)+"</div><div class='gcsj-func-ac-row-description'>"+(o.description||"")+"</div></div>";(i=a.GC$(u.Z0)).html(e).show(),u.R1=!0,(s=i.find(".gcsj-func-ac-row")).length>0&&(l="gcsj-ac-row-active",a.GC$(s[0]).addClass(l),s.bind("mouseover",(function(){s.removeClass(l),a.GC$(this).addClass(l)})),s.bind("click",(function(){u.a2()}))),u.SH()}else u.z2()},t.prototype.v2=function(){var t,e,n,r,i,a,s,l=this,u=l.s1(l.caret()),c=u&&u.text,f=[],h=l.S0.indexOf(u);if(u&&14===u.type)return f;if((t=l.A2(h)).length>0){for(i in e=JSON.parse(JSON.stringify(o.sR().B2)),n=o.getMapping()&&o.getMapping().tableFunctionsMapping,r=[],e)(a=n&&n[e[i].name])&&(e[i].name=a),r.push(e[i]);if(f=f.concat(t).concat(r),m.jb(c,"[")||m.jb(c,"[@"))return f}else f=this.n2();return s=[],(c=l.t2())&&(s=l.s2(c,f)),s},t.prototype.A2=function(t){var e,n,o,r,i,a,s,u,c=[],f=this.S0,h=f&&f.length;if(t<0||t>=f.length)return c;if(n=(e=this.OC)&&G(e),o={},void 0!==t&&t!==l||(t=h),n&&(r=f[t],void 0!==(a=(i=n.tables)&&i.findByName(m.Ib(r.text,"[")))&&a!==l&&!o[a])){for(o[a]=!0,s=0,u="";u!==l;)u=a.getColumnName(s),s++,u!==l&&c.push({name:u,description:""});if(c.length>0)return c}return c},t.prototype.z2=function(){a.GC$(this.Z0).hide(),this.R1=!1},t.prototype._1=function(t){var e,n,o,r,i,s,l=a.GC$(this.Z0).find(".gcsj-func-ac-row"),u=l.length;if(0!==u){if(e="gcsj-ac-row-active",n=0,t)for(o=0;o<u;o++)if(a.GC$(l[o]).hasClass(e)){n=o+t;break}r=a.GC$(this.Z0).scrollTop(),l.removeClass(e),i=0,u>0&&(i=l[0].offsetHeight),n=c(n,0),s=l[n=f(n,u-1)],a.GC$(s).addClass(e),s.offsetTop+s.offsetHeight>a.GC$(this.Z0).scrollTop()+a.GC$(this.Z0).height()?a.GC$(this.Z0).scrollTop(a.GC$(this.Z0).scrollTop()+i):s.offsetTop<a.GC$(this.Z0).scrollTop()?a.GC$(this.Z0).scrollTop(s.offsetTop):a.GC$(this.Z0).scrollTop(r)}},t.prototype.a2=function(){var t,e,n,o,r,i,s,u,c,f,h,p,d,g,y,v=this,C=a.GC$(v.Z0).find(".gcsj-ac-row-active .gcsj-func-ac-row-name"),b=C.text(),w="true"===C.attr("isFunc");if(b){for(t=v.caret(),n=(e=v.S0)&&e.length,o=0,r=0,i=0,s=l;i<n&&!(o+(r=(s=e[i]).text.length)>=t);)i++,o+=r;u=t-o,c=s.text,f=0,h=0,m.Bb(c,"[")?-1===(f=c.lastIndexOf("[",u-1))?(f=c.indexOf("["),s.text=-1===f?b:b+c.substr(f),f=0):(f++,"@"===c.charAt(f)&&(f+=1),-1===(h=c.indexOf("]",u))&&(h=c.length),s.text=c.substring(0,f)+b+c.substr(h)):(s.text=b,(p=c.substr(u))&&((d=v.T0("="+p)).length>1&&e.splice(i+1,0,d[1]))),s.type=w?2:11,y=e[g=i+1],!w||y&&5===y.type||e.splice(g,0,{text:"(",type:5}),v.z2(),v.qo.focus(),v.z1(),v.caret(o+b.length+f+(w?1:0)),v.S1(),v.S0=v.T0(v.text()),v.Wq(R,{})}},t.prototype.S1=function(){var t,e,n,r,i,s,u,c,h,p,d,g,m=this;if(m.R1&&m.z2(),(t=m.u2())!==l&&!0===t.isFunc)if(e=m.w1(),m.h1&&m.bW(m.text())&&t&&!m.MH&&!m.T1&&!m.V4){for(i=(r=(n=t.func).parameters)&&r.length,s=f(i-1,t.activeParamterIndex),u=void 0,c="",h=0;h<i;h++)p=(u=r[h]).name,u.repeatable&&(p+=e+"..."),u.optional&&(p="["+p+"]"),d=h===i-1?"":e+" ",c+=p=h===s?"<span class='gcsj-func-help-paramter gcsj-func-help-paramter-active'>"+p+"</span>"+d:"<span class='gcsj-func-help-paramter'>"+p+"</span>"+d;g="<div class='gcsj-func-help-title'><div class='gcsj-func-help-formula'><span class='gcsj-func-help-formula-name'>"+V(n.name)+"</span><span class='gcsj-func-help-paramter-paren'>(</span>"+c+"<span class='gcsj-func-help-paramter-paren'>)</span></div></div>"+("<div class='gcsj-func-help-body'>"+("<div class='gcsj-func-help-section-content'>"+("<div class='gcsj-func-help-section'><div class='gcsj-func-help-section-title'>"+o.sR().Fbx_Summary+"</div><div class='gcsj-func-help-section-content'>"+(n.description||"")+"</div></div>")+"</div>")+"</div>"),a.GC$(m.$0).html(g).show(),m.W1=!0,m.SH()}else m.w2();else m.w2()},t.prototype.w2=function(){a.GC$(this.$0).hide(),this.W1=!1},t.prototype.close=function(){this.z2(),this.w2()},t.prototype.BH=function(t,e){var n,o,r,i,a,s;return!this.MH&&(n=t.ctrlKey||t.shiftKey||t.altKey||t.metaKey,o=t.keyCode,r=t.ctrlKey,i=t.altKey,a=t.metaKey,(s=t.srcElement||t.target)&&e&&e.isEditing&&"gcAttachedFormulaTextBox"===s.getAttribute("gcUIElement")?67===o&&(r||a)&&!i||88===o&&(r||a)&&!i:this.R1&&!n&&(o===M.down||o===M.up||o===M.tab))},t.prototype.SH=function(){var t,e,n,o,r,i,u,c,f,h,p,d,m,y,v=this,C=l;if(v.R1?C=v.Z0:v.W1&&(C=v.$0),C){if(t=a.GC$(v.qo),e=a.GC$(C),(n=s.G0.H0)&&n.kj)return o=n.kj.getCellRect(n.nT,n.Mk),r=n.f1,void e.css("top",o.y+o.height+r.top).css("left",o.x+r.left);i=t.parent(),u=t.outerHeight(),v.Dia(v.qo)&&(u=(i=i.parent()).outerHeight()),c=i.css("top"),f=parseFloat(c),isNaN(f)||(c=f),h=i.css("left"),"auto"===c&&(c=t.offset().top,h=t.offset().left),p=c+u,d=a.GC$(g.body).outerHeight(),p+(m=e.outerHeight())>d&&((y=c-m)>=0&&(p=y)),e.css("top",p).css("left",h)}},t.prototype.focus=function(){a.GC$(this.qo).focus()},t.prototype.V0=function(t){var e,n,o,r,i=this,a="",s="",l=t&&t.length,u=0;for(n=0;n<l;n++)o="",11===(e=t[n]).type&&(o=" style='color: "+i.o1(u)+"'",u++),i._0.innerText=e.text,a+="<span"+o+" class='gcsj-func-color-text'>"+i._0.innerHTML+"</span>",s+=e.text;if(s||i.text())if(r=i.qo,a)r.innerHTML="<span class='gcsj-func-color-content'>"+a+"</span>";else for(;r.firstChild;)r.removeChild(r.firstChild)},t.prototype.e1=function(t,e){var n,o,r,i=a.GC$(t).find(".gcsj-func-color-content .gcsj-func-color-text"),s=i.length;for(e=c(0,e),r=0;r<s;r++)if((e-=(o=(n=i[r]).innerText).length)<=0)return{node:n,offset:o.length+e};return o?{node:n,offset:o.length}:l},t.prototype.iIb=function(t,e){var n=d.getSelection(),o=this.qo.children[0],r=document.createRange();r.setStart(o,t),r.setEnd(o,e),n.removeAllRanges(),n.addRange(r)},t.prototype.Jka=function(t){var e=this,n=e.qo,o=e.Cia(n),r=e.text();o&&r&&(r=t?r.substr(0,r.length-2):r,e.Ac.push(r))},t.prototype.nLb=function(t,e){var n,o,r,i,a,s,l;if(e)for(n=0,o=0,r=0,i=e.length,a=0;a<t.length;a++){for(s=t[a].text;o<i;o++)if((l=e[o].toUpperCase())===(s[r]?s[r].toUpperCase():void 0))r+=1;else{if("\n"!==l)break;o+1<i&&"â"===e[o+1]&&(o+=1)}t[a].text=e.substring(n,o),n=o,r=0}return t},t.prototype.mLb=function(t){var e,n,o,r,i;if("="===t[0]&&-1!==t.indexOf("\n")){for(e=[],n=t.length,o=!1,r=0;r<n;r++)'"'===(i=t[r])&&(o=!o),o||"\n"!==i?e.push(i):r+1<n&&"â"===t[r+1]&&(r+=1);return e.join("")}},t}(),e.FormulaTextBox=B},"./dist/plugins/group/group-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function M(t){var e=t.kj;return t.ML?e.rowOutlines:e.columnOutlines}function N(t){var e,n,o,r,i,a=this,s=!1;return(t?a.canExecute():a.canUndo())&&(e=a.kj,n=a.VQ.index,o=a.VQ.count,r=M(a),e&&r&&!d(n)&&!d(o)&&(i=t?r.group:r.ungroupRange,a.Lz(e,!0),i.call(r,n,o),a.Mz(e,!0),s=!0)),s}function E(t,e,n,o,r){var i,a=0;for(i=e;i<=n&&i<o;i++)a+=r.call(t,i)*t.zoom();return a}function D(t,e,n,o,r){if(e<o)return o;if(e>r)return r;for(var i=e;i<=r;i++)if(n.call(t,i))return i;return-1}function O(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m=this.kj,y=n.index,v=e?m.getRowCount():m.getColumnCount(),C=void 0;y<0||y>=v||(r=1===(o=M(this)).direction(),i=e?m.frozenRowCount():m.frozenColumnCount(),a=e?m.getRowHeight:m.getColumnWidth,s=e?m.getViewportTopRow:m.getViewportLeftColumn,l=e?m.getViewportHeight:m.getViewportWidth,u=s.call(m,1),(p=o.find(r?y-1:y+1,n.level))&&(d=r?p.start:y,g=r?y:p.end,r?(t?d=y:d<i&&(d=i),d<u&&(u=d),c=l.call(m,1),(f=E(m,u,g,v,a))>c&&(u=function(t,e,n,o,r){var i,a=0;for(i=e;i<o&&a<n;i++)e++,a+=r.call(t,i)*t.zoom();return e>=o?o-1:e}(m,u,f-c,v,a)),h=D(m,u,a,i,v-1)):(t?g=y:g>=v&&(g=v-1),d<u?h=D(m,d,a,i,v-1):(c=l.call(m,1),(f=E(m,u,g,v,a))>c&&(h=D(m,d,a,i,v-1)))),e&&h!==C?(m.lq=h,m.os()):e||h===C||(m.qq=h,m.qs())))}function j(t){var e,n,o,r,i,a,s=this,l=!1;return(t?s.canExecute():s.canUndo())&&(e=s.kj,n=s.VQ,o=M(s),r=n.collapsed,i=n.index,a=n.level,!e||!o||d(r)||d(i)||d(a)||(s.Lz(e,!0),t||(r=!r),(1===o.direction()?o.find(i-1,a):o.find(i+1,a))&&o.setCollapsed(i,r),O.call(s,r,s.ML,n),s.Mz(e,!0),l=!0)),l}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),e.Commands=r.Commands,i=r.Commands.ActionBase,r.GC$,a="outlineColumn",s="removeColumnOutline",l="expandColumnOutline",u="expandColumnOutlineForLevel",c="outlineRow",f="removeRowOutline",h="expandRowOutline",p="expandRowOutlineForLevel",d=o.Common.j.Fa,g=function(t){function e(e,n,o){var r=t.call(this,e,n)||this;return r.ML=o,r}return k(e,t),e.prototype.execute=function(){return N.call(this,!0)},e.prototype.undo=function(){return N.call(this,!1)},e}(i),m=function(t){function e(e,n){return t.call(this,e,n,!1)||this}return k(e,t),e}(g),y=function(t){function e(e,n){return t.call(this,e,n,!0)||this}return k(e,t),e}(g),v=function(t){function e(e,n,o){var r=t.call(this,e,n)||this;return r.ML=o,r}return k(e,t),e.prototype.execute=function(){var t,e,n,o,i=this,a=i.kj,s=a.ITa,l=!1;return i.canExecute()&&(e=(t=i.VQ).index,n=t.count,o=M(i),a&&o&&!d(e)&&!d(n)&&(s.startTransaction(),i.Lz(a,!0),o.ungroupRange(e,n),i.Mz(a,!0),t[r.Commands.bWa(a.name())]=s.endTransaction(),l=!0)),l},e.prototype.undo=function(){var t,e,n=this,o=!1,i=n.kj;return n.canUndo()&&(t=r.Commands.bWa(i.name()),e=n.VQ[t],i&&e&&(n.Lz(i,!0),i.ITa.undo(e),n.Mz(i,!0),o=!0)),o},e}(i),C=function(t){function e(e,n){return t.call(this,e,n,!1)||this}return k(e,t),e}(v),b=function(t){function e(e,n){return t.call(this,e,n,!0)||this}return k(e,t),e}(v),w=function(t){function e(e,n,o){var r=t.call(this,e,n)||this;return r.ML=o,r}return k(e,t),e.prototype.execute=function(){return j.call(this,!0)},e.prototype.undo=function(){return j.call(this,!1)},e}(i),T=function(t){function e(e,n){return t.call(this,e,n,!1)||this}return k(e,t),e}(w),x=function(t){function e(e,n){return t.call(this,e,n,!0)||this}return k(e,t),e}(w),S=function(t){function e(e,n,o){var r=t.call(this,e,n)||this;return r.ML=o,r}return k(e,t),e.prototype.execute=function(){var t,e,n,o,i=this,a=i.kj,s=!1;if(i.canExecute()&&(t=void 0,e=i.VQ.level,n=M(i),a&&n&&!d(e))){for(a.ITa.startTransaction(),i.Lz(a,!0),a.suspendCalcService(),t=0;t<e;t++)n.expand(t,!0);n.expand(e,!1),a.resumeCalcService(!0),i.Mz(a,!0),o=r.Commands.bWa(a.name()),i.VQ[o]=a.ITa.endTransaction(),s=!0}return s},e.prototype.undo=function(){var t,e,n,o=this,i=!1;return o.canUndo()&&(t=o.kj,e=r.Commands.bWa(t.name()),n=o.VQ[e],t&&n&&(o.Lz(t,!0),t.ITa.undo(n),i=!0,o.Mz(t,!0))),i},e}(i),A=function(t){function e(e,n){return t.call(this,e,n,!1)||this}return k(e,t),e}(S),I=function(t){function e(e,n){return t.call(this,e,n,!0)||this}return k(e,t),e}(S),R=r.Commands.h4,r.Commands[a]={canUndo:!0,execute:function(t,e,n){return R(t,m,e,n)}},r.Commands[c]={canUndo:!0,execute:function(t,e,n){return R(t,y,e,n)}},r.Commands[s]={canUndo:!0,execute:function(t,e,n){return R(t,C,e,n)}},r.Commands[f]={canUndo:!0,execute:function(t,e,n){return R(t,b,e,n)}},r.Commands[l]={canUndo:!0,execute:function(t,e,n){return R(t,T,e,n)}},r.Commands[h]={canUndo:!0,execute:function(t,e,n){return R(t,x,e,n)}},r.Commands[u]={canUndo:!0,execute:function(t,e,n){return R(t,A,e,n)}},r.Commands[p]={canUndo:!0,execute:function(t,e,n){return R(t,I,e,n)}},r.Commands.SL=function(t){t.register(a,r.Commands[a]),t.register(c,r.Commands[c]),t.register(s,r.Commands[s]),t.register(f,r.Commands[f]),t.register(l,r.Commands[l]),t.register(h,r.Commands[h]),t.register(u,r.Commands[u]),t.register(p,r.Commands[p])}},"./dist/plugins/group/group.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/group/group-actions.js")),o(n("./dist/plugins/group/group.js")),o(n("./dist/plugins/group/group.ns.js"))},"./dist/plugins/group/group.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q;function Y(t,e){t.Wq(r.Events.RangeGroupStateChanging,e)}function X(t,e){t.Wq(r.Events.RangeGroupStateChanged,e)}function Z(t,e,n,o,r){var i={sheet:t,sheetName:t.name(),isRowGroup:e,index:n,level:o};return r&&(i.cancel=!1),i}function Q(t,e){var n,o,i,a,s=this,u=s.Gt(),c=u.width,f=u.height;return c||f?(n=s.am(),o=new r.Rect(u.x,u.y,c,n.height),i=new r.Rect(u.x,u.y,n.width,f),o.contains(t,e)||i.contains(t,e)?((a=J(s,t,e,u.rowMaxLevel,!0))||(a=J(s,t,e,u.colMaxLevel,!1)),a||{what:"empty",info:l}):l):l}function J(t,e,n,o,r){var i,a,s=new L(t,r,o).WL(e,n,r);if(s)return{what:r?E:D,info:s};for(i=$(t,r,o),a=0;a<=2;a++)if(s=i[a].XL(e,n,r))return{what:r?O:j,info:s};return l}function $(t,e,n){var o,r=[new B(t,e,0,n),new B(t,e,1,n),new B(t,e,2,n)];for(o=0;o<=2;o++)r[o].YL();return r}function K(t,e){var n=e?t.width:t.height;return c(0,(n-2*this.PADDING)/(this.ZL+2))}function tt(t,e){return t?e.rowOutlines:e.columnOutlines}function et(t,e,n){var o,r,i,a;if(n>0){for(o=t.items,r=void 0,i=void 0,a=[],r=0;r<n;r++)a.push(l);if(t.items=o=o.slice(0,e).concat(a,o.slice(e)),t.V3<=0&&e>0&&(i=o[e-1]))for(r=0;r<n;r++)o[e+r]=new z(i);st(t)}}function nt(t,e,n){n>0&&(t.items.splice(e,n),st(t))}function ot(t,e,n){for(var o,r,i,a,s=l,u=t.items,c=e,f=b(u);c<f&&(!(o=u[c])||o.level<n||(s||(s=new V(t,c,c,n)),o.level>n&&(c=(r=ot(t,c,n+1)).index,s.addChild(r.g)),c>s.end&&(s.end=c),!t.isGroupEnd(c,n)));c++);if(s)for(i=s.end+1,a=s.start;a<i;a++)u[a].groupInfo||(u[a].groupInfo=s);return{g:s,index:c}}function rt(t,e){return e>=-1&&e<b(t.items)}function it(t,e,n){var o,r,i=t&&t.items;if(i)for(o=i[e]&&i[e].groupInfo;o;){if((r=o.level)===n)return o;if(!(r>n))break;o=o.parent}return l}function at(t,e){switch(t){case"head":case"tail":return e===l;case"direction":return 1===e;case"itemsData":return 0===b(e);default:return!1}}function st(t){t.Zka=l,t.refresh()}function lt(t,e){!e&&t.Wka||(t.Zka=t.createRangeGroup(),ct(t))}function ut(t){t.Wka&&!t.Zka&&(t.Zka=t.createRangeGroup())}function ct(t,e){t.groupChangeHandler&&t.groupChangeHandler(e)}function ft(t,e,n){if(ht(t,e),!rt(t,e+n-1))throw Error(P().Exp_InvalidCount)}function ht(t,e){if(!rt(t,e))throw Error(P().Exp_InvalidIndex)}function pt(t,e){for(var n=t.parent;n&&(e?t.end===n.end:t.start===n.start);)t=n,n=n.parent;return t}function dt(t){return t&&new z(t)}function gt(t){return{items:t.items.map(dt),head:dt(t.head),tail:dt(t.tail),wz:t.wz,direction:t.direction()}}function mt(t,e){t.items=e.items.map(dt),t.head=dt(e.head),t.tail=dt(e.tail),t.wz=e.wz,t.direction(e.direction),lt(t,!0)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("./dist/plugins/group/group-actions.js"),a=n("./dist/plugins/group/group.ns.js"),s={},l=null,u=void 0,c=Math.max,f=Math.min,h=Math.round,p=Math.ceil,d=r.GC$,g=d.each,m=r.Im.Lm,y=o.Common.k,v=y._b,C=y.$b,b=y.ac,w=r.Ul.Ol,T=o.Common.j.Fa,x=r.Ul.Pl,S=r.Ul.fp,A="rangegroup",k=(R=(I="gc-group")+"-box")+"-expand",M=R+"-collapsed",N=I+"-line",E="rgh",D="cgh",O="rg",j="cg",F=new o.Common.ResourceManager(a.SR),P=F.getResource.bind(F),_={Gt:function(){var t,e,n,o,r,i,a=this,s=a.TL;return s||(e={x:(t=a.options.sheetAreaOffset).left,y:t.top,width:0,height:0,rowMaxLevel:-1,colMaxLevel:-1},n=a.rowOutlines,o=a.columnOutlines,r=17*a.zoom(),a.showRowOutline()&&n&&!n.iT()&&((i=n.getMaxLevel())>=0&&(e.width=r*(i+2)+4,e.rowMaxLevel=i)),a.showColumnOutline()&&o&&!o.iT()&&((i=o.getMaxLevel())>=0&&(e.height=r*(i+2)+4,e.colMaxLevel=i)),a.TL=e,e)},showRowOutline:x("showRowOutline",!0,(function(){this.$p()})),showColumnOutline:x("showColumnOutline",!0,(function(){this.$p()}))},d.extend(r.Worksheet.prototype,_),L=function(){function t(t,e,n){var o=this;o.PADDING=2,o.kj=t,o.ML=e,o.ZL=w(n)?n:tt(e,t).getMaxLevel()}return t.prototype._L=function(t){var e,n,o,r,i,a,s,l,u,f,p,d,g,y,v,C,b,w,T,x,A,k,M,N,E,D,O,j=this,F=j.kj,P=j.ZL;if(!(P<0)&&(e=j.ML,n=F.Gt(),o=K.call(j,n,e))){if(r=P+2,i=j.PADDING,a=F.options,s=n.width,l=n.height,u=n.x,f=n.y,d=(p=F.am()).width,g=p.height,y=p.Cr,v=p.Br,C=p.zr,b=p.Ar,t.save(),t.fillStyle=m(I).backgroundColor,t.strokeStyle=m(I).borderTopColor,t.lineWidth=1,t.fillRect(u,f,e?s:d,e?g:l),t.strokeRect(u-.5,f-.5,e?s:d+1,e?g+1:l),e?t.strokeRect(u-.5,b-.5,s,y):t.strokeRect(C-.5,f-.5,v,l),w=(e?y:v)-o,x=c(0,(e?b-a.sheetAreaOffset.top:C-a.sheetAreaOffset.left)+w/2),A=i,e&&(M=x,x=A,A=M),t.restore(),T=e?a.colHeaderVisible:a.rowHeaderVisible,t.save(),T&&w>=0)for(k=0;k<r;k++)N=o-1,void 0,D=u+x,O=f+A,e?D=h(D)+.5:O+=.5,t.fillStyle=m(R).backgroundColor,t.fillRect(D,O,N,N),t.font=8.25*F.zoom()+"pt Arial",t.strokeStyle=m(R).borderTopColor,t.strokeRect(D,O,N,N),t.fillStyle=m(R).color,E=S(t.font),j.pM(t,D,O,N,o,k+1,E),e?x+=o:A+=o;t.restore()}},t.prototype.pM=function(t,e,n,o,r,i,a){var s=""+i,l=t.measureText(s).width;l<=o&&a<=r&&(t.textBaseline="middle",t.fillText(s,e+(o-l)/2,n+o/2))},t.prototype.WL=function(t,e,n){var o,r,i,a,s=this,u=s.kj,c=s.ZL;return c<0?l:(o=c+2,r=u.am(),a=(i=u.options).sheetAreaOffset,n?s.qM(u,t,e,n,i.colHeaderVisible,r.Cr,r.Ar-a.top,o):s.qM(u,t,e,n,i.rowHeaderVisible,r.Br,r.zr-a.left,o))},t.prototype.qM=function(t,e,n,o,i,a,s,u){var f,h,p,d,g=t.Gt(),m=K.call(this,g,o),y=a-m;if(m&&i&&y>=0)for(f=c(0,s+y/2),h=this.PADDING,o&&(d=f,f=h,h=d),p=0;p<u;p++){if(new r.Rect(g.x+f,g.y+h,m,m).contains(e,n))return{index:p};o?f+=m:h+=m}return l},t}(),B=function(){function t(t,e,n,o){var r=this;r.PADDING=2,r.LINE_SIZE=2,r.START_LINE_SIZE=6,r.bM=[],r.cM=[],r.dM=[],r.kj=t,r.ML=e,r.eM=n,r.ZL=w(o)?o:tt(e,t).getMaxLevel()}return t.prototype.YL=function(){var t,e=this;-1!==e.ZL&&(t=e.fM(0,e.ML),g(t,(function(t,n){e.gM(n)})))},t.prototype.gM=function(t){var e,n,o,r,i,a,s,u,h,p,d,m,y,v,C,w,T,x,S=this,A=S.kj,I=S.ML,R=tt(I,A).direction(),k=1===R,M=0===R,N=S.hM(!0,I),E=S.hM(!1,I),D=t.start,O=t.end,j=t.level;if(k?e=O+1:M&&(e=D-1),0===t.state()){if(n=!0,(o=t.parent)&&(M&&D===o.start||k&&O===o.end)&&(n=!1),n&&S.iM(!0,j,e,N,E,R),D<=E&&O>=N){for(r=c(N,D),i=f(E,O),a=void 0,s=void 0,n&&(a={start:r,end:i,level:j,startLine:l},(k&&r===D||M&&i===O)&&(a.startLine=!0),S.bM.push(a)),h=[],p=t.children,s=r;s<=i;s++)h.push(!1);for(g(p,(function(t,e){var n=e.start,o=e.end;if(1===e.state())for(u=n;u<=o;u++)h[u-r]=!0;h[(k?o+1:o-1)-r]=!0,S.gM(e)})),d=!0,s=0;s<b(p);s++){if(y=(m=p[s]).start,w=(v=m.end)===O,(C=y===D)&&w){d=!1;break}if(k&&w||M&&C)for(u=y;u<=v;u++)h[u-r]=!0}if(d)for(T=r;T<=i;T++)h[T-r]||(x={index:T,level:j+1},S.cM.push(x))}}else 1===t.state()&&S.iM(!1,j,e,N,E,R)},t.prototype.iM=function(t,e,n,o,r,i){var a={isExpanded:t,level:e};t&&(a.paintLine=!0),n>=o&&n<=r&&(a.index=n,a.lineDirection=i,this.dM.push(a))},t.prototype.jM=function(t){var e=this,n=e.kj,o=e.eM;return e.ML?n.Gr(o).findRow(t):n.Hr(o).findCol(t)},t.prototype.aM=function(t){var e,n,o,r,i,a,s,l=this;-1!==l.ZL&&(e=l.kj.Gt(),n=l.ML,(o=K.call(l,e,n))&&(r=parseInt(m(N).borderTopWidth,10),r=isNaN(r)?2:r,i=h(o/3),s=(o-r)/2+(a=l.PADDING),t.save(),t.fillStyle=m(I).color,l.kM(t,l.cM,n,e,o,s,r),n?l.D_a(t,l.bM,n,e,o,s,r,i):l.E_a(t,l.bM,n,e,o,s,r,i),l.mM(t,l.dM,n,e,o,s,r,a),t.beginPath(),t.restore()))},t.prototype.kM=function(t,e,n,o,r,i,a){var s,l,u,f=this,h=f.kj.options.sheetAreaOffset,p=h.left,d=h.top;t.save(),t.fillStyle=m("gc-group-dot").color,u=f.bM,g(e,(function(e,h){var g,m,y,v,C,b=h.index,w=h.level,T=f.jM(b);T&&(f.C0a(u,b,w)||(g=n?T.y:T.x,(m=(n?T.height:T.width)-a)>=0&&(s=g+c(0,m/2),l=h.level*r+i,n?(y=s,s=l+.5,l=y,l-=d):(l+=.5,s-=p),t.strokeStyle="transparent",t.lineWidth=0,(v=o.x+s)%1!=0&&(v+=.5),(C=o.y+l)%1!=0&&(C+=.5),t.strokeRect(v,C,2,2),t.fillRect(v,C,2,2))))})),t.restore()},t.prototype.C0a=function(t,e,n){var o,r=!1,i=b(t);for(o=0;o<i;o++)if(t[o].level===n&&t[o].start<=e&&t[o].end>=e){r=!0;break}return r},t.prototype.D_a=function(t,e,n,o,r,i,a,s){var l,u,f,h,d,g,y,v,C,w,T,x,S,A,I;for(t.save(),t.strokeStyle=m(N).borderTopColor,t.fillStyle=m(N).borderTopColor,t.lineWidth=a,f=tt(n,u=(l=this).kj).direction(),d=u.options.sheetAreaOffset.top,h=0;h<b(e);h++){y=(g=e[h]).start,v=g.end,C=void 0,w=void 0;do{C=l.jM(y),y++}while(!C&&y<=v);do{w=l.jM(v),v--}while(!w&&v>=y);(C||w)&&(C?w||(w=C):C=w,T=C.y,x=g.level*r+i,S=a,A=c(0,w.y+w.height-C.y),1===f?T+=1:T-=1,T-=d,t.beginPath(),I=o.x+x+S/2,I=p(I),t.moveTo(I,o.y+T),t.lineTo(I,o.y+T+A),t.stroke(),g.startLine&&r/2-2*a>0&&(0===f&&(T=T+A-a-d),T>=C.y-d&&T<w.y+w.height-d&&t.fillRect(p(o.x+x),o.y+T,s,a)))}t.restore()},t.prototype.E_a=function(t,e,n,o,r,i,a,s){var l,u,f,h,d,g,y,v,C,w,T,x,S,A;for(t.save(),t.strokeStyle=m(N).borderTopColor,t.fillStyle=m(N).borderTopColor,t.lineWidth=a,f=tt(n,u=(l=this).kj).direction(),d=u.options.sheetAreaOffset.left,h=0;h<b(e);h++){y=(g=e[h]).start,v=g.end,C=void 0,w=void 0;do{C=l.jM(y),y++}while(!C&&y<=v);do{w=l.jM(v),v--}while(!w&&v>=y);(C||w)&&(C?w||(w=C):C=w,T=C.x,x=g.level*r+i,S=c(0,w.x+w.width-C.x),1===f&&(T+=1),T-=d,A=o.y+x+a/2,A=p(A),t.beginPath(),t.moveTo(o.x+T,A),t.lineTo(o.x+T+S,A),t.stroke(),g.startLine&&r/2-2*a>0&&(0===f&&(T=T+S-a-d),T>=C.x-d&&T<w.x+w.width-d&&t.fillRect(o.x+T,p(o.y+x),a,s)))}t.restore()},t.prototype.r0a=function(t){var e=m(t).backgroundImage;return"none"===e&&(e=""),e&&(e=(e=(e=e.split(",")[0]).replace(/url\(['"]?([^'"\)]+)['"]?\)/,"$1")).trim()),e},t.prototype.mM=function(t,e,n,o,r,i,a,s){var l,u,h,d,g,y,v,C,w,T,x,S,A,I,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J=this,$=J.kj,K=$.options,tt=K.sheetAreaOffset.left,et=K.sheetAreaOffset.top,nt=m(R).borderTopColor,ot=m(R).backgroundColor,rt=m(R).color,it=m(N).borderTopColor,at=$.vu(),st=J.r0a(k),lt=J.r0a(M);for(st&&!at.ko(st)&&at.fo(st),lt&&!at.ko(lt)&&at.fo(lt),u=lt&&at.lo(lt),h=st&&at.lo(st),d=m(k),g=m(M),y=h?d.backgroundColor:"",v=u?g.backgroundColor:"",C=h?d.borderTopColor:"",w=u?g.borderTopColor:"",l=0;l<b(e);l++)t.save(),I=e[l],(E=J.jM(I.index))?(D=n?E.height:E.width)<=0?t.restore():(O=c(0,(D-r)/2),void 0,void 0,P=(n?E.y-et:E.x-tt)+O,_=I.level*r+s,B=r,G=void 0,H=void 0,V=D-(L=f(r,D)),n?(z=P,P=_,_=z,W=L,L=B,B=W,G=.5,H=0):(G=0,H=.5),S=I.isExpanded?C:w,t.strokeStyle=S||nt,t.lineWidth=1,x=I.isExpanded?y:v,t.fillStyle=x||ot,t.fillRect(o.x+P,o.y+_,L,B),j=o.x+P+G,F=o.y+_+H,t.strokeRect(j,F,L,B),t.fillStyle=rt,T=I.isExpanded?st:lt,J.nM(t,I.isExpanded,T,j,F,L,B),t.restore(),I.paintLine&&V>0&&(t.save(),t.strokeStyle=it,P=n?E.y-et:E.x-tt,_=I.level*r+i,U=0===I.lineDirection,q=n?a:O,Y=n?O:a,n?(X=P,P=_,_=X,U&&(_+=O+B,Y=V-O)):U&&(P+=O+L,q=V-O),t.beginPath(),t.lineWidth=a,Z=p(o.x+P+a/2),Q=p(o.y+_+a/2),n?(t.moveTo(Z,o.y+_),t.lineTo(Z,o.y+_+Y-1)):(A=0,u&&!I.isExpanded&&(A=1),t.moveTo(o.x+P,Q),t.lineTo(o.x+P+G+q+A,Q)),t.stroke(),t.restore())):t.restore()},t.prototype.nM=function(t,e,n,o,r,i,a){var s,l,u,c=this.kj.vu();if(n&&c.ko(n)){l=(s=c.lo(n)).width,u=s.height;try{t.drawImage(s,0,0,l,u,h(o),h(r),i-1,a-1)}catch(t){}}else this.u0a(t,e,o,r,i,a)},t.prototype.u0a=function(t,e,n,o,r,i){var a,s,l=h(r/4),u=h(r/2);e||(a=h(i/4),s=h(i/2),t.fillRect(n+r/2-1,o+a,2,i-s)),t.fillRect(n+l,o+i/2-1,u,2)},t.prototype.fM=function(t,e){var n,o,r,i=this.kj,a=[],s=-1,l=-1,u=tt(e,i),h=(e?i.Gr:i.Hr).call(i,this.eM),p=b(h);for(p&&(o=h[0],r=h[p-1],s=c(0,(e?o.row:o.col)-1),l=e?f(i.getRowCount(),r.row+2):f(i.getColumnCount(),r.col+2));s<l;)(n=u.find(s,t))?(s=n.end+1,a.push(n)):s++;return a},t.prototype.hM=function(t,e){var n=-1,o=this.kj,r=this.eM,i=o.frozenRowCount(),a=o.frozenColumnCount(),s=o.frozenTrailingRowCount(),l=o.frozenTrailingColumnCount(),u=o.getRowCount(),c=o.getColumnCount();return 0===r?n=t?0:(e?i:a)-1:1===r?n=t?e?i:a:(e?u-s:c-l)-1:2===r&&(n=t?e?u-s:c-l:(e?u:c)-1),n},t.prototype.oM=function(t){t&&this.kj.CH&&(t.x-=2,t.y-=2,t.width+=4,t.height+=4)},t.prototype.XL=function(t,e,n){var o,i,a,s,u,h,p,d,g,m,y,v,C,w,T,x,S=this,A=S.ZL,I=S.kj,R=I.options,k=R.sheetAreaOffset.left,M=R.sheetAreaOffset.top;if(A<0)return l;if(o=I.Gt(),!(i=K.call(S,o,n)))return l;for(a=S.dM,h=0;h<b(a);h++)if(d=(p=a[h]).index,g=p.level*i+S.PADDING,(m=S.jM(d))&&(!((s=n?m.height:m.width)<=0)&&(y=f(i,s),v=i,C=(n?m.y-M:m.x-k)+c(0,(s-i)/2),w=g,n&&(T=y,y=v,v=T,x=C,C=w,w=x),u=new r.Rect(o.x+C+.5,o.y+w+.5,y,v),S.oM(u),u.contains(t,e))))return p;return l},t}(),function(t){t[t.backward=0]="backward",t[t.forward=1]="forward"}(G=e.OutlineDirection||(e.OutlineDirection={})),s.OutlineDirection=G,function(t){t[t.expanded=0]="expanded",t[t.collapsed=1]="collapsed"}(H=e.OutlineState||(e.OutlineState={})),s.OutlineState=H,V=function(){function t(t,e,n,o){var r=this;r.children=[],r.parent=l,r.model=t,r.start=e,r.end=n,r.level=o}return t.prototype.state=function(t){var e=this,n=e.model;return arguments.length?void(n&&n.expandGroup(e,0===t)):n?n.getState(e):0},t.prototype.contains=function(t){return this.start<=t&&t<=this.end},t.prototype.addChild=function(t){t&&(this.children.push(t),t.parent=this)},t}(),e.OutlineInfo=V,s.OutlineInfo=V,z=function(t){this.level=t?t.level:0,this.collapsed=!!t&&t.collapsed,this.viewCollapsed=!!t&&t.viewCollapsed},W=function(){function t(t,e,n){var o=this;o.head=l,o.tail=l,o.Zka=l,o.items=Array(t),o.V3=0,o.wz=!0,o.kj=e,o.ML=n}return t.prototype.no=function(){this.kj=l},t.prototype.group=function(t,e){var n,o,r=this;for(ft(r,t,e),r.kj.ITa.vUa(r.ML),n=0;n<e;n++)o=t+n,r.items[o]?r.items[o].level++:r.items[o]=new z;r.Wka&&r.Zka&&(r.Zka=l),lt(r),r.wz=!1},t.prototype.Lia=function(){this.Wka=!0,this.Zka=l},t.prototype.Mia=function(){this.Wka=!1,this.refresh()},t.prototype.ungroupRange=function(t,e){var n,o,r=this;for(ft(r,t,e),r.kj.ITa.vUa(r.ML),n=0;n<e;n++)(o=r.items[t+n])&&o.level>-1&&o.level--;lt(r)},t.prototype.ungroup=function(){var t=this,e=b(t.items);t.kj.ITa.vUa(t.ML),t.items=Array(e),lt(t),t.wz=!0},t.prototype.expand=function(t,e){var n,o,r,i,a,s;if(t<-1)throw Error(P().Exp_InvalidLevel);for(o=(n=this).items,n.kj.ITa.vUa(n.ML),ut(n),(i=n.kj.Cf()).suspend(),a=0,s=o.length;a<s;a++)o[a]&&((r=n.find(a,t))&&n.expandGroup(r,e));i.resume(!1)},t.prototype.expandGroup=function(t,e){if(!t)throw Error(P().Exp_GroupInfoIsNull);var n=this,o=n.direction(),r=-1;n.kj.ITa.vUa(n.ML),0===o?r=t.start-1:1===o&&(r=t.end+1),n.setCollapsed(r,!e,t.level),n.kj.$p()},t.prototype.Xr=function(t){return!(!this.wz&&rt(this,t)&&this.isCollapsed(t))},t.prototype.isCollapsed=function(t){var e=this.items[t];return!!(e&&e.viewCollapsed&&e.level>-1)},t.prototype.find=function(t,e){var n,o=this;return ut(o),-1===e?n=o.Zka:(ht(o,t),n=it(o,t,e)),n},t.prototype.getLevel=function(t){var e=this.items[t];return e?e.level:-1},t.prototype.getCollapsed=function(t){var e=this.items[t];return!!e&&!!e.collapsed},t.prototype.B4=function(t,e,n,o){var i,a,s,l=this.kj.ITa;for(i=e;i<=n;i++)(a=t[i])||((a=t[i]=new z).level=-1),a.viewCollapsed=o,s=this.ML?r.AxisInfoChangeType.outlineExpandRows:r.AxisInfoChangeType.outlineExpandColumns,l.zgc({type:s,index:[i]})},t.prototype.setCollapsed=function(t,e,n){var o,r,i,a,s,l,c=this,f=!1,h=c.items,p=[];if(c.kj.ITa.vUa(c.ML),ut(c),t<0?(o=c.head)||(o=c.head=new z):t<b(h)?(o=h[t])||((o=h[t]=new z).level=-1):(o=c.tail)||(o=c.tail=new z),r=1===c.direction(),(i=n!==u)||o.collapsed===e?i&&(o.level===n-1&&(o.collapsed=e),f=!0,c.E4(t,e,n)):(o.collapsed=e,f=!0,c.E4(t,e,n)),f&&(t+=r?-1:1,s=c.find(t,c.getLevel(t)))){for(l=s.start;l<=s.end;l++)p.push(l);a={indexes:p}}ct(c,a)},t.prototype.dPa=function(t,e){var n,o=this.items;o[t]?o[t].collapsed!==e&&(o[t].collapsed=e):((n=o[t]=new z).level=-1,n.collapsed=e)},t.prototype.E4=function(t,e,n){var o,r,i,a,s,l,c,f,h,p=this,d=p.items,g=1===p.direction(),m=n!==u,y=t+(g?-1:1),v=m?n:p.getLevel(y),C=it(p,y,v);if(C&&((g?C.end+1:C.start-1)!==t&&(C=null)),T(C)&&(v=m?n:p.getLevel(t),C=it(p,t,v)),C)if(o=void 0,r=C.parent,e)m||(o=g?C.end+1:C.start-1,p.dPa(o,!0),C=pt(C,g)),p.B4(d,C.start,C.end,!0);else{for(i=!1,a=void 0;r;){if(d[a=g?r.end+1:r.start-1]&&d[a].collapsed&&d[a].level>-1){i=!0;break}r=r.parent}if(!i)for(m||(o=g?C.end+1:C.start-1,p.dPa(o,!1),C=pt(C,g)),p.B4(d,C.start,C.end,!1),s=[C],l=0;l>=0;)if(c=s[l],l--,d[a=g?c.end+1:c.start-1]&&d[a].collapsed&&-1!==d[a].level)p.B4(d,c.start,c.end,!0);else for(f=c.children,h=0;f&&h<f.length;h++)s[++l]=f[h]}},t.prototype.getMaxLevel=function(){var t,e=-1,n=this.items;return g(n,(function(n,o){o&&((t=o.level)>e&&(e=t))})),e},t.prototype.cB=function(t,e,n,o){var r,i,a,s,l;if(!(n<=0||t===e)){for((r=this).kj.ITa.vUa(r.ML),t<0&&(t=0),e<0&&(e=0),i=[],a=r.items,s=v(a,t-1);s>=0&&s<t+n;)l=new z(a[s]),i.push({index:s-t,value:l}),s=v(a,s);o&&C(a,t,n),C(a,e,n),g(i,(function(t,n){a[e+n.index]=n.value})),st(r)}},t.prototype.bB=function(t,e,n,o,r){var i,a,s=this;if(s.kj.ITa.vUa(s.ML),e<0&&(e=0),n<0&&(n=0),i=[],t)for(a=v(t.items,e-1);a>=0&&a<e+o;)i[a-e]=new z(t.items[a]),a=v(t.items,a);C(s.items,n,o),i.length>0&&i.forEach((function(t,e){s.items[n+e]=t})),r&&C(t.items,e,o)},t.prototype.refresh=function(){this.wz||lt(this)},t.prototype.VL=function(t){var e,n,o=this,r=o.items,i=b(r),a=t-i;if(a<0)r.splice(t,-a);else if(n=void 0,e=r[i-1])for(n=0;n<a;n++)r.push(new z(e));else o.items=r.concat(Array(a));st(o)},t.prototype.getState=function(t){var e,n=this,o=n.items,r=n.direction(),i=-1;return 0===r?i=t.start-1:1===r&&(i=t.end+1),(e=i<0?n.head:i<b(o)?o[i]:n.tail)&&e.collapsed?1:0},t.prototype.Ez=function(t,e){var n=this,o=n.items;t<0?(n.head||(n.head=new z),n.head.level=e):t<b(o)?(o[t]||(o[t]=new z),o[t].level=e):(n.tail||(n.tail=new z),n.tail.level=e),st(n)},t.prototype.suspendAdding=function(){this.V3++},t.prototype.resumeAdding=function(){this.V3--},t.prototype.createRangeGroup=function(){for(var t,e,n=this,o=n.items,r=b(n.items),i=new V(n,0,r-1,-1),a=0;a<r;)o[a]&&(o[a].groupInfo=l),a++;for(a=0;a<r;)o[a]?(e=(t=ot(n,a,0)).g,a=t.index+1,e&&e.level>-1&&i.addChild(e)):a++;return i},t.prototype.qec=function(t,e){return 1===this.direction()?e===t.end+1:e===t.start-1},t.prototype.rec=function(t,e,n,o){var r=this,i=-1,a=0;if(1===r.direction()&&(i=0,a=1),t===e)return r.qec(t,n)||r.qec(t,o)?{start:t.start,end:t.end,level:t.level}:{start:n,end:o,level:t.level};for(;t.level>e.level;){if(e===t.parent)return r.qec(e,o)?{start:e.start,end:e.end,level:e.level}:{start:t.start+i,end:o,level:t.level-1};t=t.parent}for(;t.level<e.level;){if(t===e.parent)return r.qec(t,n)?{start:t.start,end:t.end,level:t.level}:{start:n,end:e.end+a,level:e.level-1};e=e.parent}for(;t.level>=0;){if(t.parent===e.parent)return{start:t.start+i,end:e.end+a,level:e.level-1};t=t.parent,e=e.parent}return{start:t.start+i,end:e.end+a,level:e.level-1}},t.prototype.sec=function(t){var e,n=this.items,o=n[t];return e=1===this.direction()?n[t-1]:n[t+1],(o?o.level:-1)<(e?e.level:-1)?e&&e.groupInfo:o&&o.groupInfo},t.prototype.kec=function(t,e){var n,o,r=this,i=r.sec(t),a=r.sec(t+e-1);if(T(i)&&T(a))return{start:t,end:t+e-1,count:e,level:-1};if(!i||!a){for(n=i||a;n&&-1!==n.level;)n=n.parent;i||(i=n),a||(a=n)}return(o=r.rec(i,a,t,t+e-1)).count=o.end-o.start+1,o},t.prototype.pec=function(t,e){var n,o,r,i,a=this.items;for(n=t;n<t+e;n++)if(o=a[n]&&a[n].groupInfo&&a[n].groupInfo.level,!T(o)&&o>=0)return!0;return i=a[r=1===this.direction()?t-1:t+e]&&a[r].groupInfo&&a[r].groupInfo.level,!T(i)&&i>=0},t.prototype.tec=function(t){var e=this.items,n=e[t]&&e[t].groupInfo&&e[t].groupInfo.level;return T(n)?-1:n},t.prototype.uec=function(t,e,n){var o,r=[],i=[];for(o=t;o<t+e;o++)this.tec(o)===n&&i.push(o),this.tec(o+1)<n&&i.length>0&&(r.push(i),i=[]);return i.length>0&&r.push(i),r},t.prototype.lec=function(t,e){var n,o,r,i,a=this;if(1===e)return a.uec(t.start,t.count,t.level);for(n=[],o=a.getMaxLevel(),r=2===e?t.level+1:t.level,i=o;i>=r&&i>=-1;i--)n=n.concat(a.uec(t.start,t.count,i));return n},t.prototype.nec=function(t,e,n){var o,r,i,a=this;for(o=t.length-1;o>=0;o--)(r=t[o]).collapse&&a.setCollapsed(r.head,!1),a.ungroupRange(r.start,r.count);for(o=t.length-1;o>=0;o--)r=t[o],i=y.Cb(e,r.head)+n,1===a.direction()?a.group(i-r.count,r.count):a.group(i+1,r.count),r.collapse&&a.setCollapsed(i,r.collapse)},t.prototype.mec=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p=this,d=p.items;if(1===n)for(o=p.getMaxLevel(),r=e.level+1;r<=o;r++)t.splice.apply(t,[0,0].concat(p.uec(e.start,e.count,r)));else 2===n&&t.push.apply(t,p.uec(e.start,e.count,e.level));for(a=t[(i=t.length)-1].concat([]),s=[],r=i-2;r>=0;r--)u=(l=d[t[r][0]]).groupInfo,1===p.direction()?(c=u.end+1,f=y.Cb(a,c),a.splice.apply(a,[f,0].concat(t[r])),s.push({head:c,start:u.start,count:c-u.start,collapse:l.viewCollapsed})):(c=u.start-1,f=y.Cb(a,c),a.splice.apply(a,[f+1,0].concat(t[r])),s.push({head:c,start:u.start,count:u.end-c,collapse:l.viewCollapsed}));for(h=!1,r=0;r<e.count;r++)if(a[r]!==r+e.start){h=!0;break}return{array:a,isChanged:h,groupSwap:s}},t.prototype.isGroupEnd=function(t,e){var n,o,r,i,a,s=this.items,l=t+1;return!rt(this,l)||!(n=s[l])||(i=!1,(o=n.level)<(r=s[t].level)&&((a=r-e)>=0&&a<r-o&&(i=!0)),i)},t.prototype.hitTest=function(t,e,n){return Q.call(t,e,n)},t.prototype.jp=function(t,e,n,o){var r,i,a,s,l,u,c=t.Gt(),f=t.am(),h=t.ss,p=c.width,d=c.height;if(p||d){if(r=o?p:f.width,i=o?f.height:d,a=o?c.rowMaxLevel:c.colMaxLevel,s=o?h.bn:h.dn,e.save(),e.beginPath(),!n||n.intersect(c.x,c.y,r,i))for(l=void 0,u=void 0,new L(t,o,a)._L(e),l=s.call(t.ss,(function(){return $(t,o,a)})),u=0;u<=2;u++)l[u].aM(e);e.beginPath(),e.restore()}},t.prototype.UL=function(t,e){if(e){var n=e.what;n===E||n===D?function(t,e){var n,o,r,i;t.isEditing&&t.isEditing()||(n=e.info.index,r=(o=e.what===E)?"expandRowOutlineForLevel":"expandColumnOutlineForLevel",Y(t,i=Z(t,o,-1,n,!0)),i&&!1===i.cancel&&(t.wu().execute({cmd:r,sheetName:t.name(),level:n}),X(t,Z(t,o,-1,n,!1))))}(t,e):n!==O&&n!==j||function(t,e){var n,o,r,i,a,s,l;t.isEditing&&t.isEditing()||tt(n=e.what===O,t)&&(i=r=(o=e.info).index,a=o.level,void 0,l=n?"expandRowOutline":"expandColumnOutline",1===o.lineDirection?r--:r++,Y(t,s=Z(t,n,r,a,!0)),s&&!1===s.cancel&&(t.wu().execute({cmd:l,sheetName:t.name(),index:i,level:a,collapsed:o.isExpanded}),X(t,Z(t,n,r,a,!1))))}(t,e)}},t.prototype.iT=function(){return this.wz},t.prototype.s0a=function(){var t=parseInt(m(N).borderTopWidth,10);return isNaN(t)?2:t},t.prototype.fromJSON=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d=e&&e.ignoreStyle;if(t&&!d){if(o=(n=this).items,r=t.items,i=t.itemsData,a=t.direction,s=t.head,l=t.tail,h=[],T(a)||n.direction(a),s&&(n.head=s),l&&(n.tail=l),r&&r.length>0)for(p=0;p<r.length;p++)T(r[p])||(o[p]=new z(r[p]),n.wz=!1);else for(g(i,(function(t,e){if(u=e.index,c=e.info,u>=0&&c){for(f=0;f<e.count&&!(u+f>=b(o));f++)e.info.collapsed&&h.push(e),o[u+f]=new z(c);n.wz=!1}})),p=0;p<h.length;p++)n.E4(h[p].index,!0);lt(n,!0)}},t.prototype.toJSON=function(t){var e,n,o,r,i,a,s,l,c,f;if(!(t&&t.ignoreStyle)){for(n=[],o=(e=this).items,i=-1,a=[],r=0;r<b(o);r++)s=n[i],(l=o[r])&&(a[r]={level:l.level,collapsed:l.collapsed,viewCollapsed:l.viewCollapsed},i>=0&&r===s.count+s.index&&l.level===s.info.level&&l.collapsed===s.info.collapsed?n[i].count++:n[++i]={index:r,count:1,info:{level:l.level,collapsed:l.collapsed}});return c={items:a,itemsData:n,direction:e.direction(),head:e.head,tail:e.tail},f={},g(c,(function(t,e){at(t,e)||(f[t]=e)})),d.isEmptyObject(f)?u:f}},t}(),e.Outline=W,W.prototype.direction=x("direction",1),s.Outline=W,d.extend(r.lUa.prototype,{vUa:function(t){var e=this,n=e.zTa;n&&(n.wUa||(n.wUa=[]),t&&!n.wUa[0]?n.wUa[0]=gt(e.xUa):t||n.wUa[1]||(n.wUa[1]=gt(e.yUa)))},zUa:function(t){var e;t&&(this,(e=t[0])&&mt(this.xUa,e),(e=t[1])&&mt(this.yUa,e))}}),r.lUa.$n(A,{init:function(){var t=this,e=t.kj;t.yUa=new W(t.getColumnCount(),e,!1),t.xUa=new W(t.getRowCount(),e,!0)},undo:function(t){var e=t.wUa;e&&(this.zUa(e),this.kj.$p())},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&(e.yUa&&(e.yUa.no(),e.yUa=l),e.xUa&&(e.xUa.no(),e.xUa=l))}}),U={init:function(){var t=this;t.rowOutlines=t.ITa.xUa,t.columnOutlines=t.ITa.yUa,t.rowOutlines.groupChangeHandler=function(e){var n,o,i,a,s,l=e&&e.indexes;l&&t.recalcRows&&((n=t.getCalcService())&&!n.IsSuspended()&&t.recalcRows(l)),(o=t.parent)&&t!==o.getActiveSheet()||t.au(),l?(i=l[0],a=l[l.length-1],s=!0):(i=0,a=t.getRowCount()-1,s=!1),r.Worksheet.ao(t,"onGroupChanged",{start:i,end:a,isRow:!0,fromSetCollapsed:s})},t.columnOutlines.groupChangeHandler=function(e){var n,o,i,a,s=t.parent;s&&t!==s.getActiveSheet()||t.bu(),(n=e&&e.indexes)?(o=n[0],i=n[n.length-1],a=!0):(o=0,i=t.getColumnCount()-1,a=!1),r.Worksheet.ao(t,"onGroupChanged",{start:o,end:i,isRow:!1,fromSetCollapsed:a})},t.Wr.push(t.rowOutlines),t.Zr.push(t.columnOutlines)},dispose:function(t){var e=this;!1!==t.clearCache&&(e.rowOutlines&&(e.rowOutlines.groupChangeHandler=l),e.columnOutlines&&(e.columnOutlines.groupChangeHandler=l)),d(e.Ws()).unbind("mousedown.group")},setHost:function(t){if(t){var e=this;t.bind("mousedown.group",(function(t){var n,o=e.Vs(),r=Q.call(e,t.pageX-o.left,t.pageY-o.top);r&&((n=r.what)===O||n===E?e.rowOutlines.UL(e,r):n!==j&&n!==D||e.columnOutlines.UL(e,r))}))}},onPaintSuspend:function(t){var e=this;t.suspend?(e.rowOutlines.Lia(),e.columnOutlines.Lia()):(e.rowOutlines.Mia(),e.columnOutlines.Mia())},beforeLayoutChanged:function(t){"invalidateLayout"===t.changeType&&(this.TL=l)},onLayoutChanged:function(t){var e=this,n=t.changeType,o=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=t.sheetArea,u=e.rowOutlines,c=e.columnOutlines,f=this.ITa;"addRows"===n?(f.vUa(!0),et(u,o,r)):"deleteRows"===n?(f.vUa(!0),nt(u,o,r)):"addColumns"===n?(f.vUa(!1),et(c,i,a)):"deleteColumns"===n?(f.vUa(!1),nt(c,i,a)):"invalidateLayout"===n?e.TL=l:"setColumnCount"===n?(f.vUa(!1),3!==s&&1!==s||c.VL(a)):"setRowCount"!==n||3!==s&&2!==s||(f.vUa(!0),u.VL(r))},paint:function(t){var e=t.ctx,n=t.clipRect,o=this,r=o.rowOutlines,i=o.columnOutlines;r&&r.jp(o,e,n,!0),i&&i.jp(o,e,n,!1)},fromJson:function(t,e,n){if(t){var o=this,r=void 0,i=t.showRowRangeGroup,a=t.showColumnRangeGroup,s=w(i)?i:t.showRowOutline,l=w(a)?a:t.showColumnOutline;T(s)||o.showRowOutline(s),T(l)||o.showColumnOutline(l),(r=t.rowRangeGroup||t.rowOutlines)&&o.rowOutlines.fromJSON(r,n),(r=t.colRangeGroup||t.columnOutlines)&&o.columnOutlines.fromJSON(r,n)}},toJson:function(t,e){var n,o=this,r=o.rowOutlines,i=o.columnOutlines,a=o.showRowOutline();!0!==a&&(t.showRowOutline=a),!0!==(n=o.showColumnOutline())&&(t.showColumnOutline=n),t.rowOutlines=r?r.toJSON(e):u,t.columnOutlines=i?i.toJSON(e):u}},r.Worksheet.$n(A,U),q={init:function(){i.Commands.SL(this.commandManager())}},r.Workbook.$n(A,q)},"./dist/plugins/group/group.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/group/group.res.en.js");e.SR={en:o}},"./dist/plugins/group/group.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidIndex="Invalid index",e.Exp_InvalidCount="Invalid count",e.Exp_InvalidLevel="Invalid level",e.Exp_GroupInfoIsNull="groupInfo is null"},"./dist/plugins/hyperlink/hyperlink.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function L(t,e,n,o){return h(o)&&(o=3),!h(t.getHyperlink(e,n,o))}function B(){var t=s("div");return u(t).css("position","absolute").css("margin",0).css("padding",2).css("border","1px #c0c0c0 solid").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css("box-sizing","content-box").css("background-color","white").css("font","9pt Arial"),t}function G(t){var e=(t&&t.zo()).getElementsByClassName(T)[0];h(e)||u(e).hide()}function H(t,e){h(e)||(e.drawUnderline&&(h(t.textDecoration)?t.textDecoration=1:1!=(1&t.textDecoration)&&(t.textDecoration+=1)),e.isVisited?e.visitedLinkColor===m?t.foreColor="rgba(0,0,0,0)":e.visitedLinkColor===g?t.foreColor=S:t.foreColor=e.visitedLinkColor:h(e.linkColor)?e.linkColor===g&&t.foreColor||(t.foreColor=x):t.foreColor=e.linkColor)}function V(t){if(t&&t.cellType){var e=t.cellType.typeName;if(!P[e])return!0}return!1}function z(t){var e={context:t,value:0};return f.ao(t.sheet,"getOutlineColumnOffset",e),e.value}function W(t,e){var n=a(e);return{x:0,y:0,width:y(0,o.Vn.Xn(t,e,!0)),height:t.split(/\r\n|\r|\n/).length*n}}function U(t,e,n,o,r,i,a){var s=W(t,o),l=function(t,e,n,o,r,i,a){var s=0,l=0,u=t.width,c=t.height,f=z(a);return f&&(u-=f),s=i=i||0,1===o?s=(u-e)/2:2===o&&(s=u-e-i),1===r?l=(c-n)/2:2===r&&(l=c-n),f&&(s+=f),{x:s,y:l}}(r,s.width,s.height,e,n,i,a);return s.x=l.x,s.y=l.y,s}function q(t,e,n,r,i,a){var s,u,c,f,p,d,g,m,y,C,b,w,T,x=i.sheet,S=x.yl;if(h(n))return!1;if(n.textOrientation)return!0;if(s=x.getValue(i.row,i.col,i.sheetArea),a||(a=x.getText(i.row,i.col,i.sheetArea)),!a)return!1;for(a=a.replace(/\s+/g," "),u=n&&n.font?n.font:S.Bl(),u=S.Cl(u),c=[a],f=function(t){return 8*(t.textIndent||0)}(n),n.wordWrap&&(a=(c=o.Vn.Wn(a,r.width-3-f,u)).join("\r\n")),p=n.hAlign,d=n.vAlign,3===p&&(p=l(p,s,n.formatter)),g=U(a,p,d,u,r,f,i),m=r.y+g.y,y=0;y<c.length;y++)if(C=U(c[y],p,d,u,r,f,i),b=r.x+C.x,w=v(b+C.width,r.x+r.width),m=v((T=m)+C.height,r.y+r.height),b<=t&&t<w&&T<=e&&e<m)return!0;return!1}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("SheetsCalc"),a=o.Ul.fp,s=o.Ul.Nl,l=o.Ul.ol,u=o.GC$,c=o.Commands.ActionBase,f=o.CellTypes.Base,h=r.Common.j.Fa,p=r.Common.j.C4,d=r.Common.u.BIc,r.Common.pc,g=void 0,m=null,y=Math.max,v=Math.min,Math.floor,C=window.open,b=r.Common.u.kb,w="default",T="gc-spread-hyperlink-tooltip",x="hyperlink",S="followedHyperlink",A="hyperlink",I="openUrl",R="generateHyperlink",k=/^sjs:\/\/\w+[\!]\w+([\:]\w+)?/,M=/^(mailto:\/\/)?([A-Za-z0-9_\-\.\!\#$%&'*\+/=?^`{|}~])+\@([A-Za-z0-9\-])+\.([A-Za-z0-9\-]){2,63}(\?subject=.+)?$/gi,N=/(((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|www\.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9]\.[^\s]{2,}|((ht|f)tp(s?)):\/\/(?:www\.|(?!www))[a-zA-Z0-9]+\.[^\s]{2,}|www\.[a-zA-Z0-9]+\.[^\s]{2,})/gi,function(t){t[t.blank=0]="blank",t[t.self=1]="self",t[t.parent=2]="parent",t[t.top=3]="top"}(e.HyperlinkTargetType||(e.HyperlinkTargetType={})),o.GC$.extend(o.lUa.prototype,{getHyperlink:function(t,e,n){var o;return h(n)&&(n=3),this,(o=this.XTa(n).RTa(t,e))&&!h(o.hyperlink)?o.hyperlink:m},setHyperlink:function(t,e,n,o){var r,i,a,s,l,u,c=this;if(h(o)&&(o=3),(r=n&&n.url)&&r.match(N)&&r.match(N).length>0?("www.",b(r,"www.")&&(n.url="http://"+r)):r&&r.match(M)&&r.match(M).length>0&&(b(r,i="mailto:")||(n.url=i+r)),a=c.WTa>0?[["sheetModels",o],g]:g,s=c.XTa(o).RTa(t,e,!0,a?a[0]:g),h(s))a&&(a.length=0);else{if(l=s.hyperlink,h(n))s.hyperlink=null,delete s.hyperlink;else for(u in s.hyperlink={url:"",linkColor:g,visitedLinkColor:g,tooltip:"",target:0,drawUnderline:!0,isVisited:!1,command:""},s.hyperlink)n[u]!==g&&(s.hyperlink[u]=n[u]);a&&(a[0].push("hyperlink"),a[1]=l)}a&&a.length>0&&c.zTa.push(a)}}),o.GC$.extend(o.Worksheet.prototype,{getHyperlink:function(t,e,n){var o;return 0===n?m:(h(n)&&(n=3),this,o=this.ITa,p(o.getHyperlink(t,e,n)))},setHyperlink:function(t,e,n,o){var r,i,a;0!==o&&(h(o)&&(o=3),this,i=(r=this.ITa).getRowCount(o),a=r.getColumnCount(o),t<0||t>=i||e<0||e>=a||(r.do("setHyperlink",t,e,n,o),this.$p()))}}),E=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.execute=function(){var t,e,n,o,a,s,l,u,c=this,f=c.kj,p=c.VQ.url;return h(p)||(t=c.VQ.target||0,e="sjs://",0===p.indexOf(e)?(n=e.length,(o=i.formulaToRanges(f,p.substring(n),0,0,!0))&&o.length>0&&(a=o[0].sheetName,s=o[0].ranges[0],a!==f.name()&&(f.parent.setActiveSheet(a),f=f.parent.getActiveSheet()),f.setSelection(s.row,s.col,s.rowCount,s.colCount))):h(p)||(l="mailto:",p.match(N)&&p.match(N).length>0?("www.",b(p,"www.")&&(p="http://"+p)):p.match(M)&&p.match(M).length>0&&(b(p,l)||(p=l+p)),b(p,l)&&r.Common.u.Jb(p,"?")>1&&(u=p.split("?"),p=u[0]+"?"+u.slice(1).join("%3F")),C(d(p),["_blank","_self","_parent","_top"][t]))),!1},e}(c),o.Commands[I]={canUndo:!1,execute:function(t,e,n){return o.Commands.h4(t,E,e,n)}},D=function(t){function e(e,n){return t.call(this,e,n)||this}return _(e,t),e.prototype.execute=function(){var t,e,n,r=this,i=r.kj,a=r.VQ,s=a.url,l=a.row,u=a.col,c=a.sheetArea;if(null===s)t=null;else{if("string"!=typeof s)return!1;if((!(e=s.match(N))||e.length<1)&&((!(e=s.match(M))||e.length<1)&&(e=s.match(k))),!(e&&e.length>0&&0===s.indexOf(e[0])&&s.length===e[0].length))return!1;t={url:s,linkColor:x,visitedLinkColor:S}}return i.ITa.startTransaction(),i.suspendPaint(),i.suspendEvent(),i.setHyperlink(l,u,t,c),i.resumeEvent(),i.resumePaint(),n=o.Commands.bWa(i.name()),r.VQ[n]=i.ITa.endTransaction(),!0},e.prototype.undo=function(){var t,e=this.kj;return e.suspendPaint(),e.suspendEvent(),t=o.Commands.bWa(e.name()),e.ITa.undo(this.VQ[t]),e.resumeEvent(),e.resumePaint(),!0},e}(c),o.Commands[R]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,D,e,n)}},O={init:function(){this.commandManager().register(I,o.Commands[I]),this.commandManager().register(R,o.Commands[R])}},o.Workbook.$n(A,O),j={setHyperlinkWhenEditing:function(t){var e=t.url,n=t.row,o=t.col,r=t.sheetArea,i=this.getParent();i.options.allowAutoCreateHyperlink&&i.commandManager().execute({cmd:R,sheetName:this.name(),url:e,row:n,col:o,sheetArea:r})}},o.Worksheet.$n(A,j),F={applyHyperlinkStyle:function(t){var e=t.style,n=t.sheet.getHyperlink(t.row,t.col,t.sheetArea);!V(e)&&H(e,n)},getCellTextHitInfo:function(t){var e,n=t.context.sheetArea,o=t.cellStyle,r=t.context,i=r.sheet,a=r.row,s=r.col;L(i,a,s,n)&&!V(o)&&(h(n)&&3!==n||!o||!t.cellRect||(e=i.getText(a,s,n),t.paddingHitInfo={row:a,col:s,x:t.x,y:t.y,sheetArea:n,sheet:i,isFocusAware:!0,isReservedLocation:q(t.x,t.y,o,t.cellRect,r,e)}))},processMouseUpOnCellPadding:function(t){var e,n,r,i,a,s=t.sheet,l=t.cellStyle,u=t.row,c=t.col,f=t.sheetArea;s&&!s.isEditing()&&L(s,u,c,f)&&!V(l)&&t.isReservedLocation&&(e=s.Ws(),G(s),e&&(e.style.cursor=w),(n=s.ITa.getHyperlink(u,c,f)).isVisited=!0,r=n.command,h(r)||""===r||r===I?s.getParent().commandManager().execute({cmd:I,sheetName:s.name(),url:n.url,target:n.target}):"string"==typeof r?s.getParent().commandManager().execute({cmd:r,row:u,col:c,sheetName:s.name(),sheetArea:f}):"function"==typeof r&&r.call(m,s,u,c,f),i=s.getColumnCount(),a=new o.Range(u,-1,1,i),s.repaint(s.getRangeRect(1,1,a)))},processMouseMoveOnCellPadding:function(t){var e,n,o=t.row,r=t.col,i=t.sheet,a=t.cellStyle,s=t.sheetArea;L(i,o,r,s)&&!V(a)&&(!i||i.isEditing()&&i.getActiveRowIndex()===o&&i.getActiveColumnIndex()===r||(e=i.Ws(),n=i.getHyperlink(o,r,s),t.isReservedLocation?e&&(function(t,e,n){var o,r,i,a,s,l,c;n&&(o=t&&t.zo(),r=o.getElementsByClassName(T)[0],i=!1,h(r)&&((r=B()).className=T,o.insertBefore(r,m),i=!0),a=u(r),!i&&a.isVisible()||(a.text(n),s=t.mm.bG(),l=s.left+e.x,c=s.top+e.y+20,a.css("top",c).css("left",l),a.show()))}(i,t,n.tooltip),e.style.cursor="pointer"):(G(i),e&&(e.style.cursor=w))))},processMouseLeaveOnCellPadding:function(t){var e,n=t.sheet,o=t.row,r=t.col,i=t.sheetArea;G(n),L(n,o,r,i)&&n&&((e=n.Ws())&&(e.style.cursor=w))},onUpdateContainer:function(t){var e=t.cellStyle,n=t.context.row,o=t.context.col,r=t.context.sheet.getHyperlink(n,o);!V(e)&&H(e,r)}},f.$n(A,F),P={0:!0,1:!0,2:!0,3:!0,4:!0}},"./dist/plugins/outlineColumn/outlineColumn-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function g(t,e,n,o){return m(t,e,n,o)}function m(t,e,n,o){var r,i,s,l,u,c,f,h,p,d=a(o)?t.getActiveColumnIndex():o;if(!t.outlineColumn.XQa(d))return null;if(r=e?1:-1,i=t.getActiveRowIndex(),s=t.getSelections()[0].rowCount,u=!0,a(n))for(n={},u=!1,l=i;l<s+i;l++)0!==l&&(c=t.rowOutlines.getLevel(l),e&&(c>t.rowOutlines.getLevel(l-1)&&!n[l-1])||(f=c+r,h=t.outlineColumn.options(),(p=a(h.maxLevel)?t.outlineColumn.Oia().maxLevel:h.maxLevel)&&f+1>p||f+1<0||(n[l]={row:l,original:c+1,current:f+1},u=!0)));return u?n:null}function y(t,e,n,o){var r,i,s,l=m(t,e,n,o);if(!l)return null;for(i in r=a(o)?t.getActiveColumnIndex():o,t.outlineColumn.Lia(),t.suspendPaint(),l)Object.prototype.hasOwnProperty.call(l,i)&&(s=l[i],t.getCell(s.row,r).textIndent(s.current));t.resumePaint(),t.outlineColumn.Mia()}function v(t,e,n,o){var r,i,a,s,l,u=0,c=0,f=t.rowOutlines.getLevel(e);if(t.outlineColumn.Kia.updateCheckStatus(e,o),null!==(i=e<=t.getRowCount()-2?t.rowOutlines.find(e+1,f+1):null)&&null!==o)for(a=i.start;a<i.end+1;a++)t.outlineColumn.Kia.updateCheckStatus(a,o);for(i=t.rowOutlines.find(e,f);null!==i&&null!==i.parent;){if(i.start>0){for(u=i.start-1,c=t.rowOutlines.getLevel(u),t.outlineColumn.Kia.updateCheckStatus(u,o),a=(r=t.rowOutlines.find(u+1,c+1)).start;a<r.end+1;a++)if((s=t.outlineColumn.Kia.QR[a].checkBox.checkStatus)!==o){l="number"==typeof s&&"number"==typeof o&&3,t.outlineColumn.Kia.updateCheckStatus(u,l);break}a===r.end+1&&!0===o&&t.outlineColumn.Kia.updateCheckStatus(u,!0)}i=i.parent}}function C(t){var e=t.kj,n=r.Commands.bWa(e.name()),o=t.VQ[n];e.ITa.undo(o)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),e.commands=r.Commands,i=r.Commands.ActionBase,a=o.Common.j.Fa,s="increaseCellIndent",l="decreaseCellIndent",u="updateOutlineColumnCheckStatus",e.outlineColumnCheckStatus="outlineColumnCheckStatus",c=r.Commands.h4,e.setCheckStatus=v,f=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.canExecute=function(){return!!g(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns)},e.prototype.canUndo=function(){return!0},e.prototype.execute=function(){var t,e;return!!this.canExecute()&&((t=this.kj).ITa.startTransaction(),t.outlineColumn.Kia.JVa(),y(this.kj,!0,this.VQ.changingRows,this.VQ.changingColumns),e=r.Commands.bWa(t.name()),this.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.undo=function(){var t=this.kj,e=r.Commands.bWa(t.name()),n=this.VQ[e];return t.ITa.undo(n),!0},e}(i),h=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.canExecute=function(){return!!g(this.kj,!1,this.VQ.changingRows,this.VQ.changingColumns)},e.prototype.canUndo=function(){return!0},e.prototype.execute=function(){var t,e;return!!this.canExecute()&&((t=this.kj).ITa.startTransaction(),t.outlineColumn.Kia.JVa(),y(t,!1,this.VQ.changingRows,this.VQ.changingColumns),e=r.Commands.bWa(t.name()),this.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.undo=function(){return C(this),!0},e}(i),p=function(t){function e(e,n){return t.call(this,e,n)||this}return d(e,t),e.prototype.canExecute=function(){return!0},e.prototype.canUndo=function(){return!0},e.prototype.execute=function(){var t=this.kj,e=this.VQ,n=e.row,o=e.col,i=e.status;return t.ITa.startTransaction(),v(t,n,0,i),t.outlineColumn.refresh(),e[r.Commands.bWa(t.name())]=t.ITa.endTransaction(),function(t,e,n,o){t.Wq(r.Events.OutlineColumnCheckStatusChanged,{sheet:t,sheetName:t.name(),row:e,col:n,status:o})}(t,n,o,i),!0},e.prototype.undo=function(){return C(this),this.kj.outlineColumn.refresh(),!0},e}(i),r.Commands[s]={canUndo:!0,execute:function(t,e,n){return e.cmd=s,c(t,f,e,n)}},r.Commands[l]={canUndo:!0,execute:function(t,e,n){return e.cmd=l,c(t,h,e,n)}},r.Commands[u]={canUndo:!0,execute:function(t,e,n){return e.cmd=u,c(t,p,e,n)}},r.Commands.$Qa=function(t){var e=r.Ul.sl(),n=!e,o=e;t.register(s,r.Commands[s],221,n,!1,!0,o),t.register(l,r.Commands[l],219,n,!1,!0,o),t.register(u,r.Commands[u])}},"./dist/plugins/outlineColumn/outlineColumn.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/outlineColumn/outlineColumn.js")),o(n("./dist/plugins/outlineColumn/outlineColumn-actions.js"))},"./dist/plugins/outlineColumn/outlineColumn.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w;function T(t,e){return t&&t.outlineColumn&&t.outlineColumn.options()&&t.outlineColumn.options().columnIndex===e}function x(t,e,n,o,r){var i,a=n.x+o.x,s=o.y+o.height/2-n.height/2,l=n.width,u=n.height;if(!(o.x+o.width<a+l)&&e&&"none"!==e&&r)try{r.ko(e)?(i=r.lo(e),t.drawImage(i,a,s,l,u)):r.fo(e)}catch(t){}}function S(t,e,n,o){var r={sheet:t,sheetName:t.name(),isRowGroup:!0,index:e,level:n};return o&&(r.cancel=!1),r}function A(t,e,n){var r,i=t.rowOutlines.getLevel(e);h(n)&&(n=!t.rowOutlines.getCollapsed(e)),r=S(t,e+1,i+1,!0),t.Wq(o.Events.RangeGroupStateChanging,r),r&&!1===r.cancel&&(t.wu().execute({cmd:"expandRowOutline",sheetName:t.name(),index:e,level:i+1,collapsed:n}),t.Wq(o.Events.RangeGroupStateChanged,S(t,e+1,i+1,!1)))}function I(t,e,n,o){var r,i;h(o)&&(o=typeof(r=t.outlineColumn.getCheckStatus(e))===d?1===r?2:1:!r),i={cmd:"updateOutlineColumnCheckStatus",row:e,col:n,status:o,sheetName:t.name()},t.wu().execute(i)}function R(t,e){return h(t[e])?m[e]:t[e]}function k(t,e,n,o,r,i){var a,s;(h(n.showCheckBox)?m.showCheckBox:n.showCheckBox)?(a=!h(i.checkBox)&&1!==i.checkBox&&i.checkBox.checkStatus,s=t.zoom(),i.checkBox={x:r.value+3*s,y:-6*s,width:12*s,height:12*s,checkStatus:a},!1===a&&function(t,e){for(var n,o,r,i,a,s,l,u=t.rowOutlines,c=t.outlineColumn.Kia,f=u.getLevel(e),h=u.find(e,f),p=0,g=0;null!==h&&null!==h.parent;){if((o=h.start)>0)for(p=o-1,g=u.getLevel(p),c.updateCheckStatus(p,!1),r=(n=u.find(p+1,g+1)).start;r<n.end+1;r++)if(a=(i=c.QR[r])&&i.checkBox,i&&a&&!1!==(s=a.checkStatus)){l=typeof s===d&&!1,c.updateCheckStatus(p,l);break}h=h.parent}}(t,e),r.value+=6*s+12*s):delete i.checkBox}function M(t,e,n){var o,r,i,a,s=t.outlineColumn.options(),l=s&&s.columnIndex;if(!h(l))return o={value:0},r=0,(i=t.getActualStyle(e,l))&&i.textIndent&&(r=i.textIndent),0!==e&&(r-(a=t.rowOutlines.getLevel(e-1))>=3&&(r=a+2)),o.value+=8*r,function(t,e,n){var o,r,i,a=t.getLevel(e);if(n!==a+1)for(o=n-(a+1),r=0,i=Math.abs(o);r<i;r++)o>0?t.group(e,1):t.ungroupRange(e,1)}(t.rowOutlines,e,r),function(t,e,n,o,r,i,a){var s,l,u,c,f,h,p,d;R(n,"showIndicator")?(s=t.zoom(),l=t.getRowCount(),u=!!t.rowOutlines.isCollapsed(e+1),c=5*s,f=6*s,h=null,p=null,n.expandIndicator&&(h=n.expandIndicator,u&&(c=16*s,f=16*s)),n.collapseIndicator&&(p=n.collapseIndicator,u||(c=16*s,f=16*s)),e<l-1&&((d=t.getStyle(e+1,o))&&d.textIndent>r?a.indicator={x:i.value+3*s,y:-f/2,width:c,height:f,collapsed:u,collapseIndicator:p,expandIndicator:h}:delete a.indicator),i.value+=6*s+c):delete a.indicator}(t,e,s,l,r,o,n),k(t,e,s,0,o,n),function(t,e,n,o,r){var i,a,s,l;(h(n.showImage)?m.showImage:n.showImage)?(i=n.images,a=t.zoom(),i&&i.length&&(s=e>i.length-1?i[i.length-1]:i[e],l=o.value+3*a,0,r.images={image:s,x:l,y:0,width:16*a,height:16*a},o.value+=6*a+16*a)):delete r.images}(t,r,s,o,n),n.cellContent={left:o.value,x:o.value,y:0,width:-o.value,height:0},n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/outlineColumn/outlineColumn-actions.js"),a=r.Common.k,s=a.ac,l=r.Common.A,u=r.Common.B,c=o.GC$.each,f=o.GC$.isEmptyObject,h=r.Common.j.Fa,d="number",g=null,m={columnIndex:p=void 0,showCheckBox:!1,showImage:!1,images:p,showIndicator:!0,expandIndicator:p,collapseIndicator:p,maxLevel:10},y=function(){function t(t){this.kj=t,this.YQa={},this.$e=0}return t.prototype.no=function(){this.kj=g,this.Kia=g},t.prototype.LRa=function(t,e){return this.ZQa()?this.Kia.QR[t].cellContent.left:null},t.prototype.options=function(t){var e=this,n=e.YQa;return s(arguments)?(e.YQa=t,e.refresh(),e):n},t.prototype.refresh=function(){var t=this.kj;h(this.YQa)||h(this.YQa.columnIndex)||0===this.$e&&(t.suspendPaint(),t.outlineColumn.Kia.updateModel(),t.resumePaint())},t.prototype.setCheckStatus=function(t,e){var n=this.YQa.columnIndex;h(n)||I(this.kj,t,n,e)},t.prototype.Wlb=function(t){this.kj.outlineColumn.Kia.setAllTiemCheckStatus(t),this.refresh()},t.prototype.getCheckStatus=function(t){var e,n;if(s(arguments))return this.kj.outlineColumn.Kia.getCheckStatus(t);for(e=[],n=this.kj.getRowCount(),t=0;t<n;t++)e[t]=this.kj.outlineColumn.Kia.getCheckStatus(t);return e},t.prototype.setCollapsed=function(t,e){A(this.kj,t,e)},t.prototype.getCollapsed=function(t){var e,n;if(s(arguments))return this.kj.outlineColumn.Kia.getCollapsed(t);for(e=[],n=this.kj.getRowCount(),t=0;t<n;t++)e[t]=this.kj.outlineColumn.Kia.getCollapsed(t);return e},t.prototype.XQa=function(t){return this.YQa&&this.YQa.columnIndex===t},t.prototype.ZQa=function(){return this.YQa&&!h(this.YQa.columnIndex)},t.prototype.Lia=function(){this.$e++},t.prototype.Mia=function(){this.$e>0&&this.$e--,0===this.$e&&this.refresh()},t.prototype.Nia=function(t,e){this.kj.outlineColumn.Kia.insertRows(t,e)},t.prototype.STa=function(t,e){this.kj.outlineColumn.Kia.deleteRows(t,e)},t.prototype.Oia=function(){return m},t.prototype.Pia=function(){return{TRIANGLE_HEIGHT:5,TRIANGLE_BASE:6,CHECKBOX_RADIUS:6,GAP:3,IMAGE_WIDTH:16,IMAGE_HEIGHT:16,INDICATOR_IMAGE_WIDTH:16,INDICATOR_IMAGE_HEIGHT:16}},t.prototype.Gka=function(t){var e;for(e in t)t.hasOwnProperty(e)&&((this.Kia.QR[e]=this.Kia.QR[e]||{}).checkBox={checkStatus:t[e].checked})},t.prototype.CXa=function(t,e){var n=this.YQa.columnIndex;h(n)||i.setCheckStatus(this.kj,t,n,e)},t.prototype.WZa=function(){return this.Kia.QR},t}(),e.OutlineColumn=y,v=function(){function t(t){this.kj=t,this.QR={}}return t.prototype.no=function(){this.kj=g},t.prototype.updateIndicatorCollapsed=function(t,e){var n=this;h(n.QR[t])||h(n.QR[t].indicator)||(n.QR[t].indicator.collapsed=e)},t.prototype.updateCheckStatus=function(t,e){var n=this;n.JVa(t),h(n.QR[t])||(n.QR[t].checkBox.checkStatus=e)},t.prototype.setAllTiemCheckStatus=function(t){var e,n=this.QR;for(e in n)n.hasOwnProperty(e)&&(n[e].checkBox.checkStatus=t)},t.prototype.getCheckStatus=function(t){var e=this;return h(e.QR[t])||h(e.QR[t].checkBox)?null:e.QR[t].checkBox.checkStatus},t.prototype.getCollapsed=function(t){var e=this;return!h(e.QR[t])&&!h(e.QR[t].indicator)&&e.QR[t].indicator.collapsed},t.prototype.updateModel=function(){var t,e=this,n=e.kj,o=n.getRowCount();for(n.rowOutlines.direction(0),t=0;t<o;t++)e.QR[t]=e.QR[t]||{},M(n,t,e.QR[t])},t.prototype.insertRows=function(t,e){this.oEc(t,e),this.kEc(t,e)},t.prototype.oEc=function(t,e){var n,o,r,i=this.kj,a=i.outlineColumn.options();h(a)||(n=a.columnIndex,h(n)||(r=0,(o=i.getStyle(t-1,n))&&o.textIndent&&(r=o.textIndent),i.getRange(t,n,e,1).textIndent(r)))},t.prototype.kEc=function(t,e){var n,o=this.QR,r=o[t-1],i=r&&r.checkBox,a=this.kj.getRowCount();for(l(o,a,t,e),n=0;n<e;n++)o[t+n]={checkBox:{checkStatus:i&&i.checkStatus}}},t.prototype.deleteRows=function(t,e){this.lEc(t,e)},t.prototype.lEc=function(t,e){var n=this.QR,o=this.kj.getRowCount();u(n,o,t,e)},t.prototype.KVa=function(t,e){var n,o=this.QR[e];o&&!t[e]&&(n=o.checkBox,t[e]={checked:n&&n.checkStatus})},t.prototype.LVa=function(t){var e,n=this.QR;for(e in n)n.hasOwnProperty(e)&&this.KVa(t,e)},t.prototype.MVa=function(t){var e,n=this.QR;for(e in t)h(t[e].checked)||(n[e].checkBox.checkStatus=t[e].checked)},t.prototype.NVa=function(){var t=this.kj.ITa.zTa;return t?(t.OVa||(t.OVa={items:{}}),t.OVa):p},t.prototype.JVa=function(t){var e=this,n=e.NVa();n&&!n.all&&(h(t)?(n.all=!0,e.LVa(n.items)):e.KVa(n.items,t))},t.prototype.PVa=function(t){this.MVa(t.items)},t}(),o.GC$.extend(o.lUa.prototype,{PVa:function(t){var e=this.QVa,n=e.Kia;e.ZQa()&&(n.updateModel(),t&&n.PVa(t),this.kj.$p())}}),o.lUa.$n("outlineColumn",{init:function(){var t=this,e=t.kj;t.QVa=new y(e),t.QVa.Kia=new v(e)},undo:function(t){var e=t.OVa;e&&this.PVa(e)},dispose:function(t){var e=this;!1!==(t&&t.clearCache)&&e.QVa&&(e.QVa.Kia&&(e.QVa.Kia.no(),e.QVa.Kia=g),e.QVa.no(),e.QVa=g)}}),C={init:function(){this.outlineColumn=this.ITa.QVa},toJson:function(t){var e,n,o,r,i,a,s,l;if(e=this.outlineColumn,n=e.YQa,o=e.Kia.QR,!h(n)){if(r={},c(m,(function(t){i=n[t],h(i)||function(t,e){return m[t]===e}(t,i)||(r[t]=i)})),a={},n.showCheckBox)for(s in o)o.hasOwnProperty(s)&&((l=o[s].checkBox.checkStatus)&&(a[s]={checked:l}));f(a)||(r.data=a),t.outlineColumnOptions=r}},fromJson:function(t){var e,n,o,r=this.outlineColumn,i=t.outlineColumnOptions;if(i){if(i.kj=this,n=void 0,e=i.data){for(o in n={},i)"data"!==o&&(n[o]=i[o]);r.Gka(e)}r.options(h(n)?i:n),r.refresh()}},onLayoutChanged:function(t){var e,n,o=this,r=o.outlineColumn,i=t.changeType,a=t.rowCount,s=t.row;if("addRows"===i)r.Kia.JVa(),r.Nia(s,a),r.refresh();else if("deleteRows"===i)r.Kia.JVa(),r.STa(s,a),r.refresh();else if("zoomSheet"===i)r.refresh();else if("invalidateLayout"===i&&r.Kia.QR&&!f(r.Kia.QR)&&o.rowOutlines.items&&!f(o.rowOutlines.items))for(n in e=o.rowOutlines.items)e.hasOwnProperty(n)&&r.Kia.updateIndicatorCollapsed(parseInt(n,10),o.rowOutlines.isCollapsed(parseInt(n,10)+1))},sortRangeChanged:function(t){for(var e=this.outlineColumn,n=t.column,o=t.columnCount,r=n;e.XQa(r)&&r<=n+o;)e.refresh(),r+=1}},o.Worksheet.$n("outlineColumn",C),b={paintCellPadding:function(t){var e,n=t.options.rect,o=t.options.context.sheet,r=t.options.context,i=r.row,a=r.col,s=t.ctx;T(o,a)&&n.width>0&&n.height>0&&((e=o.outlineColumn.Kia.QR[i])&&(s.save(),e.indicator&&function(t,e,n,o){var r=e.collapsed,i=e.x+n.x,a=n.y+n.height/2-e.height/2,s=e.height,l=e.width;n.x+n.width<i+l||(r?e.expandIndicator?x(t,e.expandIndicator,e,n,o):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(i,a),t.lineTo(i,a+s),t.lineTo(i+l,a+s/2),t.fill(),t.restore()):e.collapseIndicator?x(t,e.collapseIndicator,e,n,o):(t.save(),t.fillStyle="black",t.beginPath(),t.moveTo(i,a+s),t.lineTo(i+l,a+s),t.lineTo(i+l,a),t.fill(),t.restore()))}(s,e.indicator,n,r.imageLoader),e.checkBox&&function(t,e,n){var o=e.x+n.x,r=n.y+n.height/2-e.height/2,i=e.height,a=e.width;n.x+n.width<o+a||(t.save(),t.beginPath(),t.strokeStyle="black",t.strokeRect(o,r,a,i),t.fillStyle="white",t.fillRect(o,r,a,i),3===e.checkStatus?(t.beginPath(),t.fillStyle="black",t.rect(o+a/5,r+i/5,a-.4*a,i-.4*i),t.fill()):!0!==e.checkStatus&&1!==e.checkStatus||(t.beginPath(),t.lineWidth=a/5,t.moveTo(o+a/6,r+i/2),t.lineTo(o+2*a/5,r+5/7*i),t.lineTo(o+5/6*a,r+i/6),t.stroke()),t.restore())}(s,e.checkBox,n),e.images&&x(s,e.images.image,e.images,n,r.imageLoader),s.restore(),e.cellContent&&(n.x+=e.cellContent.left,n.width-=e.cellContent.left)))},getCellPaddingRect:function(t){var e,n=t.options.rect,o=t.options.context.sheet,r=t.options.context,i=r.row;T(o,r.col)&&n.width>0&&n.height>0&&((e=o.outlineColumn.Kia.QR[i])&&e.cellContent&&(n.x+=e.cellContent.left,n.width-=e.cellContent.left))},getCellPaddingHitInfo:function(t){var e,n,o,r,i=t.context.sheet,a=t.context.col,s=t.context.row,l=t.x,u=t.y,c=t.cellRect,f=i.outlineColumn;if(t.paddingHitInfo=null,f&&f.YQa){for(e=f.Kia.QR[s],n=f.YQa.columnIndex,c=c.clone();a>n;)a--,c.x-=i.getColumnWidth(a);e&&a===n&&(o=void 0,r=void 0,e.indicator&&(o=e.indicator.x,l>=(r=e.indicator.x+c.x)&&l<r+e.indicator.width&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{indicator:!0}})),e.checkBox&&(o||(o=e.checkBox.x),l>=(r=e.checkBox.x+c.x)&&l<r+e.checkBox.width&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{checkBox:!0}})),e.images&&(o||(o=e.images.x),l>=(r=e.images.x+c.x)&&l<r+e.images.width&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{image:!0}})),o&&l>=c.x&&l<c.x+o&&(t.paddingHitInfo={x:l,y:u,row:s,col:a,outlineColumnHitInfo:{blank:!0}}))}},processMouseDownOnCellPadding:function(t){var e=t.sheet,n=t.row,o=t.col,r=t.outlineColumnHitInfo;h(r)||(r.indicator?A(e,n):r.checkBox?I(e,n,o):r.image||r.blank)},getOutlineColumnOffset:function(t){var e,n=t.context.sheet;T(n,t.context.col)&&(R(e=n.outlineColumn.options(),"showIndicator")&&(t.value+=3,function(t){return!(!t.expandIndicator&&!t.collapseIndicator)}(e)?t.value+=16:t.value+=5,t.value+=3),R(e,"showCheckBox")&&(t.value+=3,t.value+=12,t.value+=3),R(e,"showImage")&&(t.value+=3,t.value+=16,t.value+=3))}},o.CellTypes.Base.$n("outlineColumn",b),w={init:function(){i.commands.$Qa(this.commandManager())}},o.Workbook.$n("outlineColumn",w)},"./dist/plugins/search/search.entry.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/search/search.js");e.SearchResult=o.SearchResult,e.SearchCondition=o.SearchCondition,e.SearchFlags=o.SearchFlags,e.SearchOrder=o.SearchOrder,e.SearchFoundFlags=o.SearchFoundFlags},"./dist/plugins/search/search.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h;function p(t,e,n){if(!t)return!1;if(t=""+t,e=""+e,0===n)return t.indexOf(e)>-1;var o=(2&n)>0,r=(1&n)>0;return(4&n)>0?(e=(o?s.zb(e,!1,!0):s.ub(e))||e,(r?s.sb(e):s.qb(e)).test(t)):(r&&(e=e.toLowerCase(),t=t.toLowerCase()),o?e===t:t.indexOf(e)>=0)}function d(t,e,n,o,r,i,a,s){var u=l,c=t+1,f=e+1;return 0===n?f>=0&&f<=s?u={r:t,c:f}:c>=0&&c<=i&&(u={r:c,c:o?a:0}):c<=i?u={r:c,c:e}:f<=s&&(u={r:o?r:0,c:f}),u}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("@grapecity/js-calc"),a=!!i,s=r.Common.q,l=null,u=Math.max,c="string",o.Worksheet.prototype.search=function(t){var e,n,o,r,i,s,f,g,m,y,v,C,b,w,T,x,S,A,I,R;if(!t)return l;if(e=this,n=t.sheetArea,o=t.searchString,r=t.searchTarget,i=t.searchFlags,s=e.getRowCount(n),f=e.getColumnCount(n),g=new h,!o||0===r||s<=0&&f<=0)return g;for(m=u(0,t.rowStart),y=u(0,t.columnStart),b=(8&i)>0,((v=t.rowEnd)<0||!b)&&(v=s-1),((C=t.columnEnd)<0||!b)&&(C=f-1),x=(w=t.findBeginRow)<0?m:w,S=(T=t.findBeginColumn)<0?y:T;x>=0&&S>=0;){if(A=e.getCell(x,S,n),I=void 0,(1&r)>0&&(""!==(I=t.callback?t.callback(A,e):A.text())&&p(I,o,i)&&(g.searchFoundFlag|=1,g.foundString=I)),a&&(8&r)>0&&(typeof(I=A.formula())===c&&""!==I&&p(I,o,i)&&(g.searchFoundFlag|=8,g.foundString=I)),(4&r)>0&&(typeof(I=A.tag())===c&&""!==I&&p(I,o,i)&&(g.searchFoundFlag|=4,g.foundString=I)),0!==g.searchFoundFlag)return g.foundRowIndex=x,g.foundColumnIndex=S,g;if(!(R=d(x,S,t.searchOrder,b,m,v,y,C)))break;x=R.r,S=R.c}return g},o.Workbook.prototype.search=function(t){var e,n,o,r,i,a;if(!t)return l;if(this,0,e=this.getSheetCount(),n=new h,!t.searchString||0===t.searchTarget||e<=0)return n;if(-1===t.startSheetIndex&&(t.startSheetIndex=0),-1===t.endSheetIndex&&(t.endSheetIndex=e-1),i=t.startSheetIndex,(a=t.endSheetIndex)>=i&&0<=i&&i<e&&0<=a&&a<e)for(o=i;o<=a;o++)if((r=this.getSheet(o).search(t))&&0!==r.searchFoundFlag)return r.foundSheetIndex=o,r;return n},f=function(){this.startSheetIndex=-1,this.endSheetIndex=-1,this.searchString=l,this.searchFlags=0,this.searchOrder=0,this.searchTarget=1,this.sheetArea=3,this.rowStart=-1,this.columnStart=-1,this.rowEnd=-1,this.columnEnd=-1,this.findBeginRow=-1,this.findBeginColumn=-1},e.SearchCondition=f,h=function(){this.foundColumnIndex=-1,this.foundRowIndex=-1,this.searchFoundFlag=0,this.foundSheetIndex=-1,this.foundString=l},e.SearchResult=h,function(t){t[t.none=0]="none",t[t.ignoreCase=1]="ignoreCase",t[t.exactMatch=2]="exactMatch",t[t.useWildCards=4]="useWildCards",t[t.blockRange=8]="blockRange"}(e.SearchFlags||(e.SearchFlags={})),function(t){t[t.zOrder=0]="zOrder",t[t.nOrder=1]="nOrder"}(e.SearchOrder||(e.SearchOrder={})),function(t){t[t.none=0]="none",t[t.cellText=1]="cellText",t[t.cellTag=4]="cellTag",t[t.cellFormula=8]="cellFormula"}(e.SearchFoundFlags||(e.SearchFoundFlags={}))},"./dist/plugins/sheetsCalc/calc-spreadjs.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function D(t,e,n,o,r){var i=e.getSpan(n,o,r),a=p;return i.row===n&&i.col===o&&(a=t.getValue(n,o,r)),a}function O(t){return t.indexOf("LET(")>-1&&"LET"}function j(t,e,n,r,i,a){var l,u=t&&t instanceof o.Worksheet&&t,c=new s.Parser;return n=n===d?0:n,r=r===d?0:r,l=new k(u,!!i,s.pf(n,r)),a&&(l.culture=!0),c.parse(l,e)}function F(t,e,n,o,r){var i,a,l=t.Cf();return n===d&&(n=t.getActiveRowIndex()),o===d&&(o=t.getActiveColumnIndex()),i=!0,r&&r.convertNullToZero!==d&&(i=r.convertNullToZero),a=t.yj(),l.Hg(a,e,s.pf(n,o),!1,i)}function P(t,e,n,o,r){var i,u,c,f=t.row,h=t.col,d=t.row+t.rowCount-1,g=t.col+t.colCount-1,m=!1,y=!1,v=!1,C=!1;return arguments.length>=4&&(f-=(m=0!=(1&o))?e:0,d-=(y=0!=(4&o))?e:0,h-=(v=0!=(2&o))?n:0,g-=(C=0!=(8&o))?n:0),r&&(u=_(t,r,e),c=L(t,r,e),u&&c)?i=a.StructureReferenceResolver.create(r,u,c,t.col-r.dataRange().col,t.col+t.colCount-r.dataRange().col-1):(1===t.rowCount&&1===t.colCount?i=s.rf(p,p,f,h,m,v):(t.row<0&&(f=d=l.BAND_INDEX_CONST),t.col<0&&(h=g=l.BAND_INDEX_CONST),i=s.uf(p,p,f,h,d,g,m,v,y,C,e,n)),i)}function _(t,e,n){if(1===t.rowCount){if(e.hasHeadersRow()&&t.row===e.startRow())return 2;if(e.hasTotalsRow()&&t.row===e.endRow())return 8;if(n===t.row)return 1}else{if(e.hasHeadersRow()&&t.row===e.startRow()){if(t.rowCount===e.dataRange().rowCount+1)return 6;if(e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1+1)return 14}if(t.row===e.dataRange().row){if(t.rowCount===e.dataRange().rowCount)return 3;if(e.hasTotalsRow()&&t.rowCount===e.dataRange().rowCount+1)return 12}}return d}function L(t,e,n){return t.col===e.startColumn()&&t.colCount===e.dataRange().colCount?1:1===t.colCount?2:t.col>=e.startColumn()&&t.col+t.colCount-1<=e.endColumn()?4:d}function B(t,e,n,r){var i,a,s,l,u,c,f,h;if(!e)return null;if(n=n||0,r=r||0,i=t.Cf().parse(t.yj(),e,n,r,!0,!0))if((a=i.source)&&13===i.type);else if(1===i.type&&i.endSource){for(s=i.source,l=i.endSource,u=s.getSources(l),c=!1,f=0;f<u.length;f++)if(u[f]===t.yj()){c=!0;break}i=c&&i}return!i||!i.getRange||a&&a!==t.yj()?null:(h=i.getRange(n,r))?new o.Range(h.row,h.col,h.rowCount,h.colCount):null}function G(t,e,n,o,r,i){var a,s,l,u="";for(a=0;a<n.length;a++)s=P(n[a],o,r,i),l=t.unparse(e,s),u+=a>0?", "+l:l;return u}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=n("Common"),a=n("./dist/plugins/sheetsCalc/parser-sheets.js"),s=n("@grapecity/js-calc"),l=n("./dist/plugins/sheetsCalc/calc.ns.js"),u=i.Common.j,c=i.Common.u,f=u.Ia,h=u.za,p=null,d=void 0,g=["v","n","s","b","d","sn"],m=s.Errors.Value,s.Errors.Calc,y=i.Formatter&&i.Formatter.GeneralFormatter,v=s.Convert.vf,s.Convert.Fh,s.Convert.Ca,s.Errors.Reference,s.Errors.NotAvailable,s.Errors.Name,i.Common.A,i.Common.B,C=u.Fa,b=function(t){return s.Convert.Na(t,!0)},w=o.Range.prototype.contains,T=c.Nb,x="number",(S=s.CalcSource.prototype).referenceToArray=function(t,e,n,o,r,i,a,l){var u,c,f,h,g,y,v,C,b,w,T,x,S=this,A=1,I=1,R=[],k=t.getRangeCount();if(0===k)return R.isError=!0,R;for(v=S.getRowCount(),C=S.getColumnCount(),n=n===d||n,b=0;b<k;b++){if(n||(y=[],R.push(y)),0===(A=t.getRowCount(b)))return R.isError=!0,R;if(0===(I=t.getColumnCount(b)))return R.isError=!0,R;if(f=t.getRow(b),h=t.getColumn(b),f>=v||h>=C)return(R=[p]).rowCount=1,R.colCount=1,R.rangeCount=1,R;for(f+A>v&&(A=v-f),h+I>C&&(I=C-h),w=void 0,T=0;T<A;T++)for(u=f+T,n||(w=[],y.push(w)),x=0;x<I;x++){if(c=h+x,g=S.getValue(u,c),o&&s.Convert.vf(g))return(R=[g]).isError=!0,R;if(g=s.Convert.wf(g,e,!s.ExcelCompatibleCalcMode,i,l),r&&g===s.Convert.CalcConvertedError)return(R=[m]).isConvertError=!0,R;g===p&&i||(n?R.push(g):w.push(g))}}return n||1!==k||(R=R[0]),R.rowCount=A,R.colCount=I,R.rangeCount=k,R},S.getSheetReference=function(){var t=this;return t.Df=t.Df||new s.CalcReference(t),t.Df},function(t){t[t.a1=0]="a1",t[t.r1c1=1]="r1c1"}(A=e.ReferenceStyle||(e.ReferenceStyle={})),r.ReferenceStyle=A,I=function(){function t(t,e,n,o,r){var i=this;i.Cj=t,i.Uu=n,i.Vu=o,i.Lf=e,C(r)||(i.kT=r)}return t.prototype.getName=function(){return this.Cj},t.prototype.getRow=function(){return this.Uu},t.prototype.getColumn=function(){return this.Vu},t.prototype.getExpression=function(){return this.Lf},t.prototype.getComment=function(){return this.kT},t.prototype.fg=function(t,e){e&&e.push({type:"customName",nameInfo:this,expr:this.Lf}),this.Lf=t},t}(),e.NameInfo=I,r.NameInfo=I,s.CalcSource.prototype.createSourceModel=function(t){return new s.CalcSourceModel(t,this)},R=function(t){function e(e){var n=t.call(this,p)||this;return n.references=e,n}return E(e,t),e.prototype.toArray=function(t,e,n,o,r){var i,a,s=this.references,l=[];for(i=0;i<s.length;i++){if((a=s[i].xf.referenceToArray(s[i],t,e,n,o,r)).isError&&n)return a;e?Array.prototype.push.apply(l,a):l.push(a[0]),i||(l.rowCount=a.rowCount,l.colCount=a.colCount)}return l.rangeCount=s.length,l},e}(s.CalcReference),e.SheetRangeReference=R,k=function(t){function e(e,n,r,i){var s,l,u,c=t.call(this,e&&e.yj(),n,r,i)||this;for(e||(e=new o.Worksheet),c.kj=e,c.row=r&&r.row||0,c.column=r&&r.col||0,l=(s=e.getCalcService()).getResolvers(),u=0;u<l.length;u++)if(l[u]instanceof a.SheetReferenceResolver)return c;return s.addResolver(new a.SheetReferenceResolver(e)),s.addResolver(new a.StructureReferenceResolver(e)),c}return E(e,t),e.prototype.getExternalSource=function(t,e){var n,o,r,i=this,a=i.kj.parent;if(t&&(!a||a.name!==t))return p;if(!a)return c.Mb(i.kj.name(),e)?i.kj.yj():p;if((n=a.sheets)&&n.length>0)for(o=0;o<n.length;o++)if(r=n[o],c.Mb(r.name(),e))return r.yj();return s.ParserContext.prototype.getExternalSource.call(this,t,e)},e.prototype.getExternalSourceToken=function(t){return t.getName()},e.prototype.getTableByName=function(t){var e,n,o=this.kj.tables,r=o?o.findByName(t):p;if(!r&&(e=this.kj.parent&&this.kj.parent.sheets))for(n=0;n<e.length&&(!(o=e[n].tables)||!(r=o.findByName(t)));n++);return r},e.prototype.getTableByIndex=function(t,e){var n=this.kj.tables;return n?n.find(t,e):p},e.prototype.setSource=function(t){this.source=t;var e=t;e&&e.getSheet&&(this.kj=e.getSheet())},e.prototype.no=function(){this.kj&&this.kj.no()},e}(s.ParserContext),e.SheetParserContext=k,new i.Common.ResourceManager(o.SR),M=function(t){function e(n,o){var r=t.call(this,p)||this;return r.getCalcSourceModel=function(){return this.Bf},r.createSourceModel=function(t){return new s.CalcSourceModel(t,this)},r.getRangeKey=function(t,e){return t.id+","+e.row+","+e.col+","+e.rowCount+","+e.colCount},r.getSheetRangeReference=function(t){var n,o,r,i,a,s=this.kj,l=s&&s.parent;if(t.endSource&&l&&l.sheets&&t.endSource instanceof e){for(n=l.sheets,o=!1,r=void 0,i=[],a=0;a<n.length;a++){if((r=n[a].yj())===this)o=!0;else if(r===t.endSource){i.push(r.getReference(t));break}o&&i.push(r.getReference(t))}return new R(i)}},r.kj=n,r.Wz=o||3,r}return E(e,t),e.prototype.startCalculation=function(){this.Hu||this.xLb()},e.prototype.endCalculation=function(){this.Hu=p,this.zIc(),this.Iu=p;var t=this.Bf.ug(!1);t&&t.clearListenersCache(),this.Af.calcOnDemand&&this.kj.repaint()},e.prototype.zIc=function(){var t,e=this.Iu;e&&e.length>0&&(t=this.kj).Wq(o.Events.RangeChanged,{isUndo:!1,sheet:t,sheetName:t.name(),row:0,col:0,rowCount:t.getRowCount(),colCount:t.getColumnCount(),changedCells:e,action:6},t.vxb)},e.prototype.clearValueCache=function(){this.xLb()},e.prototype.xLb=function(){var t=this.getRowCount(),e=this.getColumnCount();this.Hu={rowCount:t,colCount:e,arrayInfo:[]},this.Iu=[]},e.prototype.OHb=function(){this.Hu=p,this.Iu=p},e.prototype.getValue=function(t,e){var n,r,i,a,l,u,c,f,h,y,v,C,b,w=[];for(n=2;n<arguments.length;n++)w[n-2]=arguments[n];if(i=(r=this).kj,typeof t===x)a=arguments[0],l=arguments[1],e=arguments[2];else if((t=t).row!==d)a=t.row,l=t.col;else if(t.name)return null;return u=r.Wz,e=e||0,a<0||l<0?m:i.Ju&&i.Ku===a&&i.Lu===l?i.Mu:(c=r.Hu,f=g[e],c?(h=c.rowCount,y=c.colCount,v=void 0,C=void 0,b=void 0,a>=h||l>=y?p:((v=c[a])||(v=c[a]={}),(C=v[l])||(C=v[l]={v:i.getValue(a,l,u)}),(b=C[f])===d&&(b=s.Convert.wf(C.v,e,!s.ExcelCompatibleCalcMode),C[f]=b),b=o.Ul.w0a(b))):a>=r.getRowCount()||l>=r.getColumnCount()?p:r.kj.getValue(a,l,u))},e.prototype.getIdentity=function(t,e){var n=this,o=e.row,r=e.rowCount||1,i=e.column,a=e.columnCount||1;return-1===o&&(o=0,r=n.getRowCount()),-1===i&&(i=0,a=n.getColumnCount()),n.getName()+"."+o+"."+r+"."+i+"."+a},e.prototype.getReference=function(t){var e,n,o,r,i,a,l=this,u=t.row,c=t.col;if(-1===u&&(t.row=0,t.rowCount=l.getRowCount()),-1===c&&(t.col=0,t.colCount=l.getColumnCount()),e=!1,t.spillRef)if(n=l.yLb().getAnchorCell(u,c))t.rowCount=n.rowCount,t.colCount=n.colCount,e=!n.isValid;else{if(r=(o=l.getCalcSourceModel()).Qf(u,c))return r.row===u&&r.col===c?(t.rowCount=r.rowCount,t.colCount=r.colCount,new s.CalcReference(l,[t])):void 0;if(!(i=o.Kf(u,c))||33!==i.type)return i&&("@"===i.functionName||i instanceof s.ReferenceExpression)?(t.rowCount=1,t.colCount=1,new s.CalcReference(l,[t])):void 0;e=!0,t.rowCount=1,t.colCount=1}return a=new s.CalcReference(l,[t]),e&&(a.isSpillError=!0),a},e.prototype.getSources=function(t){var n,o,r,i,a;if(this.kj&&this.kj.parent&&this.kj.parent.sheets&&t instanceof e){for(n=this.kj.parent.sheets,o=!1,r=void 0,i=[],a=0;a<n.length;a++){if((r=n[a].yj())===this&&(o=!0),r===t){i.push(r);break}o&&i.push(r)}return i}},e.prototype.Ppb=function(t,e){var n,o=this.Hu,r=o&&o.arrayInfo;r&&(n=!1,r.forEach((function(i,a){if(i){var s=i.reference,l=i.key;w.call(s.yf[0],t,e)&&(delete o[l],r[a]=d,n=!0)}})),n&&(o.arrayInfo=[],r.forEach((function(t){t&&o.arrayInfo.push(t)}))))},e.prototype.referenceToArray=function(t,e,n,o,r,i,a,l){var c,f,v,C,b,w,T,x,S,A,I,R,k,M,N,E,O,j=this,F=1,P=1,_=[],L=j.kj,B=j.Hu,G=g[e],H=L.ITa,V=t.getRangeCount();if(0===V)return _.isError=!0,_;if(B&&(b=B[x=t.getRangeCount()+"_"+t.getRow(0)+"_"+t.getColumn(0)+"_"+t.getRowCount(0)+"_"+t.getColumnCount(0)+"_"+e+"_"+n]))return j.zLb(b);for(S=this.getRowCount(),A=this.getColumnCount(),n=n===d||n,I=0;I<V;I++){if(n||(w=[],_.push(w)),0===(F=t.getRowCount(I)))return _.isError=!0,j.zLb(_);if(0===(P=t.getColumnCount(I)))return _.isError=!0,j.zLb(_);if(v=t.getRow(I),C=t.getColumn(I),v>=S||C>=A)return(_=n?[p]:[[p]]).rowCount=1,_.colCount=1,_.rangeCount=1,j.zLb(_);for(v+F>S&&(F=S-v),C+P>A&&(P=A-C),R=void 0,k=void 0,M=L.Ju,N=0;N<F;N++)for(c=v+N,n||(R=[],w.push(R)),B&&(B[c]||(B[c]={}),T=B[c]),E=0;E<P;E++){if(f=C+E,M&&L.Ku===c&&L.Lu===f)b=L.Mu,M=!1;else{if(B?(k=T[f])?b=k.v:(b=D(L,H,c,f,j.Wz),k=T[f]={v:b}):b=D(L,H,c,f,j.Wz),a&&(void 0,"@"===((O=L.getFormatter())instanceof y?O.formatString():O)?b=L.getText(c,f):b instanceof Date&&(b=u.Pa(b)),h(k)||(k=T[f]={v:b})),o&&s.Convert.vf(b))return(_=[b]).isError=!0,j.zLb(_);if(k&&k[G]!==d)b=k[G];else if(b=s.Convert.wf(b,e,!s.ExcelCompatibleCalcMode,i,l),k&&(k[G]=b),r&&k===b)return(_=[m]).isConvertError=!0,j.zLb(_)}s.Convert.j$a(b,i)||(n?_.push(b):R.push(b))}}return n||1!==V||(_=_[0]),_.rowCount=F,_.colCount=P,_.rangeCount=V,B&&!isNaN(V)&&!isNaN(F)&&!isNaN(P)&&V*F*P<2500&&B.arrayInfo.length<50&&(B[x]=_,B[x].rowCount=F,B[x].colCount=P,B[x].rangeCount=V,B.arrayInfo.push({reference:t,key:x})),j.zLb(_)},e.prototype.zLb=function(t){var e=[];return(e=e.concat(t)).rowCount=t.rowCount,e.colCount=t.colCount,e.rangeCount=t.rangeCount,e.isError=t.isError,e.isArray=t.isArray,e.isReference=t.isReference,e.isConvertError=t.isConvertError,e},e.prototype.getColumnCount=function(){var t=this.kj;return t.Js?0:t.getColumnCount(this.Wz)},e.prototype.getRowCount=function(){var t=this.kj;return t.Js?0:t.getRowCount(this.Wz)},e.prototype.isHiddenRow=function(t,e){var n=this.kj;return!(!(n.Nu&&n.Nu())&&e)&&0===n.getRowHeight(t)},e.prototype.getName=function(){var t=this.Wz;return t===o.SheetArea.colHeader?this.kj.name()+"CH":t===o.SheetArea.rowHeader?this.kj.name()+"RH":this.kj.name()},e.prototype.yLb=function(){var t=this,e=t.ZHb;return e||(e=t.ZHb=t.kj.ITa.ZHb),e},e.prototype.setArray=function(t,e,n,o,r){return this.yLb().setArray(this,t,e,n,o,r)},e.prototype.updateItem=function(t,e,n){return this.yLb().updateItem(this,t,e,n)},e.prototype.GIb=function(t,e){this.yLb().GIb(t,e)},e.prototype.HIb=function(){this.yLb().HIb()},e.prototype.setValue=function(t){var e,n,r,i,a,s,l,u,c,h,p,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N=[];for(e=1;e<arguments.length;e++)N[e-1]=arguments[e];if(r=(n=this).kj,s=n.Wz,(t=t).row!==d)i=t.row,a=t.col,l=1;else{if(t.name)return;i=arguments[0],a=arguments[1],l=2}u=arguments[l],c=arguments[l+1],(h=n.Hu)&&((p=h[i])&&((g=p[a])&&(g.v=u,g.b!==d&&(g.b=d),g.d!==d&&(g.d=d),g.n!==d&&(g.n=d),g.s!==d&&(g.s=d),g.sn=d))),m=o.Ul.x0a(u),y=r.ITa,v=!1,b=(C=r.tables)&&C.find(i,a),3===s&&b&&(w=b.showHeader()&&i===b.headerIndex(),T=b.showFooter()&&i===b.footerIndex(),w||T||(v=b.yq(i,a,m))),x=r.wq,3===s&&!v&&x&&x.Ou&&((S=x.getValue(i,a)).hasBinding&&(A=void 0,h?(A=(I=h.bindingRows=h.bindingRows||{})[i])||(A=I[i]=f({},r.getDataItem(i))):A=f({},r.getDataItem(i)),y.Cp(i,a,{Dp:A,Ep:S.value}),x.setValue(i,a,m,y.zTa)),v=S.hasBinding),v||(R="hyperlink",k="__proto__","string"==typeof m&&m[R]&&(M={url:m[R]},y.setHyperlink&&y.do("setHyperlink",i,a,M),delete m[k].hyperlink),y.do("setValue",i,a,m,s,!0,!0,arguments[l+2])),this.Iu?this.Iu.push({row:i,col:a}):this.kj.Wq(o.Events.CellChanged,{sheet:this.kj,sheetName:this.kj.name(),row:i,col:a,sheetArea:s,propertyName:"value",oldValue:c,newValue:u})},e.prototype.getCustomFunction=function(t){return this.kj?this.kj.Pu(t):p},e.prototype.getCustomName=function(t){t=T(t);var e=this.kj?this.kj.getCustomName(t):p;return e?e.getExpression():p},e.prototype.getSheet=function(){return this.kj},e.prototype.setFormula=function(t,e,n){},e.prototype.setArrayFormula=function(t,e,n,o,r){},e.prototype.setFormulaByName=function(t,e){},e.prototype.refresh=function(){this.kj.repaint()},e.prototype.toJSON=function(t,e,n,o,r){var i,a,s,l,u,c,f,p,d,g,m,y,v,b,w,T=e,x=t.data||{},S=!0,A=this.Cf();for(c=0;c<=n;c++)if(i=x.dataTable||{},a=T[c]){for(S=!(l=i[c]),l=l||{},f=0;f<=o;f++)if((s=a[f])&&s.Lf){u=l[f]||{};try{d=O(p=A.unparse(this,s.Lf,c,f,!1,!0)),g=void 0,d&&(C(u.prefix)&&(u.prefix={}),g=A.unparse(this,s.Nf,c,f,!1,!0)),!s.Pf&&p&&0===p.indexOf("@")&&B(this.kj,p.slice(1,p.length),0,0)&&(p=p.slice(1,p.length),d&&(g=g.slice(1,g.length))),s.Pf?s.Pf.row===c&&s.Pf.col===f&&(u.arrayInfo=s.Pf,u.formula=p,d&&(u.prefix[d]=g)):(u.formula=p,d&&(u.prefix[d]=g)),S=!1,l[f]=u}catch(t){}}if(S){if(i!==x.dataTable)continue}else i[c]=l;x.dataTable=i}if(r){for(m=x.columnDataArray||[],y=0;y<r.length;y++)(v=r[y])&&v.Lf&&(b=this.Cf().unparse(this,v.Lf,0,y,!1,!0),(w=m[y]||{}).formula=b,m[y]=w);m.length>0&&(x.columnDataArray=m)}h(x)||(t.data=x)},e}(s.CalcSource),e.SheetSource=M,M.prototype.getParserContext=function(t,e,n){return e=e||s.pf(0,0),new k(this.kj,t,e,n)},N=function(t){function e(e){var n=t.call(this,p)||this;return n.createSourceModel=function(t){return new s.CalcSourceModel(t,this)},n.Qu=e,n}return E(e,t),e.prototype.getCustomFunction=function(t){return this.Qu?this.Qu.getCustomFunction(t):p},e.prototype.getCustomName=function(t){var e=this.Qu?this.Qu.getCustomName(t)||this.Qu.aJb(t):p;return e?e.getExpression():p},e}(s.CalcSource),e.SpreadSource=N,e.formulaToExpression=j,e.expressionToFormula=function(t,e,n,r,i,a){var l,u=t&&t instanceof o.Worksheet&&t,c=new s.Parser;return n=n===d?0:n,r=r===d?0:r,(l=new k(u,!!i,s.pf(n,r))).YSa=a,c.unparse(l,e)},e.evaluateFormula=function(t,e,n,o,r){return n===d&&(n=0),o===d&&(o=0),F(t,j(t,e,n,o,r,!0),n,o)},e.evaluateExpression=F,e.rangeToExpression=P,e.rangeToFormula=function(t,e,n,o,r){var i=P(t,e,n,o),a=new k(p,!!r,s.pf(e,n)),l=(new s.Parser).unparse(a,i);return a.no(),l},e.rangeToFormulaWithStructReference=function(t,e,n,o,r,i,a){var l=P(e,n,o,r,a),u=new k(t,!!i,s.pf(n,o));return(new s.Parser).unparse(u,l)},e.formulaToRange=B,e.formulaToRanges=function(t,e,n,r,i){var l,u,c,f,p,g,m,y,v,C,b=[],w=[];if(!e)return b;for(l={},n=n||0,r=r||0,u=new s.Parser,c=a.qzb(u,e,t,n,r,d,i),f=0;f<c.length;f++)if((p=c[f].sheetRanges)&&!h(p))for(g=0;g<p.sheets.length;g++)for((w=l[m=p.sheets[g]])||(l[m]=w=[],b.push({sheetName:m,ranges:w})),y=p[m],v=0;v<y.length;v++)C=y[v],w.push(new o.Range(C.row,C.col,C.rowCount,C.colCount));return b},e.rangesToFormula=function(t,e,n,o,r){var i=new s.Parser,a=new k(p,!!r,s.pf(e,n)),l=G(i,a,t,e,n,o);return a.no(),l},e.ALb=G,e.RangeReferenceRelative={allAbsolute:0,startRowRelative:1,startColRelative:2,endRowRelative:4,endColRelative:8,rowRelative:5,colRelative:10,allRelative:15},e.goalSeek=function(t,e,n,o,r,a,s){var l,u,c,f,h=o.getValue(e,n),p=!1,d=.01,g=(b(h)?+h:0)-s,m=o.getValue(r,a),y=(b(m)?+m:0)-s;if(b(m)&&Math.abs(y)<.001)p=!0;else if(v(m))p=!1;else for(l=g+(0===g?d:d*g),c=0;!p&&c<100;c++)l=i.Common.o.Lma(l,13),t.setValue(e,n,l),m=o.getValue(r,a),u=(b(m)?+m:0)-s,b(m)&&Math.abs(u)<.001?p=!0:v(m)?l=(g+l)/2:g-l==0?l=g+(0===g?d:d*g):y-u==0?l=g+2*(l-g):(f=l-u*(g-l)/(y-u),g=l,y=u,l=f);return p||t.setValue(e,n,h),p}},"./dist/plugins/sheetsCalc/calc.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.BAND_INDEX_CONST=-2147483648,e.MAX_ROW_COUNT=1048576,e.MAX_COLUMN_COUNT=16384},"./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function C(t,e){var n,o,r,i;return e||(e=this),n=f(t.row,e.row),o=f(t.column,e.column),r=c(t.row+t.rowCount,e.row+e.rowCount),i=c(t.column+t.columnCount,e.column+e.columnCount),n>=r||o>=i?p:{row:n,column:o,rowCount:r-n,columnCount:i-o,intersectWith:C}}function b(t,e,n,o){return(!o||t<e)&&n}function w(t){return[t.row,t.col,t.rowCount,t.colCount].join(",")}function T(t,e,n,o){var r=t[e];r||(r=t[e]={}),r[n]=o}function x(t,e,n){var o=t[e];return!!o&&o[n]}function S(t,e,n,o,r,i,a,s,l,u,c,f){var h,p,d,g;return n>=0||!r?(h=o+(r?n:0),p=i+(a?n:0),d=c&&F(s,t,c),g=!c&&F(s,t,c),(d||g)&&(!f&&l+u<=n||f&&l<=n)&&(h-=r?u:0,p-=a?u:0),d=c&&F(s,e,c),g=!c&&F(s,e,c),(d||g)&&(!f&&l<=h||f&&(r&&n+o>=l||!r&&o>=l)?(h+=u,p+=u):(!f&&l<=p||f&&(a&&n+i>=l||!a&&i>=l))&&(p+=u)),h-=r?n:0,p-=a?n:0,f&&l+u<=n&&(h+=r?u:0,p+=a?u:0),{index:h,endIndex:p}):{index:o,endIndex:i}}function A(t,e,n,r,i,a,s,l,u,c,f,h){if(e&&!h){var p=u?i.row:i.column,g=u?i.rowRelative:i.columnRelative,m=void 0;if(u&&n>=0||!u&&r>=0||!g){if(c)m=S(t,e,u?n:r,p,g,-1,!1,a,s,l,u,f).index;else if(m=j(t,e,u?n:r,p,g,a,s,l,u,f),d(m))return o.Hh(m);m!==p&&(i=i.offset(u?m-p:0,u?0:m-p,!0))}}return i}function I(t,e,n,r,i,a,s,l,u,c,f,h){var p,g,m,y,v,C,b,w;if(e&&!h){if(3===(p=i.tf())||u&&2===p||!u&&1===p)return i;if(g=u?i.rowRelative:i.columnRelative,m=u?i.endRowRelative:i.endColumnRelative,y=u?i.row:i.column,v=u?i.endRow:i.endColumn,C=void 0,u&&n>=0||!u&&r>=0||!g||!m){if(c)C=S(t,e,u?n:r,y,g,v,m,a,s,l,u,f);else if(C=P(t,e,u?n:r,y,g,v,m,a,s,l,u,f),d(C))return o.Hh(C);b=C.index,w=C.endIndex,b===y&&w===v||(i=i.offset2(u?b-y:0,u?0:b-y,u?w-v:0,u?0:w-v,n,r))}}return i}function R(t,e,n,r,i,a,s,l,u,c,f,d){var g,m,y,v,C,b,w,T,x=R,S=r;if(r){if(1===r.type&&r.sf()||33===r.type)S=A(t,r.source||t,e,n,r,i,a,s,l,u,f,d);else if(1===r.type)S=I(t,r.source||t,e,n,r,i,a,s,l,u,f,d);else if(10===r.type)(g=x(t,e,n,r.value,i,a,s,l,u,h,f,d))!==r.value&&(S=o.Lh(g));else if(9===r.type)m=x(t,e,n,r.value,i,a,s,l,u,h,f,d),y=r.value2&&x(t,e,n,r.value2,i,a,s,l,u,h,f,d),m===r.value&&y===r.value2||(S=o.Kh(r.operatorType,m,y));else if(7===r.type){for(v=p,C=void 0,b=void 0,T=(w=r).arguments.length,b=0;b<T;b++)if((g=x(t,e,n,C=w.arguments[b],i,a,s,l,u,h,f,d))!==C){(v=[])[b]=g;break}if(v){for(b=0;b<T;b++)C=w.arguments[b],v[b]!==h&&v[b]!==p||(v[b]=x(t,e,n,C,i,a,s,l,u,h,f,d));S=o.Jh(w,v)}}else f||l||13!==r.type||(S=function(t,e,n,o,r,i,a,s,l){if(e){if(r)return r.offsetWhenInsertRemoveColumn(a,s,l)}return r}(0,t,0,0,r,0,a,s,u));return S}}function k(t,e,n,o,r,i,a,s,l,u){var c=t.getSheet(),f=c.uja&&(c.parent||c).tja(),h=c.ITa&&c.ITa.dUa();M(f,(function(r,i,a,s){return e.call(this,r,a,s,i,t,n,o,l,u)}),l,h)}function M(t,e,n,o){var r,i,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x;if(t)for(u=0;u<t.length;u++){for(c=!0,f=!0,h=a.maxRowCount-1,p=a.maxColumnCount-1,g=0,m=(d=(r=t[u].validator).n5).length;g<m&&(v=(y=d[g]).rowCount,C=y.colCount,s=y.row,l=y.col,-1!==v&&(f=!1,h=h>s?s:h),-1!==C&&(c=!1,p=p>l?l:p),c||f);g++);if(!(n&&f||!n&&c)&&(b=t[u].sheet.yj(),(w=(i=r.condition()).getExpressions())&&w.length>0)){for(T=0;T<w.length;T++)x=w[T],w[T]=e(b,x,h,p);i.setExpressions(w,o)}}}function N(t){var e=[],n=t.parent;return(n&&n.sheets||[t]).forEach((function(t){var n=t.conditionalFormats,o=n&&n.getRules();o&&o.length&&o.forEach((function(n){n.xyb&&e.push({rule:n,sheet:t})}))})),e}function E(t,e,n,o,r,i){var a=t.getSheet();D(N(a),(function(a,s,l,u){return e.call(this,a,l,u,s,t,n,o,r,i)}),a.ITa&&a.ITa.dUa(),r,i)}function D(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O;if(t)for(i=0,a=t.length;i<a;i++){if(l=(s=t[i].rule).ranges(),c=(u=m(l)).r,f=u.c,p=(h=t[i].sheet).yj(),d=s.condition(),(g=h.tables)&&l&&1===l.length&&(v=(y=l[0]).row,C=y.col,b=y.rowCount,w=y.colCount,T=void 0,r&&o?T=g.KFc(v,C,b,w):h.dJb&&h.zFc&&(T=[h.zFc]),T&&T.length)){for(x=!1,S=0,A=T.length;S<A;S++)if(R=(I=T[S]).row,k=I.col,M=I.rowCount,N=I.colCount,v===R&&b===M&&C>=k&&C+w<=k+N){x=!0;break}if(x)continue}if(d||(s.initCondition(),d=s.condition()),(E=d&&d.getExpressions())&&E.length>0){for(D=0;D<E.length;D++)O=E[D],E[D]=e(p,O,c,f);d.setExpressions(E,n)}}}function O(t,e,n){var o=t.getSheet();D(N(o),(function(t,o,r,i){return q.call(this,t,r,i,o,e,n)}),o.ITa.dUa())}function j(t,e,n,o,r,i,a,s,l,u){var c,f,h,p,d;if(n>=0||!r){if(c=o+(r?n:0),f=l&&F(i,t,l),h=!l&&F(i,t,l),(f||h)&&a<=n&&(c+=r?s:0),f=l&&F(i,e,l),h=!l&&F(i,e,l),f||h)if(p=n+o,d=n+s+o,!u&&a+s<=c||u&&p>=a+s)c-=s;else if(!u&&a<=c||u&&p>=a&&a<=d&&d<=a+s)return g;return c-=r?n:0,u&&a<=n&&(c-=r?s:0),c}return o}function F(t,e,n){var o=n?{2:!0}:{1:!0};return t===e||t.kj===e.kj&&(3===t.Wz&&o[e.Wz]||o[t.Wz]&&3===e.Wz)}function P(t,e,n,o,r,i,a,s,l,u,c,f){var h,p,d,m,y,v,C;if(n>=0||!r){if(h=o+(r?n:0),p=i+(a?n:0),d=l+u-1,m=c&&F(s,t,c),y=!c&&F(s,t,c),(m||y)&&l<=n&&(h+=r?u:0,p+=a?u:0),m=c&&F(s,e,c),y=!c&&F(s,e,c),m||y)if(v=n+o,C=n+i,!f&&d<h||f&&d<v)h-=u,p-=u;else{if(!f&&l<=h&&d>=p||f&&l<=v&&d>=C)return g;!f&&l>p||f&&l>C||(!f&&d<=p||f&&d<=C?(h=!f&&l>=h||f&&l>=v?h:l,p-=u):p=l-1)}return h-=r?n:0,p-=a?n:0,f&&l<=n&&(h-=r?u:0,p-=r?u:0),{index:h,endIndex:p}}return{index:o,endIndex:i}}function _(t,e,n){var r,i,a,s,l,c,f,d,g,m,y,v,C,b,w,T=_,x=e;if(e)if(e.source)if(s=e.source,(l=e.endSource)&&s!==l){if(!(c=s.kj&&s.kj.parent))return o.Ih;l===n?(f=n.VDc,x.endSource=c.getSheet(f-1).yj()):s===n&&(d=n.VDc,x.source=c.getSheet(d).yj()),delete n.VDc,x.source===x.endSource&&delete x.endSource}else(t!==n&&s===n||t===n&&s!==n)&&(x=o.Ih);else if(10===e.type)(r=T(t,e.value,n))!==e.value&&(x=o.Lh(r));else if(9===e.type)g=T(t,e.value,n),m=e.value2&&T(t,e.value2,n),g===e.value&&m===e.value2||(x=o.Kh(e.operatorType,g,m));else if(7===e.type){for(y=p,v=e.arguments.length,a=0;a<v;a++)if((r=T(t,i=e.arguments[a],n))!==i){(y=[])[a]=r;break}if(y){for(a=0;a<v;a++)i=e.arguments[a],y[a]!==h&&y[a]!==p||(y[a]=T(t,i,n));x=o.Jh(e,y)}}else 8===e.type&&(C=t||n,b=u(e.value),(w=C.getCustomName(b))&&w.source?s=w.source:(w=(C.Af.getGlobalSourceModel()||C.getCalcSourceModel()).getSource().getCustomName(b))&&w.source&&(s=w.source),s&&(t!==n&&s===n||t===n&&s!==n)&&(x=o.Ih));return x}function L(t,e,n,o,r){return _(t,o,r)}function B(t,e,n,r,i,a,s,l){return s?o.BLb(l,t,e,n,r,i,a):o.rf(t,e,n,r,i,a)}function G(t,e){if(!(e=t.getIntersect(e,0,0)))return p;var n=t.row,o=t.col,r=t.rowCount,i=t.colCount;return t.rowCount===e.rowCount&&t.colCount===e.colCount||(t.rowCount===e.rowCount?(t.col===e.col&&(o=t.col+e.colCount),i=t.colCount-e.colCount):t.colCount===e.colCount&&(t.row===e.row&&(n=t.row+e.rowCount),r=t.rowCount-e.rowCount)),s.kf(n,o,r,i)}function H(t,e,n,o){var r,i=G(t,e);return i?(r=i.union(n),o?(r.col=t.col,r.colCount=t.colCount):(r.row=t.row,r.rowCount=t.rowCount)):r=n,{startRow:r.row,endRow:r.row+r.rowCount-1,startColumn:r.col,endColumn:r.col+r.colCount-1}}function V(t,e,n,o,r){var i,a=G(t,e),s=t.getIntersect(e,0,0);return s?(s.row+=o,s.col+=r,{startRow:(i=a?a.union(s):n).row,endRow:i.row+i.rowCount-1,startColumn:i.col,endColumn:i.col+i.colCount-1}):p}function z(t,e){var n=t.row,o=t.col,r=t.rowCount,i=t.colCount,a=e.row,s=e.col,l=e.rowCount,u=e.colCount;return 1===r&&1!==i?s<o&&o<=s+u-1||s<=o+i-1&&o+i-1<s+u-1:1!==i||1===r||a<n&&n<=a+l-1||a<=n+r-1&&n+r-1<a+l-1}function W(t,e,n,o,r,i){var a,l,u,c,f=function(t,e,n){var o=t.getRange(e,n);return s.kf(o.row,o.col,o.rowCount,o.colCount)}(o,r,i),h=f.row,p=f.row+f.rowCount-1,d=f.col,g=f.col+f.colCount-1,m=t.Vj,y=m+t.Xj-1,v=t.Wj,C=v+t.Yj-1,b=t.Tj,w=t.Uj,T=s.kf(m,v,t.Xj,t.Yj),x=s.kf(b,w,t.Xj,t.Yj),S=f.getIntersect(x,0,0);if(function(t,e,n,o,r){var i;return!(!e||!t||(i=e.getIntersect(t,0,0),(i||!e.getIntersect(n,0,0))&&(!i||i.rowCount!==e.rowCount||0===r)&&(!i||i.colCount!==e.colCount||0===o)))}(T,f,x,e,n))if(u=void 0,c=void 0,l=0!==e)if(c=p>=m&&p<=y,(u=h>=m&&h<=y)&&c)h+=e,p+=e;else if(u&&!c)if(e<=0)h+=e;else if(m+e>p);else{if(!(y+e<p))return V(f,T,x,e,n);if(m===h)return H(f,T,x,l);h+=e}else if(!u&&c)if(e>=0)p+=e;else if(y+e<h);else{if(!(b>h))return V(f,T,x,e,n);if(y===p)return H(f,T,x,l);p+=e}else S&&!S.equals(x)&&z(f,x)&&(h=(a=G(f,S)).row,p=a.row+a.rowCount-1,d=a.col,g=a.col+a.colCount-1);else if(c=g>=v&&g<=C,(u=d>=v&&d<=C)&&c)d+=n,g+=n;else if(u&&!c)if(n<0)d+=n;else if(v+n>g);else{if(!(C+n<g))return V(f,T,x,e,n);if(v===d)return H(f,T,x,l);d+=n}else if(!u&&c)if(n>0)g+=n;else if(C+n<d);else{if(!(w>d))return V(f,T,x,e,n);if(C===g)return H(f,T,x,l);g+=n}else S&&!S.equals(x)&&z(f,x)&&(h=(a=G(f,S)).row,p=a.row+a.rowCount-1,d=a.col,g=a.col+a.colCount-1);return{startRow:h,endRow:p,startColumn:d,endColumn:g}}function U(t,e,n,r,a,s){var l,u,c,f,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,U,q,Y,X,Z,Q,J,$=!!r.source,K=$?r.source:t,tt=r.tf(),et=a.Nj(),nt=a.Oj(),ot=s&&s.isDataValidator,rt=function(t,e){return t.Qj===t.Rj&&e!==t.Qj}(a,t),it=!1;if(0===tt)if(l=r.rowRelative,u=r.columnRelative,c=r.endRowRelative,f=r.endColumnRelative,e>=0||!l||!c||n>=0||!u||!f){if(d=r.row+(l?e:0),g=r.endRow+(c?e:0),m=r.column+(u?n:0),v=g-d+1,C=(y=r.endColumn+(f?n:0))-m+1,!ot&&rt){if(a.Sj(a.Rj,d,m,v,C))return r.offset(et,nt,!0);if(a.Pj(K,d,m,v,C))return o.Ih;if(K!==a.Rj||K!==a.Qj||0!==et&&0!==nt)return r;it=!0}if(s&&s.isNameID||t===a.Rj&&(t===a.Qj?x=a.Pj(a.Qj,e,n,1,1):(S=e,A=n,s&&s.crossSheetMoved&&(S-=et,A-=nt),x=a.Sj(a.Rj,S,A,1,1))),(it||t===K&&t===a.Rj&&t===a.Qj)&&(I=e,R=n,x&&(I-=et,R-=nt),0===et||0===nt)){if(!(k=W(a,et,nt,r,I,R)))return o.Ih;if(0===nt&&et&&k.endColumn>=y&&k.startColumn<=m||0===et&&nt&&k.endRow>=g&&k.startRow<=d)return M=k.startRow,N=k.startColumn,E=k.endRow,D=k.endColumn,M===d&&E===g&&N===m&&D===y?r:(l&&(M-=e),c&&(E-=e),u&&(N-=n),f&&(D-=n),o.uf(r.source,p,M,N,E,D,l,u,c,f,e,n))}if(x&&(O=a.Tj-a.Vj,j=a.Uj-a.Wj,v+=(l?-O:0)+(c?O:0),C+=(u?-j:0)+(f?j:0)),K===a.Qj&&a.Pj(K,d,m,v,C)&&!C&&(!l&&!u&&!c&&!f||!x))return o.Ih;if(T=($&&K===a.Rj||!$&&t===a.Rj)&&(!x&&a.Sj(a.Rj,d,m,v,C)||x&&a.Pj(a.Qj,l?d:d+et,u?m:m+nt,v,C)),x&&(d-=l?et:0,g-=c?et:0,m-=u?nt:0,y-=f?nt:0),F=!1,T)d+=b=et,g+=b,m+=w=nt,y+=w;else if(a.Pj(K,d,m,v,C)){if(!(P=a.intersectWith(K,d,m,v,C))||P.rowCount!==v&&P.colCount!==C)return o.Ih;d=P.row+et,m=P.col+nt,g=d+P.rowCount,y=m+P.colCount,F=!0}if(d-=l?e:0,g-=c?e:0,m-=u?n:0,y-=f?n:0,a.Rj===a.Qj?K=$?r.source:h:(K=r.source,T&&x&&$?K=a.Qj:T&&x||(T?K=a.Qj:x&&!$&&(K=a.Rj))),d!==r.row||m!==r.column||g!==r.endRow||y!==r.endColumn||F||K!==r.source)return o.uf(K,p,d,m,g,y,l,u,c,f,e,n)}else if(!(e>=0)&&l&&c||-1!==n){if(-1===e&&(n>=0||!u||!f)){if((m=r.column+(u?n:0))>(y=r.endColumn+(f?n:0)))return o.Ih;if(a.Pj(t,e,n,1,1)&&(m-=u?nt:0,y-=f?nt:0),C=y-m+1,a.Sj(K,-1,m,-1,C))m+=w=nt,y+=w;else if(a.Pj(K,-1,m,-1,C))return o.Ih;if(y-=f?n:0,(m-=u?n:0)!==r.column||y!==r.endColumn)return o.uf(r.source,p,r.row,m,r.endRow,y,r.rowRelative,u,r.endRowRelative,f,e,n)}}else{if((d=r.row+(l?e:0))>(g=r.endRow+(c?e:0)))return o.Ih;if(a.Pj(t,e,n,1,1)&&(d-=l?et:0,g-=c?et:0),v=g-d+1,a.Sj(K,d,-1,v,-1))d+=b=et,g+=b;else if(a.Pj(K,d,-1,v,-1))return o.Ih;if(g-=c?e:0,(d-=l?e:0)!==r.row||g!==r.endRow)return o.uf(r.source,p,d,r.column,g,r.endColumn,l,r.columnRelative,c,r.endColumnRelative,e,n)}else if(1===tt){if(l=r.rowRelative,c=r.endRowRelative,e>=0||!l||!c){if((d=r.row+(l?e:0))>(g=r.endRow+(c?e:0)))return o.Ih;if(x=t===a.Rj&&t===a.Qj&&a.Pj(a.Qj,e,n,1,1),K===a.Rj&&K===a.Qj&&0===a.Wj&&0===a.Uj&&a.Yj===K.getColumnCount()){if(_=a.Vj,L=a.Tj,x&&(d-=et,g-=et),G=_+(B=a.Xj),V=g>=_&&G>g,(H=d>=_&&G>d)&&V)return x?r:r.offset(et,nt,!0);if(z=L+B,H&&L<=g?(d+=et,z>g&&g>=L&&(g=z-1,d=G)):V&&z>=d&&(g+=et,L<=d&&m<z&&(d=L,g=_-1)),g-=c?e:0,(d-=l?e:0)!==r.row||g!==r.endRow)return o.uf(r.source,r.endSource,d,i.BAND_INDEX_CONST,g,i.BAND_INDEX_CONST,l,u,c,f,e,n)}if(x)return r.offset(-et,nt,!0)}}else if(2===tt){if(u=r.columnRelative,f=r.endColumnRelative,(m=r.column+(u?n:0))>(y=r.endColumn+(f?n:0)))return o.Ih;if(x=t===a.Rj&&t===a.Qj&&a.Pj(a.Qj,e,n,1,1),K===a.Rj&&K===a.Qj&&0===a.Vj&&0===a.Tj&&a.Xj===K.getRowCount()){if(U=a.Wj,q=a.Uj,x&&(m-=nt,y-=nt),X=U+(Y=a.Yj),Q=y>=U&&X>y,(Z=m>=U&&X>m)&&Q)return x?r:r.offset(et,nt,!0);if(J=q+Y,Z&&q<=y?(m+=nt,J>y&&y>=q&&(y=J-1,m=X)):Q&&J>=m&&(y+=nt,q<=m&&m<J&&(m=q,y=U-1)),y-=f?n:0,(m-=u?n:0)!==r.column||y!==r.endColumn)return o.uf(r.source,r.endSource,i.BAND_INDEX_CONST,m,i.BAND_INDEX_CONST,y,l,u,c,f,e,n)}if(x)return r.offset(et,-nt,!0)}return r}function q(t,e,n,r,i,a,s){var l,u,c,f,d,g,m,y=q,v=r;if(1===r.type&&r.sf()||33===r.type)v=a?function(t,e,n,r,i,a){var s,l,u,c,f,h,d=!!r.source,g=r.source||t,m=r.rowRelative,y=r.columnRelative,v=i.Nj(),C=i.Oj(),b=33===r.type,w=b&&r.contextSource;if((e>=0||!m)&&(n>=0||!y)){if(s=r.row+(m?e:0),l=r.column+(y?n:0),a&&a.isNameID||t===i.Rj&&(t===i.Qj?c=i.Pj(i.Qj,e,n,1,1):(f=e,h=n,a&&a.crossSheetMoved&&(f-=v,h-=C),c=i.Sj(i.Rj,f,h,1,1))),g===i.Qj&&i.Pj(g,s,l,1,1)&&!i.Sj(g,s,l,1,1)&&(!m&&!y||!c))return o.Ih;if(u=(d&&g===i.Rj||!d&&t===i.Rj)&&(!c&&i.Sj(i.Rj,s,l,1,1)||c&&i.Pj(i.Qj,m?s:s+v,y?l:l+C,1,1)),c&&(s-=m?v:0,l-=y?C:0),u&&(s+=v,l+=C),s-=m?e:0,l-=y?n:0,g=r.source,i.Rj!==i.Qj&&(u&&c?d&&(g=i.Qj):u?g=i.Qj:c&&!d&&(g=i.Rj)),s!==r.row||l!==r.column||g!==r.source)return B(g,p,s,l,m,y,b,w)}else if((e>=0||!m)&&-1===n){if(s=r.row+(m?e:0),i.Pj(t,e,n,1,1)&&(s-=m?v:0),i.Sj(g,s,-1,1,-1))s+=v;else if(i.Pj(g,s,-1,1,-1))return o.Ih;if((s-=m?e:0)!==r.row)return B(r.source,p,s,r.column,m,r.columnRelative,b,w)}else if(-1===e&&n>=0&&!y){if(l=r.column+(y?n:0),i.Pj(t,e,n,1,1)&&(l-=y?C:0),i.Sj(g,s,l,1,1))l+=C;else if(i.Pj(g,s,l,1,1))return o.Ih;if(l-=y?n:0,s!==r.row||l!==r.column)return B(r.source,r.endSource,r.row,l,r.rowRelative,y,b,w)}return r}(t,e,n,r,i,s):function(t,e,n,o,r){var i,a,s=o.source||t,l=o.rowRelative,u=o.columnRelative,c=r.Nj(),f=r.Oj(),h=33===o.type,d=h&&o.contextSource;if((e>=0||!l)&&(n>=0||!u)){if(i=o.row+(l?e:0),a=o.column+(u?n:0),r.Pj(t,e,n,1,1)?(i-=l?c:0,a-=u?f:0):r.Sj(t,i,a,1,1)&&(i+=l?c:0,a+=u?f:0),r.Sj(s,i,a,1,1)?(i+=c,a+=f):r.Pj(s,i,a,1,1)&&(i-=c,a-=f),a-=u?n:0,(i-=l?e:0)!==o.row||a!==o.column)return B(o.source,p,i,a,l,u,h,d)}else if((e>=0||!l)&&-1===n){if(i=o.row+(l?e:0),r.Pj(t,e,-1,1,-1)?i-=l?c:0:r.Sj(t,i,-1,1,-1)&&(i+=l?c:0),r.Sj(s,i,-1,1,-1)?i+=c:r.Pj(s,i,-1,1,-1)&&(i-=c),(i-=l?e:0)!==o.row||a!==o.column)return B(o.source,p,i,o.column,l,o.columnRelative,h,d)}else if(-1===e&&n>=0&&!u&&(a=o.column+0,r.Pj(t,-1,n,-1,1)?a-=0:r.Sj(t,-1,a,-1,1)&&(a+=0),r.Sj(s,-1,a,-1,1)?a+=f:r.Pj(s,-1,a,-1,1)&&(a-=f),a-=0,i!==o.row||a!==o.column))return B(o.source,p,o.row,a,o.rowRelative,u,h,d);return o}(t,e,n,r,i);else if(1===r.type)v=a?U(t,e,n,r,i,s):X(t,e,n,r,i);else if(10===r.type)(l=y(t,e,n,r.value,i,a,s))!==r.value&&(v=o.Lh(l));else if(9===r.type)u=y(t,e,n,r.value,i,a,s),c=r.value2&&y(t,e,n,r.value2,i,a,s),u===r.value&&c===r.value2||(v=o.Kh(r.operatorType,u,c));else if(7===r.type){for(f=p,d=void 0,g=void 0,m=r.arguments.length,g=0;g<m;g++)if((l=y(t,e,n,d=r.arguments[g],i,a,s))!==d){(f=[])[g]=l;break}if(f){for(g=0;g<m;g++)d=r.arguments[g],f[g]!==h&&f[g]!==p||(f[g]=y(t,e,n,d,i,a,s));v=o.Jh(r,f)}}return v}function Y(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d=e.Rj.getSheet().ITa.dUa();for(o=0;o<t.length;o++)if(i=(r=t[o].validator).n5,s=(a=m(i)).r,l=a.c,u=t[o].sheet.yj(),(f=(c=r.condition()).getExpressions())&&f.length>0){for(h=0;h<f.length;h++)p=f[h],f[h]=q(u,s,l,p,e,n,{isDataValidator:!0});c.setExpressions(f,d)}}function X(t,e,n,r,a){var s,l,u,c,f,h,d,g,m,y,v,C,b=r.source||t,w=r.tf(),T=a.Nj(),x=a.Oj();if(0===w){if(d=r.rowRelative,g=r.columnRelative,m=r.endRowRelative,y=r.endColumnRelative,!(e>=0)&&d&&m||!(n>=0)&&g&&y)if(!(e>=0)&&d&&m||-1!==n){if(-1===e&&(n>=0||!g||!y)){if((u=r.column+(g?n:0))<(c=r.endColumn+(y?n:0)))return o.Ih;if(a.Pj(t,-1,n,-1,1)?(u-=g?x:0,c-=y?x:0):a.Sj(t,-1,n,-1,1)&&(u+=g?x:0,c+=y?x:0),h=c-u,a.Sj(b,-1,u,-1,h)?(u+=C=x,c+=C):a.Pj(b,-1,u,-1,h)&&(u-=C=x,c-=C),c-=y?n:0,(u-=g?n:0)!==r.column||c!==r.endColumn)return o.uf(r.source,p,u,r.endRow,c,r.rowRelative,g,r.endRowRelative,y,e,n)}}else{if((s=r.row+(d?e:0))<(l=r.endRow+(m?e:0)))return o.Ih;if(a.Pj(t,e,-1,1,-1)?(s-=d?T:0,l-=d?T:0):a.Sj(t,e,-1,1,-1)&&(s+=d?T:0,l+=d?T:0),f=l-s,a.Sj(b,s,-1,f,-1)?(s+=v=T,l+=v):a.Pj(b,s,-1,f,-1)&&(s-=v=T,l-=v),l-=m?e:0,(s-=d?e:0)!==r.row||l!==r.endRow)return o.uf(r.source,p,s,r.column,l,r.endColumn,d,r.columnRelative,m,r.endColumnRelative,e,n)}else if(s=r.row+(d?e:0),l=r.endRow+(m?e:0),u=r.column+(g?n:0),f=l-s,h=(c=r.endColumn+(y?n:0))-u,a.Pj(t,e,n,1,1)?(s-=d?T:0,l-=m?T:0,u-=g?x:0,c-=y?x:0):a.Sj(t,s,u,f,h)&&(s+=d?T:0,l+=m?T:0,u+=g?x:0,c+=y?x:0),a.Sj(b,s,u,f,h)?(s+=v=T,l+=v,u+=C=x,c+=C):a.Pj(b,s,u,f,h)&&(s-=v=T,l-=v,u-=C=x,c-=C),l-=m?e:0,u-=g?n:0,c-=y?n:0,(s-=d?e:0)!==r.row||u!==r.column||l!==r.endRow||c!==r.endColumn)return o.uf(r.source,p,s,u,l,c,d,g,m,y,e,n)}else if(1===w){if(d=r.rowRelative,m=r.endRowRelative,e>=0||!d||!m){if((s=r.row+(d?e:0))<(l=r.endRow+(m?e:0)))return o.Ih;if(a.Pj(t,e,-1,1,-1)?(s-=d?T:0,l-=m?T:0):a.Sj(t,e,-1,1,-1)&&(s+=d?T:0,l+=m?T:0),f=l-s,a.Sj(b,s,-1,f,-1)?(s+=v=T,l+=v):a.Pj(b,s,-1,f,-1)&&(s-=v=T,l-=v),l-=m?e:0,(s-=d?e:0)!==r.row||l!==r.endRow)return o.uf(r.source,p,s,i.BAND_INDEX_CONST,l,i.BAND_INDEX_CONST,d,!1,m,!1,e,n)}}else if(2===w){if(g=r.columnRelative,y=r.endColumnRelative,(u=r.column+(g?n:0))>(c=r.endColumn+(y?n:0)))return o.Ih;if(a.Pj(t,-1,n,-1,1)?(u-=g?x:0,c-=y?x:0):a.Sj(t,-1,n,-1,1)&&(u+=g?x:0,c+=y?x:0),h=c-u,a.Sj(b,-1,u,-1,h)?(u+=C=x,c+=C):a.Pj(b,-1,u,-1,h)&&(u-=C=x,c-=C),c-=y?n:0,(u-=g?n:0)!==r.column||c!==r.endColumn)return o.uf(r.source,p,i.BAND_INDEX_CONST,u,i.BAND_INDEX_CONST,c,!1,g,!1,y,e,n)}return r}function Z(t,e,n,o,r,i){t._g(e,n,o,r,!0,!1,i)}function Q(t,e,n){var r,i,a,s,l,u,c,f=Q,d=e;if(8===e.type){if(e.value===n&&(!e.source||e.source===t.getSource()))return o.Hh(g,e.source)}else if(10===e.type)(r=f(t,e.value,n))!==e.value&&(d=o.Lh(r));else if(9===e.type)s=f(t,e.value,n),l=e.value2&&f(t,e.value2,n),s===e.value&&l===e.value2||(d=o.Kh(e.operatorType,s,l));else if(7===e.type){for(u=p,c=e.arguments.length,a=0;a<c;a++)if((r=f(t,i=e.arguments[a],n))!==i){(u=[])[a]=r;break}if(u){for(a=0;a<c;a++)i=e.arguments[a],u[a]!==h&&u[a]!==p||(u[a]=f(t,i,n));d=o.Jh(e,u)}}return d}Object.defineProperty(e,"__esModule",{value:!0}),o=n("@grapecity/js-calc"),r=n("Common"),i=n("./dist/plugins/sheetsCalc/calc.ns.js"),a=n("./dist/plugins/sheetsCalc/parser-sheets.js"),s=n("Core"),l=r.Common.u,u=l.Nb,c=Math.min,f=Math.max,h=void 0,p=null,d=o.Convert.vf,g=o.Errors.Reference,m=s.util.l_a,y=function(){function t(t,e,n,o,r,i,a,s){var l=this;l.Rj=t,l.Vj=e,l.Wj=n,l.Qj=o,l.Tj=r,l.Uj=i,l.Xj=a,l.Yj=s}return t.prototype.Nj=function(){return this.Tj-this.Vj},t.prototype.Oj=function(){return this.Uj-this.Wj},t.prototype.Sj=function(t,e,n,o,r){var i=this;return i.Rj===t&&(-1===i.Vj||i.Vj<=e&&e+o<=i.Vj+i.Xj)&&(-1===i.Wj||i.Wj<=n&&n+r<=i.Wj+i.Yj)},t.prototype.Pj=function(t,e,n,o,r){var i=this;return i.Qj===t&&(-1===i.Tj||i.Tj<=e&&e+o<=i.Tj+i.Xj)&&(-1===i.Uj||i.Uj<=n&&n+r<=i.Uj+i.Yj)},t.prototype.intersectWith=function(t,e,n,o,r){var i,a=this;return a.Qj!==t?p:(i=a.Zj(t,e,n,o,r),a.Zj(t,a.Vj,a.Wj,o,r).intersectWith(i))},t.prototype.Zj=function(t,e,n,o,r){return{row:-1===e?0:e,column:-1===n?0:n,rowCount:-1===e||-1===o?t.rowCount:o,columnCount:-1===n||-1===r?t.colCount:r,intersectWith:C}},t}(),e.MoveSwapInfo=y,v=function(){function t(){}return t.zj=function(e,n,r,a,s,l,u,f,h,p,d){var m,y,v,C,b,w,T=r,x=t,S=this.zj;if(!r)return T;if(10===(v=r.type))T=o.Lh(S.call(x,e,n,r.value,a,s,l,u,f,h,p,d));else if(1===v&&r.sf()||33===v){if(m=c((r.source||n).getRowCount(),i.MAX_ROW_COUNT),y=c((r.source||n).getColumnCount(),i.MAX_COLUMN_COUNT),r.rowRelative&&(r.row+a<0||r.row+a>=m)||r.columnRelative&&(r.column+s<0||r.column+s>=y))return o.Hh(g,r.source);T=r.offset(0,0,!1)}else if(1===v){if(m=c((r.source||n).getRowCount(),i.MAX_ROW_COUNT),y=c((r.source||n).getColumnCount(),i.MAX_COLUMN_COUNT),(C=r).rowRelative&&!r.isFullColumn&&(C.row+a<0||C.row+a>m)||C.columnRelative&&!r.isFullRow&&(C.column+s<0||C.column+s>y)||C.endRowRelative&&!r.isFullColumn&&(C.endRow+a<0||C.endRow+a>m)||C.endColumnRelative&&!r.isFullRow&&(C.endColumn+s<0||C.endColumn+s>y))return o.Hh(g,r.source,r.endSource);T=r.offset(0,0,!1,a,s)}else if(9===r.type)T=o.Kh(r.operatorType,S.call(x,e,n,r.value,a,s,l,u,f,h,p,d),r.value2&&S.call(x,e,n,r.value2,a,s,l,u,f,h,p,d));else if(7===v){if(b=[],r.arguments&&r.arguments.length>0)for(w=0;w<r.arguments.length;w++)b[w]=S.call(x,e,n,r.arguments[w],a,s,l,u,f,h,p,d);T=o.Jh(r,b)}else 13===v&&(T=r.offsetWhenCopy(e,n,a,s,l,u,f,h,p,d));return T},t.copyFormula=function(e,n,r,i,a,s,l,u,f){var p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G=e,H=i,V=e.getSource(),z=i.getSource(),W=t;if(G&&H){for(p=z&&z.getSheet().ITa.dUa(),d=n,g=r,m=a,y=s,v=l,C=u,n<0&&(d=0,v=c(e.rC(),i.rC())),r<0&&(g=0,C=c(e.cC(),i.cC())),a<0&&(m=0),s<0&&(y=0),b=new o.CalcSourceModel(e.Cf(),V),w=0;w<v;w++)for(T=0;T<C;T++)G.Uf(b,w+d,T+g,w,T);for(x={},S=i.Cf(),w=0;w<v;w++)if(!f||!z.isHiddenRow(w+m,!0))for(A=w+m,T=0;T<C;T++)if(I=T+y,R=b.Kf(w,T)){if(R===x)continue;if(R=W.zj(V,z,b.Kf(w,T),A,I,a-n,s-r,a,s,v,C),k=b.Qf(w,T),z)if(k&&!k.isDynamicArray){for(M=k.rowCount,N=k.colCount,(E=d-k.row)>0&&(M-=E),(D=v-w)<M&&(M=D),(O=g-k.col)>0&&(N-=O),(j=C-T)<N&&(N=j),F=0;F<M;F++)for(P=0;P<N;P++)b.Rf(w+F,T+P,x);i.setArrayFormula(A,I,M,N,S.unparse(z,R,A,I),h,p)}else _=R?S.unparse(z,R,A,I):h,z.setFormula(A,I,_),(L=b.Mf(w,T))&&(B=new o.EvaluateContext(z,o.pf(A,I),!1),L=(L=o.Mh(B,R,!1,0,0))===R?h:L),H.ig(A,I,R,L,k,p);else H.Rf(w+m,T+y,R),H.Xf(w+m,T+y,k)}else H&&H.Kf(A,I)&&H.Sf(A,I,p)}},t.moveFormula=function(t,e,n,o,r,i,a,l){var u,f,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N=t.Bj(),E=o.Bj(),D=N.Cf();if(N&&E){for(u=N.dUa(),f=E.dUa(),d=D.ih(),e<0&&(e=0,a=c(t.getRowCount(),o.getRowCount())),r<0&&(r=0),n<0&&(n=0,l=c(t.getColumnCount(),o.getColumnCount())),i<0&&(i=0),g=!(t===o&&t.name()===o.name()),N.Sg(e,n,a,l),Z(N,e,n,a,l),E.Sg(r,i,a,l),Z(E,r,i,a,l),m=[],y=0;y<a;y++)for(v=0;v<l;v++)C=N.Kf(y+e,v+n),b=N.Qf(y+e,v+n),w=N.Mf(y+e,v+n),C?(m.push({Lf:C,Pf:b,Nf:w}),N.Sf(y+e,v+n,u)):m.push(p);for(x=g?{}:null,y=0;y<a;y++)for(S=y+r,v=0;v<l;v++)I=v+i,(A=m[y*l+v])?(C=A.Lf,b=A.Pf,D&&b&&!b.isDynamicArray&&b.row===e+y&&b.col===n+v&&(T=s.kf(S,I,b.rowCount,b.colCount)),R=b&&!b.isDynamicArray?T:h,w=A.Nf,E.FTa(f,S,I),E.Rf(S,I,C),E.Xf(S,I,R),E.Wf(S,I,w),g&&(x[S+", "+I]=C)):(E.FTa(f,S,I),E.Rf(S,I,h),E.Xf(S,I,h));d.Dj(N,e,n,a,l),d.Dj(E,r,i,a,l),M=(k=N.getSource().getSheet()).uja&&(k.parent||k).tja(),d.Ej(M,N.getSource(),e,n,E.getSource(),r,i,a,l,!0,x),!0===g&&d.Ej(M,N.getSource(),e,n,E.getSource(),r,i,a,l,!0,x)}},t.prototype.isAdjustCell=function(t){return t.preAdj||this.imb&&t===this.imb[0]},t.prototype.isAdjust=function(t){return t.preAdj||this.imb&&t===this.imb[0]},t.prototype.hh=function(t,e){var n,o,r=this;isNaN(e)||(r.imb||(r.imb={},r.jmb={}),n=r.imb[e],o=r.jmb[e],t&&!t.preAdj&&t!==n&&(n?o.nextAdj=t:r.imb[e]=t,t.preAdj=o,t.nextAdj=p,r.jmb[e]=t))},t.prototype.Fj=function(t,e){var n,o,r,i=this;isNaN(e)||(n=i.imb&&i.imb[e],t&&(t.preAdj||t===n)&&(o=t.preAdj,r=t.nextAdj,o?o.nextAdj=r:i.imb[e]=r,r?r.preAdj=o:i.jmb[e]=o,t.preAdj=p,t.nextAdj=p))},t.prototype.Gj=function(t,e,n,o,r,i,a){this.Hj(t,R,e,n,o,r,i,a);var s=0,l=0,u=0,c=0;0===e&&(o&&r?u=n:o?s=n:r?c=n:l=n),k(t,R,e,n,s,l,u,c,o,r),E(t,R,e,n,o,r)},t.prototype.Hj=function(t,e,n,o,r,i,a,s){var l,u,c,f,p,d,g,m,y,v,C,w,S,A,I,R,k,M,N,E=this,D=E.imb;if(D){for(m={};D[0];)if(g=(l=(p=D[0]).ah).dUa(),d=l.getSource(),x(m,u=p.row,c=p.column))E.Fj(p,0);else{if(f=l.Kf(u,c))if(f=e.call(E,d,u,c,f,t,n,o,r,i,h,a,s),y=l.Qf(u,c)){if(d===t&&(v=i?o:-o,r?n<=y.row&&(y.row+=v):n<=y.col&&(y.col+=v)),u===y.row&&c===y.col)if(y.isDynamicArray)l.fg(u,c,f,y,!0,b(r?u:c,n,g,t.id===d.id));else for(C=u;C<u+y.rowCount;C++)for(m[C]||(m[C]={}),w=c;w<c+y.colCount;w++)l.fg(C,w,f,y,C===u&&w===c,b(r?C:w,n,g,t.id===d.id)),T(m,C,w,!0)}else l.fg(u,c,f,y,!0,b(r?u:c,n,g,t.id===d.id));else(l.getRowExpression&&l.getRowExpression(u)||l.getColumnExpression&&l.getColumnExpression(c))&&l.Ag(u,c,1,1);E.Fj(p,0)}for(;D[1];)g=(l=(p=D[1]).ah).dUa(),u=p.row,l.getRowExpression&&((f=l.getRowExpression(u))&&l.fg&&(d=l.getSource(),l.fg(u,-1,e.call(E,d,u,-1,f,t,n,o,r,i),h,!0,b(u,n,g,t.id===d.id)))),E.Fj(p,1);for(;D[2];)g=(l=(p=D[2]).ah).dUa(),c=p.column,l.getColumnExpression&&((f=l.getColumnExpression(c))&&l.fg&&(d=l.getSource(),l.fg(-1,c,e.call(E,d,-1,c,f,t,n,o,r,i),h,!0,b(c,n,g,t.id===d.id)))),E.Fj(p,2);for(;D[3];)A=(S=D[3]).name,f=(l=S.ah).DTa(A),I=e.call(E,l.getSource(),0,0,f,t,n,o,r,i,{isNameID:!0}),l.gg(A,I),E.Fj(S,3);for(R in D)if((k=+R)>3&&D.hasOwnProperty(R))for(;D[R];)N=(M=D[R]).ah,f=e.call(E,N,0,0,M.expression,t,n,o,r,i),N.setExpression(M.id,M.name,f),E.Fj(M,k)}},t.prototype.ph=function(t){Z(t.getCalcSourceModel(),0,0,t.getRowCount(),t.getColumnCount()),this.Hj(t,L),k(t,L,0,0,0,0,0,0,!0,!1),E(t,L,0,0,!0,!1)},t.prototype.Ej=function(t,e,n,o,r,i,a,s,l,u,c){var f,p,d,g,m,v,C,b,S,A,I,R,k,M,N,E,D,j,F,P,_,L,B=this,G=q,H=new y(e,n,o,r,i,a,s,l),V={};if(t&&Y(t,H,u),O(e,H,u),S={},C=B.imb){for(;C[0];)if(f=(p=C[0]).ah,d=p.row,g=p.column,v=f.dUa(),x(V,d,g))B.Fj(p,0);else{if(m=f.Kf(d,g),b=f.getSource(),m)if(A=h,c&&c[d+", "+g]&&(b=e,A={crossSheetMoved:!0}),m=G.call(B,b,d,g,m,H,u,A),R=void 0,(I=f.Qf(d,g))&&!I.isDynamicArray)if(R=w(I),d===I.row&&g===I.col)for(S[R]=!0,k=d;k<d+I.rowCount;k++)for(V[k]||(V[k]={}),M=g;M<g+I.colCount;M++)f.fg(k,M,m,I,k===d&&M===g,v),T(V,k,M,!0);else S[R]||(f.fg(d,g,m,I,!1,v),T(V,d,g,!0));else f.fg(d,g,m,I,!0,v);else(f.getRowExpression&&f.getRowExpression(d)||f.getColumnExpression&&f.getColumnExpression(g))&&f.Ag(d,g,1,1);B.Fj(p,0)}for(;C[1];)f=(p=C[1]).ah,d=p.row,v=f.dUa(),f.getRowExpression&&((m=f.getRowExpression(d))&&f.jg&&f.jg(d,G.call(B,b,d,-1,m,H,u),h,v)),B.Fj(p,1);for(;C[2];)f=(p=C[2]).ah,g=p.column,v=f.dUa(),f.getColumnExpression&&((m=f.getColumnExpression(g))&&f.kg&&f.kg(g,G.call(B,b,-1,g,m,H,u),h,v)),B.Fj(p,2);for(;C[3];)E=(N=C[3]).name,m=(f=N.ah).DTa(E),D=G.call(B,b,0,0,m,H,u),f.gg(E,D),B.Fj(N,3);for(j in C)if((F=+j)>3&&C.hasOwnProperty(j))for(;C[j];)L=(_=(P=C[j]).ah).getSource(),m=G.call(B,L,0,0,P.expression,H,u),_.setExpression(P.id,P.name,m),B.Fj(P,F)}},t.prototype.Dj=function(t,e,n,o,r){var i,a,s,l,u,c=e+o,f=n+r;for(s=e;s<c;s++)for(l=n;l<f;l++)i=t.Yf(s,l),a=t.Kf(s,l),(i||a)&&(this.Fj(i,0),t.Q3(s,l,0),u=t.qg(s,l,!0),this.hh(u,0))},t.prototype.Ij=function(t,e,n){var o,r;for(o=e;-1!==o&&o<e+n;o++)(t.Yf(-1,o)||t.Kf(-1,o))&&(t.Q3(-1,o,2),r=t.sg(o,!0),this.hh(r,2))},t.prototype.Jj=function(t,e,n){var o,r;for(o=e;-1!==o&&o<e+n;o++)(t.Yf(o,-1)||t.Kf(o,-1))&&(t.Q3(o,-1,1),r=t.rg(o,!0),this.hh(r,1))},t.prototype.Kj=function(t){var e,n,r,i,a,s=t.Cf().getAllSourceModels();for(r=0;r<s.length;r++)if((i=s[r]).lmb)for(e=i.lmb(),a=0;a<e.length;a++)(n=e[a])&&n.isVolatile&&n instanceof o.CellCalc&&!this.isAdjustCell(n)&&this.hh(n,0)},t.prototype.onBeforeAddRemoveRows=function(t,e,n){[t,n].forEach((function(t){if(t){var n=t.rC(),o=t.cC();t.Sg(e,0,n-e,o),t.Ug(e,n-e),Z(t,e,-1,n-e,-1,!0)}}))},t.prototype.onAfterAddRemoveRows=function(t,e,n,o,r,i){var a=this;[t,i].forEach((function(t){if(t){var r=t.rC(),i=t.cC();o?t.Ag(e,0,n,i):r+=n,a.Dj(t,e,0,r-e,i),a.Jj(t,e,r-e),a.Kj(t)}})),a.Gj(t.getSource(),e,n,!0,o,h,r),t.Cf().autoCalculation&&t.Cf().recalculateAll(!1)},t.prototype.onAfterAddRemoveColumns=function(t,e,n,o,r,i){var a=this;[t,i].forEach((function(t){if(t){var r=t.rC(),i=t.cC();o?t.Ag(0,e,r,n):i+=n,a.Dj(t,0,e,r,i-e),a.Ij(t,e,i-e),a.Kj(t)}})),a.Gj(t.getSource(),e,n,!1,o,h,r),t.Cf().autoCalculation&&t.Cf().recalculateAll(!1)},t.prototype.onBeforeAddRemoveColumns=function(t,e,n){[t,n].forEach((function(t){if(t){var n=t.rC(),o=t.cC();t.Sg(0,e,n,o-e),t.Wg(e,o-e),Z(t,-1,e,-1,o-e,!0)}}))},t.prototype.onAfterRemoveName=function(t,e){var n=t.wg(e,!1);n&&(n.updateListening(!0,!1),n.fh(),n.updateListeningOnRemoved())},t.prototype.adjustFormulaOnRemoveName=function(t,e,n){return Q(t,e,n)},t.prototype.invalidName=function(t,e){var n;e&&((n=t.getCalcSourceModel().wg(e.toUpperCase(),!0))&&n.Yg())},t.prototype.onAfterRemoveTable=function(e,n){var o,r,i,a,l,u,c,f,h,p,d,g,m=this;for(l=0;l<e.length;l++)Z((u=e[l]).source().getCalcSourceModel(),u.startRow(),u.startColumn(),u.endRow()-u.startRow()+1,u.endColumn()-u.startColumn()+1);if(c=m.imb)for(f={};c[0];)if(o=(h=c[0]).ah,x(f,r=h.row,i=h.column))m.Fj(h,0);else{if(a=o.Kf(r,i))if(a=t.adjustExpressionOnRemoveTable(a,e,r,i,n),(p=o.Qf(r,i))&&!p.isDynamicArray)for(p=s.kf(r,i,p.rowCount,p.colCount),d=r;d<r+p.rowCount;d++)for(f[d]||(f[d]={}),g=i;g<i+p.colCount;g++)o.fg(d,g,a,p,d===r&&g===i),T(f,d,g,!0);else o.fg(r,i,a,p,!0);else(o.getRowExpression&&o.getRowExpression(r)||o.getColumnExpression&&o.getColumnExpression(i))&&o.Ag(r,i,1,1);m.Fj(h,0)}},t.adjustExpressionOnRemoveTable=function(e,n,r,i,a){var s,l,u,c,f,h,d,g,m,y,v,C,b,w,T,x,S=t.adjustExpressionOnRemoveTable;if(9===e.type){if(s=e.value,l=e.value2,u=S(s,n,r,i,a),c=l&&S(l,n,r,i,a),s!==u||l!==c)return o.Kh(e.operatorType,u,c)}else if(7===e.type){for(f=!1,h=[],d=0;d<e.arguments.length;d++)m=S(g=e.arguments[d],n,r,i,a),f=f||g!==m,h.push(m);if(f)return o.Jh(e,h)}else if(10===e.type){if((y=e.value)!==(v=S(y,n,r,i,a)))return o.Lh(v)}else if(13===e.type)for(C=e,d=0;d<n.length;d++)if(C.baseTable===n[d])return a?o.Ih:(b=C.getRange(-1===r?0:r,-1===i?0:i,!0),w=-1===r||1===C.referencePortions(),T=1===b.rowCount&&1===b.columnCount,x=C.source,T?o.rf(x,p,b.row,b.col,w,!1):o.uf(x,p,b.row,b.col,b.row+b.rowCount-1,b.col+b.colCount-1,w,!1,w,!1));return e},t}(),e.CalcOperatorAdjustor=v,o.CalcService.prototype.uzb=function(){return new v},e.adjustFormulaOnMoveSwap=q},"./dist/plugins/sheetsCalc/parser-sheets.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function I(t){return u(t+1).split("")}function R(t,e){var n=e+1;return t<0?t%n+n:t>e?t%n:t}function k(t){return new i.ErrorSource(t)}function M(t,e,n,o,r){var a,l,u=s.BAND_INDEX_CONST,c={cj:u,dj:u,ej:!0,fj:!0,gj:!1,li:0,Vka:!0},f=e?D(t,n,o,0):E(t,0,r);return f.hj?(c.cj=f.ij,c.ej=f.jj):(c.dj=f.ij,c.fj=f.jj),c.li=f.li,c.gj=f.gj,!f.gj||f.li>=t.length?c:!e&&f.hj||e&&!f.hj?{gj:!1}:(a=t[c.li],!e&&(i.isNumber(a)||"$"===a)||e&&("C"===a||"c"===a)?(l=e?D(t,n,o,c.li):E(t,c.li,r),c.li=l.li,!l.gj||!e&&!l.hj||e&&l.hj?(c.gj=!1,c):(l.CLb&&(c.CLb=!0),c.li<t.length&&(c.Vka=!1),e?(c.dj=l.ij,c.fj=l.jj):(c.cj=l.ij,c.ej=l.jj),c.gj=!0,c)):{gj:!1})}function N(t){return i.ei(t)||95===t.charCodeAt(0)}function E(t,n,o){var r,a,s,l,u,c,f,p,d,g={jj:!0,gj:!1},m=t.length;if(n>=m)return g;if("$"===t[n]&&(g.jj=!1,n++),n>=m)return g;if(a=0,s=t[r=n],l=!1,i.isNumber(s)&&"0"!==s){for(g.hj=!0;r<m&&i.isNumber(s);)++r<m&&(s=t[r]);if(r+1===m&&"#"===s&&o&&(l=!0),r-n>7)return g;for(u=r-1,c=0;u>=n;u--,c++)a+=(t[u].charCodeAt(0)-48)*y[c];if(a<=e.maxRowCount)return g.ij=a-1,g.li=l?m:r,g.CLb=l,g.gj=!0,g}else if(i.ei(s)){for(g.hj=!1;r<m&&i.ei(s);)++r<m&&(s=t[r]);if(r-n>3)return g;if(function(t,e,n){for(var o=t,r=e[t],i=!1;o<n&&!N(r);)++o<n&&(r=e[o]);if(o<n){for(;o<n&&N(r);)++o<n&&(r=e[o]);o<n&&(i=!0)}return i}(r,t,m))return g;for(a=0,p=f=r-1;p>=n;p--){if(!((d=t[p].charCodeAt(0))>=65&&d<=90||d>=97&&d<=122))return g;a+=((32|d)-96)*h[f-p]}if(a<=e.maxColumnCount)return g.ij=a-1,g.li=r,g.gj=!0,g}return g}function D(t,n,o,r){var a,l,u,c,f,h={li:r,ij:s.BAND_INDEX_CONST,hj:!0,jj:!1,gj:!1},p=t.length;if(r>=p)return h;if("R"===(l=t[a=r])||"r"===l)h.hj=!0,u=n;else{if("C"!==l&&"c"!==l)return h;h.hj=!1,u=o}if(a++,++r>=p)return h.li=r,h.ij=u,h.jj=!0,h.gj=!0,h;if("["===(l=t[a])&&(r++,a++,h.jj=!0),r>=p)return h;if(c=!1,l=t[a],h.jj&&"-"===l&&(r++,a++,c=!0),r>=p)return h;if(l=t[a],!i.isNumber(l))return h.jj||(h.li=r,h.ij=u,h.jj=!0,h.gj=!0),h;for(;a<p&&i.isNumber(l);)++a<p&&(l=t[a]);if(f=parseInt(t.slice(r,a).join(""),10),h.jj){if(a>=p||"]"!==t[a])return h;a++}return f<(h.hj?e.maxRowCount:e.maxColumnCount)?(h.jj?(f=c?-f:f,h.ij=f+u):h.ij=f-1,h.li=a,h.gj=!0,h):void 0}function O(t,e,n,o){var r,a,s,l,u,c=t.row||0,f=t.column||0,h=t.Eh;if(n.source===i.BangSource)o.push("!");else if(n.source&&!P(t,o,n.source,n.endSource))return void o.push("#","R","E","F","!");if(a=33===(r=n.type),8===r||5===r)o.push(""+n.value);else if(100===r)s="_xlpm.",n.bhc?o.push(s+""+n.value):o.push(""+n.value);else if(n.value&&n._error)o.push(""+n.value);else if(a||n.sf()){if(l=void 0,s=void 0,u=void 0,a&&(s=(l=v[h?0:1]).prefix,u=l.surfix,o.push(s),n.isReferenceError))return o.push("#REF!"),void o.push(u);!n.source&&t.addSheetName&&t.source&&P(t,o,t.source,p),j(t.useR1C1,c,f,n.row,n.column,n.rowRelative,n.columnRelative,o),a&&o.push(u)}else!n.source&&t.addSheetName&&t.source&&P(t,o,t.source,p),F(t.source,t.useR1C1,c,f,n.row,n.column,n.endRow,n.endColumn,n.rowRelative,n.columnRelative,n.endRowRelative,n.endColumnRelative,o,n.tf())}function j(t,n,o,r,a,s,l,u,c){var f,h;if(c=c||0,f=e.maxRowCount-1,(0===c||1===c)&&r>-f&&r<=2*f&&(r=R(r+=s?n:0,f)),h=e.maxColumnCount-1,(0===c||2===c)&&a>-h&&a<=2*h&&(a=R(a+=l?o:0,h)),function(t,e,n,o,r,i,a){return 3===a||n>=0&&o>=0||1===a&&n>=0||2===a&&o>=0}(0,0,r,a,0,0,c))if(t){if(2!==c&&(u.push("R"),r>=0&&(n!==r||!s)&&(s?u.push("["+(r-n)+"]"):(r++,u.push(r+""))),a<0))return;1!==c&&(u.push("C"),o===a&&l||(l?u.push("["+(a-o)+"]"):(a++,u.push(a+""))))}else{if(a>=0&&(l||u.push("$"),u.push.apply(u,I(a))),r<0)return;r++,s||u.push("$"),u.push(r+"")}else u.push(""+i.Errors.Reference)}function F(t,n,o,r,i,a,l,u,c,f,h,p,d,g){3===(g=g||0)&&(i=0,l=t?t.getRowCount():e.maxRowCount-1,g=1),j(n,o,r,i,a,c,f,d,g);var m=s.BAND_INDEX_CONST;(!n||i!==l||a!==u||l!==m&&u!==m)&&(l===m&&u===m||(d.push(":"),j(n,o,r,l,u,h,p,d,g)))}function P(t,e,n,o){if(t.getExternalSourceToken){if(n!==i.BangSource){var r=function(t,e,n){if(!e||0===e.length||_(t,e)||_(t,n))return[];var o,r=e;if(B(e,!1)||n&&B(n,!1)){for(r=["'"],o=0;o<e.length;o++)"'"===e[o]&&r.push("'"),r.push(e[o]);if(n)for(r.push(":"),o=0;o<n.length;o++)"'"===n[o]&&r.push("'"),r.push(n[o]);r.push("'")}else if(n)for(r.push(":"),o=0;o<n.length;o++)r.push(n[o]);return r}(t,t.getExternalSourceToken(n).split(""),o&&t.getExternalSourceToken(o).split(""));if(!(r.length>0))return!1;e.push.apply(e,r)}return e.push("!"),!0}return!1}function _(t,e){if(!e||0===e.length||!t.Eh)return!1;var n="'"===e[0]?1:0;return"["===e[n]&&e.indexOf("]")>n}function L(t,e){var n,o,r;if(!t||0===t.length)return!0;if(!e){if(i.isNumber(t[0]))return!1;if((n=function(t){var e=M(t,!1,0,0);return e.gj||(e=M(t,!0,0,0)),e}(t)).gj&&n.li<=t.length)return!1}for(r=0;r<t.length;r++)if(o=t[r],e){if("*"===o||":"===o||"["===o||"]"===o||"?"===o||"\\"===o||"/"===o)return!1}else if(m[o]||i.operaterTypesMap[o])return!1;return!0}function B(t,e){var n,o,r;return!!i.isDigit(+t[0])||(n=[],o=t,"["===t[0]&&((r=t.lastIndexOf("]"))>0&&(n=t.slice(1,r),o=t.slice(r+1))),!function(t,e){var n,o;if(!t||0===t.length)return!0;for(o=0;o<t.length;o++)if(n=t[o],e){if("*"===n||":"===n||"["===n||"]"===n||"?"===n)return!1;if("'"===n&&(0===o||o>=t.length-1||"'"!==t[o+1]))return!1}else if("'"===n||"["===n||"]"===n||"?"===n||"%"===n||i.operaterTypesMap[n])return!1;return!0}(n)||!L(o,e))}function G(t){var e=new i.Expression(8);return e.value=t,e}function H(t){var e=t;return t&&t.length>=3&&"["===t[0]&&"0"===t[1]&&"]"===t[2]&&(e=3===t.length?"":t.substring(3)),e}function V(t,e,n,o,r){return 0===e.Nc&&0===e.hi||!o&&0===e.Nc&&4===e.hi&&(!r||n<t.length-2&&":"===t[n+1].ni&&0===t[n+2].Nc&&4===t[n+2].hi)}function z(t,e,n,o,r){return e<=t.startRow()&&n<=t.startColumn()&&e+o>t.endRow()&&n+r>t.endColumn()}function W(t,e,n){return t.slice(e,n).join("")}function U(t,e,n,o,r,i){var a,s,l,u,c,f,h=t,d=[],g="",m=!1,y=!1;if(r>1)m=!0,r--,d=e.slice(i,n),":"===(o=e[++n])&&(y="["===(o=e[++n]),g=(s=X(e,n,o,r)).xj,n=s.tj,o=s.uj,r=s.wj);else if("["===o){for(y=!0,o=e[a=n-1];" "===o;)o=e[--a];":"!==o&&J(),d=function(t){for(var e=t.length-1;e>=0&&" "===t[e];)e--;for(;e>=0&&" "!==t[e];)e--;return e>=0?t.slice(e+1,t.length-e-1):t}(d=e.slice(i,a)),g=(s=X(e,n,o=e[n],r)).xj,n=s.tj,o=s.uj,r=s.wj}else h.qj!==p&&16!==h.qj||(m=!0),(a=(l=e.slice(i,n)).indexOf(":"))>0?(d=l.slice(0,a),"["!==(g=l.slice(a+1))[0]&&J()):d=l;if(u=q(h,d,m),g?(c=q(h,g,y),h.rj=4):(c=u,h.rj=2),u>c&&(f=u,u=c,c=f),h.oj=u,h.pj=c,++n<e.length)for(o=e[n];" "===o;)o=e[++n];return{tj:n,uj:o,wj:r}}function q(t,e,n){var o,r,i,a;if(e&&function(t,e){var n,o,r;if(e)return!0;if(n="",n=t[0],o=n,"#"===n||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!1;for(r=1;r<t.length;r++){if(" "===(n=t[r])||","===n||":"===n||"["===n&&"'"!==o||"]"===n&&"'"!==o||"@"===n&&"'"!==o||"#"===n&&"'"!==o)return!1;o=n}return!0}(e,n)){for(o=[],r=0,i=e.length;r<i;r++)"'"===e[r]&&r<i-1&&"'"!==e[r+1]||o.push(e[r]);return e=o,(a=t.lj.getColumnIndexInTable(e.join("")))<0&&J(),a}return-1}function Y(t){var e,n,o=[];for(n=0;n<t.length;n++)"["!==(e=t[n])&&"]"!==e&&"@"!==e&&"#"!==e&&"'"!==e||o.push("'"),o.push(e);return o}function X(t,e,n,o){var r,i,a=!1;if("["===n)for(a=!0,o++,n=t[++e];" "===n;)n=t[++e];for(r=e;"]"!==n&&(","!==n||o>1);)"'"===n&&e++,n=t[++e];return e<=r&&J(),i=t.slice(r,e),o>1&&o--,a||(i=function(t){for(var e,n=0,o=t.length;n<o&&" "===t[n];)n++;for(e=n,n=o-1;n>e&&" "===t[n];)n++;return n>=e?t.slice(e,n+1):t}(i)),{xj:i,tj:e,uj:n,wj:o}}function Z(t){var e,n=i.getMapping()&&i.getMapping().tableFunctionsMapping;if(!l.isNullOrUndefined(n))for(e in n)if(n[e].toLowerCase()===t)return e.toLowerCase();return t}function Q(t,e,n,o){for(var r,i,a,s=14,l=e;"]"!==n;)"'"===n&&e++,n=t[++e];for(r=Z(r=W(t,l,e).toLowerCase().trim()),i=!1,a=0;a<g.length;a++)if(r===g[a]){s=S[r],i=!0;break}if(i||J(),++e>=t.length)o--;else{for(n=t[e];" "===n;)n=t[++e];if(","===n){for(o<=1&&J(),n=t[++e];" "===n;)n=t[++e];for("["===n&&(o++,n=t[++e]);" "===n;)n=t[++e]}o>1&&o--}return{vj:s,tj:e,uj:n,wj:o}}function J(){throw f().Exp_FormulaInvalid}function $(t){return 1===t.Nc&&"ARRAY"===t.ni?1:0===t.Nc&&3===t.hi?(t.HTa||t.ni).length+2:0===t.Nc&&12===t.hi?t.ni.length+3:t.ni.length}function K(t,e,n){var o,r;t&&e&&((r=t[o=e.getName&&e.getName()||"!"])||(r=t[o]=[],t.sheets||(t.sheets=[]),t.sheets.push(o)),r.push(n))}function tt(t,e,n,o,r,a){var s,l,u;if(t){for(;10===t.type;)t=t.value;if(12===t.type&&(t=t.value),t.type>=2&&t.type<=6);else if(1===t.type)s=t.getRange(r,a),!o.source||t.source&&t.source!==o.source||e.push(s),K(n,t.source||o.source,s);else if(13===t.type)s=t.getRange(r,a),t.source===o.source&&s&&e.push(s),K(n,t.source||o.source,s);else if(8===t.type)l=d,t.source?t.source.Cf()&&(l=new i.EvaluateContext(t.source,i.pf(r,a))):l=o,tt(l.getName(t.value),e,n,l,r,a);else if(9===t.type)tt(t.value,e,n,o,r,a),t.value2&&tt(t.value2,e,n,o,r,a);else if(7===t.type)for(u=0;u<t.arguments.length;u++)tt(t.arguments[u],e,n,o,r,a)}}function et(t,e,n,o,r,s,l){var u,c,f,h,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N=p,E=o.yj(),D=o.Cf();for(D?(u=new a.SheetParserContext(o,!l&&D.useR1C1,i.pf(r,s)),N=new i.EvaluateContext(E,i.pf(r,s),!1)):u=new i.ParserContext(d,!1,i.pf(0,0)),u.ignoreError=!0,c=[],h=0;h<e.length;h++)try{if("["===(f=e[h]).ni||"#"===f.Qb[0]||3===f.hi){c.push({text:f.HTa||f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni});continue}if(h=nt(t,u,e,h,g=[]),m=void 0,g.length>0){for(y=0;y<g.length;y++)if((v=g[y])instanceof i.FormulaToken)c.push({text:n.slice(v.mi,v.li+1).join(""),type:v.Nc,subType:v.hi,canDrag:m,ranges:[],value:v.ni});else if(v.Lf){if(b=(C=v.Lf).type,w=C.source,T=n.slice(v.mi,v.li+1).join(""),x=[],S={},m=!0,A=C.getRange&&C.getRange(r,s),8===b)m=!1,N&&(I=N,C.source&&(I=new i.EvaluateContext(C.source,i.pf(r,s),!1)),tt(I.getName(C.value),x,S,N,r,s));else if(13===b)m=!1,w===E&&A?x.push(A):x=null,K(S,w,A);else if(33===b)(w||C.contextSource)===E&&(A||(A=i.getRangeForReference(C,r,s)),x.push(A),w||(w=E)),K(S,w,A);else if(1===b)if(C.endSource)for(R=w,k=C.endSource,M=R.getSources(k),y=0;y<M.length;y++){if(M[y]===E){x.push(A);break}K(S,M[y],A)}else K(S,w||E,A),w&&w!==E||x.push(A);else x=null;x&&x.length>0?c.push({text:T,type:0,subType:7,canDrag:m,ranges:x,value:T,sheetRanges:S}):c.push({text:T,type:f.Nc,subType:f.hi,canDrag:m,ranges:x,value:T,sheetRanges:S})}}else c.push({text:f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni})}catch(t){c.push({text:f.ni,type:f.Nc,subType:f.hi,canDrag:!1,ranges:f.ranges,value:f.ni})}return c}function nt(t,e,n,o,r){var i,a,s,l,u,c,f=n[o];return f&&"function"!=typeof f&&0===f.Nc?(i=[],a=t.resolveToken(e,n,i,o)-1,1===(l=(s=i[0]).type)||13===l||33===l||8===l||5===l&&s.source?(u=n[a],c={mi:f.mi,li:u.li,Lf:s},r.push(c),a):o):o}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("@grapecity/js-calc"),a=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),s=n("./dist/plugins/sheetsCalc/calc.ns.js"),l=n("./node_modules/util/util.js"),u=o.util.xq,c=new r.Common.ResourceManager(o.SR),f=c.getResource.bind(c),i.Errors.Reference,e.maxRowCount=1048576,e.maxColumnCount=16384,h=[1,26,676],p=void 0,d=null,g=["#all","#data","#headers","#totals","#this row"],m={" ":!0,"'":!0,"[":!0,"]":!0,"?":!0,"\\":!0,"%":!0,'"':!0,"(":!0,")":!0,"|":!0,"{":!0,"}":!0,"#":!0,"@":!0,"!":!0,$:!0,"^":!0,"ï¼":!0,"ï¼":!0,".":!0,";":!0},y=[1,10,100,1e3,1e4,1e5,1e6,1e6],v=[{prefix:"ANCHORARRAY(",surfix:")"},{prefix:"",surfix:"#"}],e.jma=L,e.validateSheetName=L,C=function(t){function e(e){var n=t.call(this,8e3)||this;return n.kj=e,n}return A(e,t),e.prototype.resolveToken=function(t,e,n,o){var r,a,u,c,f,h,p,g,m,y,v,C,b,w,T,x,S,A,I=t.useR1C1,R=t.row||0,N=t.column||0,E=n.length,D=n[o],O=D.ni,j=D.Nc,F=D.hi;if(0!==j&&6!==F)return!1;if(0===j&&0===F&&o<E-2&&":"===n[o+1].ni&&12===n[o+2].hi&&n[o+2].ni.indexOf(":")<0||0===j&&12===F){if(f=void 0,h=void 0,O&&(O.indexOf(":")>0?(p=O.indexOf(":"),f=O.substring(1,p-1),h=O.substring(p+1,O.length-2)):("'"===(f=O).charAt(0)&&(f=f.substring(1,f.length-1)),0===F&&("'"===(h=n[o+2].ni).charAt(0)&&(h=h.substring(1,h.length-1))))),o++,c=!!f,(f=H(f))&&(a=(a=O?t.getExternalSource("",f):i.BangSource)||k(f),(h=H(h))&&(u=(u=t.getExternalSource("",h))||k(h),o+=2)),!(D=n[o]))return G(O);O=D.ni}if(g=o===E-1?d:n[o+1],V(n,D,o,I,!0)){if(m=t&&t.source&&t.source.Af&&t.source.Af.allowDynamicArray,!(y=M(D.Qb,I,R,N,m)).gj&&!c)return!1;if(D.hi=7,y.gj&&y.Vka){if(v=y.cj,C=y.dj,b=y.ej,w=y.fj,T=y.CLb,o<E-2&&5===g.Nc&&":"===g.ni&&(V(n,g=n[o+2],o+2,I,!1)&&((x=M(g.Qb,I,R,N)).gj&&v===s.BAND_INDEX_CONST==(x.cj===s.BAND_INDEX_CONST)&&C===s.BAND_INDEX_CONST==(x.dj===s.BAND_INDEX_CONST))))return R=v===s.BAND_INDEX_CONST?0:R,N=C===s.BAND_INDEX_CONST?0:N,{index:o+3,expr:i.uf(a,u,v-(b?R:0),C-(w?N:0),x.cj-(x.ej?R:0),x.dj-(x.fj?N:0),b,w,x.ej,x.fj,R,N)};if(v===s.BAND_INDEX_CONST||C===s.BAND_INDEX_CONST){if(I)return v-=v!==s.BAND_INDEX_CONST&&b?R:0,C-=C!==s.BAND_INDEX_CONST&&w?N:0,{index:o+1,expr:i.uf(a,u,v,C,v,C,b,w,b,w,R,N)};if(!a)return!1;r=G(O)}if(!r)return l.isNullOrUndefined(a)&&(a=function(t,e,n){var o,r,i,a,s=t.source;return s&&(r=s.q$a,i=s.cDc,a=s.dDc,r&&((e>=0&&e<i&&n>=a||e>=i&&n>=0&&n<a)&&(o=s))),o}(t,R,N)),S=v-(b?R:0),A=C-(w?N:0),{index:o+1,expr:r=T?i.BLb(t.source,a,u,S,A,b,w):i.rf(a,u,S,A,b,w)}}else r=G(O)}else if(6===D.hi)(r=new i.Expression(5)).value=i.CalcError.parse(D.ni);else{if(!a)return!1;r=G(O)}return a&&(r.source=a),u&&(r.endSource=u),{index:o+1,expr:r}},e.prototype.unparse=function(t,e,n,o){var r=n&&n.type;return(1===r||8===r||5===r||33===r||100===r)&&(O(t,0,n,o),!0)},e}(i.TokenResolver),e.SheetReferenceResolver=C,function(t){t[t.ThisRow=1]="ThisRow",t[t.Headers=2]="Headers",t[t.Data=3]="Data",t[t.Totals=8]="Totals",t[t.HeadersAndData=6]="HeadersAndData",t[t.DataAndTotals=12]="DataAndTotals",t[t.All=14]="All",t[t.NotSpecific=16]="NotSpecific"}(b=e.StructReferencePortions||(e.StructReferencePortions={})),function(t){t[t.All=1]="All",t[t.NotSpecific=1]="NotSpecific",t[t.SingleColumn=2]="SingleColumn",t[t.ColumnRange=4]="ColumnRange"}(w=e.StructReferenceColumnSpecifier||(e.StructReferenceColumnSpecifier={})),T=function(t){function e(){return t.call(this,13)||this}return A(e,t),e.prototype.tableName=function(){return this.lj.tableName()},Object.defineProperty(e.prototype,"baseTable",{get:function(){return this.lj},set:function(t){this.lj=t,this.source=t.source()},enumerable:!0,configurable:!0}),e.prototype.JUa=function(){this.vzb=this.lj.startColumn()},e.prototype.columnReferenceStart=function(){return this.oj+this.lj.startColumn()},e.prototype.columnReferenceEnd=function(){return this.pj+this.lj.startColumn()},e.prototype.referencePortions=function(){return this.qj},e.prototype.referenceColumnSpecifier=function(){return this.rj},e.prototype.getRange=function(t,e,n){var o,r,a,s,l,u,c,f,h,p,g,m=this,y=m.lj;switch(m.JUa(),c=y.startRow(),f=y.endRow(),h=y.hasTotalsRow(),p=y.hasHeadersRow(),m.qj){case 3:case 16:o=p?c+1:c,a=h?f-1:f;break;case 2:if(p)o=c,a=c;else{if(!n)return d;o=c-1,a=c-1}break;case 8:if(h)o=f,a=f;else{if(!n)return d;o=f+1,a=f+1}break;case 1:o=t,a=t;break;case 6:o=c+(n&&!p?-1:0),a=h?f-1:f;break;case 12:o=p?c+1:c,a=f+(n&&!h?1:0);break;case 14:default:o=c+(n&&!p?-1:0),a=f+(n&&!h?1:0)}return r=m.columnReferenceStart(),s=m.columnReferenceEnd(),g=y.endColumn(),1===m.rj&&(s=g),r>g||s>g?(m._error=!0,d):a<o||!n&&o<c||!n&&a>f?d:(l=a-o+1,u=s-r+1,i.qf(o,r,l,u))},e.prototype.offsetWhenInsertRemoveColumn=function(t,n,o,r){var a,s,l=this,u=l.vzb;return t<u||t===u&&o&&!r||t>l.pj+u?l:(n=o?n:-n,a=t-u,(s=new e).baseTable=l.lj,s.pj=l.pj+n,s.oj=l.oj,t<=u+l.oj&&(s.oj+=n,s.oj<a&&(s.oj=a)),s.rj=l.rj,s.qj=l.qj,s.pj<s.oj?i.Ih:s)},e.prototype.offsetWhenCopy=function(t,e,n,o,r,s,l,u,c,f){var h,p,d,g,m,y=new a.SheetParserContext(e.kj,e.Af.useR1C1,i.pf(n,o)),v=y.getTableByIndex(n,o),C=this.offset();return v&&(h=n-r,p=o-s,d=l-r,g=u-s,m=void 0,t===e?m=y.getTableByIndex(h,p):m=new a.SheetParserContext(t.kj,t.Af.useR1C1,i.pf(h,p)).getTableByIndex(h,p),m!==v&&m===this.lj&&z(m,d,g,c,f)&&z(v,l,u,c,f)&&(C.baseTable=v)),C},e.prototype.Jma=function(t){var n,o=this,r=new e;return r.baseTable=o.lj,r.pj=o.pj,r.oj=o.oj,2===o.rj&&t&&(t%=n=o.lj.endColumn()-o.lj.startColumn()+1,r.oj+=t,r.oj<0&&(r.oj+=n),r.pj=r.oj),r.rj=o.rj,r.qj=o.qj,r},e.prototype.offset=function(t,n,o){var r=this,i=new e;return i.baseTable=r.baseTable,i.qj=r.qj,i.oj=r.oj,i.pj=r.pj,i.rj=r.rj,i},e.prototype.Kma=function(t,e){var n=this.lj;return t>=n.startRow()&&e>=n.startColumn()&&t<=n.endRow()&&e<=n.endColumn()},e.prototype.tzb=function(t,e,n){this.lj.wzb(t,e,n)},e}(i.Expression),e.xzb=T,x=function(t){function e(e){var n=t.call(this,7900)||this;return n.kj=e,n}return A(e,t),e.prototype.resolveToken=function(t,n,o,r){var i,a,s,l=o[r];if(0===l.Nc&&(0===l.hi||7===l.hi))if("]"===(i=l.ni).charAt(i.length-1))try{return a=new T,function(t,e,n){var o,r,i,a,s,l,u,c,f,h=n,p=0,d=e[p],g=function(t,e,n,o){for(var r,i,a,s=e.length;"["!==o&&n<s;)n++,o=e[n];return(a=n)>0?(i=W(e,0,a),r=t.getTableByName(i)):r=t.getTableByIndex(t.row,t.column),{sj:r,tj:n,uj:o}}(t,e,p,d),m=g.sj;for(m||J(),h.baseTable=m,p=g.tj,p++,d=e[p],o=p;" "===d;)p++,d=e[p];for("@"!==d&&"["!==d&&(d=e[p=o]),r=1,i=!1,a=!1,s=e.length;0!==r&&p<s;)if("["===d&&(r++,p++,d=e[p]),"#"===d)i&&r<=1&&J(),l=Q(e,p,d,r),u=l.vj,p=l.tj,d=l.uj,r=l.wj,i?2===h.qj&&3===u||2===u&&3===h.qj?h.qj=6:3===h.qj&&8===u||3===u&&8===h.qj?h.qj=12:J():h.qj=u,i=!0;else if("@"===d){for((r>1||i)&&J(),i=!0,h.qj=1,p++,d=e[p];" "===d;)p++,d=e[p];","===d&&J()}else{for(c=p;"]"!==d&&"["!==d;)if("'"===d&&p++,","===d){for(p++,d=e[p],f=p;" "===d;)p++,d=e[p];if("["===d){p=f,d=",";break}}else p++,d=e[p];if(p>c&&((a||"["===d&&r>1)&&J(),l=U(h,e,p,d,r,c),p=l.tj,d=l.uj,r=l.wj,a=!0),"]"===d){if(0===--r)break;p>=e.length&&J(),p++,d=e[p]}","===d&&(p++,d=e[p])}i||(h.qj=t.DLb?1:16),a||(h.oj=0,h.pj=h.lj.endColumn()-h.lj.startColumn(),h.rj=1)}(t,i.split(""),a),a}catch(t){}else if(s=t.getTableByName&&t.getTableByName(i))return e.create(s);return d},e.prototype.unparse=function(t,e,n,o){var r,a,s,l,u,c,f;return 13===n.type&&(r=n,t.YSa?(a=r.getRange(t.row,t.column,!0),O(t,0,i.uf(r.source,d,a.row,a.col,a.row+a.rowCount-1,a.col+a.colCount-1,!1,!1,!1,!1),o),!0):16===r.qj&&1===r.rj?(o.push(r.lj.tableName()),void(t.Eh&&o.push("[]"))):(l=o.length,t.source===r.lj.source()&&r.Kma(t.row,t.column)&&!t.Eh||o.push(r.lj.tableName()),o.push("["),16!==r.qj&&(u=function(t,e,n){var o=i.getMapping()&&i.getMapping().tableFunctionsMapping,r=i.sR().B2,a=o?o["#All"]:r.All.name,s=o?o["#This row"]:r.thisRow.name,l=o?o["#Headers"]:r.Headers.name,u=o?o["#Data"]:r.Data.name,c=o?o["#Totals"]:r.Totals.name;switch(t){case 1:return n?"["+s+"]":"@";case 2:return e?"["+l+"]":l;case 3:return e?"["+u+"]":u;case 8:return e?"["+c+"]":c;case 6:return"["+l+"], ["+u+"]";case 12:return"["+u+"], ["+c+"]"}return e?"["+a+"]":a}(r.qj,1!==r.rj,t.Eh),o.push(u)),1!==r.rj&&(1===r.qj&&!t.Eh||16===r.qj||o.push(", "),(c=r.lj.getColumnName(r.oj))?c=Y(c.split("")).join(""):s=!0,s||(4===r.rj?(f=r.lj.getColumnName(r.pj))?(f=Y(f.split("")).join(""),o.push("[",c,"]:[",f,"]")):s=!0:1===r.qj&&!t.Eh&&!function(t){var e,n="";if("#"===(n=t[0])||" "===n||"@"===n||" "===n||","===n||":"===n||"["===n||"]"===n)return!0;for(e=1;e<t.length;e++)if(" "===(n=t[e])||","===n||":"===n||"["===n||"]"===n||"@"===n||"#"===n)return!0;return!1}(c)||16===r.qj?o.push(c):o.push("[",c,"]"))),s?(o.length=l,o.push("#REF!")):o.push("]"),!0))},e.create=function(t,e,n,o,r){void 0===e&&(e=b.NotSpecific),void 0===n&&(n=w.NotSpecific),void 0===o&&(o=0),void 0===r&&(r=t.endColumn()-t.startColumn());var i=new T;return i.baseTable=t,i.qj=e,i.oj=o,i.pj=r,i.rj=n,i},e}(i.TokenResolver),e.StructureReferenceResolver=x,S={"#all":14,"#data":3,"#headers":2,"#totals":8,"#this row":1},e.qzb=function(t,e,n,o,r,a,s){var l,u,c;t.setParserOption(a),l=[],u=e.split("");try{c=n.yj().getParserContext(!s&&n.Cf().useR1C1,i.pf(o,r),d),l=t.parseToTokens(c,u,!1)}catch(t){}return l=function(t,e){var n,o,r,a,s,l,u,c,f,h;for(t.unshift(new i.FormulaToken("=",1,0,0,0)),a=[],s=0,r=t.length-1;r>0;r--)t[r].mi===t[r-1].mi&&t[r].ni===t[r-1].ni||(a[s]=t[r],s++);for(a[s]=t[r],a.reverse(),l=[],u=0,c=0;c<a.length-1;c++,u++)o=$(a[c]),l[u]=a[c],a[c+1].mi-a[c].mi-o>0&&(n=new i.FormulaToken(e.slice(a[c].mi+o,a[c+1].mi),7,a[c].mi+o),l[++u]=n);for(l[u]=a[c],o=$(l[u]),l.length>0&&e.length>l[u].mi+o&&(n=new i.FormulaToken(e.slice(l[u].mi+o,e.length),7,l[u].mi+o),l[u+1]=n),f=0;f<l.length;f++)h=l[f].ni.trim(),3===l[f].hi?l[f].ni='"'+l[f].ni+'"':"("===h||"{"===h?(l[f].Nc=1,l[f].hi=1):")"!==h&&"}"!==h||(l[f].Nc=1,l[f].hi=2);return l}(l,u),et(t,l,u,n,o,r,s)}},"./dist/plugins/sheetsCalc/sheetsCalc.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/sheetsCalc/calc.ns.js")),o(n("./dist/plugins/sheetsCalc/parser-sheets.js")),o(n("./dist/plugins/sheetsCalc/calc-spreadjs.js")),o(n("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js")),o(n("./dist/plugins/sheetsCalc/worksheet-formula.js")),n("./dist/plugins/sheetsCalc/workbook-formula.js")},"./dist/plugins/sheetsCalc/workbook-formula.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=n("Common"),a=n("@grapecity/js-calc"),s=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),l=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),u=s.SpreadSource,c=i.Common.u.Nb,f=new i.Common.ResourceManager(o.SR),h=f.getResource.bind(f),p=void 0,i.Common.j.Fa,(d=o.Workbook.prototype).qv=function(t){var e=this,n=e.Wu;e.Wu=new a.CalcService,e.Wu.useR1C1=1===e.options.referenceStyle,e.Wu.allowDynamicArray=e.options.allowDynamicArray,e.Wu.iterativeCalculation=e.options.iterativeCalculation,e.Wu.iterativeCalculationMaximumIterations=e.options.iterativeCalculationMaximumIterations,e.Wu.iterativeCalculationMaximumChange=e.options.iterativeCalculationMaximumChange,t&&n&&e.Wu.cloneFrom(n),e.yv=new u(e),e.zv=e.Wu.getGlobalSourceModel(e.yv)},d.addCustomFunction=function(t){this.Xu(t)},d.Xu=function(t){if(!(t&&t instanceof a.Functions.Function))throw Error(h().Exp_InvalidCustomFunction);this.Su[c(t.name)]=t},d.getCustomFunction=function(t){return t?this.Su[c(t)]:p},d.removeCustomFunction=function(t){t&&(delete this.Su[c(t)],this.iK())},d.clearCustomFunctions=function(){this.Su={}},d.addCustomName=function(t,e,n,o,r){this.Yu(this.Tu,t,e,n,o,!1,r)},d.H$a=function(t){return!this.Tu[c(t)]},d.isValidCustomName=function(t){return t&&o.Ul.G$a(t)&&this.H$a(t)},d.Yu=function(t,e,n,o,r,i,a){var s,u,f,p,d=this;if(!e||!n||!i&&!d.isValidCustomName(e))throw Error(h().Exp_InvalidCustomName);if(d.Wu){if(u=(s=this.getActiveSheet())?s.yj():null,f=void 0,i)try{f=d.Wu.parse(u,n,o,r,!1,!1,!0)}catch(t){}else f=d.Wu.parse(u,n,o,r);t[c(e)]=new l.NameInfo(e,f,o,r,a),i||((p={})[e]=e,this.Zu(p,!0))}},d.getCustomName=function(t){return t?this.Tu[c(t)]:p},d.aJb=function(t){return t?this.QHb[c(t)]:p},d.getCustomNames=function(){var t=[];return o.GC$.each(this.Tu,(function(e,n){t.push(n)})),t},d.ELb=function(){var t=[];return o.GC$.each(this.QHb,(function(e,n){t.push(n)})),t},d.removeCustomName=function(t){if(t){delete this.Tu[c(t)];var e={};e[t]=t,this.Zu(e,!1)}},d.RHb=function(t){if(t){delete this.QHb[c(t)];var e={};e[t]=t,this.Zu(e,!1)}},d.clearCustomNames=function(){var t=this.Tu;this.Tu={},this.Zu(t,!1)},d.FLb=function(){var t=this.QHb;this.QHb={},this.Zu(t,!1)},d.Zu=function(t,e){var n,o;if(t){for(o in n=this.zv,t)n&&n.updateNameCalc(o,e);this.iK()}},d.iK=function(){if(this.Wu&&!this.Wu.IsSuspended()){var t=this.getActiveSheet();t&&(t.suspendPaint(),this.Wu.recalculateAll(),t.resumePaint())}},d.getCalcService=function(){return this.Wu},d.Cf=function(){return this.Wu},d.suspendCalcService=function(t){this.Wu&&this.Wu.suspend(t)},d.resumeCalcService=function(t){this.Wu&&this.Wu.resume(t)},d.getCircularReference=function(){var t,e,n,o=this.chc();for(e in t=[],o=this.dhc(o))Object.prototype.hasOwnProperty.call(o,e)&&(n=e.split("\\"),t.push({row:+n[1],col:+n[2],rowCount:1,colCount:1,sheetName:n[0]}));return t},d.chc=function(){var t={};return this.sheets.forEach((function(e){var n,o,r,i,a,s,l,u=e.Bj(),c=e.getRowCount(),f=e.getColumnCount(),h=e.name();if(u)for(n=0;n<c;n++)for(o=0;o<f;o++)for(r=h+"\\"+n+"\\"+o,i=e.getDependents(n,o),!t[r]&&i.length>0&&(t[r]={from:[],to:[]}),a=0;a<i.length;a++)l=(s=i[a]).sheetName+"\\"+s.row+"\\"+s.col,t[l]||(t[l]={from:[],to:[]}),t[l].from.push(r),t[r].to.push(l)})),t},d.dhc=function(t){var e,n,o;function r(t,e){t.splice(t.indexOf(e),1)}for(e=!0;Object.keys(t).length>0&&e;)for(o in e=!1,n=function(n){if(Object.prototype.hasOwnProperty.call(t,n)){var o=t[n];0===o.from.length?(o.to.forEach((function(e){r(t[e].from,n)})),delete t[n],e=!0):0===o.to.length&&(o.from.forEach((function(e){r(t[e].to,n)})),delete t[n],e=!0)}},t)n(o);return t},o.Workbook.$n("calc",{priority:1e3,init:function(){this.Su={},this.Tu={},this.QHb={}},toJson:function(t){var e,n,r,i,a,s,l,u=this,c=u.Su;o.GC$.isEmptyObject(c)||(t.customFunctions=c),e=[],n=[],r=u.getCustomNames(),i=u.ELb(),a=u.Wu,s=this.getActiveSheet(),l=s?s.yj():null,r&&a&&(o.GC$.each(r,(function(t,n){var o,r=n.getName(),i=n.getRow(),s=n.getColumn(),u=n.getExpression(),c=n.getComment();u&&(o={name:r,formula:a.unparse(l,u,i,s,!1,!0),row:i,col:s},c&&(o.comment=c),e.push(o))})),o.GC$.each(i,(function(t,e){var o,r=e.getName(),i=e.getRow(),s=e.getColumn(),u=e.getExpression(),c=e.getComment();u&&(o={name:r,formula:a.unparse(l,u,i,s,!1,!0),row:i,col:s},c&&(o.comment=c),n.push(o))})),e.length>0&&(t.names=e),n.length>0&&(t.formatStringNames=n))},fromJson:function(t,e,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x=this,S=x.Wu;if(S&&S.suspend(),x.clearCustomNames(),o=t.names)for(i=0;i<o.length;i++)a=o[i],x.Yu(this.Tu,a.name,a.formula,a.row,a.col,!0,a.comment);if(x.FLb(),s=t.formatStringNames)for(i=0;i<s.length;i++)a=s[i],x.Yu(this.QHb,a.name,a.formula,a.row,a.col,!0,a.comment);if(x.clearCustomFunctions(),l=t.customFunctions)for(u in l)l.hasOwnProperty(u)&&(c=l[u],(f=r.getTypeFromString(c.typeName))&&((h=new f).fromJSON(c,e),x.Xu(h)));if(m=[],g=t.sheets){for(v in p=0,g)"string"==typeof v&&(C=g[v],d=x.getSheetFromName(C.name||v),m.push(d),d.nameFunctionsFromJSON(C,e,n),p++);for(y=m.length,p=0;p<y;p++)(d=m[p]).yj().q$a=!0,d.formulaFromJSON(g[d.name()],e,n)}for(S&&(t.noRecalc||n&&n.doNotRecalculateAfterLoad?S.resumeWithoutCalc():S.resume(!0)),b=0,w=m;b<w.length;b++)(T=(d=w[b]).yj()).HIb(),delete T.q$a},egc:function(t,e,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C=this,b=C.Wu;if(b&&b.suspend(),C.clearCustomNames(),o=t.names)for(i=0;i<o.length;i++)a=o[i],C.Yu(this.Tu,a.name,a.formula,a.row,a.col,!0,a.comment);if(C.clearCustomFunctions(),s=t.customFunctions)for(l in s)s.hasOwnProperty(l)&&(u=s[l],(c=r.getTypeFromString(u.typeName))&&((f=new c).fromJSON(u,e),C.Xu(f)));if(d=t.sheets,g=[],d){for(y in h=0,d)"string"==typeof y&&(v=d[y],p=C.getSheetFromName(v.name||y),g.push(p),p.nameFunctionsFromJSON(v,e,n),h++);for(m=g.length,h=0;h<m;h++)(p=g[h]).yj().q$a=!0,p.formulaFromJSON(d[p.name()],e,n)}n.incrementLoadTask.addTask((function(e,o,r){var i,a,s;for(b&&(t.noRecalc||n&&n.doNotRecalculateAfterLoad?b.resumeWithoutCalc():b.resume(!0)),i=0,a=g;i<a.length;i++)(s=(p=a[i]).yj()).HIb(),delete s.q$a}),[b,t,n])}})},"./dist/plugins/sheetsCalc/worksheet-formula.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(t){return t.Cf()}function C(){var t=this;return t.Ru?void(t.Ru=!1):(t.Su={},t.Tu={},t.eDc?t.eDc.clearAll():t.fDc=new s.SheetSource(t,o.SheetArea.colHeader),t.gDc?t.gDc.clearAll():t.hDc=new s.SheetSource(t,o.SheetArea.rowHeader),void(t.et?t.et.clearAll():t.ft=new s.SheetSource(t,o.SheetArea.viewport)))}function b(t,e,n,o,r,i){var a=t.Ms(e,n,o,r,i),s=a&&a.formulas;return s&&s.length>0}function w(t,e,n,o,r,i){var a,s=o.yj(),l=t&&t.formula;l&&(l=l.replace(/ANCHORARRAY\(([A-Z]+[0-9]+)\)/gi,"$1#").replace(/SINGLE\((.*)\)/gi,"@$1").replace(/ANCHORARRAY\((#[A-Z]+[\?!])\)/gi,"$1#"),(a=t.arrayInfo)&&!a.isDynamicArray?o.bv(e,n,m(a.rowCount,10),m(a.colCount,10),l,!0,i):(a&&a.isInvalid&&s.GIb(e,n),o._u(e,n,l,u,!0,i,!0,!a)))}function T(t,e,n,o,r,i,a){var s,l,u,c,f,h,p,d=r&&r.incrementLoadTask;if(d&&!d.isTerminated){for(s=d.isBusyFunc,l=i=i||0,t.suspendPaint(),30,u=new Date;l<n;){if(c=e[l])for(f=0;f<o;f++)w(c[f],l,f,t,0,a);if(l++,s&&s())break;if(new Date-u>30)break}t.resumePaint(),r||(r={}),(h=r&&r.incrementalLoading)&&h.loading&&(h.loadStatus.formulaLoad+=l-i,p=function(t,e){var n=t.formulaLoad/t.total;return e?.4*n+.5:.3*n+.4}(h.loadStatus,r.doNotRecalculateAfterLoad),h.loading(p)),l<n&&r.incrementLoadTask.pushTask(T,[t,e,n,o,r,l])}}function x(t,e,n,r){var i=o.Worksheet._n;i&&f(i,(function(o,i){var a=i.fromJsonAfterFormula;a&&a.call(t,e,n,r)}))}function S(t,e,n,o,r){var i,a,s,l,u,c,h,p;if(t.parent&&t.parent.sheets)for(l=t.parent.sheets,u=t.parent.getCustomNames(),c=t.parent.ELb(),u&&f(u,(function(i,l){a=l.getExpression(),(s=A(null,t,e,n,o,r,a))!==a&&l.fg(s)})),c&&f(c,(function(i,l){a=l.getExpression(),(s=A(null,t,e,n,o,r,a))!==a&&l.fg(s)})),h=function(u){(i=l[u].getCustomNames())&&f(i,(function(i,c){a=c.getExpression(),(s=A(l[u],t,e,n,o,r,a))!==a&&c.fg(s)}))},p=0;p<l.length;p++)h(p);else(i=t.getCustomNames())&&f(i,(function(i,l){a=l.getExpression(),(s=A(t,t,e,n,o,r,a))!==a&&l.fg(s)}))}function A(t,e,n,o,r,i,s){var l,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,I,R,k,M,N,E,D,O,j,F,P,_,L=e.yj(),B=a.Hh(a.Errors.Reference,L);if(9===s.type){if(c=s.value,f=s.value2,h=A(t,e,n,o,r,i,c),p=f&&A(t,e,n,o,r,i,f),c!==h||f!==p)return a.Kh(s.operatorType,h,p)}else if(7===s.type){for(d=!1,g=[],m=void 0,y=0;y<s.arguments.length;y++)v=A(t,e,n,o,r,i,m=s.arguments[y]),d=d||m!==v,g.push(v);if(d)return a.Jh(s,g)}else if(1===s.type&&s.sf()){if(l=s.source||t&&t.yj(),w=C=s.row,T=b=s.column,l&&l===L&&(i&&!s.rowRelative||!i&&!s.columnRelative)){if(i&&r)C+=C>=n?o:0;else if(!i&&r)b+=b>=n?o:0;else if(i){if(C>=n+o)C-=o;else if(C>=n)return B}else if(b>=n+o)b-=o;else if(b>=n)return B;if(C!==w||b!==T)return a.rf(L,u,C,b,s.rowRelative,s.columnRelative)}}else if(1===s.type){if(l=s.source||t&&t.yj(),x=s.row,S=s.column,I=s.endRow,R=s.endColumn,k=s.rowRelative,M=s.columnRelative,N=s.endRowRelative,E=s.endColumnRelative,D=x,O=S,j=I,F=R,l&&l===L){if(i&&r)x+=!k&&x>=n?o:0,I+=!N&&I>=n?o:0;else if(!i&&r)S+=!M&&S>=n?o:0,R+=!E&&R>=n?o:0;else if(i&&!r){if(!k&&x>=n&&!N&&I<n+o)return B;if(k&&N||I<n)return s;if(!k)if(x>=n+o)x-=o;else if(x<n);else{if(N)return B;x>n&&(x=n)}if(!N)if(I>=n+o)I-=o;else{if(k)return B;I<n+o&&(I=n-1)}}else{if(!M&&S>=n&&!E&&R<n+o)return B;if(M&&E||R<n)return s;if(!M)if(S>=n+o)S-=o;else if(S<n);else{if(E)return B;S>n&&(S=n)}if(!E)if(R>=n+o)R-=o;else{if(M)return B;R<n+o&&(R=n-1)}}if(S!==O||R!==F||x!==D||I!==j)return a.uf(L,u,x,S,I,R,k,M,N,E)}}else if(10===s.type){if((P=s.value)!==(_=A(t,e,n,o,r,i,P)))return a.Lh(_)}else 13===s.type&&((l=s.source||t&&t.yj())&&l===L&&!i&&(s=s.offsetWhenInsertRemoveColumn(n,o,r)));return s}function I(t,e){var n,o,r,i,a,s,l,u=e.ah,c=u.getSource(),f=-1,h=-1;e.name?(o=e.name,i=e.id,g(i)?n=u.getNodeByName(o):(n={Lf:e.expression},r=!0)):(f=void 0===(f=e.row)?-1:f,h=void 0===(h=e.column)?-1:h,n=u.getNode(f,h)),a=n.Lf,s=n.Pf,l=t.unparse(c,a,f<0?0:f,h<0?0:h),s&&(!0!==t.allowDynamicArray||!0===t.allowDynamicArray&&!s.isDynamicArray)?f===s.row&&h===s.col&&u.setArrayFormula(s.row,s.col,s.rowCount,s.colCount,l):o?r?u.setFormula(i,o,l):u.setFormulaByName(o,l):u.setFormula(f,h,l,null,!0,!0),n.Lf.ehc=a.ehc}function R(t){var e,n,r,i,s,l,u,c,f,h,p=v(t),d=[p.getSourceModel(t.yj(o.SheetArea.colHeader)),p.getSourceModel(t.yj(o.SheetArea.rowHeader)),p.getSourceModel(t.yj())];for(e=0;e<d.length;e++){if(!(n=d[e]))return;for(r=n.getAllNodes(),i=0;i<r.length;i++)if(s=r[i].calc)for(l=s.Ze,u=void 0,c=0;c<l.length;c++)if(f=s[l[c]])for(h in f)(u=f[h])&&u instanceof a.PathCalc&&I(p,u)}}function k(t,e){var n=t.offset(0,0,!1,0,0);return n.rowRelative=n.endRowRelative=n.columnRelative=n.endColumnRelative=e,n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Core"),i=n("Common"),a=n("@grapecity/js-calc"),s=n("./dist/plugins/sheetsCalc/calc-spreadjs.js"),l=n("./dist/plugins/sheetsCalc/formulaOperatorAdjustor.js"),u=null,c=void 0,f=o.GC$.each,h=i.Common.u.Nb,p=new i.Common.ResourceManager(o.SR),d=p.getResource.bind(p),g=i.Common.j.Fa,m=parseInt,(y=o.Worksheet.prototype).resetCalc=function(){C.call(this),this.Ru=!0},y.recalcAll=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g=v(this);if(g){if(this.suspendPaint(),g.suspend(!0),t)for(void 0,n=(e=this.parent)&&e.sheets||[this],o=0;o<n.length;o++){if(i=(r=n[o]).Tu,a=r.yj(),i)for(s in i)u=(l=i[s]).Lf,c=g.unparse(a,u,0,0),l.Lf=g.parse(a,c,0,0);for(f=a.getCalcSourceModel().getAllNodes(),h=0;h<f.length;h++)(d=(p=f[h]).calc)&&p.Lf&&I(g,d)}g.resume(!0),this.resumePaint()}},y.recalcRange=function(t,e,n,o){var r=v(this);r&&r.recalcRange(this.yj(),t,e,n,o)},y.recalcRows=function(t){var e,n=v(this);if(n&&!n.ignoreDirty()){for(n.suspend(),e=0;e<t.length;e++)n.recalculate(this.ft,t[e],-1);n.resume(!1)}},y.recalcCols=function(t){var e,n=v(this);if(n&&!n.ignoreDirty()){for(n.suspend(),e=0;e<t.length;e++)n.recalculate(this.ft,-1,t[e]);n.resume(!1)}},y.zq=function(t,e,n){var o,r=v(this);r&&!r.ignoreDirty()&&(o=this.ft,1===n?o=this.fDc:2===n&&(o=this.hDc),r.recalculate(o,t,e))},y.getCalcService=function(){return this.Wu||(this.Wu=new a.CalcService,this.yj(o.SheetArea.colHeader).setCalcService(this.Wu),this.yj(o.SheetArea.rowHeader).setCalcService(this.Wu),this.yj().setCalcService(this.Wu),this.Wu.initParserContext(this.yj())),this.Wu},y.Cf=function(){return this.getCalcService()},y.suspendCalcService=function(t){var e=v(this);e&&e.suspend(t)},y.resumeCalcService=function(t){var e=v(this);e&&e.resume(t)},y.yj=function(t){return g(t)||3===t?this.ft:1===t?this.fDc:2===t?this.hDc:u},y.Bj=function(t){var e=this;return 1===t?(!e.eDc&&e.fDc&&(e.eDc=e.Cf().getSourceModel(e.fDc)),e.eDc):2===t?(!e.gDc&&e.hDc&&(e.gDc=e.Cf().getSourceModel(e.hDc)),e.gDc):(!e.et&&e.ft&&(e.et=e.Cf().getSourceModel(e.ft)),e.et)},y.iDc=function(t,e,n,o,r){var i=this.Bj(r);return i&&i.tg(t,e,n,o,!0,!0)},y.Ns=function(t,e,n,o,r,i){var a=this.iDc(t,e,n,o,3);return!a&&r&&(o=this.getColumnCount(2),a=this.iDc(t,0,n,o,2)),!a&&i&&(n=this.getRowCount(1),a=this.iDc(0,e,n,o,1)),a},y.Ms=function(t,e,n,o,r){var i=this.Bj(r);return i&&i.tg(t,e,n,o,!1,!0)},y.Vq=function(t,e,n,o,r,i,a){var s,l;return void 0===r&&(r=!0),s=r&&this.Ns(t,e,n,o,i,a),l=!r&&function(t,e,n,o,r,i,a){var s=b(t,e,n,o,r,3);return!s&&i&&(r=t.getColumnCount(2),s=b(t,e,0,o,r,2)),!s&&a&&(o=t.getRowCount(1),s=b(t,0,n,o,r,1)),s}(this,t,e,n,o,i,a),!s&&!l||(this.Os(4,d().Exp_ChangePartOfArray),!1)},y.addCustomFunction=function(t){this.Xu(t),this.recalcAll()},y.Xu=function(t){if(!(t&&t instanceof a.Functions.Function))throw Error(d().Exp_InvalidCustomFunction);this.Su[h(t.name)]=t},y.getCustomFunction=function(t){return t?this.Su[h(t)]:u},y.removeCustomFunction=function(t){t&&(delete this.Su[h(t)],this.recalcAll())},y.clearCustomFunctions=function(){this.Su={},this.recalcAll()},y.Pu=function(t){var e,n;return t?(this,e=this.parent,!(n=this.getCustomFunction(t))&&e&&e.getCustomFunction&&(n=e.getCustomFunction(t)),n):u},y.addCustomName=function(t,e,n,o,r){this.Yu(t,e,n,o,!1,r)},y.getCustomName=function(t){return t?this.Tu[h(t)]:c},y.getCustomNames=function(){var t=[];return f(this.Tu,(function(e,n){t.push(n)})),t},y.removeCustomName=function(t){var e,n;t&&(e=h(t),delete this.Tu[e],(n={})[e]=e,this.Zu(n,!1))},y.clearCustomNames=function(){var t=this.Tu;this.Tu={},this.Zu(t,!1)},y.createNameInfo=function(t,e,n,o,r){var i,a=v(this),l=this.yj();return a&&l?(i=a.parse(l,e,o,r),new s.NameInfo(t,i,o,r,n)):u},y.H$a=function(t){var e,n=!this.Tu[h(t)];return n&&((e=this.tables)&&(n=!e.findByName(t))),n},y.isValidCustomName=function(t){return t&&o.Ul.G$a(t)&&this.H$a(t)},y.Yu=function(t,e,n,o,r,i){var a,l,u,c,f=this;if(!t||!e||!r&&!f.isValidCustomName(t))throw Error(d().Exp_InvalidCustomName);if(a=v(f),l=f.yj(),a&&l){if(u=void 0,r)try{u=a.parse(l,e,n,o,!1,!1,!0)}catch(t){}else u=a.parse(l,e,n,o);f.Tu[h(t)]=new s.NameInfo(t,u,n,o,i),r||((c={})[t]=t,this.Zu(c,!0))}},y.Zu=function(t,e){var n,o=this.Bj();if(o){for(n in t)o.updateNameCalc(n,e);this.recalcAll()}},y.$u=function(t){var e,n;return t?(this,e=this.parent,!(n=this.getCustomName(t))&&e&&e.getCustomName&&(n=e.getCustomName(t)),n):u},y.setFormula=function(t,e,n,o){this._u(t,e,n,u,!1,o)},y._u=function(t,e,n,o,r,i,a,s,l){var f,h,p,m,y,v,C,b,w=this;return g(i)&&(i=3),t<0||t>=w.getRowCount(i)||e<0||e>=w.getColumnCount(i)?void w.Os(0,d().Exp_IndexOutOfRange):(f=t>=0?t:0,h=e>=0?e:0,p=w.yj(i),o=o||(n&&w.Wu?w.Wu.parse(p,n,f,h,!1,r,r):u),s&&(o.ensureSingle=!0),m=w.tables,void(3===i&&t>=0&&e>=0&&m&&!m.Hma(t,e,1,1,n,o)||(y=w.Bj(i),v=w.conditionalFormats,y&&(C=y.getFormula(t,e),b=w.ITa,y.setFormula(t,e,n,o,r,c,b.dUa(),l),v&&v.Nm(),a||w.Bq("formula",t,e,i,C,n)),w.t4&&w.t4(t,e,1,1,i),w.$p())))},y.setArrayFormula=function(t,e,n,o,r,i){this.bv(t,e,n,o,r,!1,i)},y.bv=function(t,e,n,o,r,i,a,s){var l,u,c,f,h,p,g;if(void 0===a&&(a=3),l=this,t<0||t+n>l.getRowCount()||e<0||e+o>l.getColumnCount())l.Os(0,d().Exp_IndexOutOfRange);else if(l.ITa.MTa(t,e,n,o))l.Os(0,d().Exp_ArrayFormulaSpan);else if(u=l.tables,!(3===a&&t>=0&&e>=0&&u)||u.Hma(t,e,n,o,r)){if(c=l.Bj(a),f=l.conditionalFormats,c&&(l.suspendEvent(),c.setArrayFormula(t,e,n,o,r,i,l.ITa.dUa(),s),l.resumeEvent(),f&&f.Nm(),l.jm<1)){for(h=[],p=t;p<t+n;p++)for(g=e;g<e+o;g++)h.push({row:p,col:g});l.Bu(t,e,n,o,h,5,a,r)}l.$p()}},y.getFormula=function(t,e,n,o){var r=this.Bj(n);return r?r.getFormula(t,e,o):u},y.Ima=function(t,e,n){var o=this.Bj(n);return o?o.Kf(t,e):u},y.getFormulaInformation=function(t,e){var n,r,i,a,s,l={},u=this.Bj();return u&&((n=u.Kf(t,e))?(r=u.Qf(t,e),l.hasFormula=!0,r&&!r.isDynamicArray&&(l.baseRange=new o.Range(r.row,r.col,r.rowCount,r.colCount)),l.isArrayFormula=r&&!r.isDynamicArray,t=r?r.row:t,e=r?r.col:e,l.formula=this.Wu.unparse(this.ft,n,t,e),l.formulaWithCulture=this.Wu.unparse(this.ft,n,t,e,!0),l.hasFormula=!!l.formula):(i=this.ITa.getDynamicArrayInfo(t,e))&&i.isValid&&(a=i.row,s=i.col,t===a&&e===s||(n=u.Kf(a,s),l.formulaWithCulture=this.Wu.unparse(this.ft,n,a,s,!0),l.hasFormula=!0,l.isDynamicArray=!0))),l},y.ngc=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y;for(n||(n=this,o=t,r=e,i=[]),a=n.getDependents(o,r),s=this.name(),l=0;l<a.length;l++){if(i[c=(u=a[l]).sheetName+"_"+u.row+"_"+u.col+"_"+u.rowCount+"_"+u.colCount])return!1;if(i[c]=!0,(u.row<=t&&t<u.row+u.rowCount||-1===u.rowCount)&&(u.col<=e&&e<u.col+u.colCount||-1===u.colCount)&&s===u.sheetName)return!0;for(f=u.sheetName===s?n:n.parent.getSheetFromName(u.sheetName),h=u.rowCount,p=u.row,d=u.colCount,g=u.col,-1===h&&(h=f.getRowCount(),p=0),-1===d&&(d=f.getColumnCount(),g=0),m=p;m<h+p;m++)for(y=g;y<d+g;y++)if(this.ngc(t,e,f,p,g,i))return!0}return!1},y.getPrecedents=function(t,e){var n,o,r,i,a=[],s=this.Bj();return s&&(n=s.Mf(t,e)||s.Kf(t,e),r=(o=this.getFormulaInformation(t,e).baseRange)?o.row:t,i=o?o.col:e,this.VGb(n,r,i,a),a=function(t){var e,n,o,r=[],i=[];for(e=0;e<t.length;e++)o=""+(n=t[e]).row+n.col+n.rowCount+n.colCount+n.sheetName,r.indexOf(o)<0&&(r.push(o),i.push(n));return i}(a)),a},y.getDependents=function(t,e){var n,o,r,i,a,s,l,u=[],c=this.Bj().qg(t,e),f=this.Bj().ug();if(c)for(o in n=c[0])n.hasOwnProperty(o)&&(a=(i=(r=n[o]).ah.xf)?i.kj.name():this.name(),u.push({row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a}));if(f)for(o in s=f[0])s.hasOwnProperty(o)&&((-1===(l=s[o]).row||l.row<=t&&t+1<=l.row+l.rowCount)&&(-1===l.col||l.col<=e&&e+1<=l.col+l.colCount)&&(a=(i=(r=l[0]).ah.xf)?i.kj.name():this.name(),u.push({row:r.row,col:r.column,rowCount:1,colCount:1,sheetName:a})));return u},y.VGb=function(t,e,n,o){var r,i,s,l,u;if(t)switch(t.type){case a.ExpressionType.reference:case a.ExpressionType.structReference:case a.ExpressionType.spillReference:r=t.getRange(e,n),o.push({row:r.row,col:r.col,rowCount:r.rowCount,colCount:r.colCount,sheetName:t.source&&t.source.kj?t.source.kj.name():this.name()});break;case a.ExpressionType.operator:this.VGb(t.value,e,n,o),this.VGb(t.value2,e,n,o);break;case a.ExpressionType.expand:case a.ExpressionType.parentheses:this.VGb(t.value,e,n,o);break;case a.ExpressionType.name:i=this.$u(t.value),this.VGb(i.getExpression(),e,n,o);break;case a.ExpressionType.function:for(s=t.arguments,l=0;l<s.length;l++)u=s[l],this.VGb(u,e,n,o)}},y.hasFormula=function(t,e){var n=this.Bj();return!!n&&n.hasFormula(t,e)},y.dv=function(){var t,e,n,o,r,i=this.Bj();if(i)for(t=0,e=i.rC(),n=i.cC();t<e;){for(o=0;o<n;)(r=i.qg(t,o))&&(r.ng(),r.og()),o++;t++}},y.clearFormula=function(t,e,n,o,r){var i,a,s=this;for(t<0&&(t=0,n=s.getRowCount()),e<0&&(e=0,o=s.getColumnCount()),i=0;i<n;i++)if(r(s,i+t))for(a=0;a<o;a++)s.setFormula(i+t,a+e,u)},y.nameFunctionsFromJSON=function(t,e,n,o){var i,a,s,l,u,c,f,h,p;if(t){if(i=this,a=t.customFunctions)for(s in a)a.hasOwnProperty(s)&&(l=a[s],(u=r.getTypeFromString(l.typeName))&&((c=new u).fromJSON(l,e),i.Xu(c)));if((f=t.names)&&f.length>0){for(h=0;h<f.length;h++)p=f[h],i.Yu(p.name,p.formula,p.row,p.col,!0,p.comment);i.dv()}o&&o()}},y.formulaFromJSON=function(t,e,n){var o,r,i;t&&(o=this,r=n&&n.ignoreFormula,i=n&&n.incrementalLoading,[t.colHeaderData,t.rowHeaderData,t.data].forEach((function(t,e){var a,s,l,u;t&&!r&&t.dataTable&&(a=e+1,s=t.dataTable,l=o.getRowCount(a),u=o.getColumnCount(a),i?T(o,s,l,u,n,0,a):function(t,e,n,o,r){var i,a,s;for(i=0;i<n;i++)if(a=e[i])for(s=0;s<o;s++)w(a[s],i,s,t,0,r)}(o,s,l,u,a))})),i?n.incrementLoadTask.pushTask(x,[o,t,e,n]):x(o,t,e,n))},y.ev=function(t){var e=this,n=e.Wu;n&&!t||(e.Wu=t||new a.CalcService,e.yj(o.SheetArea.colHeader).setCalcService(e.Wu),e.yj(o.SheetArea.rowHeader).setCalcService(e.Wu),e.yj(o.SheetArea.viewport).setCalcService(e.Wu),e.Wu.initParserContext(e.yj()),n?(t.setSourceModel(e.fDc,n.getSourceModel(e.fDc)),t.setSourceModel(e.hDc,n.getSourceModel(e.hDc)),t.setSourceModel(e.ft,n.getSourceModel(e.ft))):(e.eDc=e.Wu.getSourceModel(e.fDc),e.gDc=e.Wu.getSourceModel(e.hDc),e.et=e.Wu.getSourceModel(e.ft)))},y.setCalc=function(t,e){this.Wu=t,this.ft=e||this.ft,this.et=t.getSourceModel(this.ft),this.parent&&(this.parent.Wu=t)},y.fv=function(){this.gv(!1,1)},y.mUa=function(t,e){var n,r,i,a,s,l,u,c,f=this,h=t.changeType,p=t.row,d=t.rowCount,g=t.col,m=t.colCount,y=f.Bj();y&&(r=(n=f.ITa).dUa(),i=v(y),a=y.xf,s=i.ih(),l=i.lh.asyncManager,"addingRows"===h?f.Vq(p,0,0,f.getColumnCount(),void 0,!0,!1)?(u=f.Bj(2),s.onBeforeAddRemoveRows(y,p,u),e||o.clearSpillValuesOnAddRemove(n,p,d,!0,!0),S(f,p,d,!0,!0),[y,u].forEach((function(t){t.addRows(p,d)})),l.addRows(a,p,d)):t.canAdd=!1:"addRows"===h?(i.suspend(),u=f.Bj(2),s.onAfterAddRemoveRows(y,p,d,!0,e,u),i.resume(!1),r&&r.push({type:"addRows",row:p,rowCount:d})):"deletingRows"===h?f.Vq(p,0,d,f.getColumnCount(),void 0,!0,!1)?(u=f.Bj(2),s.onBeforeAddRemoveRows(y,p,u),e||o.clearSpillValuesOnAddRemove(n,p,d,!1,!0),S(f,p,d,!1,!0),[y,u].forEach((function(t){t.deleteRows(p,d)})),l.deleteRows(a,p,d)):t.canDelete=!1:"deleteRows"===h?(i.suspend(),u=f.Bj(2),s.onAfterAddRemoveRows(y,p,d,!1,e,u),i.resume(!1),r&&r.push({type:"deleteRows",row:p,rowCount:d})):"addingColumns"===h?f.Vq(0,g,f.getRowCount(),0,void 0,!1,!0)?(c=f.Bj(1),s.onBeforeAddRemoveColumns(y,g,c),e||o.clearSpillValuesOnAddRemove(n,g,m,!0,!1),S(f,g,m,!0,!1),[y,c].forEach((function(t){t.addColumns(g,m)})),l.addColumns(a,p,d)):t.canAdd=!1:"addColumns"===h?(i.suspend(),c=f.Bj(1),s.onAfterAddRemoveColumns(y,g,m,!0,e,c),i.resume(!1),r&&r.push({type:"addColumns",col:g,colCount:m})):"deletingColumns"===h?f.Vq(0,g,f.getRowCount(),m,void 0,!1,!0)?(c=f.Bj(1),s.onBeforeAddRemoveColumns(y,g,c),e||o.clearSpillValuesOnAddRemove(n,g,m,!1,!1),S(f,g,m,!1,!1),[y,c].forEach((function(t){t.deleteColumns(g,m)})),l.deleteColumns(a,p,d)):t.canDelete=!1:"deleteColumns"===h&&(i.suspend(),c=f.Bj(1),s.onAfterAddRemoveColumns(y,g,m,!1,e,c),i.resume(!1),r&&r.push({type:"deleteColumns",col:g,colCount:m})))},y.nUa=function(t,e,n){var o=n.type,r=this;"addRows"===o?(n.changeType="deletingRows",r.mUa(n,!0),n.changeType="deleteRows",r.mUa(n,!0)):"deleteRows"===o?(n.changeType="addingRows",r.mUa(n,!0),n.changeType="addRows",r.mUa(n,!0)):"addColumns"===o?(n.changeType="deletingColumns",r.mUa(n,!0),n.changeType="deleteColumns",r.mUa(n,!0)):"deleteColumns"===o?(n.changeType="addingColumns",r.mUa(n,!0),n.changeType="addColumns",r.mUa(n,!0)):"customName"===o?n.nameInfo.fg(n.expr):"condition"===o&&n.condition.setExpressions(n.expressions)},y.gUa=function(t){var e,n=v(this),o=this.Bj();for(n.suspend();t.length;)(e=t.pop()).type?this.nUa(n,o,e):o.$Va.apply(o,e);n.resume(!1)},y.getReferenceRange=function(t){var e,n=this.yj(),r=this.getCalcService().evaluate(n,t,0,0,!0);if(r instanceof a.CalcReference&&(e=r.getSource().getName(),r.getRangeCount()>0))return 0,{sheetName:e,range:o.kf(r.getRow(0),r.getColumn(0),r.getRowCount(0),r.getColumnCount(0))}},e.kDc=S,e.vyb=function(t,e,n,o,r,i,a,s,u){l.CalcOperatorAdjustor.copyFormula(t.Bj(),e,n,o.Bj(),r,i,a,s,u)},e.uyb=function t(e,n,o,r,i,s,u,c,f,h){var p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,M,N,E;if(9===h.type){if(p=h.value,d=h.value2,g=t(e,n,o,r,i,s,u,c,f,p),m=d&&t(e,n,o,r,i,s,u,c,f,d),p!==g||d!==m)return a.Kh(h.operatorType,g,m)}else if(7===h.type){for(y=!1,v=[],C=void 0,b=0;b<h.arguments.length;b++)w=t(e,n,o,r,i,s,u,c,f,C=h.arguments[b]),y=y||C!==w,v.push(w);if(y)return a.Jh(h,v)}else if(1===h.type){if(T=!function(t){return t.rowRelative}(h)&&!function(t){return t.columnRelative}(h),x=!function(t){return t.endRowRelative}(h)&&!function(t){return t.endColumnRelative}(h),S=n.yj(),(!h.source||h.source===S)&&T&&x)return A=i.yj(),I=new l.MoveSwapInfo(S,o,r,A,s,u,c,f),R=k(h,!0),(M=l.adjustFormulaOnMoveSwap(S,0,0,R,I,!0))===R?h:1===M.type&&k(M,!1)||M}else if(10===h.type&&(N=h.value)!==(E=t(e,n,o,r,i,s,u,c,f,N)))return a.Lh(E);return h},o.Worksheet.$n("calc",{priority:1e3,init:C,dispose:function(t){var e,n,o,r=this;!1!==t.clearCache&&(r.ft=u,r.hDc=u,r.fDc=u,r.Wu=u,(e=r.et)&&(!0===t.isSheetDestroy?e.eHb():e.rzb(),r.et=u),(n=r.gDc)&&(!0===t.isSheetDestroy?n.eHb():n.rzb(),r.gDc=u),(o=r.eDc)&&(!0===t.isSheetDestroy?o.eHb():o.rzb(),r.eDc=u))},attach:function(t){t instanceof o.Workbook?this.ev(t.Wu):this.ev()},onLayoutChanged:function(t){this.Cf().isAdjustSuspended()||this.mUa(t)},toJson:function(t,e){var n,r,i,a,s=this,l=s.Su;o.GC$.isEmptyObject(l)||(t.customFunctions=l),n=[],r=s.getCustomNames(),i=v(s),r&&i&&(f(r,(function(t,e){var o,r=e.getName(),a=e.getRow(),l=e.getColumn(),u=e.getExpression(),c=e.getComment();u&&(o={name:r,formula:i.unparse(s.yj(),u,a,l,!1,!0,!0),row:a,col:l},c&&(o.comment=c),n.push(o))})),n.length>0&&(t.names=n)),e&&e.ignoreFormula||(a=[s.et,s.eDc,s.gDc],[t.data,t.colHeaderData,t.rowHeaderData].forEach((function(t,e){var n=a[e];n&&n.toJSON({data:t})})))},fromJson:function(t,e,n,o){var r=this;n&&n.incrementalLoading||(r.clearCustomFunctions(),r.clearCustomNames()),o&&(r.nameFunctionsFromJSON(t,e,n),r.formulaFromJSON(t,e,n))},setName:function(t){R(this),v(this.Bj()).lh.asyncManager.changeSourceName(t.oldName,t.newName)},beforeSetName:function(){this.uja&&(this.parent||this).tja()}})},"./dist/plugins/slicer/slicer-actions.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function c(t){if(t.canUndo()){var e=t.kj,n=o.Commands.bWa(e.name()),r=t.VQ[n];return t.Lz(e,!0),e.ITa.undo(r),t.Mz(e,!0),!0}return!1}Object.defineProperty(e,"__esModule",{value:!0}),r=(o=n("Core")).Commands.ActionBase,i=function(t){function e(e,n){return t.call(this,e,n)||this}return u(e,t),e.prototype.canExecute=function(){return!!this.VQ.slicerData},e.prototype.execute=function(){var t,e,n=this,r=n.VQ;return!!n.canExecute()&&((t=n.kj).ITa.startTransaction(),n.Lz(t,!0),r.slicerData.doFilter(r.columnName,{exclusiveRowIndexes:r.newValue}),n.Mz(t,!0),e=o.Commands.bWa(t.name()),n.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.canUndo=function(){return!!this.VQ.slicerData},e.prototype.undo=function(){return c(this)},e}(r),a=function(t){function e(e,n){return t.call(this,e,n)||this}return u(e,t),e.prototype.canExecute=function(){return!!this.VQ.slicerData},e.prototype.execute=function(){var t,e,n=this,r=n.VQ;return!!n.canExecute()&&((t=n.kj).ITa.startTransaction(),n.Lz(t,!0),r.slicerData.doUnfilter(r.columnName),n.Mz(t,!0),e=o.Commands.bWa(t.name()),n.VQ[e]=t.ITa.endTransaction(),!0)},e.prototype.canUndo=function(){return!!this.VQ.slicerData},e.prototype.undo=function(){return c(this)},e}(r),s=function(t){function e(e,n){return t.call(this,e,n)||this}return u(e,t),e.prototype.canExecute=function(){return!!this.VQ.slicer},e.prototype.execute=function(){var t,e=this,n=e.VQ;return!!e.canExecute()&&(t=e.kj,e.Lz(t,!0),n.slicer[n.propertyName](n.newValue),e.Mz(t,!0),!0)},e.prototype.canUndo=function(){return!!this.VQ.slicer},e.prototype.undo=function(){var t,e=this,n=e.VQ;return!!e.canUndo()&&(t=e.kj,e.Lz(t,!0),n.slicer[n.propertyName](n.oldValue),e.Mz(t,!0),!0)},e}(r),l=o.Commands.h4,o.Commands.filterSlicer={canUndo:!0,execute:function(t,e,n){return l(t,i,e,n)}},o.Commands.unfilterSlicer={canUndo:!0,execute:function(t,e,n){return l(t,a,e,n)}},o.Commands.changeSlicerProperty={canUndo:!0,execute:function(t,e,n){return l(t,s,e,n)}},o.Commands.unfilterSlicerByKey={canUndo:!1,execute:function(t,e){var n,r,i,a=o.Commands.bT(t,e),s=a.slicers.UX();if(1===s.length&&(r=(n=s[0]).YX()))return i=r.getFilteredIndexes(n.columnName()),a.wu().execute({cmd:"unfilterSlicer",sheetName:a.name(),slicerData:r,columnName:n.columnName(),value:i})}}},"./dist/plugins/slicer/slicer.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n("./dist/plugins/slicer/slicer.ns.js")),n("./dist/plugins/slicer/slicer-actions.js"),o(n("./dist/plugins/slicer/tableSlicer.js"))},"./dist/plugins/slicer/slicer.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/slicer/slicer.res.en.js");e.SR={en:o}},"./dist/plugins/slicer/slicer.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Blank="(blank)",e.Exp_SlicerNameInvalid="The slicer name is not valid.",e.Exp_SlicerNameExist="The slicer name is already in use; please enter a unique name."},"./dist/plugins/slicer/tableSlicer.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht,Vt,zt,Wt,Ut,qt,Yt,Xt,Zt,Qt,Jt,$t,Kt,te,ee,ne,oe,re,ie,ae,se,le,ue,ce,fe,he,pe,de,ge,me,ye,ve,Ce,be,we,Te,xe,Se,Ae,Ie,Re,ke,Me,Ne,Ee,De,Oe=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();for(Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("FloatingObject"),a=n("Tables"),s=n("ConditionalFormatting"),l=n("./dist/plugins/slicer/slicer.ns.js"),u=new r.Common.ResourceManager(l.SR),c=u.getResource.bind(u),f=r.Common.D,h=r.Common.k,p=o.Ul.Nl,d=o.Ul.Pl,g=o.Ul.Ol,m=h.ac,y=o.Ul.hZa,v=o.GC$.isArray,C=o.GC$.extend,b=document,w=void 0,T=null,x="normal 11pt calibri",S=parseFloat,A=r.Slicers.GeneralSlicerData,function(t){t[t.CONTAINER=0]="CONTAINER",t[t.H_SPACE=1]="H_SPACE",t[t.H_CAPTION=2]="H_CAPTION",t[t.H_SPLITLINE=3]="H_SPLITLINE",t[t.H_CLEARFILTER=4]="H_CLEARFILTER",t[t.B_ITEM=5]="B_ITEM",t[t.B_ITEMSPACER=6]="B_ITEMSPACER",t[t.B_TAIL=7]="B_TAIL",t[t.B_SCROLLBAR=8]="B_SCROLLBAR"}(I||(I={})),function(t){t[t.HOVERED=1]="HOVERED",t[t.SELECTED=2]="SELECTED",t[t.UNSELECTED=4]="UNSELECTED",t[t.HASDATA=8]="HASDATA",t[t.NODATA=16]="NODATA"}(R||(R={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ACTIVE=1]="ACTIVE",t[t.HOVERED=2]="HOVERED"}(k||(k={})),N="name",E="style",D="light",O="dark",j="white",F="black",P="solid",_="color",L="background-color",B="width",G="height",H="font","setBorders",V="back"+(M={GLb:"Style",HLb:"Color",ILb:"Width",JLb:"border",KLb:"WithDataStyle",LLb:"WithNoDataStyle",MLb:"electedItem",NLb:"hovered",OLb:"top",PLb:"gc-slicer-",QLb:"container",RLb:"header",SLb:"clearfilter",TLb:"body",ULb:"itemscontainer",VLb:"item"}).HLb,z="fore"+M.HLb,W=M.JLb+"Width",U=M.JLb+M.GLb,q=M.JLb+M.HLb,Y=M.JLb+"Left",X=M.JLb+"Top",Z=M.JLb+"Right",Q=M.JLb+"Bottom",J="textDecoration",$="wholeSlicer"+M.GLb,K="header"+M.GLb,tt="s"+M.MLb+M.KLb,et="s"+M.MLb+M.LLb,nt="unS"+M.MLb+M.KLb,ot="unS"+M.MLb+M.LLb,rt=M.NLb+"S"+M.MLb+M.KLb,it=M.NLb+"S"+M.MLb+M.LLb,at=M.NLb+"UnS"+M.MLb+M.KLb,st=M.NLb+"UnS"+M.MLb+M.LLb,lt="undoFilter",ut="undoAdd",ct="undoRemove",ft="undoUpdateTableSlicer",ht="div",pt="px",dt="default",gt="cursor",mt="position",yt="absolute",vt="padding",Ct="margin-"+M.OLb,bt="left",wt="right",Tt="text-align",xt="overflow",St="hidden",At="auto",It="text-overflow",Rt="ellipsis",kt="white-space","nowrap",Mt="unselectable",Nt="on",Et="font-weight",Dt="font-size",Ot="border-radius",jt="box-sizing",Ft="content-box","button","â",Pt="mark",_t="itemValue",Lt="Accent ",Bt="Slicer"+M.GLb,Gt="#999999",Ht="#828282",Vt="#CCCCCC",zt=M.PLb+M.QLb,Wt=M.PLb+M.RLb,Ut=M.PLb+"header-borderDiv",qt=M.PLb+"caption",Yt=M.PLb+M.SLb,Xt=M.PLb+M.TLb,Zt=M.PLb+"table",Qt=M.PLb+"tr",Jt=M.PLb+"td1",$t=M.PLb+"td2",Kt=M.PLb+M.ULb,te=M.PLb+M.VLb,ee="gc-no-user-select",ne=function(){function t(e,n,o,r,i,a,s,l){for(var u=0,c=m(t.properties);u<c;u++)this[t.properties[u]](arguments[u])}return t.prototype.setBorders=function(t){this[Y](t)[X](t)[Z](t)[Q](t)},t.prototype.fromJSON=function(e){if(e&&!o.GC$.isEmptyObject(e)){var n=this;t.properties.forEach((function(t){var o,r=e[t];g(r)&&(t.indexOf(M.JLb)>=0?((o=Fe()).fromJSON(r),n[t](o,!1)):n[t](r,!1))}))}},t.prototype.toJSON=function(){var e=this,n={};return t.properties.forEach((function(t){var o=e[t]();e[t].isDefault(o)||(n[t]=o&&o.toJSON?o.toJSON():o)})),n},t.properties=[V,z,H,Y,X,Z,Q,J],t}(),e.SlicerStyleInfo=ne,oe=0,re=m(ne.properties);oe<re;oe++)ne.prototype[ne.properties[oe]]=d(ne.properties[oe]);function je(t){var e,n;return t&&0!==m(t)?0===t.indexOf(D)?(n=parseInt(t.replace(D,""),10),e=fe[D+n]()):0===t.indexOf(O)?(n=parseInt(t.replace(O,""),10),e=fe[O+n]()):fe[t]&&(e=fe[t]()):e=new ne,e}for(ie=function(){function t(e,n,o){for(var r=0;r<t.properties.length;r++)this[t.properties[r]](arguments[r])}return t.prototype.fromJSON=function(e){var n,r;if(e&&!o.GC$.isEmptyObject(e))for(n=0;n<t.properties.length;n++)r=t.properties[n],g(e[r])&&this[r](e[r],!1)},t.prototype.toJSON=function(){var e,n,o,r={};for(e=0;e<t.properties.length;e++)r[t.properties[e]]=this[t.properties[e]]();for(o in n={},r)r[o]!==w&&r[o]!==T&&(n[o]=r[o]);return n},t.properties=[W,U,q],t}(),e.SlicerBorder=ie,ae=function(t,e,n){return d(t,e,n,(function(e){var n=typeof e;return t===W?"number"===n&&e>=0:"string"===n}))},oe=0;oe<ie.properties.length;oe++)ie.prototype[ie.properties[oe]]=ae(ie.properties[oe],w,w);function Fe(t,e,n){return new ie(t,e,n)}function Pe(t){var e=0;return t.indexOf(Bt+"Light")>-1&&17===m(t)&&(e=parseInt(t[16],10)),t.indexOf(Bt+"Dark")>-1&&16===m(t)&&(e=parseInt(t[15],10)),e>=1&&e<=6}for(se=function(){function t(){this[N]("",!1),this[$](function(){var t=new ie(0,"",""),e=new ne(j,F,x);return e.setBorders(t),e}(),!1)}return t.prototype.fromJSON=function(e){var n,r,i,a;if(e&&!o.GC$.isEmptyObject(e))return n=this,r=e.name,g(r)&&(n.name(r),Pe(r))?(i=r.toLocaleLowerCase().replace("slicerstyle","").replace(" ",""),a=je(i),void t.properties.forEach((function(t){n[t](a[t](),!1)}))):void t.properties.forEach((function(t){var o,r=e[t];t!==N&&g(r)&&((o=je()).fromJSON(r),n[t](o,!1))}))},t.prototype.toJSON=function(){var t,e,n,r=this;for(n in e={},t=Pe(r.name())?{name:r.name()}:r.toJSONInternal())t[n]===T||t[n]===w||o.GC$.isEmptyObject(t[n])||(e[n]=t[n]);return e},t.prototype.toJSONInternal=function(){var e,n,o,r=this,i={};for(i[N]=r.name(),e=1,n=m(t.properties);e<n;e++)i[o=t.properties[e]]=r[o]()?r[o]().toJSON():T;return i},t.properties=[N,$,K,tt,et,nt,ot,rt,it,at,st],t}(),e.SlicerStyle=se,le=function(t,e,n,o){return d(t,e,n,o)},oe=1,ue=m(se.properties);oe<ue;oe++)se.prototype[se.properties[oe]]=le(se.properties[oe]);function _e(){return new se}function Le(t,e,n){var o=je();return o[z](t)[V](e).setBorders(n),o}function Be(t){var e=Lt+t;return ce("Light",t,x,j,Fe(1,P,e),Fe(0,"",""),Fe(1,P,e),F,e+",Lighter 60%",Fe(1,P,Gt),Ht,e+",Lighter 80%",Fe(1,P,Vt),F,j,Fe(1,P,Vt),Ht,j,Fe(1,P,"#E0E0E0"),F,"#F9E36F",Fe(1,P,Gt))}function Ge(t){var e=Lt+t,n=",Lighter 60%";return ce("Dark",t,x,j,Fe(1,P,e),Fe(0,"",""),Fe(1,P,e),j,e,Fe(1,P,e),e+",Darker 25%",e+n,Fe(1,P,e+n),F,"#C0C0C0",Fe(1,P,"#C0C0C0"),"#959595","#DFDFDF",Fe(1,P,"#DFDFDF"),F,"#F9E36F",Fe(1,P,Gt))}for(se.prototype.name=le(N,""),ce=function(t,e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w){var T,x,S=_e(),A=Bt+t+e;return S[N](A),(T=je()).font(n),T.backColor(o),T.setBorders(r),S.wholeSlicerStyle(T),(x=je()).borderLeft(i),x.borderTop(i),x.borderRight(i),x.borderBottom(a),S.headerStyle(x),S[tt](Le(s,l,u)),S[et](Le(c,f,h)),S[nt](Le(p,d,g)),S[ot](Le(m,y,v)),function(t,e){t[rt](e)[it](e)[at](e)[st](e)}(S,Le(C,b,w)),S},fe=function(){},e.SlicerStyles=fe,he=1;he<=6;he++)fe["light"+he]=function(t){return function(){return Be(t)}}(he),fe["dark"+he]=function(t){return function(){return Ge(t)}}(he);function He(t,e){var n,o,r,i,a,s=t.KW,l=t._caption,u=Ue(t.slicerData),c=t.zoomFactor();if(e)for(a in e[$]&&(Ye(t.xo,e[$],u,l,c),pn(t,M.QLb)),n=t.LW,o=ze(e[$],e[K]),function(t){var e,n=t[K];return!n||!(n[Y]||n[X]||n[Z]||n[Z])||!(!((e=ze(t[$],n))[Q]&&e[Q][W]>0)||e[Y]&&0!==e[Y][W]||e[X]&&0!==e[X][W]||e[Z]&&0!==e[Z][W])}(e)?(i=(r=o[Q])&&r[W]||0,n[E][G]=(t.MW-i)*Xe(e)*c+pt,qe(n,r,u,Q),o[Y]=o[X]=o[Z]=o[Q]=T):(n[E][Q+B]=0+pt,n[E][G]=s[E][G]),Ye(s,o,u,l,c),pn(t,M.RLb),t.NW)f(t.NW,a)&&cn(t,parseInt(a,10))}function Ve(t,e,n){var r,i,a={};if(e&&n&&m(e)===m(n)){for(r=0,i=m(e);r<i;r++)a[e[r]]=n[r];o.GC$(t).css(a)}}function ze(t,e){var n,o={};if(e)for(n in e)f(e,n)&&(o[n]=e[n]);if(t)for(n in t)o[n]===w&&t[n]!==w&&(o[n]=t[n]);return o}function We(t,e){return e?(t&&e.getColor&&(n=e.getColor(t)),n):t;var n}function Ue(t){var e=t&&t.OW&&t.OW();return e&&e.currentTheme()}function qe(t,e,n,o){if(t){var r=e&&e[W]||0,i=e&&e[U]||"",a=e&&e[q]||"";t[E][o+M.ILb]=r+pt,t[E][o+M.GLb]=i,t[E][o+M.HLb]=We(a,n)}}function Ye(t,e,n,i,a){var s,l,u,c;t&&e&&(s=e[z]||F,l=e[V]||j,u=e[H]||x,t[E][L]=We(l,n),t[E][_]=We(s,n),t[E][H]=y(o.To.No(u,a)[H]),qe(t,e[Y],n,Y),qe(t,e[X],n,X),qe(t,e[Z],n,Z),qe(t,e[Q],n,Q),c=o.To.So(e[J]),r.Common.u.Bb(t.className,Wt)?i[E][J]=c:r.Common.u.Bb(t.className,te)&&(t[E][J]=c))}function Xe(t){var e,n,r,i,a,s,l,u,c;return t?(e=ze(t[$],t[K]))&&e[H]?(n=e[H],r=1,s=(i=o.To.Ko)((a=o.To.Jo)(x)).fontSize,l=i(a(n)).fontSize,s&&l&&(u=S(s),c=S(l),isNaN(c)||(r=c/u)),r):1:1}function Ze(t){var e,n,o,r,i,a=0,s=0;return t&&(n=(e=t[E])[Y+M.ILb],o=e[X+M.ILb],r=e[Z+M.ILb],i=e[Q+M.ILb],n&&(a+=S(n)),o&&(s+=S(o)),r&&(a+=S(r)),i&&(s+=S(i))),{widthOffset:a,heightOffset:s}}function Qe(t){var e,n,o=[];if(t)for(n=0;n<m(t);n++)e=t[n]===w||t[n]===T||""===t[n]?c().Blank:t[n]+"",o.push(e);return o}function Je(t){var e=p(ht);return Ve(e,[mt,vt,jt,xt],[yt,6*t.zoomFactor(),Ft,St]),o.GC$(e).addClass(zt),pn(t,M.QLb),o.GC$(e).append(function(t){var e,n,r,i,a,s,l,u,c=p(ht),f=p(ht),h=p("span"),d=p(ht),g=t.zoomFactor(),m=t.style();return Ve(c,[B,mt,M.OLb,bt,wt,jt,xt],[At,yt,0,0,0,Ft,St]),o.GC$(c).addClass(Wt),t.KW=c,e=t.PW*g,Ve(f,[B,mt,bt,wt,jt,xt],[At,yt,e,e,Ft,St]),o.GC$(f).addClass(Ut),t.LW=f,o.GC$(c).append(f),n=t.QW*Xe(m)*g,r=Ke(t)*g,Ve(h,[jt,mt,M.OLb,xt,B,It,kt],[Ft,yt,n,St,r,Rt,"nowrap"]),o.GC$(h).text(t.captionName()).attr(Mt,Nt).addClass(qt+" "+ee),t._caption=h,i=t.RW*g,a=t.SW*g,s=t.TW*Xe(m)*g,l=t.UW*g,u=t.VW*g+pt,Ve(d,[B,G,gt,mt,M.OLb,wt,Tt,jt,Et,Ot,xt,Dt],[i,a,dt,yt,s,l,"center",Ft,"normal",2,St,u]),o.GC$(d).attr("title","Clear Filter (Alt+C)").attr(Mt,Nt).text("â").addClass(Yt+" "+ee),t.WW=d,pn(t,M.RLb),o.GC$(f).append(h).append(d),c}(t)).append(function(t){var e,n=p(ht),r=p("table"),i=p("tr"),a=p("td"),s=p("td"),l=(t.MW-t.PW+t.XW)*Xe(t.style())*t.zoomFactor();return Ve(n,[B,xt,Ct,jt],[At,St,l,Ft]),o.GC$(n).attr(Mt,Nt).addClass(Xt+" "+ee),t.YW=n,Ve(r,[jt,"border-spacing"],[Ft,0+pt]),o.GC$(r).attr(Mt,Nt).addClass(Zt+" "+ee),t.ZW=r,o.GC$(i).css(jt,Ft).addClass(Qt),t.$W=i,Ve(a,[vt,jt],[0,Ft]),o.GC$(a).addClass(Jt),t._W=a,Ve(s,[vt,jt,gt],[0,Ft,dt]),o.GC$(s).addClass($t),t.aX=s,o.GC$(a).append(function(t){var e,n,r,i,a,s,l,u=p(ht),c=t.zoomFactor();for(t.cX=u,n=tn(t),t.dX=n,e=en(t),t.eX=e,Ve(u,[B,G,Dt],[e*c,n*c,t.VW*c+pt]),o.GC$(u).attr(Mt,Nt).addClass(Kt+" "+ee),r=on(t),t.fX=r,i=Math.min(nn(t),m(r)),a=0;a<i;a++)s=r[a],l=$e(t,s,a),o.GC$(u).append(l),t._items.push(l),t.NW[t.gX.indexOf(s)]=l;return u}(t)),e=rn(t),o.GC$(s).append(e),t.bX=e,o.GC$(i).append(a).append(s),o.GC$(r).append(i),o.GC$(n).append(r),n}(t)),e}function $e(t,e,n){var r,i,a=e,s=p("button"),l=t.zoomFactor(),u=t.hX*l+pt;return Ve(s,[Tt,kt,Ct,gt,jt,Ot,vt,xt,It,L],[bt,"nowrap",u,dt,Ft,5,"1px 6px",St,Rt,j]),o.GC$(s).attr("type","button").attr(Mt,Nt).text(a).addClass(te+" "+ee),(r=t.slicerData.kj)&&(i=r.parent),i&&i.options.enableAccessibility&&o.GC$(s).attr("tabindex",-1),(n+1)%t.columnCount()!=0&&o.GC$(s).css("margin-right",t.hX*l+pt),pn(t,M.VLb,s),s}function Ke(t){var e,n,o=t.xo,r=t.KW,i=1,a=1,s=0,l=0,u=function(t){return t?S(t):0},c=M.JLb+"Left"+M.ILb,f=M.JLb+"Right"+M.ILb;return o&&(i=u((e=o.style)[c]),a=u(e[f])),r&&(s=u((n=r.style)[c]),l=u(n[f])),t.width()-(i+a)-2*t.PW-(s+l)-t.RW}function tn(t){var e=Ze(t.xo),n=t.height()-2*t.PW-e.heightOffset;return t.showHeader()?n-t.MW*Xe(t.style())-t.XW:n}function en(t){var e=Ze(t.xo),n=t.width()-2*t.PW-e.widthOffset-1;return t.iX()?n-t.jX:n}function nn(t){return Math.ceil(t.dX/(t.itemHeight()+2*(t.kX+t.lX)+t.hX))*t.columnCount()}function on(t){var e,n,o,r,i,a,s=t.gX,l=t.mX(s.slice(0),t.sortState()),u=t.slicerData.getFilteredOutIndexes(t.columnName,2);if(t.showNoDataItems()){if(t.visuallyNoDataItems()&&t.showNoDataItemsInLast()){for(e=[],o=m(l),r=void 0,i=void 0,r=0;r<o;r++)i=l[r],h.Bb(u,s.indexOf(i))||e.push(i);for(r=0;r<o;r++)i=l[r],h.Bb(u,s.indexOf(i))&&e.push(i);l=e}}else for(e=l.concat(),n=0;n<m(e);n++)h.Bb(u,s.indexOf(e[n]))&&h.Fb(l,e[n]);return a=c().Blank,h.Bb(l,a)&&(h.Fb(l,a),l.push(a)),l}function rn(t){var e,n=new o.hv(!1);return t.nX=n,e=n.Bv(),o.GC$(e).bind("scroll.gcScrollbar",(function(e,n){var o=n.scrollEventType,r=n.scrollOrientation;e.data=t,1===r&&([0,1,2,3,5].indexOf(o)>=0&&t.Bw(e,n))})),e}function an(t){var e=t.slicerData;t.data=e.getData(t.columnName),t.exclusiveDatas=e.getExclusiveData(t.columnName),t.oX=Qe(t.data),t.gX=Qe(t.exclusiveDatas),t.fX=on(t),hn(t),un(t)}function sn(t,e){var n,r=t.style(),i=t.xo;i&&(e!==w&&e!==t.zoomFactor()&&(t.zoomFactor(e),He(t,r)),o.GC$(i).css(vt,6*e),pn(t,M.QLb),function(t){var e,n,r,i,a,s,l,u,c,f,h=t.zoomFactor(),p=t.KW,d=t.YW,g=t._caption,y=t.WW,v=t.style();t.showHeader()?(t.xo.firstChild!==p&&(o.GC$(p).insertBefore(d),o.GC$(d).css(Ct,(t.MW+t.XW)*Xe(v)*h)),o.GC$(p).css(G,t.MW*Xe(v)*h),e=t.PW*h,Ve(t.LW,[bt,wt],[e,e]),g.innerHTML!==t.captionName()&&o.GC$(g).text(t.captionName()),n=t.QW*Xe(v)*h,r=Ke(t)*h,Ve(g,[M.OLb,B,Et],[n,r,"bold"]),i=t.pX,a=i&&m(i)>0?1:0,vn(t,a),s=t.RW*h,l=s,u=t.TW*Xe(v)*h,c=t.UW*h,f=t.VW*h+pt,Ve(y,[B,G,M.OLb,wt,Dt],[s,l,u,c,f]),pn(t,M.RLb)):o.GC$(p).remove()}(t),n=t.showHeader()?(t.MW+t.XW-t.PW)*Xe(r)*e:0,o.GC$(t.YW).css(Ct,n),ln(t),hn(t))}function ln(t){var e,n=t.zoomFactor(),o=tn(t);t.dX=o,e=en(t),t.eX=e,Ve(t.cX,[B,G,Dt],[e*n,o*n,t.VW*n]),un(t)}function un(t){var e,n,r,i,a,s,l,u,c=t.fX;if(c){for((e=t._items)&&m(e)>0&&o.GC$(e).remove(),t._items=[],e=t._items,t.NW={},n=Math.min(nn(t),m(c)),r=t.iX()?t.nX.value()*t.columnCount():0,i=Math.min(r+n,m(c)),a=r;a<i;a++)l=$e(t,s=c[a],a),o.GC$(t.cX).append(l),e.push(l),t.NW[t.gX.indexOf(s)]=l;if(0!==m(e))for(u in t.NW)f(t.NW,u)&&cn(t,parseInt(u,10))}}function cn(t,e){var n=t.qX,o=n?t.gX.indexOf(n[_t]):-1,r=t.pX,i=t.rX,a=t.NW[e],s=0;e===o&&(s|=1),s|=h.Bb(r,e)?4:2,s|=h.Bb(i,e)&&t.visuallyNoDataItems()?16:8,fn(t,a,s)}function fn(t,e,n){var o,r=t.style();if(e&&r){switch(n){case 10:o=tt;break;case 18:o=et;break;case 12:o=nt;break;case 20:o=ot;break;case 11:o=rt;break;case 19:o=it;break;case 13:o=at;break;case 21:o=st}Ye(e,ze(r[$],r[o]),Ue(t.slicerData),t._caption,t.zoomFactor()),pn(t,M.VLb,e)}}function hn(t){var e,n,r,i,a,s=t.bX,l=t.aX;t.iX()?(s||(s=rn(t)),l.firstChild!==s&&(o.GC$(l).append(s),ln(t)),e=t.zoomFactor(),n=t.dX,r=Math.floor(n/(t.itemHeight()+2*t.kX+t.hX)),(i=t.nX).value(t.sX),i.Vo(t.jX*e,!1),i._v(n*e,!1),i.bw(0),i.cw(Math.ceil(m(t.gX)/t.columnCount())-r),i.dw(r),i.qB(1),i.rB(r-1),i.ew()):(l.firstChild===s&&((a=s.parentElement)&&a.removeChild(s),ln(t)),t.sX=0)}function pn(t,e,n){var r,i,a,s,l,u,c,f,h,p,d=t.zoomFactor();switch(e){case M.QLb:l=Ze(s=t.xo),u=t.PW,r=(t.width()-2*u)*d-l.widthOffset,i=(t.height()-2*u)*d-l.heightOffset,a=s;break;case M.RLb:f=Ze(c=t.KW),h=t.MW*Xe(t.style())*d-f.heightOffset,o.GC$(c).css(G,h),r=t.RW*d,i=t.SW*d,a=t.WW;break;case M.VLb:p=Ze(n),r=function(t,e){var n=t.columnCount();return(e-(n-1)*t.hX)/n}(t,t.eX)*d-2*t.tX-p.widthOffset,i=t.itemHeight()*d-p.heightOffset,a=n}Ve(a,[B,G],[r,i])}function dn(t){var e=t.xo,n=".slicer",r="mouse",i="wheel",a="DOMMouseScroll";e&&(o.GC$(e).bind(r+"down"+n,(function(e){t.AD(e)})).bind(r+"move"+n,(function(e){t.BD(e)})).bind(r+"out"+n,(function(e){t.uX()})),e.addEventListener(r+i,(function(e){t.Rw(e)}),!1),e.addEventListener(a,(function(e){t.Rw(e)}),!1),o.GC$(b).bind(r+"up"+n,(function(e){!function(t,e){var n=t.qX;t.CD(e),n=n?new me(n[Pt],n[_t]):T,t.qX=T,Cn(t,n)}(t,e)})).bind("keydown"+n,(function(e){t.nm(e)})).bind("keyup"+n,(function(e){t.om(e)})),b.addEventListener(r+i,(function(e){t.Rw(e)}),!1),b.addEventListener(a,(function(e){t.Rw(e)}),!1))}function gn(t){var e,n,o,r,i,a=t._items;if(a&&0!==m(a))for(e=t.rX,n=0,o=m(a);n<o;n++)r=a[n],i=t.gX.indexOf(a[n].innerHTML),fn(t,r,h.Bb(e,i)?20:12)}function mn(t,e){var n,o,r=t.gX;if(r)for(n=0,o=m(r);n<o;n++)if(r[n]===e)return n;return-1}function yn(t,e){var n,o,r=t.pX,i=t.rX;for(n=0;n<m(e);n++)o=0,o|=t.yX?h.Bb(r,e[n])?2:4:2,o|=h.Bb(i,e[n])&&t.visuallyNoDataItems()?16:8,fn(t,t.NW[e[n]],o)}function vn(t,e){var n,r,i,a=t.WW;if(a)switch(n=t.style(),r=ze(n[$],n[K]),i=r&&r[V],i||(i=j),t.zX=i,e){case 0:t.AX=!1,Ve(a,[_,L],[t.BX,i]);break;case 1:t.AX=!0,Ve(a,[_,L],[t.CX,i]);break;case 2:o.GC$(a).css(L,t.DX)}}function Cn(t,e){var n,o;if(e)switch(n=t.vX,e[Pt]){case 4:if(!t.WW)return;t.AX?vn(t,1):vn(t,0);break;case 5:o=t.gX.indexOf(e[_t]),n&&h.Bb(n,o)?yn(t,n):cn(t,o)}}function bn(t,e){var n,o,r=t._items;if(r&&e!==T)for(n=0;n<m(r);n++)if((o=r[n]).innerHTML.toLowerCase()===e.toLowerCase())return o;return T}function wn(t,e){var n,o,r,i,a,s,l,u,c,f,h,p=Tn(t,M.QLb),d=T,g=T;if(!p)return T;if(n=e.pageX,o=e.pageY,r=Tn(t,M.RLb),i=Tn(t,M.SLb),a=Tn(t,M.TLb),s=Tn(t,M.ULb),r&&r.contains(n,o))d=i&&i.contains(n,o)?4:1;else if(a&&a.contains(n,o))if(l=t._items,s&&s.contains(n,o)&&l){for(u=void 0,u=0;u<m(l);u++)if((c=Tn(t,M.VLb,u))&&c.contains(n,o)){for(f in d=5,t.NW)if(t.NW[f]===l[u]){g=t.gX[f];break}break}u>=m(l)&&(d=(h=Tn(t,M.VLb,m(l)-1))&&o<h.y+t.itemHeight()*t.zoomFactor()?6:7)}else d=8;else d=0;return new me(d,g)}function Tn(t,e,n){var r,i,a,s,l,u,c,f,h,p,d=e===M.QLb?w:Tn(t,M.QLb),g=t.xo,y=t.EX,v=t.PW,C=t.zoomFactor(),b=t.style(),x=t.showHeader(),S=t.MW,A=t.RW,I=t.gX;switch(e){case M.QLb:r=0,i=0,a=g.offsetWidth,s=g.offsetHeight;do{r+=g.offsetLeft,i+=g.offsetTop,g=g.offsetParent}while(g);break;case M.RLb:if(!d||!x)return T;r=d.x+y*C,i=d.y+y*C,a=t.width()*C,s=S*Xe(b)*C;break;case M.SLb:if(!d||!x)return T;r=d.x+d.width-(y+v+A)*C,i=d.y+y+t.QW*Xe(b)*C,a=A*C,s=t.SW*C;break;case M.TLb:if(!d)return T;l=y+v,0,u=S*Xe(b)+t.XW,r=d.x+l*C,i=d.y+0*C+(x?u*C:0),a=(t.width()-2*l)*C,s=d.height-0*C-(x?u*C:0);break;case M.ULb:if(!(c=Tn(t,M.TLb)))return T;if(!t.iX())return c;r=c.x,i=c.y,a=c.width-t.jX*t.zoomFactor(),s=c.height;break;case M.VLb:if(!d||0===m(I)||n>=m(I))return T;if(!(f=Tn(t,M.ULb)))return T;h=t.columnCount(),p=t.hX,a=(f.width-(h-2)*p*C)/h,s=t.itemHeight()*C+2*t.lX,r=f.x+n%h*(a+p*C),i=f.y+Math.floor(n/h)*(s+p*C)}return new o.Rect(r,i,a,s)}function xn(t){return t>0}function Sn(t){return function(e,n){var o=this;o.fX=on(o),sn(o),o.onPropertyChanged(t,e,n)}}function An(t,e,n,r){return n||(n=function(t){return function(e,n){sn(this),this.onPropertyChanged(t,e,n)}}(t)),o.Ul.Pl(t,e,n,r)}for(fe.other1=function(){return ce("Other",1,x,j,Fe(1,P,"#808080"),Fe(0,"",""),Fe(1,P,"#A6A6A6"),F,"#BFBFBF",Fe(1,P,Gt),F,"#D9D9D9",Fe(1,P,Vt),F,j,Fe(1,P,Vt),"#959595",j,Fe(1,P,"#E0E0E0"),F,"#F9E36F",Fe(1,P,Gt))},fe.other2=function(){return ce("Other",2,x,j,Fe(1,P,"#4F81BD"),Fe(0,"",""),Fe(1,P,"#4F81BD"),F,"#A9C1E3",Fe(1,P,Gt),Ht,"#D5E2F6",Fe(1,P,Vt),F,j,Fe(1,P,Vt),Ht,j,Fe(1,P,"#E0E0E0"),F,"#F9E36F",Fe(1,P,Gt))},pe=function(){function t(t,e,n){var o=this;o.name(t,!1),o.xo=T,o.PW=6,o.EX=1,o.VW=14,o.KW=T,o.MW=27,o.XW=5,o._caption=T,o.WW=T,o.RW=28,o.SW=25,o.TW=3,o.UW=0,o.AX=!1,o.QW=3,o.YW=T,o.ZW=T,o.$W=T,o._W=T,o.aX=T,o.cX=T,o.eX=0,o.dX=0,o.bX=T,o.FX=2,o._items=[],o.NW={},o.lX=1,o.kX=1,o.tX=6,o.hX=2,o.jX=17,o.sX=0,o.zX=j,o.DX="#F9E578",o.CX="red",o.BX="#B0ADB0",o.GX=!1,o.HX=!1,o.vX=[],o.wX=[],o.xX=0,o.fX=[],o.pX=[],o.rX=[],o.gX=[],o.oX=[],o.slicerData=e,o.columnName=n,o.data=e.getData(n),o.exclusiveDatas=e.getExclusiveData(n),o.slicerData.attachListener(o),o.IX()}return t.getDefaultStyle=function(){var t=function(t,e,n,o,r,i,a,s){var l={};return l[V]=t,l[z]=e,l[H]=n,l[Y]=o,l[X]=r,l[Z]=i,l[Q]=a,l[J]=s,l},e=function(t,e,n){var o={};return o[W]=t,o[U]=e,o[q]=n,o},n=e(1,P,"#808080"),o=e(0,"",""),r=e(1,P,"#999999"),i=e(1,P,"#CCCCCC"),a=e(1,P,"#E0E0E0"),s=t("#F9E36F",F,x,r,r,r,r),l={};return l[$]=t(j,F,x,n,n,n,n),l[K]=t(j,F,"bold 11pt calibri",o,o,o,e(1,P,"#A6A6A6")),l[tt]=t("#BFBFBF",F,x,r,r,r,r),l[et]=t("#D9D9D9",F,x,i,i,i,i),l[nt]=t(j,F,x,i,i,i,i),l[ot]=t(j,"#959595",x,a,a,a,a),l[rt]=s,l[it]=s,l[at]=s,l[st]=s,l},t.prototype.IX=function(){var t=this;t.oX=Qe(t.data),t.gX=Qe(t.exclusiveDatas),t.xo=Je(t),t.captionName(t.columnName,!1),dn(t),t.onFiltered(),He(t,t.style()),sn(t)},t.prototype.getDOMElement=function(){return this.xo},t.prototype.mX=function(t,e){var n,o,i=[];if(0!==e){for(n=r.Slicers.jf.quickSort(t),o=0;o<m(n);o++)i[o]=n[o].value;return 2===e&&i.reverse(),i}},t.prototype.iX=function(){var t=this,e=t.gX,n=t.showNoDataItems()?m(e):m(e)-m(t.rX);return Math.ceil(n/t.columnCount())*(t.itemHeight()+2*(t.lX+t.kX)+t.hX)>t.dX},t.prototype.Bw=function(t,e){this.JX(t,e)},t.prototype.JX=function(t,e){var n=this,o=e.newValue;o!==n.sX&&o<=n.nX.cw()&&(n.sX=o,hn(n),un(n))},t.prototype.onDataChanged=function(){an(this)},t.prototype.onRowsChanged=function(){an(this)},t.prototype.onColumnNameChanged=function(t,e){var n=this;n.columnName===t&&n._caption&&(n.columnName=e,n.captionName(e,!1),o.GC$(n._caption).text(e))},t.prototype.onColumnRemoved=function(t){var e=this;t===e.columnName&&(e.slicerData.doUnfilter(t),function(t){var e=t.xo;e&&o.GC$(e).unbind(".slicer")}(e),o.GC$(e.xo).remove(),e.xo=T)},t.prototype.onFiltered=function(){var t=this,e=t.slicerData,n=t.columnName;t.fX=on(t),t.rX=e.getFilteredOutIndexes(n,2),t.pX=e.getFilteredOutIndexes(n,1),sn(t)},t.prototype.xmb=function(t){var e,n=wn(this,t);return!!n&&(5===(e=n.mark)||6===e||8===e||4===e)},t.prototype.AD=function(t){var e=this,n=wn(e,t);n&&(8===n[Pt]&&(e.HX=!0),5===n[Pt]&&(e.wX=[],e.GX=!0,t.ctrlKey?function(t,e){var n,o,r,i=t.exclusiveDatas,a=t.pX,s=mn(t,e[_t]),l=t.vX,u=t.wX;for(h.Bb(l,s)?h.Fb(l,s):l.push(s),n=0;n<m(i);n++)h.Bb(a,n)||u.push(n);for(o=0;o<m(l);o++)h.Bb(u,l[o])?h.Fb(u,l[o]):u.push(l[o]);if(0===m(u))for(r=0;r<m(t.gX);r++)u.push(r);t.xX=s}(e,n):t.shiftKey?function(t,e){var n,o,r,i,a,s,l,u,c=t.fX,f=t.gX,h=f[t.xX];for(gn(t),n=c.indexOf(h),o=c.indexOf(e[_t]),r=Math.min(n,o),i=Math.max(n,o),a=r;a<=i;a++)s=f.indexOf(c[a]),l=t.vX,u=t.wX,-1===l.indexOf(s)&&l.push(s),-1===u.indexOf(s)&&u.push(s)}(e,n):function(t,e){gn(t);var n=mn(t,e[_t]);cn(t,n),t.vX.push(n),t.wX.push(n),t.xX=n}(e,n)),yn(e,e.vX),(5===n[Pt]||6===n[Pt]||8===n[Pt]||4===n[Pt]&&e.AX)&&t.stopPropagation())},t.prototype.CD=function(t){var e,n,o,r=this,i=wn(r,t);i&&(e=r.slicerData,n=r.vX,o=!1,4===i[Pt]?r.AX&&(e.doUnfilter(r.columnName),vn(r,0),o=!0):n&&m(n)>0&&!r.yX&&!r.KX&&(e.doFilter(r.columnName,{exclusiveRowIndexes:r.wX}),o=!0),r.GX=!1,r.HX=!1,o&&(r.vX=[],r.wX=[]))},t.prototype.BD=function(t){var e,n,o,r,i,a,s,l,u,c,f,p,d,g=this,y=g.qX,v=y?new me(y[Pt],y[_t]):T,C=wn(g,t),b=g.gX,w=g.wX;if(C&&(!v||v[Pt]!==C[Pt]||5===v[Pt]&&v[_t]!==C[_t])){if(!g.GX)return g.qX=C,Cn(g,v),void function(t,e){if(e)switch(e[Pt]){case 4:if(!t.WW||!t.AX)return;vn(t,2);break;case 5:var n=t.gX.indexOf(e[_t]);cn(t,n);break;case 6:t.cX.style.cursor=dt}}(g,C);if(5===C[Pt])if(e=b.indexOf(C[_t]),n=g.rX,o=void 0,r=void 0,i=void 0,h.Bb(w,e)){for(s=(a=g.fX).indexOf(b[g.xX]),l=a.indexOf(C[_t]),u=Math.min(s,l),c=Math.max(s,l),f=[],p=m(w),o=0;o<p;o++)d=w[o],((r=a.indexOf(b[d]))>c||r<u)&&f.push(d);for(p=m(f),o=0;o<p;o++)i=bn(g,b[r=f[o]]),h.Bb(n,r)?fn(g,i,20):fn(g,i,12),h.Fb(w,r)}else i=bn(g,b[e]),h.Bb(n,e)?fn(g,i,18):fn(g,i,10),h.Sb(w,e);g.qX=C}},t.prototype.uX=function(){var t=this,e=t.qX,n=e?new me(e[Pt],e[_t]):T;t.qX=T,Cn(t,n)},t.prototype.Rw=function(t){return 8===wn(this,t)[Pt]&&(t.stopPropagation(),!0)},t.prototype.nm=function(t){var e=this;17!==t.keyCode||e.yX||(e.yX=!0),16!==t.keyCode||e.KX||(e.KX=!0)},t.prototype.om=function(t){var e=this,n=e.slicerData;17===t.keyCode&&e.yX&&(e.yX=!1),16===t.keyCode&&e.KX&&(e.KX=!1),!e.yX&&!e.KX&&m(e.vX)>0&&(n.doFilter(e.columnName,{exclusiveRowIndexes:e.wX}),e.vX=[],e.wX=[])},t.prototype.onPropertyChanged=function(t,e,n){var o=this;o.slicerData.OW&&o.slicerData.OW().ITa.xVa(o,t,n)},t}(),e.ItemSlicer=pe,de=[[N],[B,180],[G,210],["captionName",""],["columnCount",1,T,xn],["itemHeight",21,T,xn],["showHeader",!0],["sortState",1,Sn("sortState")],["showNoDataItems",!0,Sn("showNoDataItems")],["showNoDataItemsInLast",!0,Sn("showNoDataItemsInLast")],["visuallyNoDataItems",!0,Sn("visuallyNoDataItems")],[E,pe.getDefaultStyle(),function(t,e){He(this,t),sn(this),this.onPropertyChanged("visuallyNoDataItems",t,e)}],["zoomFactor",1,T,xn],["isLocked"],["disableResizingAndMoving"]],oe=0,ge=m(de);oe<ge;oe++)pe.prototype[de[oe][0]]=An(de[oe][0],de[oe][1],de[oe][2],de[oe][3]);function In(t,e,n){var o,r,i,a,s=t.kj,l=t.dataRange(),u=l.row+l.rowCount-1,c=l.col+l.colCount-1;for(o=l.row;o<=u;o++)for(r=[],e.push(r),i=l.col;i<=c;i++)r.push({value:s.getValue(o,i),text:s.getText(o,i)});for(i=0;i<l.colCount;i++)a=t.getColumnName(i)||"",n.push(a)}function Rn(t,e,n){var o,r,i,a,s,l,u,c,f,p,d,g,y,v,C,b;for(o=0;o<n.length;o++){if(r=t.sj,i=t.xr,l=(a=n[o]-r.range().col)+(s=r.dataRange()).col,u=t.columnNames[a],c=[],f={},h.Bb(i.Je,l)){for(p=[],d=s.row;d<s.row+s.rowCount;d++)i.E0a(d,l)||p.push(d);for(g=0;g<m(p);g++)y=p[g]-s.row,f[v=t.getExclusiveRowIndex(u,y)]||(f[v]=!0,c.push(v))}else for(C=m(t.getExclusiveData(u)),b=0;b<C;b++)c.push(b);kn(Mn(t,u),c)||(e.prototype.doFilter.call(t,u,{exclusiveRowIndexes:c}),t.onFiltered(),t.kj.$p())}}function kn(t,e){var n,o=r.Common.j.Fa;if(o(t)&&o(e))return!0;if(o(t)&&!o(e)||!o(t)&&o(e)||!o(t)&&!o(e)&&(!v(t)||!v(e))||t.length!==e.length)return!1;for(n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Mn(t,e){var n,o=t.getExclusiveData(e),r=t.getFilteredOutIndexes(e,1),i=[];for(n=0;n<m(o);n++)h.Bb(r,n)&&i.push(n);return i}function Nn(t){var e=t.sj,n=e.kj,o=e&&e.rowFilter();return!n.options.isProtected||o&&o.TX(n)}function En(t,e){var n,o,r=t.VX;if(e){for(n=e.getTable(),o=0;o<m(r);o++)if(r[o].getTable()===n)return;r.push(e)}}function Dn(t,e){h.Fb(t.VX,e)}function On(t,e){var n,o,r,i=t.VX;for(n=0;n<m(i);n++)if(r=(o=i[n]).getTable(),o&&r&&r.tableName()===e)return o;return T}function jn(t,e,n){var o;return e?f(Fn(t),e)&&(o=c().Exp_SlicerNameExist):o=c().Exp_SlicerNameInvalid,o&&n&&(n.error=Error(o)),!o}function Fn(t){var e,n,o,r=t.kj,i={},a=r&&r.parent&&r.parent.sheets;if(a)for(e=0;e<m(a);e++)for(o in n=a[e].slicers.XX())f(n,o)&&(i[o]=n[o]);return i}function Pn(t){return t.ZX.getTable()}function _n(t){return t.$X}function Ln(t,e,n,o){return Re.push(t),d(t,e,(function(e,o){n.call(this,t,e,o)}),o)}function Bn(t,e,n){var o,r,i=this,a=i.$X||[];for(o=0;o<m(a);o++)a[o][t]&&("style"===t?a[o][t](e.toJSONInternal()):a[o][t](e));(r=i.sheet())&&(r.ITa.xVa(i,t,n),i.Wq({sheet:r,sheetName:r.name(),slicer:i,propertyName:t}))}for(me=function(t,e){this[Pt]=t===w?T:t,this[_t]=e===w?T:e},ye=function(t){function e(e){var n,o,r=[],i=[],a=e.rowFilter();return In(e,r,i),o=t.call(this,r,i)||this,(n=o).sj=e,n.kj=e.kj,n.xr=a,n.MX=T,function(t,e){var n,o,r=t.kj,i=t.sj.rowFilter();for(r.suspendPaint(),n=i&&i.Je||[],o=0;o<m(n);o++)Rn(t,e,[n[o]]);r.resumePaint()}(n,A),a&&(a.filterHandler=function(t){Rn(n,A,t.columns)}),o}return Oe(e,t),e.prototype.no=function(){var t=this;t.MX=T,t.sj=T,t.xr&&(t.xr.filterHandler=T,t.xr=T),t.kj=T},e.prototype.OW=function(){return this.kj},e.prototype.getTable=function(){return this.sj},e.prototype.doFilter=function(e,n,o){var r,i,a,l,u,c,f,h,p,d,g,y,v,C,b,w,T=this,x=T.kj,S=T.sj,A=T.xr,I=n.ranges,R=n.exclusiveRowIndexes,k=!!R;if(x.ITa.xVa(T,lt,{columnName:e,oldValue:T.getFilteredIndexes(e)}),!((r=T.getColumnIndex(e))<0||!k&&!I))if(o)t.prototype.doFilter.call(this,e,n,o);else{if(i=k?T.getExclusiveData(e):T.getData(e),a=[],k)a=R;else for(l=T.ef(),u=T.ff(),l[r]||T.We(r),c=l[r],f=0;f<m(I);f++)for(h=I[f],d=(p=T.Xe(c,h)).start;d<=p.end;d++)a.push(u[r][d]);if(x.suspendPaint(),g=S.startColumn()+r,A&&A.removeFilterItems(g,!0),x.AR(),s.$V){for(y=[],v=0;v<m(a);v++)(C=s.$V(2,0,i[a[v]])).useWildCards(!1),y.push(C);A&&A.addFilterItem(g,y)}t.prototype.hf.call(this,e,n),b=[],w={},T.gf(e,b,w),A&&(A.filter(g,!0),A.onFilter(A.SX(0,[g]))),T.onFiltered(),x.resumePaint()}},e.prototype.doUnfilter=function(e){var n,o=this,r=o.kj,i=o.sj,a=o.getColumnIndex(e),s=o.xr;-1!==a&&(r.ITa.xVa(o,lt,{columnName:e,oldValue:o.getFilteredIndexes(e)}),n=i.startColumn()+a,s.removeFilterItems(n),t.prototype.if.call(this,e),s.unfilter(n,!0),s.onFilter(s.SX(0,[n])),o.onFiltered(),o.kj.$p())},e.prototype.refresh=function(){var t=[],e=[];In(this.sj,t,e),this.bf(t,e)},e.prototype.onColumnNameChanged=function(e,n){t.prototype.onColumnNameChanged.call(this,e,n),this.kj.slicers.all().forEach((function(t){t.columnName(n)}))},e.prototype.onRowsAdded=function(e,n){var o,r,i=this,a=i.kj,s=i.sj.dataRange();for(t.prototype.onRowsAdded.call(this,e,n,!0),o=e;o<e+n;o++)for(r=0;r<m(i.columnNames);r++)i.data[o][r]={value:a.getValue(s.row+o,s.col+r),text:a.getText(s.row+o,s.col+r)};i.bf(i.data,i.columnNames),i.cf("onRowsChanged",e,n,!0)},e.prototype.onRowsRemoved=function(e,n){t.prototype.df.call(this,e,n,!1)},e.prototype.onColumnsAdded=function(t,e){var n,o,r,i,a=this,s=a.kj,l=a.sj,u=l.dataRange(),c=a.data,f=a.columnNames;for(n=0;n<m(c);n++)for(o=t;o<t+e;o++)c[n].splice(o,0,{value:s.getValue(u.row+n,u.col+o),text:s.getText(u.row+n,u.col+o)});for(r=t;r<t+e;r++)i=l.getColumnName(r)||"",f.splice(r,0,i);a.bf(c,f)},e.prototype.onColumnsRemoved=function(e,n){var o,r,i=this,a=i.kj,s=i.sj.name(),l=i.columnNames,u=[];for(o=e;o<e+n;o++)u.push(l[o]);t.prototype.onColumnsRemoved.call(this,e,n),r=a&&a.slicers,u.forEach((function(t){r.all(s,t).forEach((function(t){r.remove(t.name())}))}))},e.prototype.onTableRemoved=function(t){var e,n,o,r=this;t&&t===r.sj&&(r.MX=[],e=r.kj,n=e.slicers,o=t.name(),n.all(o).forEach((function(t){r.MX.push(t),n.remove(t.name())})),n&&Dn(n,r),r.Ze=[])},e.prototype.onTableAdded=function(t){var e=this.kj.slicers;e&&t&&t.Aq()&&En(e,t.getSlicerData()),(this.MX||[]).forEach((function(t){var n=t.name(),o=t.ZX.sj.name(),r=t.columnName(),i=t.style();e.add(n,o,r,i)}))},e}(A),e.TableSlicerData=ye,a.Table&&o.GC$.extend(a.Table.prototype,{getSlicerData:function(){var t=this;return t.ZX||(t.ZX=new ye(t)),t.ZX}}),(ve=function(t){function e(e,n,o){var r=t.call(this,e,n,o)||this;return r.isSelected(!1),r}return Oe(e,t),e.prototype.no=function(){var t=this;t.sj=T,t.slicer(T),t.sheet(T)},e.prototype.IX=function(){var e=this,n=e.slicerData;n&&n instanceof ye&&(e.sheet(n.OW()),e.sj=n.getTable()),t.prototype.IX.call(this)},e.prototype.onColumnRemoved=function(t){var e,n=this,o=n.sheet(),r=n.sj,i=n.slicerData;t===n.columnName&&(e=i.getFilteredOutIndexes(t,1),0!==m(e)&&i.doUnfilter(t),o&&r&&o.wr.Fb(n.name()))},e.prototype.mX=function(t,e){var n,o,i,a,s,l,u=this,c=u.slicerData,f=c.getColumnIndex(u.columnName),h=u.sj.dataRange(),p=[];if(0===e)return t;for(n=[],o=c.OW(),i=0;i<m(t);i++)a=c.getRowIndexes(u.columnName,i),n.push(o.getValue(h.row+a[0],h.col+f));for(s=r.Slicers.jf.quickSort(n),l=0;l<m(s);l++)p[l]=t[s[l].index];return 2===e&&p.reverse(),p},e.prototype.Bw=function(e,n){var o,r,i=this.sheet(),a=this.slicer();for(a&&i.ER(a)||(n.newValue=n.oldValue),o=_n(a),r=0;r<m(o);r++)t.prototype.JX.call(this,e,n)},e.prototype.AD=function(e){var n,o,r,i=this,a=i.sheet(),s=i.slicer();if(s&&a.ER(s)){if(n=wn(i,e),!Nn(i)&&(5===n[Pt]||6===n[Pt]||8===n[Pt]))return void e.stopPropagation();for(o=_n(s),r=0;r<m(o);r++)t.prototype.AD.call(this,e)}},e.prototype.CD=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g=this,y=g.sheet(),v=g.slicer();if(v&&y.ER(v)&&Nn(g)&&(e=wn(g,t))){for(n=g.slicerData,o=g.vX,r=g.wX,i=n.getExclusiveData(g.columnName),a=!1,s=T,4===e[Pt]||5===e[Pt]&&m(r)===m(i)&&!g.yX&&!g.KX?(l=n.getFilteredIndexes(g.columnName),s=y.wu().execute({cmd:"unfilterSlicer",sheetName:y.name(),slicerData:n,columnName:g.columnName,value:l}),a=!0):o&&m(o)>0&&!g.yX&&!g.KX&&(u=n.getFilteredIndexes(g.columnName),c=r.concat(),s=y.wu().execute({cmd:"filterSlicer",sheetName:y.name(),slicerData:n,columnName:g.columnName,oldValue:u,newValue:c}),a=!0),f=_n(v),h=0,p=m(f);h<p;h++)(d=f[h]).GX=!1,d.HX=!1,a&&(d.vX=[],d.wX=[]);return!!s}},e.prototype.BD=function(e){var n,o,r=this,i=r.sheet(),a=r.slicer();if(a&&!r.HX&&i.ER(a))for(n=_n(a),o=0;o<m(n);o++)t.prototype.BD.call(this,e)},e.prototype.uX=function(){var e,n,o=this.sheet(),r=this.slicer();if(r&&o.ER(r))for(e=_n(r),n=0;n<m(e);n++)t.prototype.uX.call(this)},e.prototype.Rw=function(e){var n,o,r,i=this;return!!t.prototype.Rw.call(this,e)||(o=(n=i.sheet().slicers)&&n.UX(),r=i.nX,!!(o&&1===m(o)&&i.isSelected()&&i.iX()&&r)&&(r.sC(e),e.stopPropagation(),!0))},e.prototype.om=function(t){var e,n,o,r,i=this,a=i.slicerData,s=i.sheet(),l=i.wX;17===t.keyCode&&i.yX&&(i.yX=!1),16===t.keyCode&&i.KX&&(i.KX=!1),!i.yX&&!i.KX&&m(i.vX)>0&&(e=m(a.getExclusiveData(i.columnName)),m(l)===e?(n=a.getFilteredIndexes(i.columnName),s.wu().execute({cmd:"unfilterSlicer",sheetName:s.name(),slicerData:a,columnName:i.columnName,value:n})):(o=a.getFilteredIndexes(i.columnName),r=l.concat(),s.wu().execute({cmd:"filterSlicer",sheetName:s.name(),slicerData:a,columnName:i.columnName,oldValue:o,newValue:r})),i.vX=[],i.wX=[])},e}(pe)).prototype.isSelected=d("isSelected",!1),ve.prototype.sheet=d("sheet"),ve.prototype.slicer=d("slicer"),Ce=function(){function t(t){var e=this;e.kj=t,e.VX=[],e.WX={}}return t.prototype.no=function(){var t=this;t.WX&&(o.GC$.each(t.WX,(function(t,e){e.no()})),t.WX=T),t.VX&&(t.VX.forEach((function(t){t.no()})),t.VX=T),t.kj=T},t.prototype.add=function(t,e,n,o){var r,i=this.kj,a=i.parent.jga(e);return a&&-1!==a.getColumnIndexInTable(n)?(i.suspendPaint(),r=new ke(t,a,n),o&&r.style(o),this.Cz(r),i.wr.Sb(r),i.resumePaint(),r):T},t.prototype.Cz=function(t){var e,n,o=this,r=o.kj;if(t){if(!jn(o,e=t.name(),n={}))throw n.error;o.WX[e]=t,En(o,t.YX()),r.ITa.xVa(o,ut,e)}},t.prototype.get=function(t){return t===T||t===w?T:this.WX[t]},t.prototype.remove=function(t){var e=this.kj;this.vV(t),e.wr.Fb(t)},t.prototype.vV=function(t){var e,n,o,r=this,i=r.kj,a=r.WX,s=r.get(t);if(s&&f(a,t)){for(e=s.YX(),n=_n(s),o=0;o<m(n);o++)e.detachListener(n[o]);i.ITa.xVa(r,ct,s),delete r.WX[t]}},t.prototype.U3=function(t,e){var n,o=this,r=o.kj,i={};if(!jn(o,e,i))throw i.error;n=o.WX[t],delete o.WX[t],o.WX[e]=n,r.wr.U3(t,e)},t.prototype.clear=function(){var t=this,e=t.kj;e.suspendPaint(),o.GC$.each(this.WX,(function(e,n){t.remove(n.name())})),e.resumePaint()},t.prototype.all=function(t,e){var n=[];return o.GC$.each(this.WX,(function(o,r){t&&(Pn(r).name()!==t||e&&r.columnName()!==e)||n.push(r)})),n},t.prototype.tTa=function(t,e,n){i.FloatingObjectCollection.prototype.tTa.call(this,t,e,n)},t.prototype.XX=function(){return this.WX},t.prototype.HS=function(t){var e,n,o=Fn(this);if(!f(o,t))return t;for(e=1," ",n=t.split(" ")[0];f(o,n+" "+e);)e++;return n+" "+e},t.prototype.UX=function(){var t,e,n,r=this.WX;if(!r||o.GC$.isEmptyObject(r))return[];for(e in t=[],r)f(r,e)&&((n=r[e])&&n.isSelected()&&t.push(n));return t},t.prototype.W3=function(t){var e,n,o=this.UX();if(1!==m(o))return!1;if(e=_n(o[0]),m(e)>0){for(n=0;n<m(e);n++)e[n].Rw(t);return!0}return!1},t.prototype.toJSON=function(){var t,e=[],n=this.WX;if(n&&!o.GC$.isEmptyObject(n))for(t in n)f(n,t)&&e.push(n[t].toJSON());return e},t.prototype.fromJSON=function(t){var e,n,o,r,i,a,s;if(t&&0!==m(t))for(this,n=(e=this.kj).parent,this.WX={},o=0;o<m(t);o++)r=t[o].tableName,i=t[o].columnName,r&&i&&((a=n.jga(r))&&-1!==a.getColumnIndexInTable(i)&&((s=new ke(t[o].name,a,i)).sheet(e),s.fromJSON(t[o]),e.slicers.Cz(s),e.wr.Sb(s)))},t}(),e.SlicerCollection=Ce,"nameInFormula",be="captionName","columnCount",we="columnName","itemHeight","showHeader","sortState",Te="disableResizingAndMoving","showNoDataItems","showNoDataItemsInLast","visuallyNoDataItems","isSelected",xe="dynamicMove",Se="dynamicSize",Ae="tableName",Ie="Slicer",100,100,192,250,Re=[],ke=function(t){function e(e,n,o){var r,i,a=t.call(this,e,100,100,192,250)||this,s=a;return s.typeName=Ie,s.g3=Ie,n&&(r=n.kj,s.sheet(r),i=On(r.slicers,n.tableName())),i||(i=n.getSlicerData()),s.ZX=i,s[we](o),s.$X=[],s._X=o,s.nameInFormula(Ie+"_"+o),s[be](o),s[Se](!1),s[xe](!1),a}return Oe(e,t),e.prototype.no=function(t){if(!1!==t){var e=this;e.$X&&(e.$X.forEach((function(t){t.no()})),e.$X=T),e.ZX&&(e.ZX.no(),e.ZX=T),e.sheet(T)}},e.prototype.sourceName=function(){return this._X},e.prototype.cloneContent=function(){var t=this,e=t.sheet(),n=t.ZX,o=new ve(t.name(),n,t.columnName());return o.width(t.width(),!1),o.height(t.height(),!1),o.captionName(t.captionName()),o.columnCount(t.columnCount()),o.itemHeight(t.itemHeight()),o.showHeader(t.showHeader()),o.sortState(t.sortState()),o.isLocked(t.isLocked()),o.disableResizingAndMoving(t.disableResizingAndMoving()),o.showNoDataItems(t.showNoDataItems()),o.showNoDataItemsInLast(t.showNoDataItemsInLast()),o.visuallyNoDataItems(t.visuallyNoDataItems()),o.style(t.style().toJSONInternal()),o.zoomFactor(e.zoom()),o.isSelected(t.isSelected()),o.slicer(t),o.sheet()!==e&&o.sheet(e),t.$X.push(o),o.getDOMElement()},e.prototype.YX=function(){return this.ZX},e.prototype.hga=function(){return!1},e.prototype.refresh=function(t){var e,n=this.$X;for(e=0;e<m(n);e++)sn(n[e],t)},e.prototype.refreshContent=function(t){var e=this,n=e.sheet().zoom();n!==e.MP&&(e.MP=n,e.refresh(n))},e.prototype.clone=function(t){var n,o=this;return!o.sheet()&&t&&o.sheet(t,!1),(n=new e(o.name(),Pn(o),o.columnName())).sheet(o.sheet(),!1),n.fromJSON(o.toJSON(),!1,o.ZX),n},e.prototype.fromJSON=function(e,n,r){var i,a,s,l,u,c,f,h,p,d;e&&(i=this,a=e.tableName,s=e[we],a&&s&&(t.prototype.fromJSON.call(this,e),u=(l=i.sheet()).slicers,c=l.parent,(f=r||On(u,a))||En(u,f=c.jga(a).getSlicerData()),i.ZX=f,i[we](s),h=e.x!==w?e.x:100,p=e.y!==w?e.y:100,i.position(new o.Point(h,p)),i[B](e[B]!==w?e[B]:192,!1),i[G](e[G]!==w?e[G]:250,!1),e.sourceName!==w&&(i._X=e.sourceName),Re.forEach((function(t){var n=e[t];n!==w&&i[t](n,!1)})),e.style!==w&&((d=_e()).fromJSON(e.style),i.style(d,!1))))},e.prototype.toJSON=function(){var t,e,n=this,o={};return["x","y",B,G,xe,Se,"isLocked","fixedPosition"].forEach((function(t){var e=n[t]();n[t].isDefault(e)&&t!==xe&&t!==Se||(o[t]=e)})),(t=n._X)&&(o.sourceName=t),n[E]()&&(o[E]=n[E]().toJSON()),(e=n.ZX.getTable())[Ae]&&(o[Ae]=e[Ae]()),Re.forEach((function(t){var e=n[t]();t===E||n[t].isDefault(e)||(o[t]=e)})),o},e.prototype.Wq=function(t){var e=this.sheet();e&&e.Wq(o.Events.SlicerChanged,t)},e}(i.FloatingObject),e.Slicer=ke,ke.prototype.nameInFormula=Ln("nameInFormula","",Bn),ke.prototype.onPropertyChanged=Bn,Me=[[N,"",function(t,e,n){!function(t,e,n){var o,r,i=t.ZX;i&&(o=i.OW(),(r=o.slicers).all().forEach((function(o){o===t&&(r.U3(e,n),t.onPropertyChanged(N,n,e))})))}(this,n,e)},function(t){var e,n,o,r;if(!t)return!1;if(this,e=this.ZX,t===this.name())return!1;if(e&&((o=(n=e.OW())&&n.slicers)&&!jn(o,t,r={})))throw r.error;return!0}],[be,"",Bn],["columnCount",1,Bn,xn],["itemHeight",21,Bn,xn],["showHeader",!0,Bn],["sortState",1,Bn],[Te,!1,function(t,e,n){var o,r=this;r.allowMove(!e,!1),r.allowResize(!e,!1),Bn.call(r,Te,e,n),(o=r.sheet())&&o.$p()}],["showNoDataItems",!0,Bn],["showNoDataItemsInLast",!0,Bn],["visuallyNoDataItems",!0,Bn],[E,fe.light1(),Bn],[we,"",function(t,e,n){var o=this;o._X=e,o.captionName(e,!1),o.sheet().ITa.xVa(o,t,n)}]],oe=0,ge=m(Me);oe<ge;oe++)ke.prototype[Me[oe][0]]=Ln(Me[oe][0],Me[oe][1],Me[oe][2],Me[oe][3]);C(o.Worksheet.prototype,{t4:function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p;if(r===w&&(r=3),a=(i=this).tables){for(s=0;s<n;s++)for(l=0;l<o;l++)u=s+t,c=l+e,f=a.find(u,c),3===r&&f&&f.Aq()&&((h=f.dataRange()).contains(u,c)&&((p=f.getSlicerData())&&p.onDataChanged([{columnName:f.getColumnName(c-h.col),row:u-h.row,data:{value:i.getValue(u,c),text:i.getText(u,c)}}])));i.ITa.xVa(null,ft,{row:t,col:e,rowCount:n,colCount:o,sheetArea:r})}}}),Ne={priority:900,init:function(){this.slicers=new Ce(this)},setHost:function(){var t=this;t.bind("tableRemoved",(function(e,n){var o,r,i,a=n.tables;for(o=0;o<m(a);o++)(i=On(r=t.slicers,a[o].name()))&&Dn(r,i)}))},dispose:function(t){!1!==t.clearCache&&(this.slicers&&(this.slicers.no(),this.slicers=T),this.unbind("tableRemoved"))},toJson:function(t,e){var n;e&&e.ignoreStyle||(n=this.slicers.toJSON()).length>0&&(t.slicers=n)},preProcessMouseWheel:function(t){var e=this.slicers;e&&e.W3(t.e)&&(t.r=!0)},onGroupChanged:function(t){this.slicers.tTa(t.start,t.end,t.isRow)}},o.Worksheet.$n("slicer",Ne),Ee=function(t){var e="unfilterSlicerByKey",n="filterSlicer",r="unfilterSlicer",i="changeSlicerProperty";t.register(e,o.Commands[e],67,!1,!1,!0,!1),t.register(n,o.Commands[n]),t.register(r,o.Commands[r]),t.register(i,o.Commands[i])},De={init:function(){Ee(this.commandManager())},fromJson:function(t,e,n){var o,r,i,a,s;if(!(n&&n.ignoreStyle))for(this,o=0,r=this.getSheetCount();o<r;o++)i=this.getSheet(o),(s=(a=t.sheets&&t.sheets[i.name()])&&a.slicers)&&i.slicers.fromJSON(s)}},o.Workbook.$n("slicer",De),o.GC$.extend(o.lUa.prototype,{xVa:function(t,e,n){var o,r=this.zTa;r&&((o=r.EUa)||(o=r.EUa=[]),o.push({slicerItem:t,name:e,value:n}))},yVa:function(t){var e,n,o,r,i,a,s,l,u;if(t)for(e=t.length-1;e>=0;e--)if(o=(n=t[e]).slicerItem,r=n.name,i=n.value,r===lt)a=i.columnName,s=i.oldValue,o.doFilter(a,{exclusiveRowIndexes:s});else if(r===ut)o.vV(i);else if(r===ct){if(!i)return;o.Cz(i),(l=i.ZX.MX)&&((u=l.indexOf(i))>=0&&l.splice(u,1))}else if(r===ft){if(!i)return;this.kj.t4(i.row,i.col,i.rowCount,i.colCount,i.sheetArea)}else o[r](i)}}),o.lUa.$n("SLICER_PROPERTYCHANGE",{priority:5500,undo:function(t){var e=t.EUa;e&&this.yVa(e)}})},"./dist/plugins/sparkline/functions-sparkline.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function rt(t){return 0===t}function it(t){return 0===t||2===t}function at(t){return it(t)||8===t}function st(t,e){var n,o,r,i,a,s,l,u,h,p,d=[];if(c(t))for(n=0,o=t.getRangeCount();n<o;n++)for(r=t.getRowCount(n),i=t.getColumnCount(n),a=0;a<r;a++)for(s=0;s<i;s++)d.push(t.getValue(n,a,s));else if(e&&f(t))for(l=t.getRowCount(),u=t.getColumnCount(),h=0;h<l;h++)for(p=0;p<u;p++)d.push(t.getValue(h,p));return d}function lt(t,e){var n,o,r,i,a=[];if(c(t)&&t.getRangeCount()>e)for(n=t.getRowCount(e),o=t.getColumnCount(e),r=0;r<n;r++)for(a[r]=[],i=0;i<o;i++)a[r].push(t.getValue(e,r,i));return a}function ut(t){var e;return c(t)?e=t.getValue(0,0,0):d(t)||(e=t),e}function ct(t,e){function n(t){return new r.Range(t.getRow(0),t.getColumn(0),t.getRowCount(0),t.getColumnCount(0))}var o=new h(t,2,5);return o.evaluate=function(t){var o,r,i,s,l,u,f,h,p,g,m,y,v=t[0];if(c(v)&&v.getRangeCount()>0){for(g in o=n(v),r=v.getSource().getSheet().name(),i=t[1],s=t[2],l=void 0,u=void 0,f=void 0,c(s)&&(f=s.getSource().getSheet().name(),s.getRangeCount()>0&&(l=n(s),u=t[3])),h=function(t){var e,n,o,r,i,a={},s=!1,l=!0,u="",c="";if(t){for(e=0,n=(t=t.substr(1,t.length-2)).length;e<n;e++)":"===(o=t.charAt(e))?l=!1:","!==o||s?"'"===o||'"'===o||("("===o?s=!0:")"===o&&(s=!1),l?u+=o:c+=o):(a[u]=c,u="",c="",l=!0);for(r in u&&(a[u]=c),a)a.hasOwnProperty(r)&&(i=a[r],d(i)||("TRUE"===i.toUpperCase()?a[r]=!0:"FALSE"===i.toUpperCase()?a[r]=!1:!b(i)&&isFinite(i)&&(a[r]=w(i))))}return a}(t[4]||"{}"),p={ac:"axisColor",fmc:"firstMarkerColor",hmc:"highMarkerColor",lastmc:"lastMarkerColor",lowmc:"lowMarkerColor",mc:"markersColor",nc:"negativeColor",sc:"seriesColor",deca:"displayEmptyCellsAs",rtl:"rightToLeft",dh:"displayHidden",dxa:"displayXAxis",sf:"showFirst",sh:"showHigh",slast:"showLast",slow:"showLow",sn:"showNegative",sm:"showMarkers",mmax:"manualMax",mmin:"manualMin",maxat:"maxAxisType",minat:"minAxisType",lw:"lineWeight"})p.hasOwnProperty(g)&&h.hasOwnProperty(g)&&(h[p[g]]=h[g]);return 1===(y=(m=new a.SparklineSetting(h)).options).maxAxisType&&(y.maxAxisType=0),1===y.minAxisType&&(y.minAxisType=0),{data:o,dataSheetName:r,dataOrientation:i,dateAxisData:l,dateAxisDataSheetName:f,dateAxisOrientation:u,sparklineType:e,displayDateAxis:l&&!d(u),setting:m,values:lt(v,0),dateValues:lt(s,0)}}},o.acceptsReference=it,o}function ft(t,e,n,o,i,s,l){var u,c,f=a.Sparkline.cT,h=l.sheet,p=h.parent.getSheetFromName(e.dataSheetName),d=h.parent.getSheetFromName(e.dateAxisDataSheetName),g=e.setting;g&&g.options||(g=new a.SparklineSetting(g)),u=g.options.displayHidden,c={sparklineType:e.sparklineType,displayDateAxis:e.displayDateAxis,zoomFactor:l.zoomFactor,values:f(e.values,p||h,u,e.data,e.dataOrientation),dateValues:f(e.dateValues,d||h,u,e.dateAxisData,e.dateAxisOrientation,!0),settings:g,getColor:function(t){if(h&&t){var e=r.Rm.Om(h,t);if(e)return e}return t}},(new y).paint(t,c,n,o,i,s)}function ht(t){t&&(nt[t.name()]=t)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("@grapecity/js-calc"),r=n("Core"),i=n("Common"),a=n("./dist/plugins/sparkline/sparkline-wrapper.js"),c=o.Convert.Fh,f=o.Convert.Ca,h=o.Functions&&o.Functions.Function,p=o.Functions&&o.Functions.bi,d=i.Common.j.Fa,(g=r.GC$).inherit,m=g.extend,y=i.Sparklines.SparklineRender,v=i.Sparklines.SparklineExRenders,C=null,b=isNaN,w=parseFloat,T="PIESPARKLINE",x="AREASPARKLINE",S="SCATTERSPARKLINE",A="BULLETSPARKLINE",I="SPREADSPARKLINE",R="STACKEDSPARKLINE",k="HBARSPARKLINE",M="VBARSPARKLINE",N="VARISPARKLINE",E="BOXPLOTSPARKLINE",D="CASCADESPARKLINE",O="PARETOSPARKLINE",j="MONTHSPARKLINE",F="YEARSPARKLINE",P=function(){function t(t,e){this.name=t,this.value=e,this.typeName="SparklineExValue"}return t.prototype.toString=function(){return""},t}(),e.SparklineExValue=P,_=function(){function t(){var t,e,n=this.createFunction();n&&(t=n.name,e=n.evaluate,n.evaluate=function(){var n=e.call(this,arguments);return n instanceof o.CalcError?n:n?new P(t,n):C},this.Cj=t,t&&!o.Functions.findGlobalFunction(t)&&(o.Functions.ci[t]=n)),this.typeName=""}return t.prototype.name=function(){return this.Cj},t.prototype.createFunction=function(){return C},t.prototype.paint=function(t,e,n,o,r,i,a){},t.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)d(t[e])||(this[e]=t[e])},t}(),e.SparklineEx=_,L=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.PieSparkline=L,m(L.prototype,{createFunction:function(){var t=new h(T,1,255);return t.evaluate=function(t){var e=t[0],n=st(e);return n.length<=0&&!d(e)&&n.push(e),{values:n,colors:Array.prototype.slice.call(t,1)}},t.acceptsReference=rt,t},paint:v[T]}),B=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.AreaSparkline=B,m(B.prototype,{createFunction:function(){var t=new h(x,1,7);return t.evaluate=function(t){return{points:st(t[0]),mini:t[1],maxi:t[2],line1:t[3],line2:t[4],colorPositive:t[5],colorNegative:t[6]}},t.acceptsReference=rt,t},paint:v[x]}),G=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.ScatterSparkline=G,m(G.prototype,{createFunction:function(){var t=new h(S,1,18);return t.evaluate=function(t){return{points1:lt(t[0],0),points2:lt(t[1],0),minX:t[2],maxX:t[3],minY:t[4],maxY:t[5],hLine:t[6],vLine:t[7],xMinZone:t[8],xMaxZone:t[9],yMinZone:t[10],yMaxZone:t[11],tags:t[12],drawSymbol:t[13],drawLines:t[14],color1:t[15],color2:t[16],dash:t[17]}},t.acceptsReference=function(t){return 0===t||1===t},t},paint:v[S]}),H=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.BulletSparkline=H,m(H.prototype,{createFunction:function(){var t=new h(A,3,17);return t.evaluate=function(t){return{measure:ut(t[0]),target:ut(t[1]),maxi:ut(t[2]),good:ut(t[3]),bad:ut(t[4]),forecast:ut(t[5]),tickUnit:ut(t[6]),colorScheme:t[7],vertical:t[8],measureColor:t[9],targetColor:t[10],maxiColor:t[11],goodColor:t[12],badColor:t[13],forecastColor:t[14],allowMeasureOverMaxi:t[15],barSize:t[16]}},t.acceptsReference=function(t){return 0<=t&&t<=6},t},paint:v[A]}),V=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.SpreadSparkline=V,m(V.prototype,{createFunction:function(){var t=new h(I,1,7);return t.evaluate=function(t){var e,n,o,r,i,a,s,l,u=st(t[0]),c=[];if(!d(u)&&(c=function(t){var e,n,o,r,i,a={};for(e=0,n=void 0,o=t.length;e<o;e++)a[n=t[e]]?a[n]++:a[n]=1;for(i in r=[],a)a.hasOwnProperty(i)&&r.push({key:w(i),value:a[i]});return r.sort((function(t,e){return t.key-e.key}))}(u=function(t){var e,n,o,r,i=[];for(n=0,o=0,r=t.length;n<r;n++)e=w(t[n]),!b(e)&&isFinite(e)&&(i[o]=e,o++);return i}(u)),3===(e=t[4])))for(n=0,o=c.length;n<o;n++){for(i=(r=c[n]).value,a=[],s=Math.max(100,10*i),l=0;l<s+i-1;l++)a.push(Math.random());r.randomNumbers=a}return{spreadData:c,showAverage:t[1],scaleStart:t[2],scaleEnd:t[3],style:e,colorScheme:t[5],vertical:t[6]}},t.acceptsReference=rt,t},paint:v[I]}),z=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.StackedSparkline=z,m(z.prototype,{createFunction:function(){var t=new h(R,1,13);return t.evaluate=function(t){return{points:st(t[0]),colorRange:st(t[1]),labelRange:st(t[2]),maximum:t[3],targetRed:t[4],targetGreen:t[5],targetBlue:t[6],targetYellow:t[7],color:t[8],highlightPosition:t[9],vertical:t[10],textOrientation:t[11],textSize:t[12]}},t.acceptsReference=function(t){return 0<=t&&t<=2},t},paint:v[R]}),W=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.HBarSparkline=W,m(W.prototype,{createFunction:function(){var t=new h(k,1,4);return t.evaluate=function(t){return{value:ut(t[0]),colorScheme:t[1],axisVisible:t[2],barHeight:t[3]}},t.acceptsReference=rt,t},paint:v[k]}),U=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.VBarSparkline=U,m(U.prototype,{createFunction:function(){var t=new h(M,1,4);return t.evaluate=function(t){return{value:ut(t[0]),colorScheme:t[1],axisVisible:t[2],barWidth:t[3]}},t.acceptsReference=rt,t},paint:v[M]}),q=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.VariSparkline=q,m(q.prototype,{createFunction:function(){var t=new h(N,1,10);return t.evaluate=function(t){return{variance:ut(t[0]),reference:ut(t[1]),mini:ut(t[2]),maxi:ut(t[3]),mark:ut(t[4]),tickUnit:ut(t[5]),legend:t[6],colorPositive:t[7],colorNegative:t[8],vertical:t[9]}},t.acceptsReference=function(t){return 0<=t&&t<=5},t},paint:v[N]}),Y=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.BoxPlotSparkline=Y,m(Y.prototype,{createFunction:function(){function t(t,e){return c(t)&&!b(e)&&0<=e&&e<=100?p.PERCENTILE.evaluate(t,e/100):NaN}function e(t){return c(t)?p.STDEVP.evaluate(t):NaN}var n=new h(E,1,10);return n.evaluate=function(n){var o=n[0];return{points:st(o),boxPlotClass:n[1],showAverage:n[2],scaleStart:ut(n[3]),scaleEnd:ut(n[4]),acceptableStart:ut(n[5]),acceptableEnd:ut(n[6]),colorScheme:n[7],style:n[8],vertical:n[9],perc02:t(o,2),perc09:t(o,9),perc10:t(o,10),perc90:t(o,90),perc91:t(o,91),perc98:t(o,98),q1:t(o,25),q3:t(o,75),median:t(o,50),stDev:e(o)}},n.acceptsReference=rt,n},paint:v[E]}),X=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.CascadeSparkline=X,m(X.prototype,{createFunction:function(){var t=new h(D,1,10);return t.evaluate=function(t){return{points:st(t[0]),pointIndex:ut(t[1]),labels:st(t[2]),minimum:ut(t[3]),maximum:ut(t[4]),colorPositive:t[5],colorNegative:t[6],vertical:t[7],itemTypeRange:st(t[8],!0),colorTotal:t[9]}},t.acceptsReference=at,t.acceptsArray=at,t},paint:v[D]}),Z=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.ParetoSparkline=Z,m(Z.prototype,{createFunction:function(){var t=new h(O,1,12);return t.evaluate=function(t){return{points:st(t[0]),pointIndex:ut(t[1]),colorRange:st(t[2],!0),target:ut(t[3]),target2:ut(t[4]),highlightPosition:ut(t[5]),label:t[6],vertical:t[7],targetColor:t[8],target2Color:t[9],labelColor:t[10],barSize:t[11]}},t.acceptsReference=it,t.acceptsArray=it,t},paint:v[O]}),Q=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.MonthSparkline=Q,m(Q.prototype,{createFunction:function(){var t=new h(j,3,7);return t.evaluate=function(t){var e,n,o,r,i,a,s,l,u,f=t[0],h=t[1],p=t[2],d=p;for(c(p)&&(d=lt(p,0)),e=t[3],n=[],c(e)&&(n=lt(e,0)),o=[],r=[],i=0,a=d.length;i<a;i++)(s=d[i])&&((l=s[0])&&l.getFullYear()===f&&l.getMonth()+1===h&&(o[u=l.getDate()-1]=s[1],n.length>0&&(r[u]=n[i][0])));return n.length>0?{year:f,month:h,values:o,colors:r}:{year:f,month:h,values:o,emptyColor:e,startColor:t[4],middleColor:t[5],endColor:t[6]}},t.acceptsReference=function(t){return 2===t||3===t},t},paint:v[j]}),J=function(t){function e(){return t.call(this)||this}return ot(e,t),e.daysOfMonth=function(t,e){switch(e){case 2:return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}},e.dayInYear=function(t){var n,o=t.getFullYear(),r=t.getMonth(),i=t.getDate();for(n=1;n<r+1;n++)i+=e.daysOfMonth(o,n);return i},e}(_),e.YearSparkline=J,m(J.prototype,{createFunction:function(){var t=new h(F,2,6);return t.evaluate=function(t){var e,n,o,r,i,a,s,l,u,f=t[0],h=t[1],p=h;for(c(h)&&(p=lt(h,0)),e=t[2],n=[],c(e)&&(n=lt(e,0)),o=[],r=[],i=0,a=p.length;i<a;i++)(s=p[i])&&((l=s[0])&&l.getFullYear()===f&&(o[u=J.dayInYear(l)-1]=s[1],n.length>0&&(r[u]=n[i][0])));return n.length>0?{year:f,values:o,colors:r}:{year:f,values:o,emptyColor:e,startColor:t[3],middleColor:t[4],endColor:t[5]}},t.acceptsReference=function(t){return 1===t||2===t},t},paint:v[F]}),$=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.LineSparkline=$,m($.prototype,{createFunction:function(){return ct("LINESPARKLINE",0)},paint:ft}),K=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.ColumnSparkline=K,m(K.prototype,{createFunction:function(){return ct("COLUMNSPARKLINE",1)},paint:ft}),tt=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.WinlossSparkline=tt,m(tt.prototype,{createFunction:function(){return ct("WINLOSSSPARKLINE",2)},paint:ft}),et=function(t){function e(){return t.call(this)||this}return ot(e,t),e}(_),e.RangeBlockSparkline=et,m(et.prototype,{createFunction:function(){var t=new h("RANGEBLOCKSPARKLINE",2,2);return t.evaluate=function(t){var e=t[0],n=e.getSource().getSheet(),o=e.getRow(0),r=e.getColumn(0),i=e.getRowCount(0),a=e.getColumnCount(0);return{templateSheetName:n.name(),templateRange:{row:o,col:r,rowCount:i,colCount:a},bindingObject:t[1]}},t.acceptsReference=rt,t},paint:function(t,e,o,r,i,a,c){var f,h,p,d,g,m=e.templateSheetName,y=e.templateRange;m&&((h=(f=c.sheet.parent)&&f.getSheetFromName(m))&&(l||(p=n("CellTypes"),l=p.Xgc,s=p.Wgc,u=p.paintRangeTemplate),d=(new l).YE(h,y),g=(new s).YE(h,y),u(t,{x:o,y:r,width:i,height:a},e.bindingObject,c,d,g.NJb)))}}),nt={},e.w_a=nt,h&&(ht(new L),ht(new B),ht(new G),ht(new H),ht(new V),ht(new z),ht(new W),ht(new U),ht(new q),ht(new Y),ht(new X),ht(new Z),ht(new Q),ht(new J),ht(new $),ht(new K),ht(new tt),ht(new et)),m(r.Workbook.prototype,{addSparklineEx:function(t){this.dT||(this.dT={});var e=this.dT;t&&(e[t.name()]=t)},getSparklineEx:function(t){var e,n=nt[t];return n||(e=this.dT)&&e[t]},removeSparklineEx:function(t){var e=this.dT;e&&(e[t]=void 0)}}),r.Workbook.$n("sparklineEx",{toJson:function(t){var e,n,o=this.dT,r=[];if(o){for(e in o)o.hasOwnProperty(e)&&((n=o[e].toJSON())&&n.typeName&&r.push(n));r.length>0&&(t.sparklineExs=r)}},fromJson:function(t){var e,n,o,i,a=t.sparklineExs;if(a)for(e=0;e<a.length;e++)n=a[e],(o=r.getTypeFromString(n.typeName))&&((i=new o).fromJSON(n),this.addSparklineEx(i))}})},"./dist/plugins/sparkline/sparkline-wrapper.entry.js":function(t,e,n){"use strict";var o,r;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/sparkline/functions-sparkline.js"),e.w_a=o.w_a,e.PieSparkline=o.PieSparkline,e.AreaSparkline=o.AreaSparkline,e.ScatterSparkline=o.ScatterSparkline,e.BulletSparkline=o.BulletSparkline,e.SpreadSparkline=o.SpreadSparkline,e.StackedSparkline=o.StackedSparkline,e.HBarSparkline=o.HBarSparkline,e.VBarSparkline=o.VBarSparkline,e.VariSparkline=o.VariSparkline,e.BoxPlotSparkline=o.BoxPlotSparkline,e.CascadeSparkline=o.CascadeSparkline,e.ParetoSparkline=o.ParetoSparkline,e.MonthSparkline=o.MonthSparkline,e.YearSparkline=o.YearSparkline,e.LineSparkline=o.LineSparkline,e.ColumnSparkline=o.ColumnSparkline,e.WinlossSparkline=o.WinlossSparkline,e.RangeBlockSparkline=o.RangeBlockSparkline,e.SparklineEx=o.SparklineEx,e.SparklineExValue=o.SparklineExValue,r=n("./dist/plugins/sparkline/sparkline-wrapper.js"),e.EmptyValueStyle=r.EmptyValueStyle,e.SparklineAxisMinMax=r.SparklineAxisMinMax,e.SparklineSetting=r.SparklineSetting,e.SparklineType=r.SparklineType,e.DataOrientation=r.DataOrientation,e.Sparkline=r.Sparkline},"./dist/plugins/sparkline/sparkline-wrapper.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k;function M(t,e){var n=a.formulaToRanges(t,e,0,0)[0],o=n&&n.ranges&&n.ranges[0];return o?{range:o,sheetName:n.sheetName}:m}function N(t,e,n,o){var r=this.ZA;r.JUa(t,e,o),o&&r.add(o.group()),this.Bq("sparkline",t,e,3,n,o)}function E(t,e){return t+"_"+e}function D(t,e,n){return n?t>n.row+n.rowCount-1?n:t>n.row?l(n.row,n.col,n.rowCount+e,n.colCount):l(n.row+e,n.col,n.rowCount,n.colCount):m}function O(t,e,n){return n?t>n.col+n.colCount-1?n:t>n.col?l(n.row,n.col,n.rowCount,n.colCount+e):l(n.row,n.col+e,n.rowCount,n.colCount):m}function j(t,e,n,r,i){var a,s,l,u,c,f,h,p,d,g,y,v,C=new o.KTa;for(a=0;a<t.length;a++)for(l=(s=t[a]).PS,s.displayDateAxis&&(void 0,c=s.dateAxisData(),u=r?D(e,n,c):O(e,n,c),s.dateAxisData(u)),f=0;f<l.length;f++)h=l[f],e<=(r?h.row:h.column)&&(C.set(a,f,h),i.JUa(h.row,h.column,m),r?h.row+=n:h.column+=n),void 0,d=h.data(),p=r?D(e,n,d):O(e,n,d),h.data(p);for(g=0;g<t.length;g++)for(y=t[g].PS,v=0;v<y.length;v++)i.SUa(C.get(g,v))}function F(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,v,C,b;for(a=0;a<o.length;a++)(s=o[a]).displayDateAxis&&(u=(l=s.OW()).ITa,c=!1,i&&!u.zTa&&(u.zTa=[],c=!0),void 0,h=s.dateAxisData(),f=n?D(t,e,h):O(t,e,h),s.dateAxisData(f),c&&(i.push({sheetName:l.name(),changes:u.zTa}),u.zTa=y));for(p=0;p<r.length;p++)m=(g=(d=r[p]).bT()).ITa,v=!1,i&&!m.zTa&&(m.zTa=[],v=!0),void 0,b=d.data(),C=n?D(t,e,b):O(t,e,b),d.data(C),v&&(i.push({sheetName:g.name(),changes:m.zTa}),m.zTa=y)}function P(t,e,n){var o=L(n.col,n.col+n.colCount-1,t,t+e-1);return o?l(n.row,o.start,n.rowCount,o.end-o.start+1):m}function _(t,e,n){var o=L(n.row,n.row+n.rowCount-1,t,t+e-1);return o?l(o.start,n.col,o.end-o.start+1,n.colCount):m}function L(t,e,n,o){var r,i,a,s,l,u=-1;if(o<t)return{start:u=t-(i=o-n+1),end:e-i};if(n>e)return{start:u=t,end:e};if(n<=t){for(a=e-t+1,s=0,r=t;r<=o&&r<=e;r++)s++;return{start:u=n,end:u+a-s-1}}for(l=0,r=t;r<=e;r++)-1===u&&(r<n||r>o)&&(u=r),(r<n||r>o)&&l++;return-1!==u&&l>0?{start:u,end:u+l-1}:m}function B(t,e,n,r,i){var a,s,l,c,f,p,d,g,y,C,b,w,T,x,S=new o.KTa,A=t.length,I=0;for(a=A-1;a>-1;a--){if((s=t[a]).displayDateAxis){if(void 0,c=s.dateAxisData(),l=r?_(e,n,c):P(e,n,c),u(l)){s.clear(),i.remove(s);continue}s.dateAxisData(l)}for(f=(f=[]).concat(s.PS),p=h(f),I=v(p,I),d=p-1;d>-1;d--)g=f[d],(y=r?g.row:g.column)>=e&&y<e+n?(s.remove(g),i.JUa(g.row,g.column,m)):(e<=y&&(i.JUa(g.row,g.column,m),r?g.row-=n:g.column-=n,S.set(a,d,g)),void 0,b=g.data(),C=r?_(e,n,b):P(e,n,b),u(C)?s.remove(g):g.data(C));s.count()<=0&&i.remove(s)}for(T=0;T<A;T++)for(x=0;x<I;x++)(w=S.get(T,x))&&i.SUa(w)}function G(t,e,n,o,r,i){var a,s,l,c,f,h,p,d,g,m,v,C,b,w,T;for(a=o.length-1;a>-1;a--)(s=o[a]).displayDateAxis&&(c=(l=s.OW()).ITa,f=!1,i&&!c.zTa&&(c.zTa=[],f=!0),void 0,p=s.dateAxisData(),h=n?_(t,e,p):P(t,e,p),u(h)?(s.clear(),s.ZA.remove(s)):s.dateAxisData(h),f&&(i.push({sheetName:l.name(),changes:c.zTa}),c.zTa=y));for(d=r.length-1;d>-1;d--)v=(m=(g=r[d]).bT()).ITa,C=!1,i&&!v.zTa&&(v.zTa=[],C=!0),void 0,w=g.data(),b=n?_(t,e,w):P(t,e,w),u(b)?((T=g.group()).remove(g),T.count()<=0&&T.ZA.remove(T)):g.data(b),C&&(i.push({sheetName:m.name(),changes:v.zTa}),v.zTa=y)}function H(t,e){var n=!1;return"setting"===t||"axisReference"===t?n=e===m:"displayDateAxis"===t?n=!1===e:"axisOrientation"===t?n=1===e:"sparklines"===t&&(n=0===e.length),n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("@grapecity/js-calc"),a=n("SheetsCalc"),s=o.GC$.isEmptyObject,l=o.kf,u=r.Common.j.Fa,c=r.Common.k,f=c.Fb,h=c.ac,p=c.Bb,d=r.Sparklines.Vd,g=r.Sparklines.SparklineRender,m=null,y=void 0,v=Math.max,C=Number.MAX_VALUE,o.GC$.extend(o.lUa.prototype,{FUa:function(t){var e,n,o,r=this,i=r.zTa,a=arguments[1];if(i){switch(i.GUa||(i.GUa=[]),e={type:t},t){case 0:o=void 0,o=(n=a)&&n.sparkline?n.sparkline:m,e.HUa={row:n.row,col:n.col,sparkline:o};break;case 12:case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:e.HUa=a}i.GUa.push(e)}},IUa:function(t){var e,n,o,r,i,a,s,u,c,p,d,g=this,y=t.HUa;switch(t.type){case 12:y.sparkline?(y.sparkline.row=y.row,y.sparkline.column=y.col,g.ZA.JUa(y.row,y.col,y.sparkline)):g.ZA.JUa(y.row,y.col,m);break;case 0:g.ZA.JUa(y.row,y.col,y.sparkline),y.sparkline&&!g.ZA.contains(y.sparkline.group())&&g.ZA.add(y.sparkline.group());break;case 1:for(e=void 0,n=void 0,o=void 0,r=h(y),i=0;i<r;i++)e=y[i].row,n=y[i].col,o=g.ZA.KUa(e,n),0===i&&o.cb.count()===r&&g.ZA.remove(o.cb),this.ZA.add(o.group(y[i].group).cb);break;case 2:for(a=[],s=0;s<h(y);s++)a.push(g.ZA.KUa(y[s].row,y[s].col));g.ZA.kj.groupSparkline(a);break;case 3:g.ZA.KUa(y.row,y.col).sparklineType(y.sparklineType);break;case 4:g.ZA.KUa(y.row,y.col).setting(y.setting);break;case 5:y.sparkline.data(y.data);break;case 15:g.ZA.KUa(y.row,y.col).dataSheetName(y.dataSheetName);break;case 6:g.ZA.KUa(y.row,y.col).dataOrientation(y.dataOrientation);break;case 7:g.ZA.KUa(y.row,y.col).displayDateAxis(y.displayDateAxis);break;case 8:void 0,u=(c=y.rangeInfo)?l(c.row,c.col,c.rowCount,c.colCount):c,y.group.dateAxisData(u);break;case 16:y.group.dateAxisDataSheetName(y.dateAxisDataSheetName);break;case 9:y.group.dateAxisOrientation(y.dateAxisOrientation);break;case 10:for(y.group.PS.forEach((function(t){g.ZA.vZa(t)})),y.group.PS=y.PS,p=y.group.PS,d=0;d<h(p);d++)p[d].group(y.group);p.forEach((function(t){g.ZA.tZa(t)}));break;case 11:g.ZA.KUa(y.row,y.col).group(y.group);break;case 13:f(g.ZA.groups(),y),g.ZA.yZa(y);break;case 14:g.ZA.groups().push(y),g.ZA.zZa(y)}},LUa:function(t){var e;for(e=h(t)-1;e>=0;e--)this.IUa(t[e])},MUa:function(t,e){this.ZA.rI(t,e)},NUa:function(t,e){this.ZA.GR(t,e)},OUa:function(t,e){this.ZA.tI(t,e)},PUa:function(t,e){this.ZA.HR(t,e)},QUa:function(t,e,n,o){this.ZA.clear(t,e,n,o)},wZa:function(){var t=this.zTa;return t?(t.xZa||(t.xZa=[]),t.xZa):m}}),o.lUa.$n("sparkline",{init:function(){var t=this.kj;this.ZA=new T(t)},undo:function(t){var e,n,o=t.GUa;o&&this.LUa(o),e=this.kj,(n=t.xZa)&&n.forEach((function(t){e.parent.getSheetFromName(t.sheetName).ITa.undo(t.changes)}))}}),b={init:function(){this.ZA=this.ITa.ZA},dispose:function(t){if(!1!==t.clearCache){var e=this;e.ZA&&(e.ZA.kj=m,e.ZA.evaluator=m,e.ZA=m),e.ITa&&(e.ITa.ZA=m)}},onLayoutChanged:function(t){var e,n=t.changeType,o=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=this.ITa;"addRows"===n?s.MUa(o,r):"deleteRows"===n?s.NUa(o,r):"addColumns"===n?s.OUa(i,a):"deleteColumns"===n?s.PUa(i,a):"clear"===n&&(e=t.type,3===t.sheetArea&&16==(16&e)&&s.QUa(o,i,r,a))},toJson:function(t,e){e&&e.ignoreStyle||(t.sparklineGroups=this.ZA.toJSON())},fromJson:function(t,e,n){var o=n&&n.ignoreStyle,r=this.ZA,i=t.sparklineGroupManager,a=e?i&&i.groups:t.sparklineGroups;a&&!o&&r.RUa(a,e)},setName:function(t){var e=t.oldName,n=t.newName;this.ZA.jOa(e,n)}},o.Worksheet.$n("sparkline",b),w={getSparkline:function(t,e){return this.ZA?this.ZA.KUa(t,e):m},setSparkline:function(t,e,n,o,r,i,a,s){var l,c,f,h,p,d,g=this;if(!g.ZA)return m;if("string"==typeof n){if(!(c=M(g,n)))return m;n=c.range,l=c.sheetName}if(f=new k(t,e,n,o,r,i),l&&l!==g.name()&&f.dataSheetName(l),a&&!u(s)){if(h=void 0,"string"==typeof a){if(!(p=M(g,a)))return m;a=p.range,h=p.sheetName}f.dateAxisData(a),h&&h!==g.name()&&f.dateAxisDataSheetName(h),f.dateAxisOrientation(s),f.group().displayDateAxis=!0}return d=g.getSparkline(t,e),g.removeSparkline(t,e),N.call(g,t,e,d,f),g.$p(),f},WLb:function(t,e,n){var o=this.getSparkline(t,e);N.call(this,t,e,o,n)},removeSparkline:function(t,e){var n,o,r,i=this,a=i.ZA;a&&(o={row:t,col:e,sparkline:n=i.getSparkline(t,e)},i.ITa.FUa(0,o),n&&((r=n.group()).remove(n),r.count()<=0&&a.remove(r),N.call(i,t,e,n,m)),i.$p())},groupSparkline:function(t){var e,n,o,r,i,a,s=this,l=s.ZA;if(!l)return m;for(e=m,n=[],o=s.ITa.zTa!==y,r=0;r<t.length;r++)(i=t[r])&&(o&&n.push({group:i.group().clone(),row:i.row,col:i.column}),e?((a=i.group()).remove(i),e.add(i),a.count()<=0&&l.remove(a)):e=i.group());return s.$p(),s.ITa.FUa(1,n),e},ungroupSparkline:function(t){var e,n,o,r,i,a,s=this,l=s.ZA;if(l&&t){for(e=[],n=[],o=s.ITa.zTa!==y,e=e.concat(t.PS),r=0;r<e.length;r++)(i=e[r])&&(o&&n.push({row:i.row,col:i.column}),t.remove(i),(a=t.clone()).add(i),l.add(a));l.remove(t),s.ITa.FUa(2,n),s.$p()}}},o.GC$.extend(o.Worksheet.prototype,w),T=function(){function t(t){this.Ub=[],this.kj=t,this.xn={},this.qZa=[],this.rZa=[]}return t.prototype.RUa=function(t,e){var n=this;n.fromJSON(t,e),n.groups().forEach((function(t){t.PS.forEach((function(t){n.SUa(t)}))}))},t.prototype.SUa=function(t){t&&this.JUa(t.row,t.column,t)},t.prototype.JUa=function(t,e,n){if(this.kj.ITa.zTa){var o={row:t,col:e,sparkline:this.KUa(t,e)};this.kj.ITa.FUa(12,o)}n?this.xn[E(t,e)]=n:delete this.xn[E(t,e)]},t.prototype.KUa=function(t,e){return this.xn[E(t,e)]||m},t.prototype.groups=function(t){return 0===arguments.length?this.Ub:void(this.Ub=t)},t.prototype.add=function(t){var e=this;e.kj.ITa.FUa(13,t),e.groups().push(t),t.ZA=e,t.QS(),e.zZa(t)},t.prototype.zZa=function(t){var e=this;e.sZa(t),t.all().forEach((function(t){e.tZa(t)}))},t.prototype.remove=function(t){var e=this;e.kj.ITa.FUa(14,t),f(e.groups(),t),e.yZa(t)},t.prototype.yZa=function(t){var e=this;e.uZa(t),t.all().forEach((function(t){e.vZa(t)}))},t.prototype.contains=function(t){return p(this.groups(),t)},t.prototype.count=function(){return this.groups().length},t.prototype.rI=function(t,e){j(this.Ub,t,e,!0,this),F(t,e,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.tI=function(t,e){j(this.Ub,t,e,!1,this),F(t,e,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.GR=function(t,e){B(this.Ub,t,e,!0,this),G(t,e,!0,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.HR=function(t,e){B(this.Ub,t,e,!1,this),G(t,e,!1,this.rZa,this.qZa,this.kj.ITa.wZa())},t.prototype.jOa=function(t,e){this.rZa.forEach((function(n){n.dateAxisDataSheetName()===t&&n.dateAxisDataSheetName(e)})),this.qZa.forEach((function(n){n.dataSheetName()===t&&n.dataSheetName(e)}))},t.prototype.tZa=function(t){var e,n,o=this.kj,r=t.dataSheetName();r&&r!==o.name()&&((e=o.parent.getSheetFromName(r))&&((n=e.ZA.qZa).indexOf(t)<0&&n.push(t)))},t.prototype.vZa=function(t){var e,n,o,r=t.dataSheetName();r&&((e=this.kj.parent.getSheetFromName(r))&&((o=(n=e.ZA.qZa).indexOf(t))>=0&&n.splice(o,1)))},t.prototype.sZa=function(t){var e,n,o=this.kj,r=t.dateAxisDataSheetName();r&&r!==o.name()&&((e=o.parent.getSheetFromName(r))&&((n=e.ZA.rZa).indexOf(t)<0&&n.push(t)))},t.prototype.uZa=function(t){var e,n,o,r=t.dateAxisDataSheetName();r&&((e=this.kj.parent.getSheetFromName(r))&&((o=(n=e.ZA.rZa).indexOf(t))>=0&&n.splice(o,1)))},t.prototype.clear=function(t,e,n,o){var r,i,a,s,l,u,c,f,p,d=this;if(0===arguments.length){for(r=d.Ub,i=h(r)-1;i>-1;i--)if(a=r[i]){for(s=a.count()-1;s>-1;s--)l=a.PS[s],d.JUa(l.row,l.column,m),a.remove(l);d.remove(a)}}else for(u=t;u<t+n;u++)for(c=e;c<e+o;c++)(f=d.RS(u,c))&&(d.JUa(f.row,f.column,m),(p=f.group()).remove(f),0===p.count()&&d.remove(p))},t.prototype.RS=function(t,e){var n,o,r,i,a=this.Ub;for(n=0;n<a.length;n++)for(o=a[n],r=0;r<o.count();r++)if((i=o.PS[r])&&i.row===t&&i.column===e)return i;return m},t.prototype.Zz=function(t,e,n,r,i,a,s){var l,c,f,h,p,d,g,m,y,v,C,b,w=this,T=w.kj;if(T){for(l=new o.KTa,c=n-t,f=r-e,d=T.getRowCount(),g=T.getColumnCount(),m=T.ZA,h=0;h<i;h++)if(!(s&&T.Ps&&T.Ps(n+h)))for(p=0;p<a;p++)(y=T.getSparkline(t+h,e+p))&&((v=y.clone()).row=n+h,v.column=r+p,C=v.dateAxisData(),!u(C)&&w.SS(C,c,f,d,g)&&v.dateAxisData(C.offset(f,c)),b=v.data(),!u(b)&&w.SS(b,c,f,d,g)&&v.data(b.offset(f,c)),w.add(v.group()),l.set(h,p,v));for(h=0;h<i;h++)if(!(s&&T.Ps&&T.Ps(n+h)))for(p=0;p<a;p++)m.JUa(n+h,r+p,l.get(h,p))}},t.prototype.SS=function(t,e,n,o,r){var i,a,s,l,u=this.TS(t);return!(!u||(i=v(u.row,0),a=v(u.col,0),s=u.row<0?o:u.rowCount,l=u.col<0?r:u.colCount,i+e<0||a+n<0||i+s+e>o||a+l+n>r))},t.prototype.aB=function(t,e,n,r,i,a){var s,l,u,c,f,h=this.kj;if(h){for(this.US(t,e,n,r,i,a),s=h.ZA,l=new o.KTa,u=0;u<i;u++)for(c=0;c<a;c++)(f=h.getSparkline(t+u,e+c))&&(f.row=n+u,f.column=r+c,l.set(u,c,f)),s.JUa(t+u,e+c,m);for(u=0;u<i;u++)for(c=0;c<a;c++)h.removeSparkline(n+u,r+c),s.JUa(n+u,r+c,l.get(u,c))}},t.prototype.US=function(t,e,n,o,r,i){var a,s,u,c,f,h,p,d,g=this,m=l(t,e,r,i),y=n-t,v=o-e,C=g.Ub;for(a=0;a<C.length;a++)for(s=C[a].PS,u=0;u<s.length;u++)(c=s[u])&&(f=c.dateAxisData(),(h=g.TS(f))&&m.containsRange(h)&&m.contains(c.row,c.column)&&c.dateAxisData(f.offset(v,y)),p=c.data(),(d=g.TS(p))&&m.containsRange(d)&&m.contains(c.row,c.column)&&c.data(p.offset(v,y)))},t.prototype.TS=function(t){return t},t.prototype._A=function(t,e,n,o,r,i,a,s){var l,c,f,h,p,d,g,y,v,C,b,w=this,T=w.kj;if(T){if(t===T)return void w.Zz(e,n,o,r,i,a);for(l=o-e,c=r-n,f=T.ZA,h=T.getRowCount(),p=T.getColumnCount(),d=0;d<i;d++)if(!(s&&T.Ps&&T.Ps(o+d)))for(g=0;g<a;g++)(y=t.getSparkline(e+d,n+g))?((v=y.clone()).row=o+d,v.column=r+g,C=v.dateAxisData(),!u(C)&&w.SS(C,l,c,h,p)&&v.dateAxisData(C.offset(c,l)),b=v.data(),!u(b)&&w.SS(b,l,c,h,p)&&v.data(b.offset(c,l)),w.add(v.group()),f.JUa(o+d,r+g,v)):f.JUa(o+d,r+g,m)}},t.prototype.$A=function(t,e,n,o,r,i,a){var s,l,u,c,f,h,p,d=this,g=d.kj;if(g){if(t===g)return void d.aB(e,n,o,r,i,a);for(s=t.ZA,l=g.ZA,d.VS(t,e,n,o,r,i,a),u=0;u<i;u++)for(c=0;c<a;c++)(f=t.getSparkline(e+u,n+c))?(f.row=o+u,f.column=r+c,p=(h=f.group()).clone(),h.remove(f),h.count()<=0&&s.remove(h),p.add(f),d.add(p),l.JUa(o+u,r+c,f)):l.JUa(o+u,r+c,m),s.JUa(e+u,n+c,m)}},t.prototype.VS=function(t,e,n,o,r,i,a){var s,u,c,f,h,p,d,g,m,y,v,C,b=this,w=b.kj;if(t&&w){if(t===w)return void b.US(e,n,o,r,i,a);for(s=l(e,n,i,a),u=o-e,c=r-n,f=t.ZA.Ub,h=0;h<f.length;h++)for(p=f[h],d=0;d<p.PS.length;d++)(g=p.PS[d])&&(m=g.dateAxisData(),(y=b.TS(m))&&s.containsRange(y)&&s.contains(g.row,g.column)&&g.dateAxisData(m.offset(c,u)),v=g.data(),(C=b.TS(v))&&s.containsRange(C)&&s.contains(g.row,g.column)&&g.data(v.offset(c,u)))}},t.prototype.toJSON=function(){var t,e=this.Ub,n=[];for(t=0;e&&t<e.length;t++)n.push(e[t].toJSON());return 0===n.length?y:n},t.prototype.fromJSON=function(t,e){var n,o,r;for(this.Ub.length=0,this.xn={},n=0;t&&n<t.length;n++)o=t[n],(r=new R).fromJSON(o,e),this.add(r)},t}(),function(t){t[t.gaps=0]="gaps",t[t.zero=1]="zero",t[t.connect=2]="connect"}(e.EmptyValueStyle||(e.EmptyValueStyle={})),function(t){t[t.individual=0]="individual",t[t.group=1]="group",t[t.custom=2]="custom"}(e.SparklineAxisMinMax||(e.SparklineAxisMinMax={})),x=r.Common.pc.bc(255,149,179,215),S=r.Common.pc.bc(255,36,64,98),A={axisColor:"black",firstMarkerColor:x,highMarkerColor:"Blue",lastMarkerColor:x,lowMarkerColor:"Blue",markersColor:S,negativeColor:"Brown",seriesColor:S,displayEmptyCellsAs:0,rightToLeft:!1,displayHidden:!1,displayXAxis:!1,showFirst:!1,showHigh:!1,showLast:!1,showLow:!1,showNegative:!1,showMarkers:!1,manualMax:0,manualMin:0,maxAxisType:0,minAxisType:0,lineWeight:1},I=function(){function t(t){var e,n=this;for(e in n.options={},A)A.hasOwnProperty(e)&&(n.options[e]=t&&t[e]?t[e]:A[e]);n.WS=m}return t.prototype.clone=function(){return new t(this.options)},t.prototype.toJSON=function(){var t,e=this.options,n={};for(t in e)A[t]!==e[t]&&(n[t]=e[t]);return s(n)?y:n},t}(),e.SparklineSetting=I,function(t){t[t.line=0]="line",t[t.column=1]="column",t[t.winloss=2]="winloss"}(e.SparklineType||(e.SparklineType={})),function(t){t[t.vertical=0]="vertical",t[t.horizontal=1]="horizontal"}(e.DataOrientation||(e.DataOrientation={})),R=function(){function t(t,e){var n=this;n.displayDateAxis=!1,n.ZA=m,n.PS=[],n.XS=m,n.YS=1,n.setting=e,n.sparklineType=t}return t.prototype.OW=function(){var t;return this.ZA&&(t=this.ZA.kj),t},t.prototype.TUa=function(){var t,e=this,n=e.OW();n&&n.ITa.zTa&&(t={group:e,PS:e.PS.concat()},n.ITa.FUa(10,t))},t.prototype.add=function(t){var e,n=this;t&&(n.TUa(),n.PS.push(t),t.group(n),n.QS(),(e=n.ZA)&&e.tZa(t),n.onGroupChanged())},t.prototype.clear=function(){this.TUa();var t=this.ZA;t&&this.PS.forEach((function(e){t.vZa(e)})),this.PS=[]},t.prototype.all=function(){return this.PS},t.prototype.remove=function(t){var e,n=this,o=n.PS;return n.TUa(),f(o,t),t.onSparklineChanged(),t.cb=n.clone(),n.QS(),(e=n.ZA)&&e.vZa(t),n.onGroupChanged(),o},t.prototype.contains=function(t){return p(this.PS,t)},t.prototype.onGroupChanged=function(){var t,e,n=this.PS;if(n)for(t=0;t<n.length;t++)(e=n[t])&&e.onSparklineChanged()},t.prototype.clone=function(){var e=this,n=e.setting?e.setting.clone():m,o=new t(e.sparklineType,n);return o.displayDateAxis=e.displayDateAxis,o.XS=e.XS,o.nZa=e.nZa,o.YS=e.YS,o},t.prototype.dateAxisData=function(t){var e,n,o,r=this;return 0===arguments.length?r.XS:((e=r.OW())&&e.ITa.zTa&&(void 0,n={group:r,rangeInfo:r.XS?{row:r.XS.row,col:r.XS.col,rowCount:r.XS.rowCount,colCount:r.XS.colCount}:m},e.ITa.FUa(8,n)),o=r.XS,r.XS=t,void(o!==t&&r.onGroupChanged()))},t.prototype.dateAxisDataSheetName=function(t){var e,n,o,r=this;return 0===arguments.length?r.nZa:(e=r.nZa,(n=r.OW())&&n.ITa.zTa&&(o={group:r,dateAxisDataSheetName:e},n.ITa.FUa(16,o)),e!==t&&(e&&n&&n.ZA.uZa(r),r.nZa=t,t&&n&&n.ZA.sZa(r),r.onGroupChanged()),r)},t.prototype.dateAxisOrientation=function(t){var e,n,o,r=this;return 0===arguments.length?r.YS:((e=r.OW())&&e.ITa.zTa&&(n={group:r,dateAxisOrientation:r.YS},e.ITa.FUa(9,n)),o=r.YS,r.YS=t,void(o!==t&&r.onGroupChanged()))},t.prototype.count=function(){return this.PS.length},t.prototype.QS=function(){var t,e,n,o,r,i,a,s,l=this,u=l.setting,c=l.PS;if(u&&((t=u.options).groupMaxValue=-C,t.groupMinValue=C,e=1===t.maxAxisType,n=1===t.minAxisType,e||n))for(o=0;o<c.length;o++)r=c[o],a=(i=l.ZS(r)).min,s=i.max,e&&t.groupMaxValue<s&&(t.groupMaxValue=s),n&&t.groupMinValue>a&&(t.groupMinValue=a)},t.prototype.ZS=function(t){var e,n,o,r,i,a,s=-C,l=C,u=t.data();if(u)for(n=(e=t.bT())&&e.parent.getSheetFromName(t.dataSheetName()),o=t.$S(u,t.dataOrientation(),!1,n||e),r=0;r<o.length;r++)(i=o[r])===d&&(i=0),"number"==typeof i&&(s=s<(a=i)?a:s,l=l>a?a:l);return{min:l,max:s}},t.prototype.toJSON=function(){var t,e,n,o=this,r={setting:o.setting?o.setting.toJSON():m,displayDateAxis:o.displayDateAxis,sparklineType:o.sparklineType,axisOrientation:o.YS,sparklines:o.PS.map((function(t){return t.toJSON()}))},i=o.XS;for(e in i&&(r.axisReference={row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount,sheetName:o.nZa}),t={},r)r.hasOwnProperty(e)&&(H(e,n=r[e])||(t[e]=n));return s(t)?y:t},t.prototype.fromJSON=function(t,e){var n,o,r,i,a,s,c,f,h;if(t&&(n=this,o=t.displayDateAxis,r=t.sparklineType,i=t.axisReference,a=t.axisOrientation,s=t.sparklines,n.setting=new I(t.setting),u(o)||(n.displayDateAxis=o),u(r)||(n.sparklineType=r),u(i)||(n.XS=l(i.row,i.col,i.rowCount,i.colCount),n.nZa=i.sheetName),u(a)||(n.YS=a),s))for(n.PS=[],c=0,f=s.length;c<f;c++)(h=new k).fromJSON(s[c]),n.add(h)},t}(),k=function(){function t(t,e,n,o,r,i){var a=this;a.row=t,a.column=e,a._S=o,a.aT=n,a.cb=new R(r,i),a.cb.add(a)}return t.prototype.group=function(t){var e,n,o,r,i=this;return 0===arguments.length?((e=i.cb)||((e=new R).add(i),i.cb=e),e):(n=i.cb,(o=i.bT())&&o.ITa.zTa&&(r={row:i.row,col:i.column,group:n},o.ITa.FUa(11,r)),t!==n&&(n&&n.remove(i),i.cb=t,t&&!t.contains(i)&&t.add(i),i.onSparklineChanged()),o&&o.$p(),i)},t.prototype.sparklineType=function(t){var e,n,o,r,i=this;return 0===arguments.length?i.group().sparklineType:((n=(e=i.group()).sparklineType)!==t&&(e.sparklineType=t,(o=i.bT())&&o.ITa.zTa&&(r={row:i.row,col:i.column,sparklineType:n},o.ITa.FUa(3,r)),i.onSparklineChanged(),o&&o.$p()),i)},t.prototype.onSparklineChanged=function(){var t=this.bT();t&&t.Wq(o.Events.SparklineChanged,{sheet:t,sheetName:t.name(),sparkline:this})},t.prototype.setting=function(t){var e,n=this,r=n.group(),i=n.bT(),a=i&&i.ITa.zTa;return 0===arguments.length?(void 0,a?o.GC$.extend(!0,{},r.setting):r.setting):(a&&(e={row:n.row,col:n.column,setting:o.GC$.extend(!0,{},r.setting)},i.ITa.FUa(4,e)),r.setting=t,i&&i.$p(),n)},t.prototype.data=function(t){var e,n,r=this;return 0===arguments.length?r.aT:((e=r.bT())&&e.ITa.zTa&&(n={row:r.row,col:r.column,sparkline:r,data:o.GC$.extend(!0,{},r.aT)},e.ITa.FUa(5,n)),r.aT!==t&&(r.aT=t,r.onSparklineChanged()),e&&e.$p(),r)},t.prototype.dataSheetName=function(t){var e,n,o,r=this;return 0===arguments.length?r.oZa:(e=r.oZa,(n=r.bT())&&n.ITa.zTa&&(o={row:r.row,col:r.column,dataSheetName:e},n.ITa.FUa(15,o)),e!==t&&(e&&n&&n.ZA.vZa(r),r.oZa=t,t&&n&&n.ZA.tZa(r),r.onSparklineChanged()),r)},t.prototype.dataOrientation=function(t){var e,n,o=this;return 0===arguments.length?o._S:((e=o.bT())&&e.ITa.zTa&&(n={row:o.row,col:o.column,dataOrientation:o._S},e.ITa.FUa(6,n)),o._S!==t&&(o._S=t,o.onSparklineChanged()),e&&e.$p(),o)},t.prototype.dateAxisData=function(t){var e=this,n=e.group();return 0===arguments.length?n.dateAxisData():(n.dateAxisData(t),e)},t.prototype.dateAxisDataSheetName=function(t){var e=this,n=e.group();return 0===arguments.length?n.dateAxisDataSheetName():(n.dateAxisDataSheetName(t),e)},t.prototype.dateAxisOrientation=function(t){var e=this,n=e.group();return 0===arguments.length?n.dateAxisOrientation():(n.dateAxisOrientation(t),e)},t.prototype.displayDateAxis=function(t){var e,n,o=this,r=o.group();return 0===arguments.length?r.displayDateAxis:((e=o.bT())&&e.ITa.zTa&&(n={row:o.row,col:o.column,displayDateAxis:r.displayDateAxis},e.ITa.FUa(7,n)),r.displayDateAxis=t,o)},t.prototype.clone=function(){var e=this,n=new t;return n.row=e.row,n.column=e.column,n.data(e.data()),n.dataSheetName(e.dataSheetName()),n.dataOrientation(e.dataOrientation()),n.group(e.group().clone()),n},t.prototype.paintSparkline=function(t,e,n,r,i){var a,s,l,u=this,c=u.bT();c&&c.parent&&(a=c.parent.getSheetFromName(u.dataSheetName()),s=c.parent.getSheetFromName(u.dateAxisDataSheetName())),this.lKb&&(c=this.lKb),l={sparklineType:u.sparklineType(),displayDateAxis:u.displayDateAxis(),zoomFactor:c.zoom(),values:u.hKb||u.$S(u.data(),u.dataOrientation(),!1,a||c),dateValues:u.jKb||u.$S(u.dateAxisData(),u.dateAxisOrientation(),!0,s||c),settings:u.setting(),getColor:function(t){if(c&&t){var e=o.Rm.Om(c,t);if(e)return e}return t}},(new g).paint(t,l,e,n,r,i)},t.prototype.iKb=function(t){var e=this;return e.$S(e.data(),e.dataOrientation(),!1,t)},t.prototype.kKb=function(t){var e=this;return e.$S(e.dateAxisData(),e.dateAxisOrientation(),!0,t)},t.prototype.$S=function(e,n,o,r){var i=this.setting().options.displayHidden;return t.cT(y,r,i,e,n,o)},t.prototype.bT=function(){var t=this.group(),e=t&&t.ZA;return e?e.kj:m},t.prototype.toJSON=function(){var t=this;return{row:t.row,col:t.column,orientation:t._S,data:{row:t.aT.row,rowCount:t.aT.rowCount,col:t.aT.col,colCount:t.aT.colCount,sheetName:t.oZa}}},t.prototype.fromJSON=function(t){var e,n,o,r,i,a;t&&(e=this,n=t.row,o=t.col,r=t.orientation,i=t.data,u(n)||(e.row=n),u(o)||(e.column=o),u(r)||(e._S=r),i&&(a=i,e.aT=l(a.row,a.col,a.rowCount,a.colCount),e.oZa=a.sheetName))},t.cT=function(t,e,n,o,a,s){var l,c,f,h,p,g="number",m=[],y=1===a;if(e&&o)for(l=0,c=y?o.colCount:o.rowCount;l<c;l++)f=y?0:l,h=y?l:0,(p=t?t[f][h]:e.getValue(o.row+f,o.col+h))instanceof i.CalcError||(!n&&(e.getRowHeight(o.row+f)<=0||e.getColumnWidth(o.col+h)<=0)?p=NaN:u(p)||(s?p=typeof p===g?r.Common.l.Xb(p):Date.parse(p):typeof p!==g&&(p=d)),m.push(p));return m},t}(),e.Sparkline=k},"./dist/plugins/statusBar/baseStatusBar.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("./dist/plugins/statusBar/statusItem.js"),i=o.GC$,a=null,s="left",l="right",u=function(){function t(t){this.yzb=[],this.zzb=[],this.Azb=[],this.mi=0,this.qo=a,this.ET=t,this.Bzb()}return t.prototype.Bzb=function(){var t=this.qo,e=this.Czb;t||(t=this.qo=document.createElement("div"),e=this.Czb=document.createElement("div")),this.ET.appendChild(t),this.ET.appendChild(e)},t.prototype.Dzb=function(t){t.name||(t.name="statusItem"+this.mi,this.mi++)},t.prototype.mL=function(t,e){return t instanceof r.StatusItem&&!this.Jp(t.name)&&(this.Dzb(t),e>=0&&e<this.yzb.length?this.yzb.splice(e,0,t):this.yzb.push(t),t.align=t.align||s,t.Ezb(this.ET),!0)},t.prototype.Fzb=function(t,e){var n,o,r,i,s=!1,u=this.yzb,c=e>=0&&e<u.length,f=a,h=a;if(c&&(h=(f=u[e]).Gzb()),this.mL(t,e)){n=t.align===l;try{n?(r=(o=this.Azb).indexOf(f),i=o.length-1,h&&r>=0&&r<i?h=o[r+1].Gzb():h===a?h=o[0].Gzb():(h&&r<0||r===i)&&(h=a),this.Azb.push(t)):this.zzb.push(t),this.qo.insertBefore(t.Gzb(),h),this.xc&&t.onBind(this.xc),s=!0}catch(e){n?this.Azb.splice(this.Azb.indexOf(t),1):this.zzb.splice(this.zzb.indexOf(t),1),this.yzb.splice(this.yzb.indexOf(t),1)}}return s},t.prototype.Hzb=function(t){var e,n,o=this.yzb,r=!1;for(e=0;e<o.length;e++)if(t===(n=o[e]).name){r=!0;break}return!!r&&(n.onUnbind(),n.align===l?this.Azb.splice(this.Azb.indexOf(n),1):this.zzb.splice(this.zzb.indexOf(n),1),this.yzb.splice(e,1),this.qo.removeChild(n.Gzb()),!0)},t.prototype.Jp=function(t){var e,n,o=this.yzb;for(e=0;e<o.length;e++)if(t===(n=o[e]).name)return n;return a},t.prototype.Izb=function(t){this.xc=t,this.yzb.forEach((function(e){e.onBind(t),e.onUpdate()}))},t.prototype.hZ=function(){this.zzb=[],this.Azb=[],i(this.qo).empty()},t.prototype.Jzb=function(){var t,e=this,n=this.qo,o=s;this.hZ(),this.yzb.forEach((function(r){o=r.align,(t=r.Gzb()).style.float=o,o===l?e.Azb.unshift(r):(e.zzb.unshift(r),n.appendChild(t))})),this.Azb.forEach((function(t){n.appendChild(t.Gzb())}))},t.prototype.Kzb=function(){this.yzb.forEach((function(t){t.onUpdate()})),this.Jzb()},t.prototype.Lzb=function(){var t=[];return this.yzb.forEach((function(e){t.push(e.Mzb())})),t},t.prototype.Nzb=function(t){var e,n,o=this.yzb,r=t.name;for(e=0;e<o.length;e++)if((n=o[e]).name===r){n.Nzb(t);break}},t.prototype.Ozb=function(){return this.yzb},t.prototype.Pzb=function(){var t,e=this.yzb;for(this.xc=a,t=0;t<e.length;t++)e[t].onUnbind()},t.prototype.no=function(){var t,e,n=this.yzb;if(this.qo){for(t=0;t<n.length;t++)e=n[t],this.qo.removeChild(e.Qzb),e.onDispose();this.qo.parentElement&&this.qo.parentElement.removeChild(this.qo),this.Czb.parentElement&&this.Czb.parentElement.removeChild(this.Czb),this.qo=a,this.Czb=a}this.mi=a,this.yzb=a,this.zzb=a,this.Azb=a},t}(),e.BaseStatusBar=u},"./dist/plugins/statusBar/statusBar.entry.js":function(t,e,n){"use strict";var o,r;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./dist/plugins/statusBar/statusBar.js"),e.StatusBar=o.StatusBar,r=n("./dist/plugins/statusBar/statusItem.js"),e.StatusItem=r.StatusItem,function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n("./dist/plugins/statusBar/statusBar.ns.js"))},"./dist/plugins/statusBar/statusBar.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function X(t){return t&&t.getActiveSheet()}function Z(t,e){return"_SUBTOTALFORSTATUSBAR("+t+r.Common.CultureManager.q4().NumberFormat.listSeparator+e+")"}function Q(t,e){t.splice(e,1)}function J(t,e){var n,o=e,r=e.length,i=[];if(r>1){for(i.push(e[0]),n=1;n<r;n++)i=$(t,e[n],i);return i}return o}function $(t,e,n){var o,r,i,a,s,l,u=t.getRowCount(3),c=t.getColumnCount(3),f=[],h=[];for(f.push(e),a=n.length,s=0;s<a;s++)for(o=n[s],l=0;l<f.length;)(i=(r=f[l]).getIntersect(o,u,c))?(h=t.v_a(r,i,u,c),Q(f,l),f=h.concat(f),l+=h.length):l++;return f.concat(n)}function K(t){var e=t;return t>0&&t<=4&&(e=Math.floor(+parseFloat((100*t).toPrecision(12)))),e}function tt(t,e,n){if(t&&t.parent&&t.parent.options.allowUserZoom){var r={sheet:t,sheetName:t.name(),newZoomFactor:e,oldZoomFactor:n,cancel:!1};if(t.Wq(o.Events.ViewZooming,r),r&&!0===r.cancel)return;(e=r.newZoomFactor)!==n&&(t.wu().execute({cmd:N,sheetName:t.name(),newZoomFactor:e,oldZoomFactor:n}),ot(t,e,n))}}function et(t){for(var e,n,o,r={top:t.offsetTop,left:t.offsetLeft},i=t.offsetParent;i;)r.top+=i.offsetTop,r.left+=i.offsetLeft,i=i.offsetParent;return n=(e=document.body).clientTop,o=e.clientLeft,isNaN(n)||(r.top+=n),isNaN(o)||(r.left+=o),r}function nt(t){return""!==t}function ot(t,e,n){t.Wq(o.Events.UserZooming,{sheet:t,sheetName:t.name(),oldZoomFactor:n,newZoomFactor:e}),t.Wq(o.Events.ViewZoomed,{sheet:t,sheetName:t.name(),oldZoomFactor:n,newZoomFactor:e})}function rt(t,e){t.xc=e,e.bind(o.Events.ActiveSheetChanged+t.Rzb,(function(){t.onUpdate()}))}function it(t){var e,n;u.StatusItem.prototype.onUpdate.call(t),(e=X(t.xc))&&(n=e.zoom(),t.qAb(n))}function at(t){t.xc&&(t.xc.unbind(o.Events.ActiveSheetChanged+t.Rzb),t.xc=b)}function st(){P&&_.call(this)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("@grapecity/js-calc"),a=n("SheetsCalc"),s=n("ContextMenu"),l=n("./dist/plugins/statusBar/statusBar.ns.js"),u=n("./dist/plugins/statusBar/statusItem.js"),c=n("./dist/plugins/statusBar/baseStatusBar.js"),f=o.GC$,h=o.Ul,p=h.Nl,d=h.nl,g=r.Common.j,m=r.Common.u.Kb,y=g.Fa,v=o.Commands.ActionBase,C=i.Convert.vf,b=null,w=f.inherit,T="gc-statusbar-",x="slider-",S="%",A="px",I="div",R="none",k="inline",M="right",N="statusbarZoom",E="statusBar",D="click",O="contextmenu",j=".statusbar",F=["average","count","numericalCount","min","max","sum"],P=!!s,s&&(_=s.MenuView,L=s.Cyb),B=new r.Common.ResourceManager(l.SR),G=B.getResource.bind(B),H=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.Rzb=j+o.name,o}return Y(e,t),e.prototype.onBind=function(t){var e,n=this;n.xc=t,t.bind(o.Events.EditorStatusChanged+n.Rzb,(function(t,o){e=n.Szb(o.newStatus),n.Tzb(e)})),t.bind(o.Events.ActiveSheetChanged+n.Rzb,(function(){n.onUpdate()}))},e.prototype.onUpdate=function(){var e,n,o;t.prototype.onUpdate.call(this),(e=X(this.xc))&&(n=e.editorStatus(),o=this.Szb(n),this.Tzb(o))},e.prototype.Szb=function(t){var e;switch(t){case 0:e=G().cellModeReady;break;case 1:e=G().cellModeEnter;break;case 2:e=G().cellModeEdit}return e},e.prototype.Tzb=function(t){if(t!==this.value){this.value=t,this.tipText=m(G().toolTipCellMode,[t]);var e=this.TJa;e&&(e.parentElement.title=this.tipText,y(this.value)||(e.innerText=this.value+""))}},e.prototype.onUnbind=function(){this.xc&&(this.xc.unbind(o.Events.EditorStatusChanged+this.Rzb),this.xc.unbind(o.Events.ActiveSheetChanged+this.Rzb),this.xc=b)},e}(u.StatusItem),V=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.Uzb=": ",o.fhc=!1,o.Uk=n.prefix,o.Rzb=j+o.name,o.XLb=Number.MAX_VALUE,o.ghc={},o}return Y(e,t),e.prototype.onBind=function(t){var e=this;e.xc=t,t.bind(o.Events.SelectionChanging+e.Rzb,(function(t,n){e.Vzb(n)})),t.bind(o.Events.SelectionChanged+e.Rzb,(function(t,n){e.Vzb(n)})),t.bind(o.Events.ValueChanged+e.Rzb,(function(t,n){var o=n.sheet,r=n.row,i=n.col;o.vp(r,i)&&e.onUpdate()})),t.bind(o.Events.RangeChanged+e.Rzb,(function(){e.onUpdate()})),t.bind(o.Events.DragFillBlockCompleted+e.Rzb,(function(){e.onUpdate()})),t.bind(o.Events.ActiveSheetChanged+e.Rzb,(function(){e.onUpdate()})),t.bind(o.Events.TopRowChanged+e.Rzb,(function(){e.hhc(!0)})),t.bind(o.Events.RowChanged+e.Rzb,(function(){e.hhc(!1)})),t.bind(o.Events.ColumnChanged+e.Rzb,(function(){e.hhc(!1)}))},e.prototype.hhc=function(t){this.fhc=t},e.prototype.YLb=function(t){var e=X(this.xc),n=0;return t.forEach((function(t){var o=e.Tq(t);n+=o.rowCount*o.colCount})),n<this.XLb},e.prototype.Vzb=function(t){var e,n,o=this,r=t.sheet,i=t.newSelections;o.YLb(i)?1===i.length&&1===i[0].rowCount&&1===i[0].colCount?(e=o.Wzb(r,b),o.Tzb(e[o.name])):nt(n=o.ZLb(J(r,i)))?(e=o.Wzb(r,n),o.Tzb(e[o.name])):y(o.value)&&o.Xzb(!1):o.Tzb(b)},e.prototype.Wzb=function(t,e){var n,o,r,i,s,l,u,c,f,h,p,d,g=this,m=a.evaluateFormula,v=0,w=b,T=b,x=b,S=b,A=b;return e&&(o=(n=g.ghc)[e],!g.fhc||y(o)?(g.hhc(!1),(v=m(t,Z(103,e)))>1&&((w=m(t,Z(102,e)))>0&&(r=m(t,Z(101,e)),i=m(t,Z(105,e)),s=m(t,Z(104,e)),l=m(t,Z(109,e)),C(r)||C(i)||C(s)||C(l)||(u=t.getActiveRowIndex(),c=t.getActiveColumnIndex(),f=t.getCellType(u,c),h=function(t,e,n){var o=t.tq(e,n,"formatter");return o||(o=t.tq(e,n,"_autoFormatter")),o}(t,u,c),p={},x=f.format(r,h,p),S=f.format(i,h,p),A=f.format(s,h,p),T=f.format(l,h,p)))),n[e]={average:x,numericalCount:w,minimum:S,maximum:A,sum:T,count:v}):(x=o.average,w=o.numericalCount,S=o.minimum,A=o.maximum,T=o.sum,v=o.count)),(d={}).average=x,d.numericalCount=w>0?w:b,d.min=S,d.max=A,d.sum=T,d.count=v>1?v:b,d},e.prototype.Xzb=function(t){this.Qzb&&(this.Qzb.style.display=t?"inline-block":R)},e.prototype.Tzb=function(t){var e=this.Uzb,n=this.TJa,o=this.Uk,r=this.visible,i=!1;this.value=t,n.innerText=o+e+t,!y(t)&&r&&(i=!0),this.Xzb(i)},e.prototype.Av=function(t){if(t){var e=t.menuContent,n=t.tipText;this.menuContent=e,this.Uk=e,this.tipText=n,this.Qzb.title=n}},e.prototype.onUpdate=function(){var e,n,o,r,i,a;t.prototype.onUpdate.call(this),(n=X((e=this).xc))&&(o=n.getSelections(),e.YLb(o)?1===o.length&&1===o[0].rowCount&&1===o[0].colCount?(r=e.Wzb(n,b),e.Tzb(r[e.name])):nt(i=e.ZLb(J(n,o)))?(a=(r=e.Wzb(n,i))[e.name],(y(a)||a!==e.value)&&(e.value=a,e.Tzb(a))):y(e.value)&&e.Xzb(!1):e.Tzb(b))},e.prototype.onUnbind=function(){var t=this.xc,e=this.Rzb;t&&(t.unbind(o.Events.SelectionChanging+e),t.unbind(o.Events.SelectionChanged+e),t.unbind(o.Events.ValueChanged+e),t.unbind(o.Events.RangeChanged+e),t.unbind(o.Events.DragFillBlockCompleted+e),t.unbind(o.Events.ActiveSheetChanged+e),t.unbind(o.Events.TopRowChanged+e),t.unbind(o.Events.RowChanged+e),t.unbind(o.Events.ColumnChanged+e),this.xc=b)},e.prototype.ZLb=function(t,e,n,o,r){var s,l=this.kh;return l||(l=this.kh=new i.Parser),(s=this.Dh)||(s=this.Dh=new a.SheetParserContext(b,!!r,i.pf(e,n))),a.ALb(l,s,t,e,n,o)},e.prototype.onDispose=function(){t.prototype.onDispose.call(this),this.kh=b,this.ghc=b,this.Dh&&(this.Dh.no(),this.Dh=b)},e}(u.StatusItem),z=function(t){function e(e,n,o){var r=t.call(this,n,o)||this;return r.min=25,r.max=400,r.middle=100,r.step=10,r.Yzb=1,r.Zzb=4,r.$zb=120,r._zb=Math.round((r.$zb+r.Yzb)/2),r.aAb=Math.round((r.$zb+r.Zzb)/2),r.bAb=!1,r.cAb=e,r.Rzb=j+r.name,r}return Y(e,t),e.prototype.onCreateItemView=function(t){var e,n,o,r,i,a,s,l,u=this,c=u._v,h=c+A;t.style.display=this.visible?k:R,(e=this.dAb)||(e=this.dAb=p(I)),f(e).addClass("gc-statusbar-slider-btn-container"),e.style.height=h,e.style.lineHeight=h,(n=this.eAb)||(n=this.eAb=p(I)),n.title=G().toolTipZoomOut,f(n).addClass("gc-statusbar-slider-btn"),n.style.height=h,n.addEventListener(D,(function(){u.fAb(!1)})),(o=this.gAb)||(o=this.gAb=p(I)),f(o).addClass("gc-statusbar-slider-add-btn-container"),o.style.height=h,o.style.lineHeight=h,(r=this.hAb)||(r=this.hAb=p(I)),r.title=G().toolTipZoomIn,f(r).addClass("gc-statusbar-slider-add-btn"),r.style.height=h,r.addEventListener(D,(function(){u.fAb(!0)})),(i=this.iAb)||(i=this.iAb=p(I)),f(i).addClass("gc-statusbar-slider-back-progress"),i.style.marginTop=Math.floor(c/2+1)+A,i.addEventListener(D,(function(){return!1})),(a=this.jAb)||(a=this.jAb=p(I)),f(a).addClass("gc-statusbar-slider-middle-line"),a.style.top=Math.floor((c-8)/2+1)+A,a.style.left=u._zb+A,(s=this.kAb)||(s=this.kAb=p(I)),s.title=G().toolTipSlider,f(s).addClass("gc-statusbar-slider-drag-bar"),s.style.top=Math.floor((c-10)/2+1)+A,s.style.right=u.aAb+A,s.addEventListener("mousedown",(function(){u.bAb=!0})),document.addEventListener("mouseup",(function(){u.bAb=!1})),document.addEventListener("mousemove",(function(t){if(u.bAb){var e=t.pageX,n=et(i).left+i.offsetWidth+u.Zzb-e;u.lAb(n)}})),(l=this.mAb)||(l=this.mAb=p(I)),l.title=G().toolTipSlider,f(l).addClass("gc-statusbar-slider-back"),l.style.height=h,l.style.lineHeight=h,l.addEventListener(D,(function(t){var e,n,o=t.target;o!==s&&(o===a?e=u.aAb:(n=t.offsetX,e=l.offsetWidth-n),u.lAb(e))})),e.appendChild(n),t.appendChild(e),l.appendChild(a),l.appendChild(i),l.appendChild(s),t.appendChild(l),o.appendChild(r),t.appendChild(o)},e.prototype.M4=function(){this.xc&&this.xc.focus()},e.prototype.onBind=function(t){rt(this,t)},e.prototype.onUpdate=function(){it(this)},e.prototype.fAb=function(t){var e,n=this.value;n%10==0?n=t?n+this.step:n-this.step:(e=n/10,n=t?Math.ceil(e):Math.floor(e),n*=10),n=(n=n>this.max?this.max:n)<this.min?this.min:n,this.nAb(n)},e.prototype.lAb=function(t){var e,n,o,r,i,a,s,l,u,c=this;t<0&&(t=0),t>c.$zb&&(t=c.$zb+c.Zzb),n=c.value/100,o=c.aAb,r=c.$zb,i=3*c.Zzb/2,a=c.min,s=c.middle,l=c.max,(u=t<=o?(o-t)/o*(l-s)+s:(r-t+i)/o*(s-a)+a)<=a+5?u=a:u>=l-5&&(u=l),e=u/100,tt(X(this.xc),e,n),c.M4()},e.prototype.nAb=function(t){t&&(t=K(t),tt(X(this.xc),t/100,this.value/100),this.M4())},e.prototype.oAb=function(t){var e,n=this,o=n.min,r=n.middle,i=n.max,a=n.Zzb,s=n.aAb;e=n.$zb-(e=t<=r?(t-o)/(r-o)*s-a/2:(t-r)/(i-r)*s+s-a/2),this.pAb(e)},e.prototype.pAb=function(t){var e=this,n=e.Zzb/2,o=e.Zzb;t<=o?t+=o:t<e.$zb&&(t+=n),e.kAb.style.right=t+A},e.prototype.qAb=function(t){t&&(t=K(t)),t!==this.value&&(this.value=parseInt(t+"",10),this.oAb(this.value))},e.prototype.rAb=function(t){return t===this.iAb||t===this.jAb||t===this.kAb||t===this.mAb},e.prototype.sAb=function(t){var e=t.target;this.rAb(e)&&this.tAb(.7)},e.prototype.uAb=function(t){var e=t.target;this.rAb(e)&&this.tAb(1)},e.prototype.tAb=function(t){this.kAb.style.opacity=t+""},e.prototype.Av=function(t){if(t){var e=t.tipText;this.menuContent=t.menuContent,this.tipText=e,this.eAb.title=e[0],this.hAb.title=e[1],this.kAb.title=e[2],this.mAb.title=e[2]}},e.prototype.onUnbind=function(){at(this)},e.prototype.onDispose=function(){this.cAb=b,u.StatusItem.prototype.onDispose.call(this)},e}(u.StatusItem),W=function(t){function e(e,n){var o=t.call(this,e,n)||this;return o.Rzb=j+o.name,o}return Y(e,t),e.prototype.onCreateItemView=function(t){t.style.display=this.visible?k:R;var e=this.vAb;e||(e=this.vAb=p("span")),f(e).addClass("gc-statusbar-zoom-panel"),e.innerText="100%",t.appendChild(e)},e.prototype.onBind=function(t){rt(this,t)},e.prototype.onUpdate=function(){it(this)},e.prototype.qAb=function(t){var e;t&&(e=K(t)),e!==parseInt(this.value+"",10)&&(e=parseInt(e,10),this.value=e+S,this.wAb(e))},e.prototype.wAb=function(t){var e=this.vAb;e&&(e.innerText=t+S)},e.prototype.onUnbind=function(){at(this)},e}(u.StatusItem),U=function(){function t(t,e){if(t){var n=this.xAb=new c.BaseStatusBar(t);this.yAb(n,e),this.qo=n.qo,this.Czb=n.Czb,this.zAb={},this.AAb(t),this.maxCalcCells=5e4}}return Object.defineProperty(t.prototype,"maxCalcCells",{get:function(){return this.XLb},set:function(t){this.XLb=t,this.xAb.Ozb().forEach((function(e){e instanceof V&&(e.XLb=t)}))},enumerable:!0,configurable:!0}),t.prototype.yAb=function(t,e){var n,o,r,i,a,s,l=["formulaAverage","formulaCount","formulaNumericalCount","formulaMin","formulaMax","formulaSum"],u=["toolTipFormulaAverage","toolTipFormulaCount","toolTipFormulaNumericalCount","toolTipFormulaMin","toolTipFormulaMax","toolTipFormulaSum"],c=[G().formulaAverage,G().formulaCount,G().formulaNumericalCount,G().formulaMin,G().formulaMax,G().formulaSum],f=[G().toolTipFormulaAverage,G().toolTipFormulaCount,G().toolTipFormulaNumericalCount,G().toolTipFormulaMin,G().toolTipFormulaMax,G().toolTipFormulaSum],h=[!0,!0,!1,!1,!1,!0],p=[];for(c.forEach((function(t,e){var n={};n.menuContent=t,n.prefix=t,n.align=M,n.tipText=f[e],n.visible=h[e],n.BAb=l[e],n.CAb=u[e],p.push(n)})),n={menuContent:G().cellMode,value:G().cellModeReady,tipText:m(G().toolTipCellMode,[G().cellModeReady]),BAb:"cellMode",CAb:"toolTipCellMode"},o={value:100,menuContent:G().zoomSlider,showStatusInContexMenu:!1,align:M,BAb:"zoomSlider",CAb:["toolTipZoomOut","toolTipZoomIn","toolTipSlider"]},r={value:"100%",tipText:G().toolTipZoomPanel,menuContent:G().zoom,align:M,BAb:"zoom",CAb:"toolTipZoomPanel"},i=[new H("cellMode",n),new V(F[0],p[0]),new V(F[1],p[1]),new V(F[2],p[2]),new V(F[3],p[3]),new V(F[4],p[4]),new V(F[5],p[5]),new z(this,"zoomSlider",o),new W("zoomPanel",r)],e&&e.items instanceof Array&&(i=i.concat(e.items)),s=0;s<i.length;s++)a=i[s],t.mL(a);t.Jzb()},t.prototype.AAb=function(t){var e,n=this.qo,o=this.Czb,r=t.clientHeight;n&&(f(n).addClass("gc-statusbar"),f(o).addClass("gc-statusbar-menu-host"),e=r,r<15&&(t.style.minHeight=15+A,e=15),o.style.top="-"+e+A)},t.prototype.DAb=function(){var t=this.qo;t&&(this.EAb=this.FAb.bind(this),t.addEventListener(O,this.EAb))},t.prototype.FAb=function(t){var e,n,o,r,i,a;d(t),n=(e=this).zAb,o=e.xc,P&&o&&(e.Ela||(e.Ela=new L(e.Czb,f(e.xc.sv))),r=n.menuView,a=et(i=e.qo).left,r.hostInfo={top:i.getBoundingClientRect().top,width:i.clientWidth,height:i.clientHeight},n.menuData=e.xAb.Lzb(),e.Ela.OT(r,n.menuData,t.clientX-a,t.offsetY,o))},t.prototype.GAb=function(t){if(P){var e=new st;this.zAb.menuView=e,this.nla(t)}},t.prototype.nla=function(t){var e=this,n={canUndo:!1,execute:function(t,n){var o=n.commandOptions;e.xAb.Nzb(o)}};t.commandManager().register("gc.spread."+E,n)},t.prototype.bind=function(t){this.unbind(),t&&(this.xc=t,t.cAb=this,this.xAb.Izb(t),this.GAb(t),this.DAb())},t.prototype.unbind=function(){this.xAb&&this.xAb.Pzb(),this.xc&&(this.xc.cAb=b,this.xc=b),this.qo&&(this.qo.removeEventListener(O,this.EAb),this.EAb=b),this.Ela&&(this.Ela.close(),this.Ela=b)},t.prototype.add=function(t,e){return this.xAb.Fzb(t,e)},t.prototype.remove=function(t){return this.xAb.Hzb(t)},t.prototype.get=function(t){return this.xAb.Jp(t)},t.prototype.all=function(){return this.xAb.Ozb()},t.prototype.update=function(){this.xAb.Kzb()},t.prototype.dispose=function(){this.unbind(),this.zAb=b,this.Ela=b,this.xAb&&(this.xAb.no(),this.xAb=b),this.qo&&(this.qo=b)},t}(),e.StatusBar=U,P&&w(st,_),st.prototype.getCommandOptions=function(t){return t},q=function(t){function e(e,n){var o=t.call(this)||this;return o.kj=e,o.HAb=n,o}return Y(e,t),e.prototype.canExecute=function(){return!0},e.prototype.execute=function(){var t=this.kj,e=this.HAb,n=e.newZoomFactor;if(this.canExecute()){t.ITa.startTransaction();try{t.zoom(n)}finally{e[o.Commands.bWa(t.name())]=t.ITa.endTransaction()}return!0}return!1},e.prototype.canUndo=function(){return!0},e.prototype.undo=function(){var t=this.kj,e=this.HAb[o.Commands.bWa(t.name())][0].value,n=t.zoom();return e!==n&&(t.zoom(e),ot(t,e,n)),!0},e}(v),o.Commands[N]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,q,e,n)}},o.Worksheet.$n(N,{setHost:function(t){if(t){var e=this.wu();e[N]||e.register(N,o.Commands[N])}},onLayoutChanged:function(t){var e,n;"invalidateLayout"===t.changeType&&((e=this.parent)&&!e.isPaintSuspended()&&((n=e.cAb)&&n.update()))}}),o.Workbook.$n(E,{onCultureChanged:function(){var t,e,n=this.cAb,o=G(),r=[];n&&n.xAb&&n.xAb.Ozb().forEach((function(n){t=n.CAb,e=o[t],t instanceof Array&&(t.forEach((function(t){r.push(o[t])})),e=r),n.Av({menuContent:o[n.BAb],tipText:e})}))}})},"./dist/plugins/statusBar/statusBar.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/statusBar/statusBar.res.en.js");e.SR={en:o}},"./dist/plugins/statusBar/statusBar.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.cellMode="Cell Mode",e.cellModeReady="Ready",e.cellModeEnter="Enter",e.cellModeEdit="Edit",e.formulaAverage="Average",e.formulaCount="Count",e.formulaNumericalCount="Numerical Count",e.formulaMin="Min",e.formulaMax="Max",e.formulaSum="Sum",e.zoomSlider="Zoom Slider",e.zoom="Zoom",e.toolTipCellMode="In {0} mode",e.toolTipFormulaAverage="Average of selected cells",e.toolTipFormulaCount="Number of selected cells that contain data",e.toolTipFormulaNumericalCount="Number of selected cells that contain numerical data",e.toolTipFormulaMin="Minimum value in selection",e.toolTipFormulaMax="Maximum value in selection",e.toolTipFormulaSum="Sum of selected cells",e.toolTipZoomOut="Zoom Out",e.toolTipZoomIn="Zoom In",e.toolTipSlider="Zoom",e.toolTipZoomPanel="Zoom level"},"./dist/plugins/statusBar/statusItem.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=o.Ul.Nl,a=o.GC$,s=r.Common.j,l=s.Fa,u="none",c="mousemove",f="mouseout",h=null,p="left",d="statusBar",g="10px",m=function(){function t(t,e){if(this._marginLeft=0,this._marginRight=0,this.Vo="auto",this.Qzb=h,this.TJa=h,this.name=t,e){var n=e.align,o=e.menuContent,r=e.tipText,i=e.visible,a=e.showStatusInContexMenu,s=e.value,u=e.BAb,c=e.CAb;this.align=l(n)?p:n,this.menuContent=l(o)?h:o,this.tipText=l(r)?"":r,this.visible=!!l(i)||i,this.showStatusInContexMenu=!!l(a)||a,this.value=l(s)?h:s,this.BAb=l(u)?h:u,this.CAb=l(c)?h:c}}return t.prototype.Ezb=function(t){var e,n,o=this.align===p;this._marginLeft=o?g:0,this._marginRight=o?0:g,e=t.clientHeight,this._v=e>15?e:15,n=this.IAb(),this.Qzb=n,this.onCreateItemView(n),this.QQ(n)},t.prototype.IAb=function(){var t=this.Qzb,e=this._v&&this._v+"px";return t||((t=this.Qzb=i("div")).title=this.tipText,a(t).addClass("gc-statusbar-statusitem-container"),a(t).css({height:e,lineHeight:e,float:this.align,marginLeft:this._marginLeft+"",marginRight:this._marginRight+""}),!1===this.visible&&(t.style.display=u)),t},t.prototype.onCreateItemView=function(t){var e=this.TJa;e||((e=this.TJa=i("span")).innerText=this.value+""),t.appendChild(e)},t.prototype.onBind=function(t){},t.prototype.QQ=function(t){t.addEventListener(c,this.sAb.bind(this)),t.addEventListener(f,this.uAb.bind(this))},t.prototype.Gzb=function(){return this.Qzb},t.prototype.sAb=function(t){},t.prototype.uAb=function(t){},t.prototype.Mzb=function(){var t=this.JAb();return t.type=d,t.workArea=d,t},t.prototype.Nzb=function(t){this.visible=!t.visible,this.onUpdate()},t.prototype.JAb=function(){var t=this.showStatusInContexMenu?this.KAb():null;return function(t,e,n,o){return{name:t,menuContent:e,visible:n,status:o,command:"gc.spread."+d}}(this.name,this.menuContent,this.visible,t)},t.prototype.KAb=function(){return this.value},t.prototype.D4=function(){this.Qzb&&(this.Qzb.style.display=this.visible?"inline-block":u)},t.prototype.Av=function(t){t&&(this.menuContent=t.menuContent,this.tipText=t.tipText,this.Qzb.title=this.tipText)},t.prototype.onUpdate=function(){this.D4()},t.prototype.onUnbind=function(){},t.prototype.onDispose=function(){this.onUnbind(),this.TJa=h,this.Qzb&&(this.Qzb.removeEventListener(c,this.sAb),this.Qzb.removeEventListener(f,this.uAb),a(this.Qzb).empty(),this.Qzb=h)},t}(),e.StatusItem=m},"./dist/plugins/table/table-action.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/table/table-util.js"),a=i.Util.$Lb,s=i.Util.PIb,l=i.Util.QIb,u=i.Util._getTable,c=i.Util._Mb,f=o.Commands.ActionBase,h=r.Common.j.Fa,p="tableResize",d="tableInsertRows",g="tableDeleteRows",m="tableInsertColumns",y="tableDeleteColumns",v="tableToRange",C="tableTotalRowFormula",b="DoInsertRows",w="tableShowFooter",T="tableInsertRowsAboveForContextMenu",x="tableInsertRowsBelowForContextMenu",S="tableDeleteRowsForContextMenu",A="tableInsertColumnsLeftForContextMenu",I="tableInsertColumnsRightForContextMenu",R="tableDeleteColumnsForContextMenu",k=void 0,M=function(t){function e(e,n){var o=t.call(this,e)||this;return o._Lb=n,o.aMb=n.tableName,o.bMb=n.resizeToRange,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,s,l,u=this,c=!1;if(u.canExecute()){e=(t=u.kj).ITa,n=u.aMb,r=u._Lb,e.startTransaction(),u.Lz(t,!0);try{(i=t.tables.findByName(n))&&(s=i.range(),l=u.bMb,t.tables.resize(i,l),a(t,i,s,l),c=!0)}finally{u.Mz(t),r[o.Commands.bWa(t.name())]=e.endTransaction()}}return c},e.prototype.undo=function(){var t,e,n,r,i=this,s=i.kj,l=i.aMb,u=!1;if(i.canUndo()){i.Lz(s,!0);try{t=i._Lb,e=s.ITa,n=s.tables.findByName(l),(r=t[o.Commands.bWa(s.name())])&&(e.undo(r),a(s,n,t.resizeToRange,n.range()),e.wVa(r.uVa),u=!0)}finally{i.Mz(s,!0)}}return u},e}(f),o.Commands[p]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,M,e,n)}},N=function(t){function e(e,n){var o=t.call(this,e)||this;return o.cMb=n,o.aMb=n.tableName,o.cj=n.row,o.Jb=n.count,o.dMb=n.isAfter,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a,l,u,c,f=this,h=!1;if(f.canExecute()){e=(t=f.kj).ITa,n=f.aMb,r=f.cj,i=f.Jb,a=f.dMb,e.startTransaction(),f.Lz(t,!0);try{(l=t.tables.findByName(n))&&(u=l.Xj,l.Nia(r,i,a),h=!0,l.Xj-u===i&&s(t,l,d,r,i,a))}finally{f.Mz(t),c=o.Commands.bWa(t.name()),f.cMb[c]=e.endTransaction()}}return h},e.prototype.undo=function(){var t,e,n,r,i,a,l,u,f=this,h=f.kj,p=!1;if(f.canUndo()){f.Lz(h,!0);try{t=f.cMb,e=h.ITa,n=t[o.Commands.bWa(h.name())],r=t.row,i=t.count,a=t.isAfter,n&&(e.undo(n),e.wVa(n.uVa),(l=h.tables.findByName(f.aMb))&&(u=a?r+1:r,l.ihc(u,i),l.NAb(),l.WNb(u,i,c(!0)),s(h,l,g,r,i,k,l.nKb())),p=!0)}finally{f.Mz(h,!0)}}return p},e}(f),o.Commands[d]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,N,e,n)}},E=function(t){function e(e,n){var o=t.call(this,e)||this;return o.cMb=n,o.aMb=n.tableName,o.cj=n.row,o.Jb=n.count,o.dMb=n.isAfter,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a,l,u,c=this,f=!1;if(c.canExecute()){e=(t=c.kj).ITa,n=c.aMb,r=c.cj,i=c.Jb,a=c.dMb,e.startTransaction(),c.Lz(t,!0);try{(l=t.tables.findByName(n))&&(l.eMb(r,i,a,!1),s(t,l,d,r,i,a),c.cMb.row=r,c.cMb.count=i,f=!0)}finally{c.Mz(t),u=o.Commands.bWa(t.name()),c.cMb[u]=e.endTransaction()}}return f},e.prototype.undo=function(){var t,e,n,r,i,a,l,u,f=this,h=f.kj,p=!1;if(f.canUndo()){f.Lz(h,!0);try{t=f.cMb,e=h.ITa,n=t[o.Commands.bWa(h.name())],r=t.row,i=t.count,a=t.isAfter,n&&(e.undo(n),e.wVa(n.uVa),(l=h.tables.findByName(f.aMb))&&(u=a?r+1:r,l.ihc(u,i),l.NAb(),l.WNb(u,i,c(!0)),s(h,l,g,r,i,l.nKb())),p=!0)}finally{f.Mz(h,!0)}}return p},e}(f),o.Commands[b]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,E,e,n)}},D=function(t){function e(e,n){var o=t.call(this,e)||this;return o.fMb=n,o.aMb=n.tableName,o.cj=n.row,o.Jb=n.count,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a,l,u,c=this,f=!1;if(c.canExecute()){e=(t=c.kj).ITa,n=c.aMb,r=c.cj,i=c.Jb,e.startTransaction(),c.Lz(t,!0);try{(a=t.tables.findByName(n))&&(l=a.Xj,a.STa(r,i),f=!0,l-a.Xj===i&&s(t,a,g,r,i,k,a.nKb()))}finally{c.Mz(t),u=o.Commands.bWa(t.name()),c.fMb[u]=e.endTransaction()}}return f},e.prototype.undo=function(){var t,e,n,r,i,a,l=this,u=l.kj,c=!1;if(l.canUndo()){l.Lz(u,!0);try{t=l.fMb,e=u.ITa,n=t[o.Commands.bWa(u.name())],r=t.row,i=t.count,n&&(e.undo(n),e.wVa(n.uVa),(a=u.tables.findByName(l.aMb))&&a.NAb(),c=!0,s(u,a,d,r,i,!1))}finally{l.Mz(u,!0)}}return c},e}(f),o.Commands[g]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,D,e,n)}},O=function(t){function e(e,n){var o=t.call(this,e)||this;return o.gMb=n,o.aMb=n.tableName,o.dj=n.col,o.Jb=n.count,o.dMb=n.isAfter,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a,s,u,c,f=this,h=!1;if(f.canExecute()){e=(t=f.kj).ITa,n=f.aMb,r=f.dj,i=f.Jb,a=f.dMb,e.startTransaction(),f.Lz(t,!0);try{(s=t.tables.findByName(n))&&(u=s.OZ,s.hMb(r,i,a),h=!0,s.OZ-u===i&&l(t,s,m,r,i,a))}finally{f.Mz(t),c=o.Commands.bWa(t.name()),f.gMb[c]=e.endTransaction()}}return h},e.prototype.undo=function(){var t,e,n,r,i,a,s=this,u=s.kj,c=!1;if(s.canUndo()){s.Lz(u,!0);try{t=s.gMb,e=u.ITa,n=t[o.Commands.bWa(u.name())],r=t.col,i=t.count,n&&(e.undo(n),e.wVa(n.uVa),(a=u.tables.findByName(s.aMb))&&a.NAb(),c=!0,l(u,a,y,r,i))}finally{s.Mz(u,!0)}}return c},e}(f),o.Commands[m]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,O,e,n)}},j=function(t){function e(e,n){var o=t.call(this,e)||this;return o.iMb=n,o.aMb=n.tableName,o.dj=n.col,o.Jb=n.count,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a,s,u,c=this,f=!1;if(c.canExecute()){e=(t=c.kj).ITa,n=c.aMb,r=c.dj,i=c.Jb,e.startTransaction(),c.Lz(t,!0);try{(a=t.tables.findByName(n))&&(s=a.OZ,a.TTa(r,i),f=!0,s-a.OZ===i&&l(t,a,y,r,i))}finally{c.Mz(t),u=o.Commands.bWa(t.name()),c.iMb[u]=e.endTransaction()}}return f},e.prototype.undo=function(){var t,e,n,r,i,a,s=this,u=s.kj,c=!1;if(s.canUndo()){s.Lz(u,!0);try{t=s.iMb,e=u.ITa,n=t[o.Commands.bWa(u.name())],r=t.col,i=t.count,n&&(e.undo(n),e.wVa(n.uVa),(a=u.tables.findByName(s.aMb))&&a.NAb(),c=!0,l(u,a,m,r,i,!1))}finally{s.Mz(u,!0)}}return c},e}(f),o.Commands[y]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,j,e,n)}},F=function(t){function e(e,n){var o=t.call(this,e)||this;return o.jMb=n,o.aMb=n.tableName,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a=this,s=!1;if(a.canExecute()){e=(t=a.kj).ITa,n=a.aMb,e.startTransaction(),a.Lz(t,!0);try{(r=t.tables.findByName(n))&&(t.tables.remove(r,3),s=!0)}finally{a.Mz(t),i=o.Commands.bWa(t.name()),a.jMb[i]=e.endTransaction()}}return s},e.prototype.undo=function(){var t,e,n,r,i=this,a=i.kj,s=!1;if(i.canUndo()){i.Lz(a,!0);try{t=i.jMb,e=a.ITa,(n=t[o.Commands.bWa(a.name())])&&(e.undo(n),e.wVa(n.uVa),(r=a.tables.findByName(i.aMb))&&r.NAb(),s=!0)}finally{i.Mz(a,!0)}}return s},e}(f),o.Commands[v]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,F,e,n)}},P=function(t){function e(e,n){var o=t.call(this,e)||this,r=o;return r.kMb=n,r.cj=n.row,r.dj=n.col,r.Yw=n.newValue,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a,s=this,l=!1;if(s.canExecute()){(e=(t=s.kj).ITa).startTransaction(),s.Lz(t,!0);try{n=s.cj,r=s.dj,i=s.Yw,t.setFormula(n,r,i),i||t.setValue(n,r,null),l=!0}finally{s.Mz(t),a=o.Commands.bWa(t.name()),s.kMb[a]=e.endTransaction()}}return l},e.prototype.undo=function(){var t,e,n,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{t=r.kMb,e=i.ITa,(n=t[o.Commands.bWa(i.name())])&&(e.undo(n),e.wVa(n.uVa),a=!0)}finally{r.Mz(i,!0)}}return a},e}(f),o.Commands[C]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,P,e,n)}},_=function(t){function e(e,n){var o=t.call(this,e)||this;return o.lMb=n,o.aMb=n.tableName,o}return L(e,t),e.prototype.execute=function(){var t,e,n,r,i,a=this,s=!1;if(a.canExecute()){e=(t=a.kj).ITa,n=a.aMb,e.startTransaction(),a.Lz(t,!0);try{(r=t.tables.findByName(n))&&(r.showFooter(!0),s=!0)}finally{a.Mz(t),i=o.Commands.bWa(t.name()),a.lMb[i]=e.endTransaction()}}return s},e.prototype.undo=function(){var t,e,n,r=this,i=r.kj,a=!1;if(r.canUndo()){r.Lz(i,!0);try{t=r.lMb,e=i.ITa,(n=t[o.Commands.bWa(i.name())])&&(e.undo(n),e.wVa(n.uVa),a=!0)}finally{r.Mz(i,!0)}}return a},e}(f),o.Commands[w]={canUndo:!0,execute:function(t,e,n){return o.Commands.h4(t,_,e,n)}},o.Commands[T]={canUndo:!0,execute:function(t,e,n){var r,i,a,s,l,c,f;return e.cmd=T,h(e.row)&&h(e.count)?(r=o.Commands.bT(t,e),a=void 0,s=void 0,l=void 0,c=void 0,1===(i=e.selections).length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,f=s.footerIndex()===l,e.row=f?l-1:l,e.count=c,e.tableName=s.name(),e.isAfter=f),o.Commands.h4(t,N,e,n))):o.Commands.h4(t,N,e,n)}},o.Commands[x]={canUndo:!0,execute:function(t,e,n){if(e.cmd=x,h(e.row)&&h(e.count)){var r=o.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,e.row=l,e.count=c,e.tableName=s.name(),e.isAfter=!0),o.Commands.h4(t,N,e,n))}return o.Commands.h4(t,N,e,n)}},o.Commands[S]={canUndo:!0,execute:function(t,e,n){if(e.cmd=S,h(e.row)&&h(e.count)){var r=o.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.row,c=a.rowCount,e.row=l,e.count=c,e.tableName=s.name()),o.Commands.h4(t,D,e,n))}return o.Commands.h4(t,D,e,n)}},o.Commands[A]={canUndo:!0,execute:function(t,e,n){if(e.cmd=A,h(e.col)&&h(e.count)){var r=o.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,e.col=l,e.count=c,e.tableName=s.name(),e.isAfter=!1),o.Commands.h4(t,O,e,n))}return o.Commands.h4(t,O,e,n)}},o.Commands[I]={canUndo:!0,execute:function(t,e,n){if(e.cmd=I,h(e.col)&&h(e.count)){var r=o.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,e.col=l,e.count=c,e.tableName=s.name(),e.isAfter=!0),o.Commands.h4(t,O,e,n))}return o.Commands.h4(t,O,e,n)}},o.Commands[R]={canUndo:!0,execute:function(t,e,n){if(e.cmd=R,h(e.col)&&h(e.count)){var r=o.Commands.bT(t,e),i=e.selections,a=void 0,s=void 0,l=void 0,c=void 0;return 1===i.length&&(a=i[0],(s=u(r,a))&&(l=a.col,c=a.colCount,e.col=l,e.count=c,e.tableName=s.name()),o.Commands.h4(t,j,e,n))}return o.Commands.h4(t,j,e,n)}},o.Commands.mMb=function(t){t.register(p,o.Commands[p]),t.register(d,o.Commands[d]),t.register(b,o.Commands[b]),t.register(g,o.Commands[g]),t.register(m,o.Commands[m]),t.register(y,o.Commands[y]),t.register(v,o.Commands[v]),t.register(C,o.Commands[C]),t.register(w,o.Commands[w]),t.register(T,o.Commands[T]),t.register(x,o.Commands[x]),t.register(S,o.Commands[S]),t.register(A,o.Commands[A]),t.register(I,o.Commands[I]),t.register(R,o.Commands[R])}},"./dist/plugins/table/table-event.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("./dist/plugins/table/table.js"),a=n("./dist/plugins/table/table.ns.js"),s=n("./dist/plugins/table/table-util.js"),l=r.Common.j.Fa,u=null,c=Math.abs,f=new r.Common.ResourceManager(a.SR),h=f.getResource.bind(f),p=s.Util.nMb,d=s.Util.oMb,g=s.Util.pMb,o.GC$.extend(o.iI.prototype,{oIb:function(t,e){var n=this.qgc(t,e);n&&e.setSelection(n.row,n.col,n.rowCount,n.colCount)},qgc:function(t,e){var n,r,a,s,c,f,h,p,d=e.getSelections(),g=t.tableSelectInfo;if(!e.isEditing()||e.getActiveRowIndex()===t.row&&e.getActiveColumnIndex()===t.col||e.endEdit(),r=0,a=0,(n=g.table).NZ&&(r=1),n.MZ&&(a=1),s=u,c=g.action,f=e.Cw&&e.Cw.ahc(),!l(f)&&f.length>0&&(d=f),c===i.TableSelectionType.TABLE_ROW_SELECT)s=o.kf(t.row,n.dj,1,n.OZ);else if(c===i.TableSelectionType.TABLE_COL_SELECT){for(h=0;h<d.length;h++)if((p=d[h]).col===t.col&&p.row===n.cj+a&&1===p.colCount&&p.rowCount===n.Xj-a-r){s=o.kf(n.cj,t.col,n.Xj,1);break}l(s)&&(s=o.kf(n.cj+a,t.col,n.Xj-a-r,1))}else if(c===i.TableSelectionType.TABLE_CORNER_SELECT){for(h=0;h<d.length;h++)if((p=d[h]).col===n.dj&&p.row===n.cj+a&&p.colCount===n.OZ&&p.rowCount===n.Xj-a-r){s=o.kf(n.cj,n.dj,n.Xj,n.OZ);break}l(s)&&(s=o.kf(n.cj+a,n.dj,n.Xj-a-r,n.OZ))}else c===i.TableSelectionType.TABLE_SELECT&&(s=o.kf(n.cj,n.dj,n.Xj,n.OZ));return s},iJb:function(t,e){var n,o,r,i,a,s,l,c,f,h,g,m,y,v,C=this.kj,b=u;return C&&!C.options.isProtected&&!C.isEditing()&&e&&e.showResizeHandle()?(n=t.row,o=t.col,r=t.x,i=t.y,a=t.rowViewportIndex,s=t.colViewportIndex,l=p(C,e),c=d(C,e),n===l&&o===c&&(h=(f=C.getCellRect(n,o,a,s)).x,g=f.y,m=f.width,v=g+f.height,r>=(y=h+m)-10&&r<=y&&i>=v-10&&i<=v&&(b={x:r,y:i,table:e})),b):b},pIb:function(t){var e,n,o,r,i,a=this;!0!==a.qIb&&!0!==a.OG&&(e=a.kj,(o=(n=t.resizeTableHitInfo)&&n.table)&&!o.hJb()&&(a.qIb=!0,a.OG=!0,a.qMb=o,a.rMb=o.cj,a.sMb=o.dj,a.tMb=o.Xj,a.uMb=o.OZ,r=a.rMb+a.tMb-1,i=a.sMb+a.uMb-1,a.vMb=e.getCellRect(r,i),a.wMb=o.range(),a.rG={KG:t.rowViewportIndex,MG:t.colViewportIndex,sG:t.hitTestType},a.qG()))},rIb:function(){var t,e=this,n=e.kj;e.rG&&e.qIb&&e.OG&&e.qMb&&(e.xMb(),e.yMb()&&(e.zMb=e.AMb(),e.BMb(),e.CMb(),(t=e.DMb)||(t=e.EMb()),t.equals(e.FMb)||(e.DMb=o.kf(e.FMb.row,e.FMb.col,e.FMb.rowCount,e.FMb.colCount),g(n,e.qMb,e.EMb(),e.FMb))),e.NG())},wIb:function(){var t,e=this,n=e.kj;return e.RG(),e.qIb&&e.OG&&e.FMb&&e.qMb?(e.qIb=!1,e.OG=!1,void(e.HMb()?(t=e.EMb(),e.IMb(),t.equals(e.FMb)?n.yl.JMb():n.wu().execute({cmd:"tableResize",sheetName:n.name(),tableName:e.qMb.name(),resizeToRange:e.FMb}),e.GMb()):(e.GMb(),n.yl.JMb()))):void e.GMb()},EMb:function(){var t=this.qMb;return o.kf(t.cj,t.dj,t.Xj,t.OZ)},xMb:function(){var t=this,e=t.fH(),n=t.gH();t.KMb=e,t.LMb=n},yMb:function(){var t=this,e=t.rMb,n=t.sMb,o=t.KMb,r=t.LMb;return o>=(t.qMb.MZ?e+1:e)&&r>=n},AMb:function(){var t=this.$F,e=this.vMb,n=e.x+e.width,o=e.y+e.height,r=t.x,i=t.y;return c(o-i)>=c(n-r)?i<o?2:3:r<n?0:1},BMb:function(){var t=this,e=t.rMb,n=t.sMb,r=t.KMb,i=t.LMb,a=t.zMb,s=t.tMb,l=t.uMb;switch(a){case 0:case 1:l=c(i-n)+1;break;case 2:case 3:s=c(r-e)+1}t.FMb?(t.FMb.rowCount=s,t.FMb.colCount=l):t.FMb=o.kf(e,n,s,l)},CMb:function(){var t=this;t.kj.yl.JMb(),t.wMb=t.MMb()},MMb:function(){var t=this.FMb,e=t.row,n=t.col,r=t.rowCount,i=t.colCount;return o.kf(e,n,r,i)},IMb:function(){var t=this,e=t.qMb;2===t.zMb&&e.NZ&&(t.FMb.rowCount+=1)},HMb:function(){var t=this,e=t.kj,n=!1,o=e.ITa,r=e.tables,i=t.qMb,a=t.FMb,s=a.row,l=a.col,u=a.rowCount,c=a.colCount,f=t.KMb,g=t.LMb,m=p(e,i),y=d(e,i),v=t.zMb,C=i.xr;return m&&y?(o.MTa(s,l,u,c)||o.qu(s,l,u,c)?e.Os(6,h().Exp_TableResizeToSpan):C&&C.isFiltered()?2===v?e.Os(6,h().Exp_TableResizeWithHidden):3===v&&i.NZ?e.Os(6,h().Exp_TableResizeWithFilter):n=!0:2===v&&t.NMb(m,f)||0===v&&t.OMb(y,g)?e.Os(6,h().Exp_TableResizeWithHidden):1===v&&(r.rn(s,y+1,u,g-y)||r.HZ(s,y+1,u,g-y))||3===v&&(r.rn(m+1,l,f-m,c)||r.HZ(m+1,l,f-m,c))?e.Os(6,h().Exp_TableResizeToTable):n=!0,n):n},NMb:function(t,e){var n,o=this.kj,r=!1;for(n=t;n>e;n--)if(o.getRowHeight(n)<=0){r=!0;break}return r},OMb:function(t,e){var n,o=this.kj,r=!1;if(!r)for(n=t;n>e;n--)if(o.getColumnWidth(n)<=0){r=!0;break}return r},GMb:function(){var t=this;t.qIb=!1,t.OG=!1,t.rG=u,t.FMb=u,t.DMb=u}})},"./dist/plugins/table/table-render.js":function(t,e,n){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),(0,(o=n("Core")).GC$.extend)(o.oJ.prototype,{JMb:function(){this.kj.Xq>0||this.im()}}),o.Worksheet.$n("tableRender",{paintAdornment:function(t){var e=t.ctx,n=this.mm;n&&n.rG&&n.qIb&&function(t,e,n,o){var r=t.mm.FMb,i=t.getRangeRect(n,o,r);e.strokeStyle=t.getSelectionBorderColor(),e.strokeRect(i.x,i.y,i.width,i.height)}(this,e,n.iH(),n.jH())}})},"./dist/plugins/table/table-theme.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L;function B(t,e){return isNaN(e)?e:new o.LineBorder(t,e)}function G(t,e,n,o,r,i,a,s,l,u){var c=new O;return e&&(c.backColor=e),n&&(c.foreColor=n),o&&(c.font="bold 11pt calibri"),r&&(c.borderLeft=B(t,r)),i&&(c.borderTop=B(t,i)),a&&(c.borderRight=B(t,a)),s&&(c.borderBottom=B(t,s)),l&&(c.borderHorizontal=B(t,l)),u&&(c.borderVertical=B(t,u)),c}function H(t){return 0===t?"Text 1":"Accent "+t}function V(t){var e,n=t-1,o=h,r=c(n/7);return r>=0&&r<3&&(e="Light"+t,(o=[z,W,U][r](n%7)).name&&o.name(e),o.builtInName&&o.builtInName(e)),o}function z(t){var e=H(t),n=e+" 80",o=new j;return o[p](G(e,0,e,1,0,0,0,1)),o[g](G(e,0,e,0,0,1,0,1)),o[v](G(e,n)),o[y](G(e,0,e,1)),o[m](G(e,0,e,1)),o[b](G(e,n)),o[d](G(e,0,e,1,0,1)),o}function W(t){var e=H(t),n=new j;return n[p](G(e,e,F,1)),n[g](G(e,0,0,0,1,1,1,1)),n[v](G(e,0,0,0,0,1)),n[C](G(e,0,0,0,0,1)),n[b](G(e,0,0,0,1)),n[w](G(e,0,0,0,1)),n[y](G(e,0,0,1)),n[m](G(e,0,0,1)),n[d](G(e,0,0,1,0,6)),n}function U(t){var e=H(t),n=e+" 80",o=new j;return o[p](G(e,0,0,1,0,0,0,2)),o[g](G(e,0,0,0,1,1,1,1,1,1)),o[v](G(e,n)),o[b](G(e,n)),o[y](G(e,0,0,1)),o[m](G(e,0,0,1)),o[d](G(e,0,0,1,0,6)),o}function q(t){var e,n=t-1,o=h,r=c(n/7);return r>=0&&r<4&&(e="Medium"+t,(o=[Y,X,Z,Q][r](n%7)).name(e),o.builtInName(e)),o}function Y(t){var e=H(t),n=e+" 20",o=e,r=e+" 80",i=new j;return i[p](G(n,o,F,1)),i[g](G(n,0,0,0,1,1,1,1,1)),i[v](G(n,r)),i[b](G(n,r)),i[y](G(n,0,0,1)),i[m](G(n,0,0,1)),i[d](G(n,0,P,1,0,6)),i}function X(t){var e=H(t),n=F,o=e,r=e+" 60",i=e+" 80",a=new j;return a[p](G(n,o,F,1,0,0,0,2,0,1)),a[g](G(n,i,0,0,0,0,0,0,1,1)),a[v](G(n,r)),a[b](G(n,r)),a[y](G(n,o,F,1)),a[m](G(n,o,F,1)),a[d](G(n,o,F,1,0,2,0,0,0,1)),a}function Z(t){var e="#D3D3D3",n=H(t),r=e,i=0===t?P:e,a=new j;return a[p](G(P,n,F,1,0,2,0,2)),a[g](G(i,0,0,0,1,new o.LineBorder(P,2),1,new o.LineBorder(P,2),0===t?1:0,1)),a[v](G(i,r)),a[b](G(i,r)),a[y](G(i,n,F)),a[m](G(i,n,F)),a[T](G(i,n,F,1)),a[x](G(i,n,F,1)),a[d](G(P,0,P,0,0,6)),a}function Q(t){var e=H(t),n=e,r=e+" 40",i=e+" 80",a=e+" 60",s=e+" 80",l=new j;return l[p](G(r,i,P,1,1,1,1,1,0,1)),l[g](G(r,i,0,0,1,1,1,1,1,1)),l[v](G(r,a)),l[b](G(r,a)),l[y](G(r,0,0,1)),l[m](G(r,0,0,1)),l[d](G(r,s,P,1,1,new o.LineBorder(n,2),1,1,0,1)),l}function J(t){var e,n=t-1,o=h,r=c(n/7);return r>=0&&r<2&&(e="Dark"+t,(o=[$,K][r](n%7)).name(e),o.builtInName(e)),o}function $(t){var e=H(t),n=0===t?e+" 25":e+" -25",o=0===t?e+" 50":e,r=0===t?e:e+" -50",i=new j;return i[p](G(F,"black",F,1,0,0,0,2)),i[g](G(e,o,F)),i[v](G(e,n)),i[b](G(e,n)),i[y](G(F,n,F,1,0,0,2)),i[m](G(F,n,F,1,2)),i[d](G(F,r,F,1,0,2)),i}function K(t){var e,n,o,r,i,a;function s(t,e){if(t<0||t>3)return"";return{tableBackground:["Background 1 -15","Accent 1 80","Accent 3 80","Accent 5 80"],stripColor:["Background 1 -35","Accent 1 60","Accent 3 60","Accent 5 60"],headerColor:["Text 1","Accent 2","Accent 4","Accent 6"]}[e][t]}return e=H(t),n=s(t,"headerColor"),o=s(t,"stripColor"),i=r=s(t,"tableBackground"),(a=new j)[p](G(e,n,F)),a[g](G(e,r)),a[v](G(e,o)),a[b](G(e,o)),a[y](G(e,0,0,1)),a[m](G(e,0,0,1)),a[d](G(P,i,0,1,0,6)),a}for(Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=o.GC$.each,i=o.GC$.isEmptyObject,a=o.Ul.Ol,s=JSON.stringify,l=JSON.parse,u=o.Ul.Pl,c=Math.floor,f=void 0,h=null,"firstHeaderCellStyle","lastHeaderCellStyle",S=[p="headerRowStyle",d="footerRowStyle",g="wholeTableStyle",m="highlightLastColumnStyle",y="highlightFirstColumnStyle",v="firstRowStripStyle",C="secondRowStripStyle",b="firstColumnStripStyle",w="secondColumnStripStyle","firstHeaderCellStyle","lastHeaderCellStyle",T="firstFooterCellStyle",x="lastFooterCellStyle"],"firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize",A=["firstRowStripSize","secondRowStripSize","firstColumnStripSize","secondColumnStripSize"],"name","bold 11pt calibri",D=["backColor","foreColor","font",I="borderLeft",R="borderTop",k="borderRight",M="borderBottom",N="borderHorizontal",E="borderVertical","textDecoration"],O=function(){function t(t,e,n,o,i,a,s,l,u,c){var f=this,h=arguments;r(D,(function(t,e){f[e]=h[t]}))}return t.prototype.Yo=function(t,e,n,o,i){var s=this;r(D,(function(r,l){l.indexOf("border")>=0?(n&&a(s[I])&&!a(t[I])&&(t[I]=s[I],t[I].level=20),e&&a(s[R])&&!a(t[R])&&(t[R]=s[R],t[R].level=20),i&&a(s[k])&&!a(t[k])&&(t[k]=s[k],t[k].level=20),o&&a(s[M])&&!a(t[M])&&(t[M]=s[M],t[M].level=20),o||!a(s[N])||a(t[M])||(t[M]=s[N],t[M].level=20),i||!a(s[E])||a(t[k])||(t[k]=s[E],t[k].level=20)):a(s[l])&&!a(t[l])&&(t[l]=s[l])}))},t.prototype.Uo=function(){var e=new t,n=s(this.toJSON());return e.fromJSON(l(n)),e},t.prototype.toJSON=function(){var t=this,e={};return r(D,(function(n,o){var r=t[o],a=r&&r.toJSON?r.toJSON():r;e[o]=i(a)?f:a})),e},t.prototype.fromJSON=function(t,e){if(t){var n=this;r(D,(function(r,i){var s,l=t[i];a(l)&&(i.indexOf("border")>=0?((s=new o.LineBorder).fromJSON(l,e),n[i]=s):n[i]=l)}))}},t}(),e.TableStyle=O,j=function(){function t(){}return t.prototype.toJSON=function(){var t,e,n=this,o=n.builtInName();return o?{buildInName:o}:(t={name:n.name()},r(S,(function(o,r){(e=n[r]())&&(t[r]=e.toJSON())})),r(A,(function(o,r){1!==(e=n[r]())&&(t[r]=e)})),i(t)?f:t)},t.prototype.fromJSON=function(t,e){var n,o,i,s;if(t){if(n=this,o=t.buildInName)return void function(t,e){t.name(e.name()),r(A,(function(n,o){t[o](e[o]())})),r(S,(function(n,o){var r=e[o]();t[o](r?r.Uo():h)})),t.builtInName(e.builtInName(),!1)}(n,_[o.toLowerCase()]);i=t.name,s=a(i)?i:t.Cj,a(s)&&n.name(s,!1),r(A,(function(e,o){var r=t[o]!==f?t[o]:t["_"+o];r&&n[o](r,!1)})),r(S,(function(o,r){var i,a=t[r]!==f?t[r]:t["_"+r];a&&((i=new O).fromJSON(a,e),n[r](i,!1))}))}},t}(),e.TableTheme=j,j.prototype.name=u("name"),j.prototype.builtInName=u("builtInName"),r(S,(function(t,e){j.prototype[e]=u(e)})),r(A,(function(t,e){j.prototype[e]=u(e,1)})),F="white",P="black",_=function(){},e.TableThemes=_,L=1;L<=28;L++)L<=21&&(_["light"+L]=V(L)),L<=11&&(_["dark"+L]=J(L)),_["medium"+L]=q(L)},"./dist/plugins/table/table-util.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g;function m(t){throw Error(t)}function y(t){t.suspendPaint()}function v(t){t.resumePaint()}function C(t){i&&t.suspendCalcService()}function b(t,e){i&&t.resumeCalcService(e)}function w(t){return t&&!(/\d/.test(t[0])||/[\s\+\-\*\\:%!\[\]]/.test(t)||-1!==["C","c","R","r"].indexOf(t)||/^[A-Za-z]{1,3}(\$)?\d+$/.test(t)||/^[Rr]\d*[Cc]\d*$/.test(t)||t.length>=255)}function T(t,e,n,o,r){return r=r===c||r,t.Wu.unparse(t.yj(),e,n,o,!1,r)}function x(t,e,n){var o=t.getValue(e,n);return!(o===u||!l(o))||!!(t.getSparkline&&t.getSparkline(e,n))||S(t.Iq(e,n))}function S(t){return!(!t||!(t.backColor||t.backgroundImage||t.borderBottom||t.borderLeft||t.borderRight||t.borderTop||t.diagonalDown||t.diagonalUp))}function A(t,e,n,o,r,i,a,s){return t>=r&&!(e===a&&e+o-1===s)&&(e<a&&e+o>=a||e>=a&&e<=s&&e+o-1>s)}function I(t,e,n,o,r,i,a,s){return e>=a&&!(t===r&&t+n-1===i)&&(t<r&&t+n>=r||t>=r&&t<=i&&t+n-1>i)}function R(t){var e,n,o,r,i=t.ITa,a=i.XTa(3).dataTable,s=i.getLastNonNullRow(3,!0),l=t.getRowCount(),u=t.getColumnCount();for(o=l-1;o>-1;o--)if(e=a[o])for(r=0;r<u;r++)if((n=e[r])&&!h(n.value))return f(o,s);return f(-1,s)}function k(t){var e,n,o,r,i=t.ITa,a=i.XTa(3).dataTable,s=i.getLastNonNullCol(3,!0),l=t.getRowCount();for(o=t.getColumnCount()-1;o>-1;o--)for(r=0;r<l;r++)if((n=(e=a[r])&&e[o])&&!h(n.value))return f(o,s);return f(-1,s)}function M(t,e){var n=t.cj;return e-(t.MZ?n+1:n)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("SheetsCalc"),i=n("@grapecity/js-calc"),a=n("Common"),s=n("./dist/plugins/table/table.ns.js"),l=o.Ul.Ol,u=null,c=void 0,f=Math.max,h=a.Common.j.Fa,p=0,d=new a.Common.ResourceManager(s.SR),g=d.getResource.bind(d),e.Util={throwError:m,setFormulaToSheet:function(t,e,n,o,r){!o&&r&&(o=T(t,r,e,n)),i&&t._u(e,n,o,r)},setValue:function(t,e,n,o){t.setValue(e,n,o)},suspendPaint:y,resumePaint:v,ih:function(t){return t.Cf().ih()},suspendCalcService:C,resumeCalcService:b,RMb:function(t){t&&(y(t),t.suspendEvent(),C(t))},SMb:function(t){t&&(b(t),t.resumeEvent(),v(t))},getRowCount:function(t){return t.rowCount},getColCount:function(t){return t.colCount},isValidTableName:w,formulaToExpression:function(t,e,n,o,r){var i,a=t.yj();return a.DLb=r,i=t.Wu.parse(a,e,n,o,!1,!1,!1),delete a.DLb,i},expressionToFormula:T,checkTableName:function(t){var e,n,o,r;return!(!t||(w(t)||m(g().Exp_TableNameInvalid),e=this,n=e.name(),o=e.tc,t===n||o&&(r=o.findByName(t),r&&e!==r)))},TMb:function(t,e,n){return{col:e,leadingCellRow:n,row:t}},nMb:function(t,e,n){var o=u,r=e.cj,i=e.endRow();for(n&&(i-=e.NZ?1:0);i>=r&&t.getRowHeight(i)<=0;)i--;return i>=r&&(o=i),o},oMb:function(t,e){for(var n=u,o=e.dj,r=e.endColumn();r>=o&&t.getColumnWidth(r)<=0;)r--;return r>=o&&(n=r),n},UMb:function(t,e){var n,r,i,a=e.tc,s=e.cj+e.Xj-1,l=e.dj,u=l+e.OZ-1,c=R(t),h=a?a.PMb():-1;return n=s,(c=f(c,h))>s&&(r=s+1,i=new o.Range(r,l,c-s,u-l+1),n=f(function(t,e,n,o,r){var i,a,s;for(i=n;i>=e;i--)for(a=o;a<=r;a++){if(S(t.Iq(i,a)))return i;if(x(t,i,a))return i;if(s=t.ITa.findSpan(i,a))return s.row+s.rowCount-1}return-1}(t,r,c,l,u),a.PMb(i))),n},VMb:function(t,e){var n,r,i,a=e.tc,s=e.cj,l=s+e.Xj-1,u=e.dj+e.OZ-1,c=k(t),h=a?a.QMb():-1;return n=u,(c=f(c,h))>u&&(r=u+1,i=new o.Range(s,r,l-s+1,c-u),n=f(function(t,e,n,o,r){var i,a,s;for(a=r;a>=o;a--)for(i=e;i<=n;i++){if(S(t.Iq(i,a)))return a;if(x(t,i,a))return a;if(s=t.ITa.findSpan(i,a))return s.col+s.colCount-1}return-1}(t,s,l,r,c),a.QMb(i))),n},WMb:function(t,e,n,o,r,i,a,s,l,u){var c,f,h=t.getRowCount()-1,p=t.getColumnCount()-1,d=t.ITa.getSpans(),y=e.tc&&e.tc.l$;return!s&&(!l&&h-o<a||l&&p-i<a)?(u||m(g().Exp_TableAddRowNoEnoughRoom),!0):(c=l?I:A,(f=d.some((function(t){var e=t.row,a=t.col,s=t.rowCount,l=t.colCount;return c(e,a,s,l,n,o,r,i)})))?u||m(g().Exp_TableAddRowIntersectSpan):y&&((f=y.some((function(t){var e=t.cj,a=t.dj,s=t.Xj,l=t.OZ;return c(e,a,s,l,n,o,r,i)})))&&!u&&m(g().Exp_TableAddRowIntersectTable)),f)},XMb:function(t,e,n){var r,i,a,s=e.row,l=e.col,u=s+e.rowCount,f=l+e.colCount;for(r=s;r<u;r++)for(i=l;i<f;i++)if((a=t.getCell(r,i)).value()||t.ITa.findSpan(r,i)){if(n&&n.equals(new o.Range(a.row,a.col,1,1)))continue;return new o.Range(r,i,1,1)}return c},YMb:function(t,e){return{action:e,table:t}},ZMb:M,$Mb:function(t,e){return e-t.dj},_Mb:function(t){var e=p;return t&&p++,e},aNb:function(t){return"string"==typeof t},pMb:function(t,e,n,r){var i={sheet:t,table:e,oldRange:n,newRange:r};t.Wq(o.Events.TableResizing,i)},$Lb:function(t,e,n,r){var i={sheet:t,table:e,oldRange:n,newRange:r};t.Wq(o.Events.TableResized,i)},PIb:function(t,e,n,r,i,a,s){var l={sheet:t,table:e,propertyName:n,row:M(e,r),count:i};h(a)||(l.isAfter=a),s&&(l.deletedItem=s),t.Wq(o.Events.TableRowsChanged,l)},QIb:function(t,e,n,r,i,a){var s={sheet:t,table:e,propertyName:n,col:r-e.dj,count:i};h(a)||(s.isAfter=a),t.Wq(o.Events.TableColumnsChanged,s)},bNb:function(t,e,n){var o=0;if(t.VZ(e,n))for(o=2;t.VZ(e+o,o);)o++;return o>0&&(e+=o),e},bW:function(t){return t&&"="===t[0]},cNb:function(t){var e,n,o=-1;if(t)for(e=t.arguments,void 0,n=0;n<e.length;n++)if(e[n]instanceof r.xzb){o=n;break}return o},dNb:function(t,e,n){var o=t.dataRange(),r=o.row,i=o.col;return(n?r:i)+e},eNb:function(t){var e=t;return t&&"="===t[0]&&(e=t.slice(1)),e},fNb:function(t,e){var n,o;for(o=0;o<t.length;o++)if((n=t[o])&&e===n.col)return n;return u},_getTable:function(t,e){var n,o,r;if(!e)return null;for(n=e.row;n<e.row+e.rowCount;n++)for(o=e.col;o<e.col+e.colCount;o++)if(t.tables&&(r=t.tables.find(n,o)))return r;return null},Pda:function(t,e){return e?t.tables.s$(e.row,e.col,e.rowCount,e.colCount):null},jhc:function(t){return h(t)||("string"!=typeof t&&(t+=""),t=t.replace(/\r\n?/g,"\n")),t},gNb:function(t){return t===c}}},"./dist/plugins/table/table.entry.js":function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),n("./dist/plugins/table/table.interface.js"),n("./dist/plugins/table/table-event.js"),n("./dist/plugins/table/table-render.js"),n("./dist/plugins/table/table-action.js"),n("./dist/plugins/table/table-util.js"),o(n("./dist/plugins/table/table-theme.js")),o(n("./dist/plugins/table/table.js")),o(n("./dist/plugins/table/table.ns.js"))},"./dist/plugins/table/table.interface.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0})},"./dist/plugins/table/table.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht,Vt,zt,Wt,Ut,qt,Yt,Xt,Zt,Qt,Jt,$t=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),Kt=this&&this.__assign||function(){return(Kt=Object.assign||function(t){var e,n,o,r;for(n=1,o=arguments.length;n<o;n++)for(r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function te(t,e){var n={position:o.ButtonPosition.right,imageType:o.ButtonImageType.dropdown,visibility:o.ButtonVisibility.onSelected,useButtonStyle:!1,command:"openList"},r={items:[{text:Ut().Table_None,value:null},{text:Ut().Table_Average,value:"=SUBTOTAL(101,["+e+"])"},{text:Ut().Table_Count,value:"=SUBTOTAL(103,["+e+"])"},{text:Ut().Table_Count_Numbers,value:"=SUBTOTAL(102,["+e+"])"},{text:Ut().Table_Max,value:"=SUBTOTAL(104,["+e+"])"},{text:Ut().Table_Min,value:"=SUBTOTAL(105,["+e+"])"},{text:Ut().Table_Sum,value:"=SUBTOTAL(109,["+e+"])"},{text:Ut().Table_StdDev,value:"=SUBTOTAL(107,["+e+"])"},{text:Ut().Table_Var,value:"=SUBTOTAL(110,["+e+"])"}]},i=new o.Style;return i.cellButtons=[n],i.dropDowns=[{type:o.DropDownType.list,option:r,submitCommand:"tableTotalRowFormula"}],i}function ee(t){return function(e,n){var o=this.kj;o&&e!==n&&o.ITa.pVa(this,t,n)}}function ne(t,e,n,o,r){var i,a,s=0===r,l=s?t.Ts:t.nNb,u=-1;for(a=0;a<l.length;a++)if((i=l[a])&&i.key===o){u=a;break}u>-1&&l.splice(u,v(n)?1:n),s&&t.phc()}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("SheetsCalc"),i=n("Common"),a=n("@grapecity/js-calc"),s=n("Filters"),l=n("Bindings"),u=n("./dist/plugins/table/table.ns.js"),c=n("./dist/plugins/table/table-theme.js"),f=n("./dist/plugins/table/table-util.js"),h=o.Ul.Pl,p=o.Ul.Ol,d=o.Ul.bc,g=o.GC$.inArray,m=o.GC$.each,y=o.GC$.isEmptyObject,v=i.Common.j.Fa,C=i.Common.l,b=i.Common.k.Bb,w=i.Common.D,T=f.Util.throwError,x=f.Util.setFormulaToSheet,S=f.Util.setValue,A=f.Util.suspendPaint,I=f.Util.resumePaint,R=f.Util.ih,k=f.Util.suspendCalcService,M=f.Util.resumeCalcService,N=f.Util.getRowCount,E=f.Util.getColCount,D=f.Util.checkTableName,O=f.Util.isValidTableName,j=f.Util.formulaToExpression,F=f.Util.expressionToFormula,P=f.Util.TMb,_=f.Util.nMb,L=f.Util.oMb,B=f.Util.UMb,G=f.Util.VMb,H=f.Util.WMb,V=f.Util.XMb,z=f.Util.YMb,W=f.Util.ZMb,U=f.Util.$Mb,q=f.Util._Mb,Y=f.Util.aNb,X=f.Util.RMb,Z=f.Util.SMb,Q=f.Util.PIb,J=f.Util.QIb,$=f.Util.bNb,K=f.Util.bW,tt=f.Util.cNb,et=f.Util.dNb,nt=f.Util.eNb,ot=f.Util.fNb,rt=f.Util.Pda,it=f.Util.jhc,at=f.Util.gNb,st=null,lt=void 0,ut=Math.min,ct=Math.ceil,ft=Math.max,ht=JSON.stringify,pt=JSON.parse,yt="highlightFirstColumn",vt="highlightLastColumn",Ct="bandRows",bt="bandColumns",wt="autoGenerateColumns",Tt=".table",xt="Column",kt="footerRowStyles",Mt=["id",dt="name",gt="cellType","value",mt="formatter",St="dataField",At="footerFormula",It="dataAreaFormula",Rt="footerValue"],Nt="table",Et="tableInsertRows",Dt="tableDeleteRows",Ot="tableInsertColumns",jt="tableDeleteColumns",Ft="collection",Pt="tableColumn",_t="property",Lt="dataSource",Bt="rowsChange",Gt="range",Ht="columns",Vt="tableExpression",zt="sheetExpression",Wt=new i.Common.ResourceManager(u.SR),Ut=Wt.getResource.bind(Wt),function(t){t.TABLE_ROW_SELECT="tableRowSelect",t.TABLE_COL_SELECT="tableColSelect",t.TABLE_CORNER_SELECT="tableCornerSelect",t.TABLE_SELECT="tableSelect"}(qt=e.TableSelectionType||(e.TableSelectionType={})),function(t){t[t.deleted=0]="deleted",t[t.dirty=1]="dirty"}(Yt||(Yt={})),o.Worksheet.$n(Nt,{priority:2e3,init:function(){var t=this;t.tables=t.ITa.noa,t.unbind(Tt),t.bind(o.Events.BeforeDragDrop+Tt,(function(e,n){var o,r=t,i=t.tables,a=Ut().Exp_DragDropChangePartOfTable,s=n.fromRow,l=n.fromColumn,u=N(n),c=n.columnCount,f=r.mm.gA,h=f.row,p=f.col,d=n.isDragInsert,g=n.isDragCopy,m=st;!d||-1!==s&&-1!==l||(l>=0?(t.isDragCopy&&(p<=l||p>=l+c)||!g&&(p<l||p>l+c))&&(o=!1,i.HZ(-1,p,-1,1)&&(o=!0,m=Ut().Exp_DragDropShiftTableCell),o||g||!i.HZ(-1,l,-1,c)||(m=a)):s>=0&&l<0&&(g&&(h<=s||h>=s+u)||!g&&(h<s||h>s+u))&&!g&&i.HZ(s,-1,u,-1)&&(m=a)),n.invalidMessage=m})),t.bind(o.Events.RowChanged+Tt,(function(e,n){var o=t.tables,r=o.$m,i=n.propertyName;"isVisible"===i?(!1===n.newValue?r[n.row]=0:r[n.row]=lt,o.hNb(n.row)):"height"===i&&(r[n.row]=lt,o.hNb(n.row))})),t.bind(o.Events.RowHeightChanged+Tt,(function(e,n){var o,r,i,a=t.tables,s=a.$m;for(o=0,r=n.rowList;o<r.length;o++)s[i=r[o]]=lt,a.hNb(i)})),t.bind(o.Events.ColumnChanged+Tt,(function(e,n){var o=t.tables,r=o.an;"isVisible"===n.propertyName?(!1===n.newValue?r[n.col]=0:r[n.col]=lt,o.iNb(n.col)):"width"===n.propertyName&&(r[n.col]=lt,o.iNb(n.col))})),t.bind(o.Events.ColumnWidthChanged+Tt,(function(e,n){var o,r,i,a=t.tables,s=a.an;for(o=0,r=n.colList;o<r.length;o++)s[i=r[o]]=lt,a.iNb(i)})),t.bind(o.Events.RangeFiltered+Tt,(function(e,n){var o,r=t.tables,i=r.$m,a=n.sheet.xr.range;for(o=0;o<a.rowCount;o++)i[a.row+o]=lt,r.hNb(a.row+o)})),t.bind(o.Events.TableFiltered+Tt,(function(e,n){var o,r=t.tables,i=r.$m,a=n.table.range();for(o=0;o<a.rowCount;o++)i[a.row+o]=lt,r.hNb(a.row+o)})),t.bind(o.Events.TableFilterCleared+Tt,(function(e,n){t.tables.Nm()}))},resetBinding:function(t){this.tables.IZ()},initBinding:function(t){var e,n,o,r,i=this,a=i.tables;for(a.IZ(),k(i),n=0,o=(e=a.all()).length;n<o;n++)(r=e[n])&&r.JZ();M(i)},dispose:function(t){!1!==t.clearCache&&(this.unbind(Tt),this.tables&&(this.tables.no(),this.tables=null))},clearPendingChanges:function(){var t=this.tables;t&&t.Xec()},onGroupChanged:function(t){var e,n,o=this.tables;if(t.fromSetCollapsed)for(e=t.isRow?o.$m:o.an,n=t.start;n<=t.end;n++)e[n]=lt,t.isRow?o.hNb(n):o.iNb(n)},onLayoutChanged:function(t){var e,n=t.changeType,o=t.row,r=t.rowCount,i=t.col,a=t.colCount,s=this.tables;"addRows"===n?(s.rI(o,r),s.Nm()):"addRows2"===n?s.KZ(o,r):"deleteRows"===n?(s.GR(o,r),s.Nm()):"addColumns"===n?(s.tI(i,a),s.Nm()):"deleteColumns"===n?(s.HR(i,a),s.Nm()):"addColumns2"===n||"deleteColumns2"===n?s.khc(i):"clear"===n?(e=t.sheetArea,t.ignoreTable||3!==e&&!v(e)||s.$b(o,i,r,a,t.type)):("setRowCount"===n||"setColumnCount"===n)&&s.Nm()},toJson:function(t,e){var n,o;n=this.tables,e&&e.ignoreStyle||(n&&(t.tables=n.toJSON()),e&&e.includeBindingSource&&((o=t.data).dataTable=o.dataTable||{},function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g=t.tables.all();for(n=0,o=g.length;n<o;n++)if(i=(r=g[n]).LZ(),s=(a=r.dataRange()).row,l=a.col,u=s+N(a)-1,c=l+E(a)-1,i)for(f=s;f<=u;f++)for(h=l;h<=c;h++)(p=r.ge(f,h)).gt&&(d=p.Qb,C.Ska(d)&&(d=C.Daa(d)),t.qI(e,f,h,d))}(this,o.dataTable)))},fromJson:function(t,e,n){var o=this.tables,r=t.tableManager,i=e?r&&r.tables:t.tables,a=n&&n.ignoreStyle;p(i)&&!a&&o&&o.fromJSON(i,e)},fromJsonAfterFormula:function(t,e,n){this.tables.all().forEach((function(t){t.formulaFromJSON()}))},lastNonNullRowAndCol:function(){var t,e,n,o,r,i,a=-1,s=-1,l=this.tables.all();if(l)for(t=0,e=l.length;t<e;t++)(n=l[t])&&((r=(o=n.range()).row+N(o)-1)>a&&(a=r),(i=o.col+E(o)-1)>s&&(s=i));return{lastNonNullRow:a,lastNonNullCol:s}},paintCell:function(t){var e,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C=this;t.isPrinting||t.sheetArea!==o.SheetArea.viewport||C.options.isProtected||(e=C.tables,n=t.ctx,i=(r=t.cell).row,a=r.col,(s=e.find(i,a))&&s.showResizeHandle()&&!s.hJb()&&(l=_(C,s),u=L(C,s),i===l&&a===u&&(c=r.x,f=r.y,h=r.width,p=r.height,d=C.zoom(),g=ct(4*d),m=ct(2*d),y=c+h,v=f+p,n&&h>0&&p>0&&(n.save(),n.rect(c,f,h,p),n.clip(),n.fillStyle="#485DB1",n.beginPath(),n.moveTo(y-g,v),n.lineTo(y,v),n.lineTo(y,v-m),n.lineTo(y-g,v-m),n.fill(),n.beginPath(),n.moveTo(y,v-m),n.lineTo(y-m,v-m),n.lineTo(y-m,v-g),n.lineTo(y,v-g),n.fill(),n.restore()))))},composeTableFooterList:function(t){var e=t.table,n=t.row,o=t.col,r=t.style;e.jNb(n,o,r)}}),o.Worksheet.prototype.PIb=function(t,e,n,o,r,i){var a=i?lt:t.nKb();Q(this,t,e,n,o,r,a)},o.Worksheet.prototype.QIb=function(t,e,n,o,r){J(this,t,e,n,o,r)},o.Workbook.prototype.jga=function(t){var e,n,o,r=this.sheets;if(r)for(o=0;o<r.length;o++)if((n=r[o].tables)&&(e=n.findByName(t)))return e;return st},Xt=function(){function t(t,e,n,o,r,i,a){var s,l=this;for(l.MZ=!a||a.showHeader===lt||a.showHeader,l.NZ=!(!a||a.showFooter===lt)&&a.showFooter,l.kNb=!(!a||a.useFooterDropDownList===lt)&&a.useFooterDropDownList,l.lNb=!(!a||a.showResizeHandle===lt)&&a.showResizeHandle,l.mNb=[],l.wq=st,l.xr=st,l.tc=st,l.lhc=!1,p(t)&&l.name(t),l.cj=p(e)?e:-1,l.dj=p(n)?n:-1,l.Xj=p(o)?o:-1,l.OZ=p(r)?r:-1,p(i)&&l.style(i),l.Nz=[],s=0;s<l.OZ;s++)l.Nz.push(new Qt(s+1));l.ZX=st,l.LAb={},l.Bec=[],l.Ts=[],l.nNb=[],l.mhc=[],l.oNb=[],l.pNb=[],l.qNb=!0}return t.prototype.no=function(){var t=this;t.Nz=[],t.mNb=[],t.Ts=[],t.nNb=[],t.mhc=[],t.LAb={},t.Bec=[],t.kj=st,t.tc=st,t.xr&&(t.xr.no(),t.xr=st),t.Nm()},t.prototype.Nm=function(){this.oNb=[],this.pNb=[]},t.prototype.range=function(){var t=this;return o.kf(t.cj,t.dj,t.Xj,t.OZ)},t.prototype.dataRange=function(){var t=this,e=t.MZ?t.cj+1:t.cj,n=t.MZ?t.Xj-1:t.Xj;return t.NZ&&n--,o.kf(e,t.dj,n,t.OZ)},t.prototype.headerIndex=function(){return this.MZ?this.cj:-1},t.prototype.footerIndex=function(){return this.NZ?this.cj+this.Xj-1:-1},t.prototype.showHeader=function(t){var e,n=this;return 0===arguments.length?n.MZ:(n.MZ!==t&&((e=n.kj)&&e.suspendPaint(),n.qVa(t),e&&e.resumePaint()),n)},t.prototype.qVa=function(t){var e,n=this,o=n.kj;o&&o.ITa.pVa(n,"showHeader",n.MZ),(n.MZ=t)?(n.cj>0&&(n.cj=n.cj-1,n.Xj+=1),n.PZ()):(e=n.cj,n.cj=n.cj+1,n.Xj-=1,n.QZ(e),n.RZ()),o&&a&&o.recalcRange(n.cj+(t?0:-1),n.dj,1,n.OZ)},t.prototype.showFooter=function(t,e){var n,o=this;if(0===arguments.length)return o.NZ;if(o.NZ!==t){(n=o.kj)&&n.suspendPaint();try{o.rVa(t,!!e&&e)}finally{n&&n.resumePaint()}}return o},t.prototype.expandBoundRows=function(t){var e=this;return 0===arguments.length?e.lhc:(e.lhc!==t&&(e.lhc=t),e)},t.prototype.rVa=function(t,e){var n,o,r,i,s,l,u,c,f,h,p,d=this,g=d.kj;if(g&&g.ITa.pVa(d,"showFooter",d.NZ),n=d.Xj,t){if((!g||d.cj+n<g.getRowCount())&&(!e||d.rNb(!0,n)))for(d.NZ=t,d.Xj+=1,r=(o=d.Nz).length,i=d.footerIndex(),s=d.dj,l=0;l<r;l++)f=s+l,(c=(u=o[l])&&u.footerFormula())&&((h=F(g,c,i,f))&&(c=j(g,h,i,f),u.footerFormula(c)));d.SZ()}else d.NZ=t,p=d.cj+n-1,d.Xj-=1,d.QZ(p),d.NAb(),d.Cec(0),e&&d.rNb(!1,n);g&&a&&g.recalcRange(d.cj+d.Xj+(t?-1:0),d.dj,1,d.OZ)},t.prototype.rNb=function(t,e){var n,r=this,i=r.kj,a=r.cj+e,s=r.dj,l=r.OZ,u=s+l-1,c=B(i,r),f=c>=a,h=V(i,new o.Range(a,s,c-a+1,u-s+1)),p=(h&&h.row)===a;return!(p&&H(i,r,a,c,s,u,1)||(p&&f&&(n=t?a+1:a-1,i.moveTo(a,s,n,s,c-a+1,l,1023)),0))},t.prototype.sNb=function(t){var e,n,o,r=this,i=r.Nz,a=i.length,s=r.dj,l=[],u=r.name();for(e=0;e<a;e++)n=s+e,o=r.getColumnName(e),l.push(te(0,o)),t||(0===e?r.j$(n,Ut().Table_Total,!0):e===a-1&&(i[e].footerFormula()||(r.tNb(n)?r.i$(e,"=SUBTOTAL(109,"+u+"["+o+"])"):r.i$(e,"=SUBTOTAL(103,"+u+"["+o+"])"))));r.mNb=l},t.prototype.tNb=function(t){var e,n,o=this.kj,r=this.dataRange(),i=!0,a=r.rowCount,s=r.row;for(e=0;e<a;e++)if(n=o.getValue(s+e,t),!v(n)&&"number"!=typeof n){i=!1;break}return i},t.prototype.uNb=function(){return this.mNb&&this.mNb.length>0},t.prototype.vNb=function(t,e,n){var o=this,r=this.kj;o.uNb()&&(r&&r.ITa.pVa(o,kt,o.wNb()),e>=0&&(n?o.mNb.splice(t,e,n):o.mNb.splice(t,e)))},t.prototype.wNb=function(){var t=this.mNb,e=[];return t.forEach((function(t){t&&e.push(t.clone())})),e},t.prototype.xNb=function(t,e,n){var o=this,r=p(n)?te(o.name(),n):st;o.uNb()&&o.vNb(t,e,r)},t.prototype.useFooterDropDownList=function(t){var e=this,n=e.kj;return 0===arguments.length?e.kNb:(n&&(n.suspendPaint(),e.kNb!==t&&(n.ITa.pVa(e,"useFooterDropDownList",e.kNb),e.kNb=t,e.kNb&&!e.uNb()&&(e.sNb(),e.e$())),n.resumePaint()),e)},t.prototype.showResizeHandle=function(t){var e=this,n=e.kj;return 0===arguments.length?e.lNb:(n&&(n.suspendPaint(),e.lNb!==t&&(n.ITa.pVa(e,"showResizeHandle",e.lNb),e.lNb=t),n.resumePaint()),e)},t.prototype.rowFilter=function(){var t=this;return!t.xr&&e.MAb&&(t.xr=new e.MAb(t),t.xr.EZ(t.dataRange())),t.xr},t.prototype.bindColumns=function(t){var e,n,o,r,i,a,s,l,u,c,f=this,h=[];if(t)for(e=ut(f.OZ,t.length),n=0;n<e;n++)(o=f.Nz[n])||(o=new Qt(f.TZ()),f.Nz[n]=o),i=(r=t[n]).id(),a=r.name(),s=r.dataField(),l=r.value(),u=$(f,a,n),o.id(i),o.name(u),o.dataField(s),o.value(l),o.cellType(r.cellType()),o.formatter(r.formatter()),c={name:u,value:l,dataField:s},s&&h.push(c),f.xNb(n,1,u);f.yNb=h,f.wq&&(f.wq.qia=h)},t.prototype.bindingPath=function(t){var e=this;return 0===arguments.length?e.UZ:(e.UZ=t,e.JZ(),e)},t.prototype.bind=function(t,e,n){var o=this,r=n;return v(t)||o.bindColumns(t),v(n)&&(r=o.LZ()),e&&(o.UZ=e,r=l.LL(r,e)),l.qL&&r&&o.zNb(r),o},t.prototype.getColumnName=function(t){var e,n,o=this.Nz;return o&&0<=t&&t<o.length&&(e=o[t])?((n=e.name())!==st&&(n=d(n)),n):st},t.prototype.setColumnName=function(t,e){var n,o,r,i,a=this;return a.VZ(e)||(n=a.Nz)&&0<=t&&t<n.length&&((o=n[t])||(o=a.Nz[t]=new Qt(a.TZ())),r=o.name(),i=a.kj,r!==e&&i&&(i.ITa.sVa(o,"name",r),o.name(e)),a.MZ&&i&&i.setText(a.headerIndex(),a.dj+t,e),a.WZ(r,o.name(),t)),a},t.prototype.WZ=function(t,e,n){var o,r=this.Nz[n];this.xNb(n,1,r.name()),(o=this.ZX)&&o.onColumnNameChanged(t,e)},t.prototype.setColumnDataField=function(t,e){var n,o,r,i=this,a=i.Nz;return a&&0<=t&&t<a.length&&((n=a[t])||(n=i.Nz[t]=new Qt(i.TZ())),o=i.kj,r=n.dataField(),o&&e!==r&&o.ITa.sVa(n,"dataField",r),n.dataField(e)),i},t.prototype.getColumnDataField=function(t){var e,n,o=this.Nz;return o&&0<=t&&t<o.length&&(e=o[t])?((n=e.dataField())!==st&&(n=d(n)),n):st},t.prototype.getColumnFormula=function(t){var e,n,o,r,i=this.Nz,a=this.kj;return i&&a&&0<=t&&t<i.length&&(e=i[t])?(n=this.footerIndex(),o=this.dj+t,(r=e.footerFormula())&&F(a,r,n,o,!1)):st},t.prototype.setColumnFormula=function(t,e){return this.i$(t,e),this},t.prototype.setColumnDataFormula=function(t,e){var n,o,r,i,s,l,u,c,f,h;if(a){if((o=(n=this).Nz)&&0<=t&&t<o.length&&(r=o[t])){for(i=n.kj,k(i),s=t+n.dj,l=n.cj,u=n.Xj,n.showHeader()&&(l++,u--),n.showFooter()&&u--,c=j(i,e,l,s,!0),f=r.dataAreaFormula(),i&&c!==f&&i.ITa.sVa(r,"dataAreaFormula",f),r.ANb(e),r.dataAreaFormula(c),h=l;h<l+u;h++)x(i,h,s,e,c);M(i,!1)}return n}},t.prototype.getColumnValue=function(t){var e,n,o=this,r=o.Nz;return r&&0<=t&&t<r.length&&(e=r[t])?o.NZ&&e.footerFormula()&&(n=o.kj)?n.getValue(o.footerIndex(),o.dj+t):e.footerValue():st},t.prototype.setColumnValue=function(t,e){var n,o,r=this,i=r.Nz,a=r.kj;return i&&0<=t&&t<i.length&&((n=i[t])&&(o=n.footerValue(),a&&e!==o&&a.ITa.sVa(n,"footerValue",o),n.footerValue(e)),r.NZ&&a&&S(a,r.footerIndex(),r.dj+t,e)),r},t.prototype.filterButtonVisible=function(t,e){var n,o,r,i,a=this,s=a.kj,l=a.rowFilter();if(!(t<0||t>=a.OZ))switch(n=arguments,n.length){case 0:return l&&l.filterButtonVisible();case 1:if("number"===(r=typeof(o=n[0])))return l&&l.filterButtonVisible(o);if("boolean"===r&&l){for(A(s),i=0;i<a.OZ;i++)l.filterButtonVisible(i,o);I(s)}return a;case 2:return l&&l.filterButtonVisible(t,e),a}},t.prototype.allowAutoExpand=function(t){var e=this,n=e.kj;return 0===arguments.length?e.qNb:(e.qNb!==t&&(n.ITa.pVa(e,"allowAutoExpand",e.qNb),e.qNb=t),e)},t.prototype.Aq=function(){return!!this.ZX},t.prototype.Yv=function(t){var e=this,n=e.tc;e.BNb(t),e.kj&&e.kj.ITa&&e.kj.ITa.CNb(e,n)},t.prototype.BNb=function(t){var e,n=this;n.tc=t,n.kj=t&&t.kj,e=n.xr,t&&e&&e.kj!==t.kj&&e.table(n)},t.prototype.Fu=function(t){var e,n,o,r,i,a,s,l,u,c=this,f=c.autoGenerateColumns(),h=c.xr&&c.xr.qZ;if(c.RZ(),(e=c.kj)&&(n=c.dataRange(),f?e.cg(n.row,n.col,N(n),E(n),3,17,!1,!0):m(c.Nz,(function(t,o){o.dataField()&&e.cg(n.row,n.col+t,N(n),1,3,17,!1,!0)}))),f&&(o=c.range(),c.$b(o.row,o.col,N(o),E(o))),t.qia=c.yNb,c.wq=t,t)if(e&&e.ITa.pVa(c,Gt,{row:c.cj,col:c.dj,rowCount:c.Xj,colCount:c.OZ}),r=t.getRowCount(),i=t.getColumnCount(),c.MZ&&r++,c.NZ&&r++,c.Xj=r,f)for(c.OZ=i,c.Nz=[],a=t.rL(),s=0;s<c.OZ;s++)l=new Qt(s+1),c.Nz[s]=l,a&&(l.name(a[s]),l.dataField(a[s]));else u=[],c.Nz.forEach((function(t){var e=t.dataField();e&&u.push(e)})),t.Nka(u);c.xr&&(c.xr.EZ(c.dataRange()),c.xr.qZ=h)},t.prototype.XZ=function(t){var e,n,o,r,i,a=this,s=a.wq;if(s&&(e=s.rL()))for(o=(n=a.Nz[t-a.startColumn()])&&n.dataField(),r=0,i=e.length;r<i;r++)if(e[r]===o)return r;return-1},t.prototype.ge=function(t,e){var n,o=!1,r=lt,i=this,a=i.wq,s=t-i.dataRange().row;return a&&s<a.getRowCount()&&((n=i.XZ(e))>=0&&(o=!0,r=a.getValue(s,n).value)),{gt:o,Qb:r}},t.prototype.yq=function(t,e,n){var o,r,i,a,s,l,u=this,c=u.wq,f=W(u,t),h=!1;return c&&((o=u.XZ(e))>=0&&(r=(i=c.getValue(f,o)).value,(s=(a=u.kj)&&a.ITa)&&i.hasBinding&&r!==n&&(l=q(!0),u.DNb(t,f,l),s.ENb(u,t,st,l,Yt.dirty),s.Cp(t,e,{Ep:r})),c.setValue(f,o,n,s&&s.zTa),h=!0)),h},t.prototype.Gq=function(t,e,n){var r=new o.Style;return this.Yo(t,e,r,n),r},t.prototype.D3=function(t){var e,n=this.tc.$m,o=n[t];return o!==lt?o:(e=this.kj,o=n[t]=e.getRowHeight(t))},t.prototype.C3=function(t){return this.kj.getColumnWidth(t)},t.prototype.Yo=function(t,e,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y=this,X=Y.style();if(X){if(i=Y.kj,a=Y.MZ,s=Y.NZ,l=Y.Nz,u=Y.highlightLastColumn(),c=Y.highlightFirstColumn(),f=Y.headerIndex(),h=Y.footerIndex(),p=a?t===Y.cj+1:t===Y.cj,d=s?t===Y.cj+Y.Xj-2:t===Y.cj+Y.Xj-1,g=e===Y.dj,m=e===Y.dj+Y.OZ-1,y=a?t===f:t===Y.cj,v=s?t===h:t===Y.cj+Y.Xj-1,C=X.highlightLastColumnStyle(),b=X.highlightFirstColumnStyle(),w=new o.Style,f===t)T=X.lastHeaderCellStyle(),m&&u&&T&&T.Yo(w,!0,!0,!0,!0),x=X.firstHeaderCellStyle(),g&&c&&x&&x.Yo(w,!0,!0,!0,!0),(S=X.headerRowStyle())&&S.Yo(w,!0,g,!0,m),m&&u&&C&&C.Yo(w,!0,!0,!1,!0),g&&c&&b&&b.Yo(w,!0,!0,!1,!0);else if(h===t)A=X.lastFooterCellStyle(),m&&u&&A&&A.Yo(w,!0,!0,!0,!0),I=X.firstFooterCellStyle(),g&&c&&I&&I.Yo(w,!0,!0,!0,!0),(R=X.footerRowStyle())&&R.Yo(w,!0,g,!0,m),m&&u&&C&&C.Yo(w,!1,!0,!0,!0),g&&c&&b&&b.Yo(w,!1,!0,!0,!0);else{if(m&&u&&C&&C.Yo(w,y,!0,v,!0),g&&c&&b&&b.Yo(w,y,!0,v,!0),k=a?t-Y.cj-1:t-Y.cj,M=e-Y.dj,N=void 0,E=void 0,D=void 0,O=void 0,j=void 0,F=void 0,P=void 0,_=!r||"cellType"!==r&&"formatter"!==r,Y.bandRows()&&_&&(E=(N=X.firstRowStripSize())+X.secondRowStripSize())>0){if(void 0===(D=Y.oNb[t])){if(o.mn.nn&&o.mn.sn){for(L=o.mn.sn,B=Y.dataRange().row;-1===L[B];)B++;if(B>t)return;k=L[t]-L[B]}else if(i){for(G=0,B=Y.dataRange().row;B<t;B++)Y.D3(B)>0&&G++;k=G}D=Y.oNb[t]=k%E}O=X.firstRowStripStyle(),j=X.secondRowStripStyle(),D<N&&O?(F=0===D,P=d||D===N-1,O.Yo(w,F,g,P,m)):D>=N&&j&&(F=D===N,P=d||D===E-1,j.Yo(w,F,g,P,m))}if(Y.bandColumns()&&_&&(E=(N=X.firstColumnStripSize())+X.secondColumnStripSize())>0){if(void 0===(D=Y.pNb[e])){if(H=0,i)for(V=Y.dj;V<e;V++)Y.C3(V)>0&&H++;D=Y.pNb[e]=H%E}O=X.firstColumnStripStyle(),j=X.secondColumnStripStyle(),D<N&&O?(F=0===D,P=m||D===N-1,O.Yo(w,p,F,d,P)):D>=N&&j&&(F=D===N,P=m||D===E-1,j.Yo(w,p,F,d,P))}l&&l.length>0&&((z=l[M])&&(W=z.cellType(),U=z.formatter(),W&&(w.cellType=W),U&&(w.formatter=U)))}(q=X.wholeTableStyle())&&q.Yo(w,y,g,v,m),Y.Oka(n,w)}},t.prototype.jNb=function(t,e,n){var o,r,i,a=this,s=a.NZ,l=a.kNb;a.footerIndex()===t&&s&&a.uNb()&&((o=a.mNb[e-a.dj])&&l&&(r=n.cellButtons,i=n.dropDowns,v(r)&&(r=[]),n.cellButtons=r.concat(o.cellButtons),v(i)&&(i=[]),n.dropDowns=i.concat(o.dropDowns)))},t.prototype.Oka=function(t,e){var n,o,r,i,a=t;v(a.backColor)&&(a.backColor=e.backColor),at(a.foreColor)&&(a.foreColor=e.foreColor),v(a.themeFont)&&v(a.font)?(a.themeFont=e.themeFont,a.font=e.font):!v(a.themeFont)&&v(a.font)&&(a.font=e.font),v(a.borderLeft)&&(n=e.borderLeft,a.borderLeft=n&&n.Uo()||n,a.borderLeft&&(a.borderLeft.level=20)),v(a.borderTop)&&(o=e.borderTop,a.borderTop=o&&o.Uo()||o,a.borderTop&&(a.borderTop.level=20)),v(a.borderRight)&&(r=e.borderRight,a.borderRight=r&&r.Uo()||r,a.borderRight&&(a.borderRight.level=20)),v(a.borderBottom)&&(i=e.borderBottom,a.borderBottom=i&&i.Uo()||i,a.borderBottom&&(a.borderBottom.level=20)),v(a.textDecoration)&&(a.textDecoration=e.textDecoration),v(a.cellType)&&(a.cellType=e.cellType),v(a.formatter)&&(a.formatter=e.formatter)},t.prototype.YZ=function(t,e){var n,o,r,i,a,s=this;if((t!==s.cj||e!==s.dj)&&(n=s.kj)){if((t<0||n.getRowCount()<t+s.Xj||e<0||n.getColumnCount()<e+s.OZ)&&T(Ut().Exp_TableMoveOutOfRange),r=void 0,i=void 0,o=s.tc)for(i=0,a=(r=o.l$).length;i<a;i++)if(r[i]===s){r.splice(i,1),s.ZZ();break}n.moveTo(s.cj,s.dj,t,e,s.Xj,s.OZ,3),r&&i<=a&&(s.$Z(t,e),r.splice(i,0,s),s._Z()),this.Cec(1)}},t.prototype.$Z=function(t,e){var n=this,o=n.kj;o&&o.ITa.pVa(n,Gt,{row:n.cj,col:n.dj,rowCount:n.Xj,colCount:n.OZ}),n.cj=t,n.dj=e,n.a$(),n.Nm()},t.prototype.ZZ=function(t,e,n){var o,r,i,s,l,u,c,f,h,p,d,g,m,y,C=this,b=C.kj;if(b&&a){for(o=C.Nz,r=C.footerIndex(),i=C.range(),l=(s=C.dataRange()).row,u=N(s),v(t)&&(t=0,e=o.length);t<e;t++)if(c=o[t],f=i.col+t,c){for(c.footerFormula()&&r>=0&&(x(b,r,f,st),S(b,r,f,st)),h=c.ANb(),p=nt(h),d=void 0,g=void 0,m=0;m<u;m++)g=l+m,d=b.getFormula(g,f),v(d)||(v(C.FNb)&&(C.FNb=[]),C.FNb.push({row:g,col:f,formula:d})),v(d)||!v(p)&&F(b,j(b,p,C.cj,f),g,f)===d||(v(C.GNb)&&(C.GNb=[]),y=ot(C.GNb,f),v(y)?((y={}).col=f,y.rowIndexes=[],y.rowIndexes.push(g),C.GNb.push(y)):y.rowIndexes.push(g));if(c.ANb(lt),c.dataAreaFormula())for(m=0;m<u;m++)x(b,g=l+m,f,st),S(b,g,f,st)}!0===n&&(C.FNb=[])}},t.prototype.HNb=function(t,e,n){var o,r,i,a,s,l,u=this,c=u.kj,f=u.FNb;if(f){for(i=0;i<f.length;i++)o=!0,(r=f[i])&&(a=r.row,s=r.col,l=r.formula,a>=t&&(!0===n&&(a+=e),!1===n&&(a<t+e?o=!1:a-=e)),o&&x(c,a,s,l));u.FNb=[]}u.Gj(t,e,!0,n)},t.prototype.INb=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,S=this,A=S.kj,I=S.FNb;if(I){for(i=0;i<I.length;i++)o=!0,(r=I[i])&&(a=r.row,s=r.col,l=r.formula,s>=t&&(!0===n&&(s+=e),!1===n&&(s<t+e?o=!1:s-=e)),o&&x(A,a,s,l));for(u=S.GNb||[],c=void 0,i=0;i<u.length;i++)(c=u[i])&&((f=c.col)>=t&&(!0===n&&(c.col+=e),!1===n&&f>=t+e&&(c.col-=e)));for(S.Gj(t,e,!1,n),p=(h=S.Nz).length,g=(d=S.dataRange()).row,m=d.col,y=d.rowCount,v=void 0,C=void 0,void 0,b=void 0,w=void 0,i=0;i<p;i++)if(w=m+i,(C=h[i])&&C.dataAreaFormula()){for(v=g,T=0;T<u.length;T++)if((c=u[T])&&c.col===w){for(;c.rowIndexes.indexOf(v)>-1&&v<g+y;)v++;break}v<g+y&&((b=A.getFormula(v,w))&&C.dataAreaFormula(j(A,b,g,w)))}S.FNb=[],S.GNb=[]}},t.prototype.Gj=function(t,e,n,o,r){var i,a,s,l,u,c,f=this,h=f.kj,p=f.Nz,d=f.footerIndex(),g=f.dataRange(),m=g.row,y=g.col,v=g.rowCount,C=g.colCount,b=h.Bj(),w=h.Wu;if(w&&b&&((i=w.ih())&&(r||(i.Dj(b,m,y,v,C),i.Gj(b.xf,t,e,n,o,!0)),f.NZ)))for(r||(i.Dj(b,d,y,1,C),i.Gj(b.xf,t,e,n,o,!1)),c=0;c<C;c++)(a=p[c])&&(u=y+c,(s=a.footerFormula())&&((l=h.getFormula(d,u))&&(h&&h.ITa.sVa(a,"footerFormula",s),a.footerFormula(j(h,l,d,u)))))},t.prototype._Z=function(){var t,e,n,o=this,r=o.kj;r&&a&&(t=o.footerIndex(),e=o.range(),n=o.dataRange(),m(o.Nz,(function(o,i){var a,s,l,u=e.col+o,c=i.footerFormula(),f=i.dataAreaFormula();if(c&&t>=0&&x(r,t,u,st,c),f)for(a=0,s=N(n);a<s;a++)l=n.row+a,x(r,l,u,st,f)})))},t.prototype.b$=function(t){var e,n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,x,S,A,I,R,k,M,D,O=this,j=O.dataRange();if(!t.equals(O.range())){if(e=t.row,n=t.col,r=N(t),i=E(t),a=O.MZ,s=O.NZ,l=O.kNb,u=0,1,a&&(u+=1),s&&(u+=1),(c=O.kj)&&((r<u||i<1||e+r>c.getRowCount()||n+i>c.getColumnCount())&&T(Ut().Exp_TableResizeOutOfRange),e===O.cj&&t.intersect(O.cj,O.dj,O.Xj,O.OZ)||T(Ut().Exp_TableResizeInvalidRange),c.ITa.pVa(O,Gt,{row:O.cj,col:O.dj,rowCount:O.Xj,colCount:O.OZ}),c.ITa.pVa(O,Ht,O.Nz.slice())),f=O.Nz,h=n,p=n+i-1,d=O.dj,g=O.dj+O.OZ-1,m=O.OZ,O.dj=n,O.OZ=i,h<d){for(y=0,v=h;v<d;v++)C=new Qt(O.TZ()),f.splice(y,0,C),y++;a&&O.PZ(0,d-h),s&&O.SZ(0,d-h)}else h<=g&&(O.ZZ(d,h),f.splice(0,h-d));if(p>g){for(v=g+1;v<=p;v++)C=new Qt(O.TZ()),f.push(C);a&&O.PZ(m,p-g),s&&O.SZ(m,p-g),l&&O.JNb(m)}else p>=d&&(O.ZZ(p,g),f.splice(f.length-(g-p),g-p));r!==O.Xj&&(b=O.wq,x=(w=O.dataRange()).row,S=N(w),b?r>O.Xj?(A=x+S-1,I=r-O.Xj,c&&(R=A+I+1,(k=V(c,new o.Range(R,h,c.getRowCount()-R,p)))&&k.row<R||O.eMb(A,I,!0,!1))):c&&(M=O.Xj-r,O.STa(x+S-M,M)):(D=void 0,s&&(O.SZ(),D=O.footerIndex()),O.Xj=r,O.LNb(),s&&(O.e$(),O.QZ(D)))),O.a$(),O.f$(j,O.dataRange()),O.NAb(),O.Cec(0)}},t.prototype.f$=function(t,e){var n,o,r,i,a,s,l,u,c,f,h=this.ZX;h&&(n=t.col,o=N(t),r=E(t),i=e.col,a=N(e),s=E(e),l=t.row+o,u=n+r,f=i+s,(c=e.row+a)<l&&h.onRowsRemoved(a,l-c),c>l&&h.onRowsAdded(o,c-l),i>n&&h.onColumnsRemoved(0,i-n),f<u&&h.onColumnsRemoved(s,u-f),i<n&&h.onColumnsAdded(0,n-i),f>u&&h.onColumnsAdded(n+r-i,f-u))},t.prototype.a$=function(){var t=this.xr;t&&(t.EZ(this.dataRange()),t.reFilter())},t.prototype.RZ=function(){var t=this.xr;t&&(t.unfilter(),t.reset())},t.prototype.VZ=function(t,e){var n;for(t!==st&&(t=d(t)),n=0;n<this.OZ;n++)if(n!==e&&t===this.getColumnName(n))return!0;return!1},t.prototype.g$=function(t){var e,n,o,r=this,i=r.Nz;return r.MZ&&i?0<=(e=t-r.dj)&&e<i.length&&(n=i[e])?(o=n.name(),v(o)||(o=d(o)),o):st:st},t.prototype.h$=function(t,e){var n,o,r,i,a,s=this,l=s.Nz;s.MZ&&l&&(n=l.length,0<=(o=t-s.dj)&&o<n&&((r=l[o])&&(i=r.name(),(a=s.kj)&&e!==i&&a.ITa.sVa(r,"name",i),r.name(e),s.WZ(i,r.name(),o))))},t.prototype.i$=function(t,e,n){var o,r,i=this,s=i.Nz,l=i.footerIndex(),u=i.dj+t,c=i.kj;a&&0<=t&&t<s.length&&(o=s[t],e&&!n&&c&&(n=j(c,e,l,u),i.NZ&&x(c,l,u,e,n)),o&&(r=o.footerFormula(),c&&n!==r&&c.ITa.sVa(o,"footerFormula",r),o.footerFormula(n)))},t.prototype.j$=function(t,e,n){var o,r,i,a,s=this,l=s.Nz;(n||s.NZ)&&l&&(0<=(o=t-s.dj)&&o<l.length&&((r=l[o])&&(e!==(i=r.footerValue())&&((a=s.kj)&&(a.ITa.sVa(r,"footerValue",i),a.ITa.Cp(s.cj+s.Xj-1,t,{Ep:r.footerValue()}))),r.footerValue(e))))},t.prototype.TZ=function(){var t,e,n=this.Nz,o=n&&n.length,r=[];for(e=0;e<o;e++)(t=n[e])&&t.k$()&&r.push(t.id());if(r.sort((function(t,e){return t-e})),(o=r.length)>0){for(e=0;e<o;e++)if(r[e]!==e+1)return e+1;return o+1}return 1},t.prototype.dga=function(t,e){var n,o,r,i;if(t&&!this.VZ(t,e))return t;if(o=xt,r=0,t)o=t,r=1;else if(e>0&&(t=this.Nz[e-1].name(),i=/[0-9]+$/.exec(t))){if(n=(o=t.substr(0,i.index))+((r=parseInt(t.substr(i.index),10))+1),!this.VZ(n))return n;o=t,r=1}for(;;)if(n=o+ ++r,!this.VZ(n))return n},t.prototype.PZ=function(t,e,n){var o,r,i,s,l,u,c,f,h,p,d=this,m=d.Nz,y=d.kj;if(d.MZ&&m&&y)for(o=m.length,r=d.headerIndex(),i=d.dj,v(t)&&(t=0),v(e)&&(e=o),l=ut(o,t+e),c=t;c<l;c++)(s=m[c])&&(f=d.tc.l$,(h=g(d,f))>-1&&f.splice(h,1),u=it(y.getValue(r,i+c)),h>-1&&f.splice(h,0,d),x(y,r,i+c,st),u&&!n?(a&&y.zq(r,i+c),(p=d.dga(u,c))===u?(y.ITa.sVa(s,"name",s.name()),s.name(u)):y.setText(r,i+c,p)):(d.KNb=n,y.setText(r,i+c,s.name()),delete d.KNb))},t.prototype.JNb=function(t){var e,n,o=this.Nz;for(e=t;e<o.length;e++)n=te(this.name(),o[e].name()),this.mNb.push(n)},t.prototype.SZ=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p=this,d=p.Nz,g=p.kj;if(p.NZ&&d&&g)for(p.useFooterDropDownList()&&!p.uNb()&&p.sNb(),o=d.length,r=p.footerIndex(),i=p.dj,v(t)&&(t=0),v(e)&&(e=o),v(n)&&(n=p.nhc),s=ut(o,t+e),c=t;c<s;c++)(a=d[c])&&(u=g.getValue(r,i+c),v(u)||n?(p.KNb=n,S(g,r,i+c,a.footerValue()),delete p.KNb):(u!==(f=a.footerValue())&&g.ITa.sVa(a,"footerValue",f),a.footerValue(u)),(l=g.Ima&&g.Ima(r,i+c))&&!n?(l!==(h=a.dataAreaFormula())&&g.ITa.sVa(a,"dataAreaFormula",h),a.footerFormula(l)):p.S3||(p.KNb=n,x(g,r,i+c,st,a.footerFormula()),delete p.KNb))},t.prototype.m$=function(t,e){var n,o,r,i,a,s,l=this,u=l.Nz;if(l.MZ&&u)for(n=u.length,v(t)&&(t=0),v(e)&&(e=n),r=ut(n,t+e),i=t;i<r;i++)(o=u[i])&&(a=o.name(),(s=l.kj)&&a!==st&&s.ITa.sVa(o,"name",a),o.name(st),l.WZ(a,o.name(),i))},t.prototype.n$=function(t){var e,n,o,r,i,a,s,l,u=this,c=u.dataRange();if(c.containsRange(t)){for(e=t.row,n=t.col,o=N(t),r=E(t),i=[],a=0;a<o;a++)for(s=0;s<r;s++)u.yq(e+a,n+s,st),i.push({columnName:u.getColumnName(n+s-c.col),row:e+a-c.row,data:""});(l=u.ZX)&&l.onDataChanged(i)}},t.prototype.o$=function(t,e){var n,o,r,i,a,s,l=this,u=l.Nz;if(l.NZ&&u)for(v(t)&&(t=0),v(e)&&(e=u.length),o=ut(u.length,t+e),r=t;r<o;r++)(n=u[r])&&(i=l.kj,a=n.footerFormula(),i&&st!==a&&i.ITa.sVa(n,"footerFormula",a),n.footerFormula(st),s=n.footerValue(),i&&st!==s&&i.ITa.sVa(n,"footerValue",s),n.footerValue(st))},t.prototype.e$=function(){var t,e,n,o,r,i,a,s=this,l=s.Nz;if(s.NZ&&l&&(t=s.kj))for(e=l.length,o=s.dj,i=s.footerIndex(),a=0;a<e;a++)(n=l[a])&&(S(t,i,r=o+a,n.footerValue()),x(t,i,r,st,n.footerFormula()))},t.prototype.QZ=function(t){var e,n,o,r,i=this,a=i.kj;if(a&&!(t<0||a.getRowCount()<=t))for(e=i.dj,n=i.OZ,r=0;r<n;r++)x(a,t,o=e+r,st),S(a,t,o,st)},t.prototype.rI=function(t,e,n,o,r){var i,a,s,l=this,u=!1,c=n?1:0;return t>=l.cj+l.Xj+c||((i=l.kj)&&i.ITa.pVa(l,Gt,{row:l.cj,col:l.dj,rowCount:l.Xj,colCount:l.OZ}),l.ohc(t,e,!1),a=l.cj,s=l.cj+l.Xj-1+c,t<=a&&!r?l.cj+=e:t<=s&&(o||(u=l.c$(t,e)),l.Xj+=e)),u},t.prototype.KZ=function(t,e,n){var o,r,i,a=this,s=a.cj+a.Xj-1;!n&&t>=a.cj&&t<=s&&a.LNb(t,e),n||(a.Gj(t,e,!0,!0,!0),a.MNb()),o=a.ZX,r=a.dataRange().row,i=a.endRow(),t>=r&&t<=i&&o&&o.onRowsAdded(t-r,e),a.xr&&a.xr.rI(t,e)},t.prototype.c$=function(t,e){var n,o,r,i=this.wq;return!!i&&(r=void 0,(o=(n=this.kj)&&n.ITa.zTa)&&((r=o.uVa)||(r=[])),i.uL(W(this,t),e,r),!0)},t.prototype.LNb=function(t,e){if(a){var n=this,o=n.kj,r=n.dataRange();v(t)&&(t=r.row),v(e)&&(e=r.rowCount),k(o),m(n.Nz,(function(r,i){var a,s,l=i.dataAreaFormula();if(l)for(a=r+n.dj,s=t;s<t+e;s++)x(o,s,a,st,l)})),M(o,!1)}},t.prototype.MNb=function(){if(a){var t,e,n=this,o=n.kj,r=o.Bj(),i=n.dataRange();v(t)&&(t=i.row),v(e)&&(e=i.rowCount),k(o),m(n.Nz,(function(o,i){var a,s,l,u,c=i.NNb();if(c&&c.isArrayFormula)for(a=c.isDynamicArray,s=o+n.dj,l=t;l<t+e;l++)v(r.Qf(l,s))&&(u={row:l,col:s,rowCount:1,colCount:1,isDynamicArray:a},r.Xf(l,s,u))})),M(o,!1)}},t.prototype.tI=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g=this,m=n?1:0;if(!(t>=g.dj+g.OZ+m)){if(i=g.dj,(a=g.kj)&&(a.ITa.pVa(g,Gt,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),a.ITa.pVa(g,Ht,g.Nz.slice())),t<=g.dj&&!r)g.dj+=e;else if(t<g.dj+g.OZ+m&&(g.OZ+=e,s=g.Nz)){for(l=t-g.dj,u=0;u<e;u++)c=g.TZ(),f=l+u,(h=new Qt(c)).name(g.dga(st,f)),s.splice(f,0,h),p=g.getColumnName(f),g.xNb(f,0,p);o&&g.PZ(l,lt,!0)}g.xr&&g.xr.tI(t,e),t>=i&&((d=g.ZX)&&d.onColumnsAdded(t-i,e))}},t.prototype.khc=function(){var t,e,n,o,r=this,i=r.kj.Bj();i&&r.NZ&&(t=r.Nz,e=r.footerIndex(),n=r.dj,t.forEach((function(t,r){o=i.Kf(e,n+r),v(o)||t.footerFormula(o)})))},t.prototype.GR=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g=this,m=!1;return t>=g.cj+g.Xj||(i=(r=g.dataRange()).row,a=N(r),s=g.cj,l=g.cj+g.Xj-1,u=g.kj,c=g.wq,u&&((h=u.ITa).pVa(g,Gt,{row:g.cj,col:g.dj,rowCount:g.Xj,colCount:g.OZ}),(f=h.zTa)&&((p=f.uVa)||(p=[]))),g.ohc(t,e,!0),t<s?t+e<=s&&(g.cj-=e):t===s?g.MZ||(g.Xj-=ut(l-t+1,e),!n&&c&&(h&&h.ENb(g,t,e,o,Yt.deleted),c.wL(W(g,t),ut(l-t+1,e),p),m=!0)):t<=l&&(g.Xj-=ut(l-t+1,e),!n&&c&&(h&&h.ENb(g,t,e,o,Yt.deleted),c.wL(W(g,t),ut(l-t+1,e),p),m=!0),t===l&&g.NZ&&(u&&u.ITa.pVa(g,"showFooter",g.NZ),g.NZ=!1)),g.xr&&g.xr.GR(t,e),t>=i&&t<i+a&&((d=g.ZX)&&d.onRowsRemoved(t-i,e))),m},t.prototype.HR=function(t,e){var n,o,r,i,a,s=this,l=s.Nz;t>=s.dj+s.OZ||((n=s.kj)&&(n.ITa.pVa(s,Gt,{row:s.cj,col:s.dj,rowCount:s.Xj,colCount:s.OZ}),n.ITa.pVa(s,Ht,s.Nz.slice())),o=s.dj,r=s.dj,i=s.dj+s.OZ-1,t<r?t+e<=r?s.dj-=e:(s.dj=t,s.OZ-=t+e-r,l&&(l.splice(0,t+e-r),s.xNb(0,t+e-r))):(s.OZ-=ut(i-t+1,e),l&&(l.splice(t-r,ut(i-t+1,e)),s.xNb(t-r,ut(i-t+1,e)))),s.xr&&s.xr.HR(t,e),t>=o&&((a=s.ZX)&&a.onColumnsRemoved(t-o,e)))},t.prototype.$b=function(t,e,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y=this,v=n,C=r,b=y.kj;b&&(v=b.getRowCount(),C=b.getColumnCount()),i=t<0?0:t,a=e<0?0:e,s=t<0?v:n,l=e<0?C:r,u=o.kf(i,a,s,l),c=y.headerIndex(),y.MZ&&i<=c&&c<i+s&&(f=o.kf(c,y.dj,1,y.OZ),(h=u.getIntersect(f,v,C))&&y.m$(h.col-y.dj,E(h))),p=y.dataRange(),(d=u.getIntersect(p,v,C))&&y.n$(d),g=y.footerIndex(),y.NZ&&i<=g&&g<i+s&&(m=o.kf(g,y.dj,1,y.OZ),(h=u.getIntersect(m,v,C))&&y.o$(h.col-y.dj,E(h))),y.xr&&y.xr.$b(t,e,n,r)},t.prototype.toJSON=function(){var t,e,n,o,r,i,a,s=this,l=s.style(),u=s.xr,c="columns",f={name:[s.name(),st],row:[s.cj,-1],col:[s.dj,-1],rowCount:[s.Xj,-1],colCount:[s.OZ,-1],showHeader:[s.MZ,!0],showFooter:[s.NZ,!1],useFooterDropDownList:[s.kNb,!1],showResizeHandle:[s.lNb,!1],highlightFirstColumn:[s.highlightFirstColumn(),!1],highlightLastColumn:[s.highlightLastColumn(),!1],bandRows:[s.bandRows(),!0],expandBoundRows:[s.expandBoundRows(),!1],bandColumns:[s.bandColumns(),!1],style:[l?l.toJSON():st,st],autoGenerateColumns:[s.autoGenerateColumns(),!0],bindingPath:[s.bindingPath(),lt],rowFilter:[u?u.toJSON():st,st],reservedElement:[s.ONb,st],allowAutoExpand:[s.qNb,!0],columns:[[]]};for(t=0;t<s.Nz.length;t++)n=(e=s.Nz[t].toJSON())[At],o=e[It],n&&(e[At]=F(s.kj,n,s.footerIndex(),t+s.dj)),o&&(e[It]=F(s.kj,o,s.dataRange().row,t+s.dj)),f[c][0][t]=e;for(i in f[c][1]=st,r={},f)(a=f[i])[0]!==a[1]&&(r[i]=a[0]);return y(r)?lt:r},t.prototype.fromJSON=function(t,n){var o,r,i,a,s,u,f,h,d,g,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_;if(t){if(o=this,m([dt,yt,vt,Ct,bt,wt],(function(e,n){p(t[n])&&o[n](t[n],!1)})),r=t.row,p(r)&&(o.cj=r),i=t.col,p(i)&&(o.dj=i),a=t.rowCount,p(a)&&(o.Xj=a),s=t.colCount,p(s)&&(o.OZ=s),u=t.showHeader,p(u)&&(o.MZ=u),f=t.showFooter,p(f)&&(o.NZ=f),h=t.expandBoundRows,p(h)&&(o.lhc=h),d=t.useFooterDropDownList,p(d)&&(o.kNb=d),g=t.showResizeHandle,p(g)&&(o.lNb=g),(y=t.style)&&((v=new c.TableTheme).fromJSON(y,n),o.style(v)),C=t.dataSource,b=t.dataBinding,w=t.bindingPath,n?(C&&l.qL&&(o.wq=new l.qL,o.wq.bind(C)),b&&l.qL&&(o.wq=new l.qL,o.wq.fromJSON(b))):w&&(o.UZ=w,x=(T=o.kj)&&T.getDataSource&&T.getDataSource(),l.CellBindingSource&&x instanceof l.CellBindingSource&&((S=l.LL(x.getSource(),w))&&(o.wq=new l.qL,o.wq.bind(S)))),A=t.columns){for(R=(I=A).length,k=o.Nz=[],M=void 0,N=void 0,E=0;E<R;E++)N=I[E],(M=new Qt(o.TZ())).fromJSON(N),D=M.name(),O=o.dga(D,E),k.push(M),O!==D&&o.setColumnName(E,O);o.Qdc()}o.kNb&&o.sNb(!0),(j=t.rowFilter)&&((F=e.MAb&&new e.MAb)&&(F.table(o),F.fromJSON(j,n),o.xr=F,o.xr.reFilter())),(P=t.reservedElement)&&(o.ONb=P),_=t.allowAutoExpand,p(_)&&(o.qNb=_)}},t.prototype.formulaFromJSON=function(){var t,e,n,o,r,i,a=this,s=a.kj,l=s.Bj(),u=a.Nz,c=a.footerIndex(),f=a.dataRange().row,h=a.dj;for(n=0;n<u.length;n++)e=n+h,(o=(t=u[n]).footerFormula())&&"string"==typeof o&&t.footerFormula(j(s,o,c,e)),(r=t.dataAreaFormula())&&l&&(i=l.Qf(f,e),v(i)||t.NNb({isArrayFormula:!0,isDynamicArray:i.isDynamicArray})),r&&"string"==typeof r&&t.dataAreaFormula(j(s,r,f,e))},t.prototype.Qdc=function(){var t,e,n=this.Nz,o=n.length;for(e=0;e<o;e++)(t=n[e]).id()<1&&t.id(this.TZ())},t.prototype.startRow=function(){return this.cj},t.prototype.startColumn=function(){return this.dj},t.prototype.endRow=function(){return this.cj+this.Xj-1},t.prototype.endColumn=function(){return this.dj+this.OZ-1},t.prototype.hasHeadersRow=function(){return this.MZ},t.prototype.hasTotalsRow=function(){return this.NZ},t.prototype.tableName=function(){return this.name()},t.prototype.getColumnIndexInTable=function(t){t=t.toLowerCase();var e=-1,n=i.Common.u.Gb(t,"\r\n","\n");return v(t)||m(this.Nz,(function(o,r){var i=(""+r.name()).toLowerCase();if(i===t||i===n)return e=o,!1})),e},t.prototype.source=function(){var t=this.kj;return t&&t.yj&&t.yj()},t.prototype.JZ=function(){var t,e,n,o=this,r=o.kj;r&&((t=o.bindingPath())&&(e=r.getDataSource&&r.getDataSource(),l.CellBindingSource&&e instanceof l.CellBindingSource&&(n=l.LL(e.getSource(),t),o.zNb(n))))},t.prototype.zNb=function(t){var e,n,o,r,i,s,u,c=this,f=c.kj;if(t){n=(e=c.dataRange()).row,o=N(e),(r=new l.qL).bind(t,f.ITa.zTa),i=r.getRowCount();try{A(f),i>o?c.lhc?f.addRows(n+o,i-o):((s=f.wq)&&s.aLb&&(s.bLb=!0),c.PNb=!0,0===o?c.Nia(n,i):c.Nia(n+o-1,i-o,!0),delete c.PNb):i<o&&(c.lhc?f.deleteRows(n+i,o-i):(c.PNb=!0,c.STa(n+i,o-i),delete c.PNb)),c.wq=st,c.Fu(r),(u=a&&f.Cf())&&!u.IsSuspended()&&f.recalcAll()}finally{I(f)}}},t.prototype.clone=function(){var e=new t,n=ht(this.toJSON());return e.Yv(this.tc),e.fromJSON(pt(n)),e},t.prototype.p$=function(t){var e=new l.qL;e.bind(t),this.wq=e},t.prototype.Az=function(t){if(t&&!t.bindingPath()){var e=t.wq;e&&this.p$(e.getSource())}},t.prototype.LZ=function(){var t=this.wq;return t?t.getSource():st},t.prototype.q$=function(){var t=this.wq;return t?t.getRowCount():0},t.prototype.Eec=function(t,e){var n,o=this.Bec;e?o.push(t):-1!==(n=o.indexOf(t))&&o.splice(n,1)},t.prototype.Cec=function(t){var e=this;e.Bec.forEach((function(n){n.Jec(e,t)})),2===t&&(e.Bec=[])},t.prototype.wzb=function(t,e,n){var o,r;this.OAb||((r=(o=this.LAb)[n])||(r=o[n]={}),r[[t,e].join(",")]=!0)},t.prototype.NAb=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p=this,d=p.kj,g=d&&d.getCalcService&&d.getCalcService();if(p.OAb=!0,g)for(r in r=void 0,o=p.LAb)if(i=g.jh[r])for(l in a=i.dUa(),s=o[r])c=+(u=l.split(","))[0],f=+u[1],(h=i.Kf(c,f))?(p.QNb(c,f)||p.RNb(h,t,e,n,!1,c,f),i.fg(c,f,h,void 0,!1,a)):delete s[l];else delete o[r];delete p.OAb},t.prototype.SNb=function(t,e,n){var o,r,i,a,s,l,u,c,f,h=this,p=h.kj,d=p&&p.getCalcService();if(h.OAb=!0,d)for(r in r=void 0,o=h.LAb)for(a in i=d.jh[r],o[r])l=+(s=a.split(","))[0],u=+s[1],(c=i.Kf(l,u))&&t===l&&e===u&&((f=tt(c))>-1&&(c.arguments[f]=n));delete h.OAb},t.prototype.QNb=function(t,e){var n,o,r=this,i=r.footerIndex(),a=!1;return i>-1&&t===i&&(o=(n=r.dj)+r.OZ,a=e>=n&&e<o),a},t.prototype.sort=function(t,e){var n=this,o=n.kj,r=n.dataRange(),i=n.rowFilter();o&&0<=t&&t<r.colCount&&(o.suspendPaint(),o.sortRange(r.row,r.col,r.rowCount,r.colCount,!0,[{index:t+r.col,ascending:e}]),i&&(i.zZ={index:t+r.col,ascending:e}),o.resumePaint())},t.prototype.hJb=function(){return!!this.wq},t.prototype.eMb=function(t,e,n,o,r){var i,a,s,l,u,c,f=this,h=f.kj,p=f.cj,d=f.dj,g=f.Xj,m=f.OZ,y=p+g-1,v=n?t+1:t,C=v+e,b=f.dataRange();X(h);try{f.eJb(!1),f.TNb(),f.rI(v,e,n,!1,!0),f.NAb(),o&&!f.UNb&&(a=(i=y+1)+e,s=r-i+1,h.moveTo(i,d,a,d,s,m,1023)),l=y-v+1,(!n||t!==y)&&l>0&&(h.dJb=!0,h.zFc=b,h.moveTo(v,d,C,d,l,m,1023),delete h.zFc,delete h.dJb),u=h.ITa,c=f.dataRange(),u._Ua&&u._Ua(v,e,[c]),u.CVa&&u.CVa(v,e,[c]),f.VNb(),f.KZ(v,e,!0),f.LNb(),f.HNb(v,e,!0),f.MNb(),f.tc.Nm()}finally{f.eJb(!0),Z(h),f.Cec(0),h.recalcAll(!0)}},t.prototype.eJb=function(t){this.kj.eJb(t)},t.prototype.insertRows=function(t,e,n){if(!(v(t)||v(e)||e<=0)){t=et(this,t,!0),this.Nia(t,e,n)}},t.prototype.Nia=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p;v(t)||v(e)||e<=0||(r=(o=this).kj,a=(i=o.dataRange()).row,0===(s=i.rowCount)&&t===a||!(t<a||t>=a+s)||T(Ut().Exp_RowParamOutOfRange),l=o.cj,u=o.dj,c=l+o.Xj-1,f=u+o.OZ-1,p=(h=B(r,o))>c,H(r,o,c+1,h,u,f,e)||o.eMb(t,e,n,p,h))},t.prototype.deleteRows=function(t,e){if(!(v(t)||v(e)||e<=0)){t=et(this,t,!0),this.STa(t,e)}},t.prototype.STa=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,b,w;if(!(v(t)||v(e)||e<=0||(n=this,o=n.kj,r=n.dataRange(),i=r.row,a=r.rowCount,(t<i||t>=i+a)&&T(Ut().Exp_RowParamOutOfRange),s=n.cj,l=n.dj,u=n.Xj,c=n.OZ,f=s+u-1,h=l+c-1,(u<=1||t===i&&!n.MZ&&!n.NZ&&e>=a)&&T(Ut().Exp_TableDeleteCountInvalid),p=B(o,n),d=p>f,H(o,n,f+1,p,l,h,e,!0)))){X(o);try{n.eJb(!1),g=n.hJb(),m=void 0,g&&(m=q(!0),n.WNb(t,e,m)),n.TNb(),n.GR(t,e,lt,m),n.NAb(),y=ut(e,f-t+1),o.clear(t,l,y,c,3,127),t+e<=f&&!g&&o.moveTo(t+e,l,t,l,f-e-t+1,c,1023),d&&(b=(C=f+1)-y,w=p-C+1,o.moveTo(C,l,b,l,w,c,1023)),n.VNb(),n.LNb(),n.HNb(t,e,!1),n.tc.Nm()}finally{n.eJb(!0),Z(o),n.Cec(0),o.recalcAll(!0)}}},t.prototype.insertColumns=function(t,e,n){if(!(v(t)||v(e)||e<=0)){t=et(this,t,!1),this.hMb(t,e,n)}},t.prototype.hMb=function(t,e,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,C,b,w,x,S,A,I,R,k,M;if(!(v(t)||v(e)||e<=0||(o=this,i=o.kj,a=o.dataRange(),s=a.row,l=a.col,u=a.rowCount,c=a.colCount,(t<l||t>=l+c)&&T(Ut().Exp_ColParamOutOfRange),f=o.cj,h=o.dj,p=o.Xj,d=o.OZ,g=f+p-1,m=h+d-1,y=G(i,o),C=y>m,H(i,o,f,g,m+1,y,e,!1,!0)))){w=(b=n?t+1:t)+e,X(i);try{o.eJb(!1),o.TNb(),x=!o.hJb(),A=(S=m+1)+e,I=y-S+1,C&&i.moveTo(f,S,f,A,p,I,1023),o.tI(b,e,n,x,!0),o.XNb(b,e,!0),o.NAb(b,e,!0),n&&t===m||!x||(i.dJb=!0,R=o.NZ?1:0,i.moveTo(s,b,s,w,u+R,m-b+1,1023),delete i.dJb),k=i.ITa,M=o.dataRange(),k.bVa&&k.bVa(b,e,[M]),k.EVa&&k.EVa(b,e,[M]),o.VNb(),o.LNb(),o.INb(b,e,!0),r.kDc(i,b,e,!0,!1),o.tc.Nm()}finally{o.eJb(!0),Z(i),o.Cec(0),i.recalcAll(!0)}}},t.prototype.deleteColumns=function(t,e){if(!(v(t)||v(e)||e<=0)){t=et(this,t,!1),this.TTa(t,e)}},t.prototype.TTa=function(t,e){var n,o,i,a,s,l,u,c,f,h,p,d,g,m,y,C,b,w;if(!(v(t)||v(e)||e<=0||(n=this,o=n.kj,i=n.dataRange(),a=i.col,s=i.colCount,(t<a||t>=a+s)&&T(Ut().Exp_ColParamOutOfRange),l=n.cj,u=n.dj,c=n.Xj,f=n.OZ,h=l+c-1,p=u+f-1,d=n.NZ?1:0,(f<=1||t===u&&e>=f)&&T(Ut().Exp_TableDeleteCountInvalid),g=G(o,n),m=g>p,H(o,n,l,h,p+1,g,e,!0,!0)))){X(o);try{n.eJb(!1),n.TNb(),n.HR(t,e),n.XNb(t,e,!1),n.NAb(t,e,!1),y=ut(e,p-t+1),o.clear(l,t,c,y,3,127),t+e<=p&&o.moveTo(l,t+e,l,t,c-d,p-e-t+1,1023),m&&(b=(C=p+1)-y,w=g-C+1,o.moveTo(l,C,l,b,c,w,1023)),n.VNb(!0),n.LNb(),n.INb(t,e,!1),r.kDc(o,t,e,!1,!1),n.tc.Nm()}finally{n.eJb(!0),Z(o),n.Cec(0),o.recalcAll(!0)}}},t.prototype.TNb=function(){var t=this,e=t.kj,n=t.tc.l$;e&&e.ITa.tVa([t]),n.splice(n.indexOf(t),1),t.ZZ()},t.prototype.VNb=function(t){var e=this;e.PNb=!0,e.nhc=t,e.tc.Cz(e),delete e.nhc,delete e.PNb},t.prototype.XNb=function(t,e,n){var o,r,i,a=this,s=a.Nz,l=s.length,u=U(a,t);for(r=u;r<l;r++)i=void 0,n?r>u+e-1&&(i=r-e):r>=u&&(i=r+e),(o=s[r].footerFormula())&&a.RNb(o,t,e,n,!0,i)},t.prototype.RNb=function(t,e,n,o,i,a,s){var l,u,c,f,h,p,d,g=this.kj;if(n>0&&t&&t.arguments)for(l=t.arguments,u=void 0,c=void 0,f=0;f<l.length;f++)(u=l[f])instanceof r.xzb&&(g&&(i?(h=a,g.ITa.YNb(this,u,h)):(p=a,d=s,g.ITa.ZNb(this,u,p,d))),u.JUa(),c=u.offsetWhenInsertRemoveColumn(e,n,o,i),l[f]=c)},t.prototype.ru=function(t){var e,n,o,r,i,a,s,l=this,u=l.wq,c=l.kj,f=l.MZ?1:0,h=l.cj+f+t,p=l.dj;if(!u||0===u.getRowCount())return st;if(e=l.OZ,n={},o=u.ru(t))for(r in o)w(o,r)&&"function"!=typeof r&&(n[r]=o[r]);for(i=0;i<e;i++)s=(a=l.Nz[i])&&a.dataField(),a&&s&&s.length>0&&v(n[s])&&(n[s]=c.getValue(h,p+i));return n},t.prototype.WNb=function(t,e,n){var o,r,i,a,s=this,l=[],u=s.wq;if(u)for(r=u.getRowCount(),i=0;i<e;i++)a=st,(o=W(s,t+i))<r&&(a=s.ru(o)),l.push({key:n,data:a});s.Ts=l},t.prototype.nKb=function(){var t=[],e=this.Ts;return e&&m(e,(function(e,n){n&&!o.GC$.isFunction(n)&&t.push(n.data)})),t},t.prototype.DNb=function(t,e,n){var o,r,i,a,s=this;s.kj.gga>0||(o=s.nNb,(r=s.wq)&&(i=st,e<r.getRowCount()&&(i=s.ru(e)),a={key:n,data:i},o[t]=a))},t.prototype.ohc=function(t,e,n){var o,r,i,a=this;if(!(a.kj.gga>0))if(o=a.nNb,n)r=o.splice(t,e),a.mhc.push({rowIndex:t,count:e,deletedDirtyItems:r});else for(i=0;i<e;i++)o.splice(t,0,st)},t.prototype.ihc=function(t,e){this.nNb.splice(t,e)},t.prototype.phc=function(){var t,e,n=this.mhc.pop(),o=n.rowIndex,r=n.count,i=n.deletedDirtyItems;for(t=0;t<r;t++)e=i[t],this.nNb[o+t]=Kt({},e)},t.prototype.getDirtyRows=function(){var t,e,n,o=this,r=o.nNb,i=[];for(n=0;n<r.length;n++)t=r[n],v(t)||(e=W(o,n),i.push({row:e,originalItem:t.data,item:o.ru(e)}));return i},t.prototype.clearPendingChanges=function(){this.nNb=[]},t.prototype.footerRowDropDowns=function(t,e){var n,o,r,i,a=this,s=a.mNb[t];if(s){if(1===arguments.length)return s.dropDowns&&s.dropDowns.slice();if(n=s.dropDowns[0],e)return o=e.listOption,r=e.submitCommand,i=e.type,o&&(n.option=o),r&&(n.submitCommand=r),p(i)&&(n.type=i),a}},t.prototype.checkTableLastRow=function(t){var e=this.dataRange();return this.headerIndex()===t||e.row+e.rowCount-1!==t},t.prototype.checkTableLastCol=function(t){var e=this.dataRange();return e.col+e.colCount-1!==t},t.prototype.PIb=function(t,e,n,o,r){var i,a,s,l=this,u=l.kj;Q(u,l,n?Dt:Et,t,e,o,r),i=u.ITa,a=n?Et:Dt,s=!n&&lt,i&&i.ZVa(["tableRowsChanged",l,a,t,e,s,n])},t.prototype.QIb=function(t,e,n,o){var r,i,a,s=this,l=s.kj;J(l,s,n?jt:Ot,t,e,o),r=l.ITa,i=n?Ot:jt,a=!n&&lt,r&&r.ZVa(["tableColumnsChanged",s,i,t,e,a])},t}(),e.Table=Xt,Xt.prototype.name=h(dt,"",ee(dt),D),Xt.prototype.bandRows=h(Ct,!0,ee(Ct)),Xt.prototype.bandColumns=h(bt,!1,ee(bt)),Xt.prototype.highlightFirstColumn=h(yt,!1,ee(yt)),Xt.prototype.highlightLastColumn=h(vt,!1,ee(vt)),Xt.prototype.style=h("style",lt,ee("style")),Xt.prototype.autoGenerateColumns=h(wt,!0,ee(wt)),s&&s.HideRowFilter&&(Zt=function(t){function e(e){var n=t.call(this)||this;return n.table(e),n}return $t(e,t),e.prototype.oZ=function(){return 0},e.prototype.pZ=function(){return this.range.colCount},e.prototype.table=function(t){var e=this;return 0===arguments.length?e.sj:(e.sj=t,void(t&&(e.kj=t.kj)))},e.prototype.rI=function(e,n){var o=this.sj;t.prototype.rI.call(this,e,n),o&&this.BZ(o.dataRange())},e.prototype.GR=function(e,n){var o=this.sj;t.prototype.GR.call(this,e,n),o&&this.BZ(o.dataRange())},e.prototype.no=function(){this.sj=st,this.kj=st},e}(s.HideRowFilter),e.MAb=Zt),Qt=function(){function t(t,e,n,o,r,i){var a=this;a.id(t),a.dataField(e),a.name(n||e||xt+a.id()),a.formatter(o),a.cellType(r),a.value(i)}return t.prototype.k$=function(){return this.id()>0},t.prototype.toJSON=function(){var t=this,e={};return m(Mt,(function(n,o){var r=t[o]();v(r)||(o===gt&&r.toJSON&&"function"==typeof r.toJSON?e[o]=r.toJSON():e[o]=r)})),y(e)?lt:e},t.prototype.fromJSON=function(t){if(t){var e=this;m(Mt,(function(n,r){var i,a,s,l,u=t[r]!==lt?t[r]:t["_"+r];v(u)||r===gt&&(i=u.typeName,(s=(a=o.CellTypes&&o.CellTypes._o)&&a[i]||a[u.type]||o.getTypeFromString(i))&&((l=new s).fromJSON(u,!1),u=l)),v(u)||e[r](u,!1)}))}},t}(),e.TableColumn=Qt,Qt.prototype.id=function(t){var e=h("id",lt,(function(t){this.name()||this.name(xt+t)}));return 0===arguments.length?e.call(this):v(t)?this:e.call(this,t)},Qt.prototype.name=h(dt,lt,(function(t){if(!t){this.name(xt+this.id())}})),Qt.prototype.formatter=h(mt),Qt.prototype.cellType=h(gt),Qt.prototype.value=h("value"),Qt.prototype.dataField=h(St),Qt.prototype.footerValue=h(Rt),Qt.prototype.dataAreaFormula=h(It),Qt.prototype.footerFormula=h(At),Qt.prototype.ANb=h("dataAreaFormulaStr"),Qt.prototype.NNb=h("isArrayFormula"),Jt=function(){function t(t){this.kj=t,this.l$=[],this.$m=[],this.an=[]}return t.prototype.no=function(){var t,e,n=this,o=n.l$,r=o.length;for(e=0;e<r;e++)(t=o[e])&&t.no();n.l$=[],n.Nm(),n.kj=st},t.prototype.Nm=function(){var t,e,n,o=this;for(o.$m=[],o.an=[],e=(t=o.l$).length,n=0;n<e;n++)t[n].Nm()},t.prototype.hNb=function(t){var e,n=this.l$,o=n.length;for(e=0;e<o;e++)n[e].oNb[t]=lt},t.prototype.iNb=function(t){var e,n=this.l$,o=n.length;for(e=0;e<o;e++)n[e].pNb[t]=lt},t.prototype.add=function(t,e,n,o,r,i,a){var s=this;return s.LA(s.kj,t,e,n,o,r,!0),s.Cz(new Xt(t,e,n,o,r,i||c.TableThemes.medium2,a))},t.prototype.addFromDataSource=function(t,e,n,o,r,i){var a,s,u,c,f;if(o||T(Ut().Exp_TableDataSourceNullError),l.qL)return this,(a=this.kj).suspendPaint(),(s=new l.qL).bind(o),u=s.getRowCount()+1,c=s.getColumnCount(),(f=this.add(t,e,n,u,c,r,i)).Fu(s),a.clearPendingChanges(),a.resumePaint(),f},t.prototype.find=function(t,e){var n,o,r,i=this.l$,a=i.length;for(o=0;o<a;o++)if((r=(n=i[o]).range()).row<=t&&t<r.row+N(r)&&r.col<=e&&e<r.col+E(r))return n;return st},t.prototype.findByName=function(t){var e,n,o=this.l$,r=o.length;for(n=0;n<r;n++)if((e=o[n]).name().toLowerCase()===t.toLowerCase())return e;return st},t.prototype.pJb=function(t,e,n,r){var i,a,s=this.l$,l=s.length,u=o.kf(t,n,e,r),c=[];for(a=0;a<l;a++)i=s[a],u.containsRange(i.range())&&c.push(i);return c},t.prototype.s$=function(t,e,n,o){var r,i,a=this.l$,s=a.length,l=[];for(i=0;i<s;i++)(r=a[i]).range().intersect(t,e,n,o)&&l.push(r);return l},t.prototype.KHb=function(){var t=this.kj,e=this.find(t.Jl,t.Kl);if(e)return t.cm(new o.Range(-1,e.dj,-1,e.OZ))},t.prototype.Cz=function(t,e){var n,o;if(t)return(n=this).findByName(t.name())&&T(Ut().Exp_TableHasSameNameError),(o=n.kj).suspendPaint(),t.Yv(n),o.ITa.tVa([]),n.l$.push(t),t.PNb||t.JZ(),t.showHeader()&&t.PZ(),!e&&t.showFooter()&&t.SZ(),n.t$(t),o.resumePaint(),t},t.prototype.vV=function(t){var e,n=this,o=g(t,n.l$);return o>-1?((e=n.kj)&&e.ITa.tVa([t]),n.l$.splice(o,1),n.u$([t],!1),t):st},t.prototype.remove=function(t,e){var n,r,i,a,s,l,u,c,f,h,p,d,g,m,y,C,b=this;if(Y(t)&&(t=b.findByName(t)),t&&(e=e||0,t.RZ(),t=b.vV(t))){n=t.range(),r=b.kj;try{if(A(r),i=n.row,a=n.row+N(n),s=n.col,l=n.col+E(n),u=void 0,c=void 0,f=t.showHeader(),h=t.headerIndex(),1!=(1&e))for(u=i;u<a;u++)for(c=s;c<l;c++)x(r,u,c,st),S(r,u,c,st);else if(t.hJb()){if(f)for(u=h,c=s;c<l;c++)r.setValue(u,c,t.getColumnName(c-n.col));for(g=(d=(p=t.dataRange()).row)+N(p),void 0,m=void 0,y=void 0,u=d;u<g;u++)for(c=s;c<l;c++)(m=t.Nz[U(t,c)])&&(y=t.ru(W(t,u))[m.dataField()],v(y)||r.setValue(u,c,y))}else if(f)for(u=h,c=s;c<l;c++)r.setValue(u,c,t.getColumnName(c-n.col));if(2==(2&e))for(u=i;u<a;u++)for(c=s;c<l;c++)C=r.getStyle(u,c)||new o.Style,t.Yo(u,c,C),r.setStyle(u,c,C)}finally{I(r)}t.Cec(2)}return t},t.prototype.move=function(t,e,n){var o,r,i,a=this,s=a.kj;if(Y(t)&&(t=a.findByName(t)),t&&e>=0&&n>=0&&(o=t.range(),0===(i=(r=a.s$(e,n,N(o),E(o))).length)||1===i&&r[0]===t)){A(s);try{t.YZ(e,n)}finally{I(s)}}},t.prototype.resize=function(t,e){var n,r,i,a,s,l,u,c,f,h=this,p=h.kj;if(Y(t)&&(t=h.findByName(t)),t&&(n=t.range(),r=t.dataRange(),a=e,3===(i=arguments).length&&(a=o.kf(n.row,n.col,i[1],i[2])),a&&(s=N(a),l=E(a),s>=0&&l>=0&&h.s$(a.row,a.col,s,l).length<=1))){X(p);try{t.b$(a),!t.hJb()&&n.rowCount<a.rowCount&&(u=p.ITa,c=n.row+n.rowCount,f=a.rowCount-n.rowCount,t.showFooter()&&c--,u._Ua&&u._Ua(c,f,[r]),u.CVa&&u.CVa(c,f,[r]))}finally{Z(p)}}},t.prototype.all=function(){var t=[];return m(this.l$,(function(e,n){t.push(n)})),t},t.prototype.Xec=function(t){var e,n=t||this.l$,o=n.length;for(e=0;e<o;e++)n[e].clearPendingChanges()},t.prototype.Nec=function(t,e,n,o){var r,i,a=[],s=this.l$,l=s.length;for(r=0;r<l;r++)(i=s[r]).cj>=t&&i.dj>=e&&i.cj+i.Xj<=t+n&&i.dj+i.OZ<=e+o&&a.push(i);return a},t.prototype.Oec=function(t,e,n,o){var r=this.s$(t,e,n,o),i=this.Nec(t,e,n,o),a=[];return i.length>0?r.forEach((function(t){-1===i.indexOf(t)&&a.push(t)})):a=r,a},t.prototype.Pec=function(t,e,n){var o,r,i=t.length;for(o=0;o<i;o++)if((r=t[o].range()).row<=e&&e<r.row+N(r)&&(n<0||r.col<=n&&n<r.col+E(r)))return!0;return!1},t.prototype.LA=function(t,e,n,o,r,i,s){var l,u,c,f;return e?O(e)?n<0||r<1||n+r>t.getRowCount()?(s&&T(Ut().Exp_TableInvalidRow),!1):o<0||i<1||o+i>t.getColumnCount()?(s&&T(Ut().Exp_TableInvalidColumn),!1):(l=t.tables).rn(n,o,r,i)?(s&&T(Ut().Exp_TableIntersectError),!1):l.findByName(e)?(s&&T(Ut().Exp_TableHasSameNameError),!1):(c=(u=a&&t.Ms(n,o,r,i))&&u.ranges,f=!0,c&&m(u,(function(t,e){if(N(e)>1||E(e)>1)return s&&T(Ut().Exp_ArrayFormulaTable),f=!1,!1})),f):(s&&T(Ut().Exp_TableNameInvalid),!1):(s&&T(Ut().Exp_TableEmptyNameError),!1)},t.prototype.$Hb=function(t,e,n,o){var r,i,a=[],s=this.l$;for(r=0;r<s.length;r++)(i=s[r]).cj>=t&&i.dj>=e&&i.cj+i.Xj<=t+n&&i.dj+i.OZ<=e+o&&a.push(i.name());return a},t.prototype.HZ=function(t,e,n,r){var i,a,s,l,u=this.all();if(u)for(i=o.kf(t,e,n,r),a=u.length,s=void 0,l=0;l<a;l++)if(s=u[l].range(),i.intersect(s.row,s.col,N(s),E(s))&&!i.containsRange(s))return!0;return!1},t.prototype.rn=function(t,e,n,o){var r,i=this.l$,a=i.length;for(r=0;r<a;r++)if(i[r].range().intersect(t,e,n,o))return!0;return!1},t.prototype._getTable=function(t,e,n,o,r){var i,a,s,l=t.tables.all(),u=l.length,c=[];for(a=0;a<u;a++)(s=(i=l[a]).range()).row>=e&&s.col>=n&&s.row+s.rowCount<=e+o&&s.colCount+s.col<=n+r&&c.push({table:i,index:a});return c},t.prototype.zxb=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p=n.tables.all(),d=p.length;if(!v(e)&&(a=o.row-e.row,s=o.col-e.col,0!==(l=this._getTable(t,e.row,e.col,e.rowCount,e.colCount)).length))for(u=0;u<d;u++)for(i=p[u],c=0;c<l.length;c++)if(f=l[c],(!r||u!==f.index)&&(h=f.table.range(),i.range().intersect(h.row+a,h.col+s,h.rowCount,h.colCount)))return n.Os(6,Ut().Exp_TableIntersectError),!0;return!1},t.prototype.KZ=function(t,e){var n,o,r=this.l$;for(n=0,o=r.length;n<o;n++)r[n].KZ(t,e)},t.prototype.rI=function(t,e){var n,r,i,a,s,l,u,c,f,h,p=this.l$,d=[];for(n=0,r=p.length;n<r;n++)a=(i=p[n]).LZ(),b(d,a)?i.rI(t,e,!0):i.rI(t,e)&&d.push(a);s=this.kj;try{for(A(s),l=void 0,u=void 0,n=0,r=p.length;n<r;n++)l=(i=p[n]).q$(),u=i.dataRange(),l>0&&l!==N(u)&&(c=l,i.showHeader()&&(c+=1),i.showFooter()&&(c+=1),f=i.range(),h=o.kf(f.row,f.col,c,E(u)),i.b$(h))}finally{I(s)}},t.prototype.tI=function(t,e){var n,o=this.l$,r=o.length;for(n=0;n<r;n++)o[n].tI(t,e)},t.prototype.khc=function(t){var e,n,o,r,i=this.l$,a=i.length;for(r=0;r<a;r++)n=(e=i[r]).dj,o=e.endColumn(),n<=t&&o>=t&&e.khc()},t.prototype.GR=function(t,e){var n,r,i,a,s,l,u,c,f,h,p,d=this,g=d.l$,m=[],y=[],v=[];for(n=0,r=g.length;n<r;n++)a=(i=g[n]).LZ(),t<=(s=i.range()).row&&s.row+N(s)<=t+e?v.push(i):(b(m,a)?i.GR(t,e,!0):(i.hJb()&&i.WNb(t,e,q(!0)),i.GR(t,e)&&m.push(a)),y.push(i));d.kj.ITa.tVa(v),d.l$=y,d.u$(v,!0),l=d.kj;try{for(A(l),g=d.l$,u=void 0,c=void 0,n=0,r=g.length;n<r;n++)u=(i=g[n]).q$(),c=i.dataRange(),u>0&&u!==N(c)&&(f=u,i.showHeader()&&(f+=1),i.showFooter()&&(f+=1),h=i.range(),p=o.kf(h.row,h.col,f,E(c)),i.b$(p))}finally{I(l)}},t.prototype.HR=function(t,e){var n,o,r,i=this,a=i.l$,s=[],l=[],u=a.length;for(o=0;o<u;o++)t<=(r=(n=a[o]).range()).col&&r.col+E(r)<=t+e?l.push(n):(n.HR(t,e),s.push(n));i.kj.ITa.tVa(l),i.l$=s,i.u$(l,!0)},t.prototype.$b=function(t,e,n,r,i){var a,s,l,u,c,f=this,h=o.kf(t,e,n,r),p=[],d=f.kj;if(1==(1&i)){for(u=[],s=(a=f.l$).length,c=0;c<s;c++)l=a[c],h.containsRange(l.range())?p.push(l):u.push(l);for(s=u.length,c=0;c<s;c++)(l=u[c]).$b(t,e,n,r);d&&d.ITa.tVa(p),f.l$=u}if(2==(2&i))for(s=(a=f.l$).length,c=0;c<s;c++)l=a[c],h.containsRange(l.range())&&(d&&d.ITa.pVa(l,"style",l.style()),l.style(st));return f.u$(p,!0),p},t.prototype.u$=function(t,e){if(t&&0!==t.length){var n=this.kj;o.GC$.each(t,(function(t,e){e.Aq()&&e.getSlicerData().onTableRemoved(e),e.uNb()&&(n&&n.ITa.pVa(e,kt,e.wNb()),e.mNb=[])})),a&&function(t,e,n){var o=t.parent,i=R(t);function a(e,o){m(e,(function(e,a){var s=a.getExpression(),l=r.CalcOperatorAdjustor.adjustExpressionOnRemoveTable(s,o,-1,-1,n);l!==s&&(a.fg(l),i.invalidName(t.yj(),a.getName()))}))}o?(a(o.getCustomNames(),e),m(o.sheets,(function(t,n){a(n.getCustomNames(),e)}))):a(t.getCustomNames(),e),i.onAfterRemoveTable(e,n)}(this.kj,t,e)}},t.prototype.t$=function(t){t&&t.Aq()&&t.getSlicerData().onTableAdded(t)},t.prototype.v$=function(t){for(var e=1;this.findByName(t);)t=Nt+e,e++;return t},t.prototype.ge=function(t,e){var n=!1,o=st,r=this.find(t,e);return r&&(r.showHeader()&&t===r.headerIndex()?(o=r.g$(e),v(o)||(o=d(o)),n=!0):(n=(o=r.ge(t,e)).gt,o=o.Qb)),{gt:n,Qb:o}},t.prototype.yq=function(t,e,n){var o=!1,r=!0,i=this.find(t,e);return i&&!0!==i.KNb&&(i.showHeader()&&t===i.headerIndex()?i.VZ(n)?r=!1:(n=v(n)?n:d(n),i.h$(e,n)):i.showFooter()&&t===i.footerIndex()?i.j$(e,n):o=i.yq(t,e,n)),o||!r},t.prototype.Hma=function(t,e,n,o,r,i){var s=this.find(t,e);if(a&&s){if(n>1||o>1)return this.kj.Os(0,Ut().Exp_ArrayFormulaTable),!1;if(s.showHeader()&&t===s.headerIndex()&&r)return!1;!s.KNb&&s.showFooter()&&t===s.footerIndex()&&(v(r)||s.j$(e,st),s.i$(e-s.dj,r,i))}return!0},t.prototype.IZ=function(){var t,e,n,o=this.all();for(t=0,e=o.length;t<e;t++)(n=o[t]).bindingPath()&&(n.wq=st)},t.prototype.dB=function(t,e){var n,o,r,i=[],a=this;if(a&&(n=a.all()))for(r=n.length-1;r>=0;r--)o=n[r],t.containsRange(o.range())&&(e&&(this.kj&&this.kj.ITa.tVa([o]),a.l$.splice(r,1),o.ZZ(lt,lt,e)),i.push(o));return i},t.prototype.eB=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p=this,d=[];for(a=0,s=t.length;a<s;a++)l=t[a],u=void 0,c=void 0,i?c=l:(u=l.bindingPath()?lt:l.LZ(),(c=new Xt).Yv(p),c.fromJSON(pt(ht(l.toJSON()))),c.name(p.v$(c.name())),d.push(c)),f=c.range(),c.S3=!0,c.$Z(o+f.row-e,r+f.col-n),p.Cz(c,i),i?(h=c.ZX)&&(h.kj=p.kj,h.refresh()):u&&c.p$(u),c.S3=!1;for(a=0;a<d.length;a++)d[a].formulaFromJSON()},t.prototype.R3=function(t){for(var e=0,n=t.length;e<n;e++)t[e]._Z()},t.prototype.toJSON=function(){var t,e=this.l$,n=[];if(e)for(t=0;t<e.length;t++)n.push(e[t].toJSON());return 0===n.length?lt:n},t.prototype.fromJSON=function(t,e){var n,o,r,i;if(t)for(this.l$=[],this.Nm(),n=0,o=t.length;n<o;n++)r=t[n],(i=new Xt).Yv(this),this.l$.push(i),i.fromJSON(r,e)},t.prototype.containTableHeaderTotalRowForSheet=function(){var t,e,n,o,r,i,a,s,l,u,c,f,h=this.kj;if(h&&(t=h.getSelections(),n=void 0,o=void 0,r=void 0,(e=h.tables)&&t))for(i=e.l$,a=void 0,s=void 0,l=void 0,u=void 0,c=0;c<t.length;c++)for(r=(o=(n=t[c]).row)+n.rowCount-1,f=0;f<i.length;f++)if(s=(a=i[f]).range(),l=a.headerIndex(),u=a.footerIndex(),!n.containsRange(s)&&(l>=o&&l<=r||u>=o&&u<=r))return!0;return!1},t.prototype.containTableHeaderTotalRow=function(){var t,e,n,o,r,i,a,s,l=this.kj,u=!1;if(l&&(t=l.getSelections(),e=void 0,n=void 0,l.tables&&t)){if(t.length>1)return u;o=t[0],i=void 0,a=void 0,s=void 0,(r=rt(l,o))&&1===r.length&&(n=(e=o.row)+o.rowCount-1,a=(i=r[0]).headerIndex(),s=i.footerIndex(),(a>=e&&a<=n||s>=e&&s<=n)&&(u=!0))}return u},t.prototype.noRoomToInsertColumn=function(){var t,e,n,o,r,i,a,s,l=this.kj;return!!(l&&(t=l.getSelections(),e=l.tables,e&&t&&1===t.length&&(n=t[0],o=n.row,r=n.col,i=n.colCount,a=e.find(o,r),s=l.getColumnCount(3),a&&a.endColumn()+i>=s)))},t.prototype.noRoomToInsertRow=function(){var t,e,n,o,r,i,a,s,l=this.kj;return!!(l&&(t=l.getSelections(),e=l.tables,e&&t&&1===t.length&&(n=t[0],o=n.row,r=n.col,i=n.rowCount,a=e.find(o,r),s=l.getRowCount(3),a&&a.endRow()+i>=s)))},t.prototype.checkTableRow=function(){var t,e,n,o,r,i,a,s=this.kj;return!!(s&&(t=s.getSelections(),e=s.tables,e&&t&&1===t.length&&(n=t[0],o=n.row,r=n.col,i=e.find(o,r),a=i&&i.range(),i&&a&&!i.MZ&&!i.NZ&&1===a.rowCount)))},t.prototype.checkTableCol=function(){var t,e,n,o,r,i,a,s=this.kj;return!!(s&&(t=s.getSelections(),e=s.tables,e&&t&&1===t.length&&(n=t[0],o=n.row,r=n.col,i=e.find(o,r),a=i&&i.range(),a&&1===a.colCount)))},t.prototype.isAcrossTables=function(){var t,e,n,o=this.kj,r=!1;if(o&&(t=o.getSelections(),o.tables&&t)){if(t.length>1)return r;e=t[0],(n=rt(o,e))&&(r=n.length>1)}return r},t.prototype.isWholeTableCol=function(){var t,e,n,o,r,i,a,s,l=this.kj,u=!1;return l&&(t=l.getSelections(),l.tables&&t&&(t.length>1?u=!0:(e=t[0],1===(n=rt(l,e)).length&&(r=(o=n[0]).dj,i=o.OZ,a=e.col,s=e.colCount,u=r===a&&i===s)))),u},t.prototype.containTableHeader=function(){var t,e,n,o,r,i,a=this.kj,s=!1;if(a&&(t=a.getSelections(),e=void 0,n=void 0,a.tables&&t)){if(t.length>1)return s;o=t[0],(r=rt(a,o))&&1===r.length&&(i=r[0].headerIndex(),n=(e=o.row)+o.rowCount-1,e<=i&&n>=i&&(s=!0))}return s},t.prototype.mKb=function(){var t,e,n,o,r,i,a,s,l=this.kj,u=!1;if(l&&(t=l.getSelections(),(e=l.tables)&&t)){if(n=l.getActiveRowIndex(),o=l.getActiveColumnIndex(),t.length>1||!e.find(n,o))return u;for(r=e.l$,i=t[0],a=void 0,s=0;s<r.length;s++)a=r[s],i&&i.intersect(a.cj,a.dj,a.Xj,a.OZ)&&(u=!0)}return u},t.prototype.PMb=function(t){var e,n,o,r,i=-1,a=this.l$;if(a)for(e=a.length,n=void 0,void 0,void 0,o=void 0,r=0;r<e;r++)n=a[r].range(),t&&!n.intersect(t.row,t.col,t.rowCount,t.colCount)||i<(o=n.row+n.rowCount-1)&&(i=o);return i},t.prototype.QMb=function(t){var e,n,o,r,i=-1,a=this.l$;if(a)for(e=a.length,n=void 0,void 0,void 0,o=void 0,r=0;r<e;r++)n=a[r].range(),t&&!n.intersect(t.row,t.col,t.rowCount,t.colCount)||i<(o=n.col+n.colCount-1)&&(i=o);return i},t.prototype.fIb=function(t,e,n,o){var r,i,a,s,l,u,c=this;if(!c.kj.options.isProtected&&0!==(r=c.all()).length)for(s=0;s<r.length;s++)(i=r[s]).qNb&&(a=i.range(),l=e&&e.equals(a),u=e&&0!==c.kj.ITa.getSpans(e,3).length,e&&(l||u)||(i.UNb=o,c.$Nb(i,a,t,n),delete i.UNb))},t.prototype.$Nb=function(t,e,n,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T=this.kj,x=null,S=!1,A=e.row+e.rowCount-1,I=new o.Range(e.row,e.col,e.rowCount,e.colCount);if(t.showFooter()){if(i=new o.Range(e.row+e.rowCount-1,e.col,1,e.colCount),n.row===i.row&&n.col>=e.col&&n.col+n.colCount<=e.col+e.colCount)return;S=!0,I.rowCount--}if(a=n.row,s=n.col,l=n.row+n.rowCount-1,u=n.col+n.colCount-1,c=e.row+e.rowCount-1,f=e.col+e.colCount-1,h=lt,p=T.getRowCount(),d=I.contains(a-1,s)&&!I.contains(a,s),S||(d=d&&u<=f&&s>=e.col),g=I.contains(a,s-1)&&!I.contains(a,s)&&l<=A&&a>=e.row,I.contains(a,s)&&!I.contains(l,u)){if(m=ft(c,l)-e.row+1,y=ft(f,u)-e.col+1,u>f&&((v=V(T,new o.Range(e.row,f+1,e.rowCount,u-f)))&&u>v.col&&(y=e.colCount)),x=new o.Range(e.row,e.col,m,y),S&&(x.rowCount++,l++),l>c&&(h=V(T,new o.Range(c+1,e.col,x.row+x.rowCount-1,e.colCount))),h&&(C=l-h.row+1)>0){if(V(T,new o.Range(p-Math.abs(C),e.col,Math.abs(C),e.colCount)))return void T.Os(6,Ut().Exp_TableAddRowNoEnoughRoom);T.moveTo(h.row,e.col,x.row+x.rowCount,e.col,p-x.row-x.rowCount,e.colCount,1)}}else if(d&&!S){if(x=new o.Range(a,e.col,n.rowCount,e.colCount),(b=V(T,x,n))&&!n.containsRange(b))return}else if(g&&(x=new o.Range(e.row,s,e.rowCount,n.colCount),(b=V(T,x,n))&&!n.containsRange(b)))return;if(d&&!S&&K(r)&&(t.useFooterDropDownList(!0),function(t,e){t.wu().execute({cmd:"tableShowFooter",sheetName:t.name(),tableName:e.name()})}(T,t)),x){if(e.containsRange(x))return;w=e.union(x),this._Nb(t,e,w)}},t.prototype._Nb=function(t,e,n){var o=this.kj,r=o.getParent();r&&r.commandManager().execute({cmd:"tableResize",sheetName:o.name(),tableName:t.name(),resizeToRange:n})},t.prototype.gJb=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y=this,v=this.kj,C=n.col,b=n.row,w=qt.TABLE_SELECT,T=qt.TABLE_CORNER_SELECT,x=qt.TABLE_COL_SELECT,S=qt.TABLE_ROW_SELECT,A=v.getActiveRowIndex(),I=v.getActiveColumnIndex();if(-1===n.rowViewportIndex&&(o=v.getCellRect(b,C,n.rowViewportIndex,n.colViewportIndex),(r=y.find(A,I))instanceof Xt&&r.showHeader()&&A>=r.cj&&A<r.cj+r.Xj&&I>=r.dj&&I<r.dj+r.OZ&&r.cj<v.lq&&r.cj+r.Xj>v.lq&&n.col<r.dj+r.OZ&&n.col>=r.dj))if(t>o.x+5&&t<o.x+o.width-18&&e<o.height-5){for(i=v.getSelections(),a=0;a<i.length;a++)if(!((s=i[a]).col===n.col&&1===s.colCount&&s.row===r.cj&&s.rowCount===r.Xj||s.col===n.col&&1===s.colCount&&-1===s.row&&s.rowCount===v.getRowCount()))return z(r,x)}else if(t>o.x+18)return z(r,"default");if(l=v.getCellRect(b,C),y.find(b,C)instanceof Xt&&-1!==n.colViewportIndex&&-1!==n.rowViewportIndex){if(u=!1,r=y.find(b,C),c=y.find(A,I),f=!0,1===(i=v.getSelections()).length&&((h=i[0]).row<=b&&h.row+h.rowCount>b&&h.col<=C&&h.col+h.colCount>C&&(f=!1)),r===c&&(u=!0),C===r.dj&&b===r.cj){if(f&&u&&(t<=l.x+2||e<=l.y+2))return z(r,w);if(t>l.x+2&&t<l.x+18&&e>l.y+2&&e<l.y+6)return z(r,T);if(t>l.x+18&&e>l.y+2&&e<l.y+6)return z(r,x);if(t>l.x+2&&t<l.x+18&&e>l.y+6)return z(r,S)}if(C===r.dj+r.OZ-1&&b===r.cj){if(f&&u&&(t>=l.x+v.getColumnWidth(C)-2||e<=l.y+2))return z(r,w);if(t<l.x+v.getColumnWidth(C)-2&&e>l.y+2&&e<l.y+6)return z(r,x)}if(C===r.dj&&b===r.cj+r.Xj-1){if(f&&u&&(t<=l.x+2||e>=l.y+v.getRowHeight(b)-2))return z(r,w);if(t>l.x+2&&t<l.x+18&&e<l.y+v.getRowHeight(b)-2)return z(r,S)}if(f&&u&&C>r.dj&&C<r.dj+r.OZ&&b===r.cj&&e<=l.y+2)return z(r,w);if(C>r.dj&&C<r.dj+r.OZ&&b===r.cj&&e>l.y+2&&e<l.y+6)return z(r,x);if(f&&u&&b>r.cj&&b<r.cj+r.Xj&&C===r.dj&&t<=l.x+2)return z(r,w);if(b>r.cj&&b<r.cj+r.Xj&&C===r.dj&&t>l.x+2&&t<l.x+18)return z(r,S);if(p=v.getColumnWidth(r.dj+r.OZ-1),d=v.getRowHeight(r.cj+r.Xj-1),g=l.x+p,m=l.y+d,u&&(b>r.cj&&b<r.cj+r.Xj&&C===r.dj+r.OZ-1&&t>=g-2&&t<=g||C>r.dj&&C<r.dj+r.OZ&&b===r.cj+r.Xj-1&&e>=m-2&&e<=m)){if(C===r.dj+r.OZ-1&&b===r.cj+r.Xj-1&&e>=m-10&&t>=g-10)return st;if(f)return z(r,w)}}return st},t.prototype.bJb=function(t,e){var n,o,r,i,a=this,s=a.kj;if(a.find(t,e)instanceof Xt){for(o=0,(n=a.find(t,e)).NZ&&(o=1),r=0,n.MZ&&(r=1);t>0&&0===s.getRowHeight(t-1);)t--;if(1===r&&e===n.dj&&t===n.cj)return i=_(s,n,!0),P(i,n.dj+n.OZ-1,i);if(e===n.dj&&t===n.cj)return i=_(s,n,!0),P(i,n.dj+n.OZ-1,i);if(t>n.cj&&t<n.cj+n.Xj-o&&e===n.dj)return t===n.cj+r?(t=_(s,n,!0),P(t,n.dj+n.OZ-1,t)):P(t-1,n.dj+n.OZ-1,t-1)}return null},t.prototype.cJb=function(t,e){var n,r,i,a,s,l,u,c,f,h,p,d,g=this,m=g.kj;if(g.find(t,e)instanceof Xt){for(r=0,(n=g.find(t,e)).NZ&&(r=1),i=0,n.MZ&&(i=1),a=m.getRowCount()-1;t+1<m.getRowCount()&&0===m.getRowHeight(t+1);)t++;if(a!==t&&e===n.dj+n.OZ-1&&t<n.cj+n.Xj-r)return s=n.cj+n.Xj,u=(l=n.dj)+n.OZ-1,c=P(t+1,n.dj,t+1),t===s-r-1&&(n.qNb?(f=B(m,n),1===r&&H(m,n,s,f,l,u,1,!0,!1,!0)||(p=((h=V(m,new o.Range(s,l,f-s+1,u-l+1)))&&h.row)===s,s!==m.getRowCount()&&(p?function(t,e,n,o,r){t.wu().execute({cmd:Et,sheetName:t.name(),tableName:e.name(),row:n,count:o,isAfter:r})}(m,n,t,1,!0):function(t,e,n,o,r){t.wu().execute({cmd:"DoInsertRows",sheetName:t.name(),tableName:e.name(),row:n,count:o,isAfter:r})}(m,n,t,1,!0)))):c=P(t,u+1,t)),c;if(m.getRowCount()-1===t&&e===n.dj+n.OZ-1&&0===r){for(d=n.cj+i;d+1<m.getRowCount()&&0===m.getRowHeight(d);)d++;return d+1===m.getRowCount()&&0===m.getRowHeight(d)?P(n.cj,n.dj,n.cj):P(d,n.dj,d)}}return null},t.prototype.fg=function(){var t,e=this.l$,n=e.length;for(t=0;t<n;t++)e[t].e$()},t.prototype.Cec=function(t,e){var n,o,r,i,a,s,l=this.l$,u=l.length;for(n=0;n<u;n++)o=l[n],t?(r=o.cj,i=o.cj+o.Xj-1,r<=e&&e<=i&&o.Cec(0)):(a=o.dj,s=o.dj+o.OZ-1,a<=e&&e<=s&&o.Cec(0))},t.prototype.KFc=function(t,e,n,o,r){var i,a,s,l=this.s$(t,e,n,o),u=[];for(i=0,a=l.length;i<a;i++)s=l[i].dataRange(),r?s.rowCount+=n:s.colCount+=o,u.push(s);return u},t}(),e.TableManager=Jt,function(t){t[t.none=0]="none",t[t.keepData=1]="keepData",t[t.keepStyle=2]="keepStyle"}(e.TableRemoveOptions||(e.TableRemoveOptions={})),o.GC$.extend(o.lUa.prototype,{CNb:function(t,e){var n=this.zTa;n&&(n.uVa||(n.uVa=[]),n.uVa.push({type:"changeTableManager",table:t,oldTableManager:e}))},pVa:function(t,e,n){var o=this.zTa;o&&(o.uVa||(o.uVa=[]),o.uVa.push({type:_t,table:t,name:e,value:n}))},tVa:function(t){var e,n,o=this.zTa;o&&(o.uVa||(o.uVa=[]),e=o.uVa,n=this.noa,e.push({type:Ft,tableList:n.l$.slice(),changedTables:t}))},sVa:function(t,e,n){var o=this.zTa;o&&(o.uVa||(o.uVa=[]),o.uVa.push({type:Pt,tableColumn:t,name:e,value:n}))},vVa:function(t,e,n){var o=t.getValue(e,n).value,r=this.zTa;r&&(r.uVa||(r.uVa=[]),r.uVa.push({type:Lt,bindingManager:t,row:e,col:n,oldValue:o}))},ENb:function(t,e,n,o,r){var i=this.zTa;i&&(i.uVa||(i.uVa=[]),i.uVa.push({type:Bt,table:t,key:o,row:e,count:n,stateType:r}))},YNb:function(t,e,n){var o=this.zTa;o&&(o.aOb||(o.aOb=[]),o.aOb.push({type:Vt,table:t,expression:e,col:n}))},ZNb:function(t,e,n,o){var r=this.zTa;r&&(r.bOb||(r.bOb=[]),r.bOb.push({type:zt,table:t,expression:e,row:n,col:o}))},wVa:function(t){var e,n,o,r,i,a,s,l;if(t)for(function(t){var e,n;if(t)for(e=t.length-1;e>=0;e--)(n=t[e]).bindingManager.sUa(n)}(t.rUa),e=t.length-1;e>=0;e--)switch(n=t[e],o=void 0,n.type){case Ft:r=this.noa,i=n.changedTables,r.l$=n.tableList,i&&i.length>0&&i.forEach((function(t){t&&(t.e$(),t.JZ())}));break;case Pt:n.tableColumn[n.name](n.value);break;case _t:o=n.table,a=n.name,s=n.value,a===Gt?(o.cj=s.row,o.dj=s.col,o.Xj=s.rowCount,o.OZ=s.colCount):a===Ht?o.Nz=s:a===kt?o.mNb=s:o[a](s),o.Cec(0);break;case"changeTableManager":o=n.table,l=n.oldTableManager,o.BNb(l);break;case Lt:n.bindingManager.setValue(n.row,n.col,n.oldValue);break;case Bt:ne(n.table,n.row,n.count,n.key,n.stateType)}},cOb:function(t){var e,n,o,r,i,a,s;if(t){for(e=void 0,n=t.length-1;n>=0;n--)(o=t[n]).type===Vt&&(e=o.table,r=o.expression,i=o.col,a=void 0,(a=e.Nz[i].footerFormula())&&((s=tt(a))>-1&&(a.arguments[s]=r)));e&&e.e$()}},dOb:function(t){var e,n,o,r,i;if(t)for(e=t.length-1;e>=0;e--)(n=t[e]).type===zt&&(o=n.expression,r=n.row,i=n.col,n.table.SNb(r,i,o))}}),o.lUa.$n(Nt,{priority:7e3,init:function(){this.noa=new Jt(this.kj)},clearPendingChanges:function(t){var e=this.tables;e&&e.Xec(t.tableList)},undoAddRows:function(t){var e=this.kj,n=t.row,o=t.rowCount;e.tables.s$(n,-1,o,-1).forEach((function(t){t.WNb(n,o,q(!0))}))},getValue:function(t){var e,n=t.row,o=t.col,r=t.sheetArea,i=this.kj.tables;3===r&&i&&(i.find(n,o)&&(e=i.ge(n,o),t.isValueGet=e.gt,t.value=e.Qb))},setValue:function(t){var e,n=t.row,o=t.col,r=t.value,i=t.sheetArea,a=this.kj.tables;3===i&&a&&(a.find(n,o)&&(void 0,(e=t.changes)&&(e.uVa||(e.uVa=[])),t.isValueSet=a.yq(n,o,r)))},undo:function(t){var e=t.uVa,n=t.aOb,o=t.bOb;e&&this.wVa(e),n&&this.cOb(n),o&&this.dOb(o),this.noa.Nm()}}),o.Workbook.$n(Nt,{init:function(){o.Commands.mMb(this.commandManager())}})},"./dist/plugins/table/table.ns.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./dist/plugins/table/table.res.en.js");e.SR={en:o}},"./dist/plugins/table/table.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_DragDropShiftTableCell="This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",e.Exp_DragDropChangePartOfTable="Cannot complete operation: You are attempting to change a portion of a table row or column in a way that is not allowed.",e.Exp_TableEmptyNameError="The table name cannot be empty.",e.Exp_TableNameInvalid="The table name is not valid.",e.Exp_TableInvalidRow="Invalid row index or row count.",e.Exp_TableInvalidColumn="Invalid column index or column count.",e.Exp_TableIntersectError="The tables cannot be intersected.",e.Exp_TableHasSameNameError="The current worksheet already exists in a table with the same name.",e.Exp_TableDataSourceNullError="Table datasource cannot be null.",e.Exp_TableMoveOutOfRange="The table cannot be moved out of the sheet.",e.Exp_TableResizeOutOfRange="The invalid row count, column count, and table cannot be resized out of the sheet.",e.Exp_ArrayFormulaTable="multi-cell array formulas are not allowed in tables.",e.Exp_TableResizeInvalidRange="The headers must remain in the same row, and the resulting table range must overlap the original table range.",e.Exp_TableResizeToSpan="Cannot complete operation: A table cannot overlap with a table or merged cells.",e.Exp_TableResizeWithFilter="Cannot shift cells in a filtered range or table.",e.Exp_TableResizeWithHidden="Cannot resize a table that's adjacent to a hidden row or column.",e.Exp_TableResizeToTable="Cannot complete operation: Operations that include cells both inside and outside a table range, and operation that affect cells that overlap multiple tables are not allowed.",e.Exp_RowParamOutOfRange="The param row out of data range of table.",e.Exp_ColParamOutOfRange="The param col out of data range of table.",e.Exp_TableDeleteCountInvalid="The param count to delete will cause empty table.",e.Exp_TableAddRowIntersectSpan="This won't work because it would move cells in a span on your worksheet.",e.Exp_TableAddRowIntersectTable="This won't work because it would move cells in a table on your worksheet.",e.Exp_TableAddRowNoEnoughRoom="Cannot insert new cells because it would push non-empty cells of the end of worksheet. These cells might appear empty but have blank values, some formatting, or a formula. Delete enough rows or columns to make room for what you want to insert and then try again.",e.Table_Total="Total",e.Table_None="None",e.Table_Average="Average",e.Table_Count="Count",e.Table_Count_Numbers="Count Numbers",e.Table_Max="Max",e.Table_Min="Min",e.Table_Sum="Sum",e.Table_StdDev="StdDev",e.Table_Var="Var"},"./dist/plugins/touch/touch.entry.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n("./dist/plugins/touch/touch.js"))},"./dist/plugins/touch/touch.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht,Vt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function zt(t){return t.height}function Wt(t){return t.width}function Ut(t){clearInterval(t)}function qt(){return(new Date).valueOf()}function Yt(t,e){var n,o;return!(!t||!e)&&(13,15,13,13,15,15,n=t.X-e.X,o=t.Y-e.Y,C(n)<13&&C(o)<13&&I(n*n+o*o)<b(15,15))}function Xt(t){return t.getActiveSheet()}function Zt(t){return t.getSelections()}function Qt(t){return t.frozenTrailingColumnCount()}function Jt(t){return t.frozenTrailingRowCount()}function $t(t,e){return t.getColumnCount(e)}function Kt(t,e){return t.getRowCount(e)}function te(t){var e=l(t).offset(),n=q.body,o=0,r=0;return e&&(o=e.top+n.clientTop||0,r=e.left+n.clientLeft||0),{FB:o,EB:r}}function ee(t,e){var n=x(e.Y,e.X)-x(t.Y,t.X);return n>S?n-=2*S:n<-S&&(n+=2*S),n}function ne(t,e){return I((e.X-t.X)*(e.X-t.X)+(e.Y-t.Y)*(e.Y-t.Y))}function oe(t){return C(t)<=2220446049250313e-31}function re(t){return new et(t?A(t.X):-1,t?A(t.Y):-1)}function ie(t,e){var n=t*e;return n>4?n=4:n<.5&&(n=.5),n}function ae(t,e){return z(-e/(t/e+1)+e+"")}function se(t,e){return z(e*(-e/(t-e)-1)+"")}function le(t,e,n,o,r,i){t.fillStyle=e,t.fillRect(n,o,r,i)}function ue(t,e,n,o,i){var a,s,l,u,c,f=r.Im.Km(0,"gc-columnHeader-normal"),h=f&&f.backgroundImage,p=f&&f.backgroundColor;if(h&&-1!==h.indexOf("linear-gradient"))for(s=r.Ul.wl(h),a=t.createLinearGradient(e+o/2,n,e+o/2,n+i),l=0,u=s.length;l<u;l++)c=s[l],a.addColorStop(c.point,c.color);else p&&(a=p);return a}function ce(){var t=r.Im.Km(0,"gc-rowHeader-normal");return t&&t.backgroundColor}function fe(t,e,n,o,r,i){t.beginPath(),t.strokeStyle=e,t.moveTo(n,o),t.lineTo(r,i),t.stroke()}function he(t){var e=t.options.sheetAreaOffset;return t.Gt&&t.Gt()||{x:e.left,y:e.top,width:0,height:0}}function pe(t,e){var n,o,r,i,a,s=t.am(),l=t.yl.bm(),u=t.jt(1),c=he(t),f=t.Rt(-1),h=u.findRow(f),d=p("gc-group").color;h&&(n=s.qt,h.y-n>0&&e&&c.width>0&&0===s.Br&&fe(l,d,s.kt-.5,n,s.kt-.5,h.y)),o=t.it(1),r=t.Ot(-1),(i=o.findCol(r))&&(a=s.pt,i.x-a>0&&e&&c.height>0&&0===s.Cr&&fe(l,d,a,s.nt-.5,i.x,s.nt-.5))}function de(t,e){var n=0;return t||(n|=1),e||(n|=2),n}function ge(t,e,n,o){var r,i,s,l,u,c,f,h,p;if(0===t.selectionPolicy())return y;for(r=e.hitTestType,i=Te(t),s=Zt(t),l=3,t.CH&&s.length>0&&(-1!==(u=s[s.length-1]).row&&-1!==u.col?l=3:-1!==u.row?l=2:-1!==u.col&&(l=1)),c=0;c<i.length;c++)if((f=i[c])&&(f.x-=Wt(f),f.y-=zt(f),f.width*=3,f.height*=3,f.contains(n,o)))return a(e.row)&&((h=t.jt(1))&&h.length>0&&(e.row=h[h.length-1].row)),a(e.col)&&((p=t.it(1))&&p.length>0&&(e.col=p[p.length-1].col)),{x:n,y:o,type:l,isHeader:!1,isFirstIndicator:0===c};return 1===r?{x:n,y:o,type:1,isHeader:!0}:2===r?{x:n,y:o,type:2,isHeader:!0}:y}function me(t,e,n,o){var r,i,s,l,u,c,f,h,p,d,g,m,v=y,C=e.rowViewportIndex,b=e.colViewportIndex;if(a(C)||a(b))return v;if(r=t.parent,i=t.Ix(),C>=0&&b>=0&&1===t.ITa.getSelections().length){if(s=t.Tq(i),l=Qt(t),u=Jt(t),c=$t(t)-l,f=Kt(t)-u,1===b&&l>0&&s.col<c&&s.col+s.colCount>c&&((h=t.Hr(b))&&h.length>0&&n>(p=h[h.length-1]).x+Wt(p)))return v;if(1===C&&u>0&&s.row<f&&s.row+s.rowCount>f&&((d=t.Gr(C))&&d.length>0&&o>(g=d[d.length-1]).y+zt(g)))return v}return(m=Ce(t))&&(v||(m.x-=Wt(m),m.y-=zt(m),m.width*=3,m.height*=3,m.contains(n,o)&&(v={action:"drag",side:"corner"})),r&&r.options.allowUserDragFill||v&&"corner"===v.side&&(v.side=y)),v}function ye(t,e,n,o,i){e===o&&n===i||(t.ITa.setCellState(e,n,r.CellStatesType.active,!1,r.SheetArea.viewport),t.xIb&&t.xIb(r.CellStatesType.active,e,n,r.SheetArea.viewport),t.ITa.setCellState(o,i,r.CellStatesType.active,!0,r.SheetArea.viewport),t.xIb&&t.xIb(r.CellStatesType.active,o,i,r.SheetArea.viewport))}function ve(t,e,n,o){var r=t.vu();r.ko(e)?n.drawImage(r.lo(e),o.x,o.y,Wt(o),zt(o)):r.fo(e)}function Ce(t){var e,n,o=y,i=Zt(t),a=i.length;return t.CH&&a>0&&(e=i[a-1],n=t.cm(e),17,20,o=new r.Rect(n.x+Wt(n)-17,n.y+zt(n),17,20)),o}function be(t,e,n){var o=t.Er(e),i=t.Fr(n),a=t.jt(o),s=t.it(i),l=0,u=0,c=0,f=0;return a.length>0&&(l=a[0].row,u=a[a.length-1].row),s.length>0&&(c=s[0].col,f=s[s.length-1].col),r.kf(l,c,u-l+1,f-c+1)}function we(t,e,n,o,r,i){var a=t.Er(e),s=t.Fr(n),l=t.am().Ft(a,s),u=be(t,e,n),c=u.row<=e&&e<=u.row+u.rowCount-1&&l.y<=r&&r<=l.y+zt(l),f=u.col<=n&&n<=u.col+u.colCount-1&&l.x<=o&&o<=l.x+Wt(l);return i&&i.colCheck?f:(i&&i.rowCheck||f)&&c}function Te(t){var e,n,o,i,a,s,l,u,c,f,h,p,d,g,m,v,C,b,w,T,x,S=Zt(t),A=[];if(t.CH&&S.length>0)for(e=S[S.length-1],n=t.cm(e),8,o=t.am(),i=e.row,a=e.row+e.rowCount-1,s=e.col,l=e.col+e.colCount-1,-1!==e.row&&-1!==e.col?(we(t,i,s,n.x,n.y)&&(A[0]=new r.Rect(n.x-8,n.y-8,16,16)),we(t,a,l,n.x+Wt(n),n.y+zt(n))&&(A[1]=new r.Rect(n.x+Wt(n)-8,n.y+zt(n)-8,16,16))):-1!==e.row?(u=o.Ft(1,0),c=o.Ft(1,1),f=u.x+(Wt(u)+Wt(c))/2-8,h=$t(t)-1-Qt(t),(d=(p=t.it(1)).findCol(h))&&((g=t.it(0)[0]||p[0])&&(f=g.x+(d.x+Wt(d)-g.x)/2-8)),we(t,i,s,f+8,n.y,{rowCheck:!0})&&(A[0]=new r.Rect(f,n.y-8,16,16)),we(t,a,l,f+8,n.y+zt(n),{rowCheck:!0})&&(A[1]=new r.Rect(f,n.y+zt(n)-8,16,16))):-1!==e.col&&(u=o.Ft(0,1),c=o.Ft(1,1),m=u.y+(zt(u)+zt(c))/2-8,v=Kt(t)-1-Jt(t),(b=(C=t.jt(1)).findRow(v))&&((w=t.jt(0)[0]||C[0])&&(m=w.y+(b.y+zt(b)-w.y)/2-8)),we(t,i,s,n.x,m+8,{colCheck:!0})&&(A[0]=new r.Rect(n.x-8,m,16,16)),we(t,a,l,n.x+Wt(n),m+8,{colCheck:!0})&&(A[1]=new r.Rect(n.x+Wt(n)-8,m,16,16))),T=void 0,x=A.length-1;x>=0;x--)(!(T=A[x])||T.x<0||T.y<0)&&(A[x]=y);return A}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("./dist/plugins/touch/touch.res.en.js"),e.SR={en:i},a=o.Common.j.Fa,s=r.Go,(l=r.GC$).extend,u=l.isEmptyObject,c=r.Ul.Nl,f=r.Ul.nl,h=r.Ul.Ml.mozilla,p=r.Im.Lm,d=r.Ul.rl(),g=d.ipad,m=g||d.iphone,y=null,v=void 0,C=Math.abs,b=Math.min,w=Math.max,T=Math.pow,x=Math.atan2,S=Math.PI,A=Math.round,I=Math.sqrt,R=Math.atan,k=Math.log,M=Math.floor,N="touch",E="none",D="MSPointerDown",O="MSPointerMove",j="MSPointerUp",F="pointerdown",P="pointermove",_="pointerup",L="touchstart",B="touchmove",G="touchend",H="MSPOINTER_TYPE_TOUCH",V=isNaN,z=parseInt,W=parseFloat,U=window,q=document,Y=U.Yl,X="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB",Z="AAAAAElFTkSuQmCC",r.Rxb.touch=!0,Q=new o.Common.ResourceManager(e.SR),J=Q.getResource.bind(Q),$=function(){function t(){var t=this;t.rM=[],t.sM={length:0},t.tM=new K,t.uM=new tt}return t.prototype.vM=function(t){this.tM.vM=t},t.prototype.wM=function(t){this.tM.wM=t},t.prototype.xM=function(t){var e=this;e.tM.xM=function(n){if(t){t(n);var o=e.yM;o&&o.zM()}}},t.prototype.AM=function(t){this.tM.AM=t},t.prototype.BM=function(t){this.tM.BM=t},t.prototype.CM=function(t){this.uM.CM=t},t.prototype.DM=function(t){this.uM.DM=t},t.prototype.EM=function(t){this.uM.EM=t},t.prototype.FM=function(t){this.GM=t},t.prototype.HM=function(t){this.IM=t},t.prototype.JM=function(t,e){var n=e?e.KM:this.LM.KM;return r.Ul.Z3(t,n)},t.prototype.MM=function(t,e){var n,o,r,i,a,s=this,l=e.pointerType,u=e.target,c=e.offsetX,h=e.offsetY;l!==e[H]&&l!==N||(o=(n=s.JM(u,t)).EB,r=n.FB,s.NM(t,u,e.pointerId,new et(c+o,h+r),e.timeStamp)&&f(e),"sheet"===s.LM.OM&&(i=e.pageX-(c+o),a=e.pageY-(h+r),s.LM.KM.canvasOffset={top:a,left:i}))},t.prototype.PM=function(t){var e,n=this,o=t.pointerType,r=t.pointerId;if(o===t[H]||o===N){if(n.sM[r]===v)return!1;e=n.JM(t.target),n.aB(r,new et(t.offsetX+e.EB,t.offsetY+e.FB),t.timeStamp)&&f(t)}},t.prototype.QM=function(t){var e,n=this,o=t.pointerType,r=t.pointerId;if(o===t[H]||o===N){if(n.sM[r]===v)return!1;e=n.JM(t.target),n.RM(r,new et(t.offsetX+e.EB,t.offsetY+e.FB))&&f(t)}},t.prototype.SM=function(t){var e,n=this,o=t.pointerType,r=t.pointerId;if(o===t[H]||o===N){if(n.sM[r]===v)return!1;e=n.JM(t.target),n.TM(r,new et(t.offsetX+e.EB,t.offsetY+e.FB))&&f(t)}},t.prototype.UM=function(t,e){var n,o,r,i=te(t.KM),a=e.changedTouches,s=!1;for(n=0;n<a.length;n++)o=a[n],r=h?qt():e.timeStamp,s=this.NM(t,e.target,o.identifier,new et(o.pageX-i.EB,o.pageY-i.FB),r)||s;s&&f(e)},t.prototype.VM=function(t){var e,n,o,r=te(this.LM.KM),i=t.changedTouches,a=!1;for(e=0;e<i.length;e++)n=i[e],o=h?qt():t.timeStamp,a=this.aB(n.identifier,new et(n.pageX-r.EB,n.pageY-r.FB),o)||a;a&&f(t)},t.prototype.WM=function(t){var e,n,o=te(this.LM.KM),r=t.changedTouches,i=!1;for(e=0;e<r.length;e++)n=r[e],i=this.RM(n.identifier,new et(n.pageX-o.EB,n.pageY-o.FB))||i;i&&f(t)},t.prototype.XM=function(t){var e,n,o=te(this.LM.KM),r=t.changedTouches,i=!1;for(e=0;e<r.length;e++)n=r[e],i=this.TM(n.identifier,new et(n.pageX-o.EB,n.pageY-o.FB))||i;i&&f(t)},t.prototype.YM=function(t){var e,n,o=this.LM,r=this.ZM;o!==r&&(e=l(o.KM).offset(),n=l(r.KM).offset(),t.X+=e.left-n.left,t.Y+=e.top-n.top)},t.prototype.$M=function(t,e){var n,o,r,i,a,s=this,l=s.rM;for(s.ZM=y,s.yM=y,o=0;o<l.length;o++)if(l[o]===t){if(r=l[o],i=y,a=y,r._M&&!r._M()){for(o=0;o<l.length;o++)if((n=l[o])!==r&&n.aN>=0&&n.aN<r.aN&&(!n._M||n._M())){i=n;break}if(i===y)return!1}if(r.bN&&!r.bN()){for(o=0;o<l.length;o++)if((n=l[o])!==r&&n.aN>=0&&n.aN<r.aN&&(!n.bN||n.bN())){a=n;break}if(a===y)return!1}i===y&&(i=r),a===y&&(a=r),s.LM=r,s.ZM=i,s.cN=a,s.vM(a.dN||y),s.wM(i.eN||y),s.BM(i.fN||y),s.AM(i.gN||y),s.xM(i.hN||y),s.CM(a.iN||y),s.DM(a.jN||y),s.EM(a.kN||y),s.FM(i.GM||y),s.HM(i.IM||y),i.lN&&(s.yM=r.lN);break}return!0},t.prototype.NM=function(t,e,n,o,r){var i=this;return!(i.sM[n]!==v||0===i.sM.length&&!i.$M(t,e)||!i.ZM||!(i.sM.length>=i.ZM.mN)&&(i.yM&&i.yM.nN()||(i.YM(o),i.yM&&0===i.sM.length&&i.yM.oN(),i.sM[n]={id:n,time:qt(),position:o},i.sM.length++,i.tM.pN(e,n,o,r),i.tM.qN(n,o,i.sM.length,r),1===i.sM.length&&i.uM.qN(o),1===i.sM.length&&i.GM&&i.GM({rN:o}),0)))},t.prototype.aB=function(t,e,n){var o=this;return!(o.sM[t]===v||o.yM&&o.yM.sN()||(o.YM(e),o.sM[t]={id:t,time:qt(),position:e},o.tM.tN(t,e,n),0))},t.prototype.RM=function(t,e){var n=this;return n.sM[t]!==v&&(delete n.sM[t],n.sM.length--,!(n.yM&&n.yM.uN()||(n.YM(e),n.tM.vN(t),n.tM.wN(),0===n.sM.length&&(n.uM.vN(e),n.uM.wN()),0===n.sM.length&&n.IM&&n.IM({rN:e}),n.yM&&0===n.sM.length&&0===n.tM._process&&n.yM.zM(),0)))},t.prototype.TM=function(t,e){return this.RM(t,e)},t.prototype.xN=function(t,e){var n,i,s,u,c,f=this,h="."+t.OM,p=".gcSheet",d=D+p,g=O+p+h,m=j+p+h,y="MSPointerCancel"+p+h,v="MSLostPointerCapture"+p+h,C=F+p,b=P+p+h,w=_+p+h,T="LostPointerCapture"+p+h,x="pointercancel"+p+h,S=L+p,A=B+p,I=G+p,R="touchcancel"+p;function k(){l(q).unbind(g).unbind(b).unbind(m).unbind(w).unbind(y).unbind(x).unbind(v).unbind(T)}function M(e){l(q).bind(g,N).bind(m,H).bind(b,N).bind(w,H).bind(y,V).bind(v,V).bind(T,V).bind(x,V),f.MM(t,e)}function N(t){f.PM(t)}function H(t){f.QM(t),0===f.sM.length&&k()}function V(t){f.SM(t),0===f.sM.length&&k()}n=t.KM,i=f.rM,(s=o.Common.k.Cb(i,t))>=0&&e||s<0&&!e||(u=r.Ul._Va(),e?u?(c=n.style,a(c.msTouchAction)||(c.msTouchAction=E),a(c.touchAction)||(c.touchAction=E),l(n).bind(d,M).bind(C,M)):(l(n).bind(S,(function(e){f.UM(t,e)})),l(n).bind(A,(function(t){f.VM(t)})).bind(I,(function(t){f.WM(t)})).bind(R,(function(t){f.XM(t)}))):u?l(n).unbind(d).unbind(C):l(n).unbind(S).unbind(A).unbind(I).unbind(R),e?i.push(t):i.splice(s,1))},t.prototype.no=function(){var t,e=this.rM;for(t=e.length-1;t>=0;t--)this.xN(e[t],!1)},t}(),e.TouchEventProvider=$,K=function(){function t(){var t=this;t.AN=0,t.BN=0,t.CN=1,t.DN=0,t.EN=0,t._process=0,t.FN=511,t.GN=new lt,t.HN=20,t.IN=new nt}return t.prototype.pN=function(t,e,n,o){var r,i=this;3===i._process&&i.JN(!0),i.KN=2===i._process&&1===i.GN.MN(),i.NN=t,(r={}).Np=e,r.ON=n,r.PN=n,i.GN.QN(r),i.RN=o,i.GN.MN()>1&&(i.SN=!1,i.TN=!1,1===i._process&&i.UN())},t.prototype.qN=function(t,e,n,o){0===this._process&&1===n&&this.VN(this.GN.WN(0).PN)},t.prototype.tN=function(t,e,n){var o,r,i,a,s,l,u,c=this;if(0!==c.FN&&c.GN.XN(t)){if(1===c._process&&1===c.GN.MN()){if(o=c.YN(),!c.ZN(1)&&!c.ZN(2)&&!o)return;if(Yt(e,r=c.GN.$N(t).PN))return;i=C(e.X-r.X),a=C(e.Y-r.Y),c._N(i,a)}if(!(n-c.RN<20)){if(c.GN.$N(t).aO=e,(s=c.GN.MN())>1)for(l=0;l<s;l++)if(!(u=c.GN.WN(l)).aO)return;for(c.bO(n),c.RN=n,s=c.GN.MN(),l=0;l<s;l++)(u=c.GN.WN(l)).ON=u.aO,u.aO=y}}},t.prototype.wN=function(){var t=this;t.cO&&(t.dO(t.cO),t.cO=y)},t.prototype.vN=function(t){var e=this;e.GN.XN(t)&&(e.GN.eO(t),2===e._process?0===e.GN.MN()&&(e.ZN(64)||e.ZN(256)||e.ZN(128)?e.fO():e.JN(!0)):3===e._process?e.JN(!0):1===e._process&&e.JN(!1))},t.prototype.bO=function(t){var e,n,o,r,i=this,a=i.gO(),s=a.hO,l=a.iO,u=a.SH,c=i.jO(),f=c.kO,h=c.eb,p=c.lO;if(i.AN+=s,i.BN+=l,i.CN*=h,i.DN+=f,i.EN+=p,(e={}).lO=p,e.kO=f,e.mO=t-i.RN,e.hO=s,e.iO=l,i.IN.nO(e),i.oO=u,1===i._process||2===i._process){if(1===i._process&&i.UN())return;if((n=new st).pO=p,n.qO=f,n.rO=h,n.sO=new et(s,l),o=new ot(i.IN),r=new ft(i.NN,i.tO(),n,!1,u,o),i.uO(r),r.vO)return void i.JN(!0)}},t.prototype.UN=function(){var t,e=this;return e._process=2,t=new pt(e.NN,e.GN.MN(),e.tO(),e.GN.WN(0).PN),e.wO(t),!!t.vO&&(e.JN(!0),!0)},t.prototype._N=function(t,e){var n=function(t,e){var n,o=!1,r=!1;return 0!==t&&((n=R(e/t)/S*180)<20&&(o=!0)),0===t?r=!0:(n=R(e/t)/S*180)>75&&n<105&&(r=!0),{yN:o,zN:r}}(t,e);this.SN=n.yN,this.TN=n.zN},t.prototype.gO=function(){var t=this.xO(),e=t.yO,n=t.zO,o=new et(e.X,e.Y);return{hO:e.X-n.X,iO:e.Y-n.Y,SH:o}},t.prototype.jO=function(){var t,e=this,n=0,o=1,r=0;return e.ZN(16)&&1===e.GN.MN()&&e.YN()&&(n=function(t,e,n){var o=new et(n._Center.X,n._Center.Y),r=new et(e.X-o.X,e.Y-o.Y),i=new et(t.X-o.X,t.Y-o.Y),a=b(1,T(ne(e,o)/n._Radius,4)),s=ee(r,i);return V(s)?0:s*a}(e.GN.WN(0).aO,e.GN.WN(0).ON,e.AO)),e.GN.MN()>1&&(n=(t=e.BO()).kO,o=t.eb,r=t.lO),{kO:n=n/S*180,eb:o,lO:r}},t.prototype.BO=function(){var t,e,n,o,r,i,a,s,l,u,c=this,f=c.xO(),h=f.yO,p=f.zO,d=c.YN(),g=d?c.AO._Center:new et(0,0),m=0,y=1,v=0,C=0,b=0,w=0,T=0,x=c.GN.MN();for(t=0;t<x;t++)n=(e=c.GN.WN(t)).aO,o=e.ON,r=ne(n,h),i=ne(o,p),a=d?new et(o.X-g.X,o.Y-g.Y):new et(o.X-p.X,o.Y-p.Y),s=d?new et(n.X-g.X,n.Y-g.Y):new et(n.X-h.X,n.Y-h.Y),l=ne(o,g),u=ne(n,g),i>=c.HN&&r>=c.HN&&(b++,w+=r,T+=i,(!d||l>=c.HN)&&u>=c.HN&&(m+=ee(a,s),C++));return C>0&&c.ZN(16)?m/=C:m=0,b>0&&c.ZN(32)?(c.KN||(y=w/T),v=(w-T)/b,c.CO=w/b):c.CO=0,{kO:m,eb:y,lO:v}},t.prototype.ZN=function(t){return 0!=(this.FN&t)},t.prototype.xO=function(){var t,e,n,o,r,i=0,a=0,s=0,l=0,u=this.GN,c=u.MN();for(t=0;t<c;t++)n=(e=u.WN(t)).ON,o=e.aO,i+=n.X,a+=n.Y,s+=o.X,l+=o.Y;return r=new et(i/c,a/c),{yO:new et(s/c,l/c),zO:r}},t.prototype.YN=function(){var t=this.AO;return t&&!V(t._Radius)},t.prototype.VN=function(t){var e=this,n=new dt(e.NN,e.FN,y,t);return n.DO=511,e.EO(n),e.FO=n.DO,0===n.DO?(e.JN(!1),!1):(e.FN=n.DO,e.AO=n.GO,e._process=1,!0)},t.prototype.JN=function(t){var e,n=this,o=3===n._process;n._process=0,n.HO&&(Ut(n.HO),n.HO=y),t&&(e=new ct(n.NN,n.tO(),o,re(n.oO),new ot(n.IN)),3===n._process?n.cO=e:n.dO(e)),n.IN.IO(),n.GN.IO(),n.AO=y,n.AN=0,n.BN=0,n.CN=1,n.DN=0,n.EN=0,n.SN=!1,n.TN=!1,n.FN=0},t.prototype.fO=function(){var t,e,n=this,o={},r=new ot(n.IN);return o.JO=n.ZN(64)?r.KO().X:0,o.LO=n.ZN(64)?r.KO().Y:0,o.MO=n.ZN(256)?r.pO():0,o.NO=n.ZN(128)?r.OO():0,0===o.JO&&0===o.LO&&0===o.MO&&0===o.NO?void n.JN(!0):(o.PO=new at(o.JO,o.LO),o.QO=new rt(o.MO),o.RO=new it(o.NO),r=new ot(y,o.JO,o.LO,o.NO,o.MO),t=new ht(n.NN,n.tO(),new st,r,o.QO,o.RO,o.PO),n.SO(t),o.PO=t.TO,o.QO=t.QO,o.RO=t.RO,o.PO.UO<=0&&o.PO.VO<=0&&o.PO.WO(.003),o.QO.XO()<=0&&o.QO.WO(.002),o.RO.XO()<=0&&o.RO.WO(.003),e=qt(),o.YO=e,o.ZO=e,o.$O=0,o._O=0,n._process=3,void(n.HO=U.setInterval((function(){try{n.aP(o)}catch(t){}}),20)))},t.prototype.aP=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d=this,g=qt(),m=g-t.ZO;if(0!==m){if(e=t.JO,n=t.LO,o=t.MO,r=t.NO,t.JO=d.bP(m,t.PO.UO,t.JO),t.LO=d.bP(m,t.PO.VO,t.LO),t.MO=d.bP(m,t.QO.XO(),t.MO),t.NO=d.bP(m,t.RO.XO(),t.NO),e=(e+t.JO)/2,n=(n+t.LO)/2,o=(o+t.MO)/2,r=(r+t.NO)/2,t.ZO=g,i=!1,oe(e)&&oe(n)&&oe(o)&&oe(r)&&(i=!0),a=m*e,s=m*n,l=m*o,u=m*r,c=1,d.CO>0&&(d.CO+2*l<0&&(l=-d.CO/2+1),0!==d.CO&&(c=(d.CO+2*l)/d.CO)),d.EN+=l,d.DN+=u,d.AN+=a,d.BN+=s,d.CN*=c,d.CO+=l,d.oO=new et(d.oO.X+a,d.oO.Y+s),t.$O+=a,t._O+=s,i){if(a=A(t.$O),s=A(t._O),oe(a)&&oe(s))return void d.JN(!0)}else C(t.$O)>=1&&(a=t.$O,t.$O-=a),C(t._O)>=1&&(s=t._O,t._O-=s);return(f=new st).sO=new et(a,s),f.rO=c,f.pO=l,f.qO=u,h=new ot(y,t.JO,t.LO,t.NO,t.MO),p=new ft(d.NN,d.tO(),f,!0,re(d.oO),h),d.uO(p),p.vO?void d.JN(!0):void(i&&d.JN(!0))}},t.prototype.bP=function(t,e,n){return oe(n)?0:(((o=n<0?n+e*t:n-e*t)<0&&n>0||o>0&&n<0)&&(o=0),o);var o},t.prototype.tO=function(){var t=this,e=new st;return e.pO=t.EN,e.qO=t.DN,e.rO=t.CN,e.sO=new et(t.AN,t.BN),e},t.prototype.cP=function(t,e,n,o){var r,i=this,a=new st,s=new st,l=0,u=0,c=0,f=0,h=i.ZN(4)&&i.SN,p=i.ZN(8)&&i.TN;return!i.ZN(1)||p||t&&!i.ZN(64)||(a.sO.X=e.sO.X,s.sO.X=n.sO.X,l=o.KO().X),!i.ZN(2)||h||t&&!i.ZN(64)||(a.sO.Y=e.sO.Y,s.sO.Y=n.sO.Y,u=o.KO().Y),!i.ZN(32)||t&&!i.ZN(256)?(a.rO=e.rO,s.rO=1):(a.rO=e.rO,a.pO=e.pO,s.rO=n.rO,s.pO=n.pO,f=o.pO()),!i.ZN(16)||t&&!i.ZN(128)||(a.qO=e.qO,s.qO=n.qO,c=o.OO()),r=new ot(y,l,u,c,f),new ut(a,s,r)},t.prototype.EO=function(t){this.vM&&t&&this.vM(t)},t.prototype.wO=function(t){this.wM&&t&&this.wM(t)},t.prototype.dO=function(t){var e,n=this;n.xM&&t&&(e=n.cP(!1,t.dP,t.dP,t.eP),t.dP=e.dP,t.eP=e.eP,n.xM(t))},t.prototype.SO=function(t){var e,n=this;n.AM&&t&&(e=n.cP(!1,t.dP,t.fP,t.eP),t.dP=e.dP,t.fP=e.fP,t.eP=e.eP,n.AM(t))},t.prototype.uO=function(t){var e,n=this;n.BM&&t&&(e=n.cP(t.gP,t.dP,t.fP,t.eP),t.dP=e.dP,t.fP=e.fP,t.eP=e.eP,n.BM(t))},t}(),tt=function(){function t(){}return t.prototype.qN=function(t){var e,n=this;n._pointerCount++,n._pointerCount>1||(e=qt(),n.hP&&Yt(t,n.hP)&&e-n.iP<400?n.Jb++:(n.hP=t,n.Jb=1),n.jP=t,n.iP=e)},t.prototype.wN=function(){var t=this;t.cO&&(t.cO instanceof gt?t.kP(t.cO):t.cO instanceof mt&&t.lP(t.cO),t.cO=y)},t.prototype.vN=function(t){var e,n=this;n._pointerCount--,n._pointerCount>0||(e=qt(),Yt(t,n.jP)?e-n.iP>1e3?n.cO=new mt(n.jP):n.Jb>1?(n.Jb=0,n.mP(new yt(n.hP)),n.hP=y):n.cO=new gt(n.jP):n.hP=y)},t.prototype.nP=function(){this.hP=y},t.prototype.kP=function(t){this.CM&&t&&this.CM(t)},t.prototype.mP=function(t){this.DM&&t&&this.DM(t)},t.prototype.lP=function(t){this.EM&&t&&this.EM(t)},t}(),et=function(t,e){this.X=t,this.Y=e},e.oP=et,nt=function(){function t(){var t=this;t.Jb=0,t.oI=0,t.pP=10,t.qP=[]}return t.prototype.rP=function(t){var e,n,o,r,i,a,s=this;if(0===s.Jb)return 0;for(e=0,n=(1+s.Jb)*s.Jb/2,o=s.Jb-1;o>=0;o--)r=0,i=s.sP(o),0===t?r=i.hO:1===t?r=i.iO:2===t?r=i.lO:3===t&&(r=i.kO),a=s.tP(r,i.mO),e+=a*=o+1;return e/n},t.prototype.tP=function(t,e){return t/e},t.prototype.sP=function(t){return this.qP[this.uP(t)]},t.prototype.vP=function(){return this.qP[this.Jb-1]},t.prototype.nO=function(t){var e,n,o=this;for(10===o.Jb&&o.wP(),o.Jb++,o.qP[o.uP(o.Jb-1)]=t,e=20*o.pP,n=0;n<o.Jb;n++)t.mO-o.qP[n].mO>e&&(o.wP(),n--)},t.prototype.wP=function(){var t=this;t.oI++,t.oI===t.pP&&(t.oI=0),t.Jb--},t.prototype.IO=function(){this.Jb=0},t.prototype.uP=function(t){return(this.oI+t)%this.pP},t}(),ot=function(){function t(t,e,n,o,r){var i=this;t?i.qP=t:(i.xP=new et(e,n),i.yP=o,i.lO=r)}return t.prototype.KO=function(){var t=this;return t.xP||(t.xP=new et(t.qP.rP(0),t.qP.rP(1))),t.xP},t.prototype.OO=function(){var t=this;return a(t.yP)&&(t.yP=t.qP.rP(3)),t.yP},t.prototype.pO=function(){var t=this;return a(t.lO)&&(t.lO=t.qP.rP(2)),t.lO},t}(),rt=function(){function t(t){this.zP=t,this.AP=0}return t.prototype.XO=function(){var t=this,e=t._DesiredExpansion,n=t._DesiredDeceleration,o=t.zP;return V(e)||0===e?V(n)?t.AP:n:.5*o*o/e},t.prototype.WO=function(t){this.AP=t},t}(),it=function(){function t(t){this.zP=t,this.AP=0}return t.prototype.XO=function(){var t=this,e=t._DesiredRotation,n=t._DesiredDeceleration,o=t.zP;return V(e)||0===e?V(n)?t.AP:n:.5*o*o/e},t.prototype.WO=function(t){this.AP=t},t}(),at=function(){function t(t,e){var n=this;n.BP=t,n.CP=e,n.UO=0,n.VO=0,n.AP=0,n.DP=I(t*t+e*e)}return t.prototype.EP=function(){var t=this,e=t._DesiredDisplacement,n=t.DP,o=t.BP,r=t.CP,i=t.XO();V(e)||0===e?V(i)||0===i?(t.UO=0,t.VO=0):(t.UO=i*C(o)/n,t.VO=i*C(r)/n):(t.UO=.5*n*C(o)/e,t.VO=.5*n*C(r)/e)},t.prototype.XO=function(){var t=this,e=t._DesiredDeceleration;return V(e)&&V(t._DesiredDisplacement)?t.AP:e},t.prototype.WO=function(t){this.AP=t,this.EP()},t}(),st=function(){var t=this;t.sO=new et(0,0),t.rO=0,t.qO=0,t.pO=0},lt=function(){function t(){this.FP=[]}return t.prototype.XN=function(t){var e,n=this.FP;for(e=0;e<n.length;e++)if(n[e].Np===t)return!0;return!1},t.prototype.QN=function(t){this.FP.push(t)},t.prototype.eO=function(t){var e,n=this.FP;for(e=0;e<n.length;e++)if(n[e].Np===t){n.splice(e,1);break}},t.prototype.MN=function(){return this.FP.length},t.prototype.WN=function(t){return this.FP[t]},t.prototype.$N=function(t){var e,n,o=this.FP;for(e=0;e<o.length;e++)if((n=o[e]).Np===t)return n;return y},t.prototype.IO=function(){var t=this.FP;t.splice(0,t.length)},t}(),ut=function(t,e,n){var o=this;o.dP=t,o.fP=e,o.eP=n},ct=function(t,e,n,o,r){var i=this;i.GP=t,i.dP=e,i.gP=n,i.rN=o,i.eP=r},e.ManipulationCompletedEventArgs=ct,ft=function(t,e,n,o,r,i){var a=this;a.GP=t,a.dP=e,a.fP=n,a.gP=o,a.rN=r,a.eP=i},e.ManipulationDeltaEventArgs=ft,ht=function(t,e,n,o,r,i,a){var s=this;s.GP=t,s.dP=e,s.fP=n,s.eP=o,s.QO=r,s.RO=i,s.TO=a},pt=function(t,e,n,o){var r=this;r.GP=t,r.HP=e,r.dP=n,r.rN=o},e.ManipulationStartedEventArgs=pt,dt=function(t,e,n,o){var r=this;r.GP=t,r.DO=e,r.GO=n,r.rN=o},e.ManipulationStartingEventArgs=dt,gt=function(t){this.rN=t},mt=function(t){this.rN=t},yt=function(t){this.rN=t},vt=function(){function t(t){this.kj=t}return t.prototype.IP=function(t,e){var n=this.Xs;return n?t===r.En.Nn(n)&&e===r.En.On(n)||r.En.Pn(n,t,e):(n=c("canvas"),r.En.Kn(n,y,this.kj),r.En.Pn(n,t,e)),n},t.prototype.JP=function(t,e,n,o){var i=this,a=r.En.Nn(t),s=r.En.On(t),l=i.IP(a,s),u=l.getContext("2d"),c=r.En.Ln(l),f=r.En.Mn(l);r.Bn.Cn(u,1,1),u.drawImage(t,0,0,Wt(l),zt(l),0,0,Wt(l),zt(l)),r.Bn.Cn(u,c,f),i.Xs=l,i.KP=e,i.LP=n,i.MP=o},t.prototype.NP=function(t,e,n){var o,i,a,s,l,u,c,f,h,p,d=this,g=d.kj,m=r.En.Nn(t),v=r.En.On(t),C=Qt(g),b=Jt(g),w=C>0?1:0,T=b>0?1:0,x=d.LP,S=he(g),A=d.KP,I=g.am(),R=e/d.MP,k=t.getContext("2d"),M=r.En.Ln(t),N=r.En.Mn(t),E=d.Xs;k.save(),k.fillStyle=n,k.fillRect(0,0,m,v),h=g.rowOutlines,p=g.columnOutlines,h&&h.jp(g,k,y,!0),p&&p.jp(g,k,y,!1),o=x.x+Wt(x),i=x.y+zt(x),a=A.lt-o-w,s=A.ot-i-T,l=S.x+Wt(S),u=S.y+zt(S),c=a*R,f=s*R,o*=M,i*=N,a*=M,s*=N,l*=M,u*=N,c*=M,f*=N,r.Bn.Cn(k,1,1),k.drawImage(E,o,i,a,s,l,u,c,f),C>0&&(o=A.lt-w,i=x.y+zt(x),a=A.js+w,s=A.ot-i-T,l=I.lt-w,u=S.y+zt(S),c=I.js+w,f=s*R,o*=M,i*=N,a*=M,s*=N,l*=M,u*=N,c*=M,f*=N,k.drawImage(E,o,i,a,s,l,u,c,f)),b>0&&(o=x.x+Wt(x),i=A.ot-T,a=A.lt-o-w,s=A.gs+T,l=S.x+Wt(S),u=I.ot-T,c=a*R,f=I.gs+T,o*=M,i*=N,a*=M,s*=N,l*=M,u*=N,c*=M,f*=N,k.drawImage(E,o,i,a,s,l,u,c,f)),C>0&&b>0&&(o=A.lt-w,i=A.ot-T,a=A.js+w,s=A.gs+T,l=I.lt-w,u=I.ot-T,c=I.js+w,f=I.gs+T,o*=M,i*=N,a*=M,s*=N,l*=M,u*=N,c*=M,f*=N,k.drawImage(E,o,i,a,s,l,u,c,f)),r.Bn.Cn(k,M,N),k.restore()},t.prototype.OP=function(){var t=this.kj,e=t.zoom(),n=t.yl.vI();n&&this.JP(n.canvas,t.am(),he(t),e)},t.prototype.PP=function(t){var e,n,o,i,a,s,l=this,u=l.kj;if(u.endEdit()&&(e=ie(t,l.MP),n=u.zoom(),o=u.name(),n!==e)){if(i={sheet:u,sheetName:o,oldZoomFactor:n,newZoomFactor:e,cancel:!1},u.Wq(r.Events.ViewZooming,i),i&&!0===i.cancel)return;e=i.newZoomFactor,u.XSa(e),u.Wq(r.Events.UserZooming,{sheet:u,sheetName:o,oldZoomFactor:n,newZoomFactor:e}),u.Wq(r.Events.ViewZoomed,{sheet:u,sheetName:o,oldZoomFactor:n,newZoomFactor:e}),u.invalidateLayout(),(s=(a=u.yl).bm())&&l.NP(s.canvas,e,a.zI(!1)),u.QP&&u.QP(y,e),u.RP&&u.RP(y)}},t.prototype.SP=function(t){var e,n=this.kj,o=n.name(),i=ie(t,this.MP),a=n.zoom();if(i!==a){if(e={sheet:n,sheetName:o,oldZoomFactor:a,newZoomFactor:i,cancel:!1},n.Wq(r.Events.ViewZooming,e),e&&!0===e.cancel)return;i=e.newZoomFactor,n.XSa(i),n.Wq(r.Events.UserZooming,{sheet:n,sheetName:o,oldZoomFactor:a,newZoomFactor:i}),n.Wq(r.Events.ViewZoomed,{sheet:n,sheetName:o,oldZoomFactor:a,newZoomFactor:i})}n.oq=!0,n.jq=!0,n.$p()},t}(),e.TP=vt,Ct=200,bt=function(){function t(t){this.kj=t}return t.prototype.VP=function(t){this.kj.eCb=t},t.prototype.WP=function(t){this.kj.cCb=t},t.prototype.XP=function(){this.kj.invalidateLayout()},t.prototype.ju=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,w,T=this,x=T.kj,S=x.options,A=function(t,e,n){var o,r,i=n,a=0,s=0,l=t.ss,u=t.am().qt,c=t.jt(1).findRow(i);if(c)if(e>0){for(o=t.Rt(-1),a=u-c.y;i>o&&a<e;)i--,a+=l.Sl(i);s=e-a}else if(e<0){for(r=t.ns(),a=-(c.y+zt(c)-u);i<r&&a>e;)i++,a-=l.Sl(i);s=e-a}return{cj:i,UP:s}}(x,t,x.lq),I=A.cj,R=A.UP;if(x.lq=I,x.Xq>0)return!1;if(r=x.Dr(),a=(i=x.am()).qt,s=i.jr,l=r?r.x:i.x,u=Wt(i),u+=(p=S.sheetAreaOffset).left,t<0)T.YP=0,T.ZP=0,d=void 0,g=void 0,(m=x.jt(1))&&m.length>0&&(d=m.findRow(I)),d&&((g=m[m.length-1]).row>=I&&(c=2+p.top,f=a+C(t),(h=b(a+s,g.y+zt(g))-f)>=0&&(h-=c,T.WP(R-zt(d)),n.x=l,n.y=f,n.width=u,n.height=h,n.tx=l,n.ty=a,o.x=l,o.y=a+h,o.width=u,o.height=s-h)));else if(t>0){if(y=x.Rt(-1),v=void 0,w=void 0,x.parent&&x.parent.options.scrollByPixel&&R>0&&(t-=R,R=0),I===y&&R>0)if(T.YP>0&&T.ZP>0){if(R=w=ae(v=T.YP+t,Ct),(t=w-T.ZP)<=0)return e;if(e&&w>=20)return!0;T.YP=v,T.ZP=w}else{if(R>=Ct&&(t-=R-199,R=199,t<=0))return e;if(v=se(R,Ct),w=R,e&&w>=20)return!0;T.YP=v,T.ZP=w}else T.YP=0,T.ZP=0;t<s&&(c=2+p.top,f=a,h=s-t,Jt(x)>0&&(h-=1),T.WP(R),n.x=l,n.y=f,n.width=u,n.height=h,n.tx=l,n.ty=f+t,o.x=l,o.y=f,o.width=u,o.height=t+c)}return!1},t.prototype.lu=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,w,T=this,x=T.kj,S=function(t,e,n){var o,r,i=n,a=0,s=0,l=t.ss,u=t.am().pt,c=t.it(1).findCol(i);if(c)if(e>0){for(o=t.Ot(-1),a=u-c.x;i>o&&a<e;)i--,a+=l._m(i);s=e-a}else if(e<0){for(r=t.ps(),a=-(c.x+Wt(c)-u);i<r&&a>e;)i++,a-=l._m(i);s=e-a}return{dj:i,UP:s}}(x,t,x.qq),A=S.dj,I=S.UP;if(x.qq=A,x.Xq>0)return!1;if(r=x.Dr(),a=(i=x.am()).pt,s=i.er,l=r?r.y:i.y,u=zt(i),u+=(g=x.options.sheetAreaOffset).top,t<0)T.$P=0,T._P=0,m=void 0,y=void 0,(v=x.it(1))&&v.length>0&&(m=v.findCol(A)),m&&((y=v[v.length-1]).col>=A&&(c=2+g.left,f=a+C(t),(h=b(a+s,y.x+Wt(y))-f)>=0&&(h-=c,T.VP(I-Wt(m)),n.x=f,n.y=l,n.width=h,n.height=u,n.tx=a,n.ty=l,o.x=a+h,o.y=l,o.width=s-h,o.height=u)));else if(t>0){if(w=x.Ot(-1),x.parent&&x.parent.options.scrollByPixel&&I>0&&(t-=I,I=0),A===w&&I>0)if(T.$P>0&&T._P>0){if(I=d=ae(p=T.$P+t,Ct),(t=d-T._P)<=0)return e;if(e&&d>=20)return!0;T.$P=p,T._P=d}else{if(I>=Ct&&(t-=I-199,I=199,t<=0))return e;if(p=se(I,Ct),d=I,e&&d>=20)return!0;T.$P=p,T._P=d}else T.$P=0,T._P=0;t<s&&(c=2+g.left,f=a,h=s-t,Qt(x)>0&&(h-=1),T.VP(I),n.x=f,n.y=l,n.width=h,n.height=u,n.tx=f+t,n.ty=l,o.x=f,o.y=l,o.width=t+c,o.height=u)}return!1},t.prototype.aQ=function(t,e,n,o){var i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,T,x,S,A,I=this,R=I.kj,k=!0,M=!0,N=R.yl,E=N.bm(),D=0!=(2&n),O=0!=(1&n);if(O||D)return u=R.Dr(),c=R.am(),f=u?u.y:c.y,h=zt(c),p=u?u.x:c.x,d=Wt(c),D&&(a={},i={},k=I.ju(e,o,i,a),N.Ow(i.x,i.y,Wt(i),zt(i),i.tx,i.ty)),O&&(s={},l={},M=I.lu(t,o,s,l),N.Ow(s.x,s.y,Wt(s),zt(s),s.tx,s.ty),D||(a=l)),(g=R.parent)&&!g.options.scrollbarShowMax&&(O&&(R.oq=!0),D&&(R.jq=!0)),I.XP(),m=R.rowOutlines&&!R.rowOutlines.iT()?1:0,y=R.columnOutlines&&!R.columnOutlines.iT()?1:0,O&&D?N._l(E,new r.Rect(a.x,a.y,Wt(a),zt(a)+m),new r.Rect(l.x,l.y,Wt(l)+y,zt(l))):N._l(E,new r.Rect(a.x,a.y,Wt(a)+y,zt(a)+m)),v=new r.Rect(p,f,d,h),(C=R.getSelections())&&C.length>0&&(T=R.getRangeRect(1,1,C[0]),x=w(v.x+v.width,T.x+T.width),S=w(v.y+v.height,T.y+T.height),v.x=b(v.x,T.x),v.y=b(v.y,T.y),v.width=x-v.x+1,v.height=S-v.y+1),N.Pw(E,v),function(t,e){var n,o,i,a,s,l=t.am(),u=t.yl,c=t.options.gridline.color,f=r.Im.Km(0,"gc-columnHeader-normal"),h=f&&f.borderBottomColor,p=u.bm(),d=t.jt(1),g=he(t),m=l.zr,y=Wt(l),v=t.Rt(-1),C=d.findRow(v);C&&(n=l.qt,(o=C.y-n)>0&&(fe(p,c,m,C.y-.5,m+y-g.width,C.y-.5),e&&(0===g.width&&fe(p,c,l.zr-.5,n,l.zr-.5,C.y),fe(p,h,l.kt-.5,n,l.kt-.5,C.y)))),i=t.it(1),n=l.Ar,o=zt(l),a=t.Ot(-1),(s=i.findCol(a))&&(m=l.pt,(y=s.x-m)>0&&(fe(p,c,s.x-.5,n,s.x-.5,n+o-g.height),e&&(0===g.height&&fe(p,c,m,l.Ar-.5,s.x,l.Ar-.5),fe(p,h,m,l.nt-.5,s.x,l.nt-.5))))}(R,!0),function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g=t.am(),m=t.yl,y=t.options.sheetAreaOffset,v=y.left,C=y.top,b=m.zI(!1),w=m.bm(),T=m.vI(),x=t.jt(1),S=he(t),A=g.zr,I=v>=1?1:0,R=C>=1?1:0,k=Wt(g),M=t.Rt(-1),N=x.findRow(M);N&&(n=g.qt,(o=N.y-n-1-R)>0&&(e?(r=g.Br,le(w,i=ce(),A,n,r-1,o+1),le(T,i,A,n,r-1,o+1),le(w,b,A+r,n,k-r-S.width,o),le(T,b,A+r,n,k-r-S.width,o)):(le(w,b,A,n,k,o),le(T,b,A,n,k,o)))),a=t.Rt(Kt(t),!0),(s=x.findRow(a))&&(n=s.y+zt(s),(o=g.ot-n-1-R)>0&&(le(w,b,A,n,k,o),le(T,b,A,n,k,o))),l=t.it(1),n=g.Ar,o=zt(g),u=t.Ot(-1),(c=l.findCol(u))&&(A=g.pt,(k=c.x-A-1-I)>0&&(e?(le(w,h=ue(w,A,n,k+1,(f=g.Cr)-1),A,n,k+1,f-1),le(T,h,A,n,k+1,f-1),le(w,b,A,n+f,k,o-f-S.height),le(T,b,A,n+f,k,o-f-S.height)):(le(w,b,A,n,k,o),le(T,b,A,n,k,o)))),p=t.Ot($t(t),!0),(d=l.findCol(p))&&(A=d.x+Wt(d),(k=g.lt-A-1-I)>0&&(le(w,b,A,n,k,o),le(T,b,A,n,k,o)))}(R,!0),I.bQ(O,D),pe(R,!0),A=R.options.sheetAreaOffset,R.options.rowHeaderVisible||N.B0a(E,new r.Rect(p,f,2,h+A.top)),R.options.colHeaderVisible||N.B0a(E,new r.Rect(p,f,d+A.left,2)),k&&M},t.prototype.bQ=function(t,e){var n,o=this.kj;e&&o.os(),t&&o.qs(),o.mm.Qw(),(n=o.ITa.Ky)&&n.cQ()},t.prototype.dQ=function(t,e,n){function o(t,e,n,o){return T(.75,t/=n)*o*(e?1:-1)}function r(t,e,n){return t=C(t),k(t/=n)/k(.75)*e}var i=this,a=i.kj,s=Ct,l=100,u=r(t,10,s),c=r(e,10,s),f=t,h=e,p=0,d=0,g=!1,m=!1;i.jI=U.setInterval((function(){var r,v,C,b,w;return g&&m?(a.ss.jn(),(r=a.parent)&&!r.options.scrollbarShowMax&&(a.oq=!0,a.jq=!0),a.ss.kn(),a.cCb=0,a.eCb=0,a.$p(),a.qs(),a.os(),Ut(i.jI),void(i.jI=y)):(c+=20,void((u+=20)>l&&c>l?(i.aQ(t-p,e-d,de(g,m),n),g=!0,m=!0):(u>l&&!g&&(i.aQ(t-p,0,1,n),g=!0),c>l&&!m&&(i.aQ(0,e-d,2,n),m=!0),v=o(u,t>0,10,s),C=o(c,e>0,10,s),b=M(f-v),w=M(h-C),i.aQ(b,w,de(g,m),n),f=v,h=C,p+=b,d+=w)))}),20)},t.prototype.qG=function(t){var e=this,n=e.kj,o=n.ss;e.jI&&(o.kn(),Ut(e.jI),e.jI=y),e.$P=0,e._P=0,e.YP=0,e.ZP=0,e.eQ=n.lq,e.fQ=n.qq,t&&o.hn()},t.prototype.NG=function(t,e){var n=this.kj.parent,o=n.options.scrollbarAppearance===r.ScrollbarAppearance.mobile,i=n.St,a=n.Pt,s=n.ku,l=z(t.X+""),u=z(t.Y+""),c=function(t,e){var n=0;return(n|=0!==t?1:0)|(0!==e?2:0)}(l,u);return o&&(0!==u&&(i.Jwa(r.ScrollbarState.show),s.Rdc(!0)),0!==l&&(a.Jwa(r.ScrollbarState.show),s.Rdc(!1))),this.aQ(l,u,c,e)},t.prototype.gQ=function(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d,g,m=this,y=m.kj;return y.parent&&y.parent.options.scrollByPixel?(y.ss.kn(),void y.$p()):(n=(e=y.am()).pt,o=e.qt,r=y.lq,i=y.qq,a=y.it(1),l=y.ps(),u=1,a&&a.length>0&&(s=a.findCol(i),i<l&&s&&s.x+Wt(s)-n<Wt(s)/2?i++:u=-1),c=y.jt(1),h=y.ns(),p=1,c&&c.length>0&&(f=c.findRow(r),r<h&&f&&f.y+zt(f)-o<zt(f)/2?r++:p=-1),d=0,g=0,a&&a.length>0&&(d=n-(s=a.findCol(i)).x),c&&c.length>0&&(g=o-(f=c.findRow(r)).y),r!==m.eQ&&y.mq(r,0,!0),i!==m.fQ&&y.rq(i,0,!0),d*=u,g*=p,void m.dQ(d,g,t))},t}(),wt=function(){function t(t){var e=this;e.KN=!1,e.hQ=new vt(t),e.iQ=new bt(t),e.kj=t}return t.prototype.jQ=function(t){var e=this.kj,n=e.am(),o=n.pt,r=n.qt,i=n.lt,a=n.ot,s=t.rN,l=0,u=this.kQ(s.X,s.Y),c=u.dragInfo,f=u.x,h=u.y;u&&(u.resizeInfo||c&&"corner"===c.side||u.selectionHitInfo)?(l|=2,l|=1):(r<=h&&h<a&&(l|=2),o<=f&&f<i&&(l|=1),l|=96,e.parent&&(l|=12)),t.DO=l},t.prototype.lQ=function(e){var n,o,r,i,a,s,l,u,c,f,h,p,d=this,g={e:e,r:y};if(t.ao(d,"preProcessManipulationStarted",g),!g.r)if(n=e.rN,r=(o=d.kj).parent,i=o.mm,a=o.yl,l=(s=d.kQ(n.X,n.Y)).dragInfo,u=s.selectionHitInfo,o.yt=s,s.resizeInfo){if(!o.endEdit())return;i.fG(s)}else if(l&&"corner"===l.side)i.hG&&i.hG(s);else if(u){if(!o.endEdit())return;c=u.isHeader,f=u.isFirstIndicator,h=u.type,c&&i.ZG(s,!0),p=s.hitTestType,s.hitTestType=h,i.bH(s),s.hitTestType=p,function(t,e,n,o){var r,i,a,s;e||(i=(r=Zt(t))[r.length-1],a=t.Jl,s=t.Kl,n?3===o?(t.Jl=i.row+i.rowCount-1,t.Kl=i.col+i.colCount-1):2===o?(t.Jl=i.row+i.rowCount-1,t.Kl=0):1===o&&(t.Jl=0,t.Kl=i.col+i.colCount-1):3===o?(t.Jl=i.row,t.Kl=i.col):2===o?(t.Jl=i.row,t.Kl=0):1===o&&(t.Jl=0,t.Kl=i.col),ye(t,a,s,t.Jl,t.Kl))}(o,c,f,h),o.mQ=!1,a.DH()}else o.nQ&&(o.nQ().oQ=!1),o.mQ=!1,a.DH(),e.HP>1&&r&&r.options.allowUserZoom?(d.KN=!1,d.hQ.OP()):(d.KN=!0,d.iQ.qG(1===e.HP))},t.prototype.pQ=function(e){var n,o,r,i,a,s,l,u,c,f,h=this,p={e:e,r:y};if(t.ao(h,"preProcessManipulationDelta",p),!p.r&&(n=e.rN,r=(o=h.kj).mm,i=o.yt,a=n.X,s=n.Y,i))if(l=i.dragInfo,u=i.selectionHitInfo,i.resizeInfo)r.$F={e:e,x:a,y:s},r.WG();else if(l&&"corner"===l.side)r.$F={e:e,x:a,y:s},r.CG&&r.CG();else if(u||r.xG){if(u){if(!r.rG||!r.OG)return;if(!0===r.DA)return;c=u.type,r.$F={e:e,x:a,y:s},3===c?r.cH():2===c?r.dH():1===c&&r.eH()}}else h.KN?e.vO=h.iQ.NG(e.fP.sO,e.gP):(f=e.dP.rO,h.hQ.PP(f))},t.prototype.qQ=function(e){var n,o,r,i,a,s=this,l={e:e,r:y};t.ao(s,"preProcessManipulationCompleted",l),l.r||(o=(n=s.kj).mm,n.mQ=!0,i=(r=n.yt).selectionHitInfo,r.resizeInfo?o.YG():r.dragInfo&&o.BG?(o.xH&&o.xH(),n.parent.touchToolStrip.rQ()):i||o.xG?(o.hH(),i&&function(t,e,n,o){var r,i,a,s;e||(i=(r=Zt(t))[r.length-1],a=t.Jl,s=t.Kl,n&&(3===o?(t.Jl=i.row,t.Kl=i.col):2===o?(t.Jl=i.row,t.Kl=0):1===o&&(t.Jl=0,t.Kl=i.col)),ye(t,a,s,t.Jl,t.Kl))}(n,i.isHeader,i.isFirstIndicator,i.type),n.yl.im()):(n.nQ&&(n.nQ().oQ=!0),s.KN?s.iQ.gQ(e.gP):(a=e.dP.rO,s.hQ.SP(a))))},t.prototype.sQ=function(e){var n,o,i,s,l,u,c,f,h,p,d,m,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L=this,B={e:e,r:y};if(t.ao(L,"preProcessTapped",B),B.r)L.kj.repaint();else if(n=e.rN,o=L.kj,i=o.parent,s=!1,o.Uja=v,L.tQ(),o.uQ&&o.uQ(),(l=o.ITa.Ky)&&l.vQ(),u=o.mm,f=(c=L.kQ(n.X,n.Y,!0)).filterButtonHitInfo,h=c.hitTestType,p=c.row,d=c.col,m=c.outlineHitInfo)o.isEditing()||(C=m.what,b=o.rowOutlines,w=o.columnOutlines,"rg"===C||"rgh"===C?b&&b.UL(o,m):"cg"!==C&&"cgh"!==C||w&&w.UL(o,m));else if(o.yt=c,f){if(!o.endEdit())return;(T=f.rowFilter)&&T.openFilterDialog(f)}else if(c.resizeInfo);else if(o.Qs(c.rowViewportIndex<0?-1:p,c.colViewportIndex<0?-1:d)){if(o.wQ&&!u.BG&&i.touchToolStrip.rQ(),x=o.getActiveRowIndex(),S=o.getActiveColumnIndex(),A=c.cellTypeHitInfo){if(I=o.getCellType(A.row,A.col,h),A.sheet||(A.sheet=o),L.Sia(I,A))if(R=A.sheetArea,!a(R)&&3!==R||p===x&&d===S)o.yl.DH();else{if(o.suspendPaint(),!o.endEdit())return;if(k={sheet:o,sheetName:o.name(),row:x,col:S,cancel:!1},o.Wq(r.Events.LeaveCell,k),k&&!0===k.cancel)return;M=o.ITa.getSelections(),N=o.ITa.getSpan(p,d),E=[r.kf(N.row,N.col,N.rowCount,N.colCount)],o.yu(M,E),o.Wq(r.Events.FloatingElementSelected,{type:"worksheet"}),D=A.isReservedLocation&&A.isFocusAware,o.Sr(p,d,v,v,D?0:1),O={sheet:o,sheetName:o.name(),row:p,col:d},o.Wq(r.Events.EnterCell,O),o.Wq(r.Events.FormulatextboxEnterCell,O),o.Au(M),o.Uja=!0,u.cs&&u.cs(p,d),o.resumePaint(),s=!0}I.processCellAndPaddingMouseDown(A),I.XGb(A)}if(A&&A.isReservedLocation)return!0;A&&A.cellButtonHitInfo&&(s=!0),o.Wq(r.Events.CellClick,{sheet:o,sheetName:o.name(),sheetArea:h,row:c.row,col:c.col});try{if(u.mG=c,j=o.isEditing(),F=o.endEdit(),o.CH&&g&&j&&F&&(u.shift=!1),j&&x===o.getActiveRowIndex()&&S===o.getActiveColumnIndex()&&!F)return}finally{u.mG=y}if(a(p)||a(d))return;3===h&&u.cs&&u.cs(p,d),function(t,e,n,o){var r,i,s,l,u,c,f,h,p=!1,d=t.ITa.getSelections();for(r=0,i=d.length;r<i;r++){if(s=d[r],(l=3===o||a(o))&&(s=t.Tq(s)),u=s.row,c=s.col,f=s.rowCount,h=s.colCount,l)p=u<=e&&e<u+f&&c<=n&&n<c+h;else if(2===o)p=-1===c&&u<=e&&e<u+f;else if(1===o)p=-1===u&&c<=n&&n<c+h;else if(0===o)return p;if(p)break}return p}(o,p,d,h)&&!s?L.xQ=U.setTimeout((function(){var t={x:c.x,y:c.y,handled:!1},e=i.touchToolStrip;o.Wq(r.Events.TouchToolStripOpening,t),t.handled||e.open(c.x,c.y-100),L.tQ()}),420):(o.Wq(r.Events.FloatingElementSelected,{type:"worksheet"}),P=o.ITa.getSelections(),u.ZG(c),_=o.ITa.getSelections(),o.yu(P,_),u.hH())}},t.prototype.Sia=function(t,e){return!(t&&t.activedOnClick&&!t.activedOnClick()&&e.isReservedLocation)},t.prototype.yQ=function(e){var n,o,i,a,s,l,u,c,f,h,p,d,g,m,v,C,b=this,w={e:e,r:y};if(t.ao(b,"preProcessDoubleTapped",w),!w.r)if(n=b.kj,o=e.rN,b.tQ(),(s=n.yt)&&(n.Wq(r.Events.CellDoubleClick,{sheet:n,sheetName:n.name(),sheetArea:s.hitTestType,row:s.row,col:s.col}),l=s.resizeInfo))if(u=n.ITa.getSelections(),"sizeRow"===l.action||"sizeHiddenRow"===l.action){if(c=[],n.tp(l.index)){for(i=0;i<u.length;i++)if(-1===(a=u[i]).col)for(a=n.Tq(a),f=0;f<a.rowCount;f++)c.push({row:a.row+f})}else c.push({row:l.index});n.wu().execute({cmd:"autoFitRow",sheetName:n.name(),rows:c,columnHeader:1===l.sheetArea})}else{if(h=[],n.sp(l.index)){for(i=0;i<u.length;i++)if(-1===(a=u[i]).row)for(a=n.Tq(a),p=0;p<a.colCount;p++)h.push({col:a.col+p})}else h.push({col:l.index});n.wu().execute({cmd:"autoFitColumn",sheetName:n.name(),columns:h,rowHeader:2===l.sheetArea})}else!((d=b.kQ(o.X,o.Y,!0))&&d.row>=0&&d.col>=0&&d.rowViewportIndex>=0&&d.colViewportIndex>=0)||d.resizeInfo||n.options.isProtected&&n.tq(d.row,d.col,"locked")||((g=n.isCtrlPressed(d.hitTestType))||n.Tr(),m=n.Er(d.row),v=n.Fr(d.col),C=!0,n.Jl===d.row&&n.Kl===d.col||(C=!1),n.Kr(d.row,d.col,m,v,C),g?n.$p():n.addSelection(d.row,d.col,1,1),n.mm.dI(!1,!0),n.EF(n.Ws(),d.row,d.col))},t.prototype.zQ=function(t){var e,n=this,o=n.kj,r=t.rN,i=n.kQ(r.X,r.Y);o.isEditing()?i.row===o.Jl&&i.col===o.Kl||o.mm.cI(i):(n._target=i,(e=n.kQ(r.X,r.Y,!0))&&e.cellTypeHitInfo&&e.cellTypeHitInfo.isEditting||o.mm.cI(e))},t.prototype.AQ=function(t){var e,n,o,r,i=this.kj;i.isEditing()||(n=!0,(e=this._target)&&((o=e.cellTypeHitInfo)&&o.isReservedLocation?n=!1:(r=i.getCellType(e.row,e.col))&&r.isEditting()&&(n=!1)),n&&i.mm.dI(!0))},t.prototype.kQ=function(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,C,b=this.kj;return b.am(),o={x:t,y:e,rowViewportIndex:y,colViewportIndex:y,row:-1,col:-1,resizeInfo:y,hitTestType:y,outlineHitInfo:y,filterButtonHitInfo:y,dragInfo:y,cellTypeHitInfo:y,selectionHitInfo:y},r=b.rowOutlines,i=b.columnOutlines,r&&(a=r.hitTest(b,t,e)),!a&&i&&(a=i.hitTest(b,t,e)),a?o.outlineHitInfo=a:(void 0,void 0,s=b.nr(e),l=b.or(t),o.rowViewportIndex=s,o.colViewportIndex=l,o.row=b.pr(e,s),o.col=b.qr(t,l),s>=0&&s<=2&&l>=0&&((u=b.rr(s,l,v,o.row,o.col))&&(o.row=u.row,o.col=u.col)),o.hitTestType=b.sr(s,l),void 0,f=void 0,h=void 0,p=void 0,d=void 0,c=function(t,e,n,o,r){var i,a,s,l,u,c=t.parent,f=t.mm,h=t.options,p=e.rowViewportIndex,d=e.colViewportIndex,g=Zt(t),m=y;return t.CH&&g.length>0&&(a=(i=g[g.length-1]).row,s=i.row+i.rowCount-1,l=i.col,u=i.col+i.colCount-1,c&&!c.options.allowUserResize||(-1!==a&&-1===l&&p>=0&&d<0&&h.rowHeaderVisible?!(m=f.mH(t,e,r,2,o))||"sizeRow"!==m.action&&"sizeHiddenRow"!==m.action||2!==m.sheetArea||m.index===s||(m=y):-1===a&&-1!==l&&p<0&&d>=0&&h.colHeaderVisible&&(!(m=f.oH(t,e,r,1,n))||"sizeCol"!==m.action&&"sizeHiddenCol"!==m.action||1!==m.sheetArea||m.index===u||(m=y)))),m}(b,o,t,e,10),(p=(h=b.xr)&&h.hitTest(o,t,e))||(p=(C=(m=(g=b.tables)&&g.find(o.row,o.col))&&m.xr)&&C.hitTest(o,t,e)),b.wQ?(f=me(b,o,t,e),o.dragInfo=f):c?o.resizeInfo=c:p?o.filterButtonHitInfo=p:n?o.cellTypeHitInfo=b.yr(o,t,e):(d=ge(b,o,t,e),o.selectionHitInfo=d)),o},t.prototype.tQ=function(){var t=this.xQ;t&&(clearTimeout(t),this.xQ=y)},t}(),e.TouchEventHandler=wt,r.Zn(wt),Tt=function(){function t(t,e,n){var o=this;o.BQ=n,o.yM=new Ft(e),o.CQ=new wt(e),o.DQ=new Pt(t,"sheet",o.yM,100,10),o.BQ.xN(o.DQ,!0)}return t.prototype.EQ=function(){var t=this.CQ,e=this.DQ;e.dN=function(e){return t.jQ(e)},e.eN=function(e){return t.lQ(e)},e.fN=function(e){return t.pQ(e)},e.hN=function(e){return t.qQ(e)},e.iN=function(e){return t.sQ(e)},e.jN=function(e){return t.yQ(e)},e.GM=function(e){return t.zQ(e)},e.IM=function(e){return t.AQ(e)}},t.prototype.FQ=function(){var t=this,e=t.DQ;e&&(t.BQ.xN(e,!1),e.dN=y,e.eN=y,e.fN=y,e.gN=y,e.hN=y,e.iN=y,e.jN=y,e.kN=y,e.GM=y,e.IM=y,t.DQ=y)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),xt="gc-toolstrip-button",St="gc-toolstrip-text",At="gc-toolstrip-image",It="gc-toolstrip-item",Rt="gc-touch-sperate-line",kt="height",Mt="width",Nt="px",Et="button",Dt=function(t){function e(e,n){var o,i=t.call(this,n,r.Ul.vl(e.qo))||this,a=i;return a.JQ=32,a.KQ=45,a.LQ={},a.MQ=!1,a.OC=e,o=a.yo(),a.NQ=o,o.addClass("gc-toolstrip-default ui-state-default well"),o.appendTo(a.zo()),o.hide(),a.OQ(),a.PQ(),a.QQ(),i}return Vt(e,t),e.prototype.open=function(t,e){var n,o,i,a=this;if(Xt(a.OC)&&(r.Vl.Zl(y,!0),a.NQ.css({left:t,top:e}),a.Ao(),a.MQ=!0,a.Do(),!u(a.LQ)))for(o in n=a.LQ)n.hasOwnProperty(o)&&(!(i=n[o]).RQ||i.RQ.call(a)?l("#"+o).show():l("#"+o).hide())},e.prototype.add=function(t){var e,n,o,r;t&&(n=(e=this).LQ,t instanceof jt?(o=t.name())&&(n[o]=t,e.SQ(t.TQ(Rt,e.KQ+Nt))):t instanceof Ot&&(r=t.name(),e.getItem(r)||(n[r]=t,e.SQ(t.TQ(At,e.JQ+Nt,St,xt)))))},e.prototype.getItem=function(t){return this.LQ[t]},e.prototype.getItems=function(){var t,e=[],n=this.LQ;if(!u(n)){for(t in n)n.hasOwnProperty(t)&&e.push(n[t]);return e}return y},e.prototype.remove=function(t){var e,n=this;return n.getItem(t)?(l("#"+t).parent().remove(),e=n.LQ[t],delete n.LQ[t],e):y},e.prototype.clear=function(){var t=this;t.NQ&&(t.NQ.find("td."+It).remove(),t.LQ={})},e.prototype.close=function(){var t,e,n=this;Y.Hm(),n.NQ&&n.NQ.hide(),n.MQ=!1,n.Eo(),(t=Xt(n.OC))&&(t.zt(),(e=Zt(t)).length>0&&!t.wQ&&-1===e[0].row&&-1===e[0].col&&t.Tr())},e.prototype.imageAreaHeight=function(t){var e=this;return 0===arguments.length?e.JQ:(t>0&&(e.JQ=t,e.NQ.find("span."+At).css(kt,t+Nt)),e)},e.prototype.itemHeight=function(t){var e=this,n=e.NQ.find("button."+xt);return 0===arguments.length?W(n.css(kt)):(t>0&&n.css(kt,t+Nt),e)},e.prototype.itemWidth=function(t){var e,n=this,o=n.NQ.find("button."+xt);return 0===arguments.length?W(o.css(Mt)):(t>0&&(e="min-width",W(o.css(e))>t&&o.css(e,t+Nt),o.css(Mt,t+Nt)),n)},e.prototype.separatorHeight=function(t){var e=this;return 0===arguments.length?e.KQ:(t>0&&(e.KQ=t,e.NQ.find("div."+Rt).css(kt,t+Nt)),e)},e.prototype.OQ=function(){var t="table",e=l(c(t)).css({padding:0,display:t}).attr({cellspacing:0,cellpadding:0});this.UQ=l(c("tr")).appendTo(e),e.appendTo(this.NQ)},e.prototype.no=function(){var t=this,e=t.NQ;e&&(t.MQ&&Y.Hm(),e.unbind("click"),e.remove(),t.Eo(),t.NQ=y)},e.prototype.QQ=function(){var t=this;t.NQ.bind("click",(function(e){var n,o,r,i=e.target;i.tagName.toLowerCase()===Et?n=i.id:(o=i.parentElement)&&o.tagName.toLowerCase()===Et&&(n=o.id),r=t.LQ[n],n&&r&&r.VQ.call(t)}))},e.prototype.SQ=function(t){this.NQ&&t&&l(c("td")).append(t).appendTo(this.UQ).addClass(It)},e.prototype.PQ=function(){var t,e,n,o,r,i,a;function s(t){for(var e=0,n=t+e;q.getElementById(n);)n=t+ ++e;return n}n=this,o=(e={0:X+(t="gAAAAYCAYAAADgdz34AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAA")+"A8ElEQVRIS92VwQ3CMAxFe+qZERiHY8dgDI4cYYNOhDhwY4ayQviW4q/Eddu0KRe+9CQ72P8rEpAmhPBT3ENLd76EiPv5HO5hSmK+KYTFsz+04A4G9NZ0hAizn7jTos2MFRYYugFZQlscoFzRZsYKCwwNulAqnZddtJmxwiIZ3oT6WFh4S2tQHwsLb2kN6mNh4S2tQX0sLLwly4IyY4WFZ2gReV/ZhBOQH2ddgKcYwBAc7R/weL0ZgqO6gGPXE1E0JlBdwJx2CUhvkCL63xvw33QKUc0N+B5MIaq5gb5o8kotBszJDShFlkvQ+ZHBvoTmC+fiVfoq/m86"+Z,1:X+t+"BkklEQVRIS7WTUXECQRBEcYCFOIiESAAH/OYPCcQBEogDJCABCUhAwqXf1QzVM0cojko+Xt3ObG/33t7eYhiGf6UU68+vneD5Mu4HpZDgKja+YCYH94NSSHAUg3glZC9k8zgAYwLmhuS6o/tBKUJ8CTGsoveIsin3g1LEAkxzAd/kXbihwxwatGys+EEpEAT5LR6FuDmMb+t+UAoEwVL44h7CvB8lGxrn3A9KkaLAj8pDMD9HL/v0ZgfAQfSAk/WgXAT3g1K4MPCj2AoPhNvRJO4HpejigF1jxtjNy9Ek7gel6GIjfzoP+Ihewf2gFPcWNNL817/c/aAUKXpbfy/FXlzFIM6gOYy3Gp+iz/xBPHeLQGLAMI2PNmYOw1uojZfdCyYNCXexiGcGpiljdp9hsBGjvnvBpCHhRbgBZChjAgj0eXrX7gWThoR992lAMGOOLMfJuIHuBZMGQuE75KN66Cpq14xH2L1g0kixyLNm3I8sNbwJulHfvWDSkJArmou4hlxXeh4AvBEBuZnnbtHfMix+AHqkr6wgQ4Q7"+Z,2:X+t+"A3UlEQVRIS72PwQ3CMAxFOwrjcOyZCTgyAjfWYCJO3JiCCVL/iFSO9W0MDTzpqYob+ztTKeWn0uJIadE6H8/ljXsR96q6tzt4YogH/olPcQ2R8mp3CHRBwO3+6EKkvNodcDkSgyyoAx0iRz/AA/8Op0sdtJuv1Va3Ct8FYHgL8dgUAGxIe41+kRAH6CbdaGW86nFAhnaXLSLEAbqJCbxlUgEZ2DIgFaCbmMBbJhWQgS0DUgG6iQm8ZVIBGTYFsK21oN3F1yrEARnsIM/u8JeAT9S9nrQ4UlocKS2Os0wLtkPMdu9POt0AAAAASUVORK5CYII=",3:X+"UAAAAXCAIAAABrvZPKAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2+oZAAAAIdJREFUOE/tzEEKgCAQheEOWLdx351adYc8Qgs3rbuAUC9nkkF0BKNN9CMy0Xx25llf8Edr7d57j/tlP4wTHf4W/b7gsT0vLs7Sz9bFWfM9nrDXE9ITphlVPO512wkkM++FNF86vBfKeKR43rjLe5QwOvxPVPSoipHmkY5RxSMFo7rXY9+eMSdet07b6c/bnwAAAABJRU5ErkJggg=="})[0],r=e[1],i=e[2],a=e[3],n.WQ=new Ot(s("wijspread_toolstrip_paste"),J().ToolStrip_PasteText,o,n.XQ),n.YQ=new Ot(s("wijspread_toolstrip_cut"),J().ToolStrip_CutText,r,n.ZQ),n.$Q=new Ot(s("wijspread_toolstrip_copy"),J().ToolStrip_CopyText,i,n._Q),n.aR=new Ot(s("wijspread_toolstrip_autofill"),J().ToolStrip_AutoFillText,a,n.bR,n.cR),n.add(n.WQ),n.add(n.YQ),n.add(n.$Q),n.add(new jt(n.cR)),n.add(n.aR)},e.prototype.cR=function(){var t,e,n,o=Xt(this.OC);if(!o)return!1;for(t=Zt(o),e=0;e<t.length;e++)if(-1===(n=t[e]).row&&-1===n.col)return!1;return!0},e.prototype.bR=function(){var t;this.close(),(t=Xt(this.OC))&&(Zt(t).length<=1&&(t.wQ=!0,t.yl.im()))},e.prototype.rQ=function(){var t=Xt(this.OC);t&&(t.wQ=!1,t.yl.im())},e.prototype._Q=function(){var t=Xt(this.OC);t&&(this.dR=t.ux(!0)),this.close()},e.prototype.ZQ=function(){var t=Xt(this.OC);t&&(this.dR=t.sx(!0)),this.close()},e.prototype.XQ=function(){var t=this,e=t.dR,n=Xt(t.OC);n&&!a(e)&&n.vx({pasteHtml:e.copyHtml,pasteText:e.copyText}),t.close()},e.prototype.eR=function(){var t=this,e="span."+St;l("#"+t.WQ.Cj).find(e).text(J().ToolStrip_PasteText),l("#"+t.YQ.Cj).find(e).text(J().ToolStrip_CutText),l("#"+t.$Q.Cj).find(e).text(J().ToolStrip_CopyText),l("#"+t.aR.Cj).find(e).text(J().ToolStrip_AutoFillText)},e}(s),e.TouchToolStrip=Dt,Ot=function(){function t(t,e,n,o,r){this._font="normal 12px Arial";var i=this;i.Cj=t,i._text=e,i.fR=n,o&&(i.VQ=o),r&&(i.RQ=r)}return t.prototype.name=function(t){var e=this;return 0===arguments.length?e.Cj:(l("#"+e.Cj).attr("id",t),l("#"+e.Cj+"Text").attr("id",t+"Text"),l("#"+e.Cj+"Image").attr("id",t+"Image"),e.Cj=t,e)},t.prototype.text=function(t){var e=this;return 0===arguments.length?e._text:(e._text=t,l("#"+e.name()+"Text").text(t),e)},t.prototype.font=function(t){var e=this,n=l("#"+e.name()+"Text");return 0===arguments.length?e._font:(e._font=t,n.css("font",t),e)},t.prototype.foreColor=function(t){var e=this,n=l("#"+e.name()+"Text");return 0===arguments.length?e.Nra?e.Nra:n.css("color"):(n.css("color",t),e)},t.prototype.image=function(t){var e=this;return 0===arguments.length?e.fR:(e.fR=t,l("#"+e.name()+"Image").css("background-image","url("+t+")"),e)},t.prototype.TQ=function(t,e,n,o){var r,i,a,s,u=this,f=u.name(),h=u.font(),p=u.text(),d=l(c("span"));return d.attr("id",f+"Image"),d.addClass(t),d.css({"background-image":"url("+u.image()+")","background-repeat":"no-repeat",display:"block",height:e,"background-position-x":"50%"}),(r=l(c("span"))).attr("id",f+"Text"),r.addClass(n),r.css("font",h),r.text(p),(i=function(t,e,n){var o,r=c("span"),i=q.body;return r.className=n,r.style.font=t,r.style.cssFloat="left",r.textContent=e,i.insertBefore(r,y),o=l(r).width(),i.removeChild(r),o}(h,p,n))>(a=60)&&(a=i),(s=l(c(Et))).attr("type",Et),s.attr("id",f),s.addClass(o+" gc-toolstrip-button-style ui-state-default ui-widget btn btn-default"),s.css({"box-sizing":"content-box",border:"0px",padding:"4px",margin:"3px",width:a+Nt}),s.append(d),s.append(r),s[0]},t}(),e.TouchToolStripItem=Ot,jt=function(){function t(t){this.Cj=function(){for(var t="separator",e=0,n=t+""+e;q.getElementById(n);)n=t+""+ ++e;return n}(),t&&(this.RQ=t)}return t.prototype.name=function(){return this.Cj},t.prototype.TQ=function(t,e){var n=l(c("div"));return n.attr("id",this.name()),n.addClass(t),n.css({width:"1px",height:e,display:"inline-block;","background-color":"#CCC","margin-left":"5px","margin-right":"5px",opacity:.6}),n[0]},t}(),e.TouchToolStripSeparator=jt,Ft=function(){function t(t){this.tc=t}return t.prototype.oN=function(){this.gR=2,this.tc.CH=!0},t.prototype.zM=function(){this.gR=0,this.hR=qt()},t.prototype.nN=function(){return 1===this.gR},t.prototype.uN=function(){return 1===this.gR},t.prototype.sN=function(){return 1===this.gR},t.prototype.GQ=function(){var t=this;if(2===t.gR)return!0;if(t.hR){if(qt()-t.hR<=200)return t.iR++,!0;t.hR=0,t.iR=0,t.gR=1}else t.gR=1;return t.tc.CH=!1,!1},t.prototype.HQ=function(){var t=this;return t.iR?(t.iR--,!0):2===t.gR||(t.gR=0,!1)},t.prototype.IQ=function(){return 2===this.gR},t}(),e.jR=Ft,Pt=function(t,e,n,o,r){var i=this;i.KM=t,i.lN=n,i.OM=e,i.mN=o,i.aN=r},e.kR=Pt,_t=function(){function t(){}return t.prototype.lR=function(t,e){var n,o,r=t,i=r.touches,s=r.targetTouches,l=r.changedTouches;!1!==r.isPrimary&&(i&&i.length>=1&&s&&s.length>=1&&(i[0].clientX!==s[0].clientX||i[0].clientY!==s[0].clientY)||(f(t),n=a(l)?r:l[0],(o=q.createEvent("MouseEvents")).initMouseEvent(e,!0,!0,U,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,y),t.target.dispatchEvent(o)))},t.prototype.NM=function(t){var e,n=t.pointerType;if(!n||n===t[H]||n===N){if((e=t.data).mR)return;e.mR=!0,e.nR=!1,e.lR(t,"mouseover"),e.lR(t,"mousemove"),e.lR(t,"mousedown")}},t.prototype.aB=function(t){var e,n=t.pointerType;if(!n||n===t[H]||n===N){if(!(e=t.data).mR)return;e.nR=!0,e.lR(t,"mousemove")}},t.prototype.RM=function(t){var e,n=t.pointerType;if(!n||n===t[H]||n===N){if(!(e=t.data).mR)return;e.lR(t,"mouseup"),e.lR(t,"mouseout"),e.nR||e.lR(t,"click"),e.mR=!1}},t.prototype.oR=function(t,e,n){var o,i,s,u,c,f,h,p,d,g,m,y=this;"."!==n.charAt(0)&&(n="."+n),o=D+n,i=O+n,s=j+n,u=F+n,c=P+n,f=_+n,h=L+n,p=B+n,d=G+n,g=r.Ul._Va(),e?g?(m=t.style,a(m.msTouchAction)||(m.msTouchAction=E),a(m.touchAction)||(m.touchAction=E),l(t).bind(o,y,y.NM).bind(u,y,y.NM),l(q).bind(i,y,y.aB).bind(c,y,y.aB).bind(s,y,y.RM).bind(f,y,y.RM)):l(t).bind(h,y,y.NM).bind(p,y,y.aB).bind(d,y,y.RM):g?(l(t).unbind(o).unbind(u),l(q).unbind(i).unbind(c).unbind(s).unbind(f)):l(t).unbind(h).unbind(p).unbind(d)},t}(),e.pR=_t,Lt="newSheet",Bt=function(){function t(t){this.hq=t}return t.prototype.lQ=function(t){var e,n,o,i,a,s,l,u,c=this,f=t.rN,h=c.hq,p=Xt(h.OC);h.FD&&h.GD(p,!1),"resize"===(e=h.hitTest(f.X,f.Y).element)?(h.HD=!0,h.ID=f.X):"tab"!==e&&e!==Lt&&""!==e||(n=h.Xs,o=r.En.Nn(n),i=r.En.On(n),s=(a=c.IP(o,i)).getContext("2d"),l=r.En.Ln(a),u=r.En.Mn(a),r.Bn.Cn(s,1,1),s.drawImage(n,0,0,Wt(a),zt(a),0,0,Wt(a),zt(a)),r.Bn.Cn(s,l,u),c.Xs=a,c.qR=h.gq,c.rR=h.VC(),c.sR=h.UC(),c.KC=h.TC(),h.SC=!0),c.tR=h.jw(-1),c.uR=h.rD(h.sD())},t.prototype.pQ=function(t){var e,n,o,i,s,l,u,c,f,h,p,d,g,m,y,v,b,w,T,x,S,A,I,R,k,M,N=this,E=t.rN.X,D=N.hq;if(D.HD)e=E-D.ID,o=(n=D.OC).options,i=n.xs.clientWidth,o.tabStripRatio=n.Iv()+e/i,s=D.kw/i,1,n.Iv()<s?(o.tabStripRatio=s,D.ID=D.kw):n.Iv()>=1?(o.tabStripRatio=1,D.ID=i):D.ID=E;else{if(l=N.Xs,u=N.qR,!l||a(u))return;c=N.tR,f=N.uR,h=N.KC,p=N.rR,d=N.sR,g=t.dP.sO.X,m=N.vR(g,u),D.gq=m.gq,y=m.Vo,(g>0&&u===c&&D.gq===c||g<0&&u===f&&D.gq===f)&&(y=0),g>0&&g>y+h?g=y+h:g<0&&g<y-h&&(g=y-h),0!==g&&(b=(v=D.Xs).getContext("2d"),w=r.En.Ln(v),T=r.En.Mn(v),b.save(),b.clearRect(0,0,r.En.Nn(v),r.En.On(v)),x=D.Dr(),D.dD(b,x),S=void 0,0,A=void 0,I=zt(x),R=void 0,k=void 0,g>0?((A=d-(R=(S=p)+g))>0&&(r.Bn.Cn(b,1,1),b.drawImage(l,S*w,0,A*w,I*T,R*w,0,A*w,I*T),r.Bn.Cn(b,w,T)),k=g-y,d-p<=g&&(k=0),S=p,(A=y)>0&&(r.Bn.Dn(b,k,0),D.iE(b,new r.Rect(S,0,A,I)),r.Bn.Dn(b,-k,0))):g<0&&((A=d-(S=(R=p)+C(g)))>0&&(r.Bn.Cn(b,1,1),b.drawImage(l,S*w,0,A*w,I*T,R*w,0,A*w,I*T),r.Bn.Cn(b,w,T)),k=g-y,d-p<=C(g)&&(k=0),S=d-(A=C(y)),A>0&&(r.Bn.Dn(b,k,0),D.iE(b,new r.Rect(S,0,A,I)),r.Bn.Dn(b,-k,0))),r.Bn.Cn(b,1,1),S=0,A=p,b.drawImage(l,S*w,0,A*w,I*T,S*w,0,A*w,I*T),M=r.Im.Lm(""),z(M.zIndex)>2007&&(S=d,A=x.x+Wt(x)-D.kw-S,b.drawImage(l,S*w,0,A*w,I*T,S*w,0,A*w,I*T)),S=Wt(x)-D.kw,A=D.kw,b.drawImage(l,S*w,0,A*w,I*T,S*w,0,A*w,I*T),r.Bn.Cn(b,w,T),b.restore())}},t.prototype.qQ=function(t){var e=this.hq;e.HD?(e.HD=!1,e.OC.aq()):(e.SC=v,e.repaint())},t.prototype.sQ=function(t){var e,n,o,r,i=this.hq,a=i.OC,s=t.rN,l=Xt(a);i.FD&&i.GD(l,!1),e=["first","prevArrow","nextArrow","last","","prevButton","nextButton"],o=(n=i.hitTest(s.X,s.Y)).element,a.mv=!0;try{e.indexOf(o)>=0?i.JD(n.index,!0):"tab"===o?i.KD(n.index,n.position):o===Lt&&i.MD(n.position)}finally{a.mv=!1,(r=Xt(a))!==l&&(r.CH=!0,r.zt())}},t.prototype.yQ=function(t){return this.hq.cE(t.rN.X,t.rN.Y)},t.prototype.IP=function(t,e){var n=this.Xs;return n?t===r.En.Nn(n)&&e===r.En.On(n)||r.En.Pn(n,t,e):(n=c("canvas"),r.En.Kn(n,this.hq.OC),r.En.Pn(n,t,e)),n},t.prototype.vR=function(t,e){var n=this,o=n.hq.WC,r=n.tR,i=n.uR,a=e,s=0;if(t>0){for(;a>=r&&!(s>t);)s+=o[a],a--;a<r&&(a=r)}else if(t<0&&-1!==i){for(;a<=i&&!(s<t);)s-=o[a],a++;a>i&&(a=i)}return{gq:a,Vo:s}},t}(),Gt=function(){function t(t,e,n){var o,r,i=this;i.yM=new Ft(i),i.DQ=new Pt(t,"tabStrip",i.yM,1,-1),i.BQ=n,i.CQ=new Bt(e),o=i.CQ,(r=i.DQ).eN=function(t){return o.lQ(t)},r.fN=function(t){return o.pQ(t)},r.hN=function(t){return o.qQ(t)},r.iN=function(t){return o.sQ(t)},r.jN=function(t){return o.yQ(t)}}return t.prototype.EQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!0)},t.prototype.FQ=function(){var t=this.BQ;t&&t.xN(this.DQ,!1)},t.prototype.GQ=function(t){return this.yM.GQ()},t.prototype.HQ=function(t){return this.yM.HQ()},t.prototype.IQ=function(t){return this.yM.IQ()},t}(),r.oJ.prototype.DH=function(){var t=this.kj,e=Zt(t),n=e.length;t.Xq<=0&&n>0&&this.im(e[n-1],v,v,!0)},r.Worksheet.$n(N,{init:function(){this.wQ=!1,this.mQ=!0},setHost:function(t){var e=this,n=e.parent,o=n&&n.BQ||new $,r=new Tt(t[0],e,o);r.EQ(),e.wR=r},dispose:function(t){var e=this;e.wR&&e.wR.FQ(),!1!==t.clearCache&&(e.wR=y)},startEdit:function(){this.yl.DH()},paintAdornment:function(t){var e=this,n=t.ctx;e.CH&&(e.options.isProtected||function(t,e){var n,o,i,a,s,l,u,c,f,h,p,d,g,m=t.am(),y=16,v=Zt(t);t.CH&&v.length>0&&(l=(s=v[v.length-1]).row,u=s.row+s.rowCount-1,c=s.col,f=s.col+s.colCount-1,p="AAAAAQCAYAAAAf8/9hAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAAJcEhZcwAADs",(h=t.parent)&&!h.options.allowUserResize||(-1!==l&&-1===c&&t.getRowResizable(u)?(d=t.Er(u),n=X+p+"MAAA7DAcdvqGQAAABaSURBVDhPY/z//z8DLsDIyAiWBKphBAtgAUxQGgPANIMAMhsdYDUAmwZchtDOC8SCgTcA5DfcgUAEoNwFo7GAPQxwJVtsYYHVBdgU4gpInF5A1oBLMwMDAwMApuAtD6Z7YxQAAAAASUVORK5CYII=",o=t.getCellRect(u,$t(t,2)-1,d,-1),(a=m.fm(d)).y<=o.y&&o.y+zt(o)<=a.y+zt(a)&&(i=new r.Rect(m.kt-y,o.y+zt(o)-8,y,y))):-1===l&&-1!==c&&t.getColumnResizable(f)&&(g=t.Fr(f),n=X+p+"IAAA7CARUoSoAAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjEwMPRyoQAAAE1JREFUOE/ljtEKACAIA/v/nzZ9mFhsJPRocLEuGS4zk/iJyyP/D6gE0wrYoCqoLoUafPl8fEBln3ulSscfErk65TMjMFRBhUowosDWBoHpba8+C7w0"+Z,o=t.getCellRect(Kt(t,1)-1,f,-1,g),(a=m.gm(g)).x<=o.x&&o.x+Wt(o)<=a.x+Wt(a)&&(i=new r.Rect(o.x+Wt(o)-8,m.nt-y,y,y))),n&&i&&ve(t,n,e,i)))}(e,n),e.wQ?function(t,e){var n=Ce(t);n&&(X+"EAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1"+Z,ve(t,"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAATCAIAAAD5x3GmAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAOwwAADsMBx2 + oZAAAAGhJREFUOE / djkEOwCAIBHk6P98u1lKo1diEU + dggOyAAkC + YPl / Onx3WDmiytm4aulQoKba + 4uiO77YhHDH5SqnRa0If / Nhq0fnjPob2h5oVXJI0rJA3h1ya1kgU4f4nQfVzozk7APgAIEqATZbalz1AAAAAElFTkSuQmCC",e,n))}(e,n):function(t,e,n){var o,i,a,s;if(r.needPaintSelection(t)){if(t.isEditing()||!e||0===t.selectionPolicy())return;if(a=void 0,(i=(o=Te(t)).length)>0){for(n.save(),n.fillStyle=t.m_a()||"white",n.strokeStyle=t.getSelectionBorderColor(),s=0;s<i;s++)(a=o[s])&&(n.beginPath(),n.arc(a.x+Wt(a)/2,a.y+zt(a)/2,Wt(a)/2,0,2*Math.PI,!1),n.fill(),n.stroke());n.restore()}}}(e,e.mQ,n))},preProcessMouseDown:function(t){var e=t.e,n=this.wR;(m||n.GQ(e))&&(f(e),t.r=!0)},preProcessMouseMove:function(t){var e=t.e,n=this.wR;(m||n.IQ(e))&&(f(e),t.r=!0)},preProcessMouseUp:function(t){var e=t.e,n=this.wR;(m||n.HQ(e))&&(f(e),t.r=!0)},preProcessMouseDbClick:function(t){(m||this.CH)&&(t.r=!0)},preProcessMouseOut:function(t){m&&(t.r=!0)},preProcessMouseWheel:function(t){m&&(t.r=!0)}}),r.Workbook.$n(N,{init:function(){this.BQ=new $},setHost:function(){var t=this;t.touchToolStrip=new Dt(t,t.xv())},dispose:function(){var t=this,e=t.BQ,n=t.touchToolStrip;e&&e.no(),n&&(n.no(),t.touchToolStrip=y)},onCultureChanged:function(){var t=this.touchToolStrip;t&&t.eR()}}),r.DC.$n(N,{setHost:function(){var t=this,e=new Gt(t.Xs,t,t.OC.BQ);e.EQ(),t.wR=e},dispose:function(){var t=this.wR;t&&(t.FQ(),this.wR=y)},preProcessMouseDown:function(t){var e=this.wR,n=t.e;(m||e.GQ(n))&&(f(n),t.r=!1)},preProcessMouseMove:function(t){var e=this.wR,n=t.e;(m||e.IQ(n))&&(f(n),t.r=!1)},preProcessMouseUp:function(t){var e=this.wR,n=t.e;(m||e.HQ(n))&&(f(n),t.r=!1)},preProcessMouseDbClick:function(t){var e=Xt(this.OC);(m||e&&e.CH)&&(t.r=!1)},preProcessMouseOut:function(t){m&&(t.r=!1)}}),Ht=".gcScrollbar",r.hv.$n(N,{initEvents:function(t){(this.xR=new _t).oR(t,!0,Ht)},dispose:function(t){var e=this.xR;e&&e.oR(t,!1,Ht)}})},"./dist/plugins/touch/touch.res.en.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToolStrip_PasteText="Paste",e.ToolStrip_CutText="Cut",e.ToolStrip_CopyText="Copy",e.ToolStrip_AutoFillText="AutoFill"},"./dist/plugins/validation/datavalidation-event.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E;Object.defineProperty(e,"__esModule",{value:!0}),o=n("Core"),r=n("Common"),i=n("@grapecity/js-calc"),a=n("./dist/plugins/validation/datavalidation.js"),s=r.Common.j.Fa,l=r.Common.l,u=r.Common.u,c=o.Ul,f=o.kf,h=c.rl(),p=c.Ml,d=o.GC$,g=c.Nl,m=c.hZa,y=c.nl,v=document,C=Math.max,b=Math.min,w="position",T="absolute",x="border",S="font",A="background-color",I="top",R="left",k="z-index",M="auto",N="white",E="gcUIElement",d.extend(o.iI.prototype,{cs:function(t,e){var n,o,r,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt;function Ct(t,e){if(t&&t[e])return"function"==typeof t[e]?t[e]():t[e]}if((r=(o=(n=this).kj)&&o.parent)&&(o.hm()&&((D=r.getActiveSheet())&&o.name()===D.name()&&((O=o.getDataValidator(t,e))&&(j=o.getCellRect(t,e),!n.oG(j)&&(F=r.xv(),P=r.getHost(),_=c.vl(P),Ct(O,"showInputMessage")&&Ct(O,"inputMessage")&&(G=(L=u.Gb)((B=u.Ob)(Ct(O,"inputTitle")),"\n","<br/>"),H=L(B(Ct(O,"inputMessage")),"\n","<br/>"),V=g("span"),d(V).css(w,T).css(x,"1px #C0C0C0 solid").css("padding","3px 8px 3px 8px").css(A,"#FFFFFF").css("box-shadow","1px 2px 5px rgba(0,0,0,0.4)").css(S,"normal normal normal 12px/normal Arial").width(M).height(M).css(I,j.y+j.height+5).css(R,j.x+j.width/2).css(k,_).html("<b>"+G+"</b><br/>"+H).attr(E,"gcValidationInputMessage").appendTo(F),o.KH=V),O&&3===Ct(O,"type")&&Ct(O,"inCellDropdown")&&Ct(O,"condition"))))))){for(W=(z=Ct(O,"condition").getValidListImp(o,t,e)).length,U=g("select"),q=o.getText(t,e),Y=-1,X=v.createDocumentFragment(),Z=RegExp(String.fromCharCode(32),"g"),Q=String.fromCharCode(160),J=0;J<W;J++)$=z[J].text,s($)||i&&$ instanceof i.CalcError||(Y<0&&$===q&&(Y=J),$ instanceof Date&&($=l.Vb($,"M/d/yyyy h:mm:ss")),(K=g("option")).value=$,K.text=$.replace(Z,Q),X.appendChild(K));U.appendChild(X),U.selectedIndex=Y>0?Y:0,tt=o.getActualStyle(t,e),et=o.yl,nt=tt&&tt.font?tt.font:et.Bl(),o.zoom()>1&&(nt=et.Cl(nt)),rt=1,(ot=o.ITa.getSpans(f(t,e,1,1)))&&ot.length>0&&ot[0]&&(rt=ot[0].colCount),it=e+rt-1==o.getColumnCount()-1,at=o.Sl(t),st=o.parent&&o.parent.options.useTouchLayout,at=b(st?50:15,at),lt=h,ut=p.safari&&(lt.ipad||lt.iphone),ct=lt.android,ft=void 0,ht=void 0,pt=void 0,dt=void 0,gt=void 0,ut?(ft=j.width+3,ht=j.height+3,pt=j.y-1.5,dt=j.x-1.5,gt=N):(ft=C(j.width+(it?0:at),o.defaults.colWidth),ht=W>8?140:M,pt=j.y+j.height,dt=j.x+j.width+(it?0:at)-ft,gt=""),mt=d(U).css("outline","none").css(w,T).css(S,m(nt)).css(k,_).css(A,gt).width(ft).height(ht).css(R,dt).attr(E,"gcValidationSelect").appendTo(F).attr("size",W>2?W:2).hide().bind("click",(function(){ct||(n.pG(U,t,e,z),ut&&d(o.y$).show())})).bind("keydown",(function(r){13!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey?27!==r.keyCode||r.ctrlKey||r.shiftKey||r.altKey||d(U).hide():n.pG(U,t,e,z),ut&&d(o.y$).show()})).bind("change",(function(){ct&&n.pG(U,t,e,z)})),yt=d(P).height(),(ht=mt.outerHeight()+1)+pt>yt&&pt>ht&&(ut||(pt=j.y-ht)),mt.css(I,pt),ut&&mt.bind("blur",(function(){n.pG(U,t,e,z),d(o.y$).show()})),o.lm=U,(vt=g("input")).type="image",vt.src=a.zW(),vt.alt="v",d(vt).css(w,T).width(at).height(at).css(I,j.y+j.height-(at+3)).css(R,j.x+j.width-(it?at:0)).css(k,_).css(A,N).css(x,"1px solid gray").attr(E,"gcValidationButton").appendTo(F).bind("click",(function(t){o.isEditing()&&!o.endEdit()||(d(o.lm).toggle().focus(),ut&&d(o.y$).toggle(),y(t))})),o.y$=vt}}})},"./dist/plugins/validation/datavalidation.entry.js":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n("./dist/plugins/validation/datavalidation-event.js");var o=n("./dist/plugins/validation/datavalidation.js");e.CriteriaType=o.CriteriaType,e.DataValidationResult=o.DataValidationResult,e.ErrorStyle=o.ErrorStyle,e.DefaultDataValidator=o.DefaultDataValidator,e.HighlightType=o.HighlightType,e.HighlightPosition=o.HighlightPosition,e.zW=o.zW,e.bW=o.bW,e.createNumberValidator=o.createNumberValidator,e.createDateValidator=o.createDateValidator,e.createTimeValidator=o.createTimeValidator,e.createTextLengthValidator=o.createTextLengthValidator,e.createFormulaValidator=o.createFormulaValidator,e.createFormulaListValidator=o.createFormulaListValidator,e.createListValidator=o.createListValidator},"./dist/plugins/validation/datavalidation.js":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O;function j(t){var e,n,r,i;if(t instanceof Date)return t;if("string"==typeof t){if(!(e=o.Common.l.Qa(t)))if(isNaN(t)){if(e=new Date(t),isNaN(e.valueOf()))return d;try{if(n=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,r=o.Common.u.ib(o.Common.u.Db(t.replace(/ |\n/g,"")," ")," "),(i=n.exec(r))&&4===i.length&&(-1===i.indexOf(""+e.getFullYear())||-1===i.indexOf(""+e.getMonth())||-1===i.indexOf(""+e.getDate())))return d}catch(t){return d}}else if(!(e=o.Common.l.Xb(parseFloat(t))))return d;return e}return d}function F(t){return l&&t&&"="===t[0]}function P(t,e,n,o){var r,i,a,s,l=d,f=d,h=d,p=d;return F(e)?l=c(e,"="):f=e,F(n)?h=c(n,"="):p=n,r=d,6===t&&((i=u(1,3,f,l)).integerValue(o),(a=u(1,5,p,h)).integerValue(o),r=u(0,1,d,d,d,d,d,i,a)),7===t&&((i=u(1,4,f,l)).integerValue(o),(a=u(1,2,p,h)).integerValue(o),r=u(0,0,d,d,d,d,d,i,a)),t>=0&&t<=5&&(r=u(1,t,f,l)).integerValue(o),(s=new E(r)).type(o?1:2),s.comparisonOperator(t),s}function _(t,e,n,o,r){var i,a,s,l,f,h=d,p=d,g=d,m=d;if(F(e)?h=c(e,"="):p=e,F(n)?g=c(n,"="):m=n,i=d,6===t&&(a=u(o,5,p,h),s=u(o,3,m,g),i=u(0,1,d,d,d,d,d,a,s)),7===t&&(a=u(o,2,p,h),s=u(o,4,m,g),i=u(0,0,d,d,d,d,d,a,s)),t>=0&&t<=5){switch(t){case 0:l=0;break;case 1:l=1;break;case 2:l=4;break;case 3:l=5;break;case 4:l=2;break;case 5:l=3}i=u(o,l,p,h)}return(f=new E(i)).type(r),f.comparisonOperator(t),f}function L(t,e,n){return _(t,e,n,5,4)}function B(t,e,n){return _(t,e,n,13,5)}function G(t,e,n){var o,r,i,a,s=d,l=d,f=d,h=d;return F(e)?s=c(e,"="):l=e,F(n)?f=c(n,"="):h=n,o=d,6===t&&(r=u(7,3,l,s),i=u(7,5,h,f),o=u(0,1,d,d,d,d,d,r,i)),7===t&&(r=u(7,4,l,s),i=u(7,2,h,f),o=u(0,0,d,d,d,d,d,r,i)),t>=0&&t<=5&&(o=u(7,t,l,s)),(a=new E(o)).type(6),a.comparisonOperator(t),a}function H(t){if(!l)return d;var e=new E(u(4,d,d,c(t,"="),4));return e.type(7),e}function V(t){if(!l)return d;var e=new E(i.Condition.fromFormula(t));return e.type(3),e}function z(t){var e=new E(i.Condition.fromSource(t));return e.type(3),e}function W(t){return this.Tq(t)}function U(t,e){var n=t.getRowCount(),o=t.getColumnCount();return e.map((function(t){return function(t,e,n){var o=t.rowCount,r=t.colCount,i=b(t.row,t.col,o,r);return 0===t.row&&o===e&&(i.row=-1),0===t.col&&r===n&&(i.col=-1),i}(t,n,o)}))}function q(t,e){var n,o,r,i,a,s,l,u,c=e.Eja;for(o=0,r=t.row,i=t.rowCount;o<i;o++,r++)if(n=c[r])for(a=0,s=t.col,l=t.colCount;a<l;a++,s++)(u=n[s])&&u.IW(t,e),n[s]=g}function Y(t){var e,n,o=[];if(t)for(e in t)(n=t[e])&&o.push(n);return o}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("Core"),i=n("ConditionalFormatting"),a=n("SheetsCalc"),s=n("@grapecity/js-calc"),l=!!s,u=i.$V,c=o.Common.u.Db,f=o.Common.j.Fa,h=o.Common.j.C4,p=r.GC$,d=null,g=void 0,y=(m=r.Ul).Pl,v=m.Ol,C=m.T$a,b=r.kf,w=Math.min,T=Math.max,x=o.Common.l,S=".validator",I={type:0,color:A="red"},R={type:1,color:A,position:1},k={type:2,color:A,position:5,image:null},M=window,function(t){t[t.anyValue=0]="anyValue",t[t.wholeNumber=1]="wholeNumber",t[t.decimalValues=2]="decimalValues",t[t.list=3]="list",t[t.date=4]="date",t[t.time=5]="time",t[t.textLength=6]="textLength",t[t.custom=7]="custom"}(e.CriteriaType||(e.CriteriaType={})),function(t){t[t.forceApply=0]="forceApply",t[t.discard=1]="discard",t[t.retry=2]="retry"}(e.DataValidationResult||(e.DataValidationResult={})),function(t){t[t.stop=0]="stop",t[t.warning=1]="warning",t[t.information=2]="information"}(e.ErrorStyle||(e.ErrorStyle={})),function(t){t[t.circle=0]="circle",t[t.dogEar=1]="dogEar",t[t.icon=2]="icon"}(e.HighlightType||(e.HighlightType={})),function(t){t[t.topLeft=0]="topLeft",t[t.topRight=1]="topRight",t[t.bottomRight=2]="bottomRight",t[t.bottomLeft=3]="bottomLeft",t[t.outsideLeft=4]="outsideLeft",t[t.outsideRight=5]="outsideRight"}(e.HighlightPosition||(e.HighlightPosition={})),N=["errorStyle","ignoreBlank","inCellDropdown","showInputMessage","showErrorMessage","inputTitle","errorTitle","inputMessage","errorMessage","comparisonOperator","type","condition"],E=function(){function t(e){var n=this;n.id=t.w$,t.w$++,n.QAb=h(I),e&&(n.condition(e),n.condition().ignoreBlank(n.ignoreBlank())),n.n5=[]}return t.prototype.value1=function(t,e){var n,o=this.condition(),r=o&&o.item1()?o.item1():o;return r?(n=r.formula(t,e))&&n.length>0?"="+c(p.trim(""+n),"="):r.expected():d},t.prototype.value2=function(t,e){var n,o=this.condition(),r=o&&o.item2()?o.item2():o;return r?(n=r.formula(t,e))&&n.length>0?"="+c(p.trim(""+n),"="):r.expected():d},t.prototype.isValid=function(t,e,n,o){var r,i,a,s=this,l=s.condition();if(l){if(s.ignoreBlank()&&(f(o)||""===o))return!0;if(r=o,i=void 0,!f(o))switch(s.type()){case 0:return!0;case 2:case 1:i=function(t){if(f(t))return 0;if("number"==typeof t)return t;if("string"==typeof t){var e=parseFloat(t);if(!isNaN(e)&&""+e===t)return e}return d}(o),f(i)||(r=i);break;case 4:case 5:i=j(o),f(i)||(r=i)}t&&(t.lRa=!0),a=void 0;try{a=l.evaluate(t,e,n,r,r)}catch(t){a=!0}finally{t&&(t.lRa=!1)}return a}return!0},t.prototype.reset=function(){var t=this;t.errorStyle(0),t.ignoreBlank(!0),t.inCellDropdown(!0),t.showInputMessage(!0),t.showErrorMessage(!0),t.inputTitle(""),t.errorTitle(""),t.inputMessage(""),t.errorMessage(""),t.comparisonOperator(6),t.type(0),t.condition(d),t.n5.length=0},t.prototype.getValidList=function(t,e,n){var o=this.condition();return o!==d&&3===this.type()&&12===o.conType()?o.getValidList(t,e,n):d},t.prototype.highlightStyle=function(t){var e,n,o=this;if(0===arguments.length)return o.QAb;if(!f(t)){if(o.QAb.type!==t.type)switch(t.type){case 1:o.QAb=h(R);break;case 2:o.QAb=h(k);break;default:o.QAb=h(I)}for(n in e=o.QAb)e.hasOwnProperty(n)&&t.hasOwnProperty(n)&&(e[n]=t[n]);return o.kj&&o.kj.repaint(),o}},t.prototype.toJSON=function(t){var e,n=this,o={};return N.forEach((function(e){var r=n[e]();n[e].isDefault(r)||(o[e]=r&&r.toJSON?r.toJSON(t):r)})),e=n.n5.map((function(t){return-1===t.row&&-1===t.col?b(-1,0,t.rowCount,t.colCount):t})),o.ranges=a.rangesToFormula(e,0,0,15,!1),o.highlightStyle=JSON.stringify(n.QAb),p.isEmptyObject(o)?g:o},t.prototype.fromJSON=function(t,e,n){var o,r,i,s,l;t&&!p.isEmptyObject(t)&&(o=this,t.ranges&&(o.n5=a.formulaToRanges(n,t.ranges,0,0,!0)[0].ranges),t.highlightStyle&&(o.QAb=JSON.parse(t.highlightStyle)),N.forEach((function(r){var i,a,s=t[r];v(s)&&("condition"===r?((i=u()).fromJSON(t.condition,n,e),o.condition(i,!1),(a=i.ranges())&&a.length?o.n5=a:i.ranges(o.n5),i.context(n)):o[r](s,!1))})),(r=t.validatorInfo)&&(i=n.Wu.useR1C1,s=function(t,e){var n,o,r;if(!f(t))return 1===t||2===t?n=P(e.operator,e.value1,e.value2,1===t):3===t?e.value?n=z(e.value):e.formula&&(n=V(e.formula)):4===t||5===t?(o=e.value1,r=e.value2,o&&"/OADate("===o.substr(0,8)&&(o=x.Rka(o)),r&&"/OADate("===r.substr(0,8)&&(r=x.Rka(r)),n=5===t?B(e.operator,o,r):L(e.operator,o,r)):6===t?n=G(e.operator,e.value1,e.value2):7===t&&void 0!==e.formula&&(n=H(e.formula)),n?n.condition():void 0}(t.type,r),l=r.operator,s&&(s.ranges(o.n5),s.ignoreBlank(o.ignoreBlank()),s.context(n),i&&C(s),o.condition(s)),f(l)||o.comparisonOperator(l)))},t.prototype.clone=function(e){var n,o;return this.Nja?((n=this.condition())&&n.initExpression(),this):((o=new t).fromJSON(this.toJSON(e),!1,e||this.kj),o.n5=[],o)},t.prototype.context=function(t){if(t){this.xc=t;var e=this.condition();e&&(e.ranges(this.n5),e.context(t))}return this.xc},t.prototype.xja=function(t){var e,n;if(t){for(e=this.n5,n=0;n<e.length;n++)if(e[n].containsRange(t))return;e.push(t)}},t.prototype.IW=function(t,e){var n,o,r,i,a,s,l,u,c=this,f=c.n5;t&&f.length&&(n=t.row,o=t.col,r=t.rowCount,i=t.colCount,a=[],s=!1,l=c.kj,u=l&&[l.getRowCount(),l.getColumnCount()],f.forEach((function(t){var e=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d,g,m,y,v,C,x,S,A,I,R,k,M,N;return t.intersect(e,n,o,r)?(a=t.rowCount,s=t.colCount,l=T(0,t.row),u=T(0,t.col),c=!1,f=!1,h=!1,e=T(0,e),n=T(0,n),i||(i=[-1,-1]),p=i[0],d=i[1],-1===a&&(a=p-l,f=!0),-1===s&&(s=d-u,c=!0),-1===o&&(o=p-e),-1===r&&(r=d-n,h=!0),m=l+a-1,y=u,v=u+s-1,C=e,x=e+o-1,S=n,A=n+r-1,I=[],-1!==(g=l)&&-1!==y&&-1!==C&&-1!==S&&(S-y>0&&(R=b(g,y,f?-1:a,S-y),I.push(R)),v-A>0&&(k=b(g,A+1,f?-1:a,v-A),I.push(k)),C-g>0&&(M=b(g,T(S,y),C-g,c&&h?-1:w(A,v)-T(S,y)+1),I.push(M)),m-x>0&&(N=b(x+1,T(S,y),m-x,c&&h?-1:w(A,v)-T(S,y)+1),I.push(N))),I.PAb=!0,I):[t]}(t,n,o,r,i,u);e.PAb&&(s=!0),a.push(e)})),c.n5=[].concat.apply([],a),s&&e.RAb(c))},t.prototype.l1=function(){return this.n5},t.prototype.rI=function(t,e,n){var o,r,i,a,s,l,u;if(!(t<0||e<=0)){for(this.condition()&&this.condition().initExpression(),o=0;o<this.n5.length;o++){if(i=(r=this.n5[o]).row,n&&n.length>0){for(a=!1,s=0,l=n.length;s<l;s++)if((u=n[s])&&u.row===r.row&&u.row+u.rowCount-e===r.row+r.rowCount&&r.row===t){r.rowCount+=e,a=!0;break}if(a)break}t<=i?r.row+=e:t<=i+r.rowCount&&(r.rowCount+=e)}this.condition()&&this.condition().ranges(this.n5)}},t.prototype.GR=function(t,e){if(!(t<0||e<=0)){this.condition()&&this.condition().initExpression();var n=[];this.n5.forEach((function(o){var r,i=o.row,a=o.rowCount;t<i?((r=t+e-i)<=0?i-=e:(i-=r,o.rowCount-=r),i<0&&(o.rowCount+=i,i=0),o.row=i):i<=t&&t<i+a&&(o.rowCount-=w(e,i+a-t)),(o.rowCount>0||-1===o.row&&-1===o.rowCount)&&n.push(o)})),this.n5=n,this.condition()&&this.condition().ranges(this.n5)}},t.prototype.tI=function(t,e,n){var o,r,i,a,s,l,u,c;if(!(t<0||e<=0)){for(this.condition()&&this.condition().initExpression(),o=0;o<this.n5.length;o++){if(r=this.n5[o],n&&n.length>0){for(i=!1,a=!1,s=0,l=n.length;s<l;s++)if(!(u=n[s])||u.containsRange(r)){if(u&&u.col===r.col&&u.col+u.colCount-e===r.col+r.colCount&&u.col===t){r.colCount+=e,a=!0;break}}else i=!0;if(i)continue;if(a)break}t<=(c=r.col)?r.col+=e:t<=c+r.colCount&&(r.colCount+=e)}this.condition()&&this.condition().ranges(this.n5)}},t.prototype.HR=function(t,e){if(!(t<0||e<=0)){this.condition()&&this.condition().initExpression();var n=[];this.n5.forEach((function(o){var r,i=o.col,a=o.colCount;t<i?((r=t+e-i)<=0?i-=e:(i-=r,o.colCount-=r),i<0&&(o.colCount+=i,i=0),o.col=i):i<=t&&t<i+a&&(o.colCount-=w(e,i+a-t)),(o.colCount>0||-1===o.col&&-1===o.colCount)&&n.push(o)})),this.n5=n,this.condition()&&this.condition().ranges(this.n5)}},t.w$=1,t}(),e.DefaultDataValidator=E,D={errorStyle:y("errorStyle",0),ignoreBlank:y("ignoreBlank",!0,(function(t){this.condition()&&this.condition().ignoreBlank(t)})),inCellDropdown:y("inCellDropdown",!0),showInputMessage:y("showInputMessage",!0),showErrorMessage:y("showErrorMessage",!0),inputTitle:y("inputTitle",""),errorTitle:y("errorTitle",""),inputMessage:y("inputMessage",""),errorMessage:y("errorMessage",""),comparisonOperator:y("comparisonOperator",6),condition:y("condition",d),type:y("type",0)},p.extend(E.prototype,D),e.zW=function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8cfvM55PfGm/K3O233vuO+638e9H5ko/ED+UPPR+mPHp9BP9z7nfP78L/eE8/sl0p8zAAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAMOSURBVHjaXJNdaJRHFIbfM7PfGremUTfkpxgpiheiBOmFtYUgRXNRqNnd75sEhBoIKhrwQpFUUSsihhIQ41+FNrUGqYhRY43STZqgARNRTIzRaFqz6xJTtals3K8xRQ3x7UV215+LB2bOxTNn3jMDs+mEIgmS+LwQiqSQ9JG03FHX54666pn7TLmJEZVIjCCRGMkYGxvNiI9FvaENZzLw/PmqtCDFV/4WkERw8TI03K6XqqrNWLBgPoafDmNwMCbd3TestpMDHpJAuIcWSZjSUrnS0SFOWamXJLpuDYAkAiYAkioYDCIej0+Lx12QrervFxOemjWfCvIyIcmTVeLVC1986OkUklhRtlgutLYrkpnOKlt1dl0BSfTHmnCnm5oTm0AS6I0xLaDLrK1PusTp/cb7/rUAyH8kSL+Vqt0ebpuGP699LCRROAdqf/suGforCpLi4DMpAOQQLAEgfE2sRDZIv5cknGxi74HDFnZ/32olk9f//vOTPIj05ZnKZpp14QlnfZgpTOXvNGsvjrvuH9MnOwAOYlhQ/UPYmxRkJVvzPHw8JF8EdrKoZEeapSt2cHDo4Sxn7R0hiV8/hEQe3Ad21jZNJQnbDklSBBas0ddvRj2Fi4qZIhaL+Q3ni8N0ZohGe4Dv6sKZfFP0kvkSWLZdGvLpiUTuTS9cVMxI5H5+fz+UfXyOto/Ns5bUL7dyjsBjTsKDbbVnM0iqYNHXYi9ZLiSlaRbFn089zlzvwN1IzkDlmDhfdiin5KgOBY5qO9iojX1K9+VRcOCXnlySsFkOkjj/WGschtR0Kt/Ga9D2aYj5DWKaIeYSxTlFMS2T66udBDbXHS94Z97ZUB8Ayt7+iVVddlkzl5LCvrklvQ9dr1fnF0IQbng5O/VQsmAJSfnxSLuqCG3Rxxpfz3xbXv0IEkzm5YR7lXOCGs6+PVNJYjaQnoKwSgBIDSqkjjPUuv3QLP9ImW+hG1/lKJtzp5jaCmW2nrNAUpOUkqrWrJUb23T5rhZf0eoWhbeEKX7O4eTPHe8DSTjF59T/AwCfnhbaDaIICgAAAABJRU5ErkJggg=="},e.bW=F,e.createNumberValidator=P,e.createDateValidator=L,e.createTimeValidator=B,e.createTextLengthValidator=G,e.createFormulaValidator=H,e.createFormulaListValidator=V,e.createListValidator=z,p.extend(r.Worksheet.prototype,{getDataValidator:function(t,e,n){return f(n)&&(n=3),3===n?this.uja.Aja(t,e)[0]:g},setDataValidator:function(t,e,n,o,r,i){var a,s,l,u,c=this,h=c.uja;if(arguments.length<5&&(r=n,i=o,n=-1===t?-1:1,o=-1===e?-1:1),f(i)&&(i=3),3===i){if(a=c.getDataValidator(t,e,i),(s=1===n&&1===o)&&a===r)return;c.ITa.zVa(),l=b(t,e,n,o),h.Cja(l),r&&h.Bja(r,l),u="validator",s&&(c.Bq(u,t,e,i,a,r),-1!==t&&-1===e?c.kq(t,i,u,r,a):-1===t&&-1!==e&&c.pq(e,i,u,r,a)),c.$p()}},isValid:function(t,e,n){var o,r=this;try{if(r.Ku=t,r.Lu=e,r.Mu=n,r.Ju=!0,o=r.getDataValidator(t,e))return o.isValid(r,t,e,n)}finally{r.Ku=-1,r.Lu=-1,r.Mu=d,r.Ju=!1}return!0},hm:function(){var t,e,n,o,r=this;return!r.x$&&(r.x$=!0,(t=r.KH)&&((e=t.parentNode)&&e.removeChild(t),r.KH=d),(n=r.y$)&&(p(n).unbind("click"),(e=n.parentNode)&&e.removeChild(n),r.y$=d),(o=r.lm)&&(p(o).unbind("keydown").unbind("blur").unbind("click").unbind("change"),(e=o.parentNode)&&e.removeChild(o),r.lm=d),r.x$=!1,!0)},tja:function(){var t,e,n,o=[],r=this.uja,i=r&&r.Dja;if(i)for(t in i)(n=(e=i[t])&&e.condition())&&n.getExpressions&&n.getExpressions().length>0&&o.push({validator:e,sheet:this});return o}}),p.extend(r.Workbook.prototype,{tja:function(){var t=[];return this.sheets.forEach((function(e){var n=e.tja();n&&n.length&&n.forEach((function(e){t.push(e)}))})),t}}),p.extend(r.CellRange.prototype,{validator:function(t){var e=this,n=e.sheet,o=e.sheetArea,r=e.row,i=e.col,a=e.rowCount,s=e.colCount;return 0===arguments.length?n.getDataValidator(r,i,o):(n.setDataValidator(r,i,a,s,t,o),e)}}),O=function(){function t(t){this.WS=t,this.Dja={},this.Eja={},this.SAb=[]}return t.prototype.no=function(){this.WS=d},t.prototype.UV=function(t){return function(t,e){if(t&&e&&e.length)return e.map(W.bind(t))}(this.WS,t)},t.prototype.EW=function(t){return U(this.WS,t)},t.prototype.QV=function(t){var e,n,o=this,r=o.Dja;if(o.Eja={},r)for(e in r)(n=r[e])&&(t&&delete n.yja,o.FW(n,!0));o.Fja()},t.prototype.RAb=function(t){var e=this.SAb;-1===e.indexOf(t)&&e.push(t)},t.prototype.FW=function(t,e){var n=this,o=n.UV(t.l1()),r=n.WS,i=r.getRowCount(),a=r.getColumnCount();o&&(n.SAb.length=0,o.forEach((function(e){!function(t,e,n,o,r){var i,a,s,l,u,c,f=o.Eja,h=t.row,p=t.col,d=t.rowCount,g=t.colCount;for(h+d-1>=e&&(d=e-h),p+g-1>=n&&(g=n-p),i=0,a=h;i<d;i++,a++)for((s=f[a])||(f[a]=s={}),l=0,u=p;l<g;l++,u++)(c=s[u])&&c!==r&&c.IW(t,o),s[u]=r}(e,i,a,n,t)})),e||n.Fja())},t.prototype.GW=function(t){var e=this,n=e.UV(t.l1());e.SAb.length=0,n.forEach((function(t){q(t,e)})),e.Fja()},t.prototype.HW=function(t){var e=this;t&&q(e.WS.Tq(t),e),e.Fja()},t.prototype.Fja=function(){var t,e=this.SAb;e.length&&(t=this.Dja,e.forEach((function(e){e.l1().length?e.condition()&&e.condition().ranges(e.l1()):(delete t[e.id],delete e.kj)})),e.length=0)},t.prototype.Bja=function(t,e){var n=this,o=n.WS;if(e&&(t.kj&&o!==t.kj&&(t=t.clone(o)),t.kj=o,t.xja(e)),o)return t.context(o),n.Dja[t.id]=t,n.FW(t),t},t.prototype.Cja=function(t){if(t){var e=this.WS;this.HW(t),e.$p()}},t.prototype.$b=function(){var t=this;t.WS&&(t.Dja={},t.QV())},t.prototype.Aja=function(t,e){var n,o,r,i=this,a=i.Dja;return 0===arguments.length?Y(a):(n=[],o=i.Eja,t===g&&(t=-1),e===g&&(e=-1),-1===t&&-1===e?Y(a):(-1!==t&&-1!==e?(r=o[t])&&r[e]&&n.push(r[e]):-1===t?p.each(o,(function(t,o){var r=o[e];r&&-1===n.indexOf(r)&&n.push(r)})):(r=o[t])&&p.each(r,(function(t,e){e&&-1===n.indexOf(e)&&n.push(e)})),n))},t.prototype._V=function(t,e,n,o){var r,i,a=this.Dja;if(a)for(r in a)(i=a[r])&&(n?i.rI(t,e,o):i.tI(t,e,o));this.QV()},t.prototype.rI=function(t,e,n){this._V(t,e,!0,n)},t.prototype.tI=function(t,e,n){this._V(t,e,!1,n)},t.prototype.aW=function(t,e,n){var o,r,i=this.Dja;if(i)for(o in i)(r=i[o])&&(n?r.GR(t,e):r.HR(t,e),0===r.n5.length&&(i[o]=g));this.QV()},t.prototype.GR=function(t,e){this.aW(t,e,!0)},t.prototype.HR=function(t,e){this.aW(t,e,!1)},t.prototype.toJSON=function(t){var e,n,o=this.Dja,r=[];for(e in o)(n=o[e])&&r.push(n.toJSON(t));return r},t.prototype.fromJSON=function(t,e,n){var o=this,r=o.WS;o.Dja={},t&&t.length&&(t.forEach((function(t){var i=new E;i.fromJSON(t,e,n),i.kj=r,o.Dja[i.id]=i})),o.QV())},t.prototype.vja=function(t,e,n){this.WS.setDataValidator(t,e,n)},t}(),p.extend(r.lUa.prototype,{zVa:function(){var t,e,n,o,r,i=this.zTa;if(i&&!i.AVa){for(n in e=[],t=this.uja.Dja)(o=t[n])&&(r=o.n5.map((function(t){return b(t.row,t.col,t.rowCount,t.colCount)})),e.push({validator:o,ranges:r}));i.AVa=e}},BVa:function(t){var e,n;t&&(e=this.uja,n={},t.forEach((function(t){var e=t.validator;e.n5=t.ranges,e.condition()&&e.condition().ranges(e.n5),n[e.id]=e})),e.Dja=n,e.QV(!1))},CVa:function(t,e,n){this.zVa(),this.uja.rI(t,e,n)},DVa:function(t,e){this.zVa(),this.uja.GR(t,e)},EVa:function(t,e,n){this.zVa(),this.uja.tI(t,e,n)},FVa:function(t,e){this.zVa(),this.uja.HR(t,e)},GVa:function(t){this.zVa(),this.uja.HW(t)},HVa:function(){this.zVa(),this.uja.QV()}}),r.lUa.$n("validator",{init:function(){this.uja=new O(this.kj)},undo:function(t){var e=t.AVa;e&&this.BVa(e)},dispose:function(t){!1!==(t&&t.clearCache)&&this.uja&&(this.uja.no(),this.uja=d)}}),r.Worksheet.$n("validator",{init:function(){var t=this;t.uja=t.ITa.uja,t.Gu(r.Events.FloatingElementSelected+S),t.Fu(r.Events.FloatingElementSelected+S,(function(e,n){"worksheet"!==n.type&&t.hm()}))},dispose:function(t){var e=this;e.hm(),t.clearCache&&e.uja.$b(),!1!==t.clearCache&&e.Gu(r.Events.FloatingElementSelected+S)},onLayoutChanged:function(t){var e=t.changeType,n=t.row,o=t.rowCount,r=t.col,i=t.colCount,a=t.sheetArea,s=this.ITa,l=this.tables;"addRows"===e?s.CVa(n,o,l&&l.KFc(n,-1,o,-1,!0)):"deleteRows"===e?s.DVa(n,o):"addColumns"===e?s.EVa(r,i,l&&l.KFc(-1,r,-1,i,!1)):"deleteColumns"===e?s.FVa(r,i):"clear"===e?3===a&&2==(2&t.type)&&s.GVa(b(n,r,o,i)):"setColumnCount"!==e&&"setRowCount"!==e||3!==a&&1!==a||s.HVa()},toJson:function(t,e){var n,o=this.uja,r=e&&e.ignoreStyle;o&&!r&&((n=o.toJSON(this))&&n.length&&(t.validations=n))},fromJson:function(t,e,n){var o,r=n&&n.ignoreStyle;t&&t.validations&&!r&&(o=t.validations,this.uja.fromJSON(o,e,this))}}),r.Style.$n("validator",{fromJson:function(t){if("validator"===t.p){var e=new E;e.fromJSON(t.v,t.noSchema,t.context),this.validator=e,t.r=!0}}}),M.Yl.km.push((function(t,e){!e&&t.hm&&t.hm()}))},"./node_modules/process/browser.js":function(t,e){var n,o,r,i,a,s,l=t.exports={};function u(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function f(t){if(n===setTimeout)return setTimeout(t,0);if((n===u||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}function h(){i&&a&&(i=!1,a.length?r=a.concat(r):s=-1,r.length&&p())}function p(){var t,e;if(!i){for(t=f(h),i=!0,e=r.length;e;){for(a=r,r=[];++s<e;)a&&a[s].run();s=-1,e=r.length}a=null,i=!1,function(t){if(o===clearTimeout)return clearTimeout(t);if((o===c||!o)&&clearTimeout)return o=clearTimeout,clearTimeout(t);try{o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function g(){}!function(){try{n="function"==typeof setTimeout?setTimeout:u}catch(t){n=u}try{o="function"==typeof clearTimeout?clearTimeout:c}catch(t){o=c}}(),r=[],i=!1,s=-1,l.nextTick=function(t){var e,n=Array(arguments.length-1);if(arguments.length>1)for(e=1;e<arguments.length;e++)n[e-1]=arguments[e];r.push(new d(t,n)),1!==r.length||i||f(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=g,l.addListener=g,l.once=g,l.off=g,l.removeListener=g,l.removeAllListeners=g,l.emit=g,l.prependListener=g,l.prependOnceListener=g,l.listeners=function(t){return[]},l.binding=function(t){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw Error("process.chdir is not supported")},l.umask=function(){return 0}},"./node_modules/util/node_modules/inherits/inherits_browser.js":function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},"./node_modules/util/support/isBufferBrowser.js":function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},"./node_modules/util/util.js":function(t,e,n){(function(t){var o,r,i,a,s=Object.getOwnPropertyDescriptors||function(t){var e,n=Object.keys(t),o={};for(e=0;e<n.length;e++)o[n[e]]=Object.getOwnPropertyDescriptor(t,n[e]);return o},l=/%[sdj%]/g;function u(t,n){var o={seen:[],stylize:f};return arguments.length>=3&&(o.depth=arguments[2]),arguments.length>=4&&(o.colors=arguments[3]),y(n)?o.showHidden=n:n&&e.Ia(o,n),w(o.showHidden)&&(o.showHidden=!1),w(o.depth)&&(o.depth=2),w(o.colors)&&(o.colors=!1),w(o.customInspect)&&(o.customInspect=!0),o.colors&&(o.stylize=c),h(o,t,o.depth)}function c(t,e){var n=u.styles[e];return n?"["+u.colors[n][0]+"m"+t+"["+u.colors[n][1]+"m":t}function f(t,e){return t}function h(t,n,o){var r,i,a,s,l,u,c,f,y;if(t.customInspect&&n&&I(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n))return b(r=n.inspect(o,t))||(r=h(t,r,o)),r;if(i=p(t,n))return i;if(a=Object.keys(n),s=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(a),t.showHidden&&(a=Object.getOwnPropertyNames(n)),A(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return d(n);if(0===a.length){if(I(n))return l=n.name?": "+n.name:"",t.stylize("[Function"+l+"]","special");if(T(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(S(n))return t.stylize(Date.prototype.toString.call(n),"date");if(A(n))return d(n)}return u="",c=!1,f=["{","}"],m(n)&&(c=!0,f=["[","]"]),I(n)&&(u=" [Function"+(n.name?": "+n.name:"")+"]"),T(n)&&(u=" "+RegExp.prototype.toString.call(n)),S(n)&&(u=" "+Date.prototype.toUTCString.call(n)),A(n)&&(u=" "+d(n)),0!==a.length||c&&0!=n.length?o<0?T(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),y=c?function(t,e,n,o,r){var i,a,s=[];for(i=0,a=e.length;i<a;++i)N(e,i+"")?s.push(g(t,e,n,o,i+"",!0)):s.push("");return r.forEach((function(r){r.match(/^\d+$/)||s.push(g(t,e,n,o,r,!0))})),s}(t,n,o,s,a):a.map((function(e){return g(t,n,o,s,e,c)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(y,u,f)):f[0]+u+f[1]}function p(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return C(e)?t.stylize(""+e,"number"):y(e)?t.stylize(""+e,"boolean"):v(e)?t.stylize("null","null"):void 0}function d(t){return"["+Error.prototype.toString.call(t)+"]"}function g(t,e,n,o,r,i){var a,s,l;if((l=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?s=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(s=t.stylize("[Setter]","special")),N(o,r)||(a="["+r+"]"),s||(t.seen.indexOf(l.value)<0?(s=v(n)?h(t,l.value,null):h(t,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+s.split("\n").map((function(t){return"   "+t})).join("\n")):s=t.stylize("[Circular]","special")),w(a)){if(i&&r.match(/^\d+$/))return s;(a=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function m(t){return Array.isArray(t)}function y(t){return"boolean"==typeof t}function v(t){return null===t}function C(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return void 0===t}function T(t){return x(t)&&"[object RegExp]"===R(t)}function x(t){return"object"==typeof t&&null!==t}function S(t){return x(t)&&"[object Date]"===R(t)}function A(t){return x(t)&&("[object Error]"===R(t)||t instanceof Error)}function I(t){return"function"==typeof t}function R(t){return Object.prototype.toString.call(t)}function k(t){return t<10?"0"+t.toString(10):t.toString(10)}function M(){var t=new Date,e=[k(t.getHours()),k(t.getMinutes()),k(t.getSeconds())].join(":");return[t.getDate(),i[t.getMonth()],e].join(" ")}function N(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function E(t,e){if(!t){var n=Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.format=function(t){var e,n,o,r,i,a;if(!b(t)){for(e=[],n=0;n<arguments.length;n++)e.push(u(arguments[n]));return e.join(" ")}for(n=1,r=(o=arguments).length,i=(t+"").replace(l,(function(t){if("%%"===t)return"%";if(n>=r)return t;switch(t){case"%s":return o[n++]+"";case"%d":return+o[n++];case"%j":try{return JSON.stringify(o[n++])}catch(t){return"[Circular]"}default:return t}})),a=o[n];n<r;a=o[++n])i+=v(a)||!x(a)?" "+a:" "+u(a);return i},e.deprecate=function(n,o){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,o).apply(this,arguments)};var r=!1;return function(){if(!r){if(t.throwDeprecation)throw Error(o);t.traceDeprecation?console.trace(o):console.error(o),r=!0}return n.apply(this,arguments)}},o={},e.debuglog=function(n){if(w(r)&&(r=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!o[n])if(RegExp("\\b"+n+"\\b","i").test(r)){var i=t.pid;o[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,i,t)}}else o[n]=function(){};return o[n]},e.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=m,e.isBoolean=y,e.isNull=v,e.isNullOrUndefined=function(t){return null==t},e.isNumber=C,e.isString=b,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=w,e.isRegExp=T,e.isObject=x,e.isDate=S,e.isError=A,e.isFunction=I,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n("./node_modules/util/support/isBufferBrowser.js"),i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e.log=function(){console.log("%s - %s",M(),e.format.apply(e,arguments))},e.inherits=n("./node_modules/util/node_modules/inherits/inherits_browser.js"),e.Ia=function(t,e){var n,o;if(!e||!x(e))return t;for(o=(n=Object.keys(e)).length;o--;)t[n[o]]=e[n[o]];return t},a="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0,e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(a&&t[a]){var e;if("function"!=typeof(e=t[a]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,a,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){var e,n,o,r=new Promise((function(t,o){e=t,n=o})),i=[];for(o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(t,o){t?n(t):e(o)}));try{t.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),a&&Object.defineProperty(e,a,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,s(t))},e.promisify.custom=a,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){var n,o,r,i,a=[];for(n=0;n<arguments.length;n++)a.push(arguments[n]);if("function"!=typeof(o=a.pop()))throw new TypeError("The last argument must be of type Function");r=this,i=function(){return o.apply(r,arguments)},e.apply(this,a).then((function(e){t.nextTick(i,null,e)}),(function(e){t.nextTick(E,e,i)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,s(e)),n}}).call(this,n("./node_modules/process/browser.js"))},"./node_modules/webpack/buildin/global.js":function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},"./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js":function(t,e,n){var o="object"==typeof o?o:{};o.Spread=o.Spread||{},o.Spread.CalcEngine=o.Spread.CalcEngine||{},o.Spread.CalcEngine.AdvancedFunctions=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){var o,r;if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)n.d(o,r,(function(e){return t[e]}).bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/",n(n.s="./src/advancedFunctions.entry.ts")}({"./src/advancedFunctions.entry.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("CalcEngine");e.Functions=o.Functions,n("./src/functions-db.ts"),n("./src/functions-eng.ts"),n("./src/functions-fin.ts"),n("./src/functions-lookup.ts"),n("./src/functions-stat.ts")},"./src/functions-db.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T;function x(t,e,n,o){for(var r,i=0,a=new C(t,e,n);a.Pk();)r=a.Ok(),(r=o?s(r):r)&&i++;return u(i)}function S(t,e,n,o,r,i,h){for(var p,g,m,y,v=h?1:0,b=0,w=0,T=new C(t,e,n);T.Pk();)if(p=T.Ok(),s(p)){if(g=a(p),d(g))return f;v=h?v*g:v+g,b+=g*g,w++}else if(l(p))return p;return i||h?u(v):(m=Math.max(0,(w*b-v*v)/(w*(w-r))),y=o?Math.sqrt(m):m,w<=1?c:u(y))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.q,a=r.Convert.Pa,s=r.Convert.Na,l=r.Convert.vf,u=r.Convert.Nh,c=r.Errors.DivideByZero,f=r.Errors.Value,h=r.Functions.ak,p=r.Functions.jk,d=isNaN,g=o.Common.u,m=g.kb,y=r.sR().Exp_InvalidCast,v=function(){function t(t,e,n){this.Gk=t,this.Hk=e,this.Wob=n}return t.prototype.Ik=function(t){var e=r.evaluateOperator({"=":9,"<>":10,"<":11,"<=":12,">":13,">=":14}[this.Gk],t,this.Hk);return!!r.Functions.ik(e)&&r.Convert.Vh(e)},t}(),C=function(){function t(t,e,n){var o=this;if(o.cj=0,o.Jk=t,o.Kk=n,o.Xob={},3===arguments.length){if(o.Lk=o.Mk(t,e),t.rowCount<2||t.colCount<1||n.rowCount<2||n.colCount<1||o.Lk<0||o.Jk.colCount<=o.Lk)throw y}else if(2===arguments.length&&(o.Lk=-1,t.rowCount<2||t.colCount<1||n.rowCount<2||n.colCount<1))throw y}return t.prototype.Mk=function(t,e){var n,o;if(p(e)){for(n=0;n<t.colCount;n++)if((o=r.Convert.bc(t[0][n]))&&this.Nk(o,e))return n;return-1}return r.Convert.Rh(e)-1},t.prototype.Ok=function(){var t=this;if(t.cj<=0||t.Jk.rowCount<=t.cj)throw r.sR().Exp_InvalidOperation;return t.Jk[t.cj][t.Lk]},t.prototype.Pk=function(){for(var t=this,e=!1,n=t.Jk.rowCount;!e&&t.cj<n;)t.cj++,t.cj<n&&(e=t.Qk());return e},t.prototype.Rk=function(t){var e,n,i,a,s;if(p(t)){for(e=["=","<>","<=",">=","<",">"],n=r.Convert.bc(t),i=void 0,a=void 0,i=0;i<e.length;i++)if(o.Common.u.kb(n,e[i]))return n=n.substring(e[i].length),s=o.Common.o.lb(n),d(s)?this.Nk("true",n)?t=!0:this.Nk("false",n)?t=!1:(t=n,a=0===i):t=s,new v(e[i],t,a);return new v("=",t)}return t?new v("=",t):null},t.prototype.Yob=function(t,e){var n,o=this,r=o.Xob,i=function(t,e){return[t,e].join(",")}(t,e),a=r[i];return a||(r[n="_"+i]||(a=r[i]=o.Rk(o.Kk[t][e]),r[n]=!0)),a},t.prototype.Qk=function(){var t,e,n,o,r,a,s,l,u,c=this,f=!1,h=c.Kk,d=c.cj,g=h.rowCount,y=h.colCount,v=c.Jk,C=c.Zob;if(!C){for(o=h[0],C=[],e=0;e<y;e++){if((n=c.Mk(v,o[e]))<0)return!1;C[e]=n}c.Zob=C}for(t=1;!f&&t<g;t++)for(f=!0,e=0;f&&e<y;e++)if(r=c.Yob(t,e)){if(a=v[d][C[e]],"="===r.Gk&&(s=r.Hk,p(s)&&p(a))){l=i.ub(s,!0),u=r.Wob,f=l?i.sb("^"+l+(u?"$":"")).test(a):u?a.toLowerCase()===s.toLowerCase():m(a,s,!0);continue}f=r.Ik(a)}return f},t.prototype.Nk=function(t,e){return t.toLowerCase()===e.toLowerCase()},t}(),h("DAVERAGE",(function(t,e,n){for(var o,i,a=0,h=0,p=new C(t,e,n);p.Pk();){if(o=p.Ok(),l(o))return o;if(s(o)){if(i={value:0},!r.Convert.Th(o,i))return f;a+=i.value,h++}}return 0===h?c:u(a/h)}),3,3,T=[w={Yi:!0,Hi:4,Ii:0},{Yi:!0},w],b="!= 1",b),h("DCOUNT",(function(t,e,n){return x(t,e,n,!0)}),3,3,T,b,b),h("DCOUNTA",(function(t,e,n){return x(t,e,n,!1)}),3,3,T,b,b),h("DGET",(function(t,e,n){var o,i=new C(t,e,n);return i.Pk()?(o=i.Ok(),i.Pk()?r.Errors.Number:o):f}),3,3,T,b,b),h("DMAX",(function(t,e,n){for(var o,i,c=!1,h=-r.Functions.hk,p=new C(t,e,n);p.Pk();){if(o=p.Ok(),l(o))return o;if(s(o)){if(i=a(o),d(i))return f;(!c||i>h)&&(h=i),c=!0}}return c?u(h):0}),3,3,T,b,b),h("DMIN",(function(t,e,n){for(var o,i,c=!1,h=r.Functions.hk,p=new C(t,e,n);p.Pk();){if(o=p.Ok(),l(o))return o;if(s(o)){if(i=a(o),d(i))return f;(!c||o<h)&&(h=o),c=!0}}return c?u(h):0}),3,3,T,b,b),h("DPRODUCT",(function(t,e,n){return S(t,e,n,!1,0,!1,!0)}),3,3,T,b,b),h("DSTDEV",(function(t,e,n){return S(t,e,n,!0,1)}),3,3,T,b,b),h("DSTDEVP",(function(t,e,n){return S(t,e,n,!0,0)}),3,3,T,b,b),h("DSUM",(function(t,e,n){return S(t,e,n,!1,0,!0)}),3,3,T,b,b),h("DVAR",(function(t,e,n){return S(t,e,n,!1,1)}),3,3,T,b,b),h("DVARP",(function(t,e,n){return S(t,e,n,!1,0)}),3,3,T,b,b)},"./src/functions-eng.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht;function Vt(t,e){return new r.Functions.Ui(t,e)}function zt(t,e){return{Ld:t,Sk:e}}function Wt(t,e){var n,o=[];for(n=0;n<i(t);n++)o.push(zt(t[n],e[n]));return o.push(zt(null,0)),o}function Ut(t,e,n){var o,i,a,s,l,u,c,f=100,p=.5*t,d=p*p;for(p=h(p,m(e)),o=r.Functions.tk(e),i=1,a=0,s=m(e),u=.9*(l=p/o),c=!1;l!==u&&0!==f;)p*=d,o*=++a,i*=++s,u=l,l=n||c?l+p/o/i:l-p/o/i,f--,c=!c;return l}function qt(t,e){var n=h(e,10),o=parseInt(t,e);return y(o)?C:n/2<=o?o-n:o}function Yt(t,e,n){t<0&&(t+=h(e,10));var o,r=t.toString(e),a=n-i(r);for(o=0;o<a;o++)r="0"+r;return r.toUpperCase()}function Xt(t,e){var n=qt(t,e);return S(n)?C:n}function Zt(t,e,n){var o=Yt(t,n,e.Qb);return 0<=o&&e.Qb<i(o)&&e.$i?C:o}function Qt(t,e,n,o,r){var a,s=qt(t,n);return S(s)||r&&(s<-r||r-1<s)?C:(a=Yt(s,o,e.Qb),0<=s&&e.Qb<i(a)&&e.$i?C:a)}function Jt(t,e){var n=Number.POSITIVE_INFINITY,o=t.Pi(),r=t.Qi();return y(o)||o===n||y(r)||r===n?C:t.bc(e)}function $t(t,e,n,o){var r=t,i=e,a=n.Pi(),s=n.Qi();return{Ri:t=o?r*a-i*s:r+a,Si:e=o?r*s+i*a:i+s}}function Kt(t,e){var n,o,a,s,l,u,c,f,h=e?1:0,p=0;for(o=0;o<i(t);o++)if(r.Convert.Ca(t[o]))for(c=t[o],a=0;a<c.rowCount;a++)for(s=0;s<c.columnCount;s++){if(!(n=R(c.getValue(a,s))))return C;h=(u=$t(h,p,n,e)).Ri,p=u.Si}else if(r.Convert.Fh(t[o]))for(f=t[o],l=0;l<f.getRangeCount();l++)for(a=0;a<f.getRowCount(l);a++)for(s=0;s<f.getColumnCount(l);s++){if(!(n=R(f.getValue(l,a,s))))return C;h=(u=$t(h,p,n,e)).Ri,p=u.Si}else{if(!(n=R(t[o])))return C;h=(u=$t(h,p,n,e)).Ri,p=u.Si}return Jt(Vt(h,p))}function te(t,e){var n=T(t*c(2)),o=2*n-1;return e.$i&&(o=2*(n=T(e.Qb*c(2)))-1-o),o}function ee(t){return 1-te(t,{$i:!1})}function ne(t){var e,n=["cup","mmHg","J","sec","cel","kel","hh","Wh","wh","flb","BTU"];for(e=0;n[e];e++)if(0===t.localeCompare(n[e]))return!1;return!0}function oe(t,e,n){var o,r,a=0,s=1;for(o=0;t[o].Ld;o++)if(0===n.localeCompare(t[o].Ld))return{Tk:!0,Uk:s,Vk:a=t[o].Sk};if(e)for(o=0;e[o].Ld;o++)n.substr(0,1)===e[o].Ld.substr(0,1)&&ne(n)&&(s=e[o].Sk);for(o=0;t[o].Ld;o++)if(r=i(t[o].Ld),n.substr(1,r)===t[o].Ld.substr(0,r)&&ne(n))return{Tk:!0,Uk:s,Vk:a=t[o].Sk};return{Tk:!1,Uk:s,Vk:a}}function re(t){if(Nt.indexOf(t)>=0)return!1;var e=[t.slice(0,1),t.slice(1)],n=e[0],o=e[1];return Rt.indexOf(n)>=0&&Nt.indexOf(o)>=0}function ie(t){for(var e=0;e<W.length;e++)if(t===W[e].Ld)return!0;return"sec"===t.slice(1)||"s"===t.slice(1)}function ae(t){var e,n,o,r,i,a,s;if(t.indexOf(xt.bit)>-1?(o=(e=[t.slice(0,-3),t.slice(-3)])[0],i=e[1]):t.indexOf(xt.byte)>-1&&(o=(n=[t.slice(0,-4),t.slice(-4)])[0],i=n[1]),o)for(s=0;Mt[s].Ld;s++)o===Mt[s].Ld&&(r=Mt[s].Sk);else r=1;return i===xt.bit?a=Tt[0].Sk:i===xt.byte&&(a=Tt[1].Sk),{Uk:r,Vk:a}}function se(t){var e,n,o=1;if(St[t])return{unit:t};if("K"===St[t.slice(1)]||"kel"===St[t.slice(1)]){for(e=t.slice(0,1),t=t.slice(1),n=0;kt[n].Ld;n++)e===kt[n].Ld&&(o=kt[n].Sk);return{unit:t,prefixNumber:o}}return{unit:void 0}}function le(t,e,n,o){var r,i;if(""===t&&""===e)return b;if(i={value:0},!0===M(t,r={value:0})&&!0===M(e,i)){if(t=r.value,e=i.value,t<0||t>k||t%1!=0)return C;if("bitOperator"===n){if(e<0||e>k||e%1!=0)return C}else if("shiftOperator"===n&&0===t)return 0;return o(t,e)}return b}function ue(t,e){if(""===t)return C;if(!0===t||!1===t)return b;var n=R(t);return n?e(n):C}function ce(t){var e=t.Pi(),n=t.Qi();return Vt(l(e)*I(n,!1),u(e)*I(n,!0))}function fe(t){var e=t.Pi(),n=t.Qi();return Vt(u(e)*I(n,!1),-l(e)*I(n,!0))}function he(t){var e=t.Pi(),n=t.Qi();return Vt(I(e,!0)*u(n),I(e,!1)*l(n))}function pe(t){var e=t.Pi(),n=t.Qi();return Vt(I(e,!1)*u(n),I(e,!0)*l(n))}function de(t,e){var n,o,r=t.Pi(),i=t.Qi(),a=e.Pi(),s=e.Qi();return Math.abs(s)<Math.abs(a)?Vt((r+i*(n=s/a))/(a+s*n),(i-r*n)/(a+s*n)):Vt((i+r*(o=a/s))/(s+a*o),(i*o-r)/(s+a*o))}function ge(t,e){return t.Pi()===e.Pi()&&t.Qi()===e.Qi()}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.k.ac,a=void 0,s=Math.abs,l=Math.sin,u=Math.cos,c=Math.sqrt,f=Math.log,h=Math.pow,p=Math.exp,d=Math.E,g=Math.atan2,m=parseFloat,y=isNaN,v=r.Errors.NotAvailable,C=r.Errors.Number,b=r.Errors.Value,w=r.Functions.ak,T=r.Functions.qk,x=r.Convert.Nh,S=r.Convert.vf,A=r.Functions.MathHelper,I=A.Dk,R=r.Functions.Wi,k=0xffffffffffff,M=r.Convert.Th,N=Vt(1,0),E=.00220462262184878,F=Wt(["g","sg","lbm","u","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","ton","uk_ton","LTON","brton"],[1,685217658567918e-19,E,602214179421676e9,.0352739619495804,15.432358352941462,D=E/100,D,O=E/112,O,O,.00015747304441777001,110231131092439e-20,j=E/2240,j,j]),L=(_=(P=1e4/254)/12)/3,G=Wt(["m","mi","Nmi","in","ft","yd","ang","Pica","ell","ly","pc","pica","survey_mi","parsec","Picapt"],[1,.000621371192237334,1/1852,P,_,L,1e10,2834.64566929134,.8748906386701663,105700083402462e-30,B=324077928966473e-31,236.2204724409449,.00062136994949495,B,2834.64566929134]),W=Wt(["yr","day","hr","mn","sec","d","min","s"],[1,H=365.25,8766,V=525960,z=60*V,H,V,z]),U=Wt(["Pa","atm","mmHg","p","at","psi","Torr"],[1,986923266716013e-20,.007500637554192,1,986923266716013e-20,.000145037737730209,.0075006168270417]),q=Wt(["N","dyn","lbf","dy","pond"],[1,1e5,.22480894309971,1e5,101.971621297793]),X=Wt(["HP","W","h","w","PS"],[1,Y=745.69987158227,1,Y,1.013869665424]),K=Wt(["J","e","c","cal","eV","HPh","Wh","flb","BTU","ev","hh","wh","btu"],[1,1e-7,$=.239005736137667,$,Z=624150964712042e4,Q=1/(3600*Y),1/3600,.737562149277265,J=.000947817120313317,Z,Q,1/3600,J]),tt=Wt(["T","ga"],[1,1e4]),ht=Wt(["tsp","tspm","tbs","oz","cup","pt","qt","uk_qt","gal","uk_gal","l","uk_pt","us_pt","lt","ang3","ang^3","barrel","bushel","ft3","ft^3","in3","in^3","ly3","ly^3","m3","m^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Pica3","Pica^3","Picapt3","Picapt^3","GRT","regton","MTON","L"],[1,.98578431875,1/3,1/6,1/48,1/96,1/192,.00433684471160932,1/768,.00108421117790233,et=.00492892159375,.00867368942321863,1/96,et,nt=492892159375e13,nt,1/32256,.000139870932189991,ot=.00017406322338,ot,rt=.30078125,rt,it=82073596535e-54,it,at=492892159375e-17,at,st=118251117638e-26,st,lt=64467860511e-16,lt,ut=775941468987e-27,ut,ct=112266,ct,ct,ct,ft=1740632233796e-18,ft,4351580584491e-18,et]),pt=Wt(["admkn","kn","m/h","m/hr","m/s","m/sec","mph"],[1,1.00063930885529,1853.184,1853.184,.514773333333333,.514773333333333,1.15151515151515]),wt=Wt(["m2","m^2","ft2","ft^2","in2","in^2","yd2","yd^2","uk_acre","us_acre","ang2","ang^2","ar","ha","Morgen","mi2","mi2","Nmi2","Nmi^2","Pica2","Picapt2","Pica^2","Picapt^2","ly2","ly^2"],[1,1,dt=10.7639104167097,dt,gt=144*dt,gt,mt=dt/9,mt,.000247105381467165,.000247104393046628,1e20,1e20,.01,1e-4,4e-4,yt=mt/3097600,yt,vt=2.91553349598123e-7,vt,Ct=8035216.07043214,Ct,Ct,Ct,bt=111725076312873e-46,bt]),Tt=Wt(["bit","byte"],[1,.125]),xt={bit:"bit",byte:"byte"},St={K:"K",kel:"kel",cel:"cel",C:"C",F:"F",fah:"fah",Rank:"Rank",Reau:"Reau"},At=273.15,It=459.67,kt=Wt(Rt=["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24]),Mt=Wt(["Y","Z","E","P","T","G","M","k","h","e","d","c","m","u","n","p","f","a","z","y","Yi","Zi","Ei","Pi","Ti","Gi","Mi","ki"],[1e24,1e21,1e18,1e15,1e12,1e9,1e6,1e3,100,10,.1,.01,.001,1e-6,1e-9,1e-12,1e-15,1e-18,1e-21,1e-24,Math.pow(2,80),Math.pow(2,70),Math.pow(2,60),Math.pow(2,50),Math.pow(2,40),Math.pow(2,30),Math.pow(2,20),Math.pow(2,10)]),Nt=["sg","lbm","ozm","grain","cwt","shweight","uk_cwt","lcwt","hweight","stone","uk_ton","lcwt","hweight","stone","uk_ton","LTON","brton","ton","mi","Nmi","in","ft","yd","ell","Pica","survey_mi","Picapt","psi","Torr","lbf","HP","h","PS","HPh","flb","BTU","hh","btu","tsp","tspm","tbs","oz","cup","pt","us_pt","uk_pt","qt","UK_qt","gal","uk_gal","barrel","bushel","ft3","ft^3","in3","in^3","mi3","mi^3","yd3","yd^3","Nmi3","Nmi^3","Picapt3","Picapt^3","Pica3","Pica^3","GRT","regton","MTON","kn","admkn","uk_acre","us_acre","ft2","ft^2","in2","in^2","ly2","ly^2","Morgen","mi2","mi^2","Nmi2","Nmi^2","Pica2","Picapt^2","Pica^2","Picapt^2","yd2","yd^2"],Dt={Hi:5},Pt={Hi:8},_t={Hi:8,Oi:!0},Bt=[{Hi:0,aj:"<= 0"},Ft={Hi:2,aj:"< 0"}],Gt=[Et={Hi:0},{Hi:0,_i:0}],Ht=[Ot={Hi:5,aj:["checkLength 10"]},jt={Zi:!0,Hi:2,_i:1,aj:["< 1","> 10"]}],w("BESSELI",(function(t,e){return x(Ut(t,e,!0))}),2,2,Lt=[Et,Ft]),w("BESSELJ",(function(t,e){return x(Ut(t,e,!1))}),2,2,Lt),w("BESSELK",(function(t,e){var n,o,r,i,a,l,u,c,h,p=17976931348623157e292,d=.5772156649015329,g=0,m=.25*t*t,y=1,v=0,C=1,b=2/t;if(e>0){for(v=-d,i=1;i<e;i++)v+=1/i,y*=i+1;if(C=b,1===e)g=1/t;else{for(l=1,u=1,n=a=y/e,i=1;i<e;i++){if(n+=o=(a/=e-i)*(u*=-m)/(l*=i),p-s(o)<s(n)||b>1&&p/b<C)return p;C*=b}if(o=s(n*=.5),C>1&&p/C<o||o>1&&p/o<C)return p;g=n*C}}h=-d,0===e?(v=h,o=1):(v+=1/e,o=1/y),n=(h+v-(c=2*f(t/2)))*o,r=1;do{n+=((h+=1/r)+(v+=1/(r+e))-c)*(o*=m/(r*(r+e))),r++}while(s(o/n)>11102230246251565e-32);return n=.5*n/C,0!=(1&e)&&(n=-n),x(g+=n)}),2,2,Bt),w("BESSELY",(function(t,e){var n=[.0007969367292973471,.08283523921074408,1.239533716464143,5.447250030587687,8.74716500199817,5.303240382353949,1],o=[.0007621256162081731,.07313970569409176,1.1271960812968493,5.112079511468076,8.424045901417724,5.214515986823615,1],r=[.0009244088105588637,.08562884743544745,1.2535274390105895,5.470977403304171,8.761908832370695,5.306052882353947,1],i=[.0005713231280725487,.06884559087544954,1.105142326340617,5.073863861286015,8.399855543276042,5.209828486823619,1],a=[-.011366383889846916,-1.2825271867050931,-19.553954425773597,-93.20601521237683,-177.68116798048806,-147.07750515495118,-51.41053267665993,-6.050143506007285],s=[.05108625947501766,4.982138729512334,75.82382841325453,366.7796093601508,710.8563049989261,597.4896124006136,211.68875710057213,25.207020585802372],h=[64.3178256118178,856.4300259769806,3882.4018360540163,7240.467741956525,5930.727011873169,2062.0933166032783,242.0057402402914],p=[74.23732770356752,1056.4488603826283,4986.410583376536,9562.318924047562,7997.041604473507,2826.1927851763908,336.0936078106983],d=[15592.436785523574,-14663929.59039716,5435264770.518765,-982136065717.9115,87590639439536.7,-0xc5090e8ec6601,0x9d4a5b305a0018,-0x41b52d6418d9ec],g=[1263204747.9017804,-647355876379.1603,114509511541823.73,-8127702555013251,0x2cf35a16e6cd620,-0xacf20aeef158b80],y=[1041.2835366425984,626107.330137135,268919633.39381415,86400248710.3935,20297961275010.555,3171577528429750.5,0x37a4bf79f36ba00],v=[594.3015923461282,235564.09294306856,73481194.44597217,18760131610.870617,3882312774962.3857,620557727146953.8,0xf41f1e2a3d2440,0x3721e321ece8fe00],C=[-4794432209.782018,1956174919465.5657,-249248344360967.72,9708622510473064],b=[-899971225.7055594,452228297998.19403,-72749424522181.83,0xd15a1534be241],w=[499.563147152651,173785.4016763747,48440965.83399621,11185553704.535683,2112775201154.892,310518229857422.56,0x710505f9ecba70,0x17be34c7b662cc00],T=[620.8364781180543,256987.25675774884,83514679.14319493,22151159547.97925,4749141220799.914,784369607876235.9,89522233618462740,0x49de55d9c0a4e400],S=.7978845608028654,A=2.356194490192345,I=.7853981633974483;function R(t,e,n,o){var r=0,i=m(e[r++]),a=n;o&&(i+=t,a--);do{i=i*t+m(e[r++])}while(0!=--a);return i}function k(t,e){var f,d,g,m,y,v=e?n:o,x=e?r:i,k=e?a:s,M=e?h:p,N=e?w:T;return t<=5?(d=t*t,e&&t<1e-5?1-d/4:(g=(d-(e?5.783185962946784:14.681970642123893))*(d-(e?30.471262343662087:49.2184563216946)),g*=f=R(d,e?C:b,3)/R(d,N,8,!0),e?g:g*t)):(f=5/t,g=R(d=e?25/(t*t):f*f,v,6)/R(d,x,6),m=R(d,k,7)/R(d,M,7,!0),(g=g*u(y=t-(e?I:A))-f*m*l(y))*S/c(t))}function M(t,e){var m,C,b,w,T,x=e?n:o,M=e?r:i,N=e?a:s,E=e?h:p,D=e?y:v,O=e?7:8;return t<=5?(m=(e?1:t)*R(C=t*t,e?d:g,e?7:5)/R(C,D,O,!0),m+=.6366197723675814*(e?f(t)*k(t,!0):k(t,!1)*f(t)-1/t)):(m=5/t,b=R(C=e?25/(t*t):m*m,x,6)/R(C,M,6),w=R(C,N,7)/R(C,E,7,!0),(b=b*l(T=t-(e?I:A))+m*w*u(T))*S/c(t))}return x(function(t,e){var n,o=M(t,!0),r=M(t,!1),i=1,a=2*i;if(0===e)return o;if(1===e)return r;do{n=a*r/t-o,o=r,r=n,a+=2,++i}while(i<e);return n}(t,e))}),2,2,Bt),w("BIN2DEC",(function(t){return Xt(t,2)}),1,1,Ot),w("BIN2HEX",(function(t,e){return Qt(t,e,2,16)}),1,2,Ht,a,a,{bk:1}),w("BIN2OCT",(function(t,e){return Qt(t,e,2,8)}),1,2,Ht,a,a,{bk:1}),w("DEC2BIN",(function(t,e){return Zt(t,e,2)}),1,2,[{Hi:0,aj:["< -512","> 511"]},jt],a,a,{bk:1}),w("DEC2HEX",(function(t,e){return Zt(t,e,16)}),1,2,[{Hi:0,aj:["< -549755813888","> 549755813887"]},jt],a,a,{bk:1}),w("DEC2OCT",(function(t,e){return Zt(t,e,8)}),1,2,[{Hi:0,aj:["< -536870912","> 536870911"]},jt],a,a,{bk:1}),w("HEX2BIN",(function(t,e){return Qt(t,e,16,2,512)}),1,2,Ht,a,a,{bk:1}),w("HEX2DEC",(function(t){return Xt(t,16)}),1,1,Ot),w("HEX2OCT",(function(t,e){return Qt(t,e,16,8,536870912)}),1,2,Ht,a,a,{bk:1}),w("OCT2BIN",(function(t,e){return Qt(t,e,8,2,512)}),1,2,Ht,a,a,{bk:1}),w("OCT2DEC",(function(t){return Xt(t,8)}),1,1,Ot),w("OCT2HEX",(function(t,e){return Qt(t,e,8,16,549755813888)}),1,2,Ht,a,a,{bk:1}),w("ERF",te,1,2,[Et,{Zi:!0,Hi:0}],a,a,{bk:1}),w("ERF.PRECISE",(function(t){return te(t,{$i:!1})}),1,1,Et),w("ERFC",ee,1,1,Et),w("ERFC.PRECISE",ee,1,1,Et),w("DELTA",(function(t,e){return r.Zh.Yh(t,e)?1:0}),1,2,Gt,a,a,{bk:1}),w("GESTEP",(function(t,e){return t>=e?1:0}),1,2,Gt,a,a,{bk:1}),w("COMPLEX",(function(t,e,n){return"i"!==n&&"j"!==n?r.Errors.Value:Jt(Vt(t,e),n)}),2,3,[Et,Et,{Hi:5,_i:"i"}],a,a,{bk:2}),w("IMABS",(function(t){return x(c(t.Ri*t.Ri+t.Si*t.Si))}),1,1,Pt),w("IMAGINARY",(function(t){return x(t.Si)}),1,1,Pt),w("IMARGUMENT",(function(t){return 0===t.Ri&&0===t.Si?r.Errors.DivideByZero:x(g(t.Si,t.Ri))}),1,1,Pt),w("IMCONJUGATE",(function(t){return Jt(Vt(t.Ri,-t.Si))}),1,1,Pt),w("IMCOS",(function(t){return Jt(Vt(u(t.Ri)*I(t.Si,!1),-l(t.Ri)*I(t.Si,!0)))}),1,1,Pt),w("IMDIV",(function(t,e){var n=t.Ri,o=t.Si,r=e.Ri,i=e.Si;return Jt(Vt((n*r+o*i)/(r*r+i*i),(o*r-n*i)/(r*r+i*i)))}),2,2,[Pt,_t]),w("IMEXP",(function(t){return Jt(Vt(p(t.Ri)*u(t.Si),p(t.Ri)*l(t.Si)))}),1,1,Pt),w("IMLN",(function(t){var e=t.Ri,n=t.Si;return Jt(Vt(f(c(e*e+n*n)),g(n,e)))}),1,1,_t),w("IMLOG10",(function(t){var e=t.Ri,n=t.Si,o=A.Ek(d,10);return Jt(Vt(o*f(c(e*e+n*n)),o*g(n,e)))}),1,1,_t),w("IMLOG2",(function(t){var e=t.Ri,n=t.Si,o=A.Ek(d,2);return Jt(Vt(o*f(c(e*e+n*n)),o*g(n,e)))}),1,1,_t),w("IMREAL",(function(t){return x(t.Ri)}),1,1,Pt),w("IMSIN",(function(t){return Jt(Vt(l(t.Ri)*I(t.Si,!1),u(t.Ri)*I(t.Si,!0)))}),1,1,Pt),w("IMSQRT",(function(t){var e,n,o=t.Ri,r=t.Si;return 0===o&&0===r?"0":(e=c(o*o+r*r),n=g(r,o),Jt(Vt(c(e)*u(n/2),c(e)*l(n/2))))}),1,1,Pt),w("IMSUB",(function(t,e){return Jt(Vt(t.Ri-e.Ri,t.Si-e.Si))}),2,2,[Pt,Pt]),w("IMPOWER",(function(t,e){var n,o,r=t.Ri,i=t.Si;return 0===r&&0===i?e>0?"0":C:(n=c(r*r+i*i),o=g(i,r),Jt(Vt(h(n,e)*u(e*o),h(n,e)*l(e*o))))}),2,2,[Pt,{Hi:2}]),w("IMPRODUCT",(function(){return Kt(arguments,!0)}),1,255,a,-1,-1),w("IMSUM",(function(){return Kt(arguments,!1)}),1,255,a,-1,-1),w("CONVERT",(function(t,e,n){var o,r,a,s,l,u,c,f,h,p,d;if(se(e).unit&&se(n).unit)return function(t,e,n){var o,r=se(e);switch(r.unit){case St.Rank:o=function(t,e){var n,o=se(e);switch(o.unit){case St.Rank:return t;case St.Reau:return.8*(t-It-32)*5/9;case St.C:case St.cel:return 5*(t-It-32)/9;case St.F:case St.fah:return t-It;case St.K:case St.kel:return n=o.prefixNumber,(At+5*(t-It-32)/9)/n}}(t,n);break;case St.Reau:o=function(t,e){var n,o=se(e);switch(o.unit){case St.Rank:return 1.25*t*9/5+32+It;case St.Reau:return t;case St.C:case St.cel:return 1.25*t;case St.F:case St.fah:return 1.25*t*9/5+32;case St.K:case St.kel:return n=o.prefixNumber,(1.25*t+At)/n}}(t,n);break;case St.C:case St.cel:o=function(t,e){var n,o=se(e);switch(o.unit){case St.Rank:return 9*t/5+32+It;case St.Reau:return.8*t;case St.cel:case St.C:return t;case St.F:case St.fah:return 9*t/5+32;case St.K:case St.kel:return n=o.prefixNumber,(t+At)/n}}(t,n);break;case St.F:case St.fah:o=function(t,e){var n,o=se(e);switch(o.unit){case St.Rank:return t+It;case St.Reau:return 4*(t-32)/9;case St.F:case St.fah:return t;case St.C:case St.cel:return 5*(t-32)/9;case St.K:case St.kel:return n=o.prefixNumber,(5*(t-32)/9+At)/n}}(t,n);break;case St.K:case St.kel:o=function(t,e){var n,o=se(e);switch(o.unit){case St.Rank:return 9*t/5;case St.Reau:return.8*(t-At);case St.C:case St.cel:return t-At;case St.F:case St.fah:return 9*(t-At)/5+32;case St.K:case St.kel:return n=o.prefixNumber,t/n}}(t*r.prefixNumber,n)}return o}(t,e,n);if(1===(o=function(t,e){var n=t.indexOf("bit")>-1||t.indexOf("byte")>-1,o=e.indexOf("bit")>-1||e.indexOf("byte")>-1;return n&&o?2:o||n?1:0}(e,n)))return v;if(2===o)return function(t,e,n){var o=ae(e),r=ae(n);return t*o.Uk/o.Vk*r.Vk/r.Uk}(t,e,n);if(ie(e)&&ie(n))return function(t,e,n){var o=oe(W,kt,e),r=oe(W,kt,n);return t*o.Uk/o.Vk*r.Vk/r.Uk}(t,e,n);if(re(e)||re(n))return v;for(r=[F,G,U,q,K,X,tt,ht,tt,pt,wt],a=0;a<i(r);a++)if(u=(l=oe(s=r[a],kt,e)).Tk,c=l.Vk,f=l.Uk,h=(l=oe(s,kt,n)).Tk,p=l.Uk,d=l.Vk,u&&h&&0!==c&&0!==p)return t*f/c*d/p;return v}),3,3,[{Hi:1},Dt,Dt]),w("BITAND",(function(t,e){return le(t,e,"bitOperator",(function(t,e){return t&e}))}),0,2),w("BITLSHIFT",(function(t,e){return le(t,e,"shiftOperator",(function(t,e){if(e>=48)return C;if(e<0&&t<1<<-e)return 0;var n=t<<e;return n>k?C:n}))}),0,2),w("BITOR",(function(t,e){return le(t,e,"bitOperator",(function(t,e){return t|e}))}),0,2),w("BITRSHIFT",(function(t,e){return le(t,e,"shiftOperator",(function(n,o){return o>53?C:e>=0?t>>e:t<<-e}))}),0,2),w("BITXOR",(function(t,e){return le(t,e,"bitOperator",(function(t,e){return t^e}))}),0,2),w("IMCOSH",(function(t){return ue(t,(function(t){return Jt(pe(t),t.lja())}))}),1,1),w("IMCOT",(function(t){return ue(t,(function(t){return ge(ce(t),Vt(0,0))?C:Jt(de(fe(t),ce(t)),t.lja())}))}),1,1),w("IMCSC",(function(t){return ue(t,(function(t){return ge(t,Vt(0,0))?C:Jt(function(t){return de(N,ce(t))}(t),t.lja())}))}),1,1),w("IMCSCH",(function(t){return ue(t,(function(t){return ge(he(t),Vt(0,0))?C:Jt(function(t){return de(N,he(t))}(t),t.lja())}))}),1,1),w("IMSEC",(function(t){return ue(t,(function(t){return ge(fe(t),Vt(0,0))?C:Jt(function(t){return de(N,fe(t))}(t),t.lja())}))}),1,1),w("IMSECH",(function(t){return ue(t,(function(t){return ge(pe(t),Vt(0,0))?C:Jt(function(t){return de(N,pe(t))}(t),t.lja())}))}),1,1),w("IMSINH",(function(t){return ue(t,(function(t){return Jt(he(t),t.lja())}))}),1,1),w("IMTAN",(function(t){return ue(t,(function(t){return Jt(function(t){return de(ce(t),fe(t))}(t),t.lja())}))}),1,1)},"./src/functions-fin.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt;function wt(t){return t.getMonth()}function Tt(t){return t.getDate()}function xt(t){return t.getFullYear()}function St(t){return t instanceof Date?o.Common.l.Ra(t):t}function At(t,e,n){var o=xt(e)-xt(t),i=wt(e)-wt(t)+12*o,a=Tt(e)-Tt(t),s=-1;return 0===n?s=r.Functions.uk(t,e):u(n,[1,2,3])>=0?s=St(e)-St(t):4===n&&(s=30*i+a),s}function It(t,e,n,o,r){var i,s=w(1+t,e),l=a(s)?s:E;return 0===t?e:d(l)||(i=a(s=(s-1)/t)?s:E,d(i))?E:a(s=(-n*l-o)/((1+t*r)*i))?s:E}function Rt(t,e,n,o){var r=xt(e),i=wt(e),a=Tt(e),s=new Date(1,0,1),l=0,u=a===_(r,i),c=12/n,f=r-xt(t);s.setFullYear(1),f>0&&(f=(f-1)*n);do{f++,(s=new Date(r,i,a)).setMonth(i-f*c),u&&(l=_(xt(s),wt(s)),s=new Date(xt(s),wt(s),l))}while(L(t,s)<0);return o&&(f--,(s=new Date(r,i,a)).setMonth(i-f*c),u&&(l=_(xt(s),wt(s)),s=new Date(xt(s),wt(s),l))),s}function kt(t,e,n,o){return B(Rt(t,e,n,!1),t,o)}function Mt(t,e,n,o){return u(o,[0,2,4,5])>=0?360/n:3===o?365/n:B(Rt(t,e,n,!1),Rt(t,e,n,!0),1)}function Nt(t,e,n,o){return B(t,Rt(t,e,n,!0),o)}function Et(t,e,n){var o=xt(e),r=wt(e),i=Tt(e),a=new Date(o,r,i),l=r-wt(t)+12*(o-xt(t));if(a.setMonth(wt(a)-l),i===_(o,r))for(;Tt(a)!==_(xt(a),wt(a));)a.setDate(Tt(a)+1);return Tt(t)>=Tt(a)&&l--,s(""+(1+l/(12/n)))}function Dt(t,e,n){return e>0?(n.Wk?n.Xk?T(t-n.Yk)<T(n.Zk-n.Yk)&&(n.Zk=t,n.$k=e):e<n.$k&&(n.Zk=t,n.$k=e):(n.Zk=t,n.$k=e,n.Wk=!0),[!1,n]):e<0?(n.Xk?n.Wk?T(t-n.Zk)<T(n.Zk-n.Yk)&&(n.Yk=t,n._k=e):-e<-n._k&&(n.Yk=t,n._k=e):(n.Yk=t,n._k=e,n.Xk=!0),[!1,n]):isNaN(e)?[!1,n]:(n.al=t,[!0,n])}function Ot(t,e,n,o,r){var i,a=Rt(t,n,o,!0),s=Rt(t,n,o,!1);if(L(a,e)>=0)return B(t,e,r)/Mt(s,a,o,r);for(i=B(t,a,r)/Mt(s,a,o,r);;){if(s=new Date(xt(a),wt(a),Tt(a)),a.setMonth(wt(a)+12/o),L(a,e)>=0)return i+B(s,e,r)/Mt(s,a,o,r);i+=1}}function jt(t,e,n,o,r,i,a){var l,u=kt(t,e,i,a),c=Nt(t,e,i,a),f=Mt(t,e,i,a),h=s(""+Et(t,e,i)),p=0,d=100*n/i,g=1+o/i,m=c/f;for(l=0;l<h;l++)p+=d/w(g,m+l);return r/w(g,h-1+c/f)+p-u/f*d}function Ft(t,e,n,o,r,i,a,l,u){var c,f,h,p=B(l,t,a),d=B(t,u,a),g=B(l,u,a),m=Mt(t,e,i,a),y=s(""+Et(t,e,i)),v=100*n/i,C=1+o/i;if(d>m)switch(a){case 0:case 4:c=B(u,e,a),y=1+s(""+x(c/m));break;default:for(f=new Date(xt(u),wt(u),Tt(u)),y=0;y<32767;y++)if(h=new Date(xt(f),wt(f),Tt(f)),f.setMonth(wt(f)+12/i),L(f,e)>=0){y+=s(""+x(B(h,e,a))/Mt(h,f,i,a))+1;break}p=m*Ot(l,t,u,i,a),d=m*Ot(t,u,u,i,a),g=m*Ot(l,u,u,i,a)}return r/w(C,y-1+d/m)+v*(g/m/w(C,d/m)+w(C,-d/m)*(w(C,-y)-1/C)/(1/C-1)-p/m)}function Pt(t,e){var n=t.substr(0,3),o={ATS:13.7603,BEF:40.3399,DEM:1.95583,ESP:166.386,EUR:1,FIM:5.94573,FRF:6.55957,GRD:340.75,IEP:.787564,ITL:1936.27,LUX:40.3399,LUF:40.3399,NLG:2.20371,PTE:200.482,SIT:245.18};return o[n]?j(o[n],e):-1}function _t(t,e,n,o,r){var i=w(1+t,e);return-(0===t?o+n*e:o*i+n*(r>0?1+t:1)*(i-1)/t)}function Lt(t,e,n,o,r,i,a){if(i<r||i>n||0!==a&&1!==a)return E;var s,l,u=function(t,e,n,o,r){var i,a=w(1+t,e);return 0===t?i=(n+o)/e:(i=o*t/(a-1)+n*t/(1-1/a),r>0&&(i/=1+t)),-i}(e,n,o,0,a),c=0;for(1===r&&(t&&(c=u),a<=0&&(c+=t?o*e:-o),r++),s=r;s<=i;s++)l=a>0?_t(e,s-2,u,o,1)-u:_t(e,s-1,u,o,0),c+=t?u-l*e:l;return t?c:c*e}function Bt(t,e,n,o){var r=w(1+n,o),i=-(t*r*n+e*(r-1));return a(i)?i:E}function Gt(t,e,n,o,r){return u(o,[1,2,4])<0||L(e,n)>=0?E:t(e,n,o,r)}function Ht(t,e,n,o,r,i){if(u(i,[1,2,4])<0||L(e,n)>0)return E;var a=function(t,e,n,o){var r,i=0,a=0;for(t*=100/y(n),e/=n,e++,r=1;r<o;r++)i+=r*t/w(e,r);for(i+=o*(t+100)/w(e,o),r=1;r<o;r++)a+=t/w(e,r);return(i/=a+=(t+100)/w(e,o))/y(n)}(o,r,i,Et(e,n,i));return t?a/(1+r/i):a}function Vt(t,e,n,o,r,i,a,s,l){var c,f,h,p;if(u(a,[1,2,4])<0||L(e,n)>0||L(o,e)>0)return E;c=new Date(xt(o),wt(o),Tt(o));do{c.setMonth(wt(c)+12/a)}while(L(c,n)<0);return f=Ot(o,e,c,a,s),h=Ot(o,n,c,a,s),p=Ot(e,n,c,a,s),t?(i*a+100*r*(h-f*(1+l*p/a)))/(l*p+a):(a*(i-l)+100*r*(h-f))/(p*l+100*r*f*p/a)}function zt(t,e,n){var o,r,i;return 0===n?M:(o=e<0?x(e):I(e),r=w(10,x(O.Ek(n,10))),i=e-o,g(o+(t?i*r/n:i*n/r)))}function Wt(t,e,n,o){var r,i,a=h(e),s=0,l=1+t,u=0;if(l>=.75&&l<=1.25&&a>12&&o&&(u=2.5),n)for(r=0;r<a;r++){if(i=-(r-u)*e[r]*Math.pow(l,-(r-u)-1),isNaN(i))return s;s+=i}else for(r=0;r<a;r++){if(i=e[r]*Math.pow(l,-(r-u)),isNaN(i))return s;s+=i}return s}function Ut(t,e,n,o){var r,i,s=0,l=h(e);for(t<=-1&&(t=1e-10-1),r=0;r<l;r++){if((i=St(o[r])-St(o[0]))<0)return[!1,n];s+=e[r]/O.Ck(t,i/365)}return a(s)?n=isNaN(s)?5e-324:s:s===Number.POSITIVE_INFINITY?n=F:s===Number.NEGATIVE_INFINITY&&(n=-F),[!0,n]}function qt(t,e,n,o){var r,i,a;return t>-1&&0!==t?(i=w(1+t,(r=n).bl-(o?1:0)),a=(w(1+t,r.bl)-1)/t,[!0,e=o?-r.cl*a/t+i*r.bl*(r.dl+r.cl*(r.Nc+1/t)):r.dl*i+r.cl*(1+t*r.Nc)*a+r.el,n]):[!1,e,n]}function Yt(t,e,n,o,r,i,a,s,l,u,f,h,p,d,g){var m,y,v,C,b=0,w=0,T=n-r,x=n+r,S=2===t;if(T<i.fl&&(T=n),x>i.gl&&(x=n),T===x)return S?[!1,o,i,a]:[!1,o,i];if(0===t?(m=e(a,s,l,T,f,h,p,d,g)-u,y=e(a,s,l,x,f,h,p,d,g)-u):1===t?(m=e(T,a,b,s),y=e(x,a,w,s)):(m=qt(T,b,a),y=qt(x,w,a)),c(m)){if(C=m[2],b=m[1],!(v=m[0]))return S?[v,o,i,C]:[v,o,i]}else b=m;if(c(y)){if(C=y[2],w=y[1],!(v=y[0]))return S?[v,o,i,C]:[v,o,i]}else w=y;return o=(w-b)/(x-T),S?[!0,o,i,C]:[!0,o,i]}function Xt(t,e,n,o,r,i,a,s,l,u,c,f,h){var p;return o<n.fl||o>n.gl?[!1,n]:(n=(p=Dt(o,t?Wt(o,r):e(r,i,a,o,l,u,c,f,h)-s,n))[1],[!!p[0],n])}function Zt(t,e,n){var o,r,i=0;return e<t.fl||e>t.gl?[!1,t,n]:(n=(o=qt(e,i,n))[2],i=o[1],o[0]?(t=(r=Dt(e,i,t))[1],[!!r[0],t,n]):[o[0],t,n])}function Qt(t,e,n,o,r,i,a,s,l,u){var c,f,h,p,d=0,g=t?15:2;if(!n.Wk||!n.Xk)return t?[!1,n,o]:[!1,n];for(f=T(n.Zk-n.Yk)/(T(n.Zk)+T(n.Yk)),c=0;c<100+4*g;c++)if(0,0,void 0,h=c%4==0?1:c%4==2?2:3,void 0,n=(p=t?ne(n,o,f,d,0,h):e?oe(!0,n,d,0,0,h,Ut,f,r,o,Yt):oe(!1,n,d,0,0,h,jt,f,i,a,s,o,r,l,u))[1],t&&(o=p[2]),d=t?p[3]:p[2],p[0])return t?[!0,n,o]:[!0,n];return t?[!1,n,o]:[!1,n]}function Jt(t,e,n,o,r,i,a,s,l,u,c){var h,p,d,g,m,y,v,w=0,x=t?15:2;if(!e.Wk||!e.Xk)return[!1,e];for(p=T(e.Zk-e.Yk)/(T(e.Zk)+T(e.Yk)),h=0;h<100+4*x;h++)if(d=0,g=0,void 0,m=h%4==0?1:h%4==2?2:3,e=(y=t?oe(!0,e,w,d,g,m,Wt,p,b,n,Yt):oe(!1,e,w,d,g,m,Ft,p,a,s,l,n,o,u,c,r,i))[1],w=y[2],d=y[3],!(t&&y[0]===C||!t&&f(y[0]))){if(y[0])return[!0,e];if(e=(v=Dt(d,g=t?Wt(d,n):Ft(n,o,a,d,l,u,c,r,i)-s,e))[1],v[0])return[!0,e];if((p=T(e.Zk-e.Yk)/(T(e.Zk)+T(e.Yk)))<e.hl)return e._k<g&&(g=e._k,d=e.Yk),e.$k<g&&(d=e.Zk),e.al=d,[!0,e]}return[!1,e]}function $t(t,e,n,o,r,i,a,s,l,u,f,h,p){var d,g,m,y,v,C,b,w,x,S,A,I,R,k,M,N,E,D,O=n.hl/2,j=!1;for(g=0;g<20;g++){if(o<n.fl||o>n.gl){if(!t||n.Xk&&n.Wk||!(o<=-1))return[!1,n];o=-1,j=!0}if(v=t?Ut(o,r,0,i):e(r,i,a,o,l,u,f,h,p)-s,c(v)){if(y=v[1],!(m=v[0]))return[m,n]}else y=v;if(n=(C=Dt(o,y,n))[1],C[0])return[!0,n];if(j)return[!1,n];if(b=n.Xk&&n.Wk?T(n.Zk-n.Yk):n.gl-n.fl,w=(T(o)<1e-10?b:T(o))/1e6,x=0,n=(C=t?Yt(1,Ut,o,x,w,n,r,i):Yt(0,e,o,x,w,n,r,i,a,s,l,u,f,h,p))[2],x=C[1]<0?C[1]:-C[1],!(m=C[0]))return[m,n];if(0===x)return[!1,n];if((S=o-1.000001*y/x)===o)return n.al=o,[!0,n];if(t&&n.Xk&&n.Wk&&(S<(I=(A=[n.Zk,n.Yk])[0])==S<(R=A[1])&&(k=!0,I>R&&(I=(d=[R,I])[0],R=d[1],k=!1),N=(M=[n.$k,n._k])[0],E=M[1],S=I+T((k?N:E)/(E-N))*(R-I))),D=T(S-o)/(T(o)+T(S)),o=S,D<O)return n.al=o,[!0,n]}return[!1,n]}function Kt(t,e,n){for(var o,r,a,s,l,u,c,f=t.hl/2,h=0;0===e[h];)h++;for(o=e.slice(h),a=[!1,null],s=[n],.1!==n&&s.push(.1),s.push(-.1,.99*t.gl,t.fl+.01),l=0;!a[0]&&l<s.length;l++)te(a=ee(i(t),o,s[l],f),o);if(!a[0]){for(u=0,l=1,c=o.length;l<c;l++)u+=o[l];r=-u/o[0]-1,a=ee(i(t),o,r,f)}return a}function te(t,e){var n,r,i,a;t[0]&&(r=15,"number"==typeof(n=t[1].al)&&n>-10&&n<10&&(((i=""+n).indexOf("000000000000")>1||i.indexOf("999999999999")>1)&&(r=14)),((a=re(n=o.Common.o.Lma(n,r),e))>.001||a<-.001)&&(t[0]=!1))}function ee(t,e,n,o){var r,i,a,s,l,u;for(r=0;r<32;r++){if(n<t.fl||n>t.gl)return[!1,t];if(t=(a=Dt(n,i=Wt(n,e,!1,!0),t))[1],a[0])return[!0,t];if(0===(s=Wt(n,e,!0,!0)))return[!1,t];if((l=n-1.0000001*i/s)===n)return t.al=n,[!0,t];if(u=T(l-n)/(T(n)+T(l)),n=l,u<o)return t.al=n,[!0,t]}return[!1,t]}function ne(t,e,n,o,r,i){var a,s,l,u,c,f,h;if(1===i){if(void 0,e=(s=qt(a=(t.Zk+t.Yk)/2,r,e))[2],r=s[1],!s[0])return[C,t,e,o];if(0===r)return[!0,t=Dt(a,r,t)[1],e,o];if(0===A(r*r-t.$k*t._k))return[C,t,e,o]}else if(2===i){if(l=void 0,void 0,u=0,c=0,n>.1)return ne(t,e,n,o,r,i=3);if(0===(f=o++%4))l=t.Zk,u=t.$k;else if(2===f)l=t.Yk,u=t._k;else if(e=(s=qt(l=(t.Zk+t.Yk)/2,u,e))[2],u=s[1],!s[0])return[C,t,e,o];if(e=(h=Yt(2,void 0,l,c,T(t.Zk-t.Yk)/1e6,t,e))[3],t=h[2],c=h[1],!h[0]||0===c)return[C,t,e,o];if((a=l-1.01*u/c)<t.Zk&&a<t.Yk||a>t.Zk&&a>t.Yk)return[C,t,e,o]}return[!1,t,e,o]}function oe(t,e,n,o,r,i,a,s,l,u,f,h,p,d,g,m,y){var v,b,w,x,S,I,R,k;switch(i){case 0:o=e.Zk-e.$k*((e.Yk-e.Zk)/(e._k-e.$k));break;case 1:if(o=(e.Zk+e.Yk)/2,v=t?a(o,u,r,l):a(h,p,l,o,f,d,g,m,y)-u,c(v)){if(r=v[1],!v[0])return[C,e,n,o,r,i]}else r=v;if(0===r)return[!0,e=Dt(o,r,e)[1],n,o,r,i];if(0===(b=A(r*r-e.$k*e._k)))return[C,e,n,o,r,i];o+=(o-e.Zk)*r/b;break;case 3:o=(e.Zk+e.Yk)/2;break;case 2:if(w=void 0,x=0,void 0,I=0,s>.1)return oe(t,e,n,o,r,i=3,a,s,l,u,f,h,p,d,g);if(0===(R=n++%4))w=e.Zk,x=e.$k;else if(2===R)w=e.Yk,x=e._k;else if(w=(e.Zk+e.Yk)/2,v=t?a(w,u,x,l):a(h,p,l,w,f,d,g,m,y)-u,c(v)){if(x=v[1],!v[0])return[C,e,n,o,r,i]}else x=v;if(S=T(e.Zk-e.Yk)/1e6,e=(k=t?f(1,a,w,I,S,e,u,l):Yt(0,a,w,I,S,e,h,p,l,u,f,d,g,m,y))[2],I=k[1],!k[0]||0===I)return[C,e,n,o,r,i];if((o=w-1.01*x/I)<e.Zk&&o<e.Yk||o>e.Zk&&o>e.Yk)return[C,e,n,o,r,i]}return v=t?a(o,u,r,l):a(h,p,l,o,f,d,g,m,y)-u,c(v)&&(r=v[1],!v[0])?[C,e,n,o,r,i]:Dt(o,r,e)[0]?[!0,e,n,o,r,i]:(s=T(e.Zk-e.Yk)/(T(e.Zk)+T(e.Yk)))<e.hl?(e._k<r&&(r=e._k,o=e.Yk),e.$k<r&&(r=e.$k,o=e.Zk),e.al=o,[!0,e,n,o,r,i]):[!1,e,n,o,r,i]}function re(t,e){var n,o,r,i=arguments,a=0,s=1;for(o=1;o<h(i);o++){if((r=m(i[o],1,!0,!0,!1,!0)).isError)return r[0];for(n=0;n<h(r);n++)r[n]!==v&&(a+=r[n]/w(1+t,s++))}return a}function ie(t,e,n){return St(Rt(t,e,n,!0))}function ae(t,e,n){return St(Rt(t,e,n,!1))}function se(t,e,n,o){var r,i,a=o.hl,s=o.Xk&&o.Wk?[o.Zk,o.Yk]:function(t,e,n,o){for(var r=.5,i=n-r,a=n+r,s=0;Ut(i,t,0,e)[1]*Ut(a,t,0,e)[1]>0&&s++<o;)i-=r,a+=r;return s>=o?[0,0]:[i,a]}(t,e,n,100),l=s[0],u=s[1],c=Ut(l,t,0,e)[1],f=Ut(u,t,0,e)[1],h=0;for(r=0;r<100&&!(c*f>0);r++)if((i=Ut(h=(l+u)/2,t,0,e)[1])*c<0?(u=h,f=i):(l=h,c=i),T(l-u)<a)return[T(i)<1||T(c+f)<1,h];return[!1,h]}function le(t,e,n,o,r){var i,a,s,l=r/n;return l>=1?(l=1,a=1===o?t:0):a=t*w(1-l,o-1),(i=a-((s=t*w(1-l,o))<e?e:s))<0?0:i}function ue(t,e,n,o,r,i){var a,s,l,u=0,c=0,f=x(r),h=f,p=t-e,d=!1;for(l=1;l<=h;l++)d?s=c:(c=p/(o-(l-1)))>(a=le(t,e,n,l,i))?(s=c,d=!0):(s=a,p-=a),l===h&&(s*=r+1-f),u+=s;return u}function ce(t,e,n,o){var r,i,a;return""===t&&""===e&&""===n?N:(t=H(t,r={value:0}),e=H(e,i={value:0}),n=H(n,a={value:0}),!0===t&&!0===e&&!0===n?o(r,i,a):N)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.j.C4,a=isFinite,s=parseInt,l=o.Common.j,u=l.Ea,c=l.Ca,f=l.Fa,h=o.Common.k.ac,p=r.Convert.Rh,d=r.Convert.vf,g=r.Convert.Nh,m=r.Convert.Ph,y=r.Convert.Pa,v=r.Convert.CalcConvertedError,C=null,b=void 0,w=Math.pow,T=Math.abs,x=Math.ceil,S=Math.log,A=Math.sqrt,I=Math.floor,R=Math.max,k=Math.min,M=r.Errors.DivideByZero,N=r.Errors.Value,E=r.Errors.Number,D=r.Functions.ak,O=r.Functions.MathHelper,j=O.Ak,F=r.Functions.hk,P=r.Functions.lk,_=r.Functions.nk,L=r.Functions.mk,B=r.Functions.pk,G=r.Functions.vk,H=r.Convert.Th,V=2.98023e-9,q={Hi:0,aj:"< 1"},Y={Hi:0,aj:"< 0"},X={_i:.1,Hi:0},Z={_i:2,Hi:0},Q={_i:1e3,Hi:0,aj:"<= 0"},$={Hi:5},K={_i:!1,Hi:7},ot={_i:0,Hi:2},it={Hi:2,aj:"= 0",bj:M},st={Hi:4,Ii:1,Ji:!0,Ki:!0},lt={Hi:4,Ii:1,Ji:!0,Mi:!0,Ki:!0},ut={Hi:4,Ii:4,Ji:!0,Ki:!0,Mi:!0,breakOnConvertError:!0},ct={Hi:4,Ii:1,Ji:!0,Ki:!0,breakOnConvertError:!0},ft={Hi:4,Ii:11,Ji:!0,Ki:!0,breakOnConvertError:!0},ht=[J={Hi:6},J,tt={Hi:2},rt={_i:0,Hi:2,aj:["< 0","> 4"]}],pt=[J,J,z={Hi:0},z,tt,rt],dt=[J,J,U={Hi:0,aj:"<= 0"}],gt=[z,J,J,z,tt,U,{_i:0,Hi:2,aj:["< 0","> 4","= 2"]}],yt=[J,J,U,U,rt],vt=[U,et={Hi:2,aj:"<= 0"},U,nt={Hi:2,aj:"< 1"},tt,tt],Ct=[U,nt],bt=[z,at={Hi:2,aj:"< 0"}],D("FV",(function(t,e,n,o,r){r=r?1:0;var i=w(1+t,e);return g(-(i=0===t?n*e+o:o*i+n*(1+t*r)*(i-1)/t))}),3,5,mt=[z,z,z,W={_i:0,Hi:0},W],b,b,{bk:[3,4]}),D("FVSCHEDULE",(function(t,e){for(var n=0;n<h(e);n++)e[n]!==v&&(t*=1+e[n]);return t}),2,2,[z,st],1,1),D("NPV",re,2,b,z,"> 0","> 0"),D("PV",(function(t,e,n,o,r){if(r=r?1:0,0===t)return g(-(n*e+o));var i=w(1+t,e);return-1===t?M:g(-(o+n*(1+t*r)*(i-1)/t)/i)}),3,5,mt,b,b,{bk:[3,4]}),D("RECEIVED",(function(t,e,n,o,r){var i,a,s;return L(t,e)>=0?E:(i=At(t,e,r),a=P(t,r),i<=0||a<=0?E:(s=1-o*i/a)<=0?E:n/s)}),4,5,yt,b,b,{bk:3}),D("XNPV",(function(t,e,n){var o,r=h(e),i=0;if(r!==h(n))return E;if(e.some((function(t){return t===v})))return N;for(o=0;o<r;o++)i+=e[o]/w(1+t,(n[o]-n[0])/365);return i}),3,3,[z,ct,ct],"!= 0","!= 0"),D("CUMIPMT",(function(t,e,n,o,r,i){return Lt(!1,t,e,n,o,r,i)}),6,6,vt),D("CUMPRINC",(function(t,e,n,o,r,i){return Lt(!0,t,e,n,o,r,i)}),6,6,vt),D("IPMT",(function(t,e,n,o,r,i){return e>=n+1||0!==i&&1!==i?E:Bt(o,It(t,n,o,r,i),t,e-1)}),4,6,[z,q,q,z,W,ot],b,b,{bk:[4,5]}),D("ISPMT",(function(t,e,n,o){return g(o*t*(e/n-1))}),4,4,[z,tt,it,z]),D("PMT",(function(t,e,n,o,r){r=r?1:0;var i=w(1+t,e);return g(-(i=0===t?(n+o)/e:(n*i+o)/((1+t*r)*(i-1)/t)))}),3,5,[z,{Hi:0,aj:"= 0",bj:M},z,W,W],b,b,{bk:[3,4]}),D("PPMT",(function(t,e,n,o,r,i){var a,s;return i=i?1:0,e>=n+1?E:(a=It(t,n,o,r,i),d(a)||(s=Bt(o,a,t,e-1),d(s))?E:a-s)}),4,6,[z,q,z,z,W,W],b,b,{bk:[4,5]}),D("COUPDAYBS",(function(t,e,n,o){return Gt(kt,t,e,n,o)}),3,4,ht,b,b,{bk:3}),D("COUPDAYS",(function(t,e,n,o){return Gt(Mt,t,e,n,o)}),3,4,ht,b,b,{bk:3}),D("COUPDAYSNC",(function(t,e,n,o){return Gt(Nt,t,e,n,o)}),3,4,ht,b,b,{bk:3}),D("COUPNCD",(function(t,e,n){return Gt(ie,t,e,n)}),3,4,ht,b,b,{bk:3}),D("COUPNUM",(function(t,e,n){return Gt(Et,t,e,n)}),3,4,ht,b,b,{bk:3}),D("COUPPCD",(function(t,e,n){return Gt(ae,t,e,n)}),3,4,ht,b,b,{bk:3}),D("DURATION",(function(t,e,n,o,r){return Ht(!1,t,e,n,o,r)}),5,6,pt,b,b,{bk:5}),D("MDURATION",(function(t,e,n,o,r){return o<0||n<0?E:Ht(!0,t,e,n,o,r)}),5,6,pt,b,b,{bk:5}),D("NPER",(function(t,e,n,o,r){return r=r?1:0,0===t?0===e?M:g(-(n+o)/e):g(S((e*(1+t*r)-o*t)/(n*t+e*(1+t*r)))/S(1+t))}),3,5,[{Hi:0,aj:"<= -1"},z,z,W,W],b,b,{bk:[3,4]}),D("YIELD",(function(t,e,n,o,r,i,a){var s,l,c,f,h,p,d;if(u(i,[1,2,4])<0||L(t,e)>0)return E;if(Et(t,e,i)<=1)return s=kt(t,e,i,a),l=Nt(t,e,i,a),(r/100+n/i-(o/100+s/(c=Mt(t,e,i,a))*n/i))/(o/100+s/c*n/i)*(i*c/l);if(p=(d=$t(!1,jt,p={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},h=.1,t,e,n,o,r,i,a))[1],!(f=d[0])){for(h=1e-10;h<p.gl;h*=2)p=Xt(!1,jt,p,h,t,e,n,o,r,i,a)[1];p=(d=Qt(!1,!1,p,t,e,n,o,r,i,a))[1],f=d[0]}return f?p.al:E}),6,7,[J,J,Y,U,U,tt,rt],b,b,{bk:6}),D("YIELDDISC",(function(t,e,n,o,r){return L(t,e)>=0?E:(o/n-1)/G(t,e,r)}),4,5,[J,J,U,U,rt],b,b,{bk:3}),D("YIELDMAT",(function(t,e,n,o,r,i){var a;return L(t,e)>=0?E:(a=1+G(n,e,i)*o,a/=r/100+G(n,t,i)*o,a--,a/=G(t,e,i))}),5,6,[J,J,J,Y,U,rt],b,b,{bk:5}),D("AMORDEGRC",(function(t,e,n,o,r,i,a){var s=1/i;return s>0&&s<1||s>1&&s<2||s>2&&s<3||s>4&&s<5||L(e,n)>0?E:function(t,e,n,o,r,i,a){var s,l,u,c,f,h=1/i;if(i*=h<3?1:h<5?1.5:h<=6?2:2.5,c=G(e,n,a),d(c))return 0;for(u=(t-=l=I(c*i*t+.5))-o,s=0;s<r;s++){if((u-=l=I(i*t+.5))<0)return 0===(f=r-s)||1===f?I(.5*t+.5):0;t-=l}return l}(t,e,n,o,r,i,a)}),6,7,gt,b,b,{bk:6}),D("AMORLINC",(function(t,e,n,o,r,i,a){return L(e,n)>0?E:function(t,e,n,o,r,i,a){var s,l,u,c=t*i,f=t-o,h=G(e,n,a);return d(h)?0:(l=(t-o-(s=h*i*t))/c,u=p((t-o-s)/c),0===r?s:r<=u?c*(l<1?l:1):r===u+1?f-c*u-s:0)}(t,e,n,o,r,i,a)}),6,7,gt,b,b,{bk:6}),D("ODDFYIELD",(function(t,e,n,o,r,i,a,s,l){var c,f,h,p=.1;if(u(s,[1,2,4])<0||L(n,t)>0||L(t,o)>0||L(o,e)>0)return E;if(c=(f=$t(!1,Ft,c={fl:0,gl:1e3,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},p,t,e,r,i,a,s,l,n,o))[1],h=f[0]){for(p=1e-10;p<c.gl;p*=2)c=Xt(!1,Ft,c,p,t,e,r,i,a,s,l,n,o)[1];c=(f=Jt(!1,c,t,e,n,o,r,i,a,s,l))[1],h=f[0]}return h?c.al:E}),8,9,[J,J,J,J,Y,U,U,tt,rt],b,b,{bk:8}),D("ODDLYIELD",(function(t,e,n,o,r,i,a,s){return Vt(!1,t,e,n,o,i,a,s,r)}),7,8,[J,J,J,Y,U,U,z,rt],b,b,{bk:7}),D("ODDLPRICE",(function(t,e,n,o,r,i,a,s){return Vt(!0,t,e,n,o,i,a,s,r)}),7,8,[J,J,J,Y,Y,U,tt,rt],b,b,{bk:7}),D("TBILLEQ",(function(t,e,n){var o,r=St(e)-St(t);return L(t,e)>=0||r>365?E:0===(o=360-n*r)?M:o<0?E:g(365*n/o)}),3,3,dt),D("TBILLYIELD",(function(t,e,n){var o=St(e)-St(t);return L(t,e)>=0||o>365?E:(100-n)/n*(360/o)}),3,3,dt),D("IRR",(function(t,e){var n,o,r,i,a,s=h(t),l=[],u=!1,c=!1,f={fl:-1,gl:9999999,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0};for(T(e)>1&&(e=.1),n=-1,o=0,r=0;r<s;r++)(i=t[r])!==v&&(0!==i&&(o=l.length+1,-1===n&&(n=l.length)),l.push(i),i>0&&(u=!0),i<0&&(c=!0));return l=l.slice(n,o+1),!u||!c||h(l)<2?E:(f=(a=Kt(f,l,e))[1],a[0]?f.al:E)}),1,2,[lt,X],0,0,{bk:1}),D("MIRR",(function(t,e,n){var o,r,i,a,s=0,l=0,u=0,c=0,f=0,p=[],d=h(t);if(d<2)return M;for(o=0;o<d;o++)(r=t[o])!==v&&(p.push(r),u++,0!==r&&(r>0?s++:l++));if(l<1||s<1)return M;for(i=0;i<u;i++)0!==(a=p[i])&&(a>0?c+=a/w(1+n,i):f+=a/w(1+e,i));return 0===f||0===c||n<=-1?M:w(-c*w(1+n,u)/(f*(1+n)),1/(u-1))-1}),3,3,[lt,z,z],0,0),D("XIRR",(function(t,e,n){var o,r,i,a,s,l,u,c=h(t);if(c!==h(e))return E;for(i=c-1;i>=0;i--)o=t[i]>0||o,r=t[i]<0||r,e[i]===v&&(0!==t[i]?e[i]=0:(t.splice(i,1),e.splice(i,1)));return o&&r?0===t[0]?0===n?4.88281e-9:V:(a=(s=$t(!0,Yt,a={fl:-1,gl:1e10,hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0},n,t,e))[1],s[0]?(l=a.al,Math.abs(l)<a.hl?V:l):(u=se(t,e,n,a))[0]?u[1]:E):E}),2,3,[ft,ut,X],"!= 2","!= 2",{bk:2}),D("RATE",(function(t,e,n,o,r,i){var a,s,l,u,c,f;if(r=r?1:0,a=w(17976931348623157e282,1/t),u=function(t,e,n){var o,r,i,a,s,l,u,c,f=t.hl/2;for(o=0;o<100;o++){if(void 0,void 0,a=void 0,s=0,l=0,n<t.fl||n>t.gl)return[!1,t,e];if(e=(u=qt(n,s,e))[2],s=u[1],!(a=u[0]))return[a,t,e];if(t=(c=Dt(n,s,t))[1],c[0])return[!0,t,e];if(e=(u=qt(n,l,e,!0))[2],l=u[1],!(a=u[0]))return[a,t,e];if(0===l)return[!1,t,e];if((r=n-1.000001*s/l)===n)return t.al=n,[!0,t,e];if(i=T(r-n)/(T(n)+T(r)),n=r,i<f)return t.al=n,[!0,t,e]}return[!1,t,e]}(s={hl:1e-10,Wk:!1,Zk:0,$k:0,Xk:!1,Yk:0,_k:0,al:0,fl:R(-1e10,1-a),gl:k(1e10,a-1)},l={bl:t,cl:e,dl:n,el:o,Nc:r},i),l=u[2],s=u[1],!(c=u[0])){for(f=2;(!s.Xk||!s.Wk)&&f<100;f*=2)l=(u=Zt(s,i*f,l))[2],l=(u=Zt(s=u[1],i/f,l))[2],s=u[1];s=(u=Qt(!0,!1,s,l))[1],c=u[0]}return c?s.al:E}),3,6,[U,z,z,W,{_i:0,Hi:2,aj:"< 0",bj:N},X],b,b,{bk:[3,4,5]}),D("VDB",(function(t,e,n,o,r,i,a){return r<o?E:t<e&&0===o&&1===r?t-e:function(t,e,n,o,r,i,a){var s,l,u,c,f=I(o),h=f,p=x(r),d=p,g=0;if(a)for(s=h+1;s<=d;s++)l=le(t,e,n,s,i),s===h+1?l*=k(r,f+1)-o:s===d&&(l*=r+1-p),g+=l;else u=n,c=void 0,o!==I(o)&&i>1&&o>=n/2&&(c=o-n/2,o=n/2,r-=c,u+=1),t-=ue(t,e,n,u,o,i),g=ue(t,e,n,n-o,r-o,i);return g}(t,e,n,o,r,i,a)}),5,7,[Y,Y,at,Y,Y,Z,K],b,b,{bk:[5,6]}),D("ACCRINT",(function(t,e,n,o,r,i,a){var s,l,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A;if(u(i,[1,2,4])<0||L(t,n)>=0)return E;if(1===i||0===a||4===a)return function(t,e,n,o,r,i,a){var s=At(t,n,a),l=P(t,a);return s<0||l<=0?E:r*o*(s/l)}(t,0,n,o,r,0,a);for(s=t.getFullYear(),l=t.getMonth(),c=t.getDate(),f=n.getFullYear(),h=n.getMonth(),p=n.getDate(),d=e.getMonth(),g=e.getDate(),m=[],y=[],v=[],C=[31,28,31,30,31,30,31,31,30,31,30,31],b=0;b<i;b++)m[b]=(d+12*b/i)%12,y[b]=g<=C[m[b]]?g:C[m[b]],2===a?v[b]=360/i:3===a&&(v[b]=365/i);for(b=0;b<i;b++)T=m[w=b===i-1?0:b+1]>m[b]?2001:2002,v[b]=St(new Date(T,m[w],y[w]))-St(new Date(2001,m[b],y[b]));for(x=0,S=St(n);s<f||s===f&&l<h||s===f&&l===h&&c<p;){for(b=0;b<i&&(l<m[b]||l===m[b]&&c<y[b])&&(0===b||m[b]>m[b-1]);)b++;for(;b<i&&(l>m[b]||l===m[b]&&c>=y[b])&&(l!==m[++b-1]||c!==y[b-1]););w=--b===i-1?0:b+1,T=l+12/i>=12?s+1:s,A=St(new Date(s,l,c)),x+=r*o/i*(Math.min(St(new Date(T,m[w],y[w])),S)-A)/v[b],s=T,l=m[w],c=y[w]}return x}),6,8,[J,J,J,U,Q,tt,rt],b,b,{bk:[4,6,7]}),D("ACCRINTM",(function(t,e,n,o,r){if(L(t,e)>0)return E;var i=At(t,e,r),a=P(t,r);return i<0||a<=0?E:o*n*i/a}),3,5,[J,J,U,Q,rt],b,b,{bk:[3,4]}),D("DISC",(function(t,e,n,o,r){if(L(t,e)>=0)return E;var i=P(t,r),a=At(t,e,r);return a<=0||i<=0?E:(o-n)/o*(i/a)}),4,5,[J,J,U,U,rt],b,b,{bk:3}),D("EFFECT",(function(t,e){return w(1+t/e,e)-1}),2,2,Ct),D("INTRATE",(function(t,e,n,o,r){if(L(t,e)>=0)return E;var i=At(t,e,r),a=P(t,r);return i<=0||a<=0?E:(o-n)/n*(a/i)}),4,5,yt,b,b,{bk:3}),D("NOMINAL",(function(t,e){return e*(w(1+t,1/e)-1)}),2,2,Ct),D("DB",(function(t,e,n,o,r){var i,a,s,l;if(n+(r<12?1:0)<o)return E;if(0===t)return 0;for(i=j(1-w(e/t,1/n),3),a=0,s=0,l=1;l<=o;l++)a+=s=1===l?t*i*r/12:l===n+1?(t-a)*i*(12-r)/12:(t-a)*i;return s}),4,5,[Y,z,nt,nt,{_i:12,Hi:2,aj:["< 1","> 12"]}],b,b,{bk:3}),D("DDB",(function(t,e,n,o,r){var i,a=0,s=0;if(n<o)return E;if(t<=e)return 0;for(i=1;i<=o;i++)a+=s=k(s=r/n*(t-a),t-a-e);return s}),4,5,[Y,z,et,et,{_i:2,Hi:0,aj:"<= 0"}],b,b,{bk:3}),D("SLN",(function(t,e,n){return(t-e)/n}),3,3,[z,z,it]),D("SYD",(function(t,e,n,o){return o>n?E:(t-e)*(n-o+1)*2/(n*(n+1))}),4,4,[z,Y,nt,et]),D("DOLLARDE",(function(t,e){return e<1?M:zt(!0,t,e)}),2,2,bt),D("DOLLARFR",(function(t,e){return 0===e?M:zt(!1,t,e)}),2,2,bt),D("PRICE",(function(t,e,n,o,r,i,a){return u(i,[1,2,4])<0||L(t,e)>0?E:jt(t,e,n,o,r,i,a)}),6,7,[J,J,Y,Y,U,tt,rt],b,b,{bk:6}),D("PRICEDISC",(function(t,e,n,o,r){if(L(t,e)>=0)return E;var i=At(t,e,r),a=P(t,r);return i<=0||a<=0?E:o-n*o*i/a}),4,5,yt,b,b,{bk:3}),D("PRICEMAT",(function(t,e,n,o,r,i){var a,s,l,u,c;return L(t,e)>=0?E:(a=At(t,e,i),s=At(n,e,i),l=At(n,t,i),u=P(t,i),l<=0||u<=0||a<=0||s<=0?E:0===(c=1+a/u*r)?E:(100+s/u*o*100)/c-l/u*o*100)}),5,6,[J,J,J,Y,Y,rt],b,b,{bk:5}),D("ODDFPRICE",(function(t,e,n,o,r,i,a,s,l){return u(s,[1,2,4])<0||L(n,t)>0||L(t,o)>0||L(o,e)>0?E:Ft(t,e,r,i,a,s,l,n,o)}),8,9,[J,J,J,J,Y,Y,U,tt,rt],b,b,{bk:8}),D("TBILLPRICE",(function(t,e,n){var o=St(e)-St(t);return L(t,e)>=0||o>365?E:100*(1-n*o/360)}),3,3,[J,J,U]),D("EURO",(function(t){var e=Pt(t,2);return e>=0?e:E}),1,1,$),D("EUROCONVERT",(function(t,e,n,o,r){var i,a,s,l;return i=0,o||(i=function(t){var e=t.substr(0,3);return u(e,["BEF","LUF","ESP","ITL","LUX"])>=0?0:2}(n)),r.$i||(r.Qb=function(t){var e=t.substr(0,3);return u(e,["BEF","LUF","ESP","ITL","PTE","GRD","LUX"])>=0?0:2}(e)),s=Pt(e,r.Qb),l=Pt(n,r.Qb),s>=0&&l>=0?(a=t*l/s,o||(a=j(a,i)),a):N}),3,5,[z,$,$,K,{Zi:!0,Hi:2,_i:3,aj:"< 3",bj:N}],b,b,{bk:[3,4]}),D("PDURATION",(function(t,e,n){return ce(t,e,n,(function(t,e,n){var o,r;return e.value>0&&t.value>0&&n.value>0?(o=(Math.log(n.value)-Math.log(e.value))/Math.log(1+t.value),(r=Math.abs(o))<=179769e303?r>=22250738585072014e-324?o:0:M):E}))}),3,3),D("RRI",(function(t,e,n){return ce(t,e,n,(function(e,n,o){if(n.value>0&&e.value>0&&o.value>=0){t=Math.pow(o.value/n.value,1/e.value)-1;var r=Math.abs(t);if(r<=179769e303)return r>=22250738585072014e-324?t:0}return E}))}),3,3)},"./src/functions-lookup.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function U(t,e,n,o){return{row:t,col:e,rowCount:n,colCount:o}}function q(t,e,n){var o,r;return f(t)?i:t.isArray||t.isReference?(e>(o=t.colCount)&&(r=e,e=n,n=r),t[n*o+e]):t[0]}function Y(t,e,n){return!((!n||null!==t&&null!==e)&&(f(e)||!((f(t)||v(t,!0))&&v(e,!0)||M(t)&&M(e))&&(!N(t)||!N(e))))}function X(t,e,n,o,r){if(t<0||e<0||e<t||n<t||n>e)return-1;if(r)return E=t,D=e,j=n,F=o,P=o,O=n;if(F){if(++O>D){if(F!==P)return-1;O=j-1,F=!1}}else if(--O<E){if(F!==P)return-1;O=j+1,F=!0}return O}function Z(t,e,n){var o=c(t),r=n;return o===e?r=0:o>e?r=1:o<e&&(r=2),r}function Q(t,e,n){var r,i,a,s;if(t===e)return 0;if(N(t)){if(!e&&0===h(""+t))return 0;if(v(e)&&!v(t))return 1;if(M(e))return 2;if(N(e)){r=void 0;try{r=(i=o.Common.CultureManager.getCultureInfo()).localeCompare?n?i.localeCompare(""+t,""+e):i.localeCompare(t.toLowerCase(),e.toLowerCase()):n?(""+t).localeCompare(""+e):t.toLowerCase().localeCompare(e.toLowerCase())}catch(o){r=n?(""+t).localeCompare(""+e):t.toLowerCase().localeCompare(e.toLowerCase())}return r<0?r=2:r>0&&(r=1),r}return e instanceof Date?Z(t,e,1):-1}return N(e)?t||0!==h(""+e)?v(t)?2:M(t)?1:t instanceof Date?Z(t,e,2):-1:0:M(t)&&v(e)?1:M(e)&&v(t)?2:(a=C(t))===(s=C(e))?0:a<s?2:1}function J(t,e,n){var o=q(t,e,n);return f(o)?0:o}function $(t,e,n,o){var r,a,s,l,u=-1,c=0,f=-1,h=-1,p=o?e.rowCount:e.colCount;if(--p<c)return-1;for(;c<=p;){for(r=i,void 0,s=t[0],n>=1!=(2===u)&&(f=h),a=h=X(c,p,h=m((c+p)/2),n>=0,!0);!Y(s,r)&&-1!==h&&!Y(s,r=o?q(e,0,h):q(e,h,0));)h=X(0,0,0,!1,!1),n>=0&&h<a?p=h:n<0&&h>a&&(c=h);if(-1===h&&n>=1!=(2===u))return f;if(-1===h)return-1;if(u=Q(s,r,!1),n>=1&&1===u)c=h+1;else if(n>=1&&2===u)p=h-1;else if(n<=-1&&1===u)p=h-1;else if(n<=-1&&2===u)c=h+1;else if(0===u){for(;n<=-1&&h>c||n>=0&&h<p;){if(0,l=n>=0?h+1:h-1,null===(r=o?J(e,0,l):J(e,l,0)))return-1;if(!Y(s,r))break;if(0!==(u=Q(s,r,!1)))break;h=l}return h}}return n>=1!=(2===u)?h:f}function K(t,e,n,o,r,a){var l,u,c,f,h,p,d=i,g=-1,m=t[0],y=N(m),v=s.zb(m),C=o?e.rowCount:e.colCount;for(y&&v&&(c=s.sb(v)),u=0;u<C;u++)if(h=r?C-1-u:u,Y(m,f=o?q(e,0,h):q(e,h,0),a))if(p=N(f),y&&p&&v?(c.lastIndex=0,l=c.test(f)?0:1):l=Q(m,f,!1),n>=1&&1===l)l=-1,g>=0&&(l=Q(f,d,!1)),(g<0||g>=0&&1===l)&&(g=h,d=f);else if(n<=-1&&2===l)l=-1,g>=0&&(l=Q(f,d,!1)),(g<0||g>=0&&2===l)&&(g=h,d=f);else if(0===l)return h;return g}function tt(t,e){var n,o;if(!e)for(n=h(t),o=void 0,o=1;o<n;o++)if(2===Q(t[o-1],t[o],!1))return!1;return!0}function et(t,e,n){var o,i,s,l,u;if(!t)return x;if(t.arrayFormulaMode,n?0:1,!(e=e!==a?e:t.getReference(t.source,U(t.row,t.column,t.rowCount,t.columnCount)))||1!==e.getRangeCount())return x;if(s=[],n){if(l=e.getRow(0)+1,(i=e.getRowCount(0))>1){for(o=0;o<i;o++)s.push([l+o]);return new r.CalcArray(s)}return l}if(u=e.getColumn(0)+1,(i=e.getColumnCount(0))>1){for(o=0;o<i;o++)s.push(u+o);return new r.CalcArray([s])}return u}function nt(t,e,n,o,r){if(r&&n>e.colCount||!r&&n>e.rowCount)return S;var i=o?$(t,e,1,r):K(t,e,0,r);return i>=0?r?J(e,n-1,i):J(e,i,n-1):A}function ot(t,e,n,o){return nt(t,e,n,o,!1)}function rt(t,e,n,o){return nt(t,e,n,o,!0)}function it(t,e,n,o){var r,i,a,l,u,c,h,p,d,g,m,y=e;if(!y.isArray&&!y.isReference)return A;if(r=y.colCount,i=y.rowCount,r>1&&i>1)return x;if(2===n&&(2===o||-2===o))return x;if(a=2===o&&!tt(y,!0),l=-2===o&&!tt(y,!1),a||l)return A;if(u=t,c=t&&t[0],h=-1,f(n)&&(n=0),(f(o)||0===o)&&(o=1),-1===o&&(p=!0),0!==n&&2!==n||(d=0),1===o||-1===o){if(1===n)d=-1;else if(-1===n){if(s.ub(c))return A;d=1}h=K(u,y,d,i>1,p,!0)}else if(2===o||-2===o){if(1===r&&1===i){if(0,!Y(c,g=y[0]))return A;if(0===(m=Q(c,g,!1)))return 1;if(0===n)return 0===m?1:A;if(1===n)return 2===m?1:A;if(-1===n)return 1===m?1:A}h=$(u,y,d=2===o?1:-1,i>1)}return-1===h?A:0!==n||gt(c,y[h])?gt(c,y[h])?h+1:2===o&&1===n||-2===o&&-1===n?h+2:h+1:A}function at(t,e,n,o){return t+=e,o?0!==n&&(t+="[",t+=""+n,t+="]"):t+=n,t}function st(t,e,n){n||(t+="$");for(var r=t.length;e>.1;e=parseInt(""+(e-1)/26,10))t=o.Common.u.Eb(t,r,String.fromCharCode("A".charCodeAt(0)+(e-1)%26));return t}function lt(t,e){if(e&&0<h(e)){var n=void 0,o=!r.ei(e[0])&&"_"!==e[0];for(n=1;!o&&n<h(e);n++)o=!r.fi(e[n])&&"_"!==e[n];o?(t+="'",t+=e.replace("'","''"),t+="'"):t+=e,t+="!"}return t}function ut(t,e){var n;return void 0===e&&(e=!1),b(t)||w(t)?n=t.toArray(0,!1):t.length&&t[0].length&&(n=t),n?ct(n,e):g(t)?t:x}function ct(t,e){var n,o,r,i,a,s,l;if(void 0===e&&(e=!1),o=t.rowCount,r=t.colCount,o||r||(o=t.length,r=t[0].length),i=t,e){for(i=[],a=0;a<r;a++)for(s=[],i.push(s),l=0;l<o;l++)s.push(t[l][a]);o=(n=[r,o])[0],r=n[1]}return i.rowCount=o,i.colCount=r,i}function ft(t){return 1===t||-1===t}function ht(t,e){var n=e.length;t.sort((function(t,o){var i,a,s,l;for(i=0;i<n;i++)if(s=(a=e[i])[0],0!==(l=r.gOb(t[s],o[s])))return a[1]?l:-l;return 0}))}function pt(t,e,n){if(n)t.forEach((function(t,n){t.push(e[n][0])}));else{var o=e[0];t.forEach((function(t,e){t.push(o[e])}))}}function dt(t,e,n){var o,i,a,s,l,u,c,f,h,p,d,m,y,v,C,T,S,A,I,R,k,M,N,E,D;for(void 0===n&&(n=1),o=[],i=3;i<arguments.length;i++)o[i-3]=arguments[i];if(l=0,u=0,c=x,w(t)?a=t:b(t)&&(l=(s=t).getRow(),u=s.getColumn()),f=a||s){if(h=f.getColumnCount(),p=f.getRowCount(),g(t))return c;for(d=[],m=void 0,y=0,v=0,C=void 0,T=void 0,S=1,A=arguments.length;S<A;S+=2){if(R=ut(I=arguments[S]),g(R))return c;if(k=I.getRowCount(),M=I.getColumnCount(),y||(y=(m=1===M)?2:1,T=ut(t,!m)),!(!m&&1===k&&M===h||m&&1===M&&k===p))return c;if(N=w(I),b(I)&&(E=void 0,m?(E=u-I.getColumn())>=0&&E<h?C=E:N=!0:(E=l-I.getRow())>=0&&E<p?C=E:N=!0),N&&(v+=1,C=m?h++:p++,pt(T,R,m)),!ft(D=arguments[S+1]||1))return c;d.push([C,1===D])}return ht(T,d),v&&T.forEach((function(t){t.length-=v})),new r.CalcArray(m?T:ct(T,!0))}return c}function gt(t,e){return!!(t===e||p(t)&&p(e)&&d(t)===d(e)||g(t)&&g(e)&&t._code===e._code)}function mt(t,e){var n,o;for(n=0,o=t.length;n<o;n++)if(!gt(t[n],e[n]))return!1;return!0}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=null,a=void 0,s=o.Common.q,l=o.Common.j,u=o.Common.l,c=u.lb,f=l.Fa,l.G,h=o.Common.k.ac,p=u.Ska,d=u.Ra,g=r.Convert.vf,m=r.Convert.Rh,y=r.Convert.Sh,v=r.Convert.Na,C=r.Convert.Pa,b=r.Convert.Fh,w=r.Convert.Ca,T=r.Convert.bc,x=r.Errors.Value,S=r.Errors.Reference,A=r.Errors.NotAvailable,I=r.Errors.Null,R=r.Errors.Calc,k=r.Functions.ak,M=r.Functions.ik,N=r.Functions.jk,_=r.CalcReference.prototype,function(t){function e(e,n,o,r,i,a){var s,l=t.call(this,e,[U(n,o,r,i)])||this;return l.getValue=function(t,e,n){var o=this,r=o.Nc;return 0===r?o.getRow(0)+1+e:1===r?o.getColumn(0)+1+n:_.getValue.call(o,t,e,n)},(s=l).cj=n,s.Lk=o,s.Xj=r,s.Yj=i,s.Nc=a,l}W(e,t),e.prototype.type=function(){return this.Nc},e.prototype.toArray=function(t,e){var n,o,r,i,a,s,l=this,u=[],c=l.cj,f=l.Lk,h=l.Nc,p=l.getRangeCount(),d=l.Xj,g=l.Yj;for(n=0;n<p;n++)for(e||(r=[],u.push(r)),a=0;a<d;a++)for(e||(i=[],r.push(i)),s=0;s<g;s++)o=0===h?c+1+a:1===h?f+1+s:_.getValue.call(l,n,c+a,f+s),e?u.push(o):i.push(o);return e||1!==p||(u=u[0]),u.rowCount=d,u.colCount=g,u.rangeCount=p,u}}(r.CalcReference),L=function(t){function e(e){var n=t.call(this,a)||this;return n.il=e,n}return W(e,t),e.prototype.getRowCount=function(){return r.CalcArrayHelper.getColumnCount(this.il)},e.prototype.getColumnCount=function(){return r.CalcArrayHelper.getRowCount(this.il)},e.prototype.getValue=function(t,e){return r.CalcArrayHelper.getValue(this.il,e,t)},e}(r.CalcArray),H={Hi:2},V={Hi:2,aj:"<= 0",bj:x},z={Hi:4,Ii:0,Ji:!0},k("ADDRESS",(function(t,e,n,o,r){var i=3===n||4===n||7===n||8===n,a=2===n||4===n||6===n||8===n,s="";return t<1&&(o||!i)||t>1048576||e<1&&(o||!a)||e>16384||n<1||8<n?x:(s=lt(s,r),o?s=function(t,e,n){return n||(t+="$"),t+e}(s=st(s,e,a),t,i):(s=at(s,"R",t,i),s=at(s,"C",e,a)),s)}),2,5,[G={Hi:2},G,{_i:1,Hi:2},B={_i:!0,Hi:7},{_i:"",Hi:5}],a,a,{bk:[2,3,4]}),k("INDEX",(function(t,e,n,o,s){var l,u,c,p,d,g,v,C,b,w,T,A,I;function R(t){return!f(t)&&!t._error}if(l=i,c=(u=t instanceof r.EvaluateContext?t:a)!==i&&u.acceptsReference,p=u!==i&&u.arrayFormulaMode,e instanceof r.CalcReference){if(d={value:-1},g=e,s===a&&(s=1),(s=R(s)&&y(s,d)?d.value-1:l)>=g.getRangeCount())return S;if(s===l||s<0)return x;if(v=g.getRowCount(s),C=g.getColumnCount(s),b=g.getRow(s),w=g.getColumn(s),T=void 0,A=void 0,3===h(arguments)){if(1!==v&&1!==C)return S;1!==C?(o=n,n=1):1!==v&&(o=1)}if(n===a&&(n=0),-1===(n=R(n)&&y(n,d)?d.value-1:l)){if(1!==v&&!c&&!p&&(b>u.row||u.row>=b+v))return x}else{if(n<-1||n===l)return x;if(v<=n)return S;T=n+b}if(o===a&&(o=0),-1===(o=R(o)&&y(o,d)?d.value-1:l)){if(1!==C&&!c&&!p&&(w>u.column||u.column>=w+C))return x}else{if(o<-1||o===l)return x;if(C<=o)return S;A=o+w}return-1===n&&-1===o?g.create([U(b,w,v,C)]):-1===n?g.create([U(b,A,v,1)]):-1===o?g.create([U(T,w,1,C)]):g.create([U(T,A,1,1)])}if(r.Convert.Ca(e))return v=(I=e).getRowCount(),n=n!==a?m(n):-1,o=o!==a?m(o):-1,1!==(s=s!==a?m(s)-1:1)?S:(-1===n&&-1===o?n=o=0:-1===o&&1===v&&(o=n,n=1),n=-1===n?0:n,o=-1===o?0:o,v=I.getRowCount(),C=I.getColumnCount(),n<0||o<0||s<0?x:(n>v&&1===v&&o===a&&(o=n,n=0),v<n||C<o?S:0===n&&0===o?I.slice(0,0,v,C):0===n?I.slice(0,o-1,v,1):0===o?I.slice(n-1,0,1,C):I.getValue(n-1,o-1)))}),2,4,a,0,0,{bk:[1,2,3],dk:!0,fk:3}),k("OFFSET",(function(t,e,n,o,i,s){var l,u,c,f,h,p,d,g,y;return t?e&&e instanceof r.CalcReference&&1===e.getRangeCount()?(i=i!==a?m(i):e.getRowCount(0),s=s!==a?m(s):e.getColumnCount(0),l=e.getRow(0)+n,u=e.getColumn(0)+o,i<=0||s<=0||l<0||u<0?S:(c=e.create([{row:l,col:u,rowCount:i,colCount:s}]),f=t.row,h=t.column,p=t.source.getCalcSourceModel().qg(f,h),c.ck=!0,d=e.getSource(),p&&d.getRangeKey&&(g={id:d.id,row:l,col:u,rowCount:i,colCount:s},y=d.getRangeKey(d,g),p.eOb||(p.eOb={}),p.eOb[y]=g),c)):x:A}),3,5,[{},G,G],0,0,{bk:[3,4],dk:!0,fk:2,returnReference:!0}),k("ROW",(function(t,e){return et(t,e,!0)}),0,1,a,-1,a,{dk:!0,ek:-1,expandColumns:!1}),k("COLUMN",(function(t,e){return et(t,e,!1)}),0,1,a,-1,a,{bk:0,dk:!0,ek:-1,expandRows:!1}),k("ROWS",(function(t){return r.CalcArrayHelper.getRowCount(t)}),1,1,a,-1,-1,{ek:-1,expandColumns:!1,ck:!0}),k("COLUMNS",(function(t){return r.CalcArrayHelper.getColumnCount(t)}),1,1,a,-1,-1,{ek:-1,expandRows:!1,ck:!0}),k("TRANSPOSE",(function(t){return new L(t)}),1,1,a,-1,-1),k("LOOKUP",(function(t,e,n){var o,i,s,l,u,c,h,p=[];if(e)for(o=0;o<e.length;o++)f(e[o])||p.push(e[o]);if(e.colCount<=e.rowCount?(p.colCount=e.colCount,p.rowCount=Math.ceil(p.length/p.colCount)):(p.rowCount=e.rowCount,p.colCount=Math.ceil(p.length/p.rowCount)),f(e.isReference)||(p.isReference=e.isReference),f(e.isArray)||(p.isArray=e.isArray),p.rangeCount=e.rangeCount,-1,l=p.colCount,u=p.rowCount,c=t,n===a)return h=l>u?ot(c,p,u,!0):rt(c,p,l,!0),g(h)?A:h;if(s=r.Convert.Ph(n,0,!0,!1,!1)){if(s.colCount>1&&s.rowCount>1)return A}else s=p;return(i=$(c,p,1,!(l>u)))>=0?(l=s.colCount)>(u=s.rowCount)?J(s,i,u-1):J(s,l-1,i):A}),2,3,[z,{Hi:4,Ii:0,Ji:!0,xTa:!0}],"!= 0","!= 0",{fk:1}),k("HLOOKUP",ot,3,4,[z,z,V,B],1,1,{bk:3}),k("VLOOKUP",rt,3,4,[z,z,V,B],1,1,{bk:3,TAb:!0}),k("XLOOKUP",(function(t,e,n,o,i,a){var s,l,u,c,f,h,p,d,g,m,y=n.getRowCount(),v=n.getColumnCount(),C=1===e.rowCount&&e.colCount>=1,b=1===y&&v>=1;if(C&&e.colCount!==v||!C&&e.rowCount!==y)return x;if((s=it(t,e,i,a))===A)return"string"==typeof o?o:A;if(s===x)return x;if(s>0){if(s-=1,l=[],r.Convert.Ca(n)){if(C)for(u=0;u<y;u++)c=n.getValue(0,s),l.push([c]);else f=b?[n.getValue(0,s)]:[n.getValue(s,0)],l.push(f);return new r.CalcArray(l)}if(n instanceof r.CalcReference)return p=(h=n).getRow(),d=h.getColumn(),g=y,m=v,C?(d=h.getColumn()+s,m=1):(p=h.getRow()+s,g=1),h.create([{row:p,col:d,rowCount:g,colCount:m}])}}),3,6,[z,z,{},{Hi:5},{Hi:2,_i:0},{Hi:2,_i:1}],[1,2],[1,2],{bk:[3,4,5]}),k("CHOOSE",(function(t){var e=arguments;return t<1||h(e)<=t?x:f(e[t])?0:e[t]}),2,255,G,">= 1",">= 1",{gk:">= 1",isBranch:!0,findTestArgument:0,findBranchArgument:function(t){var e={value:-1};return g(t)?-1:(y(t,e),e.value)}}),k("MATCH",(function(t,e,n){var o,r,s,l=t,u=e;return u.isArray||u.isReference?(o=u.colCount,r=u.rowCount,s=-1,o>1&&r>1||1===n&&!tt(u,!0)||-1===n&&!tt(u,!1)?A:(n===a?n=1:n===i&&(n=0),1===n?s=$(l,u,1,r>1):0===n?s=K(l,u,0,r>1):-1===n&&(s=$(l,u,-1,r>1)),-1===s?A:s+1)):A}),2,3,[z,z,H],1,1,{}),k("XMATCH",it,2,4,[z,z,H,H],1,1,{}),k("INDIRECT",(function(t,e,n){var o,i,a,s,u,c,f,h,p,d,g,m,y;return t?e?(a={row:o=t.row,col:i=t.column},(s=t.parser)||(s=t.parser=new r.Parser),(c=(u=t.source).parserContext)?(c.useR1C1=!n,c.row=a&&a.row||0,c.column=a&&a.col||0,c.baseIdentity=a,c.source=t.source):(u.parserContext=c=t.source?t.source.getParserContext(!n,a):new r.ParserContext(t.source,!n,a),c.onlyValidateSourceNameWithSpecial=!0),n?f=s.parse(c,e):((p=u.expressions)||(p=u.expressions={}),(f=p[e])||(f=s.parse(c,e),p[e]=f)),f?(8===f.type&&(f.source?f=(h=f.source).getCustomName(f.value):f=t.getName(f.value)),!f||l.Ea(f.type,[1,13])<0?S:(h=f.source||t.source,25===f.type||26===f.type?h.getValueByName(f.nameIdentity):(d=f.getRange(o,i),13===f.type&&(h=f.source),g=t.source.getCalcSourceModel().qg(o,i),m=null,1!==d.rowCount||1!==d.colCount||t.acceptsReference||t.arrayFormulaMode?((m=h.getReference(d)).ck=!0,d.id=h.id,g&&h.getRangeKey&&(y=h.getRangeKey(h,d),g.eOb||(g.eOb={}),g.eOb[y]=d)):(m=h.getValue(d.row,d.col),g&&(g.fOb||(g.fOb={}),g.fOb[e]=f)),m))):S):S:A}),1,2,[{Hi:5},B],a,a,{bk:2,dk:!0}),k("HYPERLINK",(function(t,e){var n,o="__proto__";return(n=T(2===arguments.length?e:t))[o].hyperlink=T(t),n}),1,2),k("AREAS",(function(){var t,e=0;for(t=0;t<h(arguments);t++){if(0===arguments[t].length)return I;arguments[t].isReference&&(e+=arguments[t].rangeCount)}return e}),1,a,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),k("FORMULATEXT",(function(t,e){var n=e.getRow(0),o=e.getColumn(0),r=e.getSource().getCalcSourceModel().getFormula(n,o);return r?"="+r:A}),1,1,a,-1,a,{dk:!0}),k("ISFORMULA",(function(t,e){var n=e.getRow(0),o=e.getColumn(0);return!!e.getSource().getCalcSourceModel().getFormula(n,o)}),1,1,a,-1,a,{dk:!0}),k("SORT",(function(t,e,n,o){var i,a,s,l,u,c,f,h,p,d,m,y,v,C,T,S,A,I,R,k,M;if(void 0===e&&(e=1),void 0===n&&(n=1),void 0===o&&(o=!1),i=ut(t,o),g(i))return i;if(a=i,s=[],b(e)||w(e)){if(h=(f=e.toArray(0,!1)).rowCount,p=f.colCount,d=0,b(n)||w(n)){if(d=(u=n.toArray(0,!1)).rowCount,1!==p){if(p<1||1!==u.colCount&&u.colCount!==p||1!==h||!function(t){if(t&&t.length&&t.length>=0){for(var e=0;e<t.length;e++)if("number"!=typeof t[e])return!1;return!0}return!1}(f[0]))return x;if((m=[]).push(t),o)for(a=ct(a,o),y=0;y<p;y++){for(v=[],C=0;C<a[0].length;C++)v.push(a[f[0][y]-1][C]);m.push(new r.CalcArray([v])),1===d?m.push(u[0][0]):m.push(u[y][0])}else for(y=0;y<p;y++){for(v=[],C=0;C<a.length;C++)v.push([a[C][f[0][y]-1]]);m.push(new r.CalcArray(v)),1===d?m.push(u[0][0]):m.push(u[y][0])}return dt.apply(dt,m)}if(1!==u.colCount||1!==d&&d!==h)return x;1===d&&(d=0,c=u[0][0])}else c=n;for(l=0;l<h;l++)s.push([f[l][0],l<d?u[l][0]:c])}else if(b(n)||w(n)){if(1!==(u=n.toArray(0,!1)).colCount||1!==u.rowCount)return x;s.push([e,u[0][0]])}else s.push([e,n]);for(T=a.colCount,S=[],A=0,I=s;A<I.length;A++){if(k=(R=I[A])[0],M=R[1],k<1||k>T||!ft(M))return x;S.push([k-1,1===M])}return ht(a,S),new r.CalcArray(o?ct(a,o):a)}),1,4,a,[0,1,2],[0,1,2],{bk:[1,2,3]},!0),k("SORTBY",dt,2,a,a,[0,"%= 1"],[0,"%= 1"],a,!0),k("UNIQUE",(function(t,e,n){var o,i,a,s;return void 0===e&&(e=!1),void 0===n&&(n=!1),o=ut(t,e),g(o)?o:(a=[],s=(i=o).rowCount,i.forEach((function(t,e){var o,r,l;if(!t.duplicated){for(o=0,r=e+1;r<s;r++)mt(t,l=i[r])&&(l.duplicated=!0,o++);n&&0!==o||a.push(t)}})),new r.CalcArray(e?ct(a,e):a))}),1,3,a,[0],[0],{bk:[1,2]},!0),k("FILTER",(function(t,e,n){var o,i,a,s=ut(t);return g(s)?s:(o=s,i=[].concat(ut(e)),a=[],o.forEach((function(t,e){i[e][0]&&a.push(t)})),0===a.length?f(n)?R:n:new r.CalcArray(a))}),2,3,a,[0,1,2],[0,1,2],a,!0),k("@",(function(t,e){var n,o,r,i,a,s,l,u,c,f;return w(e)?e.getValue(0,0):b(e)?(o=(n=e).getColumn(),r=n.getRow(),i=n.getColumnCount(),a=n.getRowCount(),u=(s=t.row)-r,c=(l=t.column)-o,f=t.source===n.getSource(),1===a&&(!f||r!==s)&&c>=0&&c<i?n.getValue(0,0,c):1===i&&(!f||o!==l)&&u>=0&&u<a?n.getValue(0,u,0):1===a&&1===i?n.getValue(0,0,0):x):e}),1,1,a,[0],[0],{dk:!0},!0)},"./src/functions-stat.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et,Dt,Ot,jt,Ft,Pt,_t,Lt,Bt,Gt,Ht,Vt,zt,Wt,Ut,qt,Yt,Xt,Zt;function Qt(t){var e,n,o;return 0===t?e=0:(n=.5*Math.abs(t))>=3?e=1:n<1?e=((((((((.000124818987*(o=n*n)-.001075204047)*o+.005198775019)*o-.019198292004)*o+.059054035642)*o-.151968751364)*o+.319152932694)*o-.5319230073)*o+.797884560593)*n*2:e=(((((((((((((-45255659e-12*(n-=2)+.00015252929)*n-19538132e-12)*n-.000676904986)*n+.001390604284)*n-.00079462082)*n-.002034254874)*n+.006549791214)*n-.010557625006)*n+.011630447319)*n-.009279453341)*n+.005353579108)*n-.002141268741)*n+.000535310849)*n+.999936657524,t>0?.5*(e+1):.5*(1-e)}function Jt(t,e,n,o){var r,a,s=[];return pe(t,s),0===(r=i(s))||e<s[0]||e>s[r-1]?I:0!==(a=1===r?1:function(t,e,n){var o,r,a,s,l,u=i(t);if(e!==t[0]){for(a=0,s=t[0],r=1;r<u&&t[r]<e;r++)t[r]!==s&&(a=r,s=t[r]);t[r]!==s&&(a=r),e===t[r]?o=n?a/(u-1):(r+1)/(u+1):0===a?o=0:(l=(e-t[a-1])/(t[a]-t[a-1]),o=n?(a-1+l)/(u-1):(a+l)/(u+1))}else o=n?0:1/(u+1);return o}(s,e,o))?x(a*f(10,n))/f(10,n):a}function $t(t){return[22250738585072014e-324,17976931348623157e292,f(2,-53),f(2,-52),O.Ek(2,10)][t-1]||0}function Kt(t,e,n){var o,r=0,i=0;if(e<1)return 0;for(o=1;o<=e;o++)if((i+=b(D(t[r=e-o])))>n)return r;return r}function te(t,e,n){var o,r,i,a,s;if(n<1||n>1e3||t<-1.1||t>1.1)return NaN;for(o=2*t,i=r=0,a=0,s=1;s<=n;s++)i=r,a=o*(r=a)-i+D(e[n-s]);return.5*(a-i)}function ee(t){var e,n=[.16663894804518634,-1384948176067564e-20,9.81082564692473e-9,-1809129475572494e-26,6221098041892606e-29,-3399615005417722e-31,2683181998482699e-33,-2.868042435334643e-20,39628370610464347e-38,-6831888753985767e-39,14292273559424982e-41,-35475981581010704e-43,1025680058010471e-43,-3.401102254316749e-30,1276642195630063e-46],o=Kt(n,15,$t(3)),r=1/w($t(3)),i=C(p(T($t(2)/12),-T(12*$t(1))));return t<10?NaN:t>=i?4930380657631324e-47:t<r?te((e=10/t)*e*2-1,n,o)/t:1/(12*t)}function ne(t){var e=[1.037869356274377,-.13364301504908918,.019408249135520562,-.0030107551127535777,.0004869461479715485,-8105488189317536e-20,13778847799559525e-21,-2380221089435897e-21,4.1640416213865184e-7,-7.359582837807599e-8,1.3117611876241675e-8,-2.3546709317742423e-9,4.2522773276035e-10,-771908941348408e-25,1407574648135907e-26,-25769072058024682e-28,4734240666629442e-28,-8724901267474264e-29,1612461490274055e-29,-29875652015665774e-31,5548070120908289e-31,-10324619158271569e-32,19250239203049852e-33,-3595507346526515e-33,6726454253787686e-34,-1260262416873522e-34,2.364488440860621e-20,-44419377050807936e-37,8354659446403425e-37,-15731559416479563e-38,29653128740247425e-39,-5594958348181595e-39,1056635426883568e-39,-19972483680670205e-41,3778297781883936e-41,-7153158688908174e-42,13552488463674214e-43,-25694673048487566e-44,48747756066216946e-45,-9.254211253084972e-30,1.757859784176024e-30,-3341002667773101e-46,6353393618023618e-47],n=Kt(e,43,.1*$t(3));return t<=-1?NaN:b(t)<=.375?t*(1-t*te(t/.375,e,n)):T(t+1)}function oe(t){var e,n,o,r,i,a,s=1,l=[1,.5772156649015329,-.6558780715202538,-.0420026350340952,.1665386113822915,-.0421977345555443,-.009621971527877,.007218943246663,-.0011651675918591,-.0002152416741149,.0001280502823882,-201348547807e-16,-12504934821e-16,1133027232e-15,-2.056338417e-7,6.116095e-9,5.0020075e-9,-1.1812746e-9,1.043427e-10,77823e-16,-36968e-16,51e-14,-206e-16,-54e-16,14e-16];if(t>171)return 1e308;if(t===E(t))if(t>0)for(e=1,r=2;r<t;r++)e*=r;else e=1e308;else{if(b(t)>1){for(o=b(t),i=E(o),s=1,n=1;n<=i;n++)s*=o-n;o-=i}else o=t;for(a=l[24],n=23;n>=0;n--)a=a*o+l[n];e=1/(a*o),b(t)>1&&(e*=s,t<0&&(e=-y/(t*e*g(y*t))))}return e}function re(t){var e,n,o,r,i,a=0,s=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059],l=t;if(t<=0)return 1e308;if(1===t||2===t)return 0;for(t<=7&&(l=t+(a=E(7-t))),n=1/(l*l),o=2*y,r=s[9],e=8;e>=0;e--)r=r*n+s[e];if(i=r/l+.5*T(o)+(l-.5)*T(l)-l,t<=7)for(e=1;e<=a;e++)i-=T(l-1),l-=1;return i}function ie(t,e){var n,o,r,i=o=t;return e<i&&(i=e),e>o&&(o=e),i<0?NaN:0===i?U:i>=10?(n=ee(i)+ee(o)-ee(i+o),-.5*T(o)+.9189385332046728+n+(i-.5)*T(i/(i+o))+o*ne(-i/(i+o))):o>=10?(n=ee(o)-ee(i+o),r=un(i),_(r)?NaN:D(r)+n+i-i*T(i+o)+(o-.5)*ne(-i/(i+o))):T(oe(i)*(oe(o)/oe(i+o)))}function ae(t,e,n){var o,r,i,a,s,l,u,c,f,g,m,y=$t(3),v=T(y),b=$t(1),w=T(b),x=t,S=e,A=n;if(S/(S+A)<t&&(x=1-x,S=n,A=e),(S+A)*x/(S+1)<y)o=0,(i=S*T(h(x,b))-T(S)-ie(S,A))>w&&0!==x&&(o=C(i)),x===t&&S===e||(o=1-o);else{if(0===(l=A-d(A))&&(l=1),o=0,(i=S*T(x)-ie(l,S)-T(S))>=w&&(r=(o=C(i))*S,1!==l))for(s=E(h(v/T(x),4)),u=1;u<=s;u++)o+=(r=r*((a=u)-l)*x/a)/(S+a);if(A>1){for(i=S*T(x)+A*T(1-x)-ie(S,A)-T(A),c=E(h(i/w,0)),r=C(i-c*w),g=A*(f=1/(1-x))/(S+A-1),m=0,A===(s=E(A))&&(s-=1),u=1;u<=s&&!(g<=1&&r/y<=m);u++)(r=(A-(a=u)+1)*f*r/(S+A-a))>1&&(c-=1,r*=b),0===c&&(m+=r);o+=m}x===t&&S===e||(o=1-o),o=h(p(o,1),0)}return o}function se(t,e,n,o){var r,i,a,s,l,u,c,f,p,d,g,m;function y(t,e){return t<0&&e>0||t>0&&e<0}for(1e-307,222045e-21,r=t.ge(e),i=t.ge(n),s=0;s<1e3&&!y(r,i);s++)b(r)<=b(i)?(a=e,(e+=2*(e-n))<0&&(e=0),n=a,i=r,r=t.ge(e)):(a=n,n+=2*(n-e),e=a,r=i,i=t.ge(n));if(0===r)return e;if(0===i)return n;if(!y(r,i))return o.jl=!0,0;for(l=e,u=r,c=n,f=i,p=e,d=r,g=.5*(e+n),m=!0,s=0;s<500&&b(d)>1e-307&&n-e>222045e-21*h(b(e),b(n));)m&&(u!==f&&f!==d&&d!==u?m=e<(g=l*d*f/(d-u)/(f-u)+p*f*u/(f-d)/(u-d)+c*u*d/(u-f)/(d-f))&&g<n:m=!1),m||(g=.5*(e+n),c=n,f=i,m=!0),l=c,c=p,p=g,u=f,f=d,y(r,d=t.ge(g))?(n=p,i=d):(e=p,r=d),m=m&&2*b(d)<=b(f),++s;return p}function le(t,e){var n,o,r,a,s=i(e);for(n=0;n<s;n++)a=(r=(o=D(e[n]))-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*r*a,t.N++,t.kl+=o}function ue(t){var e,n=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],o=1.000000000190015,r=t,i=t+5.5;for(i-=(t+.5)*T(i),e=0;e<=5;e++)o+=n[e]/++r;return-i+T(2.5066282746310007*o/t)}function ce(t,e,n){var o,r,i,a,s,l,u,c,f,h,p,d,g,m=0===n||1===n?0:C(ue(t+e)-ue(t)-ue(e)+t*T(n)+e*T(1-n)),y=n>=(t+1)/(t+e+2);for(y&&(o=t,t=e,e=o,n=1-n),r=4450147717014403e-323,100,s=t-1,l=1,b(u=1-(i=t+e)*n/(a=t+1))<r&&(u=r),c=u=1/u,f=1,h=2;f<=100;f++,h+=2)if(b(u=1+(p=f*(e-f)*n/((s+h)*(t+h)))*u)<r&&(u=r),b(l=1+p/l)<r&&(l=r),c*=(u=1/u)*l,b(u=1+(p=-(t+f)*(i+f)*n/((t+h)*(a+h)))*u)<r&&(u=r),b(l=1+p/l)<r&&(l=r),c*=d=(u=1/u)*l,b(D(d-1))<5e-324)return g=m*c/t,y?1-g:g;return R}function fe(t,e){var n,o,r,a,s=i(e);for(n=0;n<s;n++)(o=e[n])!==q&&(a=(r=o-t.M)/(t.N+1),t.M+=a,t.Q+=t.N*r*a,t.N++,t.kl+=o)}function he(t){t.sort((function(t,e){return t-e}))}function pe(t,e){var n,o;for(n=0;n<i(t);n++)(o=t[n])!==q&&e.push(o);he(e)}function de(t){var e,n=[];for(e=0;e<i(t);e++)pe(t[e],n);return n}function ge(t,e,n){var o,r,i,a,s,l,u,c,h=Math.expm1||function(t){return C(t)-1},p=Math.log1p||function(t){return T(1+t)};return t<=0?0:t>=1?1:1===n?f(t,e):1===e?-h(n*p(-t)):(r=.5-t+.5,i=p(-t),a=t,s=T(t),l=e,u=n,(c=t>e/(e+n))&&(l=n,u=e,a=r,r=t,s=i,i=T(t)),o=function(t,e,n){var o,r,i,a,s,l,u,c,f,h=1,p=1,d=1-(e+n)/(e+1)*t;0===d?(o=0,r=1,a=1):a=(o=1)*(r=1/d),i=1,s=1,5e4,l=!1;do{o=(h=(o+(c=s*(n-s)*t/(((u=e+2*s)-1)*u))*h)*r)+(f=-(e+s)*(e+n+s)*t/(u*(u+1)))*o*r,0!=(d=(p=(d+c*p)*r)+f*d*r)&&(l=b(a-(i=o*(r=1/d)))<222045e-21*b(a)),a=i,s+=1}while(s<5e4&&!l);return a}(a,l,u),o/=l,o*=l>1&&u>1&&l/(l+u)<.97&&u/(l+u)<.97?me(a,l,u)*a*r:C(l*s+u*i-ye(!1,l,u)),c&&(o=.5-o+.5),o>1&&(o=1),o<0&&(o=0),o)}function me(t,e,n){var o,r,i,a,s,l;return 1===e?1===n?1:2===n?-2*t+2:t<=.01?n+n*C((n-1)*T(1-t))-1:n*f(.5-t+.5,n-1):1===n?2===e?e*t:e*f(t,e-1):t<=0&&!(e<1&&0===t)||t>=1&&!(n<1&&1===t)?0:(o=T($t(2)),r=T($t(1)),i=T(t<.1?1+t:1-t),a=(e-1)*T(t),s=(n-1)*i,l=ye(!1,e,n),a<o&&a>r&&s<o&&s>r&&l<o&&l>r&&a+s<o&&a+s>r?f(t,e-1)*f(.5-t+.5,n-1)/ye(!0,e,n):C(a+s-l))}function ye(t,e,n){var o,r,i,a,s,l,u,c=n,f=e;return e>n&&(o=c,c=f,f=o),t&&c+f<171.624376956302?Ce(c)/Ce(c+f)*Ce(f):(6.02468004077673,r=5.52468004077673,i=we(c),i/=we(c+f),i*=we(f),a=c+f+r,s=t?i*w(a/(c+r)/(f+r)):T(i)+.5*(T(a)-T(c+r)-T(f+r)),l=c/(f+r),u=-c*T(1+f/(c+r))-f*T(1+l)-r,t?C(u)*s:u+s)}function ve(t){var e=we(t),n=t+6.02468004077673-.5,o=f(n,t/2-.25);return e*=o,e/=C(n),e*=o,t<=20&&t===O.wk(t)&&(e=x(e)),e}function Ce(t){var e,n=T(y),o=T($t(2));return t>171.624376956302?R:t>=1?ve(t):t>=.5?ve(t+1)/t:t>=-.5?ve(t+2)-T(t+1)-T(b(t))>=o?R:ve(t+2)/(t+1)/t:(e=ve(1-t)+T(b(g(y*t))))-n>=o?0:e<0&&n-e>o?R:C(n-e)*(g(y*t)<0?-1:1)}function be(t){return t>=171.624376956302?ve(t):t>=1?T(ve(t)):t>=.5?T(ve(t+1)/t):ve(t+2)-T(t+1)-T(t)}function we(t){var e,n,o,r,i=[23531376880.41076,42919803642.6491,35711959237.35567,17921034426.03721,6039542586.352028,1439720407.3117216,248874557.86205417,31426415.585400194,2876370.6289353725,186056.26539522348,8071.672002365816,210.82427775157936,2.5066282746310002],a=[0,39916800,120543840,150917976,105258076,45995730,13339535,2637558,357423,32670,1925,66,1];if(t<=1)for(e=i[12],n=a[12],o=11;o>=0;--o)e*=t,e+=i[o],n*=t,n+=a[o];else for(r=1/t,e=i[0],n=a[0],o=1;o<=12;++o)e*=r,e+=i[o],n*=r,n+=a[o];return e/n}function Te(t,e){return t<=0?0:function(t,e){var n=t*T(e)-e-be(t),o=C(n);return e>t+1?1-o*function(t,e){var n=$t(3),o=.5*n,r=1/n,i=0,a=0,s=1-t,l=e+2-t,u=0,c=e+1,f=1,h=1,p=l*e,d=e,g=c/p,m=!1,y=0;do{u=c*(l+=2)-f*(a=(s+=1)*(i+=1)),0!=(h=p*l-d*a)&&(m=b((g-(y=u/h))/y)<=o,g=y),f=c,c=u,d=p,p=h,b(u)>r&&(f*=n,c*=n,d*=n,p*=n)}while(!m&&i<1e4);return m?g:A}(t,e):o*function(t,e){var n=.5*$t(3),o=t,r=1/t,i=r,a=1;do{i+=r=r*e/(o+=1),a+=1}while(r/i>n&&a<=1e4);return a>1e4?A:i}(t,e)}(e/2,t/2)}function xe(t,e,n,o){var r,i,a,s=j(n,t);return _(s)?s:(r=D(s),s=j(o-n,e-t),_(s)?s:(i=D(s),s=j(o,e),_(s)?s:(a=D(s),M(r*i/a))))}function Se(t,e,n){var o,r=ge(e/(e+t*t),e/2,.5);switch(n){case 1:return.5*r;case 2:return r;case 3:return f(1+t*t/e,-(e+1)/2)/(w(e)*ye(!0,.5,e/2));case 4:return o=.5*ge(e/(t*t+e),.5*e,.5),t<0?o:1-o}return A}function Ae(t,e,n){var o={jl:!1},r=se(function(t,e,n){return{ge:function(o){return t-Se(o,e,n)}}}(t,e,n),.5*e,e,o);return o.jl?I:r}function Ie(t,e){var n,o,r,a,s,l=!1,u=0;for(o=0;o<i(e);o++)for(s=e[o],r=0;r<i(s);r++)if(a=s[r],P(a)||V(a)||z(a))n=z(a)?0:D(a),(!l||t&&n>u||!t&&n<u)&&(u=n),l=!0;else if(_(a))return a;return u}function Re(t,e,n,o){var r,a,s,l=0,u=0,c=0;for(r=0;r<i(e);r++)(a=e[r])!==q&&(a<n?l++:n<a?c++:u++);return 0===u?I:(s=(0===o?c:l)+1,t?s:s+(u-1)/2)}function ke(t,e,n){var o,s,l,u,c,f,h,p;for(l=0;l<i(t);l++)for(f=!!(c=t[l]).isArray,h=!!c.isReference,u=0;u<i(c);u++)if((s=c[u])!==a)if(z(s)){if(r.ExcelCompatibleCalcMode){if(f)continue;if(h){e.n++;continue}}if(p={value:0},r.Convert.Th(s,p))o=p.value,e.ll+=o,e.ml+=o*o;else if(!c.isArray&&!c.isReference)return A;e.n++}else{if(_(s))return s;!P(s)||n&&"boolean"==typeof s&&c.isArray||(o=D(s),e.ll+=o,e.ml+=o*o,e.n++)}}function Me(t,e,n,o){var r,i={ll:0,ml:0,n:0},a=ke(t,i,o);return _(a)?a:i.n<=e?S:(r=h(0,(i.n*i.ml-i.ll*i.ll)/(i.n*(i.n-e))),r=n?w(r):r,M(r))}function Ne(t,e,n){var o,r,a,s,l,u=0,c=0,f=0,h=0,p=i(e);if(p!==i(n))return I;for(a=0;a<p;a++)o=e[a],r=n[a],o!==q&&r!==q&&(u+=o,c+=r,h++);if(h<=1)return S;for(s=u/h,l=c/h,a=0;a<p;a++)o=e[a],r=n[a],o!==q&&r!==q&&(f+=(o-s)*(r-l));return M(t?f/h:f/(h-1))}function Ee(t,e){var n,o,r,a,s=t?1:0,l=0;for(r=0;r<i(e);r++)for(n=e[r],a=0;a<i(n);a++)if((o=n[a])!==q){if(o<=0)return R;s=t?s*o:s+1/o,l++}return t?l<=0?S:M(f(s,1/l)):0===s?S:M(l/s)}function De(t,e,n,o,i){var l,u,c,f,h,p,d,g,m,y,v,b,x,S,A,k,M,E,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q=e.rowCount,J=e.colCount;if(t?n=n!==s?N(n,1,!1,!0,!0):e:(l=n!==s?n:function(t,e){var n=[];for(u=0;u<t;u++)for(n[u]=[],c=0;c<e;c++)n[u][c]=u*e+c+1;return new r.CalcArray(n)}(Q,J),n=N(l,1,!1,!0,!0)),f=n.rowCount,h=n.colCount,Q===f&&J===h&&(o||!i)){for(g=t?f*h:D(f*h),E=0,O=0,j=0,F=0,P=0,_=void 0,u=0;u<f;u++)for(c=0;c<h;c++)m=n[u][c],y=e[u][c],t&&(y=T(y)),E+=m,O+=m*m,j+=y,F+=y*y,P+=m*y;return A=g*O-E*E,d=o?(g*P-E*j)/A:P/O,_=o?(j*O-E*P)/A:0,t&&(d=C(d),_=C(_)),x=[[d,_]],i&&(x[1]=[],x[2]=[],x[3]=[],x[4]=[],H=F-_*j-d*P,V=(G=g*P-E*j)*G/((L=g*O-E*E)*(B=g*F-j*j)),g<3?(x[1][0]=R,x[1][1]=R,x[2][1]=R,x[3][0]=R):(x[1][0]=w(H*g/(L*(g-2))),x[1][1]=w(H*O/(L*(g-2))),x[2][1]=w((B-G*G/L)/(g*(g-2))),x[3][0]=1===V?R:V*(g-2)/(1-V)),x[2][0]=V,x[3][1]=g-2,x[4][0]=B/g-H,x[4][1]=H),new r.CalcArray(x)}if(1===J&&Q===f||1===Q&&J===h){for(y=[],m=[],A=1===J,g=f,d=h,u=0;u<g;u++)y[u]=o?e[u][0]:e[0][u],t&&(y[u]=T(y[u]));for(u=0;u<g;u++)for(m[u]=[],c=0;c<d;c++)m[u][c]=A?n[u][c]:n[c][u];for(z=[],p=0;p<d+1;p++)z[p]=[];for(v=0;v<d+1;v++)for(b=0;b<d+2;b++)z[v][b]=0;for(W=[],v=0;v<d+2;v++)W[v]=0;for(U=i?[]:a,p=0;p<g;p++)for(W[d+1]+=y[p]*y[p],z[0][d+1]+=y[p],W[0]=z[0][d+1],u=0;u<d;u++)for(z[0][u+1]+=m[p][u],z[u+1][0]=z[0][u+1],z[u+1][d+1]+=m[p][u]*y[p],W[u+1]=z[u+1][d+1],c=u;c<d;c++)z[c+1][u+1]+=m[p][u]*m[p][c],z[u+1][c+1]=z[c+1][u+1];if(z[0][0]=g,i){for(v=0;v<d+1;v++)for(U[v]=[],b=0;b<d+1;b++)U[v][b]=0;for(u=0;u<d+1;u++)U[u][u]=1}for(q=o?0:1,u=0;u<d+1;u++){if(0===z[u][u]){for(S=!1,c=u+1;!S&&c<d+1;c++)if(0!==z[c][u]){for(p=0;p<d+2;p++)A=z[u][p],z[u][p]=z[c][p],z[c][p]=A;if(i)for(p=0;p<d+1;p++)A=U[u][p],U[u][p]=U[c][p],U[c][p]=A;S=!0}if(!S)return R}for(k=1/z[u][u],p=q;p<d+2;p++)z[u][p]*=k;if(i)for(p=q;p<d+1;p++)U[u][p]*=k;for(c=q;c<d+1;c++)if(c!==u){for(k=-z[c][u],p=q;p<d+2;p++)z[c][p]+=k*z[u][p];if(i)for(p=q;p<d+1;p++)U[c][p]+=k*U[u][p]}o||(z[0][d+1]=0)}for(x=t?[[],d+1]:[[]],u=0;u<d+1;u++)x[0][u]=t?C(z[d-u][d+1]):z[d-u][d+1];if(i){if(t)x[1]=[],x[2]=[],x[3]=[],x[4]=[];else for(v=1;v<5;v++)for(x[v]=[],b=0;b<d+1;b++)x[v][b]=0;for(Y=void 0,void 0,void 0,X=W[d+1]-W[0]*W[0]/g,Y=W[d+1],u=0;u<d+1;u++)Y-=z[u][d+1]*W[u];if(Z=X-Y,x[2][0]=0===X?R:Z/X,x[4][0]=Z,x[4][1]=Y,0===(A=o?g-d-1:g-d)){for(u=0;u<d+1;u++)x[1][u]=R;x[2][1]=R}else{for(M=Y/D(A),o||(x[1][d]=I),u=q;u<d+1;u++)x[1][d-u]=w(M*U[u][u]);x[2][1]=w(M)}for(x[3][0]=0===Y?R:D(A)*Z/(Y*D(d)),x[3][1]=D(A),u=2;u<5;u++)for(c=2;c<d+1;c++)x[u][c]=I}return t||(x=[x[0]]),new r.CalcArray(x)}return R}function Oe(t,e){var n,o,r,a,s,l=0,u=0,c=0,f=[];for(r=0;r<i(e);r++)for(s=e[r],f.push(s),a=0;a<i(s);a++)(n=s[a])!==q&&(l+=n,c++);for(o=l/c,r=0;r<i(e);r++)for(s=f[r],a=0;a<i(s);a++)(n=s[a])!==q&&(u+=t?(n-o)*(n-o):b(n-o));return t?M(u):0===c?S:M(u/c)}function je(){return B(arguments,2,7)}function Fe(t,e){return G([t,e],16)}function Pe(t,e,n){var o,r,a,s=0,l=0,u=F(e);if(t.rowCount!==n.rowCount||t.colCount!==n.colCount)return A;for(o=0;o<i(t);o++)if(r=t[o],u&&u(r,!0)&&(a=n[o])!==q){if(_(a))return a;s+=a,l++}return 0===l?S:M(s/l)}function _e(t,e,n,o){var i,a,s,l=e,u=e,c=t?l.getRowCount():u.getRowCount(0),f=t?l.getColumnCount():u.getColumnCount(0),h=[];for(i=0;i<c;i++)for(h[i]=[],a=0;a<f;a++)s=t?l.getValue(i,a):u.getValue(0,i,a),h[i][a]=Pe(n,s,o);return new r.CalcArray(h)}function Le(){return G(arguments,13)}function Be(t,e,n){var o=r.CalcArrayHelper;if(r.Convert.Fh(t)){if(1!==o.getLength(t))return A;t=o.getValueByIndex(t,0)}return t=D(t),l(t)?A:Re(!0,e,t,n)}function Ge(t,e,n){return Jt(t,e,n,!0)}function He(t,e){return G([t,e],17)}function Ve(t,e){var n,o,r=0,s=0===e||"*"===e,l=F(e);for(n=0;n<i(t);n++)o=t[n],s&&o===a||!l||!l(o)||r++;return M(r)}function ze(){return B(arguments,2,8)}function We(){return B(arguments,2,10)}function Ue(){return B(arguments,2,11)}function qe(t,e){return Ne(!0,t,e)}function Ye(t,e,n){var o=pn(t/2);return _(o)?o:-D(o)*(e/w(n))}function Xe(t){var e,n=t,o=n+5.5;return o-=(n+.5)*T(o),e=1.000000000190015+76.18009172947146/(t+1),e-=86.50532032941678/(t+2),e+=24.01409824083091/(t+3),e-=1.231739572450155/(t+4),e+=.001208650973866179/(t+5),T(2.506628274631001*(e-=5395239384953e-18/(t+6))/n)-o}function Ze(t,e,n,o,r){var i,a,s,l,u,c,f;return t<o||r<t||o===r?R:(i=(t-o)/(r-o),a=Xe(e+n),s=Xe(e),l=Xe(n),u=T(i),c=T(1-i),f=C(a-s-l+e*u+n*c)*function(t,e,n){var o,r,i,a,s,l=1e-50,u=t+e,c=t+1,f=t-1,h=1,p=1-u*n/c;for(b(p)<l&&(p=l),o=p=1/p,r=1;r<=300&&(b(p=1+(a=(e-r)*r*n/((f+(i=r+r))*(t+i)))*p)<l&&(p=l),b(h=1+a/h)<l&&(h=l),o*=(p=1/p)*h,b(p=1+(a=0-(t+r)*(u+r)*n/((t+i)*(c+i)))*p)<l&&(p=l),b(h=1+a/h)<l&&(h=l),o*=s=(p=1/p)*h,!(b(s-1)<1e-20));r++);return o}(n,e,1-i)/n,M(i<(e+1)/(e+n+2)?f:1-f))}function Qe(t,e,n,o,r){var i,a,s,l,u,c,p,d,g,m,y,v,x,S,A,I,R,k,N,E=3e-308,D=E,O=1-222e-18,j=ie(e,n);for(t<=.5?(l=t,d=e,m=n,i=0):(l=1-t,d=n,m=e,i=1),I=(y=w(-T(l*l)))-(2.30753+.27061*y)/(1+(.99229+.04481*y)*y),d>1&&m>1?(A=I*w((p=2/((v=1/(d+d-1))+(x=1/(m+m-1))))+(y=(I*I-3)/6))/p-(x-v)*(y+5/6-2/(3*p)),N=d/(d+m*C(A+A))):(x=(y=m+m)*f(1-(x=1/(9*m))+I*w(x),3))<=0?N=1-C((T((1-l)*m)+j)/m):N=(x=(4*d+y-2)/x)<=1?C((T(l*d)+j)/d):1-2/(x+1),y=1-d,x=1-m,R=0,u=1,N<D?N=D:N>O&&(N=O),k=h(1e-300,f(10,-13-2.5/(d*d)-.5/(l*l))),S=g=0,a=0;a<1e3;a++){for((I=((I=ae(N,d,m))-l)*C(j+y*T(N)+x*T(1-N)))*R<=0&&(g=h(b(u),E)),c=1,s=0;s<1e3;s++){if(b(u=c*I)<g&&((S=N-u)>=0&&S<=1)){if(g<=k)return 0!==i&&(N=1-N),M((r-o)*N+o);if(b(I)<=k)return 0!==i&&(N=1-N),M((r-o)*N+o);if(0!==S&&1!==S)break}c/=3}if(S===N)return 0!==i&&(N=1-N),M((r-o)*N+o);N=S,R=I}return 0!==i&&(N=1-N),M((r-o)*N+o)}function Je(t,e,n,o){var r,i,a,s;if(e<t)return R;if(!o){if(0===(i=f(r=1-n,e))){if(0===(i=f(n,e)))return R;for(a=0;a<e-t&&i>0;a++)i*=D(e-a)/D(a+1)*r/n;return i}for(a=0;a<t&&i>0;a++)i*=D(e-a)/D(a+1)*n/r;return i}if(e===t)return 1;if(0===(i=f(r=1-n,e))){if(0===(i=f(n,e)))return R;for(s=1-i,a=0;a<e-t&&i>0;a++)s-=i*=D(e-a)/D(a+1)*r/n;return s<0?0:s}for(s=i,a=0;a<t&&i>0;a++)s+=i*=D(e-a)/D(a+1)*n/r;return s}function $e(t,e,n){var o,r,i=1-e,a=f(i,t);if(0===a){if(0===(a=f(e,t)))return R;for(o=1-a,r=0;r<t&&o>=n;r++)o-=a*=D(t-r)/D((r+1)*i/e);return D(t-r)}for(o=a,r=0;r<t&&o<n;r++)o+=a*=D(t-r)/D((r+1)*e/i);return D(r)}function Ke(t,e){var n,o,r,i,a,s,l=T(w(y)),u=1/w(y),c=0,f=t,h=.5*f,p=e%2==0;if(e>1&&(c=C(-h)),a=H(-w(f)),_(a))return a;if(s=D(a),o=p?c:2*s,e>2){if(f=.5*(e-1),r=p?1:.5,h>20){for(n=p?0:l,i=T(h);r<=f;)n=T(r)+n,o+=C(i*r-h-n),r+=1;return o}for(n=p?1:u/w(h),i=0;r<=f;)i+=n*=h/r,r+=1;return i*c+o}return o}function tn(t,e){var n=ln(1-t,.5*e,2);return D(n)}function en(t,e){var n,o,r,a,s=0,l=t.rowCount,u=t.colCount;if(l!==e.rowCount||u!==e.colCount)return I;if(l>1&&u>1)n=(l-1)*(u-1);else if(l>1&&1===u)n=l-1;else{if(!(1===l&&u>1))return I;n=u-1}for(o=0;o<i(t);o++)if(r=t[o],a=e[o],r!==q&&a!==q){if(0===a)return S;s+=(r-a)*(r-a)/a}return s<0?R:Ke(s,n)}function nn(t,e,n){var o=C(-e*t);return M(n?1-o:e*o)}function on(t,e,n){var o=Ze(e*t/(e*t+n),.5*e,.5*n,0,1);return _(o)?o:1-D(o)}function rn(t,e,n){var o=Qe(1-(1-t),n/2,e/2,0,1);return _(o)?o:(1/D(o)-1)*(n/e)}function an(t,e){var n,o,r,i,a,s,l={N:0,M:0,Q:0,kl:0};return fe(l,t),i=l.N-1,1===l.N?S:0===(n=l.Q/(l.N-1))?S:(l.N=0,l.M=0,l.Q=0,l.kl=0,fe(l,e),a=l.N-1,1===l.N?S:0===(o=l.Q/(l.N-1))?S:(s=on(n/o,i,a),_(s)?s:((r=2*(1-D(s)))>1&&(r=2-r),r)))}function sn(t,e,n,o){var r,i,a,s,c,h,d,g,m,y,v,x,A,I,k,M;if(!1===o)return r=f(n,e),l(r)||!u(r)?S:1/(r*oe(e))*(f(t,e-1)*C(-t/n));if(1/3,1e8,M=1e37,1e3,-88,(t/=n)<=0)return R;if(e>1e3)return k=fn(i=3*w(e)*(f(t/e,1/3)+1/(9*e)-1),0,1,!0),_(k)?k:D(k);if(t>1e8)return 1;if(t<=1||t<e){if(k=un(e+1),_(k))return k;g=e*T(t)-t-D(k),m=1,I=1,v=e;do{I+=m=m*t/(v+=1)}while(m>2220446049250313e-31);g+=T(I),I=0,g>=-88&&(I=C(g))}else{if(k=un(e),_(k))return k;for(g=e*T(t)-t-D(k),m=0,i=1,a=t,I=(s=t+1)/(c=t*(x=(v=1-e)+t+1));;){if(h=(x+=2)*s-(A=(v+=1)*(m+=1))*i,b(d=x*c-A*a)>0){if(b(I-(y=h/d))<=p(2220446049250313e-31,2220446049250313e-31*y))break;I=y}i=s,a=c,s=h,c=d,b(h)>=M&&(i/=M,a/=M,s/=M,c/=M)}g+=T(I),I=1,g>=-88&&(I=1-C(g))}return I}function ln(t,e,n){var o,r,i,a,s,l,u,c,h,p,d,g,m,y;if(t<2e-6)return 0;if(t>.999998)return U;if(u=2*e,i=e-1,y=un(e),_(y))return y;if(s=D(y),u<-1.24*T(t)){if((a=f(t*e*C(s+.6931471805599453*e),1/e))<5e-7)return NaN}else if(u>.32){if(y=hn(t,0,1),_(y))return y;g=D(y),(a=u*f(g*w(l=.222222/u)+1-l,3))>2.2*u+6&&(a=-2*(T(1-t)-i*T(.5*a)+s))}else{a=.4,o=T(1-t)+s+.6931471805599453*i;do{h=a,d=(4.67+2*a)/(l=1+a*(4.67+a))-.5-(6.73+a*(13.32+3*a))/(c=a*(6.73+a*(6.66+a))),a-=(1-C(o+.5*a)*c/l)/d}while(b(h/a-1)>.01)}for(m=1;m<=20;m++){if(h=a,y=sn(l=.5*a,e,1,!0),_(y))return y;if(d=(c=t-D(y))*C(.6931471805599453*e+s+l-i*T(a)),b(h/(a+=d*(1+.5*d*(p=(210+(o=.5*d-(r=d/a)*i)*(140+o*(105+o*(84+o*(70+60*o)))))/420)-r*i*(p-r*((420+o*(735+o*(966+o*(1141+1278*o))))/2520-r*((210+o*(462+o*(707+932*o)))/2520-r*((252+o*(672+1182*o)+i*(294+o*(889+1740*o)))/5040-r*((84+2264*o+i*(1175+606*o))/2520-r*((120+i*(346+127*i))/5040))))))))-1)>5e-7)return.5*n*a}return.5*n*a}function un(t){return re(t)}function cn(t,e,n){var o,r=pn(t);return _(r)?r:(o=D(r),M(C(e+n*o)))}function fn(t,e,n,o){return o?H((t-e)/n):M(C(-(t-e)*(t-e)/(2*n*n))/(w(2*y)*n))}function hn(t,e,n){var o,r,i,a,s,l=t-.5;if(b(l)<=.42)r=l*(((-25.44106049637*(o=l*l)+41.39119773534)*o-18.61500062529)*o+2.50662823884)/((((3.13082909833*o-21.06224101826)*o+23.08336743743)*o-8.4735109309)*o+1);else{if(o=t,l>0&&(o=1-t),!(o>2220446049250313e-31))return o>1e-300?(r=-2*T(t),o=T(6.283185307179586*r),r=w(r*(1-(o=o/r+(2-o)/(r*r)+(6*o-14-o*o)/(2*r*r*r)))),l<0?-r:r):l<0?-U:U;r=(((2.32121276858*(o=w(-T(o)))+4.85014127135)*o-2.29796479134)*o-2.78718931138)/((1.63706781897*o+3.54388924762)*o+1),l<0&&(r=-r)}return a=.3989422804014327*C(-.5*(i=(r-0)/1)*i)/1,s=fn(r,0,1,!0),_(s)?s:e+n*(r-=(s-t)/a)}function pn(t){return hn(t,0,1)}function dn(t,e,n){var o,i=0;if(n)for(o=0;o<=t;o++)i+=C(-e)*f(e,o)/r.Functions.tk(o);else i=C(-e)*f(e,t)/r.Functions.tk(t);return M(i)}function gn(t,e,n){var o,r,i,a,s,l,u,c,f,h;if(1!==n&&2!==n)return R;if(r=t/w(o=e),i=o/(o+t*t),a=o-2,s=o%2,l=1,u=1,o=1,f=c=2+s,a>=2)for(h=E(c);h<=a&&(l+=u=u*i*(f-1)/f)!==o;h+=2)o=l,f+=2;return 1!==s?n*(1-(.5+.5*r*w(i)*l)):(1===e&&(l=0),n*(1-(.5+.3183098862*(r*i*l+v(r)))))}function mn(t,e){var n,o,r,i,a,s,l,u,c,h,p=t/2,d=p;if(e>1e20)return pn(p);if(d<.5?(c=0,a=2*d):(c=1,a=2*(1-d)),b(e-2)<1e-12)s=a>0?w(2/(a*(2-a))-2):U;else if(D(e)<1+1e-12)a>0?s=-m(1.5707963267948966*(a+1)):s=U;else{if(i=((94.5/((o=48/((n=1/(e-.5))*n))+(r=((20700*n/o-98)*n-16)*n+96.36))-3)/o+1)*w(1.5707963267948966*n)*e,(u=f(i*a,2/e))>.05+n){if(h=pn(.5*a),_(h))return h;l=D(h),e<5&&(r+=.3*(e-4.5)*(l+.6)),u=(((((.4*(u=l*l)+6.3)*u+36)*u+94.5)/(r=(((.05*i*l-5)*l-7)*l-2)*l+o+r)-u-3)/o+1)*l,u=(u*=n*u)>.002?C(u)-1:.5*u*u+u}else u=((1/(((e+6)/(e*u)-.089*i-.822)*(e+2)*3)+.5/(e+4))*u-1)*(e+1)/(e+2)+1/u;s=w(e*u)}return 0!==c&&(s=-s),M(s)}function yn(t,e,n,o){var r,a,s,c,f,h,p,d,g,m,y,v,C,T,x,A,k,M,N,E,O={N:0,M:0,Q:0,kl:0};if(1!==n&&2!==n)return R;if(1===o){if(m=void 0,y=void 0,v=void 0,C=void 0,T=void 0,x=void 0,A=void 0,i(t)!==i(e))return I;for(k=i(t),A=0;A<k;A++)t[A]=t[A]-e[A];for(C=T=x=m=0,A=0;A<k;A++)C+=v=(y=(M=t[A])-C)/(x+1),T+=x*y*v,x++,m+=M;if(x-1==0||0===x)return S;if(c=w(T/(x-1)),l(c)||!u(c))return R;s=(r=m/x)/(c/w(x)),p=x-1}else O.N=0,O.M=0,O.Q=0,O.kl=0,le(O,t),f=O.Q/(O.N-1),r=O.kl/O.N,d=O.N,O.N=0,O.M=0,O.Q=0,O.kl=0,le(O,e),h=O.Q/(O.N-1),a=O.kl/O.N,g=O.N,2!==o?p=1/((N=f/d/(f/d+h/g))*N/D(d-1)+(1-N)*(1-N)/D(g-1)):p=D(d+g-2),s=(r-a)/w(f/D(d)+h/D(g));return E=ce(.5*p,.5,p/(p+(s=b(s))*s)),_(E)?E:.5*n*D(E)}function vn(t,e,n,o){var r=C(-f(t/n,e));return M(o?1-r:e/f(n,e)*f(t,e-1)*r)}function Cn(t,e,n){var o,r,a,u,c,f,h=0,p=0,d=0,g=0;if(n!==s&&(h=D(n),l(h)))return A;for(u=0;u<i(t);u++)(c=t[u])!==q&&(p+=a=D(c),d+=a*a,g++);return 0===g?I:1===g?S:(o=p/g,0===(r=n!==s?h:w((g*d-p*p)/(g*(g-1))))?S:(f=H((o-e)/(r/w(g))),_(f)?f:M(1-D(f))))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.k.ac,a=null,s=void 0,l=isNaN,u=isFinite,c=parseInt,f=Math.pow,h=Math.max,p=Math.min,d=Math.floor,g=Math.sin,m=Math.tan,y=Math.PI,v=Math.atan,C=Math.exp,b=Math.abs,w=Math.sqrt,T=Math.log,x=Math.round,S=r.Errors.DivideByZero,A=r.Errors.Value,I=r.Errors.NotAvailable,R=r.Errors.Number,k=r.Errors.Null,M=r.Convert.Nh,N=r.Convert.Ph,E=r.Convert.Rh,D=r.Convert.Pa,O=r.Functions.MathHelper,j=O.Bk,F=O.xk,P=r.Convert.Na,_=r.Convert.vf,L=r.Functions.Hfc,B=r.Functions.sk,G=r.Functions.sja,H=r.Functions.qk,V=r.Functions.ik,z=r.Functions.jk,W=r.Functions.Na,U=r.Functions.hk,q=r.Convert.CalcConvertedError,Y=r.Functions.ak,X=r.Convert.Th,Z=r.Convert.Sh,ot={Hi:0,aj:["< 0",">= 1"]},dt={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0,Xi:!0},gt={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},mt={Hi:4,Ii:1,Ki:!0,Mi:!0},yt={Hi:4,Ii:0,Ji:!0},bt={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},wt={Hi:4,Ii:0,Ji:!0,Ki:!0,Mi:!0,Xi:!0},Tt={Hi:4,Ii:0,Ji:!0,Ki:!0},St=[ht={Hi:4,Ii:1,Ji:!0,Ki:!0,Mi:!0},{Hi:2}],At=[ht,nt={Hi:0},{_i:3,Hi:2,aj:"< 1"}],It=[rt={Hi:0,aj:["<= 0",">= 1"]},it={Hi:0,aj:"<= 0"},K={Hi:2,aj:"< 1"}],Rt=[rt,it,it,at={_i:0,Hi:0},st={_i:1,Hi:0}],kt=[tt={Hi:2,aj:"< 0"},tt,lt={Hi:0,aj:["< 0","> 1"]},Q={Hi:7}],Mt=[tt,lt,rt],Nt=[ut={Hi:0,aj:"< 0"},ct={Hi:0,aj:["< 1","> 10000000000"]}],Et=[lt,et={Hi:2,aj:["< 1","> 10000000000"]}],Dt=[pt={Hi:4,Ii:1,Ji:!0,Ki:!0},pt],Ot=[ut,it,Q],jt=[ut,ft={Hi:0,aj:["< 1",">= 10000000000"]},ft],Ft=[lt,ft,ft],Pt=[ht,ht],_t=[ut,it,it,Q],Lt=[lt,it,it],Bt=[lt,nt,it],Gt=[nt,nt,it,Q],Ht=[vt={Hi:4,Ii:1,Ji:!0},vt],Vt=[tt,ut,Q],zt=[ut,K],Wt=[Ct={Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0},Ct,$={Hi:2},{Hi:2,aj:["< 1","> 3"]}],Ut=[ut,it,it,Q],qt=[ht,nt],Yt=[xt={Hi:4,Ii:1,Ki:!0,Li:!0},{},J={_i:!0,Hi:7},{_i:!1,Hi:7}],Xt=[{},ht,at],Zt=[{Hi:4,Ii:1,Ji:!0,Ki:!0,hOb:!0,Mi:!0},nt],Y("TREND",(function(t,e,n,i){var a,l;for(e=e!==s?N(e,0,!1,!0,!1):t,n=n!==s?N(n,0,!1,!0,!1):e,a=0;a<t.rowCount;a++)for(l=0;l<t.colCount;l++)if(!P(t[a][l]))return A;for(a=0;a<e.rowCount;a++)for(l=0;l<e.colCount;l++)if(!P(e[a][l]))return A;for(a=0;a<n.rowCount;a++)for(l=0;l<n.colCount;l++)if(!P(n[a][l]))return A;return o.Common.qc(t,e,n,i,D,r.CalcArray,A,I)}),1,4,[{Hi:4,Ii:0,Ki:!0},{},{},J],[0,1,2],[0,1,2],{bk:[1,2,3]}),Y("GROWTH",(function(t,e,n,i){return e=e!==s?N(e,1,!1,!0,!0):t,n=n!==s?N(n,1,!1,!0,!0):e,o.Common.sc(t,e,n,i,r.CalcArray,R,I)}),1,4,[xt,{},{},J],"!= 3","!= 3",{bk:[1,2,3]}),Y("FORECAST",(function(t,e,n){var o,r,a,s,l=0,u=0,c=0,f=0,h=i(e),p=0;if(h!==i(n))return I;for(o=0;o<h;o++)r=e[o],a=n[o],r!==q&&a!==q&&(l+=r,u+=a,c+=a*a,f+=a*r,p++);return 0===p||p*c-u*u==0?S:M(l/p-(s=(p*f-u*l)/(p*c-u*u))*(u/p)+s*t)}),3,3,[nt,pt,pt],"> 0","> 0"),Y("AVERAGE",(function(){return L(arguments,2,1)}),1,s,s,-1,-1),Y("STDEV",je,1,s,s,-1,-1),Y("STDEV.S",je,1,s,s,-1,-1),Y("PERCENTILE",Fe,2,2,s,0,0),Y("PERCENTILE.INC",Fe,2,2,s,0,0),Y("MAX",(function(){return L(arguments,2,4)}),1,s,s,-1,-1),Y("MAXA",(function(){return Ie(!0,arguments)}),1,s,bt,-1,-1),Y("MIN",(function(){return L(arguments,2,5)}),1,s,s,-1,-1),Y("MINA",(function(){return Ie(!1,arguments)}),1,s,bt,-1,-1),Y("LARGE",(function(t,e){return G([t,e],14)}),2,2,Zt,0,0),Y("SMALL",(function(t,e){return G([t,e],15)}),2,2,Zt,0,0),Y("AVERAGEA",(function(){var t,e,n,o,r=arguments,s=0,l=0;for(t=0;t<i(r);t++)for(o=r[t],e=0;e<i(o);e++)n=o[e],P(n,!0)||V(n)?(s+=D(n),l++):(n===a||z(n))&&l++;return 0===l?S:M(s/l)}),1,s,wt,-1,-1),Y("AVERAGEIF",(function(t,e,n){if(n!==s){if(t=N(t,0,!0,!1,!1),(n=N(n,1,!0,!1,!1,!0,s,!0)).isError)return n[0]}else{if((t=N(t,1,!0,!1,!1,!0,s,!0)).isError)return t[0];n=t}return r.Convert.Fh(e)?_e(!1,e,t,n):r.Convert.Ca(e)?_e(!0,e,t,n):Pe(t,e,n)}),2,3,s,[0,1,2],[0,1,2],{bk:2}),Y("AVERAGEIFS",(function(t){var e,n,o,r,i,a,s,l=arguments,u=0,c=0,f=t.length,h=l.length,p=[];for(p.push(t),o=1;o<h;o+=2){if((r=N(l[o],0,!0,!1,!1)).isError)return r[0];p.push(r),i=l[o+1],a=F(i),p.push(a)}for(n=0;n<f;n++)if((e=t[n])!==q){for(s=!0,o=1;o<h&&(s=(a=p[o+1])(p[o][n]));o+=2);s&&(u+=e,c++)}return 0===c?S:M(u/c)}),3,s,ht,[0,"%= 1"],[0,"%= 1"]),Y("MEDIAN",(function(){return G(arguments,12)}),1,s,dt,-1,-1),Y("MODE",Le,1,s,dt,-1,-1),Y("MODE.SNGL",Le,1,s,dt,-1,-1),Y("GEOMEAN",(function(){return Ee(!0,arguments)}),1,s,gt,-1,-1),Y("HARMEAN",(function(){return Ee(!1,arguments)}),1,s,dt,-1,-1),Y("TRIMMEAN",(function(t,e){var n,o,r,i=0,a=[];for(pe(t,a),n=function(t){var e,n=0;for(e=0;e<t.length;e++)t[e]!==q&&n++;return n}(a),r=o=c(""+n*e/2);r<n-o;r++)i+=D(a[r]);return i/(n-2*o)}),2,2,[ht,ot],0,0),Y("FREQUENCY",(function(t,e){var n,o,i,a,s,l,u,c,f,h,p,d,g=0,m=e.rowCount,y=e.colCount;for(n=0;n<m;n++)for(o=0;o<y;o++)e[n][o]!==q&&g++;for(a=t.rowCount,s=t.colCount,l=[],u=[],c=g+1,g=0,n=0;n<m;n++)for(o=0;o<y;o++)(i=e[n][o])!==q&&(l[g++]=D(i));for(f=l.slice(0),he(l),n=0;n<c;n++)u[n]=[0];for(n=0;n<a;n++)for(o=0;o<s;o++)if(i=t[n][o],P(i)){for(h=D(i),p=!1,d=0;!p&&d<g;d++)h<=l[d]&&(u[f.indexOf(l[d])][0]++,p=!0);p||u[g][0]++}return new r.CalcArray(u)}),2,2,[mt,mt],-1,-1),Y("RANK",Be,2,3,Xt,[0,1],[0,1],{bk:2}),Y("RANK.EQ",Be,2,3,Xt,[0,1],1,{bk:2}),Y("KURT",(function(){var t,e,n,o,r,a,s=arguments,l=0,u=0,c=0,h=0,p=i(s),d=[];if(p>0){for(a=s[0],d.push(a),o=0;o<i(a);o++)(t=a[o])!==q&&(l+=t,u+=t*t,h++);if(h<=3)return S;if(e=l/h,0===(n=w((h*u-l*l)/(h*(h-1)))))return S;for(r=0;r<p;r++)for(a=d[r],o=0;o<i(a);o++)(t=a[o])!==q&&(c+=f((t-e)/n,4));return M(h*(h+1)*c/((h-1)*(h-2)*(h-3))-3*(h-1)*(h-1)/((h-2)*(h-3)))}}),1,s,dt,-1,-1),Y("PERCENTRANK",Ge,2,3,At,0,0,{bk:2}),Y("PERCENTRANK.INC",Ge,2,3,At,0,0,{bk:2}),Y("PERCENTRANK.EXC",(function(t,e,n){return Jt(t,e,n,!1)}),2,3,At,0,0,{bk:2}),Y("QUARTILE",He,2,2,St,0,0),Y("QUARTILE.INC",He,2,2,St,0,0),Y("COUNT",(function(){return L(arguments,2,2)}),1,s,s,-1,-1,{gk:-1}),Y("COUNTA",(function(){return L(arguments,2,3)}),1,s,s,-1,-1,{gk:-1}),Y("COUNTBLANK",(function(t){var e,n=0;for(e=0;e<i(t);e++)t[e]!==a&&""!==t[e]||n++;return n}),1,1,yt,-1,-1),Y("COUNTIF",(function(t,e){var n,o,i,a,s,u,c,f,h;if(e.isArray||e.isReference){for(n=void 0,o=void 0,i=0,a=[],s=e.rowCount,u=e.colCount,c=0;c<s;c++){for(f=[],h=0;h<u;h++,i++)o=Ve(t,e[i]),_(o)?f.push(o):(n=D(o),l(n)?f.push(A):f.push(n));a.push(f)}return new r.CalcArray(a)}return Ve(t,e[0])}),2,2,[yt,yt],[0,1],[0,1]),Y("COUNTIFS",(function(t){var e,n,o,r,a,s=arguments,l=0,u=i(t),c=i(s),f=[];for(o=0;o<c;o+=2){if((e=0===o?t:N(s[o],0,!0,!1,!1)).isError)return e[0];u=e.length,f.push(e),r=F(s[o+1]),f.push(r)}for(n=0;n<u;n++){for(a=!0,o=0;o<c&&(a=(r=f[o+1])&&r(f[o][n]));o+=2);a&&l++}return M(l)}),2,s,Tt,"%= 0","%= 0"),Y("AVEDEV",(function(){return Oe(!1,arguments)}),1,s,dt,-1,-1),Y("STDEVA",(function(){return Me(arguments,1,!0,!0)}),1,s,wt,-1,-1),Y("STDEVP",ze,1,s,s,-1,-1),Y("STDEV.P",ze,1,s,s,-1,-1),Y("STDEVPA",(function(){return Me(arguments,0,!0,!1)}),1,s,wt,-1,-1),Y("VAR",We,1,s,s,-1,-1),Y("VAR.S",We,1,s,s,-1,-1),Y("VARA",(function(){return Me(arguments,1,!1,!1)}),1,s,wt,-1,-1),Y("VARP",Ue,1,s,s,-1,-1),Y("VAR.P",Ue,1,s,s,-1,-1),Y("VARPA",(function(){return Me(arguments,0,!1,!1)}),1,s,wt,-1,-1),Y("COVAR",qe,2,2,Dt,-1,-1),Y("COVARIANCE.P",qe,2,2,Dt,-1,-1),Y("DEVSQ",(function(){return Oe(!0,arguments)}),1,s,dt,-1,-1),Y("CONFIDENCE",Ye,3,3,It),Y("CONFIDENCE.NORM",Ye,3,3,It),Y("CONFIDENCE.T",(function(t,e,n){return 1===n?S:e*Ae(t,n-1,2)/w(n)}),3,3,It),Y("INTERCEPT",(function(t,e){var n,o,r,a=0,s=0,l=0,u=0,c=0,f=i(t);if(f!==i(e))return I;for(r=0;r<f;r++)n=t[r],(o=e[r])!==q&&n!==q&&(a+=n,s+=o,l+=o*o,u+=o*n,c++);return 0===c||c*l-s*s==0?S:M(a/c-(c*u-s*a)/(c*l-s*s)*(s/c))}),2,2,[dt,dt],-1,-1),Y("LINEST",(function(t,e,n,o){return De(!1,t,e,n,o)}),1,4,Yt,[0,1],[0,1],{bk:[1,2,3],fk:1}),Y("SLOPE",(function(t,e){var n,o,r,a,s,l=0,u=0,c=0,f=0,h=0,p=i(e);if(p!==i(t))return I;for(n=0;n<p;n++)o=t[n],(r=e[n])===q||o===q||_(r)||_(o)||(l+=a=D(o),u+=s=D(r),c+=s*s,f+=s*a,h++);return h*c-u*u==0?S:M((h*f-u*l)/(h*c-u*u))}),2,2,[dt,dt],-1,-1,{fk:1}),Y("LOGEST",(function(t,e,n,o){return De(!0,t,e,n,o)}),1,4,Yt,[0,1],[0,1],{bk:[1,2,3]}),Y("STEYX",(function(t,e){var n,o,r,a,s,l=0,u=0,c=0,f=0,h=0,p=0,d=i(t);if(d!==i(e))return I;for(r=0;r<d;r++)a=t[r],s=e[r],a!==q&&s!==q&&(l+=o=a,u+=o*o,c+=n=s,f+=n*n,h+=n*o,p++);return p*(p-2)==0||p*f-c*c==0?S:w((p*u-l*l-(p*h-c*l)*(p*h-c*l)/(p*f-c*c))/(p*(p-2)))}),2,2,Dt,-1,-1),Y("BETADIST",Ze,3,5,[nt,it,it,at,st],s,s,{bk:[3,4]}),Y("BETA.DIST",(function(t,e,n,o,r,i){if(t<r||i<t||r===i)return R;var a=(t-r)/(i-r);return o?ge(a,e,n):me(a,e,n)/(i-r)}),4,6,[nt,it,it,Q,at,st],s,s,{bk:[5,6]}),Y("BETAINV",Qe,3,5,Rt,s,s,{bk:[3,4]}),Y("BETA.INV",Qe,3,5,Rt,s,s,{bk:[3,4]}),Y("BINOMDIST",Je,4,4,kt),Y("BINOM.DIST",Je,4,4,kt),Y("NEGBINOMDIST",(function(t,e,n){if(t+e-1<=0)return R;var o=j(t+e-1,e-1);return _(o)?o:M(D(o)*f(n,e)*f(1-n,t))}),3,3,[$,$,ot]),Y("NEGBINOM.DIST",(function(t,e,n,o){if(t+e-1<=0)return R;if(o)return 1-ge(1-n,t+1,e);var r,i=f(n,e);for(r=0;r<t;r++)i*=(r+e)/(r+1)*(1-n);return i}),4,4,[tt,K,ot,Q]),Y("CRITBINOM",$e,3,3,Mt),Y("BINOM.INV",$e,3,3,Mt),Y("CHIDIST",Ke,2,2,Nt),Y("CHISQ.DIST.RT",Ke,2,2,Nt),Y("CHISQ.DIST",(function(t,e,n){return n?Te(t,e):function(t,e){var n,o;if(t<=0)return 0;if(e*t>1391e3)n=C((.5*e-1)*T(.5*t)-.5*t-T(2)-be(.5*e));else{for(e%2<.5?(n=.5,o=2):(n=1/w(2*t*y),o=1);o<e;)n*=t/o,o+=2;n=t>=1425?C(T(n)-t/2):n*C(-t/2)}return n}(t,e)}),3,3,[ut,et,Q]),Y("CHIINV",tn,2,2,Et),Y("CHISQ.INV.RT",tn,2,2,[lt,K]),Y("CHISQ.INV",(function(t,e){var n={jl:!1},o=se(function(t,e){return{ge:function(n){return t-Te(n,e)}}}(t,e),.5*e,e,n);return n.jl?I:o}),2,2,Et),Y("CHITEST",en,2,2,Dt,-1,-1),Y("CHISQ.TEST",en,2,2,Dt,-1,-1),Y("CORREL",(function(t,e){var n,o,a,s,l,u,c,f,h=r.ExcelCompatibleCalcMode?5:1,p=N(t,h,!0,!1,!1,!0),d=N(e,h,!0,!1,!1,!0),g=0,m=0,y=0,v=0,C=0,b=i(d);if(b!==i(p))return I;for(l=0,u=0;u<b;u++){if(c=p[u],f=d[u],_(c))return c;if(_(f))return f;c!==q&&f!==q&&(g+=c,m+=f,y+=c*c,v+=f*f,l++)}if(l<=1)return S;if(n=g/l,o=m/l,a=w((l*y-g*g)/(l*(l-1))),s=w((l*v-m*m)/(l*(l-1))),0===a||0===s)return S;for(u=0;u<b;u++)c=p[u],f=d[u],c!==q&&f!==q&&(C+=(c-n)*(f-o));return M(C/D((l-1)*a*s))}),2,2,s,-1,-1),Y("EXPONDIST",nn,3,3,Ot),Y("EXPON.DIST",nn,3,3,Ot),Y("FDIST",on,3,3,jt),Y("F.DIST",(function(t,e,n,o){return o?1-ge(n/(n+e*t),n/2,e/2):f(e/n,e/2)*f(t,e/2-1)/(f(1+t*e/n,(e+n)/2)*ye(!0,e/2,n/2))}),4,4,[ut,ct,ct,Q]),Y("F.DIST.RT",on,3,3,jt),Y("FINV",rn,3,3,Ft),Y("F.INV.RT",rn,3,3,Ft),Y("F.INV",(function(t,e,n){var o=Qe(1-t,n/2,e/2,0,1);return _(o)?o:(1/D(o)-1)*(n/e)}),3,3,[lt,et,et]),Y("FISHER",(function(t){return T((1+t)/(1-t))/2}),1,1,{Hi:0,aj:["<= -1",">= 1"]}),Y("FISHERINV",(function(t){var e=C(2*t)-1,n=C(2*t)+1;return!u(e)&&e>0&&!u(n)&&n>0?1:e/n}),1,1,nt),Y("FTEST",an,2,2,Pt,-1,-1),Y("F.TEST",an,2,2,Pt,-1,-1),Y("GAMMADIST",sn,4,4,_t),Y("GAMMA.DIST",sn,4,4,_t),Y("GAMMAINV",ln,3,3,Lt),Y("GAMMA.INV",ln,3,3,Lt),Y("GAMMALN",un,1,1,it),Y("GAMMALN.PRECISE",un,1,1,it),Y("HYPGEOMDIST",(function(t,e,n,o){return t>p(e,n)||t<h(0,e-o+n)||e>o||n>o?R:xe(t,e,n,o)}),4,4,[tt,tt,tt,tt]),Y("HYPGEOM.DIST",(function(t,e,n,o,r){var i,a;if(t>p(e,n)||t<h(0,e-o+n)||e>o||n>o)return R;if(r){for(i=0,a=0;a<=t;a++)i+=xe(a,e,n,o);return i}return xe(t,e,n,o)}),5,5,[tt,tt,tt,tt,Q]),Y("LOGNORMDIST",(function(t,e,n){return H((T(t)-e)/n)}),3,3,[it,nt,it]),Y("LOGNORM.DIST",(function(t,e,n,o){if(o)return H((T(t)-e)/n);var r=(T(t)-e)/n;return.3989422804014327*C(-r*r/2)/n/t}),4,4,[it,nt,it,Q]),Y("LOGINV",cn,3,3,Bt),Y("LOGNORM.INV",cn,3,3,Bt),Y("NORMDIST",fn,4,4,Gt),Y("NORM.DIST",fn,4,4,Gt),Y("NORMINV",hn,3,3,Bt),Y("NORM.INV",hn,3,3,Bt),Y("NORMSDIST",H,1,1,nt,s,s),Y("NORMSINV",pn,1,1,lt),Y("NORM.S.INV",pn,1,1,lt),Y("NORM.S.DIST",(function(t,e){return e?function(t){var e,n;return e=D(t=.7071067811865475*-t),l(e)?A:(n=H(e*w(2)),_(n)?NaN:.5*(2-2*n))}(t):C(-f(t,2)/2)/w(2*y)}),2,2,[nt,Q]),Y("PEARSON",(function(t,e){var n,o,r,a,s=0,l=0,u=0,c=0,f=0,h=i(t);if(h!==i(e))return I;for(n=0,o=0;o<h;o++)r=t[o],a=e[o],W(r)&&W(a)&&(s+=r,l+=a,u+=r*r,c+=a*a,f+=r*a,n++);return n*u-s*s==0||n*c-l*l==0?S:(n*f-s*l)/w((n*u-s*s)*(n*c-l*l))}),2,2,Ht,-1,-1),Y("RSQ",(function(t,e){var n,o,r,a,s,l=0,u=0,c=0,f=0,h=0,p=0,d=i(e);if(d!==i(t))return I;for(n=0;n<d;n++)o=e[n],r=t[n],W(o)&&W(r)&&(l+=o,u+=r,c+=o*o,f+=r*r,h+=o*r,p++);return 0===(a=w((p*c-l*l)*(p*f-u*u)))?S:M((s=(p*h-l*u)/a)*s)}),2,2,Ht,[0,1],[0,1]),Y("POISSON",dn,3,3,Vt),Y("POISSON.DIST",dn,3,3,Vt),Y("PROB",(function(t,e,n,o){var r,a,u,c,f,h,p=n;if(o!==s&&(p=D(o),l(p)))return A;if(r=0,a=0,(u=i(t))!==i(e))return I;for(c=0;c<u;c++)if(f=t[c],h=e[c],f!==q&&h!==q){if(h<=0||1<h)return R;n<=f&&f<=p&&(r+=h),a+=h}return 1!==a?R:r}),3,4,[Ct,pt,nt],[0,1],[0,1],{bk:3}),Y("SKEW",(function(){var t,e,n,o,r,a,s=arguments,l=0,u=0,c=0,h=0,p=[];for(n=0;n<i(s);n++)for(a=s[n],p.push(a),o=0;o<i(a);o++)(r=a[o])!==q&&(l+=r,u+=r*r,h++);if(h<=2)return S;if(t=l/h,0===(e=w((h*u-l*l)/(h*(h-1)))))return S;for(n=0;n<i(p);n++)for(a=p[n],o=0;o<i(a);o++)(r=a[o])!==q&&(c+=f((r-t)/e,3));return M(h*c/((h-1)*(h-2)))}),1,s,dt,-1,-1),Y("STANDARDIZE",(function(t,e,n){return(t-e)/n}),3,3,[nt,nt,it]),Y("TDIST",gn,3,3,[ut,K,$]),Y("T.DIST",(function(t,e,n){return Se(t,e,n?4:3)}),3,3,[ut,K,Q]),Y("T.DIST.RT",(function(t,e){return gn(t,e,1)}),2,2,zt),Y("T.DIST.2T",(function(t,e){return gn(t,e,2)}),2,2,zt),Y("TINV",mn,2,2,Et),Y("T.INV.2T",mn,2,2,Et),Y("T.INV",(function(t,e){return t<.5?-Ae(1-t,e,4):Ae(t,e,4)}),2,2,[{Hi:0,aj:["<= 0","> 1"]},et]),Y("TTEST",yn,4,4,Wt,[0,1],[0,1]),Y("T.TEST",yn,4,4,Wt,[0,1],[0,1]),Y("WEIBULL",vn,4,4,Ut),Y("WEIBULL.DIST",vn,4,4,Ut),Y("ZTEST",Cn,2,3,qt,0,0,{bk:2}),Y("Z.TEST",Cn,2,3,qt,0,0,{bk:2}),Y("PERMUT",(function(t,e){t=D(E(t)),e=D(E(e));var n,o=1;if(t<0||e<0||t<e)return R;for(n=t-e+1;n<=t;n++)o*=n;return M(o)}),2,2),Y("COVARIANCE.S",(function(t,e){return Ne(!1,t,e)}),2,2,Dt,-1,-1),Y("MODE.MULT",(function(){var t,e,n,o=0,a=[],s=de(arguments),l=i(s);for(t=0;t<l;t++){for(e=0,n=t+1;n<l;n++)s[t]===s[n]&&e++;e>o?(o=e,(a=[]).push([s[t]])):e===o&&a.push([s[t]])}return 0===o?I:new r.CalcArray(a)}),1,s,gt,-1,-1),Y("PERCENTILE.EXC",(function(t,e){return G([t,e],18)}),2,2,[ht,rt],0,0),Y("QUARTILE.EXC",(function(t,e){return G([t,e],19)}),2,2,[bt,$],0,0),Y("RANK.AVG",(function(t,e,n){return t.rowCount>1||t.colCount>1?A:Re(!1,e,t[0],n)}),2,3,[Ct,vt,at],[0,1],1,{bk:2}),Y("PERMUTATIONA",(function(t,e){var n,o=e;return t>=0&&t<2147483647&&o>=0&&o<2147483647&&(t=Math.pow(c(t),c(o)),(n=Math.abs(t))<=179769e303)?n>=22250738585072014e-324?t:0:R}),2,2,[nt,nt]),Y("PHI",(function(t){var e,n;return""===t?A:!0===X(t,e={value:0})?(t=.3989422804014327*Math.exp(-e.value*e.value*.5),(n=Math.abs(t))<=179769e303?n>=22250738585072014e-324?t:0:R):A}),1,1),Y("BINOM.DIST.RANGE",(function(t,e,n,o){var r,i,a,s,l,u,c,f,h=[1,1,2,6,24,120,720,5040,40320,362880,3628800,39916800,479001600,6227020800,87178291200,1307674368e3,20922789888e3,355687428096e3,6402373705728e3,0x1b02b9306890000,243290200817664e4,5109094217170944e4,11240007277776077e5,2585201673888498e7,6204484017332394e8,15511210043330986e9,40329146112660565e10,10888869450418352e12,30488834461171387e13,8.841761993739702e30,26525285981219107e16,8222838654177922e18,2631308369336935e20,8683317618811886e21,29523279903960416e22,1.0333147966386145e40,37199332678990125e25,13763753091226346e27,5230226174666011e29,20397882081197444e30,8159152832478977e32,3345252661316381e34,140500611775288e37,6041526306337383e37,2658271574788449e39,11962222086548019e40,5502622159812089e42,25862324151116818e43,12413915592536073e45,6082818640342675e47,30414093201713376e48,15511187532873822e50,8065817517094388e52,42748832840600255e53,2308436973392414e56,12696403353658276e57,7109985878048635e59,40526919504877214e60,23505613312828785e62,1.3868311854568984e80,832098711274139e67,5075802138772248e68,3146997326038794e70,198260831540444e73,12688693218588417e73,8.247650592082472e90,5443449390774431e77,3647111091818868e79,24800355424368305e80,1711224524281413e83,1.1978571669969892e100,8504785885678623e86,61234458376886085e87,44701154615126844e89,3307885441519386e92,248091408113954e95,18854947016660504e95,14518309202828587e97,11324281178206297e99,8946182130782976e101,7156945704626381e103,5.797126020747368e120,4753643337012842e107,3945523969720659e109,3314240134565353e111,281710411438055e114,2.4227095383672734e130,2107757298379528e117,18548264225739844e118,1650795516090846e121,14857159644817615e122,1.352001527678403e140,12438414054641308e126,11567725070816416e128,1087366156656743e131,1032997848823906e133,9916779348709496e134,9619275968248212e136,9426890448883248e138,9332621544394415e140,9332621544394415e142,942594775983836e145,9614466715035127e146,990290071648618e149,10299016745145628e150,1081396758240291e153,1.1462805637347084e170,1226520203196138e157,1324641819451829e159,14438595832024937e160,1588245541522743e163,1.7629525510902446e180,1974506857221074e167,22311927486598138e168,25435597334721877e170,2925093693493016e173,3.393108684451898e190,3969937160808721e177,4684525849754291e179,5574585761207606e181,6689502913449127e183,8.094298525273444e200,9875044200833601e187,1214630436702533e190,1506141741511141e192,1882677176888926e194,2372173242880047e196,30126600184576594e197,3856204823625804e200,4974504222477287e202,6466855489220474e204,847158069087882e207,11182486511960043e208,14872707060906857e210,19929427461615188e212,2.6904727073180504e230,3659042881952549e217,5012888748274992e219,6917786472619489e221,9615723196941089e223,13462012475717526e225,1898143759076171e228,2695364137888163e230,3854370717180073e232,55502938327393044e233,8047926057471992e236,11749972043909107e238,1727245890454639e241,25563239178728654e242,3.80892263763057e260,5713383956445855e247,862720977423324e250,13113358856834524e251,20063439050956823e253,30897696138473508e255,4789142901463394e258,7471062926282894e260,11729568794264145e262,1.853271869493735e280,29467022724950384e266,47147236359920616e268,7590705053947219e271,12296942187394494e273,20044015765453026e275,3287218585534296e278,5423910666131589e280,9003691705778438e282,1.503616514864999e300,25260757449731984e286,4269068009004705e289,7257415615307999e291];function p(t){return t<171?t<0?NaN:h[t]:1/0}function d(t,e){var n,o,r,i;if(t<=e)return t===e&&e>=0?1:A;if(t<2*e&&(e=t-e),e<2)return e>=0?0!==e?t:1:A;if(t<171)return p(t)/(p(e)*p(t-e));if(e>514)return A;if(t>8192){for(n=t,o=2;o<=e;o++)n*=--t/o;return n}for(r=t,t--,i=2;;)switch(e-i){case-1:return r;case 0:return t/i*r;case 1:return t*(t-1)/(i*(i+1))*r;case 2:return t*(t-1)*(t-2)/(i*(i+1)*(i+2))*r;default:r*=t*(t-1)*(t-2)*(t-3)/(i*(i+1)*(i+2)*(i+3)),i+=4,t-=4}}if(t=Z(t,r={value:0}),e=X(e,i={value:0}),n=Z(n,a={value:0}),4===arguments.length&&o?o=Z(o,s={value:0}):(o=n,s=a),!0===t&&!0===e&&!0===n&&!0===o){if(t=r.value,e=i.value,n=a.value,o=s.value,t>=0&&t<=2147483646&&e>=0&&e<=1&&n>=0&&n<=t&&o>=n&&o<=t){if((l=t*e*(1-e))>100)return Qt((o-(e*=t)+.5)/(l=Math.sqrt(l)))-Qt((n-1-e+.5)/l);if(0===(u=d(t,n)*Math.pow(e,n)*Math.pow(1-e,t-n)))return 0;for(c=u,l=u,e/=1-e,f=n;f<o;f++)c+=l*=(t-f)/(f+1)*e;return c<=1?c:1}return R}return A}),3,4,[{_i:0},{_i:0},{_i:0}]),Y("GAMMA",(function(t){var e,n,o;if(t>0)t=Math.exp(re(t));else{if(0===(n=t+(e=Math.abs(c(t)))))return R;t=Math.pow(-1,e-1)*Math.exp(re(-n))*Math.exp(re(1+n))/Math.exp(re(e+1-n))}return(o=Math.abs(t))<=179769e303?o>=22250738585072014e-324?t:0:R}),1,1,it),Y("GAUSS",(function(t){t=Qt(t)-.5;var e=Math.abs(t);return e<=179769e303?e>=22250738585072014e-324?t:0:R}),1,1,nt),Y("SKEW.P",(function(){var t,e,n,o,r,a,s,l,u,c,h=arguments,p=0,d=0,g=[];for(n=0;n<i(h);n++){if(a=h[n],1===i(h)&&0===i(a))return k;for(o=0;o<i(a);o++)s={value:0},(r=a[o])!==q&&"boolean"!=typeof r&&X(r,s)&&(p+=s.value,d++,g.push(s.value))}if(d<=2)return S;for(t=p/d,l=0,u=0,c=0,n=0;n<g.length;n++)c=g[n]-t,u+=f(c,2),l+=f(c,3);return 0===(e=w(u/d))?S:M(l/d/e/e/e)}),1,s,wt,-1,-1)},CalcEngine:function(t,e){t.exports=n("@grapecity/js-calc")},Common:function(t,e){t.exports=n("Common")}}),t.exports=o.Spread.CalcEngine.AdvancedFunctions},"./node_modules_local/@grapecity/js-calc-advancedfunctions/index.js":function(t,e,n){t.exports=n("./node_modules_local/@grapecity/js-calc-advancedfunctions/dist/gc.spread.calcengine.advancedfunctions.js")},"./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js":function(t,e,n){var o="object"==typeof o?o:{};o.Spread=o.Spread||{},o.Spread.CalcEngine=o.Spread.CalcEngine||{},o.Spread.CalcEngine.BasicFunctions=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){var o,r;if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)n.d(o,r,(function(e){return t[e]}).bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/",n(n.s="./src/basicFunctions.entry.ts")}({"./src/basicFunctions.entry.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("CalcEngine");e.Functions=o.Functions,n("./src/functions-basic.ts")},"./src/functions-basic.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt,Mt,Nt,Et;function Dt(t,e){for(;0!==e;){var n=t%e;t=e,e=n}return t}function Ot(t,e,n,o){return 0===e||0===t?0:0!==n&&t<0?!0===o?lt(t/Math.abs(e))*Math.abs(e):st(t/Math.abs(e))*Math.abs(e):!0===o?st(t/Math.abs(e))*Math.abs(e):lt(t/Math.abs(e))*Math.abs(e)}function jt(t,e){var n,o,r,i,a,s,l=t[0],u=f(l),c=l.rowCount,h=l.colCount,p=[],d=[],g=[];for(i=1;i<f(t);i+=2){if((s=q(t[i],0,!0,!1,!1)).rowCount!==c||s.colCount!==h)return E;a=at.xk(t[i+1]),p.push(s),d.push(a)}for(r=0;r<u;r++){for(o=!0,i=0;i<f(p)&&(a=d[i],n=p[i][r],o=a&&a(n));i++);o&&((n=l[r])!==_&&g.push(n))}return e(g)}function Ft(t,e){return e=e<0?x(e):Math.ceil(e),(t&&e%2==0||!t&&e%2!=0)&&(e+=e<0?-1:1),e}function Pt(t,e,n){return e>0&&n<0?P:e<0&&n>0?(n=-n,t?lt(e/n)*n:st(e/n)*n):t?st(e/n)*n:lt(e/n)*n}function _t(t,e,n){var o,r,i,a=at.yk(C(n));return o=st(e=n<0?e/a:e*a),r=lt(e),t&&(i=o,o=r,r=i),e=e<0?o:r,Y(e=n<0?e*a:e/a)}function Lt(t,e,n,o){var r,i,a,s=e?-1:1,l=0;if(f(n)!==f(o))return F;for(a=0;a<f(n);a++)r=n[a],i=o[a],r!==_&&i!==_&&(l+=t?(r-i)*(r-i):r*r+s*i*i);return Y(l)}function Bt(){var t,e,n,o,r=arguments,i=0;for(t=0;t<f(r);t++){if(e=r[t],n=void 0,o=void 0,L(e))return e;if(B(e)||G(e)){if((n=q(e,1,!0,!0,!1)).isError)return n[0]}else n=q(e,1,!0,!0,!0);for(o=0;o<f(n);o++)n[o]!==_&&(i+=n[o])}return i}function Gt(t,e,n){var o=E;return p(t,[1,101,2,102,3,103,4,104,5,105,6,106,9,109])>=0?o=ot(n,e,t):p(t,[7,107,8,108,10,110,11,111])>=0&&(o=it(n,e,t)),o}function Ht(t,e){return at.Ak(t,e)}function Vt(t,e){return _t(!1,t,e)}function zt(t,e){return st(t/C(e))*C(e)}function Wt(t){return Y(Math.sin(t))}function Ut(t){return Y(Math.cos(t))}function qt(t){return Y(at.Dk(t,!0))}function Yt(t){return Y(at.Dk(t,!1))}function Xt(t){var e=S(t),n=S(-t);return Y(e-n)/(e+n)}function Zt(t){return Y(A((1+t)/(1-t))/2)}function Qt(t,e){var n,o,i,a,s=!0;for(n=0;n<f(e);n++)for(i=e[n],o=0;o<f(i);o++){if(r.ExcelCompatibleCalcMode){if("string"==typeof i[o]||d(i[o]))continue;s=!1}if(a={value:null},i[o]=ct(i[o],a)?a.value:_,t){if(!i[o])return!1}else if(i[o]&&i[o]!==_)return!0}return r.ExcelCompatibleCalcMode&&s?E:!!t}function Jt(t){var e,n=t.getFullYear(),o=t.getMonth(),r=t.getDate();for(e=0;e<o;e++)r+=et(n,e);return r}function $t(t){if(Q(t)){if(7!==f(t)||m(v(t)))return E}else if(!m(t)){if(x(t)<1||x(t)>17)return P;t=""+t}var e,n=["1","2","3","4","5","6","7"],o=[0,0,0,0,0,0,0];switch(f(t)){case 1:if(p(t,n)>=0){o[((e=v(t))+4)%7]=1,o[(e+5)%7]=1;break}return P;case 2:if("1"===t[0]&&p(t[1],n)>=0){o[((e=v(t[1]))+5)%7]=1;break}return P;case 7:for(e=0;e<7;e++)o[e]=v(t[e]);break;default:return E}return o}function Kt(t,e,n,o,r){var i,a=re(e,3);if(L(a))return a;for(i=V(a);n<0;++n)e.setDate(e.getDate()-1),i=0===i?6:--i,(t&&(5===i||6===i)||!t&&r[i]||o.indexOf(l(e))>=0)&&n--;for(;n>0;--n)e.setDate(e.getDate()+1),i=6===i?0:++i,(t&&(5===i||6===i)||!t&&r[i]||o.indexOf(l(e))>=0)&&n++;return l(e)}function te(t,e,n,o,r,i){var a,s,l,c,h,p,d,m,y;if(i&&(s=$t(t=t!==g?t:"0000011"),L(s)))return s;if(e!==g&&(a=q(e,4,!0,!0,!1)),!a)return r;if(a.isError)return a[0];for(l=f(a),c=[],h=0;h<l;h++)p=a[h],m=(d=u(p)).getDay(),y=f(s)?s[re(d,3)]:6===m||0===m,-1===c.indexOf(p)&&!y&&p>=n&&p<=o&&c.push(p);return r-f(c)}function ee(t,e,n,o,r,i){var a,s,u,c=V(l(e)),f=V(l(n)),h=!1;return c>f&&(a=e,e=n,n=a,s=c,c=f,f=s,h=!0),u=i(e,n,u=f-c+1,o),t&&L(u)?u:u<=0?0:(u=te(o,r,c,f,u,t),u=h?-u:u)}function ne(t,e,n){var o,i;return e=r.Convert.Wh(e),(o=new Date(e.getFullYear(),e.getMonth(),1)).setMonth(o.getMonth()+n),i=et(o.getFullYear(),o.getMonth()),o.setDate(t?i:T(e.getDate(),i)),o}function oe(t){var e;return Q(t)&&(e=c(t)),e?(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())/86400:E}function re(t,e){var n=t.getDay();switch(e){case 1:return n+1;case 2:return 0===n?7:n;case 3:return 0===n?6:n-1;default:return P}}function ie(t,e,n,o){var r,i,a,s,l,u,c;if(r=$t(o=o!==g?o:"0000011"),i=0,a=0,L(r))return r;for(s=0;s<f(r);s++)1===r[s]&&i++;if(n<30){for(s=0;s<n;s++)r[(V(re(t,3))+s)%7]&&a++;return n-a}for(l=n,u=0,c=0,s=0;s<l&&V(re(t,3)+s)%7!=0;s++)u++;for(s=0;s<u;s++)r[(V(re(t,3))+s)%7]&&a++;for(s=0;s<l&&(V(re(e,3))+7-s)%7!=6;s++)c++;for(s=0;s<c;s++)r[(V(re(e,3))+7-s)%7]&&a++;return(n-=V((l=l-u-c)/7)*i)-a}function ae(t){var e,n,o,r=""+t,i="",a=[];if(t<0&&(r=r.substr(1),i="-"),n=r.split("."),(o=f(n))<1||o>2)return E;for(2===o&&(a.push(n[1]),a.push(".")),r=n[0],e=f(r)-3;e>=0;e-=3)a.push(r.substr(e,3)),e>0&&a.push(",");return a.push(r.substring(0,e+3)),a.reverse(),i+a.join("")}function se(t,e){var n,o,r,i,a=[],s=f(t);for(n=0;n<s;n++){if(r=t[n],0===(i=f(r))&&"concat"===e)return M;for(o=0;o<i;o++)d(r[o])||a.push(W(r[o]))}return a.join("")}function le(t,e,n){var o,r=[],i=0;for(o=0;o<e.length;o++)if("fourByte"===$(e[o])){if(0===i){i++;continue}i=0,r.push(e[o-1]+e[o])}else r.push(e[o]);return n>=r.length?e:r.splice(t?0:r.length-n,n).join("")}function ue(t,e,n,o){var r,i,a=f(t);return e=T(e,a+1),n=T(n||0,a-e+1),r=t.substring(0,e-1),i=t.substr(e-1+n),r.concat(o).concat(i)}function ce(t,e,n){var o,r=f(e);if(0===r)return M;for(o=0;o<r;o++)d(e[o])||""===e[o]?n||t.push(""):t.push(W(e[o]))}function fe(t,e){if(0===t.length)return"";if(1===e.length)return t.join(e[0]);for(var n=t[0],o=1,r=0;o<t.length;o++,r++)r===e.length&&(r=0),n+=e[r]+t[o];return n}function he(t,e,n){var o,i,a,s,l,u,c,f;if(de()||r.usedbcs){for(o=[],i=void 0,a=0,s=void 0,l=0,s=0;s<e.length;s++)if(i=e[s],"fourByte"===(u=$(e[s]))){if(a%2==0){a++;continue}a++,i=e[s-1]+e[s],o[o.length]=i}else"doubleByte"===u&&(l++,i=e[s]),o[s-(a>0?a/2:0)+l]=i;return t||(o=tt(o)),n>=(c=o.length)?e:(f=void 0,t?(f=o.slice(0,n-1<0?0:n)).length>0&&d(f[f.length-1])&&(f[f.length-1]="â"):(f=o.slice(c-n)).length>0&&d(f[0])&&(f[0]="â"),f.join(""))}return le(t,e,n)}function pe(t,e,n){e--;var o=f(t);return e>=o?"":o<e+n?t.substr(e):t.substr(e,n)}function de(){return!!o.Common.CultureManager.q4().isJCKCulture}function ge(t,e,n){if(n<1||f(e)<n)return E;var o=e.indexOf(t,n-1);return-1===o?E:o+1}function me(t,e,n){var o,r,a=-1;return(o=i.ub(t))?(r=i.sb(o).exec(e),a=d(r)?-1:r.index):a=e.toLowerCase().indexOf(t.toLowerCase(),--n),-1===a?E:a+1}function ye(t){for(var e=0;e<t.length;e++)d(t[e])&&t[e-1]&&2!==t[e-1].length&&(t[e]="â");return t.join("")}function ve(t,e){return e}function Ce(t){return t>=55296&&t<=57343}function be(t,e){return!(t<55296||t>56319)&&e>=56320&&e<=57343}function we(t,e){return L(t)?F:G(t)?q(t,e,!0,!0,!1):q(t,e,!0,!0,!0)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("CalcEngine"),i=o.Common.q,a=o.Common.u,s=o.Common.l,l=s.Ra,u=s.Xb,c=s.Qa,f=o.Common.k.ac,h=o.Common.j,p=h.Ea,d=h.Fa,g=void 0,m=isNaN,y=parseFloat,v=parseInt,Math.round,C=Math.abs,b=Math.sqrt,w=Math.max,T=Math.min,x=Math.floor,S=Math.exp,A=Math.log,I=Math.PI,R=Math.random,k=Math.pow,M=r.Errors.Null,N=r.Errors.DivideByZero,E=r.Errors.Value,D=r.Errors.Reference,O=r.Errors.Name,j=r.Errors.Calc,F=r.Errors.NotAvailable,P=r.Errors.Number,_=r.Convert.CalcConvertedError,L=r.Convert.vf,B=r.Convert.Fh,G=r.Convert.Ca,H=r.Convert.Uh,V=r.Convert.Rh,z=r.Convert.Pa,W=r.Convert.bc,U=r.Convert.Na,q=r.Convert.Ph,Y=r.Convert.Nh,X=r.Zh.tryExtractToSingleValue,Z=r.Functions.ik,Q=r.Functions.jk,J=r.Functions.kk,$=r.Functions.UAb,K=r.Functions.VAb,tt=r.Functions.WAb,et=r.Functions.nk,nt=r.Functions.tk,ot=r.Functions.Hfc,rt=r.Functions.mja,it=r.Functions.sk,at=r.Functions.MathHelper,st=at.zk,lt=at.wk,ut=r.Functions.ak,ct=r.Convert.Th,ft=r.Convert.Uh,ht=r.Convert.jja,dt={Hi:0,aj:"= 0",bj:N},gt={Hi:0,aj:"= 0",bj:0},mt={_i:1,Hi:0,aj:"= 0",bj:0},yt={Hi:2,aj:"< 0"},vt={Hi:0,aj:["> 134217728","< -134217728"]},Ct={Hi:1},bt={Hi:2},wt={_i:1,Hi:2},Tt={_i:1,Hi:2,aj:"< 0",bj:E},xt={Hi:5},St={Hi:6},At={Hi:2,aj:"< 0",bj:E},It={_i:[],Hi:4,Ii:4,Ji:!0,Ki:!0,Li:!0},Rt={Hi:4,Ii:1,Ji:!0,Ki:!0},kt={Hi:4,Ii:1,Ki:!0,Li:!0},Mt={Hi:4,Ii:1,Ji:!0,Ki:!0,Xi:!0},Nt={Hi:4,Ii:3,Ji:!0,Ki:!0,Xi:!0},Et={Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},ut("ABS",(function(t){return Y(C(t))}),1,1,pt={Hi:0}),ut("ACOS",(function(t){return Y(Math.acos(t))}),1,1,{Hi:0,aj:["> 1","< -1"]}),ut("ACOT",(function(t){return Y(t<0?Math.PI+Math.atan(1/t):Math.atan(1/t))}),1,1,pt),ut("ASIN",(function(t){return Y(Math.asin(t))}),1,1,{Hi:0,aj:["> 1","< -1"]}),ut("ATAN",(function(t){return Y(Math.atan(t))}),1,1,pt),ut("ATAN2",(function(t,e){return 0===t&&0===e?N:Y(Math.atan2(e,t))}),2,2,[pt,pt]),ut("COS",Ut,1,1,pt),ut("SEC",(function(t){var e=Ut(t);return 0===e?N:1/e}),1,1,vt),ut("CEILING",(function(t,e){return Pt(!0,t,e)}),2,2,[gt,gt]),ut("ODD",(function(t){return Ft(!0,t)}),1,1,Ct),ut("EVEN",(function(t){return Ft(!1,t)}),1,1,Ct),ut("FLOOR",(function(t,e){return Pt(!1,t,e)}),2,2,[gt,gt]),ut("LN",(function(t){return Y(A(t))}),1,1,{Hi:1,aj:"<= 0"}),ut("SQRT",(function(t){return b(t)}),1,1,{Hi:0,aj:"< 0"}),ut("SIN",Wt,1,1,pt),ut("CSC",(function(t){var e=Wt(t);return 0===e?N:1/e}),1,1,vt),ut("TAN",(function(t){return Y(Math.tan(t))}),1,1,pt),ut("COT",(function(t){return 0===t?N:Y(1/Math.tan(t))}),1,1,vt),ut("SIGN",(function(t){return 0===t?0:-1}),1,1,{Hi:1,aj:"> 0",bj:1}),ut("GCD",(function(){var t,e,n,o,r=arguments,i=0;for(t=0;t<f(r);t++)for(n=r[t],e=0;e<f(n);e++)if((o=n[e])!==_){if(o<0)return P;i=Dt(i,V(o))}return i}),1,g,Mt,-1,-1),ut("LCM",(function(){var t,e,n,o,r=arguments,i=1,a=[];for(t=0;t<f(r);t++){for(n=r[t],e=0;e<f(n);e++)if((o=n[e])!==_){if(o<0)return P;if(0===o)return 0;a.push(V(o))}for(e=0;e<f(a);e++)i/=Dt(i,o=a[e]),i*=o}return i}),1,g,Mt,-1,-1),ut("PRODUCT",(function(){return ot(arguments,2,6)}),1,g,g,-1,-1),ut("POWER",(function(t,e){if(0===t&&e<0)return N;if(0===t&&0===e)return P;var n=r.Functions.MathHelper.YDc(t,e);return n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY||isNaN(n)?P:n}),2,2,[pt,pt]),ut("MOD",(function(t,e){return t-e*x(t/e)}),2,2,[pt,{Hi:0,aj:"= 0",bj:N}]),ut("QUOTIENT",(function(t,e){return v(""+t/e)}),2,2,[pt,dt],g,g),ut("SUBTOTAL",(function(t){var e,n=arguments,o=[];for(e=1;e<f(n);e++)o[e-1]=n[e];return Gt(t,0,o)}),2,g,bt,"!= 0"),ut("_SUBTOTALFORSTATUSBAR",(function(t){var e,n=arguments,o=[];for(e=1;e<f(n);e++)o[e-1]=n[e];return Gt(t,1,o)}),2,g,bt,"!= 0"),ut("INT",(function(t,e){var n,o,r,i;if(B(e))if(n=e.getRow(0),o=e.getColumn(0),r=e.getRowCount(0),i=e.getColumnCount(0),1===r&&1===i)e=e.getValue(0,0,0);else if(1!==r&&1===i&&n<=t.row&&t.row<n+r)e=e.getValue(0,t.row-n,0);else{if(!(1===r&&1!==i&&o<=t.column&&t.column<o+i))return E;e=e.getValue(0,0,t.column-o)}return e=z(e),isNaN(e)?E:lt(e)}),1,1,g,[0],g,{dk:!0}),ut("MROUND",(function(t,e){return t<0&&e>0||e<0&&t>0?P:lt(t/e+.5)*e}),2,2,[gt,gt]),ut("ROUND",Ht,2,2,[pt,bt]),ut("ROUNDDOWN",Vt,2,2,[pt,bt]),ut("ROUNDUP",(function(t,e){return _t(!0,t,e)}),2,2,[pt,bt]),ut("TRUNC",Vt,1,2,[pt,{_i:0,Hi:2}],g,g,{bk:1}),ut("EXP",(function(t){return Y(S(t))}),1,1,pt),ut("LOG",(function(t,e){return 1===e?N:Y(at.Ek(t,e))}),1,2,[{Hi:0,aj:"<= 0"},{_i:10,Hi:0,aj:"<= 0"}],g,g,{bk:1}),ut("LOG10",(function(t){return Y(at.Ek(t,10))}),1,1,{Hi:0,aj:"<= 0"}),ut("SUM",(function(){var t,e,n,o,i,a;if(!r.ExcelCompatibleCalcMode)return Bt.apply(null,arguments);for(t=arguments,e=0,n=0;n<f(t);n++){if(o=t[n],i=void 0,a=void 0,L(o))return o;if(B(o)||G(o)){if((i=q(o,5,!0,!0,!1,!0)).isError)return i[0]}else i=q(o,1,!0,!0,!1,!0);for(a=0;a<f(i);a++)i[a]!==_&&(e+=i[a])}return e}),1,g,g,-1,-1),ut("SUMIF",(function(t,e,n,o){var r,i,a,s,l,u,c,h,p,m,y,v,C,b,w,T,x,S,A,I;if(o=o!==g?o:e,d(n)&&(n=0),r=0,i=at.xk(n),a=G(e),s=G(o),(a?1:e.getRangeCount())!==(s?1:o.getRangeCount()))return E;if(l=o,o===e||s||(u=a?e.getRowCount():e.getRowCount(0),c=a?e.getColumnCount():e.getColumnCount(0),u===o.getRowCount(0)&&c===o.getColumnCount(0)||(h=o.getRow(0),p=o.getColumn(0),l=o.create([{row:h,col:p,rowCount:u,colCount:c}]),m=t.row,y=t.column,v=t.source.getCalcSourceModel().qg(m,y),C=o.getSource(),v&&C.getRangeKey&&(b={id:C.id,row:h,col:p,rowCount:u,colCount:c},w=C.getRangeKey(C,b),v.eOb||(v.eOb={}),v.eOb[w]=b))),T=e.toArray(0,!1,!1),x=l.toArray(1,!1,!1),T.isError)return T[0];if(x.isError)return x[0];for(S=0;S<f(T);S++)for(A=0;A<f(T[S]);A++)I=x[S]&&x[S][A],i&&i(T[S][A])&&I!==_&&I&&(r+=I);return Y(r)}),2,3,g,[0,2],[0,2],{bk:2,dk:!0}),ut("SUMIFS",(function(){return jt(arguments,(function(t){var e,n,o=0;for(e=0;e<t.length;e++){if(n=t[e],L(n))return n;o+=n}return o}))}),3,g,{Hi:4,Ii:1,Ji:!0},[0,"%= 1"],[0,"%= 1"]),ut("SUMPRODUCT",(function(){var t,e,n,o,r,i,a,s=arguments,l=0,u=[],c=0;for(t=0;t<f(s);t++){if((o=q(s[t],1,!0,!0,!1,!0)).isError)return o[0];if(o.isConvertError)return E;if(0===t)e=o.rowCount,n=o.colCount,c=f(o);else if(o.rowCount!==e||o.colCount!==n)return E;u.push(o)}for(t=0;t<c;t++){for(r=1,i=0;i<f(s);i++){if((a=u[i][t])===_){if(1===c)return E;r=0;break}r*=a}l+=r}return Y(l)}),1,g,g,-1,-1,{fk:1}),ut("SUMSQ",(function(){var t,e,n,o,r=arguments,i=0;for(e=0;e<f(r);e++)for(o=r[e],n=0;n<f(o);n++)(t=o[n])!==_&&(i+=t*t);return Y(i)}),1,g,Mt,-1,-1),ut("SUMX2MY2",(function(t,e){return Lt(!1,!0,t,e)}),2,2,Mt,-1,-1),ut("SUMX2PY2",(function(t,e){return Lt(!1,!1,t,e)}),2,2,Mt,-1,-1),ut("SUMXMY2",(function(t,e){return Lt(!0,!1,t,e)}),2,2,Mt,-1,-1),ut("SERIESSUM",(function(t,e,n,o){var r,i,a=0;for(r=0;r<f(o);r++){if(i=z(o[r]),m(i))return E;a+=i*k(t,e+r*n)}return Y(a)}),4,4,[pt,bt,bt,{Hi:4,Ii:1,Ji:!0,Ki:!0,Li:!0}],3,3),ut("PI",(function(){return I}),0,0),ut("SQRTPI",(function(t){return Y(b(t*I))}),1,1,{Hi:0,aj:"< 0"}),ut("DEGREES",(function(t){return 180*t/I}),1,1,Ct),ut("RADIANS",(function(t){return I*t/180}),1,1,pt),ut("COSH",Yt,1,1,pt),ut("SECH",(function(t){if(t>709||t<-709)return 0;var e=Yt(t);return 0===e?N:1/e}),1,1,pt),ut("ACOSH",(function(t){return Y(A(t+b(t*t-1)))}),1,1,{Hi:0,aj:"< 1"}),ut("SINH",qt,1,1,pt),ut("CSCH",(function(t){if(t>709||t<-709)return 0;var e=qt(t);return 0===e?N:1/e}),1,1,pt),ut("ASINH",(function(t){return Y(A(t+b(t*t+1)))}),1,1,pt),ut("TANH",Xt,1,1,pt),ut("COTH",(function(t){return 0===t?N:t>10?1:t<-10?-1:1/Xt(t)}),1,1,{Hi:0}),ut("ATANH",Zt,1,1,{Hi:0,aj:["<= -1",">= 1"]}),ut("ACOTH",(function(t){return Zt(1/t)}),1,1,{Hi:0}),ut("MDETERM",(function(t){var e,n,o,r,i,a,s,l,u=t.rowCount,c=1;if(t.rangeCount>1||u!==t.colCount)return E;for(e=0;e<u-1;e++){if(0===t[e][e]){for(a=!1,n=e+1;!a&&n<u;n++)if(0!==t[n][e]){for(r=e;r<u;r++)s=t[e][r],t[e][r]=t[n][r],t[n][r]=s;c*=-1,a=!0}if(!a)return 0}for(o=e+1;o<u;o++)if(0!==t[o][e])for(l=t[o][e]/t[e][e],i=e;i<u;i++)t[o][i]-=l*t[e][i]}for(e=0;e<u;e++)c*=t[e][e];return c}),1,1,kt,-1,-1),ut("MINVERSE",(function(t){var e,n,o,i,a,s,l,u,c,f,h,p,d,g,m,y,v=t.rowCount,C=[];if(t.rangeCount>1||v!==t.colCount)return E;for(e=0;e<v;e++)for(C[e]=[v],i=0;i<v;i++)C[e][i]=e===i?1:0;for(n=0;n<v;n++){if(0===t[n][n]){for(y=!1,a=n+1;!y&&a<v;a++)if(0!==t[a][n]){for(l=n;l<v;l++)g=t[n][l],t[n][l]=t[a][l],t[a][l]=g;for(u=1;u<v;u++)m=C[n][u],C[n][u]=C[a][u],C[a][u]=m;y=!0}if(!y)return P}for(s=0;s<v;s++)if(s!==n&&0!==t[s][n]){for(p=t[s][n]/t[n][n],c=n;c<v;c++)t[s][c]-=p*t[n][c];for(f=0;f<v;f++)C[s][f]-=p*C[n][f]}}for(o=0;o<v;o++)for(d=t[o][o],h=0;h<v;h++)C[o][h]/=d;return new r.CalcArray(C)}),1,1,kt,-1,-1),ut("MMULT",(function(t,e){var n,o,i,a,s,l,u=t.rowCount,c=t.colCount,f=e.rowCount,h=e.colCount,p=[];if(c!==f)return E;for(i=0;i<u;i++)for(p[i]=n=[],o=t[i],a=0;a<h;a++){for(l=0,s=0;s<f;s++)l+=o[s]*e[s][a];n[a]=l}return new r.CalcArray(p)}),2,2,[kt,kt],-1,-1),ut("FACT",(function(t){return nt(t)}),1,1,{Hi:3,aj:["< 0","> 170"]}),ut("FACTDOUBLE",(function(t){var e,n=1;for(e=t;e>1;e-=2)n*=e;return n}),1,1,{Hi:3,aj:["< 0","> 300"]}),ut("MULTINOMIAL",(function(){var t,e,n,o,r=arguments,i=0,a=1;for(e=0;e<f(r);e++)for(t=r[e],n=0;n<f(t);n++){if((o=V(t[n]))<0||170<o)return P;i+=o,a*=nt(o)}return i<0||170<i?P:nt(i)/a}),1,g,{Hi:4,Ii:0,Ji:!0,Ki:!0,Xi:!0},-1,-1),ut("RAND",(function(){return C(2*R()-1)}),0,0,g,g,g,{ck:!0}),ut("RANDBETWEEN",(function(t,e){return e<t?P:V(t+R()*(e-t+1))}),2,2,[bt,bt],g,g,{ck:!0}),ut("COMBIN",(function(t,e){var n,o=1;if(t<e)return P;for(e=T(t-e,e),n=1;n<=e;n++)o*=t-n+1,o/=n;return Y(o)}),2,2,[yt,yt]),ut("COMBINA",(function(t,e){var n,o=1;for(n=1;n<=e;n++)o*=t+n-1;for(n=2;n<=e;n++)o/=n;return Y(o)}),2,2,[yt,yt]),ut("DECIMAL",(function(t,e){var n,o,r,i,a,s,l;if(!t||t.length>255)return 0;if(0===(n=t.length))return 0;if("-"===t[0])return P;for(o=0;o<n&&" "===t[o];)o++;if(r=0,o===n)return 0;for(i=1,a=n-1;a>=o;a--){if((l=(s=t.charCodeAt(a)|" ".charCodeAt(0))-"a".charCodeAt(0)>=0?s-87:s-48)<0||l>=e)return P;r+=l*i,i*=e}return r}),2,2,[{_i:"0",Hi:5},{Hi:0,aj:["> 36","< 2"]}]),ut("CEILING.MATH",(function(t,e,n){return Ot(t,e,n,!0)}),1,3,[pt,{Hi:0,_i:1},{Hi:0,_i:0}]),ut("FLOOR.MATH",(function(t,e,n){return Ot(t,e,n,!1)}),1,3,[pt,{Hi:0,_i:1},{Hi:0,_i:0}]),ut("BASE",(function(t,e,n){var o=""+t.toString(e);return n&&o.length<n?Array.apply(null,{length:n-o.length+1}).join(0)+o:o}),2,3,[{Hi:0,aj:["< 0",">= 9007199254740992"]},{Hi:3,aj:["> 36","< 2"]},{Hi:3,_i:0,aj:["< 0",">= 256"]}]),ut("ROMAN",(function(t,e){var n,o,r,i,a,s,l,u,c=["M","D","C","L","X","V","I"],f=[1e3,500,100,50,10,5,1],h=[];if((n=Z(e)?e?0:4:e)>4||n<0)return E;for(o=0;o<7;o+=2){if(2<=o&&f[o-2]-f[o]<=t){for(r=o,i=o-2,a=void 0,a=0;a<n&&r+1<7&&f[i]-f[r+1]<=t;a++)r++;h.push(c[r]),h.push(c[i]),t+=f[r],t-=f[i]}if(1<=o&&f[o-1]<=t&&(h.push(c[o-1]),t-=f[o-1]),1<=o&&f[o-1]-f[o]<=t){for(s=o,l=o-1,u=void 0,u=0;u<n&&s+1<7&&f[l]-f[s+1]<=t;u++)s++;h.push(c[s]),h.push(c[l]),t+=f[s],t-=f[l]}for(;f[o]<=t;)h.push(c[o]),t-=f[o]}return h.join("")}),1,2,[{Hi:2,aj:["< 0","> 3999"],bj:E},{_i:0}],g,g,{bk:1}),ut("ARABIC",(function(t){var e,n,o,r,i,a,s,l,u,c;if(!t.length)return 0;if(t.length>255)return E;for(e=0,n=(t=t.toLowerCase()).length-1,r=0,s=-1;n>=0&&" "===t[n];)n--;for(l=0;l<=n&&" "===t[l];)l++;u=!1,l<=n&&"-"===t[l]&&(u=!0,l++);do{for(c=t[o=n],--n;n>=l&&(t[n].charCodeAt(0)|" ".charCodeAt(0))===c.charCodeAt(0);)--n;switch(c){case"i":i=o-n,a=1;break;case"v":i=5*(o-n),a=5;break;case"x":i=10*(o-n),a=10;break;case"l":i=50*(o-n),a=50;break;case"c":i=100*(o-n),a=100;break;case"d":i=500*(o-n),a=500;break;case"m":i=1e3*(o-n),a=1e3;break;default:return E}a>=s?(e+=i-r,s=a,r=0):r+=i}while(n>=l);return 0!==r&&(e-=r),u&&(e=-e),e}),1,1,xt),ut("CEILING.PRECISE",zt,1,2,[gt,mt]),ut("ISO.CEILING",zt,1,2,[gt,mt]),ut("FLOOR.PRECISE",(function(t,e){return lt(t/C(e))*C(e)}),1,2,[gt,mt]),ut("MAXIFS",(function(){return jt(arguments,(function(t){var e=null;return t.length>0&&(e=Math.max.apply(null,t)),e}))}),3,g,Rt,[0,"%= 1"],[0,"%= 1"]),ut("MINIFS",(function(){return jt(arguments,(function(t){var e=null;return t.length>0&&(e=Math.min.apply(null,t)),e}))}),3,g,Rt,[0,"%= 1"],[0,"%= 1"]),ut("MUNIT",(function(t){for(var e=[],n=0,o=[];n<t;n++)o[n]=0;for(n=0;n<t;n++)e[n]=o.slice(0),e[n][n]=1;return new r.CalcArray(e)}),1,1,{Hi:2,aj:"<= 0",bj:E}),ut("SEQUENCE",(function(t,e,n,o){var i,a,s,l,u,c,f;if(void 0===t&&(t=1),void 0===e&&(e=1),void 0===n&&(n=1),void 0===o&&(o=1),i=n,0===t||0===e)return j;if(t<0||e<0)return E;if("string"==typeof n||n instanceof Date){if(a={},!r.Convert.Th(n,a))return E;i=a.value}for(s=[],l=0,u=i;l<t;l++)for(c=[],s.push(c),f=0;f<e;f++)c.push(u),u+=o;return new r.CalcArray(s)}),1,4,[bt,bt,pt,pt],g,g,{bk:[0,1,2,3]},!0),ut("RANDARRAY",(function(t,e,n,o,i){var a,s,l,u,c,f;if(void 0===t&&(t=1),void 0===e&&(e=1),void 0===n&&(n=0),void 0===o&&(o=1),void 0===i&&(i=!1),0===t||0===e)return j;if(t<0||e<0)return E;if(n>o)return E;if(i&&(n!==x(n)||o!==x(o)))return E;for(a=o-n,i&&a++,s=[],l=0;l<t;l++)for(u=[],s.push(u),c=0;c<e;c++)f=n+R()*a,i&&(f=v(f)),u.push(f);return new r.CalcArray(s)}),0,5,[bt,bt,pt,pt],g,g,{ck:!0,bk:[0,1,2,3,4]},!0),ut("AGGREGATE",(function(t,e,n){var o,r=arguments,i=[];for(o=3;o<f(r);o++)i[o-3]=r[o];return rt(i,n,e,t)}),3,g,g,"> 1","> 1",{fk:1,dk:!0}),ut("AND",(function(){return Qt(!0,arguments)}),1,g,Et,-1,-1),ut("OR",(function(){return Qt(!1,arguments)}),1,g,Et,-1,-1),ut("NOT",(function(t){var e;return r.ExcelCompatibleCalcMode&&"string"==typeof t?E:(e={},r.Convert.Uh(t,e)?!e.value:E)}),1,1),ut("IF",(function(t,e,n){var o,r,i=t,a=e,s=X(i);return L(t)?t:(o=n!==g?n:2!==f(arguments)&&null,r={},H(s.value,r),r.value?a:o)}),2,3,g,[1,2],[1,2],{gk:[1,2],bk:2,isBranch:!0,findTestArgument:0,findBranchArgument:function(t){if(r.Convert.vf(t))return-1;var e={value:!1};return H(t,e),e.value?1:2}}),ut("IFERROR",(function(t,e){var n,o,r,i;if(!L(t)&&B(t)){if(t.getRangeCount()>1)return E;if(n=0,o=0,r=this.y0a)if(n=r.row,o=r.col,(i=t.yf&&t.yf[0])&&1===i.rowCount&&1===i.colCount)n=0,o=0;else if(i&&(n+1>i.rowCount||o+1>i.colCount))return e;t=t.getValue(0,n,o)}return function(t,e){return L(t)?d(e)?0:e:d(t)?0:t}(t,e)}),2,2,g,0,g,{gk:-1}),ut("TRUE",(function(){return!0}),0,0),ut("FALSE",(function(){return!1}),0,0),ut("IFNA",(function(t,e){return ht(t)?e:t}),2,2,g,0,g,{gk:-1}),ut("IFS",(function(){var t,e,n;for(t=0,e=arguments.length;t<e;t++){if(n={value:!1},L(arguments[t]))return arguments[t];if(!H(arguments[t++],n))return E;if(n.value)return arguments[t]}return F}),2,254,g,0,g,{gk:-1}),ut("SWITCH",(function(){var t,e,n;if(arguments.length<3)return E;if(L(arguments[0]))return arguments[0];for(t=1,e=arguments.length-1;t<e;t++){if(n=arguments[t++],L(n))return n;if("string"==typeof arguments[0]&&"string"==typeof n){if(arguments[0].toUpperCase()===n.toUpperCase())return arguments[t]}else if(arguments[0]===n)return arguments[t]}return arguments.length%2==0?arguments[arguments.length-1]:F}),3,253,g,g,g,{gk:-1}),ut("XOR",(function(){var t,e,n,o=0;for(t=0;t<f(arguments);t++)for(n=arguments[t],e=0;e<f(n);e++)n[e]&&o++;return!!(o%2)}),1,g,Nt,-1,-1),ut("DATE",(function(t,e,n){t<=1899&&(t+=1900);var o=new Date(t,e-1,n);return o<new Date(1899,11,30)?P:o}),3,3,[{Hi:2,aj:["< 0","> 9999"]},bt,bt]),ut("TIME",(function(t,e,n){var o=u(0);return o.setHours(t),o.setMinutes(e),o.setSeconds(n),o.setMilliseconds(0),o.getHours()<0&&o.getMinutes()<0&&o.getSeconds()<0?P:o}),3,3,[bt,bt,bt]),ut("DATEVALUE",(function(t){var e,n,o,r;if(Q(t)&&((e=c(t))||((e=new Date(t))&&!m(e.valueOf())||(e=null))),!e)return E;if(o=e.getFullYear(),r=Jt(e),o<1900)return E;for(n=1900;n<o;n++)r+=365,J(n)&&r++;return r}),1,1,{Ni:!0}),ut("TIMEVALUE",oe,1,1,{Ni:!0}),ut("NOW",(function(){return new Date}),0,0,g,g,g,{ck:!0}),ut("TODAY",(function(){var t=new Date;return t.setHours(0,0,0,0),t}),0,0,g,g,g,{ck:!0}),ut("HOUR",(function(t){return t.getHours()}),1,1,St),ut("MINUTE",(function(t){return t.getMinutes()}),1,1,St),ut("SECOND",(function(t){return t.getSeconds()}),1,1,St),ut("DAY",(function(t){return t.getDate()}),1,1,St),ut("MONTH",(function(t){return t.getMonth()+1}),1,1,St),ut("YEAR",(function(t){return t.getFullYear()}),1,1,St),ut("WEEKNUM",(function(t,e){var n,o,r;return 1===e||2===e?(n=Jt(t),o=new Date(t.getFullYear(),0,1).getDay(),2===e&&((o-=1)<0&&(o=6)),(r=n-1-(6-o))<0&&(r=0),1+V(r/7)+(r%7!=0?1:0)):P}),1,2,[St,wt],g,g,{bk:1}),ut("WEEKDAY",re,1,2,[St,wt],g,g,{bk:1}),ut("EDATE",(function(t,e){return ne(!1,t,e)}),2,2,[St,bt]),ut("EOMONTH",(function(t,e){return ne(!0,t,e)}),2,2,[St,bt]),ut("WORKDAY",(function(t,e,n){return Kt(!0,t,e,n)}),2,3,[St,bt,It],2,2,{bk:2}),ut("WORKDAY.INTL",(function(t,e,n,o){var r=$t(n);return L(r)?r:"1111111"===r.join("")?E:Kt(!1,t,e,o,r)}),2,4,[St,bt,{_i:"0000011"},It],[2,3],[2,3],{bk:[2,3]}),ut("DAYS360",r.Functions.uk,2,3,[St,St,{_i:!1,Hi:7}],g,g,{bk:2}),ut("NETWORKDAYS",(function(t,e,n){return ee(!1,t,e,g,n,(function(t,e,n){var o=V(l(e)-l(t))%7,r=V(re(t,2)+o),i=0===t.getDay()?1:2;return(n-=o=(o=r>5?r-5:0)>i?i:o)-2*x(n/7)}))}),2,3,[St,St],2,2,{bk:2}),ut("NETWORKDAYS.INTL",(function(t,e,n,o){return ee(!0,t,e,n,o,ie)}),2,4,[St,St],[2,3],[2,3],{bk:[2,3]}),ut("YEARFRAC",r.Functions.vk,2,3,[St,St,{_i:0,Hi:2}],g,g,{bk:2}),ut("DATEDIF",(function(t,e,n){var o,i;if(t.setHours(0,0,0,0),e.setHours(0,0,0,0),n=n.toLocaleUpperCase(),o=function(){var t=[];return t[0]=function(t,e){return e.getFullYear()-t.getFullYear()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?-1:0)},t[1]=function(t,e){return 12*(e.getFullYear()-t.getFullYear())+(e.getMonth()-t.getMonth())+(e.getDate()<t.getDate()?-1:0)},t[2]=function(t,e){return(e.getTime()-t.getTime())/864e5},t[3]=function(t,e){var n=new Date(e.getFullYear(),e.getMonth()+(e.getDate()<t.getDate()?-1:0),t.getDate());return(e.getTime()-n.getTime())/864e5},t[4]=function(t,e){return e.getMonth()-t.getMonth()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?12:0)+(e.getDate()<t.getDate()?-1:0)},t[5]=function(t,e){var n=e.getFullYear()+(e.getMonth()<t.getMonth()||e.getMonth()===t.getMonth()&&e.getDate()<t.getDate()?-1:0),o=t.getMonth(),r=t.getDate(),i=J(t.getFullYear());return 1!==o||29!==r||J(n)||r--,!i&&1===o&&28===r&&J(n)&&r++,(e-new Date(n,o,r))/864e5},t}(),i=p(n,["Y","M","D","MD","YM","YD"]),e<t)return P;if(i<0)throw r.sR().Exp_NotSupported;return(0,o[i])(t,e)}),3,3,[St,St,xt]),ut("DAYS",(function(t,e){var n,o={value:0};if(!ct(t,o))return E;if(!ct(e,n={value:0}))return E;function r(t){return t>=0&&t<2958466}return 2958465,r(o.value)&&r(n.value)?o.value-n.value:P}),2,2),ut("ISOWEEKNUM",(function(t){var e,n,o;if(isNaN(t))return P;function r(t){var e=new Date(t,0,4),n=e.getDay();return 0===n&&(n=7),e.setDate(e.getDate()+1-n),e}return e=new Date(1900,1,28),t.getTime()<=e.getTime()&&t.setDate(t.getDate()-1),1900===(n=t.getFullYear())?n+=400:9999===n&&(n-=400),t.setYear(n),t.getTime()<new Date(n,11,29).getTime()&&n--,o=r(n+1),t.getTime()<o.getTime()&&(o=r(n)),v(""+(t.getTime()-o.getTime())/864e5/7)+1}),1,1,St),ut("CLEAN",(function(t){var e,n,o=[];for(e=0;e<f(t);e++)0<=(n=t.charCodeAt(e))&&n<=31||127===n||128<=n&&n<=159||o.push(t[e]);return o.join("")}),1,1,xt),ut("TRIM",(function(t){var e,n,o,r,i;for(t=t.trim(),e=[],n=!0,o=0;o<f(t);o++)(i=" "===(r=t.charAt(o))||"\t"===r||"\n"===r)&&!n||e.push(r),n=!i;return e.join("")}),1,1,xt),ut("DOLLAR",(function(t,e){return function(t){var e=ae(t),n=[];return t<0&&(e=e.substr(1)),n.push("$"),n.push(e),t<0&&(n.push(")"),n.unshift("(")),n.join("")}(t=z(Ht(t,e)))}),1,2,[pt,{_i:2,Hi:2,aj:"> 99",bj:E}],g,g,{bk:1}),ut("FIXED",(function(t,e,n){var o,r,i,a,s=0;if(e<0&&(t/=s=V(k(10,C(e)))),t=z(Ht(t,w(0,e))),e<0&&(t*=s),o=n?""+t:ae(t),e>0)if(-1===(r=o.indexOf(".")))for(o+=".",i=0;i<e;i++)o+="0";else for(a=o.length-(r+1);a<e;a++)o+="0";return o}),1,3,[pt,{_i:2,Hi:2},{_i:!1,Hi:7}],g,g,{bk:[1,2]}),ut("TEXT",(function(t,e){var n;if(""===e)return W(t);d(t)&&(t=0),"string"==typeof t&&(t=t.trim());try{return(n=o.Formatter&&o.Formatter.GeneralFormatter)?new n(e).format(t):""+t}catch(t){return E}}),2,2,[{},xt]),ut("VALUE",(function(t){if(!t)return 0;var e,n=c(t);return d(n)?function(t){var e,n,i,s,l,u,c,f,h,p,d=o.Common.CultureManager.q4().NumberFormat;if("$"!==t[0]&&t[0]!==d.currencySymbol||(t=t.substring(1)),e=y(t),n=r.isDigit(t[0].charCodeAt(0)),i=45===t[0].charCodeAt(0)&&r.isDigit(t[1].charCodeAt(0)),s=!t||m(e)||!n&&"."!==t[0],l=!t||m(e)||!i&&"-"!==t[0]&&"."!==t[1],s&&l)return E;for(("."===t[0]||"-"===t[0]&&"."===t[1])&&(t="-"===t[0]?t.replace(t[1],"0."):"0"+t),u=t.length,c=0,h=0,p=0;c<u;c++){for(f=t[c];c<u&&r.isDigit(f.charCodeAt(0));)c++,f=t[c];if(c===u){if(h&&c-h<=3)return E;break}if(f===d.numberGroupSeparator){if(p||h&&c-h<=3)return E;h=c}else if(f===d.numberDecimalSeparator){if(p||h&&c-h<=3)return E;p=c}}return t=a.Gb(t,",",""),y(t)}(t):(e=l(n),L(e)?oe(n):e)}),1,1,xt),ut("LOWER",(function(t){return t.toLowerCase()}),1,1,xt),ut("UPPER",(function(t){return t.toUpperCase()}),1,1,xt),ut("PROPER",(function(t){var e,n,o,i=f(t),a=[];if(i>0)for(e=t.toUpperCase(),n=t.toLowerCase(),o=1,a[0]=e[0];o<i;)a[o]=r.ei(t[o-1])?n[o]:e[o],o++;return a.join("")}),1,1,xt),ut("CHAR",(function(t){return String.fromCharCode(t)}),1,1,{Hi:2,aj:["> 255","< 1"],bj:E}),ut("CODE",(function(t){return t[0].charCodeAt(0)}),1,1,{Hi:5,Ni:!0}),ut("REPLACE",ue,4,4,[xt,{Hi:2,aj:"< 1",bj:E},At,xt],g,g,{bk:2}),ut("SUBSTITUTE",(function(t,e,n,o){var r,i,s,l,u,c,h=f(e);if(f(arguments)>3){if(s=0,l=void 0,(i=V(o))<1)return E;for(l=0;l<i;l++){if(-1===(s=t.indexOf(e,s)))return t;s+=h}u=t.substring(0,s-h),c=t.substr(s),r=u.concat(n).concat(c)}else r=a.yb(t,e,n);return r}),3,4,[xt,{Hi:5,Ni:!0},xt],g,g,{bk:3}),ut("CONCATENATE",(function(){return se(arguments,"concatenate")}),1,g,{Hi:4,Ii:0,Ji:!0,Xi:!0},g,-1),ut("LEFT",(function(t,e){return le(!0,t,e)}),1,2,[xt,Tt],g,g,{bk:1}),ut("MID",pe,3,3,[xt,{Hi:2,aj:"<= 0",bj:E},At]),ut("RIGHT",(function(t,e){return le(!1,t,e)}),1,2,[xt,Tt],g,g,{bk:1}),ut("REPT",(function(t,e){var n,o=[];if(e<0||e*f(t)>32767)return E;for(n=0;n<e;n++)o.push(t);return o.join("")}),2,2,[xt,bt]),ut("LEN",(function(t){return t?t.length:0}),1,1,xt),ut("FIND",ge,2,3,[xt,xt,wt],g,g,{bk:2}),ut("SEARCH",me,2,3,[xt,xt,Tt],g,g,{bk:2}),ut("EXACT",(function(t,e){return t===e}),2,2,[xt,xt]),ut("T",(function(t){return Q(t)?t:""}),1,1),ut("UNICHAR",(function(t){if(t){var e=t;return e<=0||e>1114111?E:e>=55296&&e<=57343?F:e<1048576?String.fromCharCode(e):(e-=1048576,String.fromCharCode(55296+(e>>10),56320+(1023&e)))}return E}),1,1,[{Hi:2,bj:E}]),ut("UNICODE",(function(t){var e,n,o=W(t);return""===o||null===o?E:(e=o.charCodeAt(0))>=55296&&e<=56319?1===o.length?E:(void 0,(n=o.charCodeAt(1))>=56320&&n<=57343?e|n<<8:1):e>=56320&&e<=57343?e-53248+53248:e}),1,1),ut("BAHTTEXT",(function(t){var e,n;function o(t){var e,n,o,r,i=["à¸¥à¹à¸²à¸","à¸ªà¸´à¸","à¸£à¹à¸­à¸¢","à¸à¸±à¸","à¸«à¸¡à¸·à¹à¸","à¹à¸ªà¸",""],a=["à¸¨à¸¹à¸à¸¢à¹","à¸«à¸à¸¶à¹à¸","à¸ªà¸­à¸","à¸ªà¸²à¸¡","à¸ªà¸µà¹","à¸«à¹à¸²","à¸«à¸","à¹à¸à¹à¸","à¹à¸à¸","à¹à¸à¹à¸²"],s=["à¸¥à¸","à¸à¸²à¸","à¸à¹à¸§à¸","à¸ªà¸à¸²à¸à¸à¹","à¸¢à¸µà¹","à¹à¸­à¹à¸",","," ","à¸¿"],l="",u=t+"",c=u.length;for(e=c;e>0;--e){if(o=a[n=v(u[c-e])],1===(r=1<e?(e-1)%6:6)&&2===n&&(o=s[4]),1===n)switch(r){case 0:case 6:l+=e<c?s[5]:o;break;case 1:break;default:l+=o}else{if(0===n){0===r&&(l+=i[r]);continue}l+=o}l+=i[r]}return l}return t?(e=Math.abs(v(t)),n=parseFloat((Math.abs(t)-e).toFixed(2)),0!==e?0===n?(t<0?"à¸¥à¸":"")+o(e)+"à¸à¸²à¸à¸à¹à¸§à¸":(t<0?"à¸¥à¸":"")+o(e)+"à¸à¸²à¸"+o(100*n)+"à¸ªà¸à¸²à¸à¸à¹":0!==n?(t<0?"à¸¥à¸":"")+o(100*n)+"à¸ªà¸à¸²à¸à¸à¹":"à¸¨à¸¹à¸à¸¢à¹à¸à¸²à¸à¸à¹à¸§à¸"):E}),1,1,[{Hi:0,bj:E}]),ut("CONCAT",(function(){return se(arguments,"concat")}),1,g,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ut("TEXTJOIN",(function(t,e){var n,o,r,i,a,s,l;if(t.isReference&&0===t.length)return M;if(n={value:!1},o=!!d(e[0])||e[0],!ft(o,n))return E;for(o=n.value,i=[],a=[],s=f(r=arguments),l=2;l<s;l++)ce(i,r[l],o);return ce(a,r[0],!1),fe(i,a)}),3,g,{Hi:4,Ji:!0,Ki:!0,Xi:!0},-1,-1),ut("FINDB",(function(t,e,n){var o,i,a,s,l,u;return de()||r.usedbcs?(o=K(e),i=K(t),a=o.length,n<1||a<n?E:(s=ye(o),l=ye(i),-1===(u=s.indexOf(l,n-1))?E:u+1)):ge(t,e,n)}),2,3,[xt,xt,wt],g,g,{bk:2}),ut("LEFTB",(function(t,e){return he(!0,t,e)}),1,2,[xt,Tt],g,g,{bk:1}),ut("RIGHTB",(function(t,e){return he(!1,t,e)}),1,2,[xt,Tt],g,g,{bk:1}),ut("MIDB",(function(t,e,n){var o,i,a;return de()||r.usedbcs?(i=(o=K(t)).length,--e<0?E:e>=i?"":i<e+n?o.slice(e).join(""):(a=o.slice(e,e+n),"singleByte"!==$(a[a.length-1])&&(a[a.length-1]="â",d(a[0])&&(a[a.length]="â")),a.join(""))):pe(t,e,n)}),3,3,[xt,At,At]),ut("LENB",(function(t){var e,n,i,a;if(!t)return 0;if(de()||r.usedbcs){for(e=0,n=0;n<t.length;n++)if(8203!==t[n].charCodeAt(0)&&(i=$(t[n]),a=o.Common.CultureManager.q4(),"doubleByte"===i&&9390!==t[n].charCodeAt(0))){if("ja-jp"===(a&&a.name().toLocaleLowerCase())&&(711===t[n].charCodeAt(0)||9356===t[n].charCodeAt(0)||8212===t[n].charCodeAt(0)))continue;e++}return t.length+e}return t.length}),1,1,xt),ut("REPLACEB",(function(t,e,n,o){var i,a,s,l,u,c,f;if(de()||r.usedbcs){for(i=[],a=void 0,s=0,l=0;l<t.length;l++)a=t[l],"doubleByte"===$(t[l])&&(s++,a=t[l]),i[l+s]=a;return u=i.length,e=T(e,u+1),n=T(n||0,u-e+1),d(i[e-1])?(i[e-1]=" ",i[e]=" "):d(i[e-2])&&e>=2&&(i[e-2]=" ",i[e-1]=" "),c=i.slice(0,e-1).join(""),f=i.slice(e-1+n).join(""),c.concat(o).concat(f)}return ue(t,e,n,o)}),4,4,[xt,{Hi:2,aj:"< 1",bj:E},At,xt],g,g,{bk:2}),ut("SEARCHB",(function(t,e,n){var o,i,a,s;return de()||r.usedbcs?(o=K(e),i=K(t),a=o.length,n<1||a<n?E:(s=me(ye(i),ye(o),n))===E?E:s):me(t,e,n)}),2,3,[xt,xt,Tt],g,g,{bk:2}),ut("ENCODEURL",(function(t){var e,n,o,r,i,a="";if((e=t.length-1)<0)return"";for(n=0;n<=e;n++)if((o=t.charCodeAt(n))>="A".charCodeAt(0)&&o<="Z".charCodeAt(0)||o>="0".charCodeAt(0)&&o<="9".charCodeAt(0)||o>="a".charCodeAt(0)&&o<="z".charCodeAt(0)||o==="-".charCodeAt(0)||o==="_".charCodeAt(0)||o===".".charCodeAt(0))a+=t[n];else{if(r=void 0,Ce(o)){if(e===n||!be(o,t.charCodeAt(n+1)))return null;r=[o,t.charCodeAt(n+1)],n++}else r=[o];for(i=0;i<r.length;i++)a+="%",a+=r[i].toString(16).toUpperCase()}return a}),0,1,xt),ut("ISERROR",(function(t){return L(t)}),1,1,g,g,g,{gk:-1}),ut("ISERR",(function(t){return!!L(t)&&t._code!==F._code}),1,1,g,g,g,{gk:-1}),ut("ISNA",(function(t){return!!L(t)&&t._code===F._code}),1,1,g,g,g,{gk:-1}),ut("ERROR.TYPE",(function(t){if(!d(t)&&L(t)){var e=p(t._code,[M._code,N._code,E._code,D._code,O._code,P._code,F._code]);if(e>=0)return e+1}return F}),1,1,g,g,g,{gk:-1}),ut("ISNUMBER",(function(t){return U(t,r.ExcelCompatibleCalcMode)}),1,1,g,g,g,{gk:-1}),ut("ISEVEN",(function(t){return lt(C(t))%2==0}),1,1,pt,g,g),ut("ISODD",(function(t){return lt(C(t))%2!=0}),1,1,pt,g,g),ut("N",(function(t){return U(t)?z(t):Z(t)?t?1:0:L(t)?t:0}),1,1,g,g,g),ut("ISBLANK",(function(t){return d(t)}),1,1,g,g,g,{gk:-1}),ut("ISLOGICAL",(function(t){return Z(t)}),1,1,g,g,g,{gk:-1}),ut("ISTEXT",(function(t){return Q(t)}),1,1,g,g,g,{gk:-1}),ut("ISNONTEXT",(function(t){return!Q(t)}),1,1,g,g,g,{gk:-1}),ut("ISREF",(function(t){return B(t)}),1,1,g,-1,g,{gk:-1}),ut("TYPE",(function(t){return Z(t)?4:U(t)?1:Q(t)?2:L(t)?16:G(t)?64:E}),1,1,g,g,-1,{gk:-1}),ut("NA",(function(){return F}),0,0),ut("SHEET",(function(t,e){var n,o,i=0,a=t.source.kj;if(G(e))return F;if(e instanceof r.CalcReference||d(e))return o=(n=e)&&(n.xf||n.references[0].xf)||t.source,a.parent.getSheetIndex(o.kj.name())+1;if(U(e)||Q(e))for(;i<a.parent.sheets.length;i++)if(e.toUpperCase()===a.parent.sheets[i].name().toUpperCase())return i+1;return F}),0,1,g,-1,g,{dk:!0}),ut("SHEETS",(function(t,e){var n,o,i,a=t.source.kj;return d(e)?a.parent.sheets.length:G(e)||U(e)?F:Q(e)?E:e instanceof r.CalcReference?(o=(n=e).references)?o.length:(i=n.xf||t.source,a.parent.getSheetIndex(i.kj.name())+1):F}),0,1,g,-1,g,{dk:!0}),ut("LET",g,3,253,g,g,g,{argsValidator:function(t,e,n){if(n%2==0)throw r.sR().Exp_FormulaInvalid},subExpressionValidator:function(t,e){if(e%2==0&&1===t.type)throw r.sR().Exp_FormulaInvalid}}),ut("OBJECT",(function(){var t,e,n,o,i,a,s,l,u,c,h,p,g,m,y,v,C,b=arguments,w=f(b);if(w<2||w%2!=0)return F;for(e=0;e<w;e+=2){if(i=b[e],a=b[e+1],s=we(i,2),l=we(a,0),L(s))return s;if(L(l))return l;if(s.isError||l.isError)return F;if(u=s.length,c=l.length,d(o))o=c;else if(o!==c)return F;if(u>c)return F;if(u<c){if(!1===n||u>1)return F;for(d(t)&&(t=[]),h=l.rowCount,p=l.colCount,g=s[0],m=0;m<h;m++){for(y=t[m],d(y)&&(y=t[m]=[]),v=0;v<p;v++)d(y[v])&&(y[v]={}),y[v][g]=l[v+m*p];t[m]=y}n=!0}else{if(!0===n)return F;for(d(t)&&(t={}),C=0;C<c;C++)t[s[C]]=l[C];n=!1}}return n?new r.CalcArray(t):t}),2,g,g,-1,-1),ut("PROPERTY",(function(){var t,e=arguments,n=e[0],o=e[1],r=o.split("."),i=r.length,a=n;if(d(n)||"object"!=typeof n)return F;for(t=0;t<i;t++)if(a=a[r[t]],d(a))return F;return a}),2,2,g),function(){var t=new r.Functions.AsyncFunction("REFRESH",1,3);t.evaluate=ve,r.Functions.bi.REFRESH=t}()},CalcEngine:function(t,e){t.exports=n("@grapecity/js-calc")},Common:function(t,e){t.exports=n("Common")}}),t.exports=o.Spread.CalcEngine.BasicFunctions},"./node_modules_local/@grapecity/js-calc-basicfunctions/index.js":function(t,e,n){t.exports=n("./node_modules_local/@grapecity/js-calc-basicfunctions/dist/gc.spread.calcengine.basicfunctions.js")},"./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js":function(t,e,n){var o="object"==typeof o?o:{};o.Spread=o.Spread||{},o.Spread.CalcEngine=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){var o,r;if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)n.d(o,r,(function(e){return t[e]}).bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/",n(n.s="./src/calc.entry.ts")}({"./src/Parser.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function S(){throw r.sR().Exp_FormulaInvalid}function A(t,e,n){throw l.Kb(r.sR()[n||"Exp_FormulaInvalidChar"],[t,e])}function I(t){return t<=255}function R(t){return t<=127}function k(t){return t===r.getBoolean().boolean_true||"TRUE"===t}function M(t){return t===r.getBoolean().boolean_false||"FALSE"===t}function N(t){return t>=48&&t<=57}function E(t,e,n,o,r,i){var a,s,l=t.length,u=n===o?0:1,c=[],f=0;for(a=e+1;a<l;a++)if((s=t[a])===r&&(c.push(s),f++,s=t[++a]),s===n&&u++,s===o)if(u--,n===o&&a+2<l&&t[a+1]===n)c.push(n),a++,f++;else{if(0===u)return{result:c,endIndex:a,skipCount:f};c.push(s)}else c.push(s);i&&A(o,n,"Exp_NoSyntax")}function D(t,e,n){var o,i,a,s,l=t.length,u=l-e;for(o=0;o<r.ErrorList.length;o++)if(e+(a=(i=r.ErrorList[o]).length)<=l&&(s=t.slice(e,e+a),a<=u&&i===s.join("").toUpperCase()))return{result:s,endIndex:e+a-1};n&&A([t[e],e])}function O(t,e){return y.apply(t,e),t}function j(t,e){if(!e||0===e.length||!t.Eh)return!1;var n="'"===e[0]?1:0;return"["===e[n]&&e.indexOf("]")>n}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calc.common.ts"),i=void 0,a=null,s="ARRAY",l=o.Common.u,u=o.Common.j,c=u.Fa,e.di=["+","-","%","+","-","*","/","^","&","=","<>","<","<=",">",">=",":",","," "],f={":":1,"^":2," ":3,"*":4,"/":4,",":5,"+":6,"-":6,"&":7,"<":8,"=":8,">":8,">=":8,"<=":8,"<>":8},h=".",p=",",d=";",g=",",m=[14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,24,24,26,24,24,24,20,21,24,25,24,19,24,24,8,8,8,8,8,8,8,8,8,8,24,24,25,25,25,24,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,20,24,21,27,18,27,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,20,25,21,25,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,11,24,26,26,26,26,28,28,27,28,1,22,25,19,28,27,28,25,10,10,27,1,28,24,27,10,1,23,10,10,10,24,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,25,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,25,1,1,1,1,1,1,1,1],e.isDigit=N,e.ei=function(t){var e=t.charCodeAt(0);return!I(e)||(R(e)?(e|=32)>=96&&e<=122:0===m[e]||1===m[e])},e.fi=function(t){var e=t.charCodeAt(0);return!I(e)||(R(e)?e<=57?e>=48:(e|=32)>=96&&e<=122:0===m[e]||1===m[e])},e.isNumber=function(t){var e=t.charCodeAt(0);return R(e)?e>=48&&e<=57:8===m[e]||10===m[e]},y=[].push,v=function(){function t(t,e,n,o,r){var i,a,l;this.oi=[],r=r||0,(i=this).Qb=t,a=Array.isArray(t)?t.join(""):t,i.Nc=e,i.mi=n,i.li=o||n+t.length-1,0===e&&0===r&&t?(k(l=a.toUpperCase())||M(l))&&(r=5,a=l):1===e&&a!==s&&(a=a.toUpperCase()),i.ni=a,i.hi=r}return t.prototype.type=function(){return this.Nc},t.prototype.subType=function(){return this.hi},t.prototype.stringValue=function(){return this.ni},t}(),e.FormulaToken=v,C=function(){function t(t){void 0===t&&(t=5e3),this.priority=t}return t.prototype.resolveToken=function(t,e,n,o,r){return 0},t.prototype.unparse=function(t,e,n,o){return!0},t}(),e.TokenResolver=C,e.preOperaterTypesMap={"+":0,"-":1},e.operaterTypesMap={":":15,",":16,"+":3,"-":4,"*":5,"/":6,"^":7,"%":2,"&":8,"=":9,"<":11,"<>":10,"<=":12,">":13,">=":14},b=function(){function t(){}return t.prototype.setParserOption=function(e){var n,r;e!==i&&o.Common.CultureManager.q4()?(r="object"==typeof e&&e.NumberFormat?e.NumberFormat:o.Common.CultureManager.q4().NumberFormat,n=e?r:{}):r=n={},p=t.listSeparator=n.listSeparator||",",h=n.numberDecimalSeparator||".",!e&&t.numberDecimalSeparator||(t.numberGroupSeparator=r.numberGroupSeparator||",",t.numberDecimalSeparator=r.numberDecimalSeparator||"."),d=t.arrayGroupSeparator=n.arrayGroupSeparator||";",g=t.arrayListSeparator=n.arrayListSeparator||","},t.prototype.parse=function(t,e){var n,o;return this.setParserOption(t.culture),n=e.split(""),this.gi=n,o=this.parseToTokens(t,n,!t.ignoreError),this.buildExpressionTree(t,o,!t.ignoreError)},t.prototype.unparse=function(t,e,n){return void 0===n&&(n=[]),this.Cma(t,e,n),"@"===n[0]&&e&&e.arguments[0]&&1===e.arguments[0].type&&t&&t.source&&t.source.Af&&!0!==t.source.Af.allowDynamicArray&&n.splice(0,1),n.join("")},t.prototype.Cma=function(t,e,n){var o,r;if(e)for(this.setParserOption(t.culture),o=t.getResolvers(),r=0;r<o.length&&!o[r].unparse(t,this,e,n);r++);},t.prototype.parseToTokens=function(t,n,o){var r,i,a,l,u,c,f,m,C,b,w,T,x,S,I,R;for(void 0===o&&(o=!0),r=this,i=function(t,e,n){return e.length>0&&t.push(new v(e,0,n)),[]},a=n.length,l=[],u=[],c=-1,f=[],b=0,x=!1;b<a&&" "===n[b];)b++;for("="===n[b]&&b++,C=b,S=function(b){var S,R,k,M,j,F,P,_,L,B,G=n[b],H=G.charCodeAt(0),V=void 0;if(64===H&&t.kj&&t.kj.Wu&&!0===t.kj.Wu.allowDynamicArray)m=new v(G,1,b,b,1),l.push(m),u[++c]=m,C=b+1,x=!0;else if(H>=97&&H<=122||H>=65&&H<=90)f.push(G);else if(34===H)(V=E(n,b,'"','"',"",o))?(S=new v(V.result,0,b,b+V.result.length+2,3),V.skipCount&&(S.HTa=n.slice(b,V.endIndex+1).join(""),S.li+=V.skipCount),l.push(S),b=V.endIndex,C=b+1):(O(f,n.slice(b,a)),b=a-1);else if(39===H)(V=E(n,b,"'","'","",o))?(k=[],(R=function(t){var e,n,o=[];if(t.indexOf(":")>-1)for(e=t.split(":"),n=0;n<e.length;n++)o.push("'"+e[n].replace(/'/g,"''")+"'");return o}(V.result.join(""))).length>1&&(M=R.join(":").split(""),k=r.parseToTokens(t,M,o)),k&&k.length>0?(k.forEach((function(t){t.mi+=b,t.li+=b})),O(l,k)):(f.push("'"),O(f,V.result),f.push("'")),b=V.endIndex):(f.push("'"),b=a-1);else if(91===H)if(V=E(n,b,"[","]","'",o))f.push("["),O(f,V.result),f.push("]"),b=V.endIndex;else{if(r.lda&&0===f.length&&("R"===f[0]||"r"===f[0]||"C"===f[0]||"c"===f[0]))return I=b,"continue";O(f,n.slice(b,a)),b=a-1}else{if(13===H||10===H)return I=b,"continue";if(35===H)(j=D(n,b))?(l.push(new v(j.result,0,b,b+j.result.length-1,6)),C=b+1,b=j.endIndex):f.push(G);else if(33===H)f.length,(F=l.length)>0&&0===l[F-1].Nc?(P=l[F-1],y.apply(P.Qb,f),l[F-1]=new v(P.Qb,0,P.mi,b,12)):l.push(new v(f,0,C,b,12)),f=[],C=b+1;else if(43===H||45===H)_=0===l.length?null:l[l.length-1],0!==f.length?(l.push(new v(f,0,C)),l.push(new v(G,5,b)),f=[],C=b+1):(_&&7===_.Nc&&l.pop(),!_||2!==_.hi&&6!==_.Nc&&0!==_.Nc?(l.push(new v(G,4,b)),C=b+1):(l.push(new v(G,5,b)),C=b+1));else if(G===h||N(H))f.length>0?f.push(G):(L=function(t,e,n){var o,r,i=t.length,a=0,s=[];for(o=e;o<i;o++)if(N((r=t[o]).charCodeAt(0)))0===a?a=2:3===a?a=4:1===a?a=2:5!==a&&6!==a||(a=7),s.push(r);else if(r===n){if(2===a)a=4;else{if(0!==a&&1!==a)return{};a=3}s.push(".")}else if("+"===r||"-"===r){if(0===a)a=1;else{if(5!==a)return{num:s,endIndex:o-1};a=6}s.push(r)}else if("E"===r||"e"===r){if(2!==a&&4!==a)return{};a=5,s.push(r)}else if(2===a||4===a||7===a)return{num:s,endIndex:o-1};return 2===a||4===a||7===a?{num:s,endIndex:i-1}:{}}(n,b,h)).num?(w=L.endIndex,B=L.num,w<=a-2&&"!"===n[w+1]?(O(f,B),C=w):(l.push(new v(B,0,b,w,4)),C=w+1),b=w):f.push(G);else if(123===H)f.length>0&&o&&A(G,b),m=new v(s,1,b,b,1),l.push(m),u[++c]=m,C=b+1;else if(G===d&&c>=0&&u[c].value===s)f=i(l,f,C),c<0&&o&&A(G,b),l.push(new v(d,3,b,b)),C=b+1;else if(125===H)f=i(l,f,C),w<0&&o&&A(G,b),T=u[c--],T=new v(G,T.Nc,b,b,2),l.push(T),C=b+1;else if(32===H)f=i(l,f,C),C=b+1;else if(G===p||G===g||G===d)f=i(l,f,C),x&&G===p&&(x=!1,T=new v(")",1,b,b,2),l.push(T)),c<0||1!==u[c].Nc?l.push(new v(p,5,b,b,10)):l.push(new v(G,3,b,b)),C=b+1;else if(37===H)f=i(l,f,C),l.push(new v(n[b],6,b,b)),C=b+1;else if(b+2<=a&&e.operaterTypesMap[G+n[b+1]])f=i(l,f,C),l.push(new v(n.slice(b,b+2),5,b,b+1,5)),b++,C=b+1;else if(e.operaterTypesMap[G])f=i(l,f,C),l.push(new v(G,5,b,b)),C=b+1;else if("("===G)f.length>0?(m=new v(f,1,C,b,1),f=[]):m=new v(G,2,b,b,1),l.push(m),u[++c]=m,C=b+1,x=!1;else if(")"===G){if(f=i(l,f,C),c<0)return o&&A(G,b),I=b,"continue";T=u[c--],T=new v(G,T.Nc,b,b,2),l.push(T),C=b+1}else if(":"===G)f=i(l,f,C),l.push(new v(G,5,b,b,11)),C=b+1;else if("\r"===G||"\n"===G);else{if("\\"===G){if(++b>=a)return o&&A(G,b),I=b,"continue";f.push(G),G=n[b]}f.push(G)}}I=b},R=b;R<a;R++)S(R),R=I;return i(l,f,C),l},t.prototype.buildExpressionTree=function(t,e,n){var o,r=this.ii(t,e,n),i=this.ji(t,r,n);return n&&(i||S(),this.rSa(i)),!((o=t.source)&&o.q$a)&&i&&(i.ehc=!0),i},t.prototype.rSa=function(t){for(var e,n,o,i,a,s;10===t.type;)t=t.value;if(e=this,9===t.type)t.value||S(),e.rSa(t.value),t.value2&&e.rSa(t.value2);else if(7===t.type)for(o=(n=t.arguments).length,(i=t.function)&&i.gEc(i.minArgs,i.maxArgs,o),a=0;a<o;a++)s=n[a],i?i.hEc(s,a):r.iEc(s,a),e.rSa(s)},t.prototype.ji=function(t,e,n){var o,i,a,s,l,u,c=this.ki(t,e,n);for(s=3;s<c.length;)if(l=c[s],9!==(u=c[s-2]).type&&n&&S(),l&&9===l.type){for(;s>=3&&f[l.value]>=f[u.value];)i=c[s-3],a=c[s-1],o=r.Kh(u.operatorType,i,a),c.splice(s-3,3,o),(s-=2)>=3&&(u=c[s-2]);s+=2}else s++;if(1===c.length)return c[0];for(s=c.length-2;s>0;s-=2)i=c[s-1],a=c[s+1],9!==c[s].type&&n&&S(),o=r.Kh(c[s].operatorType,i,a),c.splice(s-1,3,o);return o},t.prototype.ki=function(t,e,n){var o,i,a,s,l,u,c,f,h,d,g,m,y,v;for(o=[],i=(e=Array.isArray(e)?e:[e]).length,a=0;a<i;a++){if(l=s=e[a],9===s.type){if(0===s.operatorType||1===s.operatorType)if(a===i-1)n&&S();else{for(u=a;9===e[u].type&&e[u].operatorType<=1;)u++;for(c=this.ji(t,e[u]),f=u-1;f>=a;f--)c=l=r.Kh(e[f].operatorType,c);l=c,a=u}else if(2===s.operatorType){if(0!==a){l=r.Kh(s.operatorType,this.ji(t,o[o.length-1])),o[o.length-1]=l;continue}n&&S()}}else if(10===s.type)s.value=this.ji(t,s.value),l=s;else if(7===s.type){if(h=0,g=[],m=[],(d=s.arguments).length>0){for(y=0;y<=d.length;y++)v=d[y],y===d.length||0===v.type&&v.value===p?(h===y?g.push(new r.Expression(11)):g.push(this.ji(t,m)),h=y+1,m=[]):m.push(v);s.arguments=g}l=s}o.push(l)}return o},t.prototype.ii=function(t,e,n){var o,r,i=[];for(o=0,r=e.length;o<r;)o=this.resolveToken(t,e,i,o,n);return i},t.prototype.resolveToken=function(t,e,n,o,s){var l,u,c,f,h,p=e[o],d=t.getResolvers();for(l=0;l<d.length;l++)if(u=d[l].resolveToken(t,this,e,o,s)){f=o-1,(c=u.expr)&&u.index!==i?o=u.index-1:c=u,(h=n.length>0?n[n.length-1]:a)&&0!==c.type&&7!==c.type&&c.type<9&&0!==h.type&&7!==h.type&&h.type<9&&(e[f].li<p.mi-1&&n.push(r.Kh(17," "))),n.push(c);break}return o+1},t.prototype.resolveSubTokens=function(t,e,n,o){for(var r=[];n<e.length&&2!==e[n].hi;)n=this.resolveToken(t,e,r,n,o);return{exprs:r,index:n+1}},t}(),e.Parser=b,w=function(){function t(t,e,n,o){this.Eh=!1,this.ignoreError=!1;var r=this;r.useR1C1=e,r.baseIdentity=n,r.option=o,r.source=t}return t.prototype.getExternalSource=function(t,e){var n,o=this.source.getCalcService().getAllSourceModels();for(n=0;n<o.length;n++)if(l.Mb(o[n].getSource().getName(),e))return o[n].getSource();return a},t.prototype.getExternalSourceToken=function(t){return t.getName()},t.prototype.setSource=function(t){this.source=t},t.prototype.getResolvers=function(){var t=(this.source||this.kj).getCalcService();return t&&t.getResolvers()},t.prototype.addResolver=function(t){var e=(this.source||this.kj).getCalcService();e&&e.addResolver(t)},t.prototype.getFunction=function(t){var e,n=t,o=r.getMapping()&&r.getMapping().builtInFunctionsMapping;if(!c(o))for(e in o)o[e].alias===t&&(n=e);return this.source&&this.source.getCustomFunction(n)||r.Functions.findGlobalFunction(t)},t}(),e.ParserContext=w,r.CalcSource.prototype.getParserContext=function(t,e,n){return new w(this,t,e,n)},T=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return x(n,t),n.prototype.resolveToken=function(t,n,o,a,u){var c,f,h,p,g,m,y,v,C,b,w,T=o[a],x=T.ni,A=T.Qb,I=T.Nc,R=null,N=T.hi;if(0===I&&12===N){if(g=void 0,x&&("'"===(g=x).charAt(0)&&(g=g.substring(1,g.length-1))),a++,g&&(R=t.getExternalSource("",g)),!(T=o[a]))return(c=new r.Expression(8)).value=x,c;x=T.ni}if(0===I)0===T.hi?k(h=x.toUpperCase())||M(h)?(T.hi=5,T.ni=h,(c=new r.Expression(4)).value=k(h)):(c=new r.Expression(8)).value=x:4===T.hi?((c=new r.Expression(2)).value=parseFloat(x),c.originalValue=x):3===T.hi?(c=new r.Expression(3)).value=x:5===T.hi?(c=new r.Expression(4)).value=k(x):6===T.hi?(c=new r.Expression(5)).value=r.CalcError.parse(x):7===T.hi&&((c=new r.Expression(8)).value=x);else if(1===I){if(x===s){for(c=new r.Expression(6),a++,h=[[]],f=0,m=0,y=0;a<o.length&&2!==o[a].hi;){if(T=o[a],a<o.length-1&&4===T.Nc&&"-"===T.ni&&4===o[a+1].hi&&((T=o[++a]).Qb.unshift("-"),T.ni="-"+T.ni),3===T.Nc){if(T.ni===d){if(m!==y)throw l.Kb(r.sR().Exp_InvalidArrayColumns,[T.mi]);h.push([]),f++,y=0}}else{if(0!==T.Nc||4!==T.hi&&3!==T.hi&&5!==T.hi&&6!==T.hi)throw r.sR().Exp_InvalidArray;C=v=T.ni,4===T.hi?C=parseFloat(v):5===T.hi?C="TRUE"===v.toUpperCase():6===T.hi&&(C=r.CalcError.parse(v)),h[f].push(C),0===f&&m++,y++}a++}if(m!==y)throw l.Kb(r.sR().Exp_InvalidArrayColumns,[T.mi]);return a++,c.value=new r.CalcArray(h),{expr:c,index:a}}if(A.length>0)return b=t.source&&t.source.Af&&t.source.Af.allowDynamicArray,"@"!==A[0]||b||(T.ni=A.slice(1).join(""),x=T.ni),(c=new r.Expression(7)).functionName=x,w=t.getFunction(c.functionName)||r.Functions.findGlobalFunction(c.functionName),!1===b&&w&&!0===w.isDynamicArrayFunction&&(w=i),c.function=w,(p=n.resolveSubTokens(t,o,a+1))?(c.arguments=p.exprs,{expr:c,index:p.index}):(c.arguments=[],c)}else if(4===I||6===I||5===I)c=r.Kh(4===I?e.preOperaterTypesMap[x]:e.operaterTypesMap[x],x);else if(2===I){if(c=new r.Expression(10),p=n.resolveSubTokens(t,o,a+1))return c.value=p.exprs,{expr:c,index:p.index};u&&S()}else 3===I&&((c=new r.Expression(0)).value=x);return R&&c&&(c.source=R,c={expr:c,index:a+1}),c},n.prototype.unparse=function(t,e,n,o){var i,a,s,l,u,c=this;if(6===n.type||4===n.type||2===n.type||5===n.type||3===n.type)c.qi(t,n,o);else if(9===n.type)c.ri(t,e,n,o);else if(10===n.type)o.push("("),e.Cma(t,n.value,o),o.push(")");else{if(7!==n.type)return(1===n.type||8===n.type)&&(c.unparseRefenceExpressions(t,e,n,o),!0);for(i=n.function&&n.function.name||n.functionName,O(o,((s=(a=r.getMapping()&&r.getMapping().builtInFunctionsMapping)&&a[i])&&s.alias||i).split("")),l="@"===i?["",""]:["(",")"],o.push(l[0]),u=0;u<n.arguments.length;u++)0!==u&&o.push(p),e.Cma(t,n.arguments[u],o);o.push(l[1])}return!0},n.prototype.unparseSource=function(t,e,n,o){if(t.getExternalSourceToken){if(n!==r.BangSource){var i=function(t,e,n){var o,r;if(!e||0===e.length||j(t,e)||j(t,n))return[];if(o=e,n)for(o.push(":"),r=0;r<n.length;r++)o.push(n[r]);return o}(t,t.getExternalSourceToken(n).split(""),o&&t.getExternalSourceToken(o).split(""));if(!(i.length>0))return!1;y.apply(e,i)}return e.push("!"),!0}return!1},n.prototype.unparseRefenceExpressions=function(t,e,n,o){if(n.source===r.BangSource)o.push("!");else if(n.source){if(!this.unparseSource(t,o,n.source,n.endSource))return void o.push("#","R","E","F","!")}8===n.type&&o.push(n.value)},n.prototype.ri=function(t,n,o,r){var i=o.operatorType;2===i?(n.Cma(t,o.value,r),r.push("%")):0===i||1===i?(r.push(e.di[i]),n.Cma(t,o.value,r)):(n.Cma(t,o.value,r),r.push(e.di[i]),n.Cma(t,o.value2,r))},n.prototype.qi=function(t,e,n){var o,s,u,c,f,p,m,y,v=r.sR().Exp_InvalidArray;if(3===e.type)n.push('"'),n.push(l.Gb(e.value,'"','""')),n.push('"');else if(2===e.type)o=e.originalValue||""+e.value,"."!==h&&(o=o.replace(".",h)),n.push(o);else if(4===e.type)n.push(e.value?r.getBoolean().boolean_true:r.getBoolean().boolean_false);else if(6===e.type){if(n.push("{"),(s=e.value).getRowCount()<=0)throw v;for(u=0,c=s.getRowCount();u<c;u++)for(u>=1&&n.push(d),f=0,p=s.getColumnCount();f<p;f++){if(0!==f&&n.push(g),(m=s.getValue(u,f))===i||m===a)throw v;"string"===(y=typeof m)?(n.push('"'),n.push(l.Gb(m,'"','""')),n.push('"')):"boolean"===y?n.push(m?r.getBoolean().boolean_true:r.getBoolean().boolean_false):"number"===y&&"."!==h?n.push((""+m).replace(".",h)):n.push(""+m)}n.push("}")}else 5===e.type?n.push(""+e.value):e.type},n}(C),e.DefaultTokenResolver=T,r.ParserWrapper.XAb=function(){b.numberDecimalSeparator===i&&(new b).setParserOption(!0);return b.numberDecimalSeparator},r.ParserWrapper.YAb=function(){b.numberGroupSeparator===i&&(new b).setParserOption(!0);return b.numberGroupSeparator}},"./src/calc.common.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function ft(t){return t&&t.toUpperCase()}function ht(t){return isNaN(t)||!isFinite(t)}function pt(t,e){var n,o,r,l,u,c,f,h,p,d,g;if(!t)return e.value=0,!0;o=typeof t;try{if(o===i)n=t;else if(o===a){if(/[\f\n\r\t\v]/.test(t))return!1;if(r=t,0===(t=t.trim()).length)return e.value=0,!0;if(l=K.XAb(),u=K.YAb(),"."!==l&&"."!==u&&t.indexOf(".")>=0||","!==l&&","!==u&&t.indexOf(",")>=0)return!1;if(c=!1,f=!1,h=t[0],p=t[t.length-1],"("===t[0]&&")"===p){if(f=!0,"+"===(h=(t=t.substring(1,t.length-1).trim())[0])||"-"===h)return!1;p=t[t.length-1]}if("%"===h?(c=!0,t=t.substring(1)):"%"===p?(c=!0,t=t.substring(0,t.length-1)):"$"===h&&(t=t.substring(1)),t.indexOf(u)>=0&&(A.qb("^\\ *[\\+|\\-]?\\ *\\d+(\\"+u+"\\d{3,})+(\\"+l+"\\d*)?([E|e][\\+|\\-]?\\d+)?\\ *$").test(t)&&(t=t.replace(A.qb("[ \\"+u+"]"),"")))," "===(t=t.trim())[1]&&("+"===t[0]?t=t.replace(/^\+ +/,"+"):"-"===t[0]&&(t=t.replace(/^\- +/,"-"))),"."!==l&&(t=t.replace(l,".")),t.indexOf(l)!==t.lastIndexOf(l))return!1;if(t.length>=2&&"0"===t[0]&&"x"===t[1])return!1;if(n=(+t).valueOf(),c&&(n/=100),f&&(n=-n),ht(n)){if(d=(t=r.trim()).charCodeAt(0),d|=32,t.length>4&&d>=97&&d<=122&&(g=(g=t[0]+t[1]+t[2]).toUpperCase(),!$[g]))return!1;if(h=t[0],p=t[t.length-1],"/"===h||"-"===h||":"===h||"/"===p||"-"===p)return!1;if(A.qb("[\\'\\$\\#\\*\\%\\!\\@\\&\\(\\)\\=\\;\\\"\\<\\>\\?\\,]").test(t))return!1;if(ht((n=new Date(t)).valueOf()))return!1;n=k.Ra(n)}}else if(o===s)n=t?1:0;else{if(!(t instanceof Date))return!1;n=k.Ra(t)}}catch(t){return!1}return e.value=n,!0}function dt(t){var n={value:0};if(pt(t,n))return n.value;throw e.sR().Exp_InvalidCast}function gt(t,e){return e&&(t===O||t===j||typeof t===a&&""===t.trim())}function mt(t,e){try{if(t)if(typeof t===s);else if(t instanceof Date)t=0!==k.Ra(t);else{if(!vt(t))return!1;t=0!==t}else t=!1}catch(t){return!1}return e.value=t,!0}function yt(t,e,n,r,l){var u,c,f;if(Ct(t))return t;if(u={value:O},c=z,0!==e&&gt(t,r))return c;switch(e){case 1:case 5:if(n&&5!==e){if(typeof t===s&&l)return c;t=pt(t,u)?u.value:c}else typeof t===i||(t=t instanceof Date?k.Ra(t):c);break;case 11:t=pt(t,u)?u.value:c;break;case 4:typeof t===a?t=(f=o.Common.l.Qa(t))!==j&&f!==O?k.Ra(f):c:n?t=pt(t,u)?u.value:c:typeof t===i||t instanceof Date||(t=c);break;case 3:n?t=pt(t,u)?u.value:c:typeof t!==s&&(t=c);break;case 2:t=t===O||t===j?"":""+t}return t}function vt(t,e){return typeof t===i||t instanceof Date||!e&&(typeof t===s||!isNaN(t)&&!isNaN(parseFloat(t)))}function Ct(t){return t instanceof W}function bt(t){return t instanceof tt}function wt(t){return t instanceof rt}function Tt(t,e,n){var o=new ot(5);return e&&(o.source=e),n&&(o.endSource=n),o.value=t,o}function xt(t,e){return t.charAt(e)}function St(t,e){for(var n=t.length,o=!1;e<n&&!isNaN(+xt(t,e));)e++,o=!0;for(e<n&&"."===xt(t,e)&&e++;e<n&&!isNaN(+xt(t,e));)e++,o=!0;if(e<n&&("E"===xt(t,e)||"e"===xt(t,e)))for(o=!1,++e<n&&("+"===xt(t,e)||"-"===xt(t,e))&&e++;e<n&&!isNaN(+xt(t,e));)e++,o=!0;return{Vi:o,mi:e}}function At(t){return"string"==typeof t}function It(t,n){if(!t||8===t.type&&t.value.indexOf("'")>=0)throw e.sR().Exp_FormulaInvalid}function Rt(t,e){return{row:t,col:e}}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calcEngine.res.en.ts"),e.ExcelCompatibleCalcMode=!1,e.SR={en:r.resource},e.ErrorCodeList=[0,7,15,23,29,42,36,99,100],i="number",a="string",s="boolean",l="TRUE",u="FALSE",C=[c="#NULL!",f="#DIV/0!",h="#VALUE!",p="#REF!",d="#NAME?",g="#N/A",m="#NUM!",y="#SPILL!",v="#CALC!"],e.ErrorList=C,e.BAND_INDEX_CONST=-2147483648,e.MAX_ROW_COUNT=1048576,e.MAX_COLUMN_COUNT=16384,b=o.Common.j,w=b.Ca,T=b.Fa,x=b.Ea,S=o.Common.k.ac,A=o.Common.q,I=parseInt,R=isNaN,k=o.Common.l,M=k.Ra,N=o.Common.u,E=o.Common.o,D=new o.Common.ResourceManager(e.SR),e.sR=D.getResource.bind(D),e.getMapping=function(){return lt&&lt.resourceMapping},e.getBoolean=function(){var t=e.getMapping()&&e.getMapping().booleanMapping;return{boolean_true:t&&t.boolean_true||l,boolean_false:t&&t.boolean_false||u}},O=null,j=void 0,F=Math.abs,P=Math.exp,_=Math.log,L=Math.pow,B=Math.floor,G=Math.ceil,H={},e.BangSource=H,V={},e.RefErrorSource=V,e.missingArgument=void 0,z={},W=function(){function t(n){var o=t.nf(n);if(!o)throw e.sR().Exp_NotSupported;this._error=o.error,this._code=o.code}return t.prototype.toString=function(){var t=e.getMapping()&&e.getMapping().clacErrorMapping;return t&&t[this._error]||this._error},t.prototype.clone=function(){return new t(this._error)},t.prototype.toJSON=function(){return{_calcError:this._error,_code:this._code}},t.parse=function(e){try{return new t(e)}catch(t){return j}},t.nf=function(t){var n,o;if(t)for(n=0;n<C.length;n++)if((o=C[n])===t||o===ft(t))return{error:o,code:e.ErrorCodeList[n]};return j},t}(),e.CalcError=W,U={Name:new W(d),Null:new W(c),DivideByZero:new W(f),NotAvailable:new W(g),Value:new W(h),Reference:new W(p),Number:new W(m),Spill:new W(y),Calc:new W(v)},e.Errors=U,q=U.Value,Y=U.Reference,X=U.Number,Z=U.DivideByZero,Q=U.NotAvailable,J=U.Null,$={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12},K=function(){},e.ParserWrapper=K,tt=function(){function t(t,e){this.array=t,this.referenceInTwoDimension=e}return t.prototype.getRowCount=function(){return this.array.length},t.prototype.getColumnCount=function(){var t=this.array[0];return t&&t.length||0},t.prototype.getValue=function(t,e){var n,o=this.array,r=t;return"number"!=typeof e&&(r=(n=t).row,e=n.column),r<0||e<0||r>=o.length||e>=o[0].length?q:this.array[r][e]},t.prototype.getValueByIndex=function(t){var e=this.getColumnCount(),n=B(t/e),o=t%e;return this.getValue(n,o)},t.prototype.toArray=function(t,e,n,o,r,i,a){var s,l,u,c,f,h,p,d,g;if(void 0===e&&(e=!0),0,u=0,c=[],p=z,l=(s=this).getRowCount())for(u=s.getColumnCount(),d=0;d<l;d++)for(e||(h=[],c.push(h)),g=0;g<u;g++){if(f=s.getValue(d,g),s.referenceInTwoDimension&&wt(f)&&(f=f.getValueByIndex(0)),n&&Ct(f))return(c=[f]).isError=!0,c;if(f=yt(f,t,!1,i),o&&f===p)return(c=[f]).isConvertError=!0,c;e?c.push(f):h.push(f)}return c.rowCount=l,c.colCount=u,c.rangeCount=1,c},t.prototype.slice=function(e,n,o,r){var i,a,s,l=this,u=l.array,c=[];for(n=n<0?0:n,o=(e=e<0?0:e)+o>l.getRowCount()?l.getRowCount()-e:o,r=n+r>l.getColumnCount()?l.getColumnCount()-n:r,a=0;a<o;a++)for(i=[],c.push(i),s=0;s<r;s++)i.push(u[a+e][s+n]);return new t(c)},t}(),e.CalcArray=tt,et=["o","n","s","b","d"],nt=function(){function t(){}return t.jja=function(t){return Ct(t)&&t._code===e.ErrorCodeList[5]},t.Nh=function(t){return isNaN(t)||!isFinite(t)?X:t},t.Ph=function(e,n,o,r,i,a,s,l){var u,c,f;if(e&&e.length&&e.rowCount&&e.colCount)return e;if(bt(e))(u=e.toArray(n,o,r,i,a)).isArray=!0;else if(wt(e))(u=e.toArray(n,o,r,i,a,s,l)).isReference=!0;else if(w(e)){if(u=[],0===e.length)return u;if(w(e[0]))return t.Oh(e,n,!0);for(c=0;c<e.length;c++)(f=yt(e[c],n,!1))===t.CalcConvertedError&&(u.isConvertError=!0),u.push(f);u.rowCount=1,u.colCount=e.length,u.rangeCount=1}else e=yt(e,n,!0,a),r&&t.vf(e)?(u=[q]).isError=!0:e===t.CalcConvertedError?(u=[t.CalcConvertedError]).isConvertError=!0:o?(u=[]).push(e):(u=[[]])[0].push(e),u.rowCount=1,u.colCount=1,u.rangeCount=1;return u},t.Oh=function(e,n,o){var r,a,l,u,c,f,h,p,d,g,m,y,v;if(!e||!e.length||!e[0].length)return(r=[]).isError=!0,[[q]];if(0===n)return e;if(a=et[n],l=e.length,u=e[0].length,p={value:O},d=!1,g=!1,m=t.CalcConvertedError,!(r=e[a]))for(r=[],e[a]=r,y=0;y<l;y++)for(c=e[y],f=r[y]=[],v=0;v<u;v++)if(Ct(h=c[v]))d||(r.isError=!0,d=!0),f.push(h);else{switch(n){case 1:case 5:o&&5!==n?pt(h,p)?h=p.value:(g||(g=!0,r.isConvertError=!0),h=0):typeof h===i||h instanceof Date||(g||(g=!0,r.isConvertError=!0),h=m);break;case 3:o?mt(h,p)?h=p.value:(g||(g=!0,r.isConvertError=!0),h=!1):typeof h!==s&&(g||(g=!0,r.isConvertError=!0),h=m);break;case 2:h=h===O||h===j?"":""+h}f.push(h)}return r},t.Rh=function(t){var n=dt(t);if(F(n)<1e21)return parseInt(""+n,10);throw e.sR().Exp_InvalidCast},t.Sh=function(t,e){return""!==t&&(!!pt(t,e)&&F(e.value)<1e21&&(e.value=parseInt(""+e.value,10),!0))},t.Vh=function(n){if(!n)return!1;if(typeof n===s)return n;if(n instanceof Date)return 0!==k.Ra(n);if(t.Na(n))return 0!==n;if(t.vf(n))return!1;throw e.sR().Exp_InvalidCast},t.bc=function(t){try{if(t===j||t===O)return"";if(typeof t===s)return t?l:u;if(typeof t===a)return t;if(t instanceof Date)return""+k.Ra(t);if(bt(t))throw e.sR().Exp_InvalidCast;return""+t}catch(t){throw e.sR().Exp_InvalidCast}},t.Wh=function(n){var o={value:O};if(t.Xh(n,o))return o.value;throw e.sR().Exp_InvalidCast},t.Xh=function(t,e){var n,r,s,l;if(t)if(t instanceof Date)e.value=new Date(t.valueOf());else if(typeof t===a){if(!(n=o.Common.l.Qa(t)))if(isNaN(t)){if(n=new Date(t),isNaN(n.valueOf()))return!1;try{if(r=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/,s=N.ib(N.Db(t.replace(/ |\n/g,"")," ")," "),(l=r.exec(s))&&4===l.length&&(-1===l.indexOf(""+n.getFullYear())||-1===l.indexOf(""+n.getMonth())||-1===l.indexOf(""+n.getDate())))return!1}catch(t){return!1}}else if(!(n=o.Common.l.Xb(parseFloat(t))))return!1;e.value=n}else{if(typeof t!==i)return!1;e.value=o.Common.l.Xb(t)}else e.value=o.Common.l.Xb(0);return!0},t.CalcConvertedError=z,t.Ca=bt,t.Na=vt,t.vf=Ct,t.Fh=wt,t.wf=yt,t.j$a=gt,t.Qh=ht,t.Pa=dt,t.Th=pt,t.Uh=mt,t}(),e.Convert=nt,function(t){t[t.unknow=0]="unknow",t[t.reference=1]="reference",t[t.number=2]="number",t[t.string=3]="string",t[t.boolean=4]="boolean",t[t.error=5]="error",t[t.array=6]="array",t[t.function=7]="function",t[t.name=8]="name",t[t.operator=9]="operator",t[t.parentheses=10]="parentheses",t[t.missingArgument=11]="missingArgument",t[t.expand=12]="expand",t[t.structReference=13]="structReference",t[t.spillReference=33]="spillReference",t[t.letLocalName=100]="letLocalName"}(e.ExpressionType||(e.ExpressionType={})),ot=function(){function t(t){this.type=t}return t.prototype.sf=function(){return O},t.prototype.offset=function(t,e,n,o,r){return O},t.prototype.offsetWhenCopy=function(t,e,n,o,r,i,a,s,l,u){return O},t.prototype.getRange=function(t,e){var n,o=[];for(n=2;n<arguments.length;n++)o[n-2]=arguments[n];return O},t}(),e.Expression=ot,rt=function(){function t(t,e){var n=this;n.xf=t,e?(n.yf=e,n.zf=e.length):n.zf=1}return t.prototype.getRangeCount=function(){return this.zf},t.prototype.getSource=function(){return this.xf},t.prototype.create=function(e){return new t(this.xf,e)},t.prototype.toArray=function(t,e,n,o,r,i,a){var s=this.xf,l=s.referenceToArray;return l&&l.call(s,this,t,e,n,o,r,i,a)},t.prototype.getRow=function(t){return this.yf?this.yf[t||0].row:0},t.prototype.getColumn=function(t){return this.yf?this.yf[t||0].col:0},t.prototype.getRowCount=function(t){return this.yf?this.yf[t||0].rowCount:this.xf.getRowCount()},t.prototype.getColumnCount=function(t){return this.yf?this.yf[t||0].colCount:this.xf.getColumnCount()},t.prototype.getValue=function(t,e,n){var o,r,a;if(typeof t===i?(o=arguments[1],r=arguments[2],e=arguments[0]):(o=(t=t).row,r=t.col),e=e||0,o>=0||r>=0){if(!(a=this.yf))return this.xf.getValue(o,r);if(e<a.length)return this.xf.getValue(o+a[e].row,r+a[e].col)}return Y},t.prototype.getValueByIndex=function(t){var e=this.getColumnCount(),n=B(t/e),o=t%e;return this.getValue(0,n,o)},t.prototype.isHiddenRow=function(t,e,n){return this.xf.isHiddenRow(e+this.getRow(t),n)},t.prototype.isSubtotal=function(t,e,n){var o=this.xf;return 0===t&&e<o.getRowCount()&&n<o.getColumnCount()&&function t(e){var n,o;if(e){if(7===e.type&&("SUBTOTAL"===e.functionName||"AGGREGATE"===e.functionName))return!0;for(n=e.arguments&&e.arguments.length,o=0;o<n;o++)if(t(e.arguments[o]))return!0;if(t(e.value)||t(e.value2))return!0}return!1}(o.getCalcSourceModel().ATa(e,n))},t}(),e.CalcReference=rt,it=function(){function t(e){this.id=t.sourceId++,this.Af=e,this.Bf=null}return t.prototype.getCalcService=function(){return this.Af},t.prototype.Cf=function(){return this.Af},t.prototype.setCalcService=function(t){this.Af=t},t.prototype.getCalcSourceModel=function(){return this.Bf},t.prototype.setCalcSourceModel=function(t){this.Bf=t},t.prototype.getValue=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t];return O},t.prototype.getName=function(){return""},t.prototype.getField=function(t){return O},t.prototype.setValue=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.getReference=function(t){return new rt(this,t&&[t])},t.prototype.getSources=function(t){return[this]},t.prototype.referenceToArray=function(t,e,n,o,r,i,a,s){return t.toArray(e,n,o,r,i,a,s)},t.prototype.setFormula=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.setArrayFormula=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.getRowCount=function(){return 1e3},t.prototype.getColumnCount=function(){return 100},t.prototype.isHiddenRow=function(t,e){return!1},t.prototype.startCalculation=function(){},t.prototype.endCalculation=function(){},t.prototype.getCustomFunction=function(t){return O},t.prototype.getCustomName=function(t){return O},t.prototype.refresh=function(){},t.prototype.toJSON=function(t,e){var n,o=[];for(n=2;n<arguments.length;n++)o[n-2]=arguments[n]},t.sourceId=1,t}(),e.CalcSource=it,e.Hh=Tt,e.Ih=Tt(Y),e.Jh=function(t,e){var n=new ot(7);return n.arguments=e,t instanceof ot?(n.function=t.function,n.functionName=t.functionName):(n.function=t.name&&t,n.functionName=t.name||t),n},e.createExpandExpression=function(t,e){var n=new ot(12);return n.value=t,n.needExpendIndexs=e,n},e.Kh=function(t,e,n){var o=new ot(9);return o.operatorType=t,o.value=e,o.value2=n,o},e.Lh=function(t){var e=new ot(10);return e.value=t,e},e.createStringExpression=function(t){var e=new ot(3);return e.value=t,e},e.createNumberExpression=function(t){var e=new ot(2);return e.value=t,e},e.createBooleanExpression=function(t){var e=new ot(4);return e.value=t,e},at=function(){function t(){}return t.Yh=function(t,e){var n=16777216;return!!(t===e||F(t-e)<F(t)/(n*n))||(t=E.Lma(t,15),e=E.Lma(e,15),F(t-e)<F(t)/(n*n))},t.getArrayValue=function(t,e,n){return t?e<t.getRowCount()&&n<t.getColumnCount()?t.getValue(e,n):n>=t.getColumnCount()&&1===t.getColumnCount()&&e<t.getRowCount()?t.getValue(e,0):e>=t.getRowCount()&&1===t.getColumnCount()&&n<t.getColumnCount()?t.getValue(0,n):q:q},t.tryExtractToSingleValue=function(t){var e,n=!0;return(wt(t)||bt(t))&&((e=nt.Ph(t,0,!1,!0)).isError?t=e[0]:1===e.rowCount&&1===e.colCount?t=e[0][0]:(t=e,n=!1)),{value:t,success:n}},t}(),e.Zh=at,e.charAtFunc=xt,st=function(){function t(t){this.Di=t}return t.prototype.$j=function(t){var e,n,o,r,i=this.Di;if(b.Ca(i)||(i=[i]),-1===i[0])return!0;for(e=0;e<i.length;e++)if(o=void 0,r=void 0,At(n=i[e])){if(o=(n=n.split(" "))[0],r=I(n[1]),"!="===o&&t!==r||">"===o&&t>r||">="===o&&t>=r||"%="===o&&t%2===r)return!0}else if(t===n)return!0;return!1},t.prototype._j=function(){return this.Di},t}(),e.iEc=It,function(t){var n,o,r,i,a,s,l,u,c,f,h,p,d,g,m,y;function v(){var e,n,o=t.bi,r=t.ci,i=[];for(e in o)i.push(o[e]);for(n in r)i.push(r[n]);return i}function C(o,r,i){var a,s,l;if(T(o))throw e.sR().Exp_InvalidFunctionName;if(o=o.toUpperCase(),t.bi[o])throw e.sR().Exp_InvalidOverrideFunction;if(a=t.bi[o]){if(!i||!i.override)throw e.sR().Exp_OverrideNotAllowed}else t.bi[o]=a=new n(o,0,255);return r&&"function"==typeof r&&(a.evaluate=r),"function"==typeof i.argsValidator&&(s=a.gEc,a.gEc=function(t,e,n){s(t,e,n),i.argsValidator(t,e,n)}),"function"==typeof i.subExpressionValidator&&(l=a.hEc,a.hEc=function(t,e){l(t,e),i.subExpressionValidator(t,e)}),b.H(i,(function(t,e){var n;x(t,["acceptsReference","acceptsArray","acceptsError","acceptsMissingArgument","precedentReference"])>=0?(n=new st(e),a[t]=function(t){return n.$j(t)}):x(t,["isVolatile","isBranch","findTestArgument","returnReference","isContextSensitive","expandColumns","expandRows"])>=0?(n=new st(e),a[t]=function(){return n._j()}):i.hasOwnProperty(t)&&(a[t]=e)})),a}function w(t){return t%400==0||t%4==0&&t%100!=0||1900===t}function k(t,e){switch(e){case 0:case 2:case 4:return 360;case 1:return d(t.getFullYear())?366:365;case 3:return 365;default:return-1}}function N(t,e){return t-e}function D(t,e){return x(e,[0,2,4,6,7,9,11])>=0?31:x(e,[3,5,8,10])>=0?30:1===e?d(t)?29:28:void 0}function H(t,e,n,o){var r,i,a=n.getFullYear(),s=n.getMonth(),l=n.getDate(),u=o.getFullYear(),c=o.getMonth(),f=o.getDate();return t?(r=2===s&&g(a,s)===l,i=2===c&&g(u,c)===f,e?(r&&(l=30),i&&(f=30)):r&&i&&(l=30,f=30),31===f&&l>=30&&(f=30)):31===f&&(f=1,e&&c++),31===l&&(l=30),360*(u-a)+30*(c-s)+f-l}function V(t,e,n){var o,r=1;return N(t,e)>0&&(o=t,t=e,e=o,r=-1),x(n,[1,2,3])>=0?r*s(M(e)-M(t)):x(n,[4,5])>=0?r*H(!1,5===n,t,e):r*H(!0,6===n,t,e)}function U(t,n,o,r,i){var a,s,l,u,h,p,d,g,m,y,v,C,b,w,x=o<100,A=2===o||102===o,I=A||3===o||103===o,R=5===o||105===o,k=4===o||104===o||R,M=9===o||109===o,N=1===o||101===o||M||r,E=6===o||106===o,D=E?1:0,O=!1,j=0;for(a=0;a<S(t);a++){if(y=t[a],v=void 0,I?v=c(y,0,!1,!1,!1,A):(C=1,(!e.ExcelCompatibleCalcMode||bt(y)||wt(y))&&(C=5),v=c(y,C,!1,!1,!1,!0)),v.isError)return v[0];if(v.isConvertError)return q;for(b=v.rangeCount,w=v.isReference,s=0;s<b;s++)for(l=b>1?v[s]:v,w&&(u=y.getRow(s),h=y.getColumn(s)),p=0;p<S(l);p++)if(2===n||!w||!y.isHiddenRow(s,p,x))for(g=l[p],d=0;d<S(g);d++)if(!(1!==n&&2!==n&&w&&y.isSubtotal(s,p+u,d+h)||(m=g[d],null===m||m===z))){if(m&&m._error&&!I)return i&&(i.sumx=0,i.sumx2=0,i.n=0),m;I&&!T(m)&&(!A||""!==m&&nt.Na(m,!0))?D++:k&&(!O||R&&m<D||!R&&m>D)?D=m:N?r?(i.sumx+=m,i.sumx2+=m*m,i.n++,i.values.push(m),i.values[0]!==m&&(i.allSame=!1)):(D+=m,j++):E&&(D*=m,j++),O=!0}}return N?M?D:r?void 0:0===j?Z:f(D/j):E?f(j>0?D:0):D}function Y(t,e,n){var o,r,i=n%100,a=7===i||8===i,s=7===i||10===i?1:0,l={sumx:0,sumx2:0,n:0,values:[],allSame:!1},u=U(t,e,n,!0,l);if(u&&u._error)return u;if(l.n<=s)return Z;if(l.allSame)u=0;else if(p(l.n*l.sumx2,l.sumx*l.sumx))for(u=0,o=l.sumx/l.n,r=0;r<l.n;r++)u+=L(l.values[r]-o,2);else u=l.sumx2-l.sumx*l.sumx/l.n;return u/=l.n-s,f(a?Math.sqrt(u):u)}function $(t){var e=t.charCodeAt(0);return e>=0&&e<129||63728===e||e>=65377&&e<65440||e>=63729&&e<63732?"singleByte":e>=55296&&e<=57343?"fourByte":"doubleByte"}function K(t){var e,n=[];for(e=0;e<t.length;e++)T(t[e])?(n[e]=t[e+1],e++):n[e]=t[e];return n.length===t.length-1&&(n[n.length]=j),n}function et(t,e){var n,o;for(void 0===e&&(e=!0),n=[],o=0;o<S(t);o++)it(t[o],n,e);return n}function ot(t){t.sort((function(t,e){return t-e}))}function it(t,e,n){var o,r;for(void 0===n&&(n=!0),o=0;o<S(t);o++)(r=t[o])!==z&&e.push(r);n&&ot(e)}function lt(){var t,e,n,o=[];for(t=0;t<arguments.length;t++)o[t]=arguments[t];return e=et(arguments[0]),0===(n=S(e))?X:n%2==0?(l(e[n/2-1])+l(e[n/2]))/2:e[I(""+n/2)]}function ut(t,e,n){var o,r=[];return it(e,r),o=S(r),n<1||o<n?X:(n=t?G(n):B(n),t?r[o-n]:r[n-1])}function ht(t,e){var n,o,r;return t=c(t,1,!0,!0,!1,!0),e=l(e),t.isError?t[0]:t.isConvertError||R(e)?q:(it(t,n=[]),!S(n)||e<0||e>1?X:(r=(o=e*(S(n)-1))%1,o=I(""+o),0===r?n[o]:l(n[o])+r*(l(n[o+1])-l(n[o]))))}function pt(t,e){var n,o,r,i,a,s,l=S(t),c=[];for(n=0;n<l;n++)u(t[n],!0)&&c.push(t[n]);return c.length?(o=c.length,ot(c),i=(r=e*(o+1)-1)%1,r<0||o-1<r?X:(s=c[a=B(r)],0===i?s:s+i*(c[a+1]-s))):X}function dt(t,e){var n=13===e,o=14===e,r=15===e,i=16===e,a=17===e,s=18===e,l=19===e;return 12===e?lt(t):n?function(){var t,e,n,o,r,i,a,s,l=[];for(t=0;t<arguments.length;t++)l[t]=arguments[t];for(e=O,n=0,o=et(arguments[0],!1),r=S(o),i=0;i<r;i++){for(s=0,a=0;a<r;a++)a!==i&&o[a]===o[i]&&s++;s>n&&(n=s,e=o[i])}return 0===n?Q:e}(t):o?function(t,e){return ut(!0,t,e)}(t[0],t[1]):r?function(t,e){return ut(!1,t,e)}(t[0],t[1]):i?ht(t[0],t[1]):a?function(t,e){var n=x(e,[0,1,2,3,4]);return n<0?X:ht(t,.25*n)}(t[0],t[1]):s?pt(t[0],t[1]):l?function(t,e){var n=x(e,[1,2,3]);return n<0?X:pt(t,.25*(n+1))}(t[0],t[1]):J}function gt(t,e,n){var o;return 0===t?o=e<=n:1===t?o=e>=n:2===t?o=e!==n:3===t?o=e<n:4===t?o=e===n:5===t&&(o=e>n),o}function mt(t,e){var n,o=-1,r=!0,i={value:0},s=A.zb(e);return 4===t&&s&&(n=function(t){if(""===t)return!1;var e=A.sb(s);return e.lastIndex=0,e.test(t)}),T(e)?o=0:s||function(t){return 0===(""+t).trim().length}(e)||R(parseFloat(e))||!a(e,i)?r=!1:o=i.value,function(i,l){var c,f;return(""!==e||4===t||2===t)&&!(!l&&i instanceof W)&&(T(i)&&(i=""),c={value:0},r&&a(i,c)?""===i?2===t:gt(t,c.value,o):(!s||!u(i,!0))&&(f=T(e)?"":(""+e).toUpperCase(),s&&n?n(""+i):gt(t,(""+i).toUpperCase(),f)))}}!function(t){t[t.normal=0]="normal",t[t.allwaysExpand=1]="allwaysExpand",t[t.neverExpand=2]="neverExpand"}(t.ArrayArgumentEvaluateMode||(t.ArrayArgumentEvaluateMode={})),n=function(){function t(t,e,n,o){void 0===e&&(e=0),void 0===n&&(n=0),this.name=t,this.minArgs=e,this.maxArgs=n;this.$h=o,this.typeName=""}return t.prototype.description=function(){var t=this,n=e.sR()._h;return t.$h?t.$h:n&&n[t.name]},t.prototype.acceptsArray=function(t){return!1},t.prototype.acceptsReference=function(t){return!1},t.prototype.acceptsError=function(t){return!1},t.prototype.acceptsMissingArgument=function(t){return!1},t.prototype.isVolatile=function(){return!1},t.prototype.isContextSensitive=function(){return!1},t.prototype.isBranch=function(){return!1},t.prototype.findTestArgument=function(){return-1},t.prototype.findBranchArgument=function(t){return-1},t.prototype.expandRows=function(){return!0},t.prototype.expandColumns=function(){return!0},t.prototype.precedentReference=function(){return!0},t.prototype.returnReference=function(){return!1},t.prototype.evaluate=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.evaluateWithContext=function(t,e){var n=this,o=e;return n.isContextSensitive()&&(o=[t].concat(o)),n.evaluate.apply(n,o)},t.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)t[e]!==j&&(this[e]=t[e])},t.prototype.gEc=function(t,n,o){if(o<t||o>n)throw e.sR().Exp_FormulaInvalid},t.prototype.hEc=function(t,e){It(t)},t.ai=function(e,n,o){var r,i=new t(e,0,255);if(n&&"function"==typeof n&&(i.evaluate=n),o)for(r in o)o.hasOwnProperty(r)&&"override"!==r&&(i[r]=o[r]);return i},t}(),t.Function=n,o=function(t){function e(e,n,o,r){return t.call(this,e,n,o,r)||this}return ct(e,t),e.prototype.isContextSensitive=function(){return!0},e.prototype.evaluate=function(t,e){return this.evaluateAsync.apply(this,arguments)},e.prototype.evaluateAsync=function(t,e){this.evaluate.apply(this,arguments)},e.prototype.defaultValue=function(){return 0},e.prototype.evaluateMode=function(){return 0},e.prototype.evaluateWhenArgumentsIsSame=function(){return!0},e.prototype.interval=function(){return 1e4},e}(n),t.AsyncFunction=o,t.AsyncFunctionEvaluateMode={onRecalculation:0,calculateOnce:1,onInterval:2},t.bi={},t.ci={},t.defineGlobalCustomFunction=function(e,n){return t.ci[ft(e)]=n,n},t.findGlobalFunction=function(n){var o,r,i;return n?(n=ft(n),o=t.bi,r=t.ci,i=e.getMapping()&&e.getMapping().builtInFunctionsMapping,o&&(function(e,n){var o,r=t.bi;if(!T(e))for(o in e)if(e[o].alias===n)return r[o];return j}(i,n)||o[n])||r&&r[n]):v()},t.findGlobalFunctions=function(){return v()},t.removeGlobalFunction=function(e){if(!e)return t.bi={},void(t.ci={});e=ft(e);var n=t.bi,o=t.ci;n[e]?delete n[e]:o[e]&&delete o[e]},r=e.sR().Exp_Format,i=function(){function e(t,e,n){this.Ri=t,this.Si=e,this.kja=n||"i"}return e.prototype.Pi=function(){return this.Ri},e.prototype.Qi=function(){return this.Si},e.prototype.lja=function(){return this.kja},e.prototype.bc=function(e){e=e||"i";var n=this.Ri,o=this.Si,r="",i=t.CALC_PRECISION;return i&&(n=E.Lma(n,i),o=E.Lma(o,i)),0===n&&0!==o||(r+=""+n),-1===o?r+="-":0!==n&&o>0&&(r+="+"),-1!==o&&0!==o&&1!==o&&(r+=""+o),0!==o&&(r+=e),r},e}(),t.Ui=i,t.Wi=function(t){try{return t?"number"==typeof t?new i(t,0):"string"==typeof t?function(t){var n,o,a,s,l=0,u=0,c=!1,f=0,h=0,p=0,d=t.length;if(!t)throw e.sR().Exp_ArgumentNull;if(0===d)throw r;if(p<d&&("+"===xt(t,p)||"-"===xt(t,p))&&p++,p=(s=St(t,p)).mi,n=s.Vi,p<d&&("+"===xt(t,p)||"-"===xt(t,p))?(f=p,p=(s=St(t,++p)).mi,o=s.Vi,p<d&&("i"===xt(t,p)||"j"===xt(t,p))&&(a=xt(t,p),p++,c=!0),h=p-f):p<d&&("i"===xt(t,p)||"j"===xt(t,p))?(a=xt(t,p),h=++p,o=n,c=!0,n=!1):f=p,p<d)throw r;if(f>0){if(!n)throw r;l=parseInt(t.substr(0,f),10)}if(h>0){if(!c)throw r;if(1===h||2===h&&"+"===xt(t,f))u=1;else if(2===h&&"-"===xt(t,f))u=-1;else{if(!o)throw r;u=parseInt(t.substr(f,h-1),10)}}return new i(l,u,a)}(t):null:new i(0,0)}catch(t){return null}},a=nt.Th,s=nt.Rh,l=nt.Pa,u=nt.Na,c=nt.Ph,f=nt.Nh,h=nt.vf,p=at.Yh,t.ak=function(t,e,n,o,r,i,a,s,l){return s||(s={}),n!==j&&(s.minArgs=n),o!==j&&(s.maxArgs=o),i!==j&&(s.acceptsReference=i),a!==j&&(s.acceptsArray=a),r!==j&&(s.Ci=r),s.bk!==j&&(s.acceptsMissingArgument=s.bk),s.ck!==j&&(s.isVolatile=s.ck),s.dk!==j&&(s.isContextSensitive=s.dk),s.ek!==j&&(s.precedentReference=s.ek),s.fk!==j&&(s.arrayArgumentEvaluateMode=s.fk),s.gk!==j&&(s.acceptsError=s.gk),l!==j&&(s.isDynamicArrayFunction=l),C(t,e,s)},t.hk=179769e303,t.ik=function(t){return"boolean"==typeof t},t.jk=At,t.Na=function(t){return"number"==typeof t},t.kk=w,d=w,t.lk=k,t.mk=N,t.nk=D,g=D,t.pk=V,t.qk=function(t){var e,n,o;return 0===t?n=0:(o=.5*F(t))>=3?n=1:o<1?n=((((((((.000124818987*(e=o*o)-.001075204047)*e+.005198775019)*e-.019198292004)*e+.059054035642)*e-.151968751364)*e+.319152932694)*e-.5319230073)*e+.797884560593)*o*2:n=(((((((((((((-45255659e-12*(o-=2)+.00015252929)*o-19538132e-12)*o-.000676904986)*o+.001390604284)*o-.00079462082)*o-.002034254874)*o+.006549791214)*o-.010557625006)*o+.011630447319)*o-.009279453341)*o+.005353579108)*o-.002141268741)*o+.000535310849)*o+.999936657524,t>0?.5*(n+1):.5*(1-n)},t.Hfc=U,t.sk=Y,t.mja=function(t,e,n,o){var r,i,a,u,f,p,d,g,m,y,v,C,b;if(null===n)return q;if((n=parseInt(n,10))<=0||n>19)return q;function w(t){var e,o,s,l,p,d,g,m,y,v,C,b=[];if((e=c(t,f?0:5,!1,!1,!1,!1)).isConvertError)return q;for(v=e.rangeCount,C=e.isReference,o=0;o<v;o++)for(s=v>1?e[o]:e,C&&(l=t.getRow(o),p=t.getColumn(o)),d=0;d<S(s);d++)if(!(C&&t.isHiddenRow(o,d,!1)&&r))for(m=s[d],g=0;g<S(m);g++)if(!(C&&i&&t.isSubtotal(o,d+l,g+p)||(y=m[g],null===y||a&&h(y)||h(y)&&u))){if(!a&&h(y)&&3!==n)return y;"object"==typeof y&&0===Object.keys(y).length||b.push(y)}return b}if(e||(e=0),r=1===e||3===e||5===e||7===e,i=1===e||2===e||3===e||0===e,a=2===e||3===e||6===e||7===e,f=(u=2===n)||3===n,p=12===n,d=13===n,g=14===n||15===n||16===n||17===n||18===n||19===n,m=[],y=S(t),g){if(2!==y)return q;if((m=w(t[0]))._error)return m;if(v=void 0,t[1]===O)return X;if(t[1]instanceof rt)v=function(t){var e,n=t.getRow(0),r=t.getColumn(0),i=t.getRowCount(0),a=t.getColumnCount(0);if(1===i&&1===a)e=t.getValue(0,0,0);else if(1!==i&&1===a&&n<=o.row&&o.row<n+i)e=t.getValue(0,o.row-n,0);else{if(!(1===i&&1!==a&&r<=o.column&&o.column<r+a))return q;e=t.getValue(0,0,o.column-r)}return e===O||""===e?X:isNaN(parseInt(e,10))?q:parseFloat(e)}(t[1]);else if(t[1]instanceof tt)v=t[1].array[0][0];else{if(isNaN(parseInt(t[1],10)))return q;v=l(t[1])}return v._error?v:(17!==n&&19!==n||(v=s(v)),dt([m,v],n))}for(C=0;C<y;C++)if(!(t[C]instanceof rt))return q;for(C=0;C<y;C++){if(!((b=w(t[C]))instanceof Array))return b;m.push.apply(m,b)}return p||d?dt([m],n):7===n||8===n||10===n||11===n?Y(m,i?1:0,n):U(m,1,n)},t.UAb=$,t.WAb=K,t.VAb=function(t){var e,n,o,r=[],i=0,a=0;for(n=0;n<t.length;n++){if(e=t[n],"doubleByte"===(o=$(t[n]))||"fourByte"===o)if("fourByte"===o){if(i%2==0){i++;continue}a++,i++,e=t[n-1]+t[n]}else a++,e=t[n];r[n-(i>0?i/2:0)+a]=e}return K(r)},t.sja=dt,t.tk=function(t){var e,n=1;for(e=t;e>1;e--)n*=e;return n},t.uk=function(t,e,n){var o=t.getDate(),r=e.getDate(),i=t.getMonth(),a=e.getMonth(),s=t.getFullYear(),l=e.getFullYear();return o=31===o?30:o,n?r=31===r?30:r:31===r&&(o<30?(r=1,++a>12&&(a=1,l++)):r=30),30*(12*(l-s)+a-i)+r-o},t.vk=function(t,e,n){return n<0||n>4?X:function(t,e,n){var o,r,i,a,u,c,f,h,p=V(t,e,n);return p<0&&(p=-p,r=t,t=e,e=r),1===n?(i=t.getFullYear(),a=e.getFullYear(),u=void 0,c=void 0,f=void 0,h=void 0,(u=new Date(t.valueOf())).setFullYear(u.getFullYear()+1),N(e,u)>0?(h=a+1-i,u=new Date(i,0,1),c=new Date(a+1,0,1),f=s(M(c)-M(u))-365*(a+1-i)):(h=1,f=d(i)&&t.getMonth()<3||d(a)&&256*e.getMonth()+e.getDate()>=541?1:0),o=365+l(f)/l(h)):o=k(new Date,n),p/o}(t,e,n)},m={},y=function(){function e(){}return e.wk=function(t){var e=B(t);return p(t,e+1)?e+1:e},e.xk=function(t){var e,n,o,r,i,a=t,s=m;if(s||(m=s={}),e=s[a])return e;if(u(t))return s[a]=mt(4,t);for("=><",n=T(t)?"":(""+t).toUpperCase(),o="\0",r=0;r<2&&r<S(n);r++){if(i=n[r],-1==="=><".indexOf(i)){if("<"===o)return s[a]=e=mt(3,n.substring(1)),e;if(">"===o)return s[a]=e=mt(5,n.substring(1)),e;break}if("="===i)return e="<"===o?mt(0,n.substring(2)):">"===o?mt(1,n.substring(2)):mt(4,"\0"===o?n.substring(1):t),s[a]=e,e;if("\0"===o)o=i;else{if("<"===o)return e=">"===i?mt(2,n.substring(2)):mt(3,n.substring(1)),s[a]=e,e;if(">"===o)return s[a]=e=mt(5,n.substring(1)),e}}return s[a]=e=mt(4,t),e},e.yk=function(t){var e=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13,1e14,1e15,1e16][t];return T(e)?L(10,parseFloat(t)):e},e.zk=function(t){var e=G(t);return p(t,e-1)?e-1:e},e.Ak=function(t,n){var o,r,i=e.yk(F(n)),a=G,s=B;return o=(t=n<0?t/i:t*i).toExponential(),(r=I(o.split("e")[1])+1)<=15&&r>=-85&&(t=parseFloat(t.toFixed(15-r))),t=t<0?a(t-.5):s(t+.5),f(t=n<0?t*i:t/i)},e.Bk=function(t,e){var n,o;if(t<0||e<0||t<e)return X;for(n=1,e=Math.min(t-e,e),o=1;o<=e;o++)n*=t-o+1,n/=o;return f(n)},e.YDc=function(t,e){if(t<0&&F(e)<1){var n=(1/e).toPrecision(15);if(parseFloat(n)===parseInt(n,10)&&parseInt(n,10)%2!=0)return-L(-t,e)}return L(t,e)},e.Ck=function(e,n){var o=F(e)>.5?L(1+e,n):P(n*_(1+e));return isFinite(o)?R(o)&&(o=5e-324):o===Number.POSITIVE_INFINITY?o=t.hk:o===Number.NEGATIVE_INFINITY&&(o=-t.hk),o},e.Dk=function(t,e){return(P(t)+(e?-1:1)*P(-t))/2},e.Ek=function(t,e){return R(t)?t:R(e)?e:1!==e&&1===t||0!==e&&e!==Number.POSITIVE_INFINITY?_(t)/_(e):NaN},e}(),t.MathHelper=y}(lt||(lt={})),e.Functions=lt,e.gOb=function(t,e,n){var r,i,l,u,c,f,h,p,d,g;if(void 0===n&&(n=!0),Ct(t))return t;if(Ct(e))return e;if(l=typeof e===s,(i=typeof t===s)||l)r=i&&l?t===e?0:t>e?1:-1:i?1:-1;else{if(c=typeof e===a,h=(f=(u=typeof t===a)||c)?"":0,t=t===O||t===j?h:t,e=e===O||e===j?h:e,p=function(){var r,i;if(t===e)return 0;if(u&&c){r=void 0;try{r=(i=o.Common.CultureManager.getCultureInfo()).localeCompare?n?i.localeCompare(t,e):i.localeCompare(t.toUpperCase(),e.toUpperCase()):n?t.localeCompare(e):t.toUpperCase().localeCompare(e.toUpperCase())}catch(o){r=n?t.localeCompare(e):t.toUpperCase().localeCompare(e.toUpperCase())}return r}return u?1:c?-1:at.Yh(t,e)?0:t-e},!f){if(g={value:0},!pt(t,d={value:0})||!pt(e,g))return q;t=d.value,e=g.value}r=p()}return r},ut=function(t){function e(e){var n=t.call(this,O)||this;return n.u4=e,n}return ct(e,t),e.prototype.startCalculation=function(){},e.prototype.endCalculation=function(){},e.prototype.getValue=function(){return U.Reference},e.prototype.getReference=function(){var t=new rt(this,[Rt(0,0)]);return t.getValue=function(){return U.Reference},t},e.prototype.referenceToArray=function(){var t=[U.Reference];return t.isError=!0,t},e.prototype.getName=function(){return this.u4},e.prototype.setValue=function(){},e}(it),e.ErrorSource=ut},"./src/calc.entry.ts":function(t,e,n){"use strict";var o,r;function i(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),i(n("./src/calc.common.ts")),i(n("./src/Parser.ts")),i(n("./src/evaluator.ts")),i(n("./src/calc.ts")),i(n("./src/referenceExpression.ts")),o=n("./src/calc.ts"),Object.defineProperty(e,"supportRowColumnFormula",{set:function(t){o.supportRowColumnFormula=t},get:function(){return o.supportRowColumnFormula}}),Object.defineProperty(e,"approximatelyEqual",{set:function(t){o.approximatelyEqual=t},get:function(){return o.approximatelyEqual}}),r=n("./src/calc.common.ts"),Object.defineProperty(e,"ExcelCompatibleCalcMode",{set:function(t){r.ExcelCompatibleCalcMode=t},get:function(){return r.ExcelCompatibleCalcMode}})},"./src/calc.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function G(t,e){var n,o,r,i,a,s;if(t)for(n in t)if(o=+n,r=t[n])for(i in r)a=+i,(s=r[i])&&e.setValue(o,a,s.value,s.oldValue,!0!==s.isAnchorCell)}function H(t,e){var n=e.split(",").map((function(t){return+t})),o=n[0],r=n[1],i=t[o];return i&&i[r]}function V(t,e,n){if(t){var o=n.anchors,r={};t.forEach((function(t){var i,a,s,l,u,c,f,h,p=t.row,d=t.col,g=function(t,e){return[t,e].join(",")}(p,d);for(e.Ag(p,d,1,1),r[g]=!0,i=t.rowCount,a=t.colCount,s=1,l=0;l<i;l++){for(;s<a;s++)if(u=n.getAnchorItem(l+p,s+d))for(f in c=u.anchorRefs)g!==f&&c[f]&&((h=H(o,f))&&!r[f]&&(e.Ag(h.row,h.col,1,1),r[f]=!0));s=0}}))}}function z(t,e,n,o,r){var i,a,s,l,u;for(i in e)e.hasOwnProperty(i)&&(s=((a=e[i]).source||t).getCalcSourceModel(),u=(l=t.getCalcSourceModel())&&l.qg(n,o),s&&u&&a&&s.Ig(u,n,o,a,a,r))}function W(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g;for(r in n)if(n.hasOwnProperty(r))if(i=n[r],a=t.jh[i.id],s=i.row,l=i.col,f=s+(u=i.rowCount)-1,h=l+(c=i.colCount)-1,J(s,l,u,c))a.ug(!0).Jg(s,l,u,c,e,o);else for(p=s;p<=f;p++)for(d=l;d<=h;d++)(g=a.qg(p,d,!0))&&g.gmb(0,e,o)}function U(t,e){var n,o,r;for(n in t)(o=t[n])&&(e?U(o):(r=o.calc)&&r.ng())}function q(t){var e,n;for(e=0;e<t.length;e++)if((n=t[e].expr)&&7===n.type&&"LET"===n.functionName)return!0;return!1}function Y(t,e,n,o,l,u,c){var f,d,C,b,w,T,x,S,A,I,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,Y,Q,J,$,K,tt,et,nt,ot,rt,it,at,st,lt,ut,ct,ft,ht,pt,dt,gt,mt,yt=t.row,vt=t.column,Ct=[],bt=0,wt=t.arrayIdentity?t.arrayIdentity.row:yt,Tt=t.arrayIdentity?t.arrayIdentity.col:vt;for(Ct[bt]={expr:e,acceptsArray:u||!1,acceptsRef:c||!1,index:-1},f=0,d=0,C=!1,w=o,T=l,x=!1;bt>=0;){if(S=Ct[bt],bt--,A=S.acceptsArray,I=S.acceptsRef,e=S.expr,k=h,e)if(7===e.type){if(B=(L=(_=e).arguments).length,!_.function){if(!t){k=r.Hh(g);continue}if("ANCHORARRAY"===(G=_.functionName)){1===B&&(V=(H=L[0]).source,z=t.source,1===H.type&&H.sf()?k=i.BLb(z,V,p,H.row,H.column,H.rowRelative,H.columnRelative):5===H.type&&(k=i.lOb(z,V))),k?t.iOb=2:k=r.Hh(g),_.ensureSingle&&(k.ensureSingle=!0),M=k;continue}_.function=t.getFunction(G)}if(W=_.function,U=S.index,P=S.neeedExpendindexs,U<0?(S.arrayArgumentEvaluateMode=x,S.arrayFormulaCatchValue=n,W&&W.arrayArgumentEvaluateMode&&(x=W.arrayArgumentEvaluateMode),S.args=[]):(W&&W.acceptsArray&&W.acceptsArray(U)?f--:C&&(P||(P=[],S.neeedExpendindexs=P),_.arguments[U],P.push(U)),S.args.push(M)),U===B-1){if(x=S.arrayArgumentEvaluateMode,n=S.arrayFormulaCatchValue,Q=!1,(Y=S.args)&&Y.length>0)for(J=0;J<Y.length;J++)if(Y[J]!==_.arguments[J]){Q=!0;break}k=Q?r.Jh(_,Y):e,P&&P.length>0&&(k=r.createExpandExpression(k,P),C=!0)}else 0===U&&W&&3===W.arrayArgumentEvaluateMode&&3===x&&(x=0),C=!1,U++,S.index=U,W&&W.acceptsArray&&W.acceptsArray(U)&&f++,Ct[++bt]=S,Ct[++bt]={expr:_.arguments[U],acceptsArray:!!W&&W.acceptsArray&&W.acceptsArray(U),acceptsRef:!!W&&W.acceptsReference&&W.acceptsReference(U),index:-1}}else if(1===e.type&&e.sf())d&&(D=(E=e.source!==r.BangSource&&e.source||t.source).getRowCount(),O=E.getColumnCount(),j=(j=e.rowRelative?(e.row+wt)%r.MAX_ROW_COUNT%D:e.row)<0?j+D:j,F=(F=e.columnRelative?(e.column+Tt)%r.MAX_COLUMN_COUNT%O:e.column)<0?F+O:F,e=i.rf(e.source&&E,h,j,F,!1,!1));else if(1===e.type||13===e.type){if(13===e.type){if(N=($=e).getRange(yt,vt),$.tzb(yt,vt,t.source.id),!N){$._error?(delete $._error,k=M=m,t.iOb=1):(k=e,M=e);continue}e=i.uf($.source===t.source?h:$.source,h,N.row,N.col,N.row+N.rowCount-1,N.col+N.colCount-1)}K=e.source!==r.BangSource&&e.source,et=(tt=e).ensureSingle,d&&(E=K||t.source,D=r.MAX_ROW_COUNT,O=r.MAX_COLUMN_COUNT,nt=tt.rowRelative?(tt.row+wt)%D:tt.row,ot=tt.columnRelative?(tt.column+Tt)%O:tt.column,at=void 0,(nt=nt<0?nt+D:nt)>(rt=(rt=tt.endRowRelative?(tt.endRow+wt)%D:tt.endRow)<0?rt+D:rt)&&(at=nt,nt=rt,rt=at),(ot=ot<0?ot+O:ot)>(it=(it=tt.endColumnRelative?(tt.endColumn+Tt)%O:tt.endColumn)<0?it+O:it)&&(at=ot,ot=it,it=at),nt>=(D=E.getRowCount())?(nt%=D,rt%=D):rt>=D&&(rt=D-1),ot>=(O=E.getColumnCount())?(ot%=O,it%=O):it>=O&&(it=O-1),e.row===r.BAND_INDEX_CONST&&(nt=rt=r.BAND_INDEX_CONST),e.column===r.BAND_INDEX_CONST&&(ot=it=r.BAND_INDEX_CONST),e=i.uf(K,e.endSource,nt,ot,rt,it,!1,!1,!1,!1),et&&(e.ensureSingle=!0)),c||I&&(A||!n&&1!==x&&3!==x)||yt<0||vt<0||(f>0&&!n&&1!==x&&3!==x||0===f||2===x?(N=tt.getRange(yt,vt),n||(I||A)&&1===x?!tt.isFullColumn&&1!==N.rowCount&&w>=N.rowCount||!tt.isFullRow&&1!==N.colCount&&T>=N.colCount?k=r.Hh(v):(j=(tt.isFullColumn?0:N.row)+(1===N.rowCount?0:w),F=(tt.isFullRow?0:N.col)+(1===N.colCount?0:T),k=i.rf(K,e.endSource,j,F,!1,!1)):N.rowCount>1&&N.colCount>1||N.rowCount>1&&!tt.isFullColumn&&(yt<N.row||yt>=N.row+N.rowCount)||N.colCount>1&&!tt.isFullRow&&(vt<N.col||vt>=N.col+N.colCount)?k=r.Hh(y):(j=tt.isFullColumn||N.rowCount>1?yt:N.row,F=tt.isFullRow||N.colCount>1?vt:N.col,k=i.rf(K,e.endSource,j,F,!1,!1))):C=!0)}else if(9===e.type)st=e.operatorType>=15,lt=I&&t.source&&t.source.Af&&t.source.Af.allowDynamicArray,-1===S.index?(S.index=e.value2?0:1,Ct[++bt]=S,Ct[++bt]=X(e.value,st||A,st||lt,-1)):0===S.index?(M!==e.value&&(k=r.Kh(e.operatorType,M,e.value2),S.expr=k),C&&((P=[]).push(0),S.neeedExpendindexs=P,C=!1),S.index=1,Ct[++bt]=S,Ct[++bt]=X(e.value2,st||A,st||lt,-1)):(k=e.value2&&M!==e.value2?r.Kh(e.operatorType,e.value,M):e,P=S.neeedExpendindexs,C&&(P?P.push(1):P=[e.value2&&e.value2===b?1:0]),P&&(k=r.createExpandExpression(k,P),C=!0));else if(10===e.type)-1===S.index?(S.index=0,Ct[++bt]=S,Ct[++bt]=X(e.value,A,I,-1)):e.value!==M&&(k=r.Lh(M));else if(8===e.type)1===S.index?(d--,k=M,S.context&&(t=S.context)):(d++,Ct[++bt]=X(e,A,I,1,t),ut=void 0,ct=t,ft=void 0,q(Ct)?(ut=new r.Expression(100)).value=e.value:(e.source?(ft=e.source===r.BangSource?t.source:e.source,(ct=new s.EvaluateContext(ft)).cloneFrom(t),ut=ft.getCustomName(e.value)):(ut=t.getName(e.value),t.source.getCustomName(e.value)||(ct=new s.GloableEvaluateContext(t.source)).cloneFrom(t)),ut||(ut=r.Hh(g))),t=ct||t,Ct[++bt]=X(ut,A,I,-1,t));else if(6===e.type)if(ht=e,pt=e.value,!A&&(f>0||n||1===x||3===x))C=!0,b=e;else if(!A&&0===f)if(dt=pt.getRowCount(),gt=pt.getColumnCount(),w>=dt&&dt>1||T>=gt&&gt>1)k=r.Hh(v);else if(n||!(t.source&&t.source.Af&&t.source.Af.allowDynamicArray))try{1===dt&&(w=0),1===gt&&(T=0),"string"==typeof(mt=ht.value.getValue(w,T))?k=r.createStringExpression(mt):typeof mt===R?k=r.createNumberExpression(mt):"boolean"==typeof mt?k=r.createBooleanExpression(mt):mt._error?k=r.Hh(mt):k=(new a.Parser).parse(t.source.getParserContext(t.useR1C1,Z(0,0)),""+mt)}catch(t){k=r.Hh(v)}k===h&&(k=e),M=k}return k}function X(t,e,n,o,r){return{expr:t,acceptsArray:e,acceptsRef:n,index:o,context:r}}function Z(t,e){return{row:t,col:e}}function Q(t,e,n,o){return{row:t,col:e,rowCount:n,colCount:o}}function J(t,e,n,o){return-1===t&&o>127||-1===e&&n>127||n*o>127}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calc.common.ts"),i=n("./src/referenceExpression.ts"),a=n("./src/Parser.ts"),s=n("./src/evaluator.ts"),l=o.Common.A,u=o.Common.B,c=o.Common.u,f=o.Common.l,h=null,p=void 0,d=Math.abs,g=r.Errors.Name,m=r.Errors.Reference,y=r.Errors.Value,v=r.Errors.NotAvailable,C=r.Errors.Calc,b=r.Convert.Ca,w=r.Convert.Fh,T=c.Nb,x=o.Common.j,S=x.Fa,A=Math.min,I="rowSliceListeners",R="number",e.approximatelyEqual=function(t,e,n){return void 0===t&&(t=0),void 0===e&&(e=0),t===e||t instanceof r.CalcError&&e instanceof r.CalcError&&t._code===e._code||d(e-t)<n},e.supportRowColumnFormula=!1,k=function(){function t(t){this.Ze=[],this.ah=t}return t.prototype.getKey=function(){return""},t.prototype.hasListeners=function(){var t,e,n,o;for(t=0,e=this.Ze;t<e.length;t++)if(n=this[e[t]])for(o in n)if(n[o])return!0;return!1},t.prototype.gmb=function(t,e,n){var o,r=this[t],i=e.getKey();e.LDc&&e.LDc.length>=1&&((o=e.LDc)[o.length-1].push(this),i="?"+i),r||(this.Ze.push(t),r=this[t]={}),n?r[i]=e:delete r[i]},t.prototype.Yg=function(){var t,e,n,o,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=this.Ze,o=0;o<e.length;o++)if(r=this[e[o]])for(i in r)(n=r[i])&&n.bh()},t.prototype.Bg=function(){var t,e,n,o,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=this.Ze,o=0;o<e.length;o++)if(r=this[e[o]])for(i in r)!(n=r[i])||n.dh||n.eh||n.fh()},t.prototype.gh=function(){var t,e,n,o,r,i,a,s,l=[];for(t=0;t<arguments.length;t++)l[t]=arguments[t];for(e=l[0],n=this.Ze,o=e?1:-1,r=0;r<n.length;r++)if(i=this[n[r]])for(a in i)if(s=i[a],"?"===a[0]){if(e||!this.MDc)continue;for(;this.MDc.indexOf(s)>=0;)this.MDc.splice(this.MDc.indexOf(s),1),s.delay--}else s&&(s.delay+=o,e&&s.y$a&&s.y$a())},t.prototype.bh=function(){},t.prototype.fh=function(){},t.prototype.ng=function(){},t.prototype.og=function(){},t.prototype.ZAb=function(){return this.ah.Cf()},t}(),e.BaseCalc=k,M=function(t){function e(e,n){var o=t.call(this,e)||this;return o.name=n,o.delay=0,o}return B(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+this.name},e.prototype.og=function(){this.ah.Og(this.name,!0)},e.prototype.ng=function(){this.ah.Og(this.name,!1)},e.prototype.bh=function(){this.ZAb().onAddAdjust(this,3)},e.prototype.fh=function(){this.$l=!0,this.ZAb().pg(this,3)},e}(k),e.NameIDCalc=M,N=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.id=n,r.name=o,r.delay=0,r}return B(e,t),e.prototype.getKey=function(){var t=this;return t.ah.getName()+","+t.id+"#"+t.name},e.prototype.og=function(){var t=this;t.ah.Ig(t.id,t.name,!0)},e.prototype.ng=function(){var t=this;t.ah.Ig(t.id,t.name,!1)},e.prototype.ZAb=function(){return this.ah.Af},e.prototype.bh=function(){this.ZAb().onAddAdjust(this,6)},e.prototype.fh=function(){this.$l=!0,this.ZAb().pg(this,6)},e}(k),e.PathCalc=N,E=function(){function t(){this.autoCalculation=!0,this.jh={},this.useR1C1=!1,this.allowDynamicArray=!1,this.iterativeCalculation=!0,this.iterativeCalculationMaximumIterations=1e3,this.iterativeCalculationMaximumChange=.01,this.mh=0,this.Bka=0,this.hmb=[];var t=this;t.kh=new a.Parser,t.lh=new s.Evaluator(t),t.nh=t.uzb&&t.uzb(),t.addResolver(new a.DefaultTokenResolver)}return t.prototype.getResolvers=function(){return this.hmb},t.prototype.addResolver=function(t){var e,n=this.hmb;for(e=0;;e++)if(!n[e]||t.priority>n[e].priority){n.splice(e,0,t);break}},t.prototype.dispose=function(){this.jh={},this.oh=h},t.prototype.cloneFrom=function(t){var e=this;e.useR1C1=t.useR1C1,e.mh=t.mh,e.qh=t.qh,e.calcOnDemand=t.calcOnDemand},t.prototype.ih=function(){return this.nh},t.prototype.getExternalSource=function(t,e){var n,o,r=this.getAllSourceModels();for(n=0,o=r.length;n<o;n++)if(c.Mb(r[n].getSource().getName(),e))return r[n].getSource();return h},t.prototype.getSourceModel=function(t){var e=this.jh[t.id];return e||(e=t.createSourceModel?t.createSourceModel(this):this.createSourceModel(this,t),this.jh[t.id]=e,t.setCalcSourceModel(e),t.setCalcService(this)),e},t.prototype.getGlobalSourceModel=function(t){return this.oh||((t=t||new r.CalcSource).createSourceModel?this.oh=t.createSourceModel(this):this.oh=this.createSourceModel(this,t),t.setCalcSourceModel(this.oh)),this.oh},t.prototype.setSourceModel=function(t,e){this.jh[t.id]=e,e.setCalcService(this)},t.prototype.getAllSourceModels=function(){var t,e=[],n=this.jh;for(t in n)e.push(n[t]);return e},t.prototype.removeSource=function(t){var e,n,o,r;for(n in this.suspend(),this.jh[t.id]&&(this.onRemoveSource(t),delete this.jh[t.id]),this.clearDirties(),e=this.jh)e[n].addDirtyNodesForCalc(!0);o=this.Dh&&this.Dh.kj,r=t&&t.kj,o&&r&&r===o&&(this.Dh=null),this.resume(!1)},t.prototype.clearSource=function(){this.jh={},this.Dh=null,this.clearDirties()},t.prototype.ignoreDirty=function(){return this.qh},t.prototype.suspend=function(t){this.mh++,this.qh=!!t},t.prototype.resume=function(t){var e=this;e.mh--,e.mh<0&&(e.mh=0),e.IsSuspended()||(e.rh=h,e.qh=!1,e.recalculateAll(t))},t.prototype.suspendAdjust=function(){this.Bka++},t.prototype.resumeAdjust=function(){var t=this;t.Bka--,t.Bka<0&&(t.Bka=0)},t.prototype.isAdjustSuspended=function(){return this.Bka>0},t.prototype.clearDirties=function(){var t,e,n,o=this,r=o.imb;if(r)for(t in r)if(r.hasOwnProperty(t))for(e=r[t];e;)(n=e.eh)?(e.$l=!1,e.eh=n.dh=p,e=n):e=h;o.imb=o.jmb=h},t.prototype.resumeWithoutCalc=function(){this.mh=0,this.clearDirties(),this.qh=!1},t.prototype.IsSuspended=function(){return this.mh>0},t.prototype.recalculateAll=function(t,e){var n,o,r,i=this;if(!i.IsSuspended()){for(r in i.CIb=Date.now(),e||i.lh.startCache(),o=i.jh)(n=o[r]).getSource().startCalculation(),n.addDirtyNodesForCalc(t,e);for(r in i.Gg(),o)(n=o[r]).getSource().endCalculation();e||i.lh.endCache(),delete i.CIb}},t.prototype.Gg=function(t){var e,n,o,r,i,a,s;if(void 0===t&&(t=!0),n=(e=this).imb){if(t){for(o in i=n[1]||n[2],n)n.hasOwnProperty(o)&&(a=parseInt(o),i&&1!==a&&2!==a||(r=n[o])&&(r.ah.addListenersToDirty(e,a),r.processed=!0));for(o in n)n.hasOwnProperty(o)&&((r=n[o])&&(r.processed?delete r.processed:r.ah.addListenersToDirty(e,parseInt(o))))}for(o in n)n.hasOwnProperty(o)&&n[o].ah.initDelay(e,parseInt(o));for(o in n)n.hasOwnProperty(o)&&n[o].ah.adjustDelayOfListeners(e,parseInt(o),!0);do{for(o in s=!1,n)n.hasOwnProperty(o)&&(n[o].ah.calculateDirtyNodes(e,parseInt(o))&&(s=!0))}while(s);for(o in n)n.hasOwnProperty(o)&&n[o].ah.calculateIterations(e,parseInt(o));e.imb=e.jmb=p}},t.prototype.initParserContext=function(t){this.Dh||(this.Dh=t.getParserContext(this.useR1C1))},t.prototype.getParserContext=function(t){var e=this,n=e.Dh;return n||(t?e.Dh=n=t.getParserContext(e.useR1C1):n=new a.ParserContext(h,e.useR1C1)),n.setSource(t),n},t.prototype.parseWithContext=function(t,e){return this.kh.parse(t,e)},t.prototype.unparseWithContext=function(t,e){return this.kh.unparse(t,e)},t.prototype.pg=function(t,e){var n,o,r,i,a=this;isNaN(e)||(r=a.imb,i=a.jmb,r||(r=a.imb={},i=a.jmb={}),n=r[e],o=i[e],t&&!t.dh&&t!==n&&(n?o.eh=t:r[e]=t,t.dh=o,t.eh=h,i[e]=t))},t.prototype.Bh=function(t,e){var n,o,r,i,a,s=this;isNaN(e)||(o=s.imb,r=s.jmb,o&&(n=s.imb[e]),t&&(t.dh||t===n)&&(i=t.dh,a=t.eh,i?i.eh=a:o&&(a?o[e]=a:delete o[e]),a?a.dh=i:r&&(i?r[e]=i:delete r[e]),t.dh=h,t.eh=h))},t.prototype.evaluateExpression=function(t,e,n){return this.lh.evaluateExpression(e,t.getEvaluatorContext(n,!1),!1)},t.prototype.onClearExpr=function(t,e){this.lh&&this.lh.asyncManager.clearCell(t,e)},t.prototype.parse=function(t,e,n,o,r,i,a){var s,l,u=this,c=u.rh,f=u.getParserContext(t);return f.useR1C1=!a&&u.useR1C1,f.ignoreError=i,f.row=n,f.column=o,f.culture=r,c?(s=c[e])?s:(l=u.kh.parse(f,e),c[e]=l,l):u.kh.parse(f,e)},t.prototype.unparse=function(t,e,n,o,r,i,a){var s,l=this.getParserContext(t);return l.useR1C1=this.useR1C1,l.row=n,l.column=o,l.culture=r,l.addSheetName=a,i&&(l.Eh=!0,l.useR1C1=!1),s=this.kh.unparse(l,e),l.Eh=!1,s},t.prototype.recalculate=function(t,e,n,o){var r=this.getSourceModel(t);-1===n?r.Ag(e,0,1,r.cC()):-1===e?r.Ag(0,n,r.rC(),1):r.Ag(e,n,1,1),this.IsSuspended()||this.recalculateAll(!1,o)},t.prototype.recalculateByName=function(t,e){var n;e&&(n=function(t,e){return t.getSourceModel(e)}(this,t).mg(T(e),!0),this.pg(n,3),this.IsSuspended()||this.recalculateAll(!1))},t.prototype.recalcRange=function(t,e,n,o,r){var i=this.getSourceModel(t);-1===n?i.Ag(e,0,o,i.cC()):-1===e?i.Ag(0,n,i.rC(),r):i.Ag(e,n,o,r),this.IsSuspended()||this.recalculateAll(!1)},t.prototype.evaluate=function(t,e,n,o,i){var a=e instanceof r.Expression?e:this.parse(t,e,n,o);return this.lh.evaluateExpression(a,t.getEvaluatorContext(Z(n,o),!1),!1,i,i)},t.prototype.Hg=function(t,e,n,o,i,a,s,l){var u,c,f,d,g,m,C,b,w,T,x,S=n.row||0,A=n.col||0,I=a?a.row:S,R=a?a.col:A,k=t.getEvaluatorContext(n,o,a);if(k.NDc=l,c=4===arguments.length&&o||s,this.allowDynamicArray&&!o&&(k.Exb=!0),(u=this.lh.evaluateExpression(e,k,i,c,c))&&u.pause)return u;if(t.ODc){for(f=0;f<t.ODc.length;f++)delete t.ODc[f].PDc;delete t.ODc}if(o&&arguments.length<=5)return u;if(!o&&s&&(r.Convert.Fh(u)||r.Convert.Ca(u)))return u;if(r.Convert.Fh(u)){if(d=u.getRowCount(0),g=u.getColumnCount(0),1!==u.getRangeCount())return y;try{if(m=o?S-I:S-u.getRow(0),C=o?A-R:A-u.getColumn(0),b=Z(0,0),1===d&&1===g);else if(1===d&&g>1&&C>=0&&C<g)b.col=C;else if(d>1&&1===g&&m>=0&&m<d)b.row=m;else{if(!(o&&m<d&&C<g))return o?v:y;b.row=m,b.col=C}u=u.getValue(b,0)}catch(t){return y}}else if(r.Convert.Ca(u))if(o){if(T=(w=u).getRowCount(),x=w.getColumnCount(),1!==T&&S-I>=T||1!==x&&A-R>=x)return v;u=u.getValue(1===T?0:S-I,1===x?0:A-R)}else u=u.getValueByIndex(0);return u===p||u===h?!1===i?u:0:u},t.prototype.onAddAdjust=function(t,e){this.nh.hh(t,e)},t.prototype.onRemoveSource=function(t){this.nh.ph(t)},t.prototype.createSourceModel=function(t,e){return new O(t,e)},t.prototype.NHb=function(){var t,e,n=this.jh;for(t in n)(e=n[t])instanceof O&&e.getAllNodes().forEach((function(t){var e=t.calc;e&&(e.$l=!1,(e.eh||e.dh)&&(e.dh=e.eh=h))}))},t}(),e.CalcService=E,e.setSpillValues=G,e.markAnchorCellDirty=V,D=function(){function t(){}return t.getLength=function(t,e){return b(t)?t.getRowCount()*t.getColumnCount():w(t)?(e=e||0,t.getRowCount(e)*t.getColumnCount(e)):void 0},t.getRowCount=function(t,e){return b(t)?t.getRowCount():w(t)?(e=e||0,t.getRowCount(e)):void 0},t.getColumnCount=function(t,e){return b(t)?t.getColumnCount():w(t)?(e=e||0,t.getColumnCount(e)):void 0},t.getValueByIndex=function(t,e,n){if(b(t))return t.getValueByIndex(e);if(w(t)){n=n||0;var o=t.getColumnCount(n);return t.getValue(n,parseInt(""+e/o,10),e%o)}},t.getValue=function(t,e,n,o){return b(t)?t.getValue(e,n):w(t)?(o=o||0,t.getValue(o,e,n)):void 0},t}(),e.CalcArrayHelper=D,O=function(){function t(t,e){this.Ef=0,this.Ff=0,this.Gf=[],this.qhc=[],this.dataTable={},this.dataTableByName={},this.Hf=[],this.If=[],this.B5=0;this.xf=e,this.Af=t}return t.prototype.getNode=function(t,e,n){var o,r=this,i=h;return t>=0&&e>=0?(o=r.dataTable[t],n&&!o&&(o=r.dataTable[t]={},t>r.Ef&&(r.Ef=t)),o&&(i=o[e],n&&!i&&(i=o[e]={},e>r.Ff&&(r.Ff=e)))):-1===t&&e>=0?(i=r.If[e],n&&!i&&(i=r.If[e]={},e>r.Ff&&(r.Ff=e))):t>=0&&-1===e?(i=r.Hf[t],n&&!i&&(i=r.Hf[t]={},e>r.Ff&&(r.Ff=e))):-1===t&&-1===e&&(i=r.Jf,n&&!i&&(i=r.Jf={})),i},t.prototype.getNodeByName=function(t,e){var n=this.dataTableByName[t];return e&&!n&&(n=this.dataTableByName[t]={}),n},t.prototype.Kf=function(t,e){var n=this.getNode(t,e);return n&&n.Lf},t.prototype.Mf=function(t,e){var n=this.getNode(t,e);return n&&n.Nf},t.prototype.Qf=function(t,e){return this.getWorkingNodeInfo(t,e,2)},t.prototype.BTa=function(t,e){return this.getWorkingNodeInfo(t,e,1)},t.prototype.ATa=function(t,e){return this.getWorkingNodeInfo(t,e,0)},t.prototype.CTa=function(t){var e=this.getNodeByName(t);return e&&e.Nf},t.prototype.DTa=function(t){var e=this.getNodeByName(t);return e&&e.Lf},t.prototype.clearAll=function(){var t=this;t.clear(-1,-1,-1,-1),t.dataTable={},t.dataTableByName={},t.Hf=[],t.If=[],t.Jf=h},t.prototype.clear=function(t,e,n,o,r){this.$b(t,e,n,o,r)},t.prototype.rzb=function(){var t=this;U(t.Hf),U(t.If),U(t.dataTable,!0),U(t.dataTableByName),t.eHb()},t.prototype.eHb=function(){var t=this;t.dataTable={},t.dataTableByName={},t.Hf=[],t.If=[],t.Jf=h,t.Gf=[],t.vg=h,t.xg=h},t.prototype.addRows=function(t,e){var n,o=this,r=o.rC();if(!(t<0||t>r||e<0))for(l(o.dataTable,r,t,e),l(o.Hf,r,t,e),n=0;n<e;n++)o.dataTable[t+n]&&(o.dataTable[t+n]={rs:"n"})},t.prototype.deleteRows=function(t,e){var n=this,o=n.rC();t<0||t>=o||e<=0||(t+e>o&&(e=o-t),u(n.dataTable,o,t,e),u(n.Hf,o,t,e))},t.prototype.addColumns=function(t,e){var n,o,r=this,i=r.rC(),a=r.cC();if(!(t<0||t>a||e<0)){for(n=0;n<i;n++)(o=r.dataTable[n])&&t<a&&l(o,a,t,e);l(this.If,a,t,e)}},t.prototype.deleteColumns=function(t,e){var n,o,r=this.rC(),i=this.cC();if(!(t<0||t>=i||e<0)){for(n=0;n<r;n++)(o=this.dataTable[n])&&u(o,i,t,e);u(this.If,i,t,e)}},t.prototype.ETa=function(t,e){var n=[t,e],o=this.getNode(t,e);return o&&n.push(o.Lf,o.Nf,o.Pf),n},t.prototype.FTa=function(t,e,n){t&&t.push(this.ETa(e,n))},t.prototype.dUa=function(){var t=this.getSource(),e=t&&t.getSheet(),n=e&&e.ITa;return n&&n.dUa()},t.prototype.$Va=function(t,e,n,o,r){var i=this;-1===t?i.kg(e,n,o):-1===e?i.jg(t,n,o):i.ig(t,e,n,o,r)},t.prototype.Rf=function(t,e,n,o){var r=this.getNode(t,e,!!n);r&&(o&&o.push([t,e,r.Lf]),r.Lf=n)},t.prototype.GTa=function(t,e,n,o,r,i,a){var s=this.getNode(t,e,!!n);s&&(this.FTa(a,t,e),s.Lf=n,(s.Nf||o)&&(s.Nf=o),(s.Pf||r)&&(s.Pf=r),s.isVolatile&&!n?this.Tf(s):(i||s.isVolatile)&&(s.isVolatile=i))},t.prototype.Sf=function(t,e,n){this.GTa(t,e,p,p,p,!1,n)},t.prototype.Uf=function(t,e,n,o,r,i){var a=this.getNode(e,n);a&&a.Lf&&t.GTa(o,r,a.Lf,a.Nf,a.Pf,a.isVolatile,i)},t.prototype.ega=function(t,e){var n=this.dataTable[t];return n&&n[e]},t.prototype.Wf=function(t,e,n){var o=this.getNode(t,e,!!n);o&&(o.Nf=n)},t.prototype.Xf=function(t,e,n){var o=this.getNode(t,e,!!n);o&&(o.Pf=n)},t.prototype.Yf=function(t,e){var n=this.getNode(t,e);return n&&n.calc},t.prototype.Zf=function(t,e,n){var o=this.getNode(t,e,!0);o&&(o.calc&&o.calc.isVolatile&&this.Tf(o),o.calc=n,n&&(n.node=o))},t.prototype.Q3=function(t,e,n){var o=this.getNode(t,e,!0);o&&o.calc&&(o.calc.isVolatile&&this.Tf(o),this.Af.Bh(o.calc,n),o.calc=p)},t.prototype.$f=function(t,e,n,o,r){var i,a=this;n>=0&&o>=0?((i=a.dataTable[n])||(i=a.dataTable[n]={}),i[o]=r,r&&r.calc&&delete r.calc):n>=0&&-1===o&&t>=0&&-1===e?a.Hf[n]=r:o>=0&&-1===n&&e>=0&&-1===t&&(a.If[o]=r)},t.prototype._f=function(t,e,n,o){var r=this,i=r.getNode(t,e),a=r.getNode(n,o);i&&i.Lf?r.$f(t,e,n,o,i):a&&a.Lf&&r.$f(t,e,n,o,h),a&&a.Lf?r.$f(n,o,t,e,a):i&&i.Lf&&r.$f(n,o,t,e,h)},t.prototype.rhc=function(t,e,n){t.isIterativeCalc||(t.isIterativeCalc=!0,this.qhc.push(t),e||function(t,e){var n,o,r,i=t.ah&&t.ah.getSource();i&&(n=t.row,o=t.column,r=i.getValue(n,o),i.setValue(n,o,e,r))}(t,n))},t.prototype.shc=function(t){delete t.isIterativeCalc},t.prototype.thc=function(){var t,e=this,n=[],o=e.qhc,r=e.qhc.length;for(t=0;t<r;t++)o[t].isIterativeCalc&&n.push(o[t]);return e.qhc=n,e.qhc},t.prototype.lmb=function(){return this.Gf},t.prototype.bg=function(t){t.isVolatile||(t.isVolatile=!0,this.Gf.push(t))},t.prototype.Tf=function(t){var e,n,o,r,i;if(t.isVolatile=p,(e=this).B5++,e.B5>100){for(e.B5=0,n=[],o=e.Gf,r=e.Gf.length,i=0;i<r;i++)o[i].isVolatile&&n.push(o[i]);e.Gf=n}},t.prototype.getCalcService=function(){return this.Af},t.prototype.setCalcService=function(t){this.Af=t},t.prototype.Cf=function(){return this.Af},t.prototype.getSource=function(){return this.xf},t.prototype.hasFormula=function(t,e){return t=t!==p?t:-1,e=e!==p?e:-1,!!this.ATa(t,e)},t.prototype.setFormula=function(t,e,n,o,r,i,a,s){var l,u,c,f,d,g=this;if(n&&0===n.length&&(n=h),!r&&g.dg(t,e,1,1)&&g.eg(),l=g.getFormula(t,e),i||l!==n&&(""!==l||n)&&(l||""!==n)||l===n&&g.Qf(t,e)){if(u=g.Cf(),c=h,u)try{f=t>=0?t:0,d=e>=0?e:0,c=o||(n?u.parse(g.xf,n,f,d,!1,r):h),g.fg(t,e,c,p,!1,a,s)}catch(t){if(!r)throw t}t>=0&&e>=0&&g.xf.setFormula(t,e,n)}},t.prototype.getFormula=function(t,e,n){var o,r,i=this.Cf();return i&&(o=this.ATa(t,e))?(t=(r=this.Qf(t,e))&&!0!==r.isDynamicArray?r.row:t,e=r&&!0!==r.isDynamicArray?r.col:e,i.unparse(this.xf,o,t,e,n)):h},t.prototype.setFormulaByName=function(t,e,n,o,r){var i,a,s,l;if(t&&(t=T(t),i=this,e&&0===e.length&&(e=h),(a=i.getFormulaByName(t))!==e&&(""!==a||e)&&(a||""!==e))){if(s=i.Cf(),l=h,s)try{l=e?s.parse(i.xf,e,0,0,!1,n):h,i.gg(t,l,p,!1,o,r)}catch(t){if(!n)throw t}i.xf.setFormula({name:t},e)}},t.prototype.getFormulaByName=function(t){var e,n=this.Cf();return n&&t&&(e=this.DTa(T(t)))?n.unparse(this.xf,e,0,0):h},t.prototype.eg=function(){throw r.sR().Exp_ArrayFromulaPart},t.prototype.rC=function(){return A(this.xf.getRowCount())},t.prototype.cC=function(){return A(this.xf.getColumnCount())},t.prototype.setArrayFormula=function(t,e,n,o,r,i,a,s){var l,u,c,f,p=this;if(r&&0===r.length&&(r=h),p.dg(t,e,n,o)&&p.eg(),t=t<0?0:t,e=e<0?0:e,(u=p.Cf())&&(p.$b(t,e,n,o,a),r)){try{l=r?u.parse(p.xf,r,t,e,!1,i,i):h}catch(t){if(!i)throw t;return}for(c=t;c<t+n;c++)for(f=e;f<e+o;f++)p.fg(c,f,l,Q(t,e,n,o),!1,a,s);t>=0&&e>=0&&p.xf.setArrayFormula(t,e,n,o,u.unparse(p.xf,l,t,e))}},t.prototype.getWorkingNodeInfo=function(t,e,n){var o,r=this,i=r.xf;return t>=i.getRowCount()||e>=i.getColumnCount()?o:(t>=0&&e>=0?((!(o=r.getNode(t,e))||0===n&&!o.Lf||1===n&&!o.Nf||2===n&&!o.Pf)&&(o=r.getNode(t,-1)),(!o||0===n&&!o.Lf||1===n&&!o.Nf||2===n&&!o.Pf)&&(o=r.getNode(-1,e))):o=t>=0&&-1===e?r.getNode(t,-1):-1===t&&e>=0?r.getNode(-1,e):r.getNode(-1,-1),o&&(0===n&&o.Lf||1===n&&o.Nf||2===n&&o.Pf))},t.prototype.fg=function(t,e,n,o,r,i,a){var l,u,c,f,h,d,g,m,y,v,C,b,w,T=this,x=T.Cf();x.nia&&x.lh.asyncManager.endCalcCell(),u=(l=o!==p&&null!==o)?o.row:t,c=l?o.col:e,f=T.xf,h=new s.EvaluateContext(f,Z(u,c),l),d=x.allowDynamicArray,g=Y(h,n,l,l?t-o.row:0,l?e-o.col:0,d,d),(m=h.iOb)&&(delete h.iOb,2===m?n=g:1===m&&(y=x.unparse(f,n,u,c),n=x.parse(f,y,u,c))),g=g===n?p:g,o!==p&&(v=o),t>=0&&e>=0?((r===p||r)&&(C=t>=0?t:0,b=e>=0?e:0,w=n?x.unparse(f,n,C,b):p,T.xf.setFormula(t,e,w)),T.ig(t,e,n,g,v,i,a)):t>=0&&-1===e?T.jg(t,n,g,i,a):-1===t&&e>=0&&T.kg(e,n,g,i,a),x.autoCalculation&&!x.IsSuspended()&&x.recalculateAll(!1)},t.prototype.gg=function(t,e,n,o,r,i){var a,l=this,u=l.Cf(),c=Y(new s.EvaluateContext(l.xf,Z(0,0),!1),e,!1,0,0);c=c===e?p:c,o!==p&&!o||r||(a=e?u.unparse(l.xf,e,0,0):p,l.xf.setFormulaByName&&l.xf.setFormulaByName(t,a)),l.lg(t,e,c,null,i),u.autoCalculation&&!u.IsSuspended()&&(r||u.recalculateAll(!1))},t.prototype.getRowExpression=function(t){return this.Kf(t,-1)},t.prototype.getColumnExpression=function(t){return this.Kf(-1,t)},t.prototype.lg=function(t,e,n,o,r){var i,a=this.mg(t,!0);a&&(r||a.ng(),(i=this.getNodeByName(t,!0)).Lf=e,o&&(o[0].push("dataTable",t),o[1]=i.Lf),n=e&&n?n:p,i.Nf=n,r||a.og(),a.fh())},t.prototype.ig=function(t,e,n,o,r,i,a){var s=this,l=s.qg(t,e,!0);l&&(s.FTa(i,t,e),s.Af.onClearExpr(s.xf,Z(t,e)),l.ng(),s.Rf(t,e,n),n?((o||s.Mf(t,e))&&s.Wf(t,e,o),r&&!0===r.isDynamicArray||s.Xf(t,e,r)):(s.Wf(t,e,p),s.Xf(t,e,p)),l.og(),l.fh())},t.prototype.jg=function(t,e,n,o,r){var i=this,a=i.rg(t,!0);a&&(i.FTa(o,t,-1),r||a.ng(),i.Rf(t,-1,e),(n||i.Mf(t,-1))&&i.Wf(t,-1,n),r||a.og(),a.fh())},t.prototype.kg=function(t,e,n,o,r){var i=this,a=i.sg(t,!0);a&&(i.FTa(o,-1,t),r||a.ng(),i.Rf(-1,t,e),(n||i.Mf(-1,t))&&i.Wf(-1,t,n),r||a.og(),a.fh())},t.prototype.$b=function(t,e,n,o,r){var i,a,s,l,u,c=this,f=t<0?0:t,d=e<0?0:e,g=f+(t<0?c.rC():n)-1,m=d+(e<0?c.cC():o)-1,y=function(t,e){if(i=c.Mf(t,e),a=c.Kf(t,e),i||a){var n=(s=c.Qf(t,e))&&!0!==s.isDynamicArray?Q(s.row,s.col,s.rowCount,s.colCount):p;c.fg(t,e,h,n,!0,r)}};for(l=f;l<=g&&l>=0;l++)for(e<0&&y(l,-1),u=d;u<=m&&u>=0;u++)l===f&&t<0&&y(-1,u),y(l,u);t<0&&e<0&&y(t,e)},t.prototype.dg=function(t,e,n,o){return this.tg(t,e,n,o,!0,!0)},t.prototype.tg=function(t,e,n,o,r,i){var a,s,l,u,c,f,h,p,d=this,g=t<0?0:t,m=e<0?0:e,y=t<0?d.rC():n,v=e<0?d.cC():o,C=g+(0===y?1:y)-1,b=m+(0===v?1:v)-1,w=!1,T=[],x=[],S=d.dataTable;for(l=g;l<=C&&l>=0&&!(l>d.Ef);l++)if(s=S[l])for(u=m;u<=b&&u>=0&&!(u>d.Ff);u++)if(a=s[u])if(f=void 0,(c=a.Pf)&&!c.isDynamicArray){if(c.row<g||c.row+c.rowCount-1>C||c.col<m||c.col+c.colCount-1>b){if(r)return h=c.row===t&&0===n,p=c.col===e&&0===o,!h&&!p;w=!0}if(l!==c.row&&l!==g)continue;T.push(Q(c.row,c.col,c.rowCount,c.colCount)),f=a.Lf,x.push(f),u=c.col+c.colCount-1}else i||(f=a.Lf)&&(T.push({row:l,col:u}),x.push(f));return!r&&{hasPart:w,ranges:T,formulas:x}},t.prototype.getCalcObj=function(){var t,e,n,o,r,i,a,s,l,u,c,f=[];for(t=0;t<arguments.length;t++)f[t]=arguments[t];if(e=f[0],n=f[1],o=this,r=e.row,i=e.column,a=null,isNaN(r)||isNaN(i))e.name&&(a=o.mg(e.name,n));else if(r>=0&&i>=0)if(e.sf())a=o.qg(r,i,n);else for(s=e.endRow,l=e.endColumn,a=[],u=r;u<=s;u++)for(c=i;c<=l;c++)a.push(o.qg(u,c,n));else r>=0?a=o.rg(r,n):i>=0&&(a=o.sg(i,n));return a},t.prototype.mg=function(t,e){var n=h,o=this.getNodeByName(t,e);return o&&(!(n=o.calc)&&e&&(n=new M(this,t),o.calc=n,n.node=o)),n},t.prototype.qg=function(t,e,n){var o,r,i,a=this,s=h;if(t>=0&&e>=0){if(!(r=(o=a.dataTable)[t])){if(!n)return s;r=o[t]={},t>a.Ef&&(a.Ef=t)}if(!(i=r[e]))return n&&(i=r[e]={},s=new j(a,t,e),i.calc=s,s.node=i,e>a.Ff&&(a.Ff=e)),s;!(s=i.calc)&&n&&(s=new j(a,t,e),i.calc=s,s.node=i,t>a.Ef&&(a.Ef=t),e>a.Ff&&(a.Ff=e))}return s},t.prototype.rg=function(t,e){var n=this,o=h;return t>=0&&(!(o=n.Yf(t,-1))&&e&&(o=new F(n,t),n.Zf(t,-1,o),t>n.Ef&&(n.Ef=t))),o},t.prototype.sg=function(t,e){var n=this,o=h;return t>=0&&(!(o=n.Yf(-1,t))&&e&&(o=new P(n,t),n.Zf(-1,t,o),t>n.Ff&&(n.Ff=t))),o},t.prototype.ug=function(t){var e=this;return!e.vg&&t&&(e.vg=new L(e)),e.vg},t.prototype.wg=function(t,e){var n,o=this;return t=T(t),o.xg||(o.xg={}),!(n=o.xg[t])&&e&&(n=o.xg[t]=new _(o,t)),n},t.prototype.updateNameCalc=function(t,e){var n=this.wg(T(t));n&&(n.updateListening(!0,e),n.fh())},t.prototype.yg=function(t,e){var n,o,r=this,i=A(r.Ff,t+e-1);for(n=t;-1!==n&&n<=i;n++)r.isDirty(-1,n)&&(o=r.sg(n,!0),r.Af.pg(o,2))},t.prototype.zg=function(t,e){var n,o,r=this,i=A(r.Ef,t+e-1);for(n=t;-1!==n&&n<=i;n++)r.isDirty(n,-1)&&(o=r.rg(n,!0),r.Af.pg(o,1))},t.prototype.Ag=function(t,e,n,o){var r,i,a,s=this,l=null,u=A(s.Ef,t+n-1),c=A(s.Ff,e+o-1);for(r=t;r<=u;r++)for(i=e;i<=c;i++)s.ega(r,i)&&(s.Af.calcOnDemand?(l=s.qg(r,i,!1))&&(l.Bg(),l.$l=!0):(l=s.qg(r,i,!0),s.Af.pg(l,0)));s.zg(t,n),s.yg(e,o),(a=s.ug(!1))&&a.Bg(t,e,n,o)},t.prototype.uhc=function(){var t,e,n,o,r,i=this,a=i.lmb().concat(i.thc());for(n=0;n<a.length;n++)o=a[n],i.Af.calcOnDemand&&o&&(o.isVolatile||o.isIterativeCalc)&&(o.$l=!0,o.Bg()),o&&(o.isVolatile||o.isIterativeCalc)&&o instanceof j&&!i.Dg(o)&&(r=i.qg(o.row,o.column,!0),i.Af.pg(r,0),(t=i.rg(o.row,!1))&&!i.Eg(t)&&i.zg(o.row,1),(e=i.sg(o.column,!1))&&!i.Eg(e)&&i.yg(o.column,1))},t.prototype.Dg=function(t){var e=this.getCalcService().imb;return!!t.dh||t===(e&&e[0])},t.prototype.Eg=function(t){var e=this.getCalcService().imb;return t.dh||t===(e&&e[1])},t.prototype.isDirtyColumn=function(t){var e=this.getCalcService().imb;return t.dh||t===(e&&e[2])},t.prototype.isDirty=function(t,e){return!(!this.Yf(t,e)&&!this.Kf(t,e))},t.prototype.recalculateForContext=function(t,e,n){var o=this.Af,r=o.getSourceModel(t),i=e.row,a=e.col;-1===a?r.Ag(i,0,1,r.cC()):-1===i?r.Ag(0,a,r.rC(),1):r.Ag(i,a,1,1),o.IsSuspended()||o.recalculateAll(!1,n)},t.prototype.recalculateCell=function(t,e,n){var o,a,s,l,u,c,d,g,m,v,b,w,T,x,A,I,k,M=this,N=M.xf,E=M.BTa(t,e)||M.ATa(t,e),D=N,O=D.q$a,j=D&&D.kj&&D.kj.ITa;if(j&&(j.SIb=!0),a=!1,E){if(s=Z(t,e),l=N.getValue(t,e),u=!1,c=void 0,d=void 0,g=void 0,m=void 0,(v=M.Qf(t,e))&&!0!==v.isDynamicArray&&(u=!0,c=v.row,d=v.col,g=v.rowCount,m=v.colCount),(b=M.Af).nia&&b.lh.asyncManager.startCalcCell(M.xf,s),(w=b.Hg(M.xf,E,s,u,!0,v&&!0!==v.isDynamicArray&&Q(c,d,g,m),b.allowDynamicArray,n))&&w.pause)return w;if((T=M.xf.getCalcSourceModel().qg(t,e)).jOb&&(z(N,T.jOb,t,e,!1),delete T.jOb),T.fOb&&(z(N,T.fOb,t,e,!0),T.jOb=T.fOb,delete T.fOb),T.kOb&&(W(b,T,T.kOb,!1),delete T.kOb),T.eOb&&(W(b,T,T.eOb,!0),T.kOb=T.eOb,delete T.eOb),(r.Convert.Fh(w)||r.Convert.Ca(w))&&!0!==E.ensureSingle&&(v={row:t,col:e,rowCount:g=w.getRowCount(),colCount:m=w.getColumnCount(),isDynamicArray:!0},M.Xf(t,e,v)),a=!0,A=void 0,(x=r.Convert.Fh(w)||r.Convert.Ca(w))&&((A=r.Convert.Ph(w,0,!1,!1,!1)).isError||A.isConvertError?(w=y,x=!1):(g=A.rowCount,m=A.colCount,0===g||0===m?(w=C,x=!1):1!==g||1!==m||E instanceof i.SpillReferenceExpression||(w=A[0][0],S(w)&&(w=0),x=!1),E.ensureSingle&&x&&(I=M.getNode(t,e),delete E.ensureSingle,E=I.Lf=r.Jh(r.Functions.findGlobalFunction("@"),[E]),I.Nf=p,w=E.function.evaluate({row:t,column:e},w),x=!1))),x)(k=D.setArray(t,e,g,m,A))&&G(k[1],D);else if((k=D.updateItem&&D.updateItem(t,e,w))&&(G(k[0],D),o=k[1]),"hyperlink",l!==w||"string"==typeof w&&w.hyperlink){if(l instanceof Date){if(w instanceof Date&&l.valueOf()===w.valueOf())return!1;if(typeof w===R){if(f.Ra(l)===w)return!1;w=f.Xb(w)}}N.setValue(t,e,w,l)}else a=!1;b.nia&&b.lh.asyncManager.endCalcCell(M.xf,s),D.Ppb&&D.Ppb(t,e)}else O||(k=D.updateItem&&D.updateItem(t,e,h))&&(G(k[0],D),o=k[1]);return j&&(o&&V(o,M,j.ZHb),j.SIb=!1),a},t.prototype.recalculateNameID=function(t){var e,n,o=this,r=o.xf,i=o.CTa(t)||o.DTa(t);if(i){if((e=r.getValueByName?r.getValueByName(t):r.getValue({name:t}))===(n=o.Af.Hg(o.xf,i,{name:t},!1,!0)))return;if(e instanceof Date&&n instanceof Date&&e.valueOf()===n.valueOf())return;r.setValueByName?r.setValueByName(t,n):r.setValue({name:t},n)}},t.prototype.addDirtyNodesForCalc=function(t,e){var n,o,r=this;!1!==t?(n=r.cC(),o=r.rC(),r.yg(0,n),r.zg(0,o),r.Ag(0,0,o,n)):e||r.uhc()},t.prototype.addListenersToDirtyForRow=function(t){for(var e,n,o,r;t.imb[1];){for(o=(n=(e=t.imb[1]).ah).cC(),r=0;r<o;r++)t.pg(n.qg(e.row,r,!0),0);t.Bh(e,1)}},t.prototype.addListenersToDirtyForCol=function(t){for(var e,n,o,r;t.imb[2];){if((o=(n=(e=t.imb[2]).ah).rC())>0)for(r=0;r<o;r++)t.pg(n.qg(r,e.column,!0),0);else e.Bg();t.Bh(e,2)}},t.prototype.Ah=function(t,e){for(var n=t.length,o=e;o;)t[n]=o,n++,o=o.eh},t.prototype.addListenersToDirty=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g;if(1===e)this.addListenersToDirtyForRow(t);else if(2===e)this.addListenersToDirtyForCol(t);else if(0===e)for(n=[],t.imb[2]&&this.Ah(n,t.imb[2]),o=t.imb[0];o;o=o.eh)for(r=o.ah,i=o.row,a=o.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),o.Bg(),s&&s.Bg(),l&&l.Bg(),u&&u.Bg(i,a,1,1),this.addListenersToDirtyForRow(t);t.imb[2];){for(c=t.imb[2],f=!1,h=0;h<n.length;h++)if(n[h]===c){f=!0;break}if(f)t.Bh(c,2);else{for(n[n.length]=c,p=(r=c.ah).rC(),d=0;d<p;d++)t.pg(r.qg(d,c.column,!0),0);t.Bh(c,2)}}else if(3===e)for(g=t.imb[3];g;g=g.eh)g.Bg()},t.prototype.initDelay=function(t,n){var o,r,i,a,s,l,u;if(0===n)for(o=null,r=t.imb[0];r;r=o)o=r.eh,a=(i=r.ah).rC(),s=i.cC(),r.row<a&&r.column<s?(e.supportRowColumnFormula&&((l=i.sg(r.column,!1))&&(l.delay=0)),r.delay=0,delete r.MDc):t.Bh(r,0);else if(3===n)for(u=t.imb[3];u;u=u.eh)u.delay=0},t.prototype.adjustDelayOfListeners=function(t,e,n){var o,r,i,a,s,l,u,c;if(0===e)for(o=t.imb[e];o;o=o.eh)r=o.ah,i=o.row,a=o.column,s=r.rg(i,!1),l=r.sg(a,!1),u=r.ug(!1),o.gh(n),s&&s.gh(n),l&&l.gh(n),u&&u.gh(i,a,n);else if(3===e)for(c=t.imb[3];c;c=c.eh)c.gh(n)},t.prototype.calculateDirtyNodes=function(t,e){var n,o,r,i,a,s,l,u,c,f,h,p,d,g;if(t.calcOnDemand)return!1;if(n=!1,o=null,0===e){for(i=t.imb[e];i;i=r)if(r=i.eh,0===i.delay){if(this.shc(i),o=i.ah,a=i.row,s=i.column,l=o.rg(a,!1),(u=o.sg(s,!1))&&u.delay)continue;if(c=o.ug(!1),(f=o.recalculateCell(a,s,!0))&&"Branch"===f.pause){if(r=i,f.branch)for(h=0;h<f.branch.length;h++)(f.branch[h].dh||f.branch[h].eh||f.branch[h]===i)&&(i.delay++,(p=f.branch[h]).MDc=p.MDc||[],p.MDc.push(i))}else t.Bh(i,0),i.gh(!1),l&&l.gh(!1),u&&u.gh(!1),c&&c.gh(a,s,!1),(d=i.node&&i.node.Lf)&&d.ehc&&delete d.ehc;n=!0}}else if(3===e)for(g=t.imb[e];g;g=r)r=g.eh,0===g.delay&&((o=g.ah).recalculateNameID(g.name),t.Bh(g,3),g.gh(!1),n=!0);return n},t.prototype.calculateIterations=function(t,n){var o,r,i,a,s,l,u,c,f,d,g,m,y;if(!t.calcOnDemand&&0===n&&(o=t.imb[n])){for(a in r=null,i=!0,t.jh)t.jh.hasOwnProperty(a)&&((s=t.jh[a].getSource()).clearValueCache&&s.clearValueCache());if(t.iterativeCalculation)for(u=0;i&&u<t.iterativeCalculationMaximumIterations;u++)for(i=!1,r=o;r;r=r.eh)l=r.node&&r.node.Lf&&r.node.Lf.ehc,this.rhc(r,!l,h),l&&(r.node.Lf.ehc=p),c=r.ah,f=r.row,d=r.column,g=c.getSource().getValue(f,d),c.recalculateCell(f,d),i||(m=c.getSource().getValue(f,d),e.approximatelyEqual(g,m,t.iterativeCalculationMaximumChange)||(i=!0));else for(r=o;r;r=r.eh)l=r.node&&r.node.Lf&&r.node.Lf.ehc,this.rhc(r,!l,0),l&&(r.node.Lf.ehc=p);for(y=null,r=o;r;r=y)y=r.eh,r.eh=p,y&&(y.dh=p)}},t.prototype.Ig=function(t,e,n,o,a,s,l){var u,c,f,d,g,m,y,v,C,b,w,x,S,A,I,R,k,M,N,E,D,O,F,P,_,L,B,G,H,V,z,W,U=this;for(s&&U.shc(t);12===o.type;)o=o.value;for(;10===o.type;)o=o.value;for(;12===o.type;)o=o.value;if(a){for(;12===a.type;)a=a.value;for(;10===a.type;)a=a.value;for(;12===a.type;)a=a.value}if(13===o.type){if((m=o.getRange(e,n,!0))===h)return;o=1===m.rowCount&&1===m.colCount?i.rf(h,h,m.row,m.col,!1,!1):i.uf(h,h,m.row,m.col,m.row+m.rowCount-1,m.col+m.colCount-1,!1,!1,!1,!1)}if(a&&a!==o&&8===a.type){if(a.source instanceof r.ErrorSource)return;c=a.value,(f=(M=o.source||a.source||l||U.xf).getCustomName(c))?N=M.getCalcSourceModel():(f=(N=U.Af.getGlobalSourceModel()||M.getCalcSourceModel()).getSource().getCustomName(c))||M.getCalcSourceModel().wg(c,!0).gmb(0,t,s),(d=N.wg(c,!0)).gmb(0,t,s),a=null,f&&U.Ig(t,e,n,f,h,s,N.getSource())}if(1===o.type&&o.endSource)for(D=(E=o).source.getSources(E.endSource),u=0;u<D.length;u++)(O=i.uf(D[u],h,E.row,E.column,E.endRow,E.endColumn,E.rowRelative,E.columnRelative,E.endRowRelative,E.endColumnRelative,e,n)).isFullRow=E.isFullRow,O.isFullColumn=E.isFullColumn,U.Ig(t,e,n,O,h,s);else if(1===o.type){if(!(N=(M=o.source!==r.BangSource&&o.source||U.xf).getCalcSourceModel()))return;if(F=o,P=t.row===p||t.column===p,_=F.tf(),y=(L=i.getRangeForReference(F,e,n)).row,C=L.col,v=y+(w=L.rowCount)-1,b=C+(x=L.colCount)-1,0===_){if(0<=e&&0<=n)if(J(void 0,void 0,w,x))g=N.ug(!0),P?g.Xoa(y,C,w,x,t,s):g.Jg(y,C,w,x,t,s);else for(R=y;R<=v;R++)for(k=C;k<=b;k++)S=N.qg(R,k,!0),P?S&&S.gmb(3,t,s):S&&S.gmb(0,t,s);else if(0<=e&&-1===n)for(R=y;R<=v;R++)for(k=C;k<=b;k++)F.columnRelative||F.endColumnRelative?(A=N.rg(R,!0))&&A.Kg(t.row,-k,s):(S=N.qg(R,k,!0))&&S.gmb(1,t,s);else if(0<=n&&-1===e)for(R=y;R<=v;R++)for(k=C;k<=b;k++)F.rowRelative||F.endRowRelative?(I=N.sg(k,!0))&&I.Mg(t,-R,s):(S=N.qg(R,k,!0))&&S.gmb(2,t,s)}else if(1===_){if(0<=e&&0<=n)g=N.ug(!0),P?g.Xoa(y,C,w,x,t,s):g.Jg(y,C,w,x,t,s);else if(0<=e&&-1===n);else if(-1===e&&0<=n)if(F.rowRelative||F.endRowRelative);else for(y=F.row,v=F.endRow,R=y;R<=v;R++)(A=N.rg(R,!0))&&A.gmb(2,t,s)}else if(2===_)if(0<=e&&0<=n)g=N.ug(!0),P?g.Xoa(y,C,w,x,t,s):g.Jg(y,C,w,x,t,s);else if(0<=e&&-1===n);else if(-1===e&&0<=n)for(k=C;k<=b;k++)(I=N.sg(k,!0))&&I.gmb(2,t,s)}else if(9===o.type)U.Ig(t,e,n,o.value,a&&9===a.type&&a.value,s),o.value2&&U.Ig(t,e,n,o.value2,a&&9===a.type&&a.value2,s);else if(8===o.type){if(M=o.source||l||U.xf,c=T(o.value),(f=M.getCustomName(c))?N=M.getCalcSourceModel():(f=(N=U.Af.getGlobalSourceModel()||M.getCalcSourceModel()).getSource().getCustomName(c))||M.getCalcSourceModel().wg(c,!0).gmb(0,t,s),!(d=N.wg(c,!0)))return;d.gmb(0,t,s),f&&U.Ig(t,e,n,f,h,s,N.getSource())}else if(7===o.type){if(B=o.function){if(B.isVolatile()&&(s?U.bg(t):U.Tf(t)),!B.precedentReference())return;B instanceof r.Functions.AsyncFunction&&(U.Af.nia=!0)}for(G=o.arguments.length,u=0;u<G;u++)H=!1,B&&B.isBranch()&&B.findTestArgument()!==u&&t instanceof j&&(o.QDc=!0,o.RDc=o.RDc||[],o.RDc[u]=[],H=!0,t.LDc=t.LDc||[],t.LDc.push(o.RDc[u])),U.Ig(t,e,n,o.arguments[u],a&&7===a.type&&a.arguments[u],s),H&&t.LDc.pop()}else if(25===o.type||26===o.type){if(V=o,!(z=(N=(M=o.source||U.xf).getCalcSourceModel()).mg(V.value,!0)))return;z.gmb(0,t,s)}else 33===o.type&&((W=o).isReferenceError||(N=(M=W.source||W.contextSource||U.xf).getCalcSourceModel(),L=i.getRangeForReference(W,e,n),(S=N.qg(L.row,L.col,!0))&&S.gmb(0,t,s)))},t.prototype.Og=function(t,e){var n=this.getNodeByName(t);n&&(n.Nf||n.Lf)&&this.Ig(this.mg(t),0,0,n.Nf||n.Lf,n.Lf,e)},t.prototype.Pg=function(t,e,n,o,r){var i,a,s,l,u,c=this,f=t+n,h=e+o;for(l=t;l<f;l++)for(u=e;u<h;u++)i=c.Mf(l,u),a=c.Kf(l,u),(i||a)&&((s=c.Qf(l,u))&&!0!==s.isDynamicArray?c.Ig(c.qg(l,u),s.row,s.col,i||a,a,r):c.Ig(c.qg(l,u),l,u,i||a,a,r))},t.prototype.Qg=function(t,e,n){var o,r,i=t+e;for(o=t;-1!==o&&o<i;o++)(r=this.getColumnExpression(o))&&this.Ig(this.sg(o,!1),-1,o,r,r,n)},t.prototype.Rg=function(t,e,n,o){this.Pg(t,e,n,o,!0)},t.prototype.Sg=function(t,e,n,o){this.Pg(t,e,n,o,!1)},t.prototype.Tg=function(t,e){},t.prototype.Ug=function(t,e){},t.prototype.Vg=function(t,e){this.Qg(t,e,!0)},t.prototype.Wg=function(t,e){this.Qg(t,e,!1)},t.prototype.Xg=function(t,e,n,o,r,i,a){var s,l,u,c=t+n,f=e+o;for(s=t;s<c;s++)for(l=e;l<f;l++)(u=this.qg(s,l,!1))&&(this.FTa(a,s,l),r&&u.Yg(),i&&u.Bg())},t.prototype.Zg=function(t,e,n,o,r){var i,a,s,l,u=this.Hf;if(-1!==t&&u)for(i=A(t+e,u.length),a=t;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,a,-1),l=s.calc,n&&l.Yg(),o&&l.Bg())},t.prototype.$g=function(t,e,n,o,r){var i,a,s,l,u=this.If;if(-1!==t&&u)for(i=A(t+e,u.length),a=t;a<i;a++)(s=u[a])&&s.calc&&(this.FTa(r,-1,a),l=s.calc,n&&l.Yg(),o&&l.Bg())},t.prototype._g=function(t,e,n,o,r,i,a){var s,l,u,c;(r||i)&&(s=this,l=void 0,a&&(l=s.dUa()),0<=t&&0<=e?(s.Xg(t,e,n,o,r,i,l),s.Zg(t,n,r,i,l),s.$g(e,o,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,n,o),i&&s.vg.Bg(t,e,n,o))):0<=t&&-1===e?(s.Xg(t,0,n,s.cC(),r,i,l),s.Zg(t,n,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,n,o),i&&s.vg.Bg(t,e,n,o))):-1===t&&0<=e?(s.Xg(0,e,s.rC(),o,r,i,l),s.$g(e,o,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,n,o),i&&s.vg.Bg(t,e,n,o))):-1===t&&-1===e&&(u=s.rC(),c=s.cC(),s.Xg(0,0,u,c,r,i,l),s.Zg(0,u,r,i,l),s.$g(0,c,r,i,l),s.vg&&(r&&s.vg.Yg(t,e,n,o),i&&s.vg.Bg(t,e,n,o))))},t.prototype.getAllNodes=function(){var t,e,n,o,r=[],i=this.dataTable,a=this.Hf,s=this.If,l=this.Jf;for(e in l&&r.push(l),a)a.hasOwnProperty(e)&&((t=a[e])&&r.push(t));for(e in s)s.hasOwnProperty(e)&&((t=s[e])&&r.push(t));for(n in i)if(i.hasOwnProperty(n)&&(o=i[n]))for(e in o)o.hasOwnProperty(e)&&((t=o[e])&&r.push(t));return r},t.prototype.toJSON=function(t){e.supportRowColumnFormula?this.xf.toJSON(t,this.dataTable,this.Ef,this.Ff,this.If):this.xf.toJSON(t,this.dataTable,this.Ef,this.Ff)},t}(),e.CalcSourceModel=O,j=function(t){function e(e,n,o){var r=t.call(this,e)||this;return r.row=n,r.column=o,r.delay=0,r}return B(e,t),e.prototype.getKey=function(){var t=this,e=t.ah;return(null===e?"":e.xf.id+",")+t.row+","+t.column},e.prototype.og=function(){var t=this;t.ah.Rg(t.row,t.column,1,1)},e.prototype.ng=function(){var t=this;t.ah.Sg(t.row,t.column,1,1)},e.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,0)},e.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,0)},e.prototype.Bg=function(){var t,e,n,o,r,i,a,s,l=this.ah.Cf(),u=this.Ze;for(e=0;e<u.length;e++)if(n=this[u[e]])for(o in n)n.hasOwnProperty(o)&&(!(t=n[o])||t.dh||t.eh||t.fh(),l.calcOnDemand&&t&&!t.$l&&(t.$l=!0,t.Bg()));if((r=this.node&&this.node.Pf)&&r.isDynamicArray)for(i=0;i<r.rowCount;i++)for(a=i;a<r.colCount;a++)0===i&&0===a||(s=this.ah.getNode(i+r.row,a+r.col))&&s.calc&&s.calc.Bg()},e.prototype.y$a=function(){var t,e,n,o,r,i,a,s=this,l=s.ah,u=l.getCalcService();u&&u.nia&&(!(e=(t=s.nia)&&s.z$a)&&S(t)&&((n=l.getSource())&&(o=n.getName(),(r=u.lh.asyncManager.y5[o])&&((i=r[s.row])&&((a=i[s.column])&&((e=a[0])?(s.nia=!0,s.z$a=e,e.h_a=s):s.nia=!1))))),e&&0===e.evaluateMode&&(e.v5=!1))},e}(k),e.CellCalc=j,F=function(t){function e(e,n){var o=t.call(this,e)||this;return o.row=n,o}return B(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+this.row+",-1"},e.prototype.og=function(){this.ah.Tg(this.row,1)},e.prototype.ng=function(){this.ah.Ug(this.row,1)},e.prototype.Kg=function(t,e,n){n?function(t,e,n){t[e]||(t[e]=[]),t[e].push(n)}(this,I,{row:t,columnOffset:e,columnCount:1}):function(t,e,n){var o,r=t[e];if(r)for(o=0;o<r.length;o++)if(r[o]===n)return void r.splice(o,1)}(this,I,{row:t,columnOffset:e,columnCount:1})},e.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,1)},e.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,1)},e}(k),e.RowCalc=F,P=function(t){function e(e,n){var o=t.call(this,e)||this;return o.column=n,o}return B(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+"-1,"+this.column},e.prototype.og=function(){this.ah.Vg(this.column,1)},e.prototype.ng=function(){this.ah.Wg(this.column,1)},e.prototype.Mg=function(t,e,n){this.gmb(2,t,n)},e.prototype.bh=function(){this.ah.Cf().onAddAdjust(this,2)},e.prototype.fh=function(){this.$l=!0,this.ah.Cf().pg(this,2)},e}(k),e.ColumnCalc=P,_=function(t){function e(e,n){var o=t.call(this,e)||this;return o.name=n,o}return B(e,t),e.prototype.getKey=function(){var t=this.ah;return(null===t?"":t.xf.id+",")+this.name},e.prototype.updateListening=function(t,e){var n,o,r,i,a,s,l,u,c=this.Ze;for(r=0;r<c.length;r++)if(i=this[c[r]]){for(s in a=[],i)i.hasOwnProperty(s)&&((n=i[s])&&a.push(n));for(l=a.length,u=0;u<l;u++)o=(n=a[u]).node,n.ng(),o&&(!o.Pf||o.Pf.row===n.row&&o.Pf.col===n.column)&&n.ah.fg(n.row,n.column,o.Lf,o.Pf,!0)}},e.prototype.updateListeningOnRemoved=function(){var t,e,n,o,r,i,a,s,l,u,c=this,f=c.Ze,h=c.ah,d=h.Cf();for(i=0;i<f.length;i++)if(a=c[f[i]])for(s in a)a.hasOwnProperty(s)&&((t=a[s])&&(e=t.ah,n=t.row,o=t.col,n=n===p?-1:n,o=o===p?-1:o,r=e.Kf(n,o),l=e.Qf(n,o),r&&((u=d.ih().adjustFormulaOnRemoveName(h,r,c.name))!==r&&e.fg(n,o,u,l,!0))))},e.prototype.fh=function(){var t,e,n,o,r=this.Ze;for(e=0;e<r.length;e++)if(n=this[r[e]])for(o in n)n.hasOwnProperty(o)&&((t=n[o])&&t.fh())},e}(k),e.NameCalc=_,L=function(t){function e(e){return t.call(this,e)||this}return B(e,t),e.prototype.processListener=function(t,e,n,o,r,i,a){var s,l,u,c=this,f=c[t],h=e+","+n+","+o+","+r;if(3!==t||i instanceof M){if(i.LDc&&i.LDc.length>=1&&((u=i.LDc)[u.length-1].push(this),h="?"+h),f||(c.Ze.push(t),c[t]=f={}),!(s=f[h])){if(!a)return;(s=f[h]=[]).row=e,s.col=n,s.rowCount=o,s.colCount=r}if(a){for(l=0;l<s.length;l++)if(s[l]===i)return;s.push(i)}else{for(l=0;l<s.length;l++)s[l]===i&&s.splice(l,1);s.length<1&&delete f[h]}c.clearListenersCache()}},e.prototype.Jg=function(t,e,n,o,r,i){this.processListener(0,t,e,n,o,r,i)},e.prototype.Xoa=function(t,e,n,o,r,i){this.processListener(3,t,e,n,o,r,i)},e.prototype.Yg=function(t,e,n,o){this.visit(0,t,e,n,o)},e.prototype.clearListenersCache=function(){var t,e=this.Ze;for(t=0;t<e.length;t++)delete this[e[t]+"cached"]},e.prototype.getListeners=function(t,e){var n,o,r,i,a=t[e],s=this[a];if(s&&!(n=this[o=a+"cached"]))for(r in n=this[o]=[],s)s.hasOwnProperty(r)&&((i=s[r])&&n.push(i));return n},e.prototype.visit=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,d,g,m,y,v=this.Ze;for(a=0;a<v.length;a++)if(this[v[a]])for(s=this.getListeners(v,a),l=0;l<s.length;l++)if(c=(u=s[l]).row,f=u.col,h=u.rowCount,p=u.colCount,(-1===c||-1===e||c<e+o&&e<c+h)&&(-1===f||-1===n||f<n+r&&n<f+p))for(d=u.length,g=0;g<d;g++)if(i=u[g],0===t){if(y=(m=this.ah.getSource()).getRangeKey&&m.getRangeKey(m,u),i._indirectRanges&&i._indirectRanges[y]){i.fh();continue}i.bh()}else i.fh()},e.prototype.Bg=function(t,e,n,o){this.visit(1,t,e,n,o)},e.prototype.gh=function(t,e,n){var o,r,i,a,s,l,u,c=this.Ze,f=n?1:-1;for(r=0;r<c.length;r++)if(this[c[r]])for(i=this.getListeners(c,r),a=0;a<i.length;a++)if((o=s=i[a])&&(-1===o.row||o.row<=t&&t<o.row+o.rowCount)&&(-1===o.col||o.col<=e&&e<o.col+o.colCount))for(l=s.length,u=0;u<l;u++)s[u].delay+=f},e.prototype.og=function(){},e.prototype.ng=function(){},e}(k),e.RangeCalc=L,e.Mh=Y,e.pf=Z,e.qf=Q},"./src/calcEngine.res.en.ts":function(t,e,n){"use strict";function o(t,e){return{description:t,parameters:e}}function r(t,e){return{name:t,repeatable:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.resource={Exp_InvalidCast:"Invalid Cast Exception",Exp_FormulaInvalidChar:"The formula contains an invalid character: '{0}' at index on {1}",Exp_FormulaInvalid:"Invalid Formula",Exp_InvalidFunctionName:"Invalid function name",Exp_InvalidOverrideFunction:"Cannot override built-in function",Exp_InvalidArray:"Invalid array",Exp_OverrideNotAllowed:"Attempt to override function while override is not allowed",Exp_NoSyntax:"No syntax '{0}' to match the syntax '{1}'.",Exp_IsValid:"'{0}' is invalid.",Exp_InvalidParameters:"Invalid function parameter at {0}.",Exp_InvalidArrayColumns:"The length of array columns are not equal at {0}.",Exp_ExprIsNull:"The argument 'expr' is null",Exp_InvalidOperation:"Invalid Operation Exception",Exp_ArgumentNull:"Argument Null Exception",Exp_CriteriaIsNull:"Criteria is null",Exp_Format:"Format",Exp_ArrayFromulaPart:"Cannot change part of an array.",Exp_NotSupported:"Not Supported Exception",_h:{ABS:o("This function calculates the absolute value of the specified value.",[r("value")]),ACCRINT:o("This function calculates the accrued interest for a security that pays periodic interest.",[r("issue"),r("first"),r("settle"),r("rate"),r("par"),r("frequency"),r("basis")]),ACCRINTM:o("This function calculates the accrued interest at maturity for a security that pays periodic interest.",[r("issue"),r("maturity"),r("rate"),r("par"),r("basis")]),ACOS:o("This function calculates the arccosine, that is, the angle whose cosine is the specified value.",[r("value")]),ACOSH:o("This function calculates the inverse hyperbolic cosine of the specified value.",[r("value")]),ADDRESS:o("This function uses the row and column numbers to create a cell address in text.",[r("row"),r("column"),r("absnum"),r("a1style"),r("sheettext")]),AGGREGATE:o("This function aggregate a list of numbers using a specified built-in function.",[r("functioncode"),r("option"),r("value1"),r("value2",!0)]),AMORDEGRC:o("This function returns the depreciation for an accounting period, taking into consideration prorated depreciation, and applies a depreciation coefficient in the calculation based on the life of the assets.",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AMORLINC:o("This function calculates the depreciation for an accounting period, taking into account prorated depreciation.",[r("cost"),r("datepurchased"),r("firstperiod"),r("salvage"),r("period"),r("drate"),r("basis")]),AND:o("Check whether all arguments are True, and returns True if all arguments are True.",[r("logical1"),r("logical2")]),ASIN:o("This function calculates the arcsine, that is, the angle whose sine is the specified value.",[r("value")]),ASINH:o("This function calculates the inverse hyperbolic sine of a number.",[r("value")]),ATAN:o("This function calculates the arctangent, that is, the angle whose tangent is the specified value.",[r("value")]),ATAN2:o("This function calculates the arctangent of the specified x- and y-coordinates.",[r("x"),r("y")]),ATANH:o("This function calculates the inverse hyperbolic tangent of a number.",[r("value")]),AVEDEV:o("This function calculates the average of the absolute deviations of the specified values from their mean.",[r("value1"),r("value2",!0)]),AVERAGE:o("This function calculates the average of the specified numeric values.",[r("value1"),r("value2",!0)]),AVERAGEA:o("This function calculates the average of the specified values, including text or logical values as well as numeric values.",[r("value1"),r("value2",!0)]),AVERAGEIF:o("This function calculates the average of the specified numeric values provided that they meet the specified criteria.",[r("value1"),r("value2",!0),r("condition")]),AVERAGEIFS:o("This function calculates the average of all cells that meet multiple specified criteria.",[r("value1"),r("condition1"),r("value2",!0),r("condition2",!0)]),BESSELI:o("This function calculates the modified Bessel function of the first kind evaluated for purely imaginary arguments.",[r("value"),r("order")]),BESSELJ:o("This function calculates the Bessel function of the first kind.",[r("value"),r("order")]),BESSELK:o("This function calculates the modified Bessel function of the second kind evaluated for purely imaginary arguments.",[r("value"),r("order")]),BESSELY:o("This function calculates the Bessel function of the second kind.",[r("value"),r("order")]),BETADIST:o("This function calculates the cumulative beta distribution function.",[r("x"),r("alpha"),r("beta"),r("lower"),r("upper")]),BETAINV:o("This function calculates the inverse of the cumulative beta distribution function.",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),BIN2DEC:o("This function converts a binary number to a decimal number",[r("number")]),BIN2HEX:o("This function converts a binary number to a hexadecimal number.",[r("number"),r("places")]),BIN2OCT:o("This function converts a binary number to an octal number.",[r("number"),r("places")]),BINOMDIST:o("This function calculates the individual term binomial distribution probability.",[r("x"),r("n"),r("p"),r("cumulative")]),CEILING:o("This function rounds a number up to the nearest multiple of a specified value.",[r("value"),r("signif")]),CHAR:o("This function returns the character specified by a number.",[r("value")]),CHIDIST:o("This function calculates the one-tailed probability of the chi-squared distribution.",[r("value"),r("deg")]),CHIINV:o("This function calculates the inverse of the one-tailed probability of the chi-squared distribution",[r("prob"),r("deg")]),CHITEST:o("This function calculates the test for independence from the chi-squared distribution.",[r("obs_array"),r("exp_array")]),CHOOSE:o("This function returns a value from a list of values.",[r("index"),r("value1"),r("value2",!0)]),CLEAN:o("This function removes all non-printable characters from text.",[r("text")]),CODE:o("This function returns a numeric code to represent the first character in a text string. The returned code corresponds to the Windows character set (ANSI).",[r("text")]),COLUMN:o("This function returns the column number of a reference.",[r("reference")]),COLUMNS:o("This function returns the number of columns in an array.",[r("array")]),COMBIN:o("This function calculates the number of possible combinations for a specified number of items.",[r("k"),r("n")]),COMPLEX:o("This function converts real and imaginary coefficients into a complex number.",[r("realcoeff"),r("imagcoeff"),r("suffix")]),CONCATENATE:o("This function combines multiple text strings or numbers into one text string.",[r("text1"),r("text2",!0)]),CONFIDENCE:o("This function returns confidence interval for a population mean.",[r("alpha"),r("stdev"),r("size")]),CONVERT:o("This function converts a number from one measurement system to its equivalent in another measurement system.",[r("number"),r("from-unit"),r("to-unit")]),CORREL:o("This function returns the correlation coefficient of the two sets of data.",[r("array1"),r("array2")]),COS:o("This function returns the cosine of the specified angle.",[r("angle")]),COSH:o("This function returns the hyperbolic cosine of the specified value.",[r("value")]),COUNT:o("This function returns the number of cells that contain numbers.",[r("value1"),r("value2",!0)]),COUNTA:o("This function returns the number of number of cells that contain numbers, text, or logical values.",[r("value1"),r("value2",!0)]),COUNTBLANK:o("This function returns the number of empty (or blank) cells in a range of cells on a sheet.",[r("cellrange")]),COUNTIF:o("This function returns the number of cells that meet a certain condition",[r("cellrange"),r("condition")]),COUNTIFS:o("This function returns the number of cells that meet multiple conditions.",[r("cellrange"),r("condition")]),COUPDAYBS:o("This function calculates the number of days from the beginning of the coupon period to the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYS:o("This function returns the number of days in the coupon period that contains the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPDAYSNC:o("This function calculates the number of days from the settlement date to the next coupon date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPNCD:o("This function returns a date number of the next coupon date after the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basi")]),COUPNUM:o("This function returns the number of coupons due between the settlement date and maturity date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COUPPCD:o("This function returns a date number of the previous coupon date before the settlement date.",[r("settlement"),r("maturity"),r("frequency"),r("basis")]),COVAR:o("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),CRITBINOM:o("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[r("n"),r("p"),r("alpha")]),CUMIPMT:o("This function returns the cumulative interest paid on a loan between the starting and ending periods.",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),CUMPRINC:o("This function returns the cumulative principal paid on a loan between the start and end periods.",[r("rate"),r("nper"),r("pval"),r("startperiod"),r("endperiod"),r("paytype")]),DATE:o("This function returns the DateTime object for a particular date, specified by the year, month, and day.",[r("year"),r("month"),r("day")]),DATEDIF:o("This function returns the number of days, months, or years between two dates.",[r("date1"),r("date2"),r("outputcode")]),DATEVALUE:o("This function returns a DateTime object of the specified date.",[r("date_string")]),DAVERAGE:o("This function calculates the average of values in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DAY:o("This function returns the day number of the month (integer 1 to 31) that corresponds to the specified date.",[r("date")]),DAYS360:o("This function returns the number of days between two dates based on a 360-day year.",[r("startdate"),r("enddate"),r("method")]),DB:o("This function calculates the depreciation of an asset for a specified period using the fixedâdeclining balance method",[r("cost"),r("salvage"),r("life"),r("period"),r("month")]),DCOUNT:o("This function counts the cells that contain numbers in a column of a list or database that match the specified conditions",[r("database"),r("field"),r("criteria")]),DCOUNTA:o("This function counts the non-blank cells in a column of a list or database that match the specified conditions",[r("database"),r("field"),r("criteria")]),DDB:o("This function calculates the depreciation of an asset for a specified period using the double-declining balance method or another method you specify.",[r("cost"),r("salvage"),r("life"),r("period"),r("factor")]),DEC2BIN:o("This function converts a decimal number to a binary number.",[r("number"),r("places")]),DEC2HEX:o("This function converts a decimal number to a hexadecimal number",[r("number"),r("places")]),DEC2OCT:o("This function converts a decimal number to an octal number",[r("number"),r("places")]),DEGREES:o("This function converts the specified value from radians to degrees",[r("angle")]),DELTA:o("This function identifies whether two values are equal. Returns 1 if they are equal; returns 0 otherwise.",[r("value1"),r("value2")]),DEVSQ:o("This function calculates the sum of the squares of deviations of data points (or of an array of data points) from their sample mean.",[r("value1"),r("value2",!0)]),DGET:o("This function extracts a single value from a column of a list or database that matches the specified conditions.",[r("database"),r("field"),r("criteria")]),DISC:o("This function calculates the discount rate for a security.",[r("settle"),r("mature"),r("pricep"),r("redeem"),r("basis")]),DMAX:o("This function returns the largest number in a column of a list or database that matches the specified conditions.",[r("database"),r("field"),r("criteria")]),DMIN:o("This function returns the smallest number in a column of a list or database that matches the specified conditions.",[r("database"),r("field"),r("criteria")]),DOLLAR:o("This function converts a number to text using currency format, with the decimals rounded to the specified place.",[r("value"),r("digits")]),DOLLARDE:o("This function converts a fraction dollar price to a decimal dollar price.",[r("fractionaldollar"),r("fraction")]),DOLLARFR:o("This function converts a decimal number dollar price to a fraction dollar price.",[r("decimaldollar"),r("fraction")]),DPRODUCT:o("This function multiplies the values in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DSTDEV:o("This function estimates the standard deviation of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DSTDEVP:o("This function calculates the standard deviation of a population based on the entire population using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DSUM:o("This function adds the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DURATION:o("This function returns the Macaulay duration for an assumed par value of $100.",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),DVAR:o("This function estimates the variance of a population based on a sample by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),DVARP:o("This function calculates the variance of a population based on the entire population by using the numbers in a column of a list or database that match the specified conditions.",[r("database"),r("field"),r("criteria")]),EDATE:o("This function calculates the date that is the indicated number of months before or after a specified date.",[r("startdate"),r("months")]),EFFECT:o("This function calculates the effective annual interest rate for a given nominal annual interest rate and the number of compounding periods per year.",[r("nomrate"),r("comper")]),EOMONTH:o("This function calculates the date for the last day of the month (end of month) that is the indicated number of months before or after the starting date.",[r("startdate"),r("months")]),ERF:o("This function calculates the error function integrated between a lower and an upper limit.",[r("limit"),r("upperlimit")]),ERFC:o("This function calculates the complementary error function integrated between a lower limit and infinity.",[r("lowerlimit")]),"ERROR.TYPE":o("This function returns a number corresponding to one of the error values.",[r("errorvalue")]),EURO:o("This function returns the equivalent of one Euro based on the ISO currency code.",[r("code")]),EUROCONVERT:o("This function converts currency from a Euro member currency (including Euros) to another Euro member currency (including Euros).",[r("currency"),r("source"),r("target"),r("fullprecision"),r("triangulation")]),EVEN:o("This function rounds the specified value up to the nearest even integer.",[r("value")]),EXACT:o("This function returns true if two strings are the same; otherwise, false.",[r("text1"),r("text2")]),EXP:o("This function returns e raised to the power of the specified value.",[r("value")]),EXPONDIST:o("This function returns the exponential distribution or the probability density.",[r("value"),r("lambda"),r("cumulative")]),FACT:o("This function calculates the factorial of the specified number.",[r("number")]),FACTDOUBLE:o("This function calculates the double factorial of the specified number.",[r("number")]),FALSE:o("This function returns the value for logical FALSE.",[]),FDIST:o("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[r("value"),r("degnum"),r("degden")]),FIND:o("This function finds one text value within another and returns the text valueâs position in the text you searched.",[r("findtext"),r("intext"),r("start")]),FINV:o("This function returns the inverse of the F probability distribution.",[r("p"),r("degnum"),r("degden")]),FISHER:o("This function returns the Fisher transformation for a specified value.",[r("value")]),FISHERINV:o("This function returns the inverse of the Fisher transformation for a specified value.",[r("value")]),FIXED:o("This function rounds a number to the specified number of decimal places, formats the number in decimal format using a period and commas (if so specified), and returns the result as text.",[r("num"),r("digits"),r("notcomma")]),FLOOR:o("This function rounds a number down to the nearest multiple of a specified value.",[r("value"),r("signif")]),FORECAST:o("This function calculates a future value using existing values.",[r("value"),r("Yarray"),r("Xarray")]),FREQUENCY:o("This function calculates how often values occur within a range of values. This function returns a vertical array of numbers.",[r("dataarray"),r("binarray")]),FTEST:o("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[r("array1"),r("array2")]),FV:o("This function returns the future value of an investment based on a present value, periodic payments, and a specified interest rate.",[r("rate"),r("numper"),r("paymt"),r("pval"),r("type")]),FVSCHEDULE:o("This function returns the future value of an initial principal after applying a series of compound interest rates. Calculate future value of an investment with a variable or adjustable rate.",[r("principal"),r("schedule")]),GAMMADIST:o("This function returns the gamma distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),GAMMAINV:o("This function returns the inverse of the gamma cumulative distribution.",[r("p"),r("alpha"),r("beta")]),GAMMALN:o("This function returns the natural logarithm of the Gamma function, G(x).",[r("value")]),GCD:o("This function returns the greatest common divisor of two numbers.",[r("number1"),r("number2")]),GEOMEAN:o("This function returns the geometric mean of a set of positive data.",[r("value1"),r("value2",!0)]),GESTEP:o("This function, greater than or equal to step, returns an indication of whether a number is equal to a threshold.",[r("number"),r("step")]),GROWTH:o("This function calculates predicted exponential growth. This function returns the y values for a series of new x values that are specified by using existing x and y values.",[r("y"),r("x"),r("newx"),r("constant")]),HARMEAN:o("This function returns the harmonic mean of a data set.",[r("value1"),r("value2",!0)]),HEX2BIN:o("This function converts a hexadecimal number to a binary number.",[r("number"),r("places")]),HEX2DEC:o("This function converts a hexadecimal number to a decimal number.",[r("number")]),HEX2OCT:o("This function converts a hexadecimal number to an octal number.",[r("number"),r("places")]),HLOOKUP:o("This function searches for a value in the top row and then returns a value in the same column from a specified row.",[r("value"),r("array"),r("row"),r("approx")]),HOUR:o("This function returns the hour that corresponds to a specified time.",[r("time")]),HYPGEOMDIST:o("This function returns the hypergeometric distribution.",[r("x"),r("n"),r("M"),r("N")]),IF:o("This function performs a comparison and returns one of two provided values based on that comparison.",[r("valueTest"),r("valueTrue"),r("valueFalse")]),IFERROR:o("This function evaluates a formula and returns a value you provide if there is an error or the formula result.",[r("value"),r("error")]),IMABS:o("This function returns the absolute value or modulus of a complex number.",[r("complexnum")]),IMAGINARY:o("This function returns the imaginary coefficient of a complex number.",[r("complexnum")]),IMARGUMENT:o("This function returns the argument theta, which is an angle expressed in radians.",[r("complexnum")]),IMCONJUGATE:o("This function returns the complex conjugate of a complex number.",[r("complexnum")]),IMCOS:o("This function returns the cosine of a complex number.",[r("complexnum")]),IMDIV:o("This function returns the quotient of two complex numbers.",[r("complexnum"),r("complexdenom")]),IMEXP:o("This function returns the exponential of a complex number.",[r("complexnum")]),IMLN:o("This function returns the natural logarithm of a complex number.",[r("complexnum")]),IMLOG2:o("This function returns the base-2 logarithm of a complex number.",[r("complexnum")]),IMLOG10:o("This function returns the common logarithm of a complex number.",[r("complexnum")]),IMPOWER:o("This function returns a complex number raised to a power.",[r("complexnum"),r("powernum")]),IMPRODUCT:o("This function returns the product of up to 29 complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2",!0)]),IMREAL:o("This function returns the real coefficient of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSIN:o("This function returns the sine of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSQRT:o("This function returns the square root of a complex number in the x+yi or x+yj text format.",[r("complexnum")]),IMSUB:o("This function returns the difference of two complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2")]),IMSUM:o("This function returns the sum of two or more complex numbers in the x+yi or x+yj text format.",[r("complexnum1"),r("complexnum2",!0)]),INDEX:o("This function returns a value or the reference to a value from within an array or range.",[r("return"),r("row"),r("col"),r("area")]),INDIRECT:o("This function returns the reference specified by a text string. References are immediately evaluated to display their contents.",[r("ref_text"),r("a1_style")]),INT:o("This function rounds a specified number down to the nearest integer.",[r("value")]),INTERCEPT:o("This function returns the coordinates of a point at which a line intersects the y-axis, by using existing x values and y values.",[r("dependent"),r("independent")]),INTRATE:o("This function calculates the interest rate for a fully invested security.",[r("settle"),r("mature"),r("invest"),r("redeem"),r("basis")]),IPMT:o("This function calculates the payment of interest on a loan.",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),IRR:o("This function returns the internal rate of return for a series of cash flows represented by the numbers in an array.",[r("arrayvals"),r("estimate")]),ISBLANK:o("This function tests whether a value, an expression, or contents of a referenced cell is empty.",[r("cellreference")]),ISERR:o("This function, Is Error Other Than Not Available, tests whether a value, an expression, or contents of a referenced cell has an error other than not available (#N/A).",[r("cellreference")]),ISERROR:o("This function, Is Error of Any Kind, tests whether a value, an expression, or contents of a referenced cell has an error of any kind.",[r("cellreference")]),ISEVEN:o("This function, Is Number Even, tests whether a value, an expression, or contents of a referenced cell is even.",[r("cellreference")]),ISLOGICAL:o("This function tests whether a value, an expression, or contents of a referenced cell is a logical (Boolean) value.",[r("cellreference")]),ISNA:o("This function, Is Not Available, tests whether a value, an expression, or contents of a referenced cell has the not available (#N/A) error value.",[r("cellreference")]),ISNONTEXT:o("This function tests whether a value, an expression, or contents of a referenced cell has any data type other than text.",[r("cellreference")]),ISNUMBER:o("This function tests whether a value, an expression, or contents of a referenced cell has numeric data.",[r("cellreference")]),ISODD:o("This function, Is Number Odd, tests whether a value, an expression, or contents of a referenced cell has numeric data.",[r("cellreference")]),ISPMT:o("This function calculates the interest paid during a specific period of an investment.",[r("rate"),r("per"),r("nper"),r("pv")]),ISREF:o("This function, Is Reference, tests whether a value, an expression, or contents of a referenced cell is a reference to another cell.",[r("cellreference")]),ISTEXT:o("This function tests whether a value, an expression, or contents of a referenced cell has text data.",[r("cellreference")]),KURT:o("This function returns the kurtosis of a data set.",[r("value1"),r("value2"),r("value3"),r("value4",!0)]),LARGE:o("This function returns the nth largest value in a data set, where n is specified.",[r("array"),r("n")]),LCM:o("This function returns the least common multiple of two numbers.",[r("number1"),r("number2")]),LEFT:o("This function returns the specified leftmost characters from a text value, and based on the number of characters you specify.",[r("mytext"),r("num_chars")]),LEN:o("This function returns the length of the number of characters in a text string.",[r("value")]),LINEST:o("This function calculates the statistics for a line.",[r("y"),r("x"),r("constant"),r("stats")]),LN:o("This function returns the natural logarithm of the specified number.",[r("value")]),LOG:o("This function returns the logarithm base Y of a number X.",[r("number"),r("base")]),LOG10:o("This function returns the logarithm base 10 of the number given.",[r("value")]),LOGEST:o("This function calculates an exponential curve that fits the data and returns an array of values that describes the curve.",[r("y"),r("x"),r("constant"),r("stats")]),LOGINV:o("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),LOGNORMDIST:o("This function returns the cumulative natural log normal distribution of x, where LN(x) is normally distributed with the specified mean and standard deviation. Analyze data that has been logarithmically transformed with this function.",[r("x"),r("mean"),r("stdev")]),LOOKUP:o("This function searches for a value and returns a value from the same location in a second area.",[r("lookupvalue"),r("lookupvector"),r("resultvector")]),LOWER:o("This function converts text to lower case letters.",[r("string")]),MATCH:o("This function returns the relative position of a specified item in a range.",[r("value1"),r("array"),r("type")]),XMATCH:o("This function returns the relative position of an item in an array. By default, an exact match is required.",[r("lookup_value"),r("lookup_array"),r("[match_mode]"),r("[search_mode]")]),XLOOKUP:o("This function searches a range or an array for a match and returns the corresponding item from a second range or array. By default, an exact match is used.",[r("lookup_value"),r("lookup_array"),r("return_array"),r("[if_not_found]"),r("[match_mode]"),r("[search_mode]")]),MAX:o("This function returns the maximum value, the greatest value, of all the values in the arguments.",[r("value1"),r("value2",!0)]),MAXA:o("This function returns the largest value in a list of arguments, including text and logical values.",[r("value1"),r("value2",!0)]),MDETERM:o("This function returns the matrix determinant of an array.",[r("array")]),MDURATION:o("This function calculates the modified Macaulay duration of a security with an assumed par value of $100.",[r("settlement"),r("maturity"),r("coupon"),r("yield"),r("frequency"),r("basis")]),MEDIAN:o("This function returns the median, the number in the middle of the provided set of numbers; that is, half the numbers have values that are greater than the median, and half have values that are less than the median.",[r("value1"),r("value2",!0)]),MID:o("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of characters you specify.",[r("text"),r("start_num"),r("num_chars")]),MIN:o("This function returns the minimum value, the least value, of all the values in the arguments.",[r("value1"),r("value2",!0)]),MINA:o("This function returns the minimum value in a list of arguments, including text and logical values.",[r("value1"),r("value2",!0)]),MINUTE:o("This function returns the minute corresponding to a specified time.",[r("time")]),MINVERSE:o("This function returns the inverse matrix for the matrix stored in an array.",[r("array")]),MIRR:o("This function returns the modified internal rate of return for a series of periodic cash flows.",[r("arrayvals"),r("payment_int"),r("income_int")]),MMULT:o("This function returns the matrix product for two arrays.",[r("array1"),r("array2")]),MOD:o("This function returns the remainder of a division operation.",[r("dividend"),r("divisor")]),MODE:o("This function returns the most frequently occurring value in a set of data.",[r("value1"),r("value2",!0)]),MONTH:o("This function returns the month corresponding to the specified date value.",[r("date")]),MROUND:o("This function returns a number rounded to the desired multiple.",[r("number"),r("multiple")]),MULTINOMIAL:o("This function calculates the ratio of the factorial of a sum of values to the product of factorials.",[r("value1"),r("value2",!0)]),MUNIT:o("The function returns the unit matrix for the specified dimension.",[r("dimension")]),N:o("This function returns a value converted to a number.",[r("value")]),NA:o("This function returns the error value #N/A that means not available.",[]),NEGBINOMDIST:o("This function returns the negative binomial distribution.",[r("x"),r("r"),r("p")]),NETWORKDAYS:o("This function returns the total number of complete working days between the start and end dates.",[r("startdate"),r("enddate"),r("holidays")]),NOMINAL:o("This function returns the nominal annual interest rate for a given effective rate and number of compounding periods per year.",[r("effrate"),r("comper")]),NORMDIST:o("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),NORMINV:o("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),NORMSDIST:o("This function returns the standard normal cumulative distribution function.",[r("value")]),NORMSINV:o("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[r("prob")]),NOT:o("This function reverses the logical value of its argument.",[r("value")]),NOW:o("This function returns the current date and time.",[]),NPER:o("This function returns the number of periods for an investment based on a present value, future value, periodic payments, and a specified interest rate.",[r("rate"),r("paymt"),r("pval"),r("fval"),r("type")]),NPV:o("This function calculates the net present value of an investment by using a discount rate and a series of future payments and income.",[r("discount"),r("value1"),r("value2",!0)]),OBJECT:o("This function converts the property/expression sequence to an object.",[r("property1|properties_range1"),r("expression1|expressions_range1"),r("property2|properties_range2"),r("expression2|expressions_range2"),r("...")]),OCT2BIN:o("This function converts an octal number to a binary number.",[r("number"),r("places")]),OCT2DEC:o("This function converts an octal number to a decimal number.",[r("number")]),OCT2HEX:o("This function converts an octal number to a hexadecimal number.",[r("number"),r("places")]),ODD:o("This function rounds the specified value up to the nearest odd integer.",[r("value")]),ODDFPRICE:o("This function calculates the price per $100 face value of a security with an odd first period.",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDFYIELD:o("This function calculates the yield of a security with an odd first period.",[r("settle"),r("maturity"),r("issue"),r("first"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),ODDLPRICE:o("This function calculates the price per $100 face value of a security with an odd last coupon period.",[r("settle"),r("maturity"),r("last"),r("rate"),r("yield"),r("redeem"),r("freq"),r("basis")]),ODDLYIELD:o("This function calculates the yield of a security with an odd last period.",[r("settle"),r("maturity"),r("last"),r("rate"),r("price"),r("redeem"),r("freq"),r("basis")]),OFFSET:o("This function returns a reference to a range. The range is a specified number of rows and columns from a cell or range of cells. The function returns a single cell or a range of cells.",[r("reference"),r("rows"),r("cols"),r("height"),r("width")]),OR:o("This function calculates logical OR. It returns TRUE if any of its arguments are true; otherwise, returns FALSE if all arguments are false.",[r("argument1"),r("argument2",!0)]),PEARSON:o("This function returns the Pearson product moment correlation coefficient, a dimensionless index between -1.0 to 1.0 inclusive indicative of the linear relationship of two data sets.",[r("array_ind"),r("array_dep")]),PERCENTILE:o("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),PERCENTRANK:o("This function returns the rank of a value in a data set as a percentage of the data set.",[r("array"),r("n"),r("sigdig")]),PERMUT:o("This function returns the number of possible permutations for a specified number of items.",[r("k"),r("n")]),PI:o("This function returns PI as 3.1415926536.",[]),PMT:o("This function returns the payment amount for a loan given the present value, specified interest rate, and number of terms.",[r("rate"),r("nper"),r("pval"),r("fval"),r("type")]),POISSON:o("This function returns the Poisson distribution.",[r("nevents"),r("mean"),r("cumulative")]),POWER:o("This function raises the specified number to the specified power.",[r("number"),r("power")]),PPMT:o("This function returns the amount of payment of principal for a loan given the present value, specified interest rate, and number of terms.",[r("rate"),r("per"),r("nper"),r("pval"),r("fval"),r("type")]),PRICE:o("This function calculates the price per $100 face value of a periodic interest security",[r("settlement"),r("maturity"),r("rate"),r("yield"),r("redeem"),r("frequency"),r("basis")]),PRICEDISC:o("This function returns the price per $100 face value of a discounted security.",[r("settle"),r("mature"),r("discount"),r("redeem"),r("basis")]),PRICEMAT:o("This function returns the price at maturity per $100 face value of a security that pays interest.",[r("settle"),r("mature"),r("issue"),r("rate"),r("yield"),r("basis")]),PROB:o("This function returns the probability that values in a range are between two limits.",[r("array"),r("probs"),r("lower"),r("upper")]),PRODUCT:o("This function multiplies all the arguments and returns the product.",[r("value1"),r("value2",!0)]),PROPER:o("This function capitalizes the first letter in each word of a text string.",[r("text")]),PROPERTY:o("This function returns the value of property path in object.",[r("data_expression"),r("property_path")]),PV:o("This function returns the present value of an investment based on the interest rate, number and amount of periodic payments, and future value. The present value is the total amount that a series of future payments is worth now.",[r("rate"),r("numper"),r("paymt"),r("fval"),r("type")]),QUARTILE:o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),QUOTIENT:o("This function returns the integer portion of a division. Use this to ignore the remainder of a division.",[r("numerator"),r("denominator")]),RADIANS:o("This function converts the specified number from degrees to radians.",[r("value")]),RAND:o("This function returns an evenly distributed random number between 0 and 1.",[]),RANDBETWEEN:o("This function returns a random number between the numbers you specify.",[r("lower"),r("upper")]),RANGEBLOCKSPARKLINE:o("This function returns a rangetemplate.",[r("template_range"),r("data_expression")]),RANK:o("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[r("number"),r("array"),r("order")]),RATE:o("This function returns the interest rate per period of an annuity.",[r("nper"),r("pmt"),r("pval"),r("fval"),r("type"),r("guess")]),RECEIVED:o("This function returns the amount received at maturity for a fully invested security.",[r("settle"),r("mature"),r("invest"),r("discount"),r("basis")]),REPLACE:o("This function replaces part of a text string with a different text string, based on the number of characters you specify.",[r("old_text"),r("start_char"),r("num_chars"),r("new_text")]),REPT:o("This function repeats text a specified number of times.",[r("text"),r("number")]),RIGHT:o("This function returns the specified rightmost characters from a text value, and based on the number of characters you specify.",[r("text"),r("num_chars")]),ROMAN:o("This function converts an Arabic numeral to a Roman numeral text equivalent.",[r("number"),r("style")]),ROUND:o("This function rounds the specified value to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROUNDDOWN:o("This function rounds the specified number down to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROUNDUP:o("This function rounds the specified number up to the nearest number, using the specified number of decimal places.",[r("value"),r("places")]),ROW:o("This function returns the number of a row from a reference.",[r("reference")]),ROWS:o("This function returns the number of rows in an array.",[r("array")]),RSQ:o("This function returns the square of the Pearson product moment correlation coefficient (R-squared) through data points in known y's and known x's.",[r("array_dep"),r("array_ind")]),SEARCH:o("This function finds one text string in another text string and returns the index of the starting position of the found text.",[r("string1"),r("string2")]),SECOND:o("This function returns the seconds (0 to 59) value for a specified time.",[r("time")]),SERIESSUM:o("This function returns the sum of a power series.",[r("x"),r("n"),r("m"),r("coeff")]),SIGN:o("This function returns the sign of a number or expression.",[r("cellreference")]),SIN:o("This function returns the sine of the specified angle.",[r("angle")]),SINH:o("This function returns the hyperbolic sine of the specified number.",[r("value")]),SKEW:o("This function returns the skewness of a distribution.",[r("number1"),r("number2",!0)]),SLN:o("This function returns the straight-line depreciation of an asset for one period.",[r("cost"),r("salvage"),r("life")]),SLOPE:o("This function calculates the slope of a linear regression.",[r("array_dep"),r("array_ind")]),SMALL:o("This function returns the nth smallest value in a data set, where n is specified.",[r("array"),r("n")]),SQRT:o("This function returns the positive square root of the specified number.",[r("value")]),SQRTPI:o("This function returns the positive square root of a multiple of pi (p).",[r("multiple")]),STANDARDIZE:o("This function returns a normalized value from a distribution characterized by mean and standard deviation.",[r("x"),r("mean"),r("stdev")]),STDEVA:o("This function returns the standard deviation for a set of numbers, text, or logical values.",[r("value1"),r("value2",!0)]),STDEVP:o("This function returns the standard deviation for an entire specified population (of numeric values).",[r("value1"),r("value2",!0)]),STDEVPA:o("This function returns the standard deviation for an entire specified population, including text or logical values as well as numeric values.",[r("value1"),r("value2",!0)]),STEYX:o("This function returns the standard error of the predicted y value for each x. The standard error is a measure of the amount of error in the prediction of y for a value of x.",[r("array_dep"),r("array_ind")]),SUBSTITUTE:o("This function substitutes a new string for specified characters in an existing string.",[r("text"),r("old_piece"),r("new_piece"),r("instance")]),SUBTOTAL:o("This function calculates a subtotal of a list of numbers using a specified built-in function.",[r("functioncode"),r("value1"),r("value2",!0)]),SUM:o("This function returns the sum of cells or range of cells.",[r("value1"),r("value2",!0)]),SUMIF:o("This function adds the cells using a given criteria.",[r("array"),r("condition"),r("sumrange")]),SUMIFS:o("This function adds the cells in a range using multiple criteria.",[r("array"),r("conditionarray"),r("condition",!0)]),SUMPRODUCT:o("This function returns the sum of products of cells. Multiplies corresponding components in the given arrays, and returns the sum of those products.",[r("array1"),r("array2",!0)]),SUMSQ:o("This function returns the sum of the squares of the arguments.",[r("value1"),r("value2",!0)]),SUMX2MY2:o("This function returns the sum of the difference of the squares of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SUMX2PY2:o("This function returns the sum of the sum of squares of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SUMXMY2:o("This function returns the sum of the square of the differences of corresponding values in two arrays.",[r("array_x"),r("array_y")]),SYD:o("This function returns the sum-of-years' digits depreciation of an asset for a specified period.",[r("cost"),r("salvage"),r("life"),r("period")]),T:o("This function returns the text in a specified cell.",[r("value")]),TAN:o("This function returns the tangent of the specified angle.",[r("angle")]),TANH:o("This function returns the hyperbolic tangent of the specified number.",[r("value")]),TBILLEQ:o("This function returns the equivalent yield for a Treasury bill (or T-bill)",[r("settle"),r("mature"),r("discount")]),TBILLPRICE:o("This function returns the price per $100 face value for a Treasury bill (or T-bill).",[r("settle"),r("mature"),r("discount")]),TBILLYIELD:o("This function returns the yield for a Treasury bill (or T-bill).",[r("settle"),r("mature"),r("priceper")]),TDIST:o("This function returns the probability for the t-distribution.",[r("x"),r("deg"),r("tails")]),TEXT:o("This function formats a number and converts it to text.",[r("value"),r("text")]),TIME:o("This function returns the TimeSpan object for a specified time.",[r("hour"),r("minutes"),r("seconds")]),TIMEVALUE:o("This function returns the TimeSpan object of the time represented by a text string.",[r("time_string")]),TINV:o("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[r("prog"),r("deg")]),TODAY:o("This function returns the date and time of the current date.",[]),TRANSPOSE:o("This function returns a vertical range of cells as a horizontal range or a horizontal range of cells as a vertical range.",[r("array")]),TREND:o("This function returns values along a linear trend. This function fits a straight line to the arrays known x and y values. Trend returns the y values along that line for the array of specified new x values.",[r("y"),r("x"),r("newx"),r("constant")]),TRIM:o("This function removes extra spaces from a string and leaves single spaces between words.",[r("text")]),TRIMMEAN:o("This function returns the mean of a subset of data excluding the top and bottom data.",[r("array"),r("percent")]),TRUE:o("This function returns the value for logical TRUE.",[]),TRUNC:o("This function removes the specified fractional part of the specified number.",[r("value"),r("precision")]),TTEST:o("This function returns the probability associated with a t-test.",[r("array1"),r("array2"),r("tails"),r("type")]),TYPE:o("This function returns the type of value.",[r("value")]),UPPER:o("This function converts text to uppercase letters.",[r("string")]),VALUE:o("This function converts a text string that is a number to a numeric value.",[r("text")]),VAR:o("This function returns the variance based on a sample of a population, which uses only numeric values.",[r("value1"),r("value2",!0)]),VARA:o("This function returns the variance based on a sample of a population, which includes numeric, logical, or text values.",[r("value1"),r("value2",!0)]),VARP:o("This function returns variance based on the entire population, which uses only numeric values.",[r("value1"),r("value2",!0)]),VARPA:o("This function returns variance based on the entire population, which includes numeric, logical, or text values.",[r("value1"),r("value2",!0)]),VDB:o("This function returns the depreciation of an asset for any period you specify using the variable declining balance method.",[r("cost"),r("salvage"),r("life"),r("start"),r("end"),r("factor"),r("switchnot")]),VLOOKUP:o("This function searches for a value in the leftmost column and returns a value in the same row from a column you specify.",[r("value"),r("array"),r("colindex"),r("approx")]),WEEKDAY:o("This function returns the number corresponding to the day of the week for a specified date.",[r("date"),r("type")]),WEEKNUM:o("This function returns a number that indicates the week of the year numerically.",[r("date"),r("weektype")]),WEIBULL:o("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),WORKDAY:o("This function returns the number of working days before or after the starting date.",[r("startdate"),r("numdays"),r("holidays")]),XIRR:o("This function calculates the internal rate of return for a schedule of cash flows that may not be periodic.",[r("values"),r("dates"),r("guess")]),XNPV:o("This function calculates the net present value for a schedule of cash flows that may not be periodic.",[r("rate"),r("values"),r("dates")]),YEAR:o("This function returns the year as an integer for a specified date.",[r("date")]),YEARFRAC:o("This function returns the fraction of the year represented by the number of whole days between the start and end dates.",[r("startdate"),r("enddate"),r("basis")]),YIELD:o("This function calculates the yield on a security that pays periodic interest.",[r("settle"),r("maturity"),r("rate"),r("price"),r("redeem"),r("frequency"),r("basis")]),YIELDDISC:o("This function calculates the annual yield for a discounted security.",[r("settle"),r("maturity"),r("price"),r("redeem"),r("basis")]),YIELDMAT:o("This function calculates the annual yield of a security that pays interest at maturity.",[r("settle"),r("maturity"),r("issue"),r("issrate"),r("price"),r("basis")]),ZTEST:o("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[r("array"),r("x"),r("sigma")]),HBARSPARKLINE:o("This function returns a data set used for representing a Hbar sparkline",[r("value"),r("colorScheme"),r("axisVisible"),r("barHeight")]),VBARSPARKLINE:o("This function returns a data set used for representing a Vbar sparkline",[r("value"),r("colorScheme"),r("axisVisible"),r("barWidth")]),VARISPARKLINE:o("This function returns a data set used for representing a variance sparkline",[r("variance"),r("reference"),r("mini"),r("maxi"),r("mark"),r("tickunit"),r("legend"),r("colorPositive"),r("colorNegative"),r("vertical")]),PIESPARKLINE:o("This function returns a data set used for representing a pie sparkline",[r("range|percentage"),r("color",!0)]),AREASPARKLINE:o("This function returns a data set used for representing a area sparkline",[r("points"),r("mini"),r("maxi"),r("line1"),r("line2"),r("colorPositive"),r("colorNegative")]),SCATTERSPARKLINE:o("This function returns a data set used for representing a scatter sparkline",[r("points1"),r("points2"),r("minX"),r("maxX"),r("minY"),r("maxY"),r("hLine"),r("vLine"),r("xMinZone"),r("xMaxZone"),r("yMinZone"),r("yMaxZone"),r("tags"),r("drawSymbol"),r("drawLines"),r("color1"),r("color2"),r("dash")]),LINESPARKLINE:o("This function returns a data set used for representing a line sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),COLUMNSPARKLINE:o("This function returns a data set used for representing a column sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),WINLOSSSPARKLINE:o("This function returns a data set used for representing a win/loss sparkline",[r("data"),r("dataOrientation"),r("dateAxisData"),r("dateAxisOrientation"),r("setting")]),BULLETSPARKLINE:o("This function returns a data set used for representing a bullet sparkline",[r("measure"),r("target"),r("maxi"),r("good"),r("bad"),r("forecast"),r("tickunit"),r("colorScheme"),r("vertical"),r("measureColor"),r("targetColor"),r("maxiColor"),r("goodColor"),r("badColor"),r("forecastColor"),r("allowMeasureOverMaxi"),r("barSize")]),SPREADSPARKLINE:o("This function returns a data set used for representing a spread sparkline",[r("points"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("style"),r("colorScheme"),r("vertical")]),STACKEDSPARKLINE:o("This function returns a data set used for representing a stacked sparkline",[r("points"),r("colorRange"),r("labelRange"),r("maximum"),r("targetRed"),r("targetGreen"),r("targetBlue"),r("tragetYellow"),r("color"),r("highlightPosition"),r("vertical"),r("textOrientation"),r("textSize")]),BOXPLOTSPARKLINE:o("This function returns a data set used for representing a boxplot sparkline",[r("points"),r("boxPlotClass"),r("showAverage"),r("scaleStart"),r("scaleEnd"),r("acceptableStart"),r("acceptableEnd"),r("colorScheme"),r("style"),r("vertical")]),CASCADESPARKLINE:o("This function returns a data set used for representing a cascade sparkline",[r("pointsRange"),r("pointIndex"),r("labelsRange"),r("minimum"),r("maximum"),r("colorPositive"),r("colorNegative"),r("vertical"),r("itemTypeRange"),r("colorTotal")]),PARETOSPARKLINE:o("This function returns a data set used for representing a pareto sparkline",[r("points"),r("pointIndex"),r("colorRange"),r("target"),r("target2"),r("highlightPosition"),r("label"),r("vertical"),r("targetColor"),r("target2Color"),r("labelColor"),r("barSize")]),MONTHSPARKLINE:o("This function returns a data set used for representing a month sparkline",[r("year"),r("month"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),YEARSPARKLINE:o("This function returns a data set used for representing a year sparkline",[r("year"),r("dataRange"),r("emptyColor"),r("startColor"),r("middleColor"),r("endColor")]),"CEILING.PRECISE":o("This function rounds a number up to the nearest integer or to the nearest multiple of a specified value.",[r("number"),r("signif")]),"COVARIANCE.S":o("This function returns the sample covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),"FLOOR.PRECISE":o("This function rounds a number down to the nearest integer or to the nearest multiple of a specified value.",[r("number"),r("signif")]),"PERCENTILE.EXC":o("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),"QUARTILE.EXC":o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),"RANK.AVG":o("This function returns the rank of a number in a set of numbers. If some values have the same rank, it will return the average rank.",[r("number"),r("array"),r("order")]),"MODE.MULT":o("This function returns the most frequently occurring vertical array or the most frequently occurring value in a set of data.",[r("number1"),r("number2",!0)]),"STDEV.P":o("This function returns the standard deviation for an entire specified population (of numeric values).",[r("value1"),r("value2",!0)]),"VAR.P":o("This function returns variance based on the entire population, which uses only numeric values.",[r("value1"),r("value2",!0)]),"COVARIANCE.P":o("This function returns the covariance, which is the average of the products of deviations for each data point pair in two sets of numbers.",[r("array1"),r("array2")]),"MODE.SNGL":o("This function returns the most frequently occurring value in a set of data.",[r("value1"),r("value2",!0)]),"PERCENTILE.INC":o("This function returns the nth percentile of values in a range.",[r("array"),r("n")]),"QUARTILE.INC":o("This function returns which quartile (which quarter or 25 percent) of a data set a value is.",[r("array"),r("quart")]),"RANK.EQ":o("This function returns the rank of a number in a set of numbers. If you were to sort the set, the rank of the number would be its position in the list.",[r("number"),r("array"),r("order")]),STDEV:o("This function returns standard deviation is estimated based on a sample.",[r("number1"),r("number2",!0)]),"STDEV.S":o("This function returns standard deviation is estimated based on a sample.",[r("number1"),r("number2",!0)]),"VAR.S":o("This function returns the variance based on a sample of a population, which uses only numeric values.",[r("value1"),r("value2",!0)]),"BETA.INV":o("This function calculates the inverse of the cumulative beta distribution function.",[r("prob"),r("alpha"),r("beta"),r("lower"),r("upper")]),"BINOM.DIST":o("This function calculates the individual term binomial distribution probability.",[r("x"),r("n"),r("p"),r("cumulative")]),"BINOM.INV":o("This function returns the criterion binomial, the smallest value for which the cumulative binomial distribution is greater than or equal to a criterion value.",[r("n"),r("p"),r("alpha")]),"CHISQ.DIST.RT":o("This function calculates the one-tailed probability of the chi-squared distribution.",[r("value"),r("deg")]),"CHISQ.INV.RT":o("This function calculates the inverse of the one-tailed probability of the chi-squared distribution.",[r("prob"),r("deg")]),"CHISQ.TEST":o("This function calculates the test for independence from the chi-squared distribution.",[r("obs_array"),r("exp_array")]),"CONFIDENCE.NORM":o("This function returns confidence interval for a population mean.",[r("alpha"),r("stdev"),r("size")]),"EXPON.DIST":o("This function returns the exponential distribution or the probability density.",[r("value"),r("lambda"),r("cumulative")]),"F.DIST.RT":o("This function calculates the F probability distribution, to see degrees of diversity between two sets of data.",[r("value"),r("degnum"),r("degden")]),"F.INV.RT":o("This function returns the inverse of the F probability distribution.",[r("p"),r("degnum"),r("degden")]),"F.TEST":o("This function returns the result of an F-test, which returns the one-tailed probability that the variances in two arrays are not significantly different.",[r("array1"),r("array2")]),"GAMMA.DIST":o("This function returns the gamma distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"GAMMA.INV":o("This function returns the inverse of the gamma cumulative distribution.",[r("p"),r("alpha"),r("beta")]),"LOGNORM.INV":o("This function returns the inverse of the lognormal cumulative distribution function of x, where LN(x) is normally distributed with the specified mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),"NORM.DIST":o("This function returns the normal cumulative distribution for the specified mean and standard deviation.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NORM.INV":o("This function returns the inverse of the normal cumulative distribution for the given mean and standard deviation.",[r("prob"),r("mean"),r("stdev")]),"NORM.S.INV":o("This function returns the inverse of the standard normal cumulative distribution. The distribution has a mean of zero and a standard deviation of one.",[r("prob")]),"PERCENTRANK.INC":o("This function returns the rank of a value in a data set as a percentage of the data set.",[r("array"),r("n"),r("signif")]),"POISSON.DIST":o("This function returns the Poisson distribution.",[r("nevents"),r("mean"),r("cumulative")]),"T.INV.2T":o("This function returns the t-value of the student's t-distribution as a function of the probability and the degrees of freedom.",[r("prog"),r("deg")]),"T.TEST":o("This function returns the probability associated with a t-test.",[r("array1"),r("array2"),r("tails"),r("type")]),"WEIBULL.DIST":o("This function returns the two-parameter Weibull distribution, often used in reliability analysis.",[r("x"),r("alpha"),r("beta"),r("cumulative")]),"Z.TEST":o("This function returns the significance value of a z-test. The z-test generates a standard score for x with respect to the set of data and returns the two-tailed probability for the normal distribution.",[r("array"),r("x"),r("sigma")]),"T.DIST.RT":o("This function returns the right-tailed t-distribution.",[r("x"),r("deg")]),"T.DIST.2T":o("This function returns the two-tailed t-distribution.",[r("x"),r("deg")]),"ISO.CEILING":o("This function returns a number up to the nearest integer or to the nearest multiple of significance, regardless of sign of significance.",[r("number"),r("signif")]),"BETA.DIST":o("This function returns the beta distribution.",[r("x"),r("alpha"),r("beta"),r("cumulative"),r("lower"),r("upper")]),"GAMMALN.PRECISE":o("This function returns the natural logarithm of the gamma function.",[r("value")]),"ERF.PRECISE":o("This function returns the error function.",[r("lowerlimit")]),"ERFC.PRECISE":o("This function returns the complementary ERF function.",[r("lowerlimit")]),"PERCENTRANK.EXC":o("This function returns the percentage rank(0..1, exclusive) of a value in a data set.",[r("array"),r("n"),r("signif")]),"HYPGEOM.DIST":o("This function returns the hypergeometric distribution.",[r("x"),r("n"),r("M"),r("N"),r("cumulative")]),"LOGNORM.DIST":o("This function returns the log normal distribution of x.",[r("x"),r("mean"),r("stdev"),r("cumulative")]),"NEGBINOM.DIST":o("This function returns the negative binomial distribution.",[r("x"),r("r"),r("p"),r("cumulative")]),"NORM.S.DIST":o("This function returns the standard normal distribution.",[r("z"),r("cumulative")]),"T.DIST":o("This function returns the t-distribution.",[r("x"),r("deg"),r("cumulative")]),"F.DIST":o("This function returns the F probability distribution.",[r("x"),r("degnum"),r("degden"),r("cumulative")]),"CHISQ.DIST":o("This function returns the chi-squared distribution.",[r("x"),r("deg"),r("cumulative")]),"F.INV":o("This function returns the inverse of the F probability distribution.",[r("probability"),r("degnum"),r("degden")]),"T.INV":o("This function returns the left-tailed inverse of the t-distribution.",[r("probability"),r("deg")]),"CHISQ.INV":o("This function returns the inverse of left-tailed probability of the chi-squared distribution.",[r("probability"),r("deg")]),"CONFIDENCE.T":o("This function returns the confidence interval for a Student's t distribution.",[r("alpha"),r("stdev"),r("size")]),"NETWORKDAYS.INTL":o("This function returns the number of workdays between two dates using arguments to indicate holidays and weekend days.",[r("startdate"),r("enddate"),r("weekend"),r("holidays")]),"WORKDAY.INTL":o("This function returns the serial number of the date before or after a number of workdays with custom weekend parameters. These parameters indicate weekend days and holidays.",[r("startdate"),r("numdays"),r("weekend"),r("holidays")]),REFRESH:o("This function decides how to re-calculate the formula. Can use the evaluateMode argument to specific the formula re-calculate on the reference value changed, evaluate once , re-calculate or interval.",[r("formula"),r("evaluateMode"),r("interval")]),DAYS:o("This function returns the number of days between two dates.",[r("startdate"),r("enddate")]),ISOWEEKNUM:o("This function returns the number of the ISO week number of the year for a given date.",[r("date")]),BITAND:o('This function returns a bitwise "AND" of two numbers.',[r("number1"),r("number2")]),BITLSHIFT:o('This function returns a bitwise "OR" of two numbers.',[r("number1"),r("number2")]),BITOR:o('This function returns a bitwise "OR" of two numbers.',[r("number1"),r("number2")]),BITRSHIFT:o('This function returns a bitwise "OR" of two numbers.',[r("number1"),r("number2")]),BITXOR:o('This function returns a bitwise "XOR" of two numbers.',[r("number1"),r("number2")]),IMCOSH:o("This function returns the hyperbolic cosine of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMCOT:o("This function returns the cotangent of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMCSC:o("This function returns the cosecant of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMCSCH:o("This function returns the hyperbolic cosecant of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMSEC:o("This function returns the secant of a complex number in x+yi of x+yj text format.",[r("complexnum")]),IMSECH:o("This function returns the hyperbolic secant of a complex number in x+yi or x+yj text format.",[r("complexnum")]),IMSINH:o("This function returns the hyperbolic sine of a complex number in x+yi of x+yj text format.",[r("complexnum")]),IMTAN:o("This function returns the tangent of a complex number in x+yi or x+yj text format.",[r("complexnum")]),PDURATION:o("This function returns the number of periods required by an investment to reach a specified value.",[r("rate"),r("pval"),r("fval")]),RRI:o("This function returns an equivalent interest rate for the growth of an investment.",[r("nper"),r("pval"),r("fval")]),ISFORMULA:o("This function tests whether contains a formula of a referenced cell.",[r("cellreference")]),IFNA:o("This function returns the value you specify if the formula returns the #N/A error value, otherwise returns the result of the formula.",[r("value"),r("value_if_na")]),IFS:o("This function checks whether one or more conditions are met and returns a value that corresponds to the first TRUE condition.",[r("valueTest1"),r("valueTrue1",!0)]),SWITCH:o("This function evaluates one value for a list of values, and returns the result corresponding to the first matching value, otherwise returns the default value",[r("convertvalue"),r("matchvalue"),r("matchtrue"),r("matchfalse")]),XOR:o("This function returns a logical exclusive or of all arguments.",[r("logical",!0)]),AREAS:o("This function returns the number of areas in a reference.",[r("reference")]),FORMULATEXT:o("This function returns a formula as a string.",[r("reference")]),HYPERLINK:o("This function creates a shortcut or jump that opens a document stored on a network server, an intranet, or the Internet.",[r("link_location"),r("friendly_name")]),ACOT:o("This function calculates the inverse arccotangent of a number.",[r("value")]),ACOTH:o("This function calculates the inverse hyperbolic arccotangent of a number.",[r("value")]),ARABIC:o("This function converts a Roman numeral text to an Arabic numeral equivalent.",[r("text")]),BASE:o("This function converts a number into a text representation with the given radix (base).",[r("number"),r("radix"),r("minLength")]),"CEILING.MATH":o("This function round  a number up to the nearest integer or to the nearest multiple of significance.",[r("value"),r("signif"),r("mode")]),COMBINA:o("This function calculates the number of possible combinations with repetitions for a specified number of items.",[r("number"),r("number_choosen")]),COT:o("This function returns the cotangent of the specified angle.",[r("angle")]),COTH:o("This function returns the hyperbolic cotangent of the specified number.",[r("value")]),CSC:o("This function returns the cosecant of the specified angle.",[r("angle")]),CSCH:o("This function returns the hyperbolic cosecant of the specified number.",[r("value")]),DECIMAL:o("This function converts a text representation of a number in a given base into a decimal number.",[r("text"),r("radix")]),"FLOOR.MATH":o("This function round a number down to the nearest integer or to the nearest multiple of significance.",[r("value"),r("signif"),r("mode")]),SEC:o("This function returns the secant of the specified angle.",[r("angle")]),SECH:o("This function returns the hyperbolic secant of the specified value.",[r("value")]),"BINOM.DIST.RANGE":o("This function calculates the probability of a trial result using a binomial distribution.",[r("x"),r("n"),r("p"),r("cumulative")]),GAMMA:o("This function returns the gamma function value.",[r("number")]),MAXIFS:o("This function returns the maximum value among cells specified by a given set of conditions or criteria.",[r("array"),r("conditionarray"),r("condition",!0)]),GAUSS:o("This function calculates the probability that a member of a standard normal population will fall between the mean and z standard deviations from the mean.",[r("number")]),MINIFS:o("This function returns the minimum value among cells specified by a given set of conditions or criteria.",[r("array"),r("conditionarray"),r("condition",!0)]),PERMUTATIONA:o("This function returns the number of permutations for a given number of object that can be selected from the total objects.",[r("k"),r("n")]),PHI:o("This function returns the value of the density function for a standard normal distribution.",[r("value")]),"SKEW.P":o("This function returns the skewness of a distribution base on a poopulation: a characterization of the degree of asymmetry of a distribution around its mean.",[r("number1"),r("number2",!0)]),BAHTTEXT:o('This function converts a number to Thai text and adds a suffix of "Baht"',[r("number")]),CONCAT:o('This function combines multiple text strings or numbers into one text string, the function will stay available for compatibility with "CONCATENATE" function.',[r("text1"),r("text2",!0)]),FINDB:o("This function finds one text value within another and returns the text value's position in the text you searched, and counts each double-byte characte as 2 when set DBCS as the default language.",[r("findtext"),r("intext"),r("start")]),LEFTB:o("This function returns the specified leftmost characters from a text value, and based on the number of bytes you specify.",[r("mytext"),r("num_bytes")]),LENB:o("This function returns the length of the number of bytes in a text string.",[r("value")]),MIDB:o("This function returns the requested number of characters from a text string starting at the position you specify, and based on the number of bytes you specify.",[r("text"),r("start_num"),r("num_bytes")]),REPLACEB:o("This function replaces part of a text string with a different text string, based on the number of bytes you specify.",[r("old_text"),r("start_byte"),r("num_bytes"),r("new_text")]),RIGHTB:o("This function returns the specified rightmost characters from a text value, and based on the number of bytes you specify.",[r("text"),r("num_bytes")]),SEARCHB:o("This function finds one text string in another text string and returns the index of the starting position of the found text, and counts each double-byte characte as 2 when set DBCS as the default language.",[r("string1"),r("string2")]),TEXTJOIN:o("This function combines multiple ranges and/or strings into one text, and the text includes a delimiter you specify between each text value.",[r("delimiter"),r("ignore_empty"),r("text1"),r("text2",!0)]),UNICHAR:o("This function returns the Unicode character of a given numeric reference.",[r("number")]),UNICODE:o("This function returns the number corresponding to the first character of the text.",[r("text")]),ENCODEURL:o("This function returns a URL-encoded string.",[r("text")]),BC_QRCODE:o("This function returns a data set for representing a QRCode",[r("value"),r("color"),r("backgroundColor"),r("errorCorrectionLevel"),r("model"),r("version"),r("mask"),r("connection"),r("connectionNo"),r("charCode"),r("charset"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_EAN13:o("This function returns a data set for representing a EAN13.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("addOn"),r("addOnLabelPosition"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_EAN8:o("This function returns a data set for representing a EAN8.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODABAR:o("This function returns a data set for representing a CODABAR.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("checkDigit"),r("nwRatio"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE39:o("This function returns a data set for representing a CODE39.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("labelWithStartAndStopCharacter"),r("checkDigit"),r("nwRatio"),r("fullASCII"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE93:o("This function returns a data set for representing a CODE93.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("checkDigit"),r("fullASCII"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE128:o("This function returns a data set for representing a CODE128.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("codeSet"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_GS1_128:o("This function returns a data set for representing a GS1_128.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_CODE49:o("This function returns a data set for representing a CODE49.",[r("value"),r("color"),r("backgroundColor"),r("showLabel"),r("labelPosition"),r("grouping"),r("groupNo"),r("fontFamily"),r("fontStyle"),r("fontWeight"),r("textDecoration"),r("textAlign"),r("fontSize"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_PDF417:o("This function returns a data set for representing a PDF417.",[r("value"),r("color"),r("backgroundColor"),r("errorCorrectionLevel"),r("rows"),r("columns"),r("compact"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),BC_DATAMATRIX:o("This function returns a data set for representing a DATAMATRIX.",[r("value"),r("color"),r("backgroundColor"),r("eccMode"),r("ecc200SymbolSize"),r("ecc200EncodingMode"),r("ecc00_140SymbolSize"),r("structuredAppend"),r("structureNumber"),r("fileIdentifier"),r("quietZoneLeft"),r("quietZoneRight"),r("quietZoneTop"),r("quietZoneBottom")]),FILTER:o("This function filter a range or array.",[r("array"),r("include"),r("if_empty")]),RANDARRAY:o("This function returns an array of random numbers.",[r("rows"),r("columns"),r("min"),r("max"),r("whole_number")]),SEQUENCE:o("This function returns a sequence of numbers.",[r("rows"),r("columns"),r("start"),r("step")]),SINGLE:o("This function returns a single value when given a value, range or array.",[r("value")]),SORT:o("This function sorts a range or array.",[r("array"),r("sort_index"),r("sort_order"),r("by_col")]),SORTBY:o("This function sorts a range or array based on the values in a corresponding range or array.",[r("array"),r("by_array1"),r("sort_order1"),r("by_array2"),r("sort_order2"),r("...")]),UNIQUE:o("This function returns the unique values from a range or array.",[r("array"),r("by_col"),r("occurs_once")]),LET:o("This function assigns calculation results to names. Useful for storing intermediate calculations and values by defining names inside a formula. These names only apply within the scope of the LET function.",[r("name1"),r("name_value1"),r("calculation_or_name2"),r("[name_value2, ...")])},Fbx_Summary:"Summary",Fbx_TableName_Description:"Table name for ",Fbx_CustomName_Description:"Custom name for ",B2:{All:{name:"#All",description:"Returns the entire contents of the table, or specified table columns including column headers, data and total rows."},Data:{name:"#Data",description:"Returns the data cells of the table or specified table columns."},Headers:{name:"#Headers",description:"Returns the columns headers for the table, or specified table columns."},Totals:{name:"#Totals",description:"Returns the total rows for the table or specified table columns."},thisRow:{name:"#This Row",description:"This row."}}}},"./src/evaluator.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function F(t,e,n,o){return{row:t,col:e,rowCount:n,colCount:o}}function P(t,e){return t&&e?t.row===e.row&&t.col===e.col:t===e}function _(t){var e,n;for(n=0;n<t.oi.length;n++)(e=t.oi[n]).v5=!1,e.oi.length>0&&_(e)}function L(t){var e,n=!0,o=t;return t&&t.getValue&&((e=d(t,0,!1,!1)).isError?o=e[0]:1===e.rowCount&&1===e.colCount?o=e[0][0]:(o=e,n=!1)),{value:o,success:n}}function B(t,e,n){return p(e)?e:p(n)?n:t<=2?function(t,e,n){var o,i,a,s,l,u,c,f;if(!e)return 0;if((o=L(e)).success)return G(t,o.value);if(n){for(i=[],a=o.value,s=a.rowCount,l=a.colCount,u=0;u<s;u++)for(c=i[u]=[],f=0;f<l;f++)c[f]=G(t,a[u][f]);return new r.CalcArray(i)}}(t,e,n):t<=14?function(t,e,n){var o,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C;if(o=t<=7?G:8===t?H:V,i=L(e),a=L(n),i.success&&a.success)return o(t,i.value,a.value);if(e=i.value,n=a.value,s=i.success?-1:e.rowCount,l=i.success?-1:e.colCount,u=a.success?-1:n.rowCount,c=a.success?-1:n.colCount,f=-1,h=-1,i.success||a.success)i.success?(f=u,h=c):(f=s,h=l);else{if(1!==s&&1!==u&&s!==u||1!==l&&1!==c&&l!==c)return b;f=1===s?u:s,h=1===l?c:l}for(p=[],d=0;d<f;d++)for(p[d]=[],g=0;g<h;g++)!i.success&&(1!==s&&s<f||1!==l&&l<h)||!a.success&&(1!==u&&u<f||1!==c&&c<h)?p[d][g]=b:(m=1===s?0:d,y=1===l?0:g,v=1===u?0:d,C=1===c?0:g,p[d][g]=o(t,i.success?e:e[m][y],a.success?n:n[v][C]));return new r.CalcArray(p)}(t,e,n):function(t,e,n){var o,i,a,s,l,u,h,p,d,g,m,y,C;if(!e||!n||(1!==e.getRangeCount()||1!==n.getRangeCount())&&16!==t||e.endSource||n.endSource)return v;if(!(o=e.getSource())||o!==n.getSource())return v;if(16===t)i=e.yf.concat(n.yf);else{if(a=15===t?c:f,s=15===t?f:c,l=e.getRow(0),u=e.getColumn(0),h=n.getRow(0),p=n.getColumn(0),d=a(l,h),g=a(u,p),m=s(l+e.getRowCount(0),h+n.getRowCount(0))-d,y=s(u+e.getColumnCount(0),p+n.getColumnCount(0))-g,m<1||y<1)return r.Errors.Null;i=[F(d,g,m,y)]}return(C=new r.CalcReference(o,i)).ck=e.ck||n.ck,C}(t,e,n)}function G(t,e,n){var i,a,s,l;function c(t){return"string"==typeof t&&0===t.trim().length}if(c(e)||c(n))return v;if(!h(e,i={value:0}))return 0===t&&"string"==typeof e||e instanceof r.CalcError?e:v;if(a=i.value,n!==u){if(!h(n,i))return n instanceof r.CalcError?n:v;s=i.value}else s=0;return 0===t?a:1===t?-a:2===t?a/100:3===t?r.Zh.Yh(a,-s)?0:a+s:4===t?r.Zh.Yh(a,s)?0:a-s:5===t?o.Common.o.Lma(a*s,r.Functions.CALC_PRECISION||15):6===t?s?a/s:w:7===t?!a&&s<0?w:0===a&&0===s?T:(l=r.Functions.MathHelper.YDc(a,s))===Number.POSITIVE_INFINITY||l===Number.NEGATIVE_INFINITY||isNaN(l)?T:l:void 0}function H(t,e,n){if(8===t)return p(e)?e:p(n)?n:r.Convert.bc(e)+r.Convert.bc(n)}function V(t,e,n){var o=i.gOb(e,n,!1);return p(o)?o:9===t&&0===o||10===t&&0!==o||11===t&&o<0||12===t&&o<=0||13===t&&o>0||14===t&&o>=0}function z(t,e){var n,o,i,a=!0;switch(e.Hi){case 0:n=M(t),o=!0;break;case 1:n=parseFloat(t),o=!0;break;case 2:n=N(t),o=!0;break;case 3:n=parseInt(t,10),o=!0;break;case 4:(n=d(t,e.Ii,e.Ji||!1,e.Ki||!1,e.Li||!1,e.Mi,e.xTa,e.hOb)).isError&&(n=n[0],a=!1),n.isConvertError&&(n=v,a=!1);break;case 5:n=E(t),e.Ni&&""===n&&(n=v,a=!1);break;case 6:D(t,i={value:l})?n=i.value:(n=v,a=!1);break;case 7:n=O(t);break;case 8:!(n=r.Functions.Wi(t))||e.Oi&&0===n.Pi()&&0===n.Qi()?(n=r.Errors.Number,a=!1):n={Ri:n.Pi(),Si:n.Qi()};break;default:n=t}return o&&isNaN(n)&&(n=v,a=!1),{Ti:n,Ei:a}}function W(t,e,n){var o,i,a,s,l;for(Array.isArray(e)||(e=[e]),o=t.Ti,i=0;i<e.length;i++)if(s=(a=e[i].split(" "))[0],l=parseInt(a[1],10),"<"===s&&o<l||">"===s&&o>l||"<="===s&&o<=l||">="===s&&o>=l||"="===s&&o===l||"!="===s&&o!==l||"checkLength"===s&&o.length>l)return t.Ti=n===u?r.Errors.Number:n,void(t.Ei=!1)}function U(t,e){var n,o,i,a,s,l=[];if(!e)return{Di:t,Ei:!0};if(e.Xi)for(i=0;i<t.length;i++)l.push(e);else l=Array.isArray(e)?e:[e];for(o=0;o<l.length;o++){if((a=l[o]).Yi&&!t[o])throw r.sR().Exp_ArgumentNull;if(s=t[o]!==u){if(n=z(t[o],a),a.aj&&W(n,a.aj,a.bj),!n.Ei)break;t[o]=a.Zi?{$i:s,Qb:n.Ti}:n.Ti}else t[o]=a.Zi?{$i:s,Qb:a._i}:a._i}return n?{Di:t,Ei:n.Ei,Fi:n.Ti}:void 0}Object.defineProperty(e,"__esModule",{value:!0}),o=n("Common"),r=n("./src/calc.common.ts"),i=n("./src/calc.common.ts"),a=n("./src/calc.ts"),s=o.Common.j.Fa,l=null,u=void 0,Math.pow,c=Math.min,f=Math.max,h=r.Convert.Th,p=r.Convert.vf,d=r.Convert.Ph,g=r.Convert.Ca,m=r.Convert.Fh,y=r.Errors.Reference,v=r.Errors.Value,C=r.Errors.Name,b=r.Errors.NotAvailable,w=r.Errors.DivideByZero,T=r.Errors.Number,x=function(){function t(t,e,n,o){var r,i,a=[];for(r=4;r<arguments.length;r++)a[r-4]=arguments[r];this.si=0,this.ti=0,this.ui=0,(i=this).source=t,i.arrayFormulaMode=!!n,i.identity=e||i.$Ab(0,0),i.arrayIdentity=o,i.row=o?o.row:i.identity.row||0,i.column=o?o.col:i.identity.col||0,i.rowOffset=o?i.identity.row-o.row:i.row,i.columnOffset=o?i.identity.col-o.col:i.column}return t.prototype.$Ab=function(t,e){return{row:t,col:e}},t.prototype.fga=function(t){return t===r.BangSource?this.source:t},t.prototype.getValue=function(t,e){return t?this.fga(t).getValue(e):y},t.prototype.getReference=function(t,e){return t?this.fga(t).getReference(e):y},t.prototype.getSheetRangeReference=function(t){return t&&t.source&&t.endSource?this.fga(t.source).getSheetRangeReference(t):y},t.prototype.getFunction=function(t){return this.source?this.source.getCustomFunction(t):l},t.prototype.getName=function(t){var e,n=this,o=n.source?n.source.getCustomName(t):l;return!o&&n.source&&(o=(e=n.source.Cf().getGlobalSourceModel())&&e.getSource().getCustomName(t)),o},t.prototype.getField=function(t){return this.source?this.source.getField(t):l},t.prototype.vi=function(){return this.ui>0},t.prototype.wi=function(){this.ui++},t.prototype.xi=function(){this.ui--},t.prototype.SetAsyncResult=function(t,e){this.source.Cf().lh.SetAsyncResult(t,e)},t.prototype.cloneFrom=function(t){this.acceptsReference=t.acceptsReference,this.arrayFormulaMode=t.arrayFormulaMode},t}(),e.EvaluateContext=x,r.CalcSource.prototype.getEvaluatorContext=function(t,e,n){return new x(this,t,e,n)},S=function(){function t(t,e){this.id=t.si++,this.ctx=t,this.row=t.row+(t.arrayFormulaMode&&t.rowOffset||0),this.col=t.column+(t.arrayFormulaMode&&t.columnOffset||0),this.node=e}return t.prototype.setAsyncResult=function(t){this.node.Fi=t,this.node.v5=!0,this.ctx.SetAsyncResult(this,t),this.ctx.source.refresh()},t.prototype.getFormula=function(){return this.ctx.source.getCalcService().unparse(this.ctx.source,this.expression,this.row,this.col)},t}(),e.AsyncEvaluateContext=S,A=function(t){function e(e,n,o,r,i,a,s,u){var c=t.call(this,e,isNaN(u)?l:{row:s,col:u},n,isNaN(a)?l:{row:o,col:r,rowCount:i,colCount:a})||this,f=e.Cf().getGlobalSourceModel(e);return c.yi=f&&f.getSource(),c}return j(e,t),e.prototype.getName=function(t){return this.yi?this.yi.getCustomName(t):l},e}(x),e.GloableEvaluateContext=A,I=function(){function t(t){this.service=t,this.asyncManager=new k(this)}return t.prototype.evaluateExpression=function(t,e,n,i,a){var s,c,f=void 0===t.type&&t.Lf?t.Lf:t,h=this.evaluate(f,e,!!i,!!a);return h&&h.pause?h:h===u||h===l?!1===n?h:0:((g(h)&&!i||m(h)&&!a)&&(h=this.getOneValue(e,h)),s=15,"number"==typeof h&&h>-10&&h<10&&(((c=""+h).indexOf("000000000000")>1||c.indexOf("999999999999")>1)&&(s=14)),o.Common.o.Lma(h,r.Functions.CALC_PRECISION||s))},t.prototype.evaluate=function(t,e,n,o){var i,a,s,c;if(!t)throw r.sR().Exp_ExprIsNull;if(void 0===t.type){if(t._error)return t;t.Lf&&(t=t.Lf)}for(;10===t.type;)t=t.value;if(i=this,s=l,12===t.type?(s=t.needExpendIndexs,t=t.value):e.Exb&&(n=!0,s=[]),(c=t.type)>=2&&c<=6)a=i.evaluateConst(t,e,n);else if(1===c||13===c||33===c)a=i.evaluateReference(t,e,o,n);else if(8===c)a=i.evaluateName(t,e,n,o);else if(t&&100===t.type)a=i.evaluateLocalName(t,e,n,o);else if(9!==c||t.value2){if(9===c)a=i.evaluateBinaryOperation(t,e,n,o,s);else if(7===c){if(t.QDc&&e.NDc&&((a=i.evaluateBranchFunction(t,e,n,o,s))&&a.pause))return a;a=i.evaluateFunction(t,e,n,o,s)}else if(11===c)a=u;else if(14===c)a=i.evaluateField(t,e);else if(e.evaluate)return e.evaluate(t,n,o)}else a=i.evaluateUnaryOperation(t,e,n,o,s);return a},t.prototype.evaluateLocalName=function(t,e,n,o){var i,a,s,l;if(e.letContext)for(i=t.value,a=e.letContext.length-1;a>=0;a--)if((s=e.letContext[a])[i]!==u)return t.bhc=!0,s[i];return(l=new r.Expression(8)).value=t.value,this.evaluate(l,e,n,o)},t.prototype.evaluateConst=function(t,e,n){var o=t.value;return g(o)?n||e&&(e.arrayFormulaMode||e.vi())?o:o.getValue(0,0):o},t.prototype.evaluateReference=function(t,e,n,o){var i,a,s,l,u,c,f,h,p,d,g,m,C,b,w,T;if(!e)return v;if(i=t.source||e.source,a=isNaN(e.row)?0:e.row,s=isNaN(e.column)?0:e.column,l=t.getRange&&t.getRange(a,s),u=t.type,!l)return 13===u?v:y;if(33===u&&l.isSpillError)return r.Errors.Spill;if(c=l.row<0?0:l.row,f=l.col<0?0:l.col,h=l.rowCount,p=l.colCount,o&&(d=i.getRowCount(),g=i.getColumnCount(),(-1===h||h>d)&&(h=d),(-1===p||p>g)&&(p=g)),n||e.arrayFormulaMode)return t.endSource?e.getSheetRangeReference({source:t.source,endSource:t.endSource,row:c,col:f,rowCount:h,colCount:p}):e.getReference(i,l);if(o&&(h>1||p>1)){for(m=[],C=0;C<h;C++)for(m[C]=[],b=0;b<p;b++)m[C][b]=i.getValue(C+c,b+f);return new r.CalcArray(m)}if(h>1||p>1)if(w=a>=l.row&&a<l.row+h,T=s>=l.col&&s<l.col+p,w&&T)c=a,f=s;else{if(!w&&!T)return v;if(w&&1===p)c=a;else{if(!T||1!==h)return v;f=s}}else if(-1===l.row&&-1===h){if(1!==p)return v;c=a}else if(-1===l.col&&-1===p){if(1!==h)return v;f=s}return i.getValue(c,f)},t.prototype.evaluateName=function(t,e,n,o){var r,i;return e?(t.source&&(e=t.source.getEvaluatorContext(e.identity,e.arrayFormulaMode,e.arrayIdentity)),(r=e.getName(t.value))?(i=a.Mh(e,r,!1,0,0,n,o),this.evaluate(i,e,n,o)):C):C},t.prototype.evaluateUnaryOperation=function(t,e,n,o,i){var a,s=!1;return i&&i.length>0&&(n=!0,s=!0),(a=this.evaluate(t.value,e,n,s))&&a.pause||r.Convert.vf(a)?a:a===r.missingArgument?b:this.evaluateWithArgs(t,(function(n){return B(t.operatorType,n[0],e.Exb)}),e,i,[a],n,o)},t.prototype.evaluateBinaryOperation=function(t,e,n,o,i){var a,s,l,u,c,f,h,p,d;if(e.Exb&&(n=!0),a=[n,n],l=[s=t.operatorType>=15,s],i&&i.length>0)for(u=0;u<i.length;u++)a[i[u]]=!0,l[i[u]]=!0;for(c=function(t,e){if(0===e){for(;10===t.type;)t=t.value;if(7===t.type&&t.function&&t.function.TAb)return null}return e},f=[t.value,t.value2],h=[],u=0;u<2;u++){if((p=this.evaluate(f[u],e,a[u],l[u]))&&p.pause)return p;if(d=c(f[u],p),r.Convert.vf(d))return d;if(d===r.missingArgument)return b;h[u]=d}return this.evaluateWithArgs(t,(function(e){return B(t.operatorType,e[0],e[1])}),e,i,h,n,o)},t.prototype.evaluateField=function(t,e){return e?(t.source&&(e=t.source.getEvaluatorContext(e.identity,e.arrayFormulaMode,e.arrayIdentity)),e.getField(t.value)||b):C},t.prototype.startCache=function(){this.Bi={},this.service.nia&&this.asyncManager.startCalc()},t.prototype.endCache=function(){this.Bi=l},t.prototype.evaluateBranchFunction=function(t,e,n,o,r){var i,a,l,u,c,f,h;if(s(t.PDc))return i=t.function,a=t.arguments.length,l=i.findTestArgument(),c=(u=this.preprocessFunction(e,i,a,r)).acceptsArrays,f=u.keepArrayValuesFlagSet,(h=this.testArgGetBranch(e,i,t,c[l],!1,l))&&h.pause?h:(f&&delete e.Exb,h.branchArgument>=0&&"number"==typeof h.branchArgument?(t.PDc=!0,e.source.ODc=e.source.ODc||[],e.source.ODc.push(t),{pause:"Branch",branch:t.RDc[h.branchArgument]}):void delete t.QDc)},t.prototype.evaluateLetFunction=function(t,e,n,o){var r,i,a,s,l,u,c,f,h=t.arguments.length;for(e.letContext=e.letContext||[],i={},a=1;a<h-1;a+=2){if(s=t.arguments[a-1],l=t.arguments[a],u=s.value,c=e,e.letContext.push(i),(r=this.evaluate(l,c,n,o))&&r.pause)return r;e.letContext.pop(),i[u]=r,s.bhc=!0}return e.letContext.push(i),(f=this.evaluate(t.arguments[h-1],e,n,o))&&f.pause||(e.letContext.pop(),0===e.letContext.length&&delete e.letContext),f},t.prototype.preprocessFunction=function(t,e,n,o){var r,i,a,s,u=[],c=[],f=t.Exb,h=!1,p=l;for(f||1!==e.arrayArgumentEvaluateMode||(f=t.Exb=!0,h=!0),r=0;r<n;r++)u[r]=e.acceptsArray(r),c[r]=e.acceptsReference(r);if(o&&o.length>0||f){for(p=[],r=0;r<n;r++)p[r]=!0;for(i=f?n:o.length,r=0;r<i;r++)u[a=f?r:o[r]]=!0,c[a]=!0,(s=!(e.acceptsReference(a)&&!e.acceptsArray(a)))&&f&&e.acceptsReference(a)&&(s=!1),p[a]=s}return e.isBranch()&&(t.arrayFormulaMode||t.vi())&&(u[e.findTestArgument()]=!0,c[e.findTestArgument()]=!0),{acceptsArrays:u,acceptsReferences:c,getReferenceValues:p,keepArrayValuesFlagSet:h}},t.prototype.testArgGetBranch=function(t,e,n,o,r,i){var a,s=-1,l=t.Exb;return t.arrayFormulaMode&&(t.Exb=!0),e.acceptsArray(i)&&t.wi(),(a=this.evaluate(n.arguments[i],t,o,r))&&a.pause?a:(e.acceptsArray(i)&&t.xi(),t.Exb=l,m(a)||g(a)||(s=e.findBranchArgument(a)),{testArgValue:a,branchArgument:s})},t.prototype.evaluateFunction=function(t,e,n,o,i){var a,s,u,c,f,h,p,d,y,v,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P;if(!t||!t.function||"string"==typeof t.function)return C;if(a=t.arguments.length,s=this,u=e.ti,"LET"===t.functionName)return s.evaluateLetFunction(t,e,n,o);if(c=t.function,f=[],p=l,c instanceof r.Functions.AsyncFunction&&this.asyncManager.startCalcFunction(c,t.arguments,e),0!==a){if(v=(y=s.preprocessFunction(e,c,a,i)).acceptsArrays,b=y.acceptsReferences,p=y.getReferenceValues,d=y.keepArrayValuesFlagSet,w=void 0,T=void 0,x=void 0,c.isBranch()){if(T=c.findTestArgument(),(S=s.testArgGetBranch(e,c,t,v[T],b[T],T))&&S.pause)return S;w=S.testArgValue,x=S.branchArgument}for(A=0;A<a;A++){if(T===A)h=w;else{if(x>=0&&A!==x){f[A]=null;continue}if(c.acceptsArray(A)&&e.wi(),(h=s.evaluate(t.arguments[A],e,v[A],b[A]))&&h.pause)return h;c.acceptsArray(A)&&e.xi()}if(!c.acceptsArray(A)&&g(h)||!c.acceptsReference(A)&&m(h))if(I=g(h)?h:l,R=m(h)?h:l,I&&1===I.getRowCount()&&1===I.getColumnCount())h=I.getValue(0,0);else if(R&&1===R.getRowCount(0)&&1===R.getColumnCount(0))h=R.getValue(0,0,0);else{if(k=[],M=!1,i)for(N=0;N<i.length;N++)k.push(i[N]),i[N]===A&&(M=!0);M||(k.push(A),i=k)}if(r.Convert.vf(h)&&!c.acceptsError(A))return c instanceof r.Functions.AsyncFunction&&this.asyncManager.endCalcFunction(),h;if(h!==r.missingArgument||c.acceptsMissingArgument(A)||(h=l),f[A]=h,h&&"INDIRECT"!==t.functionName&&h.ck&&h.xf)for(E=h.getRangeCount(),D=h.xf,O=e.source.getCalcSourceModel().qg(e.row,e.column,!0),j=0;j<E;j++)(F=h.yf[j]).id=D.id,D.getRangeKey&&(P=D.getRangeKey(D,F),O.eOb||(O.eOb={}),O.eOb[P]=F)}}return d&&delete e.Exb,s.evaluateWithArgs(t,(function(t,n,i){var a,l,f,h,p,d=U(t,c.Ci);return t=d.Di,c.isContextSensitive()?(e.acceptsReference=o||e.vi(),c instanceof r.Functions.AsyncFunction?(s.T4=s.T4||{},c.evaluateWhenArgumentsIsSame()?s.evaluateAsyncFunction(e,n,c,u,t,i):s.evaluateWithCache(c,t,(function(){return s.evaluateAsyncFunction(e,n,c,u,t,i)}),s.T4)):c.evaluateWithContext(e,t)):((l=e.arrayFormulaMode)&&(c.y0a={row:e.rowOffset,col:e.columnOffset}),f=r.getMapping()&&r.getMapping().builtInFunctionsMapping,h=f&&f[c.name]&&f[c.name].specialFun,p=function(){return d.Ei?h&&h.apply(c,t)||c.evaluate.apply(c,t):d.Fi},a=l?s.evaluateWithCache(c,t,p,s.Bi):p(),delete c.y0a,a)}),e,i,f,n,o,p)},t.prototype.evaluateAsyncFunction=function(t,e,n,o,r,i){var a,s,l=this.asyncManager.getNode();if(l.v5)a=l.Fi;else if(l.canEvaluate()){if(s=new S(t,l),a=n.evaluateWithContext(s,r),s.notAsync)return a;a===u?a=l.Fi!==u?l.Fi:n.defaultValue():1===l.evaluateMode&&(l.v5=!0)}else a=l.Fi!==u?l.Fi:n.defaultValue();return l.Fi=a,i||this.asyncManager.endCalcFunction(),a},t.prototype.evaluateWithCache=function(t,e,n,o){var i,a,s,l,c,f,h,p,d,g,m,y;if(o)if(a=!1,i=o[t.name+e.length])for(s=0;s<i.length;s++){if(a=!1,(l=i[s]).args.length===e.length){for(a=!0,c=0;c<e.length;c++)if((f=l.args[c])!==(h=e[c])){if(!(f instanceof r.CalcReference&&h instanceof r.CalcReference)){a=!1;break}if(p=f.zf,f.xf!==h.xf||p!==h.zf){a=!1;break}for(d=0;d<p;d++)if(f.getRow(d)!==h.getRow(d)||f.getColumn(d)!==h.getColumn(d)||f.getRowCount(d)!==h.getRowCount(d)||f.getColumnCount(d)!==h.getColumnCount(d)){a=!1;break}}a&&!P(l.y0a,t.y0a)&&(a=!1)}if(a)return l.flag++,l.value}else i=o[t.name+e.length]=[];if(g=n(),o&&g!==u){if((m=i.length)>=100){for(y=[],s=0;s<m;s++)i[s].flag>0&&y.push(i[s]);y.sort((function(t,e){return e.flag-t.flag})),m=Math.min(50,y.length),i=y.slice(0,m),o[t.name+e.length]=i}i.push({args:e,value:g,flag:0,y0a:t.y0a})}return g},t.prototype.SetAsyncResult=function(t){var e,n,o=[];for(e=1;e<arguments.length;e++)o[e-1]=arguments[e];(n=t.ctx).source.Cf().recalculate(n.source,t.row,t.col,!0)},t.prototype.evaluateWithArgs=function(t,e,n,o,i,a,s,l){var u,c,f,h,p,d,y,C,w,T,x,S,A,I,R=n.Exb;if(!R||o&&o.length>0||(o=[],(u=7===t.type&&t.function)&&i.forEach((function(t,e){(!u.acceptsArray(e)&&g(t)||!u.acceptsReference(e)&&m(t))&&o.push(e)}))),o&&o.length>0){if(!(f=this.Gi(n,t,i,o,l)))return b;for(h=[],p=f[0].length,d=f[0][0].length,y=0;y<p;y++)for(h[y]=[],C=0;C<d;C++)try{for(w=[],T=0;T<i.length;T++)w[T]=f[T][y][C];if(c=e(w,t,y+1!==p||C+1!==d),m(c)&&!R){if(7===t.type&&((u=t.function).returnReference&&u.returnReference()))return c;c=this.getOneValue(n,c)}h[y][C]=c}catch(t){h[y][C]=v}return new r.CalcArray(h,R)}try{if(c=e(i,t),n.arrayFormulaMode&&n.vi())return c;if(g(c)&&!a)return this.getOneValue(n,c);if(m(c)&&!s){if(x=c,a&&1===x.getRangeCount()){for(S=[],A=0;A<x.getRowCount(0);A++)for(S[A]=[],I=0;I<x.getColumnCount(0);I++)S[A][I]=x.getValue(0,A,I);return new r.CalcArray(S)}return this.getOneValue(n,c)}return c}catch(t){return v}},t.prototype.getOneValue=function(t,e){var n,o,r,i,a,s;return m(e)?(i=(r=e).getRowCount(0),a=r.getColumnCount(0),r.getRangeCount()>1||!t.arrayFormulaMode&&i>1&&a>1?e=v:(-1!==t.rowOffset||-1!==t.columnOffset?(n=1===i?0:t.arrayFormulaMode?t.rowOffset:t.rowOffset-r.getRow(0),o=1===a?0:t.arrayFormulaMode?t.columnOffset:t.columnOffset-r.getColumn(0)):(n=1===i?0:t.row-r.getRow(0),o=1===a?0:t.column-r.getColumn(0)),e=n>=i||o>=a?b:r.getValue(0,n,o))):g(e)&&(s=e,!t.arrayFormulaMode||-1===t.rowOffset&&-1===t.columnOffset?e=s.getValue(0,0):(n=1===s.getRowCount()?0:t.rowOffset,o=1===s.getColumnCount()?0:t.columnOffset,e=n>=s.getRowCount()||o>=s.getColumnCount()?b:s.getValue(n,o))),m(e)||g(e)?this.getOneValue(t,e):e},t.prototype.Gi=function(t,e,n,r,i){var a,s,c,f,h,p,d,y,v,C,w,T,x,S,A,I,R,k,M,N=1,E=1,D=-1,O=!0,j=!0,P=1,_=1,L=7===e.type?e:l,B=L&&L.function,G=t.arrayFormulaMode||t.source&&t.source.Af&&t.source.Af.allowDynamicArray;if(B&&!B.expandRows()&&(O=!1),B&&!B.expandColumns()&&(j=!1),B&&B.isBranch()&&(G||t.vi())){if(D=B.findTestArgument(),c=[],f=!1,r)for(h=0;h<r.length;h++)c.push(r[h]),r[h]===D&&(f=!0);if(f||g(n[D])||m(n[D])){for(p=0;p<L.arguments.length;p++)p!==D&&o.Common.k.Cb(c,p)<0&&(g(n[p])||m(n[p]))&&c.push(p);r=c}}for(d=[],v=r[y=0],C=n.length,x=[],w=0;w<C;w++)T=n[w],a=l,s=l,P=_=1,w===v?(a=g(T)?T:l,s=m(T)?T:l,(a||s)&&(P=a&&a.getRowCount()||(O?s.getRowCount(0):1),_=a&&a.getColumnCount()||(j?s.getColumnCount(0):1)),v=++y<r.length?r[y]:-1):i===u&&(a=g(T)?T:l,s=m(T)?T:l,(a||s)&&(P=a&&a.getRowCount()||(O?s.getRowCount(0):1),_=a&&a.getColumnCount()||(j?s.getColumnCount(0):1))),x[w]=[a,s,T,P,_],N=P>N?P:N,E=_>E?_:E;for(w=0;w<C;w++){if(S=d[w]=[],a=(A=x[w])[0],s=A[1],T=A[2],P=A[3],_=A[4],(a||s)&&(1!==P&&P!==N||1!==_&&_!==E)&&(-1===D||w===D)&&!G)return;for(I=0;I<N;I++)for(R=S[I]=[],k=0;k<E;k++)1!==P&&I>=P||1!==_&&k>=_?R[k]=b:a?(M=a.getValue(1===P?0:I,1===_?0:k),g(M)&&(M=M.getValue(0,0)),R[k]=M):s?!i||i[w]?R[k]=s.getValue(0,1===P?0:I,1===_?0:k):R[k]=s.create([F(s.getRow(0)+(1===P?0:I),s.getColumn(0)+(1===_?0:k),1,1)]):R[k]=T}return d},t}(),e.Evaluator=I,R=function(){function t(t,e){this.id=t,this.Fi=u,this.v5=!1,this.oi=[],e!==u&&(this.evaluateMode=e)}return t.prototype.canEvaluate=function(){var t,e=this.oi;for(t=0;t<e.length;t++)if(!e[t].v5)return!1;return!0},t}(),e.AsyncFunctionNode=R,k=function(){function t(t){var e=this;e.w5=[],e.x5=-1,e.y5={},e.z5=-1,e.lh=t,e.vQa=0}return t.prototype.startCalc=function(){var t,e,n,o,r,i,a,s,l;if(this.vQa)for(e in this.y5)if(n=this.y5[e])for(o in n)if(r=n[o])for(i in r)if((a=r[i])&&(t=a.length)>0)for(s=0;s<t;s++)0===(l=a[s]).evaluateMode&&(l.v5=!1)},t.prototype.startCalcCell=function(t,e){var n,o,r,i,a=this,s=t.getName(),l=e.row,u=e.col;return a.z5=-1,a.source=t,(n=a.y5[s])||(n=a.y5[s]={}),(o=n[l])||(o=n[l]={}),(r=o[u])?void(a.cellNodes=r):(i=new R(-1),r=o[u]=[],a.vQa++,a.x5=-1,a.cellNodes=r,a.row=l,a.col=u,r.root=i,a.w5[++a.x5]=i,void(a.evaluateMode=-1))},t.prototype.startCalcFunction=function(t,e,n){var o,r,i,a,s,l,u,c,f,h=this;if(h.z5++,h.isNewNode=!1,o=h.cellNodes[h.z5])return h.currentNode=o,o;if(h.isNewNode=!0,r=h.evaluateMode,i=t.evaluateMode(),"REFRESH"===t.name?(i=e[1]?h.lh.evaluate(e[1],n,!1,!1):0,h.evaluateMode=i):-1!==r&&(i=r),o=new R(h.z5,i),h.cellNodes[h.z5]=o,h.w5[h.x5].oi.push(o),o.parent=h.w5[h.x5],h.w5.push(o),h.x5++,h.currentNode=o,2===i&&-1===r){for(6e4,a=h.intervals,s=t.interval()||6e4,"REFRESH"===t.name&&(o.isRefresh=!0,s=e[2]?h.lh.evaluate(e[2],n,!1,!1):6e4),a||(h.intervals=a={}),(l=a[s])||"object"!=typeof window||((l=a[s]=[]).intervalObj=window.setInterval((function(){var t,e,n=h.intervals[s];for(u=0;u<n.length;u++)(e=(t=n[u]).node).v5=!1,e.isRefresh&&_(e),h.lh.service.recalculate(t.source,t.row,t.col,!0),h.source.refresh()}),s)),c=!1,u=0;u<l.length;u++)if((f=l[u]).source===h.source&&f.node===o&&f.row===h.row&&f.col===h.col){c=!0;break}c||l.push({source:h.source,node:o,row:h.row,col:h.col})}return o},t.prototype.getNode=function(){return this.currentNode},t.prototype.endCalcFunction=function(){this.isNewNode&&(this.w5.pop(),this.x5--),this.currentNode=this.currentNode.parent},t.prototype.endCalcCell=function(){var t,e=[];for(t=0;t<arguments.length;t++)e[t]=arguments[t]},t.prototype.clearCell=function(t,e){var n,o,r,i,a,s,l,c,f,h,p,d,g,m,y=this;if(y.vQa&&(n=t.getName(),o=e.row,r=e.col,y.z5=-1,y.source=t,(i=y.y5[n])&&((a=i[o])&&((s=a[r])&&((c=(l=s[0])&&l.h_a)&&(delete c.nia,delete c.z$a),a[r]=u,y.vQa--))),"object"==typeof window))for(h in f=y.intervals)if(p=f[h]){for(d=[],g=0;g<p.length;g++)(m=p[g]).source===t&&m.row===e.row&&m.col===e.col||d.push(m);d.length?d.length!==p.length&&(d.intervalObj=p.intervalObj,f[h]=d):(f[h]=u,window.clearInterval(p.intervalObj))}},t.prototype.setAsyncResult=function(t,e){t.Fi=e},t.prototype.addRows=function(t,e,n){this.GQa(t,e,n,!0)},t.prototype.deleteRows=function(t,e,n){this.GQa(t,e,n,!1)},t.prototype.GQa=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m=this;if(m.vQa){if(r=t.getName(),i=m.y5[r]){for(s in a={},i)(l=i[s])&&(u=parseInt(s,10),o?a[u>=e?u+n:u]=l:u<e?a[u]=l:u>=e+n&&(a[u-n]=l));m.y5[r]=a}for(f in c=m.intervals)if(h=c[f]){for(p=[],d=0;d<h.length;d++)(g=h[d]).source===t&&o&&g.row>=e?g.row+=n:g.source===t&&!o&&(g.row<e||g.row>=e+n)&&(g.row=g.row<e?g.row:g.row-n,p.push(g));o||p.length===h.length||(p.intervalObj=h.intervalObj,c[f]=p)}}},t.prototype.addColumns=function(t,e,n){this.HQa(t,e,n,!0)},t.prototype.deleteColumns=function(t,e,n){this.HQa(t,e,n,!1)},t.prototype.HQa=function(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y,v=this;if(v.vQa){if(r=t.getName(),i=v.y5[r])for(a in i)if(s=i[a]){for(u in l={},s)(c=s[u])&&c.length&&(f=parseInt(u,10),o?l[f>=e?f+n:f]=c:f<e?l[f]=c:f>=e+n&&(l[f-n]=c));i[a]=l}for(p in h=v.intervals)if(d=h[p]){for(g=[],m=0;m<d.length;m++)(y=d[m]).source===t&&o&&y.col>=e?y.col+=n:y.source===t&&!o&&(y.col<e||y.col>=e+n)&&(y.col=y.col<e?y.col:y.col-n,g.push(y));o||g.length===d.length||(g.intervalObj=d.intervalObj,h[p]=g)}}},t.prototype.changeSourceName=function(t,e){var n,o=this;o.vQa&&((n=o.y5[t])&&(o.y5[e]=n,delete o.y5[t]))},t}(),e.evaluateOperator=B,M=r.Convert.Pa,N=r.Convert.Rh,E=r.Convert.bc,D=r.Convert.Xh,O=r.Convert.Vh},"./src/referenceExpression.ts":function(t,e,n){"use strict";var o,r,i,a,s,l=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function u(t,e,n,o,r,i){var s=new a(1);return s.row=n,s.column=o,s.rowRelative=r,s.columnRelative=i,t&&(s.source=t),e&&(s.endSource=e),s}function c(t,e,n,r,i,s,l,u,c,f,h,p,d){var g,m,y,v,C,b=new a(1);return b.isFullRow=r===o.BAND_INDEX_CONST,h=h||0,p=p||0,m=n-(l?0:h),y=r-(u?0:p),v=i-(c?0:h),C=s-(f?0:p),b.isFullRow&&0===n&&i===o.MAX_ROW_COUNT-1&&(n=i=o.BAND_INDEX_CONST),b.isFullColumn=n===o.BAND_INDEX_CONST,m>v&&(g=n,n=i,i=g,g=l,l=c,c=g),y>C&&(g=r,r=s,s=g,g=u,u=f,f=g),b.row=n,b.column=r,b.endRow=i,b.endColumn=s,b.rowRelative=l,b.columnRelative=u,b.endRowRelative=c,b.endColumnRelative=f,b.isArrayReference=d,t&&(b.source=t),e&&(b.endSource=e),b}function f(t,e,n){var r,a,s,l,u={row:-1,col:-1,rowCount:-1,colCount:-1};return t.isFullRow?(u.col=-1,u.colCount=-1):(t.columnRelative?s=(s=t.column+n)>=o.MAX_COLUMN_COUNT?s%o.MAX_COLUMN_COUNT:s:s=t.column,t.sf()?(u.col=s,u.colCount=1):(t.endColumnRelative?l=(l=t.endColumn+n)>=o.MAX_COLUMN_COUNT?l%o.MAX_COLUMN_COUNT:l:l=t.endColumn,u.col=s<=l?s:l,u.colCount=i(l-s)+1)),t.isFullColumn?(u.row=-1,u.rowCount=-1):(t.rowRelative?r=(r=t.row+e)>=o.MAX_ROW_COUNT?r%o.MAX_ROW_COUNT:r:r=t.row,t.sf()?(u.row=r,u.rowCount=1):(t.endRowRelative?a=(a=t.endRow+e)>=o.MAX_ROW_COUNT?a%o.MAX_ROW_COUNT:a:a=t.endRow,u.row=r<=a?r:a,u.rowCount=i(a-r)+1)),u}function h(t,e,n,o,r,i,a,l){var u=new s(o,r,i,a,l);return u.contextSource=t,u.source=e,u.endSource=n,u}function p(t,e){return h(t,e,r,0,0,!1,!1,!0)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/calc.common.ts"),r=void 0,i=Math.abs,a=function(t){function e(e){return t.call(this,e)||this}return l(e,t),e.prototype.sf=function(){return this.endRow===r||this.endColumn===r},e.prototype.tf=function(){var t=this;return t.isFullRow&&t.isFullColumn?3:t.isFullRow?1:t.isFullColumn?2:0},e.prototype.getRange=function(t,e){return f(this,t,e)},e.prototype.offset=function(t,e,n,o,r){var i,a=this,s=a.source,l=a.endSource;return a.sf()?u(s,l,a.row+(a.rowRelative||n?t:0),a.column+(a.columnRelative||n?e:0),a.rowRelative,a.columnRelative):((i=c(s,l,a.row+(a.rowRelative||n?t:0),a.column+(a.columnRelative||n?e:0),a.endRow+(a.isFullColumn||!a.endRowRelative&&!n?0:t),a.endColumn+(a.isFullRow||!a.endColumnRelative&&!n?0:e),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,o,r)).isFullRow=a.isFullRow,i.isFullColumn=a.isFullColumn,i)},e.prototype.offset2=function(t,e,n,o,r,i){var a=this,s=c(a.source,a.endSource,a.row+(a.isFullColumn?0:t),a.column+(a.isFullRow?0:e),a.endRow+(a.isFullColumn?0:n),a.endColumn+(a.isFullRow?0:o),a.rowRelative,a.columnRelative,a.endRowRelative,a.endColumnRelative,r,i);return s.isFullRow=a.isFullRow,s.isFullColumn=a.isFullColumn,s},e}(o.Expression),e.ReferenceExpression=a,e.rf=u,e.uf=c,e.getRangeForReference=f,s=function(t){function e(e,n,o,r,i){var a=t.call(this,33)||this;return a.row=e,a.column=n,a.rowRelative=o,a.columnRelative=r,a.isReferenceError=i,a.sf=function(){return!this.isReferenceError},a.getRange=function(t,e){var n,o,r,i,a,s=this,l=s.source||s.contextSource;if(!s.isReferenceError&&l&&(o=(n=f(s,t,e)).row,r=n.col,i=l.getReference({row:o,col:r,spillRef:!0})))return a={spillRef:!0,row:o,col:r,rowCount:i.getRowCount(),colCount:i.getColumnCount()},i.isSpillError&&(a.isSpillError=!0),a},a.offset=function(t,e,n){var o=this,r=o.contextSource,i=o.source,a=o.endSource;return this.isReferenceError?p(r,i):h(r,i,a,o.row+(o.rowRelative||n?t:0),o.column+(o.columnRelative||n?e:0),o.rowRelative,o.columnRelative)},a}return l(e,t),e}(o.Expression),e.SpillReferenceExpression=s,e.BLb=h,e.lOb=p},Common:function(t,e){t.exports=n("Common")}}),t.exports=o.Spread.CalcEngine},"./node_modules_local/@grapecity/js-calc/index.js":function(t,e,n){t.exports=n("./node_modules_local/@grapecity/js-calc/dist/gc.spread.calcengine.js")},"./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js":function(t,e){var n="object"==typeof n?n:{};n.Spread=function(t){var e={};function n(o){if(e[o])return e[o].exports;var r=e[o]={i:o,l:!1,exports:{}};return t[o].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,o){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){var o,r;if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(o=Object.create(null),n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(r in t)n.d(o,r,(function(e){return t[e]}).bind(null,r));return o},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/assets/",n(n.s="./src/all.entry.ts")}({"./node_modules/webpack/buildin/global.js":function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},"./src/all.entry.ts":function(t,e,n){"use strict";var o,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/common.entry.ts"),e.Common=o,r=n("./src/plugins/commands/commands.entry.ts"),e.Commands=r,i=n("./src/plugins/formatter/formatter.entry.ts"),e.Formatter=i,a=n("./src/plugins/sparkline/sparkline.entry.ts"),e.Sparklines=a,s=n("./src/plugins/slicer/slicer.entry.ts"),e.Slicers=s},"./src/common/common.entry.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c;function f(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/colorhelper.ts"),e.pc=o.pc,r=n("./src/common/util/types.ts"),e.j=r.j,i=n("./src/common/util/arrayhelper.ts"),e.k=i.k,a=n("./src/common/util/datetimehelper.ts"),e.l=a.l,s=n("./src/common/util/numberhelper.ts"),e.o=s.o,l=n("./src/common/util/regexhelper.ts"),e.q=l.q,u=n("./src/common/util/stringhelper.ts"),e.u=u.u,f(n("./src/common/util/common.ts")),c=n("./src/common/culture/cultureInfo.ts"),e.CultureInfo=c.CultureInfo,e.CultureManager=c.CultureManager,f(n("./src/common/util/functionhelper.ts"))},"./src/common/culture/cultureInfo.ts":function(t,e,n){"use strict";(function(t){var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function I(t){return t.split("Â ").join(" ").toUpperCase()}function R(t){var e,n,o=[];for(e=0,n=t.length;e<n;e++)o[e]=I(t[e]);return o}function k(t,e,n){var o=I(t),r=e.indexOf(o);return-1===r&&(r=n.indexOf(o)),r}function M(t,e,n){var o,r,i;for(r=0,i=e.length;r<i;r++)o=e[r],this[t][o]=n[r]}function N(t){var e;"object"==typeof document&&("function"!=typeof CustomEvent?(e=document.createEvent("CustomEvent")).initCustomEvent("cultureChanged",!1,!1,void 0):e=new CustomEvent("cultureChanged",{}),e.cultureInfo=t,a.gcCultureInfo=t,document.dispatchEvent(e))}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/types.ts"),r=n("./src/common/util/common.ts"),i=n("./src/common/util/arrayhelper.ts"),a="undefined"!=typeof window?window:t,s=void 0,l=null,u=o.j.H,c=o.j.Ia,h=["hh:mm:ss","hh:mm:s","hh:m:ss","hh:m:s","h:mm:ss","h:mm:s","h:m:ss","h:m:s","hh:mm:ss tt","hh:mm:s tt","hh:m:ss tt","hh:m:s tt","h:mm:ss tt","h:mm:s tt","h:m:ss tt","h:m:s tt","hh:mm","hh:m","h:mm","h:m","hh:mm tt","hh:m tt","h:mm tt","h:m tt"],p=["MM-dd-yyyy","MM-d-yyyy","M-dd-yyyy","M-d-yyyy","yy-MM-dd","yy-MM-d","yy-M-dd","yy-M-d","yyyy-MM-dd","yyyy-MM-d","yyyy-M-dd","yyyy-M-d","dd-MMMM-yy","dd-MMM-yy"],d=(f=["MM/dd/yyyy","MM/d/yyyy","M/dd/yyyy","M/d/yyyy","yy/MM/dd","yy/MM/d","yy/M/dd","yy/M/d","yyyy/MM/dd","yyyy/MM/d","yyyy/M/dd","yyyy/M/d"]).concat(h),u(f,(function(t,e){u(h,(function(t,n){t<h.length-4&&d.push(e+" "+n)}))})),d=d.concat(p),u(p,(function(t,e){u(h,(function(t,n){t<h.length-4&&d.push(e+" "+n)}))})),g=function(){function t(){this.NumberFormat={currencyDecimalDigits:2,currencyDecimalSeparator:".",currencyGroupSeparator:",",currencyGroupSizes:[3],currencyNegativePattern:0,currencyPositivePattern:0,currencySymbol:"Â¤",digitSubstitution:1,isReadOnly:!0,numberGroupSizes:[3],nanSymbol:"NaN",nativeDigits:["0","1","2","3","4","5","6","7","8","9"],numberNegativePattern:1,negativeInfinitySymbol:"-Infinity",negativeSign:"-",numberDecimalDigits:2,numberDecimalSeparator:".",numberGroupSeparator:",",positiveInfinitySymbol:"Infinity",positiveSign:"+",percentDecimalDigits:2,percentDecimalSeparator:".",percentGroupSeparator:",",percentGroupSizes:[3],percentNegativePattern:0,percentPositivePattern:0,percentSymbol:"%",perMilleSymbol:"â°",listSeparator:",",arrayListSeparator:",",arrayGroupSeparator:";",dbNumber:{},standardDictionaryNumbers:{Hundreds:"Hundreds",Thousands:"Thousands",Millions:"Millions",Billions:"Billions",Trillions:"Trillions"}},this.DateTimeFormat={abbreviatedDayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],abbreviatedMonthGenitiveNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],abbreviatedMonthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec",""],amDesignator:"AM",calendarIsReadOnly:!0,calendarWeekRule:0,Calendar:{MinSupportedDateTime:"@-62135568000000@",MaxSupportedDateTime:"@253402300799999@",AlgorithmType:1,CalendarType:1,Eras:[1],TwoDigitYearMax:2029,isReadOnly:!0},dateSeparator:"/",dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],defaultDatePattern:"MM/dd/yyyy H:mm:ss",firstDayOfWeek:0,fullDateTimePattern:"dddd, dd MMMM yyyy HH:mm:ss",longDatePattern:"dddd, dd MMMM yyyy",longTimePattern:"HH:mm:ss",monthDayPattern:"MMMM dd",monthGenitiveNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],monthNames:["January","February","March","April","May","June","July","August","September","October","November","December",""],nativeCalendarName:"Gregorian Calendar",pmDesignator:"PM",rfc1123Pattern:"ddd, dd MMM yyyy HH':'mm':'ss 'GMT'",shortDatePattern:"MM/dd/yyyy",shortestDayNames:["Su","Mo","Tu","We","Th","Fr","Sa"],shortTimePattern:"HH:mm",sortableDateTimePattern:"yyyy'-'MM'-'dd'T'HH':'mm':'ss",timeSeparator:":",universalSortableDateTimePattern:"yyyy'-'MM'-'dd HH':'mm':'ss'Z'",yearMonthPattern:"yyyy MMMM",filterDialogDateFormatter:"yyyy/mmmm/dd",preselectedFormatters:[],eraFormatter:["ge/M/d","ge-M-d","ge.M.d","gee/MM/dd"]},this.name=function(){return""},this.id=-1}return t.prototype.ma=function(){var t,e,n,o;return this.na||(n=(n=[e=(t=this.DateTimeFormat).shortDatePattern.replace(/m/g,"M"),e+" h:mm",e+" h:mm:ss",e+" h:mm:ss.0","MMMdd","MMMd","MMM dd","MMM d"]).concat(d),1041===this.id&&(o=t.eraFormatter,n=(n=n.concat(this._Ab)).concat(o)),n=n.concat(t.preselectedFormatters),this.na=n),this.na},t.prototype.oa=function(t){var e=this;return e.pa||(e.pa=R(e.DateTimeFormat.monthNames),e.qa=R(e.DateTimeFormat.monthGenitiveNames)),k(t,e.pa,e.qa)},t.prototype.ra=function(t){var e=this;return e.sa||(e.sa=R(e.DateTimeFormat.abbreviatedMonthNames),e.ta=R(e.DateTimeFormat.abbreviatedMonthGenitiveNames)),k(t,e.sa,e.ta)},t.prototype.ua=function(t){var e=this;return e.va||(e.va=R(e.DateTimeFormat.dayNames)),e.va.indexOf(I(t))},t.prototype.wa=function(t){var e=this;return e.xa||(e.xa=R(e.DateTimeFormat.abbreviatedDayNames)),e.xa.indexOf(I(t))},t}(),e.CultureInfo=g,m=function(){function t(){}return t.I=function(e){return e>=t.J()&&e<=t.K()},t.L=function(){var t,e,n=g.eras;if(n!==s){for(t=[],e=0;e<n.length;e++)t[e]=new Date(n[e].startDate.replace(/-/g,"/"));return t}return this.O},t.P=function(e){var n,o,r,i,a;switch(e){case"g":n="symbol",o=t.R;break;case"gg":n="abbreviation",o=t.S;break;case"ggg":n="name",o=t.U;break;default:return[]}if(i=[],(r=g.eras)!==s){for(a=0;a<r.length;a++)i[a]=r[a][n];return i}return o},t.K=function(){var t,e=g.eras;return e!==s&&e.length>0?((t=new Date(e[e.length-1].startDate.replace(/-/g,"/"))).setFullYear(t.getFullYear()+99),t):this.W},t.J=function(){var t=g.eras;return t!==s&&t.length>0?new Date(t[0].startDate.replace(/-/g,"/")):this.Z},t.$=function(){var t=g.eras;return t!==s?t.length:this._},t.aa=function(){var t,e,n,o,r=g.eras;if(r!==s){for(t=[],e=1;e<r.length;e++)n=new Date(r[e-1].startDate.replace(/-/g,"/")),o=new Date(r[e].startDate.replace(/-/g,"/")),t[e-1]=o.getFullYear()-n.getFullYear()+1;return t[e-1]=99,t}return this.ba},t.ca=function(e){var n,o={da:-1,ea:-1};if(!t.I(e))return o;for(n=0;n<t.$();n++)if(e<(n+1!==t.$()?t.L()[n+1]:t.fa(t.K(),1))){o.da=n,o.ea=e.getFullYear()-t.L()[n].getFullYear()+1;break}return o},t.fa=function(t,e){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());return n.setMilliseconds(n.getMilliseconds()+e),new Date(n.valueOf())},t.ga=function(e,n){return t.L()[e].getFullYear()+n-1},t.ha=function(e,n){var o,r;for(n=n.toUpperCase(),o=t.P(e),r=0;r<o.length;r++)if(o[r]===n)return r;return-1},t.ia=function(e,n,o){var r,i,a,s=t,l=s.ca(n),u=l.da;if(u>=0&&(r=s.P(e)).length>0)return r[u];if((i=l.ea)>=0){if("1"===(a=""+i)&&o)return"å";if("ee"===e)return 1===a.length&&(a="0"+a),a;if("e"===e)return a}return""},t.O=[new Date(1868,8,8),new Date(1912,6,30),new Date(1926,11,25),new Date(1989,0,8),new Date(2019,4,1)],t._=5,t.ba=[45,15,64,31,99],t.W=new Date(2117,11,31,23,59,59),t.Z=new Date(1868,8,8),t.ja=["1,m","2,t","3,s","4,h","5,r"],t.ka=[0,1,2,3,0,1,2,3],t.U=["ææ²»","å¤§æ­£","æ­å","å¹³æ","ä»¤å"],t.R=["M","T","S","H","R"],t.S=["æ","å¤§","æ­","å¹³","ä»¤"],t.la=99,t.eraExcelFormatter="[$-ja-JP-x-gannen]",t.eraInternalFormatter="[$-411]",t}(),e.aBb=m,y=function(t){function e(){var e,n=t.call(this)||this;return M.call(n,"NumberFormat",["currencySymbol","isReadOnly"],["$",!1]),e=["MMM yyyy","MMMM yyyy"],M.call(n,"DateTimeFormat",["fullDateTimePattern","longDatePattern","longTimePattern","shortDatePattern","shortTimePattern","yearMonthPattern","calendarIsReadOnly","preselectedFormatters"],["dddd, MMMM dd, yyyy h:mm:ss tt","dddd, MMMM dd, yyyy","h:mm:ss tt","M/d/yyyy","h:mm tt","MMMM, yyyy",!1,e]),n.DateTimeFormat.defaultDatePattern=n.DateTimeFormat.shortDatePattern+" H:mm:ss",n.name=function(){return"en-US"},n.id=1033,n}return A(e,t),e}(g),v=function(t){function e(){var e,n,o,r=t.call(this)||this,i={1:{letters:["å","å","ç¾","å","äº¿","å","ç¾","å","ä¸","å","ç¾","å",""],numbers:["ã","ä¸","äº","ä¸","å","äº","å­","ä¸","å«","ä¹"]},2:{letters:["å","é¡","ç¾","æ¾","å","é¡","ç¾","æ¾","è¬","é¡","ç¾","æ¾",""],numbers:["ã","å£±","å¼","å","å","ä¼","å­","ä¸","å«","ä¹"]},3:{letters:l,numbers:["ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼"]}};return M.call(r,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[0,1,"Â¥",!1,"NaN (éæ°å¤)","-â",1,1,"+â",i,{Hundreds:"ç¾",Thousands:"å",Millions:"ç¾ä¸",Billions:"åå",Trillions:"å"}]),e=["1","2","3","4","5","6","7","8","9","10","11","12",""],n=["1æ","2æ","3æ","4æ","5æ","6æ","7æ","8æ","9æ","10æ","11æ","12æ",""],o=["yyyyå¹´Mædæ¥","yyyyå¹´Mæddæ¥","yyyyå¹´MMædæ¥","yyyyå¹´MMæddæ¥"],M.call(r,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter","preselectedFormatters","EraFilterDialogDateFormatter"],[["æ¥","æ","ç«","æ°´","æ¨","é","å"],e,e,"åå",!1,["æ¥ææ¥","æææ¥","ç«ææ¥","æ°´ææ¥","æ¨ææ¥","éææ¥","åææ¥"],"yyyy'å¹´'M'æ'd'æ¥' H:mm:ss","yyyy'å¹´'M'æ'd'æ¥'","H:mm:ss","M'æ'd'æ¥'",n,n,"è¥¿æ¦ (æ¥æ¬èª)","åå¾","yyyy/MM/dd",["æ¥","æ","ç«","æ°´","æ¨","é","å"],"H:mm","yyyy'å¹´'M'æ'","yyyyå¹´/mmmm/dæ¥",o,"ggge/mmmm/dæ¥"]),r.DateTimeFormat.eras=!0,r.DateTimeFormat.defaultDatePattern=r.DateTimeFormat.shortDatePattern+" "+r.DateTimeFormat.longTimePattern,r._Ab=['gggee"å¹´"MM"æ"dd"æ¥','gggee"å¹´"M"æ"d"æ¥','ge"å¹´"M"æ"d"æ¥','ggge"å¹´"M"æ"d"æ¥','ggee"å¹´"M"æ"d"æ¥','gge"å¹´"M"æ"d"æ¥'],r.name=function(){return"ja-JP"},r.id=1041,r.isJCKCulture=!0,r}return A(e,t),e}(g),C=function(t){function e(){var e,n,o=t.call(this)||this,r={1:{letters:["å","å","ç¾","å","äº¿","å","ç¾","å","ä¸","å","ç¾","å",""],numbers:["â","ä¸","äº","ä¸","å","äº","å­","ä¸","å«","ä¹"]},2:{letters:["å","ä»","ä½°","æ¾","äº¿","ä»","ä½°","æ¾","ä¸","ä»","ä½°","æ¾",""],numbers:["é¶","å£¹","è´°","å","è","ä¼","é","æ","æ","ç"]},3:{letters:l,numbers:["ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼"]}};return M.call(o,"NumberFormat",["currencyNegativePattern","currencySymbol","isReadOnly","nanSymbol","negativeInfinitySymbol","percentNegativePattern","percentPositivePattern","positiveInfinitySymbol","dbNumber","standardDictionaryNumbers"],[2,"Â¥",!1,"éæ°å­","è´æ ç©·å¤§",1,1,"æ­£æ ç©·å¤§",r,{Hundreds:"ç¾",Thousands:"å",Millions:"ç¾ä¸",Billions:"åäº¿",Trillions:"å"}]),e=["1æ","2æ","3æ","4æ","5æ","6æ","7æ","8æ","9æ","10æ","11æ","12æ",""],n=["ä¸æ","äºæ","ä¸æ","åæ","äºæ","å­æ","ä¸æ","å«æ","ä¹æ","åæ","åä¸æ","åäºæ",""],M.call(o,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["å¨æ¥","å¨ä¸","å¨äº","å¨ä¸","å¨å","å¨äº","å¨å­"],e,e,"ä¸å",!1,["æææ¥","ææä¸","ææäº","ææä¸","ææå","ææäº","ææå­"],1,"yyyy'å¹´'M'æ'd'æ¥' H:mm:ss","yyyy'å¹´'M'æ'd'æ¥'","H:mm:ss","M'æ'd'æ¥'",n,n,"å¬å","ä¸å","yyyy/M/d",["æ¥","ä¸","äº","ä¸","å","äº","å­"],"H:mm","yyyy'å¹´'M'æ'","yyyyå¹´/mmmm/dæ¥"]),o.DateTimeFormat.defaultDatePattern=o.DateTimeFormat.shortDatePattern+" "+o.DateTimeFormat.longTimePattern,o.name=function(){return"zh-cn"},o.id=2052,o.isJCKCulture=!0,o.localeCompare=function(t,e){return t.localeCompare(e,"en")},o}return A(e,t),e}(g),b=function(t){function e(){var e,n,o=t.call(this)||this;return M.call(o,"NumberFormat",["currencyDecimalDigits","currencyNegativePattern","currencySymbol","isReadOnly","dbNumber","standardDictionaryNumbers"],[0,1,"â©",!1,{1:{letters:["å","å","ç¾","å","å","å","ç¾","å","ä¸","å","ç¾","å",""],numbers:["ï¼","ä¸","äº","ä¸","å","äº","ï§","ä¸","å«","ä¹"]},2:{letters:["å","é¡","ç¾","ï¥³","å","é¡","ç¾","ï¥³","è¬","é¡","ç¾","ï¥³",""],numbers:["ï¦²","å£¹","è²³","ï¥«","å","ä¼","ï§","ä¸","å«","ä¹"]},3:{letters:["å","å","ç¾","å","å","å","ç¾","å","ä¸","å","ç¾","å",""],numbers:["ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼","ï¼"]},4:{letters:["ì¡°","ì²","ë°±","ì­","ìµ","ì²","ë°±","ì­","ë§","ì²","ë°±","ì­",""],numbers:["â","ì¼","ì´","ì¼","ì¬","ì¤","ì¡","ì¹ ","í","êµ¬"]}},{Hundreds:"ë°±",Thousands:"ì²",Millions:"ë°±ë§",Billions:"10ìµ",Trillions:"ì¡°"}]),e=["1","2","3","4","5","6","7","8","9","10","11","12",""],n=["1ì","2ì","3ì","4ì","5ì","6ì","7ì","8ì","9ì","10ì","11ì","12ì",""],M.call(o,"DateTimeFormat",["abbreviatedDayNames","abbreviatedMonthGenitiveNames","abbreviatedMonthNames","amDesignator","calendarIsReadOnly","dayNames","firstDayOfWeek","fullDateTimePattern","longDatePattern","longTimePattern","monthDayPattern","monthGenitiveNames","monthNames","nativeCalendarName","pmDesignator","shortDatePattern","shortestDayNames","shortTimePattern","yearMonthPattern","filterDialogDateFormatter"],[["ì¼","ì","í","ì","ëª©","ê¸","í "],e,e,"ì¤ì ",!1,["ì¼ìì¼","ììì¼","íìì¼","ììì¼","ëª©ìì¼","ê¸ìì¼","í ìì¼"],1,"yyyy'ë' M'ì' d'ì¼' dddd h:mm:ss","yyyy'ë' M'ì' d'ì¼' dddd","h:mm:ss","M'ì' d'ì¼'",n,n,"ìê¸°","ì¤í","yyyy-MM-dd",["ì¼","ì","í","ì","ëª©","ê¸","í "],"tt h:mm","yyyy'ë' M'ì'","yyyyë/mmmm/dì¼"]),o.DateTimeFormat.defaultDatePattern=o.DateTimeFormat.shortDatePattern+" "+o.DateTimeFormat.longTimePattern,o.name=function(){return"ko-kr"},o.id=1042,o.isJCKCulture=!0,o}return A(e,t),e}(g),w={invariant:new g,"en-us":new y,"ja-jp":new v,"zh-cn":new C,"ko-kr":new b},T={},x=["lsru","lsde","ls1","ls2","ls3","ls4","ls5","ls6"],S=function(){function t(){this.bBb=1}return t.instance=function(){return this.cBb||(this.cBb=new this)},t.prototype.culture=function(e){return 0===arguments.length?t.dBb:void(e&&t.dBb!==e&&(t.dBb=e.toLowerCase(),this.bBb++,N(t.dBb)))},t.prototype.addCultureInfo=function(t,e,n){var o,i,a,s;if(e&&e instanceof g){if(o=e.NumberFormat&&e.NumberFormat.numberDecimalSeparator,i=e.NumberFormat.arrayListSeparator,a=e.NumberFormat.arrayGroupSeparator,o===e.NumberFormat.listSeparator||a===i)throw new r.ResourceManager(r.SR).getResource().Exp_Separator;w[t.toLowerCase()]=e}n&&"object"==typeof n&&(s=t.toLowerCase(),T[s]=c(!0,{},n),this.bBb++)},t.prototype.getCultureInfo=function(e){var n,o,r;if(0===arguments.length)return w[t.dBb];for(r in"string"==typeof e&&(e=e.toLowerCase()),o=l,n=w)if(r===e||n[r].id!==s&&n[r].id===e){o=n[r];break}return o},t.prototype.getLanguage=function(t){if("string"==typeof t){var e=t.toLowerCase();return T[e]}return l},t.prototype.eBb=function(t,e){var n,o,r=T[t.toLowerCase()];for(n in e)i.k.Bb(x,n)||null!==(o=this.fBb(r,n))&&"string"==typeof o&&"string"==typeof e[n]&&(e[n]=o);e._h&&r.Functions&&this.gBb(r.Functions,e._h),e.B2&&r.TableFunctions&&c(!0,e.B2,r.TableFunctions)},t.prototype.fBb=function(t,e){var n,o;if(t.hasOwnProperty(e))return t[e];for(n in t)if("object"==typeof(o=t[n])&&o.hasOwnProperty(e))return o[e];return null},t.prototype.gBb=function(t,e){var n,o,r,i,a,s,l;for(n in e)if(t.hasOwnProperty(n))for(s in o=e[n],r=t[n],i=o.parameters,a=r.parameters,o.description=r.description,i)a.hasOwnProperty(s)&&("string"==typeof(l=a[s])&&(i[s].name=l));return{}},t.prototype.q4=function(e){var n=this.getCultureInfo(e);return n||((n=w[t.dBb])||(n=new g)),n},t.prototype.LZa=function(t,e){var n=(this.getCultureInfo(t)||this.getCultureInfo("en-US")).DateTimeFormat,o=n.filterDialogDateFormatter;return(e.indexOf("g")>=0||e.indexOf("e")>=0)&&(o=n.EraFilterDialogDateFormatter||o),o},t.dBb="en-us",t}(),e.CultureManager=S.instance()}).call(this,n("./node_modules/webpack/buildin/global.js"))},"./src/common/util/arrayhelper.ts":function(t,e,n){"use strict";var o,r;Object.defineProperty(e,"__esModule",{value:!0}),o=null,r=function(){function t(){}return t.Eb=function(t,e,n){t.splice(e,0,n)},t.Sb=function(t,e){t.push(e)},t.Bb=function(t,e){return t.indexOf(e)>-1},t.Fb=function(t,e){var n=t.indexOf(e);n>-1&&t.splice(n,1)},t.Zb=function(t,e){return t.slice(0,e).concat(t.slice(e+1))},t.Cb=function(t,e,n){return t.indexOf(e,n)},t.$b=function(t,e,n){if(!(e<0))for(var r=0;r<n&&e+r<t.length;r++)t[e+r]=o},t._b=function(t,e){var n;for(e<0&&(e=-1),n=e+1;n<t.length;n++)if(void 0!==t[n]&&t[n]!==o)return n;return-1},t.ac=function(t){return t&&t.length},t.Uo=function(t){var e=[];return function t(e,n){var r,i;for(r in n)n.hasOwnProperty(r)&&(i=n[r],Array.isArray(i)?(e[r]=[],t(e[r],n[r])):i!==o&&"object"==typeof i?(e[r]={},t(e[r],n[r])):e[r]=n[r])}(e,t),e},t}(),e.k=r},"./src/common/util/colorhelper.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f;function h(t,e,n){return n<0&&(n+=240),n>240&&(n-=240),n<40?t+((e-t)*n+20)/40:n<120?e:n<160?t+((e-t)*(160-n)+20)/40:t}function p(t,e,n){var o,r,i,a,s;return 0===n?o=r=i=l(255*e/240+"",10):(void 0,void 0,o=d(a=2*e-(s=e<=120?l((e*(240+n)+120)/240+""):e+n-l((e*n+120)/240+"")),s,t+80),r=d(a,s,t),i=d(a,s,t-80)),{a:255,r:o,g:r,b:i}}function d(t,e,n){return i(l((255*h(t,e,n)+120)/240+""),255)}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/numberhelper.ts"),r=o.o.pb,i=Math.min,a=Math.max,s=Math.abs,l=parseInt,u=function(){function t(t){var e,n,o,r,s=this,u=t.r,c=t.g,f=t.b,h=a(a(u,c),f),p=i(i(u,c),f),d=h+p;s.kc=l((240*d+255)/510+"",10),0===(e=h-p)?(s.mc=0,s.lc=160):(s.kc<=120?s.mc=l((240*e+d/2)/d+"",10):s.mc=l((240*e+(510-d)/2)/(510-d)+"",10),n=(40*(h-u)+e/2)/e,o=(40*(h-c)+e/2)/e,r=(40*(h-f)+e/2)/e,s.lc=l(u===h?r-o+"":c===h?80+n-r+"":160+o-n+"",10),s.lc<0&&(s.lc+=240),s.lc>240&&(s.lc-=240))}return t.prototype.nc=function(t){var e=this,n=e.kc,o=e.oc(e.kc,500,!0);return p(e.lc,n+(o-n)*t,e.mc)},t.prototype.oc=function(t,e,n){return 0===e?t:n?e>0?(t*(1e3-e)+241*e)/1e3:t*(e+1e3)/1e3:((t+=240*e/1e3)<0&&(t=0),t>240&&(t=240),t)},t}(),c=/rgb[a]?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(\s*,\s*(\d{0,1}))?\)/,f=function(){function t(){}return t.bc=function(t){var e=t.a,n=t.r,o=t.g,i=t.b;return 3===arguments.length&&(e=255,n=arguments[0],o=arguments[1],i=arguments[2]),4===arguments.length&&(e=arguments[0],n=arguments[1],o=arguments[2],i=arguments[3]),255===e?"#"+r(n,!0,2)+r(o,!0,2)+r(i,!0,2):"rgba("+n+","+o+","+i+","+e+")"},t.Pka=function(t,e){return t.stops||t.type?JSON.stringify(t)===JSON.stringify(e):t.a===e.a&&t.r===e.r&&t.g===e.g&&t.b===e.b},t.dc=function(t){return(299*t.r+587*t.g+114*t.b)/1e3},t.hc=function(t,e){var n=255-s(t.r-e.r),o=255-s(t.g-e.g),r=255-s(t.b-e.b),i=s(t.a-e.a);return!!(((n/=255)+(o/=255)+(r/=255))/3>=.9&&i<=.05)},t.ic=function(e){var n=255^e.r,o=255^e.g,r=255^e.b;return t.bc(e.a,n,o,r)},t.hBb=function(e){var n,o,r;return"object"!=typeof document?function(t){var e,n,o,r;return/^#[A-Fa-f0-9]+$/.test(t)?(e=t.replace(/^#/,""),n=e.length,(o=(o=e.split(3===n?/(.)/:/(..)/)).filter(Boolean).map((function(t){return 3===n?parseInt(t+t,16):parseInt(t,16)})))[0]||(o[0]=0),o[1]||(o[1]=0),o[2]||(o[2]=0),[o[0],o[1],o[2],1]):null!==(r=c.exec(t))?[r[1],r[2],r[3],1]:null}(e):((n=t.Yn)||(o=document.createElement("canvas"))&&o.getContext&&(n=t.Yn=o.getContext("2d")),n?(n.clearRect(1,1,1,1),n.fillStyle=e,n.fillRect(1,1,1,1),(r=n.getImageData(1,1,1,1))?r.data:null):e)},t.ec=function(e){var n,o,r,i,a;return e instanceof t||"object"==typeof e?e:(n=0,o=0,r=0,i=0,e&&((a=t.hBb(e))&&(o=a[0],r=a[1],i=a[2],n=a[3])),{a:n,r:o,g:r,b:i})},t.jc=function(e,n){var o,r;return 0===n?e:(o=new u(e),r=l((n>0?(240-o.kc)*n:o.kc*n)+"",10),t.gc(o.lc,o.kc+r,o.mc))},t.nc=function(e,n){var o=t.ec(e),r=new u(o).nc(n);return t.bc(r)},t.fc=h,t.gc=p,t}(),e.pc=f},"./src/common/util/common.ts":function(t,e,n){"use strict";var o,r,i,a,s;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/culture/cultureInfo.ts"),r=n("./src/common/util/util.res.en.ts"),i=n("./src/common/util/types.ts"),e.SR={en:r},a=i.j.Ia,s=function(){function t(t){this.res=t,this.cachedResource=this.iBb(t,!0),this.bBb=0}return t.prototype.getResource=function(){var t=this.iBb(this.res,!this.cachedResource);return t&&(this.cachedResource=t),this.cachedResource},t.prototype.iBb=function(t,e){var n,r,i,s=o.CultureManager.culture();if(t&&s){if(n=o.CultureManager.bBb,this.bBb===n&&!e)return;return this.bBb=n,o.CultureManager.getLanguage(s)?(r=a(!0,{},t.en),o.CultureManager.eBb(s,r),r):(i=s.substr(0,2).toLowerCase(),t.hasOwnProperty(i)?t[i]:t.en)}return{}},t}(),e.ResourceManager=s,e.A=function(t,e,n,o){var r,i,a,s,l;if(t&&0<=n&&n<e){for(r=[],void 0,a=void 0,a=n;a<e;a++)void 0!==t[a]&&r.push(a);for(i=r.length,a=0;a<i;a++)l=t[s=r[i-a-1]],t[s]=null,t[Math.floor(s)+o]=l}},e.B=function(t,e,n,o){var r,i,a,s,l,u;if(t&&0<=n&&n<e){for(r=[],void 0,a=n+o,s=void 0,s=n;s<e;s++)void 0!==t[s]&&(n<=s&&s<a?t[s]=null:s>=a&&r.push(s));for(i=r.length,s=0;s<i;s++)u=t[l=r[s]],t[l]=null,t[Math.floor(l)-o]=u}},e.D=function(t,e){return t.hasOwnProperty(e)},e.F=function(t,e){return t instanceof e}},"./src/common/util/datetimehelper.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v;function C(t,e,n,o){var r,i,s,l,c,f,h,g,y,v,w,T,x,S,A,I,R,k,M,N,E,D,O,j=n.DateTimeFormat,F=j.Calendar.convert;if(!e||!e.length)return n&&n.name.length?F?C(t,j.fullDateTimePattern,n):t.toLocaleString():""+t;function P(){return l||c||(l=f.test(e),c=!0),l}function _(t,e){if(y)return y[e];switch(e){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();default:return}}for(r=j.eras,i="",f=/([^d]|^)(d|dd)([^d]|$)/g,h=0,g=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g,!("s"===e)&&F&&(y=F.fromGregorian(t)),v=-2,w=-2,T={Qb:""},x=0;S=g.lastIndex,A=g.exec(e),I=e.slice(S,A?A.index:e.length),T.Qb="",h+=b(I,T),i+=T.Qb,A;x++)if(h%2!=1)switch(R=t.getFullYear(),k=t.getDay(),M=t.getHours(),N=t.getMinutes(),E=t.getSeconds(),D=t.getMilliseconds(),O=t.getTimezoneOffset(),A[0]){case"dddd":i+=j.dayNames[k];break;case"ddd":i+=j.abbreviatedDayNames[k];break;case"dd":l=!0,i+=u(_(t,2),2);break;case"d":l=!0,i+=_(t,2);break;case"MMMM":i+=j.monthGenitiveNames&&P()?j.monthGenitiveNames[_(t,1)]:j.monthNames[_(t,1)];break;case"MMM":i+=j.abbreviatedMonthGenitiveNames&&P()?j.abbreviatedMonthGenitiveNames[_(t,1)]:j.abbreviatedMonthNames[_(t,1)];break;case"MM":i+=u(_(t,1)+1,2);break;case"M":i+=_(t,1)+1;break;case"yyyy":case"yyy":i+=v>=0?a.aBb.ia("ee",t,o):u(y?y[0]:R,4);break;case"yy":i+=v>=0?a.aBb.ia("ee",t,o):u((y?y[0]:R)%100,2);break;case"y":i+=v>=0?a.aBb.ia("e",t,o):""+(y?y[0]:R)%100;break;case"hh":0===(s=M%12)&&(s=12),i+=u(s,2);break;case"h":0===(s=M%12)&&(s=12),i+=s;break;case"HH":i+=u(M,2);break;case"H":i+=""+M;break;case"mm":i+=u(N,2);break;case"m":i+=""+N;break;case"ss":i+=u(E,2);break;case"s":i+=""+E;break;case"tt":i+=M<12?j.amDesignator:j.pmDesignator;break;case"t":i+=(M<12?j.amDesignator:j.pmDesignator).charAt(0);break;case"f":case"0":i+=u(D,3).charAt(0);break;case"ff":case"00":i+=u(D,3).substr(0,2);break;case"fff":case"000":i+=u(D,3);break;case"z":i+=((s=O/60)<=0?"+":"-")+p(d(s));break;case"zz":i+=((s=O/60)<=0?"+":"-")+u(p(d(s)),2);break;case"zzz":i+=((s=O/60)<=0?"+":"-")+u(p(d(s)),2)+":"+u(d(O%60),2);break;case"g":case"gg":case"ggg":if(!r)break;if(v===x-1){v=x;break}i+=a.aBb.ia(A[0],t,o),v=x;break;case"e":case"ee":if(!r){i+=u(y?y[0]:R,4);break}if(w===x-1){w=x;break}i+=a.aBb.ia(A[0],t,o),w=x;break;case"/":i+=j.dateSeparator;break;case"[h]":case"[hh]":case"[H]":case"[HH]":case"[mm]":case"[m]":case"[ss]":case"[s]":i+=A[0];break;default:throw Error(m().Exp_InvalidDateFormat)}else i+=A[0];return""+i}function b(t,e){var n,o,r,i=0,a=h;for(n=0,o=t.length;n<o;n++)switch(r=t.charAt(n)){case'"':a?e.Qb+="'":i++,a=h;break;case"\\":a&&(e.Qb+="\\"),a=!a;break;default:e.Qb+=r,a=h}return i}function w(t,e){var n,o=new Date;return t.DateTimeFormat.eras&&e<100&&((e+=(n=a.aBb.ca(o).ea)-n%100)>t.DateTimeFormat.Calendar.TwoDigitYearMax&&(e-=100)),e}function T(t,e,n){var o,r,a,s,l,u,f,h,p,d,g;if(t.Rb){if(t.Rb[e])return t.Rb[e]}else t.Rb={};for(o=(o=(o=e).replace("%M","M")).replace(/([\^\$\.\*\+\?\|\[\]\(\)\{\}])/g,"\\\\$1"),r="^",a={Qb:""},s=[],l=0,u=0,f=/\/|dddd|ddd|dd|d|MMMM|MMM|MM|M|yyyy|yyy|yy|y|hh|h|HH|H|mm|m|ss|s|tt|t|fff|ff|f|000|00|0|zzz|zz|z|ggg|gg|g|ee|e|\[H\]|\[HH\]|\[h\]|\[hh\]|\[mm\]|\[m\]|\[ss\]|\[s\]/g;(h=f.exec(o))!==c;)if(a.Qb="",p=o.slice(l,h.index),l=f.lastIndex,u+=b(p,a),r+=a.Qb,u%2!=1){switch(h[0]){case"dddd":case"ddd":case"MMMM":case"MMM":case"gggg":case"ggg":case"gg":case"g":r+="(\\D+)";break;case"tt":case"t":r+="(\\D*)";break;case"dd":case"d":case"MM":case"M":case"yy":case"y":case"HH":case"H":case"hh":case"h":case"mm":case"m":case"ss":case"s":r+="(\\d\\d?\\d?)";break;case"eee":case"ee":case"e":r+=n?"(\\u5143|\\d\\d?)":"(\\d\\d?)";break;case"yyy":case"yyyy":r+="(\\d{2}|\\d{4})";break;case"fff":case"000":r+="(\\d{3})";break;case"ff":case"00":r+="(\\d{2})";break;case"f":case"0":r+="(\\d)";break;case"zzz":r+="([+-]?\\d\\d?:\\d{2})";break;case"zz":case"z":r+="([+-]?\\d\\d?)";break;case"/":r+="/"===t.dateSeparator?"(\\/)":"([\\/\\"+t.dateSeparator+"])";break;default:throw Error(m().Exp_InvalidDateFormat)}i.k.Sb(s,h[0])}else r+=h[0];return a.Qb="",b(o.slice(l),a),r+=a.Qb,g={Tb:d=(""+(r+="$")).replace(/\s+/g,"\\s+"),Ub:s,_a:RegExp(d)},t.Rb[e]=g,g}function x(t){var e=t.getTimezoneOffset();return-485===e&&(e=-485-43/60),-321===e&&(e=-321-10/60),-507===e&&(e=-507-52/60),e}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/common.ts"),r=n("./src/common/util/stringhelper.ts"),i=n("./src/common/util/arrayhelper.ts"),a=n("./src/common/culture/cultureInfo.ts"),s=n("./src/common/util/types.ts"),l=s.j.Fa,u=r.u.Sa,c=null,f=parseInt,h=!1,p=Math.floor,d=Math.abs,g=new o.ResourceManager(o.SR),m=g.getResource.bind(g),y={},v=function(){function t(){}return t.mb=function(t,e,n,o){return n||(n=a.CultureManager.q4()),C(t,e,n,o)},t.Vb=function(t,e,n){return C(t,e,n||a.CultureManager.q4())},t.gBa=function(e,n,o){var r,i,a,s,l,u=h;for((l=o).slice(1).forEach((function(t){t&&(u=!0)})),u||(l=l.concat(n.ma())),r=1,i=l.length;r<i;r++)if((s=l[r])&&(u=!0,a=t.Wb(e,s,n)))return a;return c},t.Qa=function(e,n,o){var r,i;return n||o||void 0===(i=y[e])?(r=n?[e,n]:[e],i=t.gBa(e,o||a.CultureManager.q4(),r),n||o||(y[e]=i),i?new Date(i):i):i?new Date(i):i},t.lb=function(e,n){return t.gBa(e,a.CultureManager.q4("invariant"),[e,n])},t.Wb=function(t,e,n){var o,i,s,l,u,p,d,g,m,y,v,C,b,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B;if(t=t.trim(),(l=(s=T(o=n.DateTimeFormat,e,i=1041===n.id))._a.exec(t))===c)return c;for(u=s.Ub,p=c,d=c,g=c,m=c,y=c,v=0,b=0,x=0,S=0,A=c,I=h,R=h,k=0,M=u.length;k<M;k++)if(N=l[k+1])switch(u[k]){case"dd":case"d":if((m=f(N,10))<1||m>31)return c;break;case"MMMM":if((g=n.oa(N))<0||g>11)return c;break;case"MMM":if((g=n.ra(N))<0||g>11)return c;break;case"M":case"MM":case"%M":if((g=f(N,10)-1)<0||g>11)return c;break;case"e":case"ee":if((d=i&&"å"===N?1:w(n,f(N,10)))<0||d>9999)return c;break;case"y":case"yy":case"yyy":case"yyyy":if((d=f(N,10))<0||d>9999)return c;break;case"h":case"hh":case"H":case"HH":if((v=f(N,10))<0)return c;break;case"m":case"mm":if((b=f(N,10))<0||b>59)return c;break;case"s":case"ss":if((x=f(N,10))<0||x>59)return c;break;case"tt":case"t":if(I=(E=N.toUpperCase())===o.pmDesignator.toUpperCase(),R=E===o.amDesignator.toUpperCase(),!I&&!R)return c;break;case"f":case"0":if((S=100*f(N,10))<0||S>999)return c;break;case"ff":case"00":if((S=10*f(N,10))<0||S>999)return c;break;case"fff":case"000":if((S=f(N,10))<0||S>999)return c;break;case"dddd":if((y=n.ua(N))<0||y>6)return c;break;case"ddd":if((y=n.wa(N))<0||y>6)return c;break;case"zzz":if(2!==(D=N.split(/:/)).length)return c;if((C=f(D[0],10))<-12||C>13)return c;if((O=f(D[1],10))<0||O>59)return c;A=60*C+(r.u.kb(N,"-")?-O:O);break;case"z":case"zz":if((C=f(N,10))<-12||C>13)return c;A=60*C;break;case"g":case"gg":case"ggg":if(!(j=N)||!o.eras)return c;if((p=a.aBb.ha(u[k],j))<0)return c}if(P=(F=/^(\d|\d\d|\d\d\d):/.test(t))?new Date(1899,11,30):new Date,(L=o.Calendar.convert)&&(_=L.fromGregorian(P)),L||(_=[P.getFullYear(),P.getMonth(),P.getDate()]),d===c?d=_[0]:d<100&&(o.eras&&p!==c?d=a.aBb.ga(p||0,d):d+=d>=30?1900:2e3),g===c&&(g=_[1]),m===c&&(m=F?_[2]:1),L){if((P=L.toGregorian(d,g,m))===c)return c}else{if(P.setFullYear(d,g,m),P.getDate()!==m)return c;if(y!==c&&P.getDay()!==y)return c}return I&&v<12?v+=12:R&&12===v&&(v=0),P.setHours(v,b,x,S),A!==c&&(B=P.getMinutes()-(A+P.getTimezoneOffset()),P.setHours(P.getHours()+B/60,B%60)),P},t.Xb=function(t){var e,n=t-25569,o=n>=0?1:-1,r=x(new Date(864e5*n)),i=(864e5*t*1440+o-3181192704e6+864e5*r)/1440,a=new Date(i),s=r>=0?1:-1,l=x(new Date(i+36e5*s));if(r!==l)if(e=new Date(i+60*(l-r)*1e3),r>l){if(-1===s||l===x(a))return 999===e.getMilliseconds()?new Date(e.valueOf()+1):e}else if(r<l&&(1===s||l===x(a)))return 999===e.getMilliseconds()?new Date(e.valueOf()+1):e;return 999===a.getMilliseconds()?new Date(a.valueOf()+1):a},t.Rka=function(e){if("/OADate("===e.substr(0,8)){var n=parseFloat(e.substr(8,e.length-10));return t.Xb(n)}},t.Daa=function(e){return"/OADate("+t.Ra(e)+")/"},t.Ra=function(t){if(l(t))return 0;"number"==typeof t&&(t=new Date(t));var e=x(t);return(1440*t.getTime()+3181192704e6-864e5*e)/124416e6},t.Yb=function(e){var n,o,r=c,i=!0;if(l(e)?r=t.Xb(0):e instanceof Date?r=new Date(e.valueOf()):"string"==typeof e?((n=t.Qa(e))||(isNaN(e)?t.fvb(e)?i=h:(n=new Date(e),isNaN(n.valueOf())&&(i=h),(o=/^[-+=\s]*(\d+)\W+(\d+)\W+(\d+)$/.exec(e.replace(/ |\n/g,"").trim()))&&4===o.length&&(-1!==o.indexOf(""+n.getFullYear())&&-1!==o.indexOf(""+(n.getMonth()+1))&&-1!==o.indexOf(""+n.getDate())||(i=h))):(n=t.Xb(parseFloat(e)))||(i=h)),r=n):"number"==typeof e?r=t.Xb(e):i=h,i)return r;throw m().Exp_InvalidCast},t.fvb=function(t){var e=a.CultureManager.q4().DateTimeFormat,n=function(t,e){var n=0;return e.forEach((function(e){e&&t.indexOf(e)>-1&&n++})),n>1};return n(t,e.monthNames)||n(t,e.abbreviatedMonthNames)||n(t,e.dayNames)||n(t,e.abbreviatedDayNames)||function(t,e){if(t&&t.indexOf(" ")>-1){var n=t.split(" "),o=n.length;return o>=2&&e.indexOf(n[o-2])<=-1&&!isNaN(n[o-1])}return!1}(t,e.monthNames.concat(e.abbreviatedMonthNames))},t.Ska=function(t){return t&&(t.constructor===Date||t.getUTCDate&&t.setFullYear)},t}(),e.l=v},"./src/common/util/functionhelper.ts":function(t,e,n){"use strict";var o,r,i;function a(t){return t}function s(t,e,n,a,s,l,u,c,f,h,p){var d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_=n[r],L=n[i],B=e[r],G=e[i],H=a[r],V=a[i],z=1===L,W=1===G;if(B===_&&G===L){for(N=0,E=0,D=0,O=0,b=_*L,d=0;d<_;d++)for(g=0;g<L;g++){if(y=l(n[d][g]),v=l(e[d][g]),t&&(o(y)||o(v)))return f;N+=y,E+=y*y,D+=v=h(v),O+=y*v}for(j=b*O-N*D,C=s?j/(b*E-N*N):O/E,w=s?(D*E-N*O)/(b*E-N*N):0,T=[],d=0;d<H;d++)for(T[d]=[],g=0;g<V;g++){if(y=l(a[d][g]),t&&o(y))return f;T[d][g]=0===j?e[0][0]:p(C*y+w)}return u?new u(T):T}if(W&&B===_||1===B&&G===L){for(y=[],v=[],k=L+1,M=L+2,d=0;d<_;d++){if(w=l(S=W?e[d][0]:e[0][d]),t&&o(w))return f;v[d]=z?h(w):w}for(d=0;d<_;d++)for(y[d]=[],g=0;g<L;g++){if(w=l(n[d][g]),t&&o(w))return f;y[d][g]=w}for(F=[],C=0;C<k;C++)for(F[C]=[],b=0;b<M;b++)F[C][b]=0;for(m=0;m<_;m++)for(F[0][k]+=v[m],d=0;d<L;d++)for(S=d+1,F[0][S]+=y[m][d],F[S][0]=F[0][S],F[S][k]+=y[m][d]*v[m],g=d;g<L;g++)F[I=g+1][S]+=y[m][d]*y[m][g],F[S][I]=F[I][S];for(F[0][0]=_,x=P=s?0:1;x<k;x++){if(t){if(0===F[x][x]){for(R=!1,g=x+1;!R&&g<k;g++)if(0!==F[g][x]){for(m=0;m<M;m++)I=F[x][m],F[x][m]=F[g][m],F[g][m]=I;R=!0}if(!R)return c}}else{for(d=x;d<k&&0===F[d][x];)d++;if(d>=k)return c;for(A=P;A<M;A++)S=F[x][A],F[x][A]=F[d][A],F[d][A]=S}for(S=1/F[x][x],A=P;A<M;A++)F[x][A]*=S;for(d=P;d<k;d++)if(d!==x)for(S=-F[d][x],A=0;A<M;A++)F[d][A]+=S*F[x][A];s||(F[0][k]=0)}for(T=[],W||(T[0]=[]),d=0;d<H;d++){for(W&&(T[d]=[]),S=F[0][k],g=0;g<L;g++){if(w=l(W?a[d][g]:a[g][d]),t&&o(w))return f;S+=F[g+1][k]*w}W?T[d][0]=p(S):T[0][d]=p(S)}return u?new u(T):T}return c}Object.defineProperty(e,"__esModule",{value:!0}),o=isNaN,r="rowCount",i="colCount",e.qc=function(t,e,n,o,r,i,l,u){return s(!0,t,e,n,o,r,i,u,l,a,a)},e.sc=function(t,e,n,o,l,u,c){var f,h;for(f=0;f<t[r];f++)for(h=0;h<t[i];h++)if(t[f][h]<=0)return u;return s(!1,t,e,n,o,a,l,c,null,Math.log,Math.exp)}},"./src/common/util/numberhelper.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N;function E(t,e,n,o){return e&&0!==e.length&&"i"!==e?function(t,e,n,o){var r=j(e);return V(t,r,n,o)}(t,e,n.NumberFormat,o):n&&n.name.length>0?t.toLocaleString():""+t}function D(t,e){for(var n,o,r,i,a,s,l,u=m(y(t)),c={Xa:1,Ya:0};u>=10;)u/=10,c.Xa++;return o=(n=""+t).search(/e/gi),r=n.indexOf(e),-1!==o?(a=T(n,0,o),s=T(n,o+1),l=0,-1!==r&&(l=T(a,r+1).length),(i=l-p(s))<0&&(i=0),c.Ya=i):(i=0,-1!==r&&(i=T(n,r+1).length),c.Ya=i),c}function O(t){var e,n={Za:t.charAt(0),$a:0,_a:0},o="";for(e=1;e<t.length;e++)if("+"===(o=t.charAt(e)))n.$a=1;else{if("-"!==o){if("0"===o){n._a=t.length-e;break}throw Error(A().Exp_InvalidExponentFormat)}n.$a=-1}return n}function j(t){var e,n,o,r,i,a,s={ab:f,bb:f,cb:d,eb:0,fb:0,Rja:0,hb:f},l="",u=d,c=d,h=d,p=d,m=d,y=d,v=f,C=[];for(n=0;n<t.length;n++){if(e=t.charAt(n),u)l+=e,'"'===e&&(C.push(l),l="",u=d);else if(c){if("E"===v||"e"===v){if(!(["+","-","0"].indexOf(e)>=0)){c=d,n--;continue}l+=e}else if("+"===v||"-"===v){if("0"!==e){c=d,n--;continue}l+=e}else if("0"===v){if("0"!==e){c=d,m||(m=g,s.hb=O(l)),n--;continue}l+=e}}else if("*"!==v&&"_"!==v&&"\\"!==v||""===l)if("*"===e||"_"===e||"\\"===e)y=d,""!==l&&(C.push(l),l=""),l+=e;else if("'"===e)y=d,""!==l&&(C.push(l),l=""),C.push(e);else if('"'===e)y=d,u=g,""!==l&&(C.push(l),l=""),l+=e;else if(M.indexOf(e)>=0)y=g,M.indexOf(v)<0&&""!==l&&(C.push(l),l=""),l+=e;else if("."!==e||h)if("%"===e)y=d,s.fb++,""!==l&&(C.push(l),l=""),C.push(e);else if("â°"===e)y=d,s.Rja++,""!==l&&(C.push(l),l=""),C.push(e);else if(","===e)if(y){for(o=void 0,""!==l&&(C.push(l),l=""),r=g,i="",a=n+1;a<t.length;a++)if(o=t.charAt(a),""===i)if('"'===o)i=o;else{if(M.indexOf(o)>=0){r=d;break}if("."===o||";"===o)break}else'"'===o&&(i="");r?s.eb++:h||(o=t.charAt(n+1))&&M.indexOf(o)>=0&&(p=g)}else l+=e;else"E"===e||"e"===e?(y=d,c=g,""!==l&&(C.push(l),l=""),l+=e):(y=d,M.indexOf(v)>=0&&""!==l&&(C.push(l),l=""),l+=e);else""!==l&&(C.push(l),l=""),s.ab=C,C=[],h=g,y=d;else l+=e,C.push(l),l="";v=e}return""!==l&&(c&&!m&&(s.hb=O(l)),C.push(l)),p&&(s.cb=g),h?s.bb=C:s.ab=C,s}function F(t,e,n,o){var r,i,a,s,l,u=e[0],c=1,f=0,h=d,p=t.length;for(r=0;r<p;r++)if("number"===(i=t[r].type)){for(a="",l=(s=t[r].value).length-1;l>=0;){if(!(1<=u&&u<=9||0===u&&c===e.length))throw Error(A().Exp_InvalidNumberGroupSize);/\d/gi.test(s[l])?(h&&(a&&t.push({type:"number",value:a}),t.push({type:"groupSeparator",value:n}),a="",h=d),f++):f=0,a=s[l]+a,f===u&&u>0&&(h=g,f=0,c<e.length&&(u=e[c],c++)),l--}a&&t.push({type:i,value:a})}else"fillingChar"===i&&(o.infillIndex=t.length-p),t.push({type:i,value:t[r].value});return t.splice(0,p)}function P(t,e,n,o,r,i){var a,s,l,f,p=U(t,-e);return isFinite(p)||(p=t),f=(a=""+(t=p)).split(/e/i),a=f[0],l=f.length>1?h(f[1],10):0,f=a.split("."),a=f[0],s=f.length>1?f[1]:"",l>0?(a+=(s=c(s,l)).slice(0,l),s=T(s,l)):l<0&&(l=-l,s=(a=t<0?i+u(a.replace(i,""),l+1):u(a,l+1)).slice(-l,a.length)+s,a=a.slice(0,-l)),e>0?s=r+(s=s.length>e?s.slice(0,e):c(s,e)):s="",a+s}function _(t,e,n,o){var r=t;return e>0&&(r=Y(t*v(100,e),15)),n>0&&(r=Y(t*v(1e3,n),15)),o>0&&(r=Y(t/v(1e3,o),15)),r}function L(t){var e,n,o=f;if(t)for(o="",e=0;e<t.length;e++)n=t[e],/^(0|#|\?)+/g.test(n)&&(o+=n);return o}function B(t,e,n){var o,r={value:t,exponentValue:0},i=D(t,".").Xa,a=y(t),s=n?n.length:1;if(a>=1)i>s?(i-=s,r.value=t/v(10,i),r.exponentValue=i):r.exponentValue=0,-1===e.$a&&(e.$a=0);else if(a<1&&a>0){for(e.$a=-1,o=v(10,s);10*a<o;)a*=10,r.exponentValue++;r.value*=v(10,r.exponentValue)}return r}function G(t,e,n,o,r,i,a,s){var l,c,f,h,p,d,m,y,v,C,b,w=s.numberGroupSizes,x=s.numberGroupSeparator,S=s.negativeSign,A=s.percentSymbol,I=s.perMilleSymbol,R=o.hb,M=T(e,0,1);for(M===S&&(e=T(e,1)),e=0===(l=1===e.length&&"0"===e?0:e.length)?"":e,c=0,f="",h=t.length-1;h>=0;h--)if(p="",d=t[h],/^(0|#|\?)+/g.test(d)){if(f!==n){for(m=d.length,y=l-c-1;y>=0&&m>0;y--)p=e.charAt(y)+p,m--,c++;for(v=m-1;v>=0;v--)c++,"0"===(C=d[v])?p=C+p:"?"===C&&(""!==p&&(i.push({type:"number",value:p}),p=""),i.push({type:"numberPlaceholder",value:C}));(f=d+f)===n&&c<l&&(p=e.substr(0,l-c)+p),""!==p&&i.push({type:"number",value:p})}}else o.hb&&!a.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(a.replaceExponent=g,b="",b+=R.Za,b+=k[R.$a],b+=u(""+r,R._a),i.push({type:"exponent",value:b})):"_"===d[0]?i.push({type:"placeholder",value:d[1]}):"*"===d[0]?a.hasInfilling||(i.push({type:"fillingChar",value:d[1]}),a.hasInfilling=!0,a.infillIndex=i.length-1):"\\"===d[0]?2===d.length&&i.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?d.length>2&&i.push({type:"text",value:d.substr(1,d.length-2)}):d===A?i.push({type:"percent",value:d}):d===I?i.push({type:"permille",value:d}):N[d]?i.push({type:"currency",value:d}):i.push({type:"text",value:d});M===S&&n&&i.push({type:"text",value:M}),o.cb===g&&F(i,w,x,a),i.reverse(),a.infillIndex=i.length-1-a.infillIndex}function H(t,e,n,o,r,i,a,s,l){var c,f,h,p,d,m,y,v,C,b,w,T,x=l.numberDecimalSeparator,S=l.percentSymbol,A=l.perMilleSymbol,M=e.indexOf(x),E=r.hb;for((M>0||o!==I||n!==R)&&a.push({type:"decimalSeparator",value:x}),c=-1!==M?e.substring(M+1):"",f=0,h="",p=0;p<t.length;p++)if(d=t[p],/^(0|#|\?)+/g.test(d)){if(m="",h!==n){for(y=d.length,v=0,C=f;y>0&&c.length-f>0;)m+=c.charAt(C),y--,f++,v++,C++;for(b=v;y>0;)w=d[b],b++,f++,y--,"0"===w?m+=w:"?"===w&&(""!==m&&(a.push({type:"number",value:m}),m=""),a.push({type:"numberPlaceholder",value:w}));""!==m&&a.push({type:"number",value:m}),h+=d}}else E&&!s.replaceExponent&&/^((E(\+|-)?|e(\+|-)?)\d+)/g.test(d)?(s.replaceExponent=g,T="",T+=E.Za,T+=k[E.$a],T+=u(""+i,E._a),a.push({type:"exponent",value:T})):"_"===d[0]?a.push({type:"placeholder",value:d[1]}):"*"===d[0]?(a.push({type:"fillingChar",value:d[1]}),s.hasInfilling&&a.splice(s.infillIndex,1),s.hasInfilling=!0,s.infillIndex=a.length-1):"\\"===d[0]?2===d.length&&a.push({type:"text",value:d[1]}):'"'===d[0]&&'"'===d[d.length-1]?d.length>2&&a.push({type:"text",value:d.substr(1,d.length-2)}):d===S?a.push({type:"percent",value:d}):d===A?a.push({type:"permille",value:d}):N[d]?a.push({type:"currency",value:d}):a.push({type:"text",value:d})}function V(t,e,n,o){var r,i,a,s,l,u,c,f,h,p,g,m,y=[];return t=_(t,e.fb,e.Rja,e.eb),r=e.ab,i=e.bb,r||i?(a=L(r),(s=L(i))||(s=""),e.hb&&(t=(u=B(t,e.hb,a)).value,l=u.exponentValue),c=D(t,"."),n.numberGroupSizes,n.numberGroupSeparator,f=n.numberDecimalSeparator,h=n.negativeSign,p=P(t,C(c.Ya,s.length),0,0,f,h),o||(p=function(t,e){var n=t;return-1!==t.indexOf(e)&&(n=t.replace(/0+$/,"")),n}(p,f)),""===p?(y.push({type:"text",value:(r?r.join(""):"")+(i?i.join(""):"")}),y):(g={hasInfilling:d,infillIndex:-1,replaceExponent:d},"10"!==(m=p.split(f)[0])||isNaN(l)||(m="1",l+=e&&e.hb&&-1===e.hb.$a?-1:1),r&&G(r,m,a,e,l,y,g,n),"0"!==m&&""===a&&i&&y.push({type:"number",value:m}),i&&H(i,p,s,a,e,l,y,g,n),y)):y}function z(t,e){var n,o,r,i,s,u,c,d,g,m,y,v,C,b,w,x;return(t=l(t)?"":a.u.ib(t,"")).match(/^[+-]?infinity$/i)?p(t):t.match(/^0x[a-f0-9]+$/i)?h(t,10):(i=(r=W(t,n=e.NumberFormat,o=n.numberNegativePattern))[0],s=r[1],""===i&&1!==o&&(i=(r=W(t,n,1))[0],s=r[1]),""===i&&(i="+"),s[0]===n.currencySymbol&&(s=T(s,1)),(d=s.indexOf("e"))<0&&(d=s.indexOf("E")),d<0?(c=s,u=f):(c=T(s,0,d),u=T(s,d+1)),(y=c.indexOf("."))<0?(g=c,m=f):(g=T(c,0,y),m=T(c,y+1)),g=g.split(",").join(""),","!==(v=",".replace(/\u00A0/g," "))&&(g=g.split(v).join("")),C=i+g,m!==f&&(C+="."+m),C[C.length-1]===n.percentSymbol&&(C=T(C,0,C.length-1),-1===(b=(C=a.u.ib(C,"")).indexOf("."))&&(b=C.length),w="",w+=T(C,0,b-2),w+=".",w+=T(C,b-2,2),C=w+=T(C,b+1)),u!==f&&(""===(x=W(u,n,1))[0]&&(x[0]="+"),C+="e"+x[0]+x[1]),C.match(/^[+-]?\d*\.?\d*(e[+-]?\d+)?$/)?p(C):NaN)}function W(t,e,n){var o=e.negativeSign,r=e.positiveSign;if(4!==n&&2!==n||(o=" "+o,r=" "+r),4===n||3===n){if(a.u.jb(t,o))return["-",T(t,0,t.length-o.length)];if(a.u.jb(t,r))return["+",T(t,0,t.length-r.length)]}else if(2===n||1===n){if(a.u.kb(t,o))return["-",T(t,o.length)];if(a.u.kb(t,r))return["+",T(t,r.length)]}else{if(0!==n)throw Error("");if(a.u.kb(t,"(")&&a.u.jb(t,")"))return["-",T(t,1,t.length-2)]}return["",t]}function U(t,e){var n,o;return t=+t,e=+e,isNaN(t)||e%1!=0?NaN:(t=(n=t<0)?-t:t,void 0===typeof e||0===e?(t=Math.round(t),n?-t:t):(o=(""+t).split("e"),t=Math.round(+(o[0]+"e"+(o[1]?+o[1]-e:-e))),+((o=(""+(t=n?-t:t)).split("e"))[0]+"e"+(o[1]?+o[1]+e:e))))}function q(t){var e=s.CultureManager.q4().NumberFormat;return"string"==typeof t&&(e=s.CultureManager.q4(t).NumberFormat),e}function Y(t,e){return"number"==typeof t&&(""+t).length>=e&&(t=+t.toPrecision(e)),t}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/common.ts"),r=n("./src/common/util/types.ts"),i=n("./src/common/util/regexhelper.ts"),a=n("./src/common/util/stringhelper.ts"),s=n("./src/common/culture/cultureInfo.ts"),l=r.j.Fa,u=a.u.Sa,c=a.u.Ta,f=null,h=parseInt,p=parseFloat,d=!1,g=!0,m=Math.floor,y=Math.abs,v=Math.pow,C=Math.min,b="#dot#",w="#group#",T=function(t,e,n){return t.substr(e,n)},x=function(t){return i.q.qb(t)},S=new o.ResourceManager(o.SR),A=S.getResource.bind(S),I="##################0",R="################",k={1:"+",0:"","-1":"-"},M=["0","#","?"],N={"Â¤":"Â¤",Br:"Br",Fdj:"Fdj",Nfk:"Nfk",R:"R",$:"$",FCFA:"FCFA","GHâµ":"GHâµ","á¥á­":"á¥á­","Ø±.Ø³.â":"Ø±.Ø³.â",XDR:"XDR","Ø¯.Ø¥.â":"Ø¯.Ø¥.â","Ø¯.Ø¨.â":"Ø¯.Ø¨.â","Ø¯.Ø¬.â":"Ø¯.Ø¬.â","Ø¬.Ù.â":"Ø¬.Ù.â","âª":"âª","Ø¯.Ø¹.â":"Ø¯.Ø¹.â","Ø¯.Ø§.â":"Ø¯.Ø§.â","Ù.Ø¬.Ù.â":"Ù.Ø¬.Ù.â","Ø¯.Ù.â":"Ø¯.Ù.â","Ù.Ù.â":"Ù.Ù.â","Ø¯.Ù.â":"Ø¯.Ù.â","Ø¯.Ù.â":"Ø¯.Ù.â","Ø£.Ù.â":"Ø£.Ù.â","Ø±.Ø¹.â":"Ø±.Ø¹.â","Ø±.Ù.â":"Ø±.Ù.â","Ø¬.Ø³.":"Ø¬.Ø³.",S:"S","Â£":"Â£","Ù.Ø³.â":"Ù.Ø³.â","Ø¯.Øª.â":"Ø¯.Øª.â","Ø±.Ù.â":"Ø±.Ù.â","â¹":"â¹",TSh:"TSh","â¬":"â¬","â¼":"â¼","â½":"â½",K:"K","Ð»Ð².":"Ð»Ð².","â¦":"â¦",CFA:"CFA","à§³":"à§³","Â¥":"Â¥",KM:"KM","ÐÐ":"ÐÐ",USh:"USh","KÄ":"KÄ","kr.":"kr.",Ksh:"Ksh",CHF:"CHF","Þ.":"Þ.","Nu.":"Nu.",EC$:"EC$",P:"P",US$:"US$",D:"D",Rp:"Rp",Ar:"Ar",MOP$:"MOP$",Rs:"Rs",MK:"MK",RM:"RM","â±":"â±",RF:"RF",SR:"SR",SDG:"SDG",Le:"Le","NAf.":"NAf.",E:"E",T$:"T$",VT:"VT",WS$:"WS$",Bs:"Bs","â¡":"â¡",Q:"Q",L:"L",C$:"C$","B/.":"B/.","S/.":"S/.","â²":"â²","Bs.":"Bs.","Ø±ÙØ§Ù":"Ø±ÙØ§Ù",FG:"FG",UM:"UM",kr:"kr",FBu:"FBu",FC:"FC",DA:"DA",G:"G",CF:"CF",DH:"DH",FCFP:"FCFP",LS:"LS",DT:"DT",kn:"kn",HUF:"HUF","Ö":"Ö",ISK:"ISK","â¾":"â¾","â":"â","â¸":"â¸","á":"á","â©":"â©","ÑÐ¾Ð¼":"ÑÐ¾Ð¼",Kz:"Kz","â­":"â­",MTn:"MTn","Ð´ÐµÐ½":"Ð´ÐµÐ½","â®":"â®","à¤°à¥":"à¤°à¥","Afl.":"Afl.","ßß.":"ßß.","ÑÑÐ±.":"ÑÑÐ±.","zÅ":"zÅ","Ø":"Ø",R$:"R$",Db:"Db",RON:"RON","â´":"â´",MAD:"MAD","à¶»à·.":"à¶»à·.","LekÃ«":"LekÃ«",den:"den",RSD:"RSD","Ð´Ð¸Ð½.":"Ð´Ð¸Ð½.","Ü .Ü£.â":"Ü .Ü£.â","Rs.":"Rs.","ÑÐ¼Ð½":"ÑÐ¼Ð½","à¸¿":"à¸¿","m.":"m.","âº":"âº","â´·âµ":"â´·âµ","soÊ»m":"soÊ»m","ÑÑÐ¼":"ÑÑÐ¼","â«":"â«",HK$:"HK$",MOP:"MOP",NT$:"NT$"},e.o={Qa:function(t){return z(t,s.CultureManager.q4())},lb:function(t){return z(t,s.CultureManager.q4("invariant"))},mb:function(t,e,n,o){return n||(n=s.CultureManager.q4()),E(t,e,n,o)},nb:function(t,e){var n,o,r;return"string"!=typeof t||(o=(n=q(e)).numberDecimalSeparator,r=n.numberGroupSeparator,"."!==o&&(t=t.replace(x("[.]"),b)),","!==r&&(t=t.replace(x("[,]"),w)),"."!==o&&(t=t.replace(x(b),o)),","!==r&&(t=t.replace(x(w),r))),t},Oa:function(t,e){var n,o,r;return"string"!=typeof t||(o=(n=q(e)).numberDecimalSeparator,r=n.numberGroupSeparator,"."!==o&&(t=t.replace(x("["+o+"]"),b)),","!==r&&(t=t.replace(x("["+r+"]"),w)),"."!==o&&(t=t.replace(x(b),".")),","!==r&&(t=t.replace(x(w),","))),t},Xia:function(t,e){var n,o,r;return!("string"==typeof t&&(n=q(e),o=n.numberDecimalSeparator,r=n.numberGroupSeparator,"."!==o&&"."!==r&&t.indexOf(".")>=0||","!==o&&","!==r&&t.indexOf(",")>=0))},ob:function(t,e){return p(this.Oa(t,e))},pb:function(t,e,n){if(0!==y(m(t)-t))throw Error(A().Exp_BadFormatSpecifier);var o=t>=0?t.toString(16):(4294967295+t+1).toString(16);return o=e?o.toLowerCase():o.toUpperCase(),!l(n)&&o.length<n?u(o,n):o},Hja:j,Ija:V,Jja:function(t){var e,n,o,r="";if(Array.isArray(t)&&t.length>0)for(e=0;e<t.length;e++)if(n=t[e].type,o=t[e].value,"placeholder"===n)r+=" ";else{if("fillingChar"===n)continue;r+="numberPlaceholder"===n?" ":o}return r},eka:I,fka:R,Lma:Y}},"./src/common/util/regexhelper.ts":function(t,e,n){"use strict";var o,r,i;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/stringhelper.ts"),r=!0,i=function(){function t(){}return t.qb=function(e){var n=t.rb[e];return n||(n=t.rb[e]=RegExp(e,"g")),n.lastIndex=0,n},t.sb=function(e){var n=t.tb[e];return n||(n=t.tb[e]=RegExp(e,"gi")),n.lastIndex=0,n},t.ub=function(e,n,o){var i,a,s,l,u;if(t.vb[e])return t.wb[e];if("[~?*]+",t.qb("[~?*]+").test(e)){for(i=[],a=e.split(""),s=void 0,l={".":r,"+":r,$:r,"^":r,"[":r,"]":r,"(":r,")":r,"{":r,"}":r,"|":r,"/":r},u=0;u<a.length;u++)"~"===(s=a[u])&&u<a.length-1?("*"===(s=a[++u])||"?"===s?i.push("\\"):n&&i.push("~"),i.push(s)):"?"===s?i.push("."):"*"===s?(i.push("[\\s\\S]"),o?i.push("+"):i.push("*")):l[s]?(i.push("\\"),i.push(s)):i.push(s);return i.join("")}return null},t.zb=function(e,n,o){var r=t.ub(e,n,o);return r&&(r="^"+r+"$"),r},t.xb=function(t,e){for(var n="#"+t+"0#",r=1;e.indexOf(n)>0;)n=o.u.yb(n,"#"+t+(r-1)+"#","#"+t+r+"#"),r++;return n},t.Ab=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},t.rb={},t.tb={},t.vb={},t.wb={},t}(),e.q=i},"./src/common/util/stringhelper.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("./src/common/util/regexhelper.ts");function r(t,e,n){return t.substr(e,n)}function i(t){return null==t}function a(t,e,n,o){var r,a;if(i(e))throw Error();return""===e||!(e.length>t.length)&&(r=t,a=e,n&&(r=r.toLowerCase(),a=a.toLowerCase()),o(r,a))}e.u={Bb:function(t,e,n){return n&&(t=t.toLowerCase(),e=e.toLowerCase()),""===e||t.indexOf(e)>=0},Cb:function(t,e,n){var o,r;return n?(o=t.toLowerCase(),r=e.toLowerCase(),o.indexOf(r)):t.indexOf(e)},Db:function(t,e){if(!e)return t;for(var n=t;r(n,0,e.length)===e;)n=r(n,e.length);return n},ib:function(t,e){if(!e)return t;for(var n=t;r(n,n.length-e.length,e.length)===e;)n=r(n,0,n.length-e.length);return n},Eb:function(t,e,n){if(e<0||e>t.length||i(n))throw Error();return r(t,0,e)+n+r(t,e,t.length-e)},Fb:function(t,e,n){if(i(n)&&(n=t.length-e),e<0||n<0||e+n>t.length)throw Error();return r(t,0,e)+r(t,e+n,t.length-e-n)},kb:function(t,e,n){return void 0===n&&(n=!1),a(t,e,n,(function(t,e){return t.slice(0,e.length)===e}))},jb:function(t,e,n){return void 0===n&&(n=!1),a(t,e,n,(function(t,e){return t.slice(-e.length)===e}))},Gb:function(t,e,n,o){if(!e)throw Error();return n=(""+n).replace(/\$/g,"$$$$"),t.replace(RegExp(e,"g"+(o?"i":"")),n)},Hb:function(t,n,r,i){return n=o.q.Ab(n),e.u.Gb(t,n,r,i)},Ib:function(t,e){var n=t.indexOf(e);return n<0||n>=t.length?t:r(t,0,n)},Jb:function(t,e){for(var n=0,o=t.indexOf(e);o>=0;)n+=1,o=t.indexOf(e,o+1);return n},yb:function(t,e,n){return t.split(e).join(n)},Kb:function(t,e){var n,o,r=t;for(n=0;n<e.length;n++)o=RegExp("\\{"+n+"\\}","g"),r=r.replace(o,e[n]);return r},Lb:function(t,e,n){var o,r=""+t;for(o=r.length;o<e;o++)r=n?"0"+r:r+"0";return r},Sa:function(t,n){return e.u.Lb(t,n,!0)},Ta:function(t,n){return e.u.Lb(t,n,!1)},Mb:function(t,e){return t===e||!t&&!e||t&&e&&t.toLowerCase()===e.toLowerCase()},Nb:function(t){return t.toUpperCase()},Ob:function(t){var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},n=o.q.qb("(?:&|<|>|\"|'|`)");return n.test(t)?t.replace(n,(function(t){return e[t]})):t},Pb:function(t){var e={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#x27;":"'","&#x60;":"`"},n=o.q.qb("(?:&amp;|&lt;|&gt;|&quot;|&#x27;|&#x60;)");return n.test(t)?t.replace(n,(function(t){return e[t]})):t},BIc:function(t){return t.replace(/javascript:/gi,"")}}},"./src/common/util/types.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.j={r4:null,H:function(t,n){var o,r,i;if(e.j.ya(t))for(o=0,r=t.length;o<r&&!1!==n.call(t[o],o,t[o]);o++);else for(i in t)if(t.hasOwnProperty(i)&&!1===n.call(t[i],i,t[i]))break;return t},za:function(t){return!t||"object"==typeof t&&0===Object.keys(t).length},Aa:function(t){return"function"===e.j.Ba(t)},Ca:function(t){return Array.isArray?Array.isArray(t):"array"===e.j.Ba(t)},Da:function(t){return e.j.jk(t)&&(t=parseFloat(t)),!isNaN(t)&&isFinite(t)},jk:function(t){return"string"==typeof t},Ba:function(t){var n,o,r,i,a,s;if(null===t)return"null";if(!(n=e.j.r4))for(n=e.j.r4={},r=0,i=(o=["Boolean","Number","String","Function","Array","Date","RegExp","Object","Error"]).length;r<i;r++)n["[object "+o[r]+"]"]=o[r].toLowerCase();return a=n.toString,"object"===(s=typeof t)||"function"===s?n[a.call(t)]||"object":s},Ea:function(t,n,o){var r,i;if(n){if(i=[].indexOf)return i.call(n,t,o);for(r=n.length,e.j.Fa(o)&&(o=0),o=o<0?Math.max(0,r+o):o;o<r;o++)if(o in n&&n[o]===t)return o}return-1},Ga:function(t,e){var n=e.length,o=t.length,r=0;if("number"==typeof n)for(;r<n;r++)t[o++]=e[r];else for(;void 0!==e[r];)t[o++]=e[r++];return t.length=o,t},Ha:function(t,n,o){var r,i,a,s,l=[];if(e.j.ya(t))for(i=0,a=t.length;i<a;i++)null!==(r=n(t[i],i,o))&&(l[l.length]=r);else for(s in s=void 0,t)t.hasOwnProperty(s)&&(null!==(r=n(t[s],s,o))&&(l[l.length]=r));return l.concat([])},Ia:function(){var t,n,o,r,i,a,s,l,u,c,f,h=[];for(t=0;t<arguments.length;t++)h[t]=arguments[t];for(l=h[0]||{},u=1,c=h.length,f=!1,"boolean"==typeof l&&(f=l,l=h[1]||{},u=2),"object"==typeof l||e.j.Aa(l)||(l={}),c===u&&(l=this,--u);u<c;u++)if(a=h[u],!e.j.Fa(a))for(i in a)n=l[i],l!==(r=a[i])&&(o=e.j.Ca(r),f&&r&&(e.j.Ja(r)||o)?(s=o?n&&e.j.Ca(n)?n:[]:n&&e.j.Ja(n)?n:{},l[i]=e.j.Ia(f,s,r)):void 0!==r&&(l[i]=r));return l},G:function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);function o(){this.constructor=t}o.prototype=e.prototype,t.prototype=new o},Ka:function(t){return null!==t&&t===t.window},Ja:function(t){var n,o;if(!t||"object"!==e.j.Ba(t)||t.nodeType||e.j.Ka(t))return!1;n={}.hasOwnProperty;try{if(t.constructor&&!n.call(t,"constructor")&&!n.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}for(o in t);return void 0===o||n.call(t,o)},ya:function(t){if(e.j.Fa(t))return!1;var n=t.length,o=e.j.Ba(t);return!e.j.Ka(t)&&(!(1!==t.nodeType||!n)||"array"===o||"function"!==o&&(0===n||"number"==typeof n&&n>0&&n-1 in t))},La:function(t,n){var o=n||[];return null!==t&&(e.j.ya(Object(t))?e.j.Ga(o,"string"==typeof t?[t]:t):[].push.call(o,t)),o},Ma:null,Fa:function(t){return null==t},Na:null,Pa:null,C4:function(t){if(!t)return t;if("number"==typeof t||"string"==typeof t||"boolean"==typeof t||e.j.Fa(t))return t;if(t.clone)return t.clone();if(t instanceof Date)return new Date(t.valueOf());var n,o,r;for(o in n=t instanceof Object?new t.constructor:new t.constructor(t.valueOf()),t)t.hasOwnProperty(o)&&(r=t[o],t.hasOwnProperty(o)&&n[o]!==r&&(n[o]="object"==typeof r?e.j.C4(r):r));return n.toString=t.toString,n.valueOf=t.valueOf,n}}},"./src/common/util/util.res.en.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_InvalidDateFormat="Invalid date format pattern",e.Exp_InvalidExponentFormat="invalid exponent format",e.Exp_InvalidSemicolons="invalid format : too many semicolons",e.Exp_InvalidNumberGroupSize="NumberGroupSize must be between 1 and 9, except for the last element, which can be zero.",e.Exp_BadFormatSpecifier="Bad Format Specifier",e.Exp_InvalidNumberFormat="Invalid number format pattern",e.Exp_InvalidCast="InvalidCastException",e.Exp_Separator="numberDecimalSeparator, listSeparator and arrayListSeparator should be different in cluture info."},"./src/plugins/commands/commands.entry.ts":function(t,e,n){"use strict";var o,r;Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/plugins/commands/commands.ts"),e.Key=o.Key,e.CommandManager=o.CommandManager,r=n("./src/plugins/commands/undomanager.ts"),e.UndoManager=r.UndoManager},"./src/plugins/commands/commands.ts":function(t,e,n){"use strict";var o,r,i;Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.left=37]="left",t[t.right=39]="right",t[t.up=38]="up",t[t.down=40]="down",t[t.tab=9]="tab",t[t.enter=13]="enter",t[t.shift=16]="shift",t[t.ctrl=17]="ctrl",t[t.space=32]="space",t[t.altkey=18]="altkey",t[t.home=36]="home",t[t.end=35]="end",t[t.pup=33]="pup",t[t.pdn=34]="pdn",t[t.backspace=8]="backspace",t[t.del=46]="del",t[t.esc=27]="esc",t[t.a=65]="a",t[t.c=67]="c",t[t.v=86]="v",t[t.x=88]="x",t[t.z=90]="z",t[t.y=89]="y"}(o=e.Key||(e.Key={})),r=function(){function t(t,e,n){var o,r;this.tc=t,this.j4=e,this.Cj=n,o=this,Object.defineProperty(o,"shortcutKey",{get:function(){return o.vc},set:function(t){var e,n,i=o.vc;i!==t&&((e=(r=o.tc.wc)[i])&&((n=e.indexOf(o))>=0&&e.splice(n,1)),o.vc=t,t&&((e=r[t])||(r[t]=e=[]),e.splice(0,0,o)))}})}return t.prototype.canUndo=function(){return this.j4.canUndo},t.prototype.execute=function(t,e,n){var o,r=this,i=!0;try{i=!1!==(o=(r.j4.execute||r.j4)(t,e,1===n))}catch(t){i=!1}return e&&i&&r.tc.g4({command:e,result:o,s4:n}),o},t}(),i=function(){function t(t){this.xc=t,this.Ze={},this.wc={}}return t.prototype.register=function(t,e,n,o,i,a,s){var l=this,u=new r(l,e,t);l[t]=u,n&&(u.shortcutKey=l.getShortcutKey(n,o,i,a,s))},t.prototype.getCommand=function(t){return this[t]},t.prototype.execute=function(t){var e=this[t.cmd];if(e)return e.execute(this.xc,t,0)},t.prototype.setShortcutKey=function(t,e,n,o,r,i){var a,s,l,u,c=this;if(t)(a=c[t])&&(a.shortcutKey=c.getShortcutKey(e,n,o,r,i));else if(s=c.getShortcutKey(e,n,o,r,i),l=c.getCommands(s))for(u=l.length-1;u>=0;u--)l[u].shortcutKey=void 0},t.prototype.getShortcutKey=function(t,e,n,r,i){if(t){var a="A".charCodeAt(0)<=t&&t<="Z".charCodeAt(0)?String.fromCharCode(t):o[t];return a||(a=t),a+(e?"+ctrl":"")+(n?"+shift":"")+(r?"+alt":"")+(i?"+window":"")}},t.prototype.getCommands=function(t){return this.wc[t]},t.prototype.addListener=function(t,e){this.Ze[t]=e},t.prototype.removeListener=function(t){delete this.Ze[t]},t.prototype.g4=function(t){var e,n=this.Ze;for(e in n)n.hasOwnProperty(e)&&n[e](t)},t.prototype.no=function(){this.xc=null},t}(),e.CommandManager=i},"./src/plugins/commands/undomanager.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,n){var o=this;o.xc=t,e<0&&(e=2147483647),o.yc=e,o.zc=n,o.Ac=[],o.Bc=[]}return t.prototype.Cc=function(t,e){var n,o,r,i=this;if(t)if(1===e)i.Bc.push(t);else{if(n=i.yc,o=i.Ac.length,n>0&&o>=n)for(r=0;r<o-n+1;r++)i.Ac.shift();i.Ac.push(t),0===e&&(i.Bc=[])}},t.prototype.canUndo=function(){return this.Ac.length>0},t.prototype.undo=function(){var t,e,n=this,o=n.Ac,r=!0;if(n.zc&&n.canUndo()){t=o[o.length-1];try{(e=n.xc.commandManager()[t.cmd])&&(t.yTa=!0,r=e.execute(n.xc,t,1))}catch(t){r=!1}delete t.yTa,!1!==r&&(o.pop(),n.Bc.push(t))}return r},t.prototype.canRedo=function(){return this.Bc.length>0},t.prototype.redo=function(){var t,e,n=this,o=n.Bc,r=!0;if(n.zc&&n.canRedo()){t=o[o.length-1];try{(e=n.xc.commandManager()[t.cmd])&&(t.yTa=!0,r=e.execute(n.xc,t,2))}catch(t){r=!1}delete t.yTa,!1!==r&&(o.pop(),n.Ac.push(t))}return r},t.prototype.clear=function(){this.Ac=[],this.Bc=[]},t.prototype.PY=function(t){this.Ac=this.Ac.filter(t),this.Bc=this.Bc.filter(t)},t.prototype.no=function(){this.xc=null},t}();e.UndoManager=o},"./src/plugins/formatter/formatter.entry.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n("./src/plugins/formatter/formatter.ts"))},"./src/plugins/formatter/formatter.res.en.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Exp_TokenIsNull="token is null",e.Exp_InvalidBackslash="the '\\' cannot be evaluated",e.Exp_FormatIllegal="format is illegal.",e.Exp_ValueIsNull="value is null",e.Exp_DuplicatedDescriptor="The type of descriptor was added.",e.Exp_TokenIllegal="token is illegal.",e.Exp_ValueIllegal="value is illegal.",e.Exp_InvalidCast="InvalidCastException"},"./src/plugins/formatter/formatter.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function $(t,e,n){return t.substr(e,n)}function K(t){return i.j.Fa(t)?"":"boolean"==typeof t?t?"TRUE":"FALSE":"string"==typeof t?t:""+t}function tt(t,e){if("\\"===t[e])throw Error(f().Exp_InvalidBackslash);if(e-1>0&&e-1<t.length&&"\\"===t[e-1]){if(e-2<0)return!0;if(e-2>0&&e-2<t.length)return"\\"!==t[e-2]}return!1}function et(t){if(!t)throw Error(f().Exp_TokenIsNull);return"["+t+"]"}function nt(t){var e,n,o,r,i;if(t===p||t===h||""===t)return t;for(e="",n=0,o=!1,r=0;r<t.length;r++)'"'===(i=t[r])?(o=!o,e+=i):o?e+=i:"["===i?n++:"]"===i?--n<0&&(n=0):0===n&&(e+=i);return""+e}function ot(t){return t=rt(t,"[",""),rt(t,"]","")}function rt(t,e,n){return!t||t===P.Dc||at(e,n,!0)?t:(e=e.replace(v,"\\$1"),t.replace(RegExp(e,"g"),n))}function it(t){var e,n,o=t.length,r=!1,i="";for(e=0;e<o;e++)"\\"===(n=t.charAt(e))?(r=!r)||(i+=n):(r=!1,i+=n);return i}function at(t,e,n){return n?D(t)===D(e):t===e}function st(t,e){var n,o,r,i;for(1===arguments.length&&(e=!0),n=!1,o="",r=0;r<t.length;r++){if('"'===(i=t[r]))n=!n;else if(!n&&!e&&"/"===i&&!tt(t,r))continue;o+=i}return o}function lt(t,e){var n,o,r;if(!t||t===P.Dc)return!1;for(n=function(t){var e,n,o,r="",i=!1;for(e=0,n=t.length;e<n;e++)'"'===(o=t[e])&&(i=!i),"E"===o||i||(r+=D(o));return r}(st(t)),o=0;o<e.length;o++){if(0===(r=n.indexOf(e[o])))return!0;if(r>0&&"_"!==n[r-1]&&"*"!==n[r-1])return!0}return!1}function ut(t,e,n,o){this.Ic=t,this.Jc=e,this.cultureName=n,this.nOb=o}function ct(t){this.Kc=t}function ft(t){var e,n,r=ot(t);return r&&r!==P.Dc?(n=r[0],["<",">","="].indexOf(n)>-1?(e=G).Name="ConditionalFormatPart":o.u.kb(r,"DBNum",!0)?(e=H).Name="DBNumberFormatPart":at(r[0],"$",!1)&&r.indexOf("-")>-1?(e=L).Name="LocaleIDFormatPart":function(t){var e,n=D(t),o=n[0];if("h"!==o&&"m"!==o&&"s"!==o)return!1;for(e=1;e<n.length;e++)if(o!==n[e])return!1;return!0}(r)?(e=z).Name="ABSTimeFormatPart":r.indexOf("$")<0&&r.length>=3&&((e=W).Name="ColorFormatPart"),e):e}function ht(t,e,n){var o,r;return o=t?t.cultureInfo():M(n),(e<4||4===e&&("ko-kr"===n||"ko-kr"===o.name()))&&(r=o.NumberFormat.dbNumber)?r[e]:h}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/stringhelper.ts"),r=n("./src/common/util/datetimehelper.ts"),i=n("./src/common/util/types.ts"),a=n("./src/common/util/numberhelper.ts"),s=n("./src/common/culture/cultureInfo.ts"),l=n("./src/common/util/common.ts"),u=n("./src/plugins/formatter/formatter.res.en.ts"),i.j.Ia(l.SR.en,u),c=new l.ResourceManager(l.SR),f=c.getResource.bind(c),i.j.Ma=function(t,e){if(i.j.Fa(t))return"null"===e;if(!e)return!1;if(e instanceof Function&&t instanceof e)return!0;if(typeof t===e)return!0;if("function"===e&&/^\s*\bfunction\b/.test(""+t))return!0;if(Object.prototype.toString.call(t).slice(8,-1).toLowerCase()===e.toLowerCase())return!0;if("DateTime"===e)return t instanceof Date;if("TimeSpan"===e){if(t instanceof Date){var n=r.l.Ra(t);return n>=0&&n<1}return!1}return"string"==typeof e&&"undefined number boolean string".indexOf(e),!1},i.j.Na=function(t,e){return!!a.o.Xia(t,e)&&(t=a.o.Oa(t,e),i.j.Ma(t,"number")||i.j.Ma(t,"DateTime")||i.j.Ma(t,"TimeSpan")||t&&!i.j.Ma(t,"boolean")&&!isNaN(t)&&!isNaN(parseFloat(t))&&!(t.length>=2&&"0"===t[0]&&"x"===t[1]))},i.j.Pa=function(t){return i.j.Fa(t)||""===t?0:i.j.Ma(t,"number")?t:i.j.Ma(t,"string")&&!isNaN(t)?a.o.Qa(t):i.j.Ma(t,"boolean")?t?1:0:i.j.Ma(t,"DateTime")?r.l.Ra(t):i.j.Ma(t,"TimeSpan")?Math.floor(r.l.Ra(t)):parseFloat(t)},h=null,p=void 0,d=Math.abs,g={Rc:"yy",vd:"y",Qc:"yyyy",jd:"m",hd:"mm",gd:"mmm",fd:"mmmm",dd:"mmmmm",ud:"d",wd:"dd",kd:"aaa",ld:"aaaa",md:"h",nd:"hh",xd:"m",yd:"mm",td:"s",zd:"ss",ea:"e",rd:"AM/PM",sd:"A/P",ed:"@mmmmm",qd:new Date(1899,11,30,0,0,0,0)},m=[g.vd,g.Rc,g.Qc,g.jd,g.hd,g.gd,g.fd,g.dd,g.ud,g.wd,g.kd,g.ld,g.md,g.nd,g.xd,g.yd,g.td,g.zd,"ggg","gg","g","ee","e"],y={Hc:0,Va:1,Ua:2,_text:3},v=RegExp("([.+?*$^\\[\\](){}|/])","g"),C=[["M/d","MMM/d","MMMM/d","d/M","d/MMM","d/MMMM","M-d","MMM-d","MMMM-d","d-M","d-MMM","d-MMMM"],["M/y","MMM/y","M/yyyy","MMM/yyyy","M-y","MMM-y","M-yyyy","MMM-yyyy"],["M/d/y","MMM/d/y","MMMM/d/y","M/d/yyyy","MMM/d/yyyy","MMMM/d/yyyy","d/M/y","d/MMM/y","d/MMMM/y","d/M/yyyy","d/MMM/yyyy","d/MMMM/yyyy","yyyy/M/d","M-d-y","MMM-d-y","MMMM-d-y","M-d-yyyy","MMM-d-yyyy","MMMM-d-yyyy","d-M-y","d-MMM-y","d-MMMM-y","d-M-yyyy","d-MMM-yyyy","d-MMMM-yyyy","yyyy-M-d"],["H:m","h:m tt"],["H:m:s","H:m:s"],["H:m:s.FFF","h:m:s.FFF tt"],["h:m:s tt","h:mm:ss tt"],["M/d H:m","MMM/d H:m","MMMM/d H:m","d/M H:m","d/MMM H:m","d/MMMM H:m","M/y H:m","MMM/y H:m","M/yyyy H:m","MMM/yyyy H:m","M/d/y H:m","MMM/d/y H:m","MMMM/d/y H:m","M/d/yyyy H:m","MMM/d/yyyy H:m","MMMM/d/yyyy H:m","M-d H:m","MMM-d H:m","MMMM-d H:m","d-M H:m","d-MMM H:m","d-MMMM H:m","M-y H:m","MMM-y H:m","M-yyyy H:m","MMM-yyyy H:m","M-d-y H:m","MMM-d-y H:m","MMMM-d-y H:m","M-d-yyyy H:m","MMM-d-yyyy H:m","MMMM-d-yyyy H:m","M/d h:m tt","MMM/d h:m tt","MMMM/d h:m tt","d/M h:m tt","d/MMM h:m tt","d/MMMM h:m tt","M/y h:m tt","MMM/y h:m tt","M/yyyy h:m tt","MMM/yyyy h:m tt","M/d/y h:m tt","MMM/d/y h:m tt","MMMM/d/y h:m tt","M/d/yyyy h:m tt","MMM/d/yyyy h:m tt","MMMM/d/yyyy h:m tt","M-d h:m tt","MMM-d h:m tt","MMMM-d h:m tt","d-M h:m tt","d-MMM h:m tt","d-MMMM h:m tt","M-y h:m tt","MMM-y h:m tt","M-yyyy h:m tt","MMM-yyyy h:m tt","M-d-y h:m tt","MMM-d-y h:m tt","MMMM-d-y h:m tt","M-d-yyyy h:m tt","MMM-d-yyyy h:m tt","MMMM-d-yyyy h:m tt"],["M/d H:m:s","MMM/d H:m:s","MMMM/d H:m:s","d/M H:m:s","d/MMM H:m:s","d/MMMM H:m:s","M/y H:m:s","MMM/y H:m:s","M/yyyy H:m:s","MMM/yyyy H:m:s","M/d/y H:m:s","MMM/d/y H:m:s","MMMM/d/y H:m:s","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s","MMMM/d/yyyy H:m:s","d/M/y H:m:s","d/MMM/y H:m:s","d/MMMM/y H:m:s","d/M/yyyy H:m:s","d/MMM/yyyy H:m:s","d/MMMM/yyyy H:m:s","yyyy/M/d H:m:s","M-d H:m:s","MMM-d H:m:s","MMMM-d H:m:s","d-M H:m:s","d-MMM H:m:s","d-MMMM H:m:s","M-y H:m:s","MMM-y H:m:s","M-yyyy H:m:s","MMM-yyyy H:m:s","M-d-y H:m:s","MMM-d-y H:m:s","MMMM-d-y H:m:s","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s","MMMM-d-yyyy H:m:s","d-M-y H:m:s","d-MMM-y H:m:s","d-MMMM-y H:m:s","d-M-yyyy H:m:s","d-MMM-yyyy H:m:s","d-MMMM-yyyy H:m:s","yyyy-M-d H:m:s","M/d h:m:s tt","MMM/d h:m:s tt","MMMM/d h:m:s tt","d/M h:m:s tt","d/MMM h:m:s tt","d/MMMM h:m:s tt","M/y h:m:s tt","MMM/y h:m:s tt","M/yyyy h:m:s tt","MMM/yyyy h:m:s tt","M/d/y h:m:s tt","MMM/d/y h:m:s tt","MMMM/d/y h:m:s tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s tt","MMMM/d/yyyy h:m:s tt","d/M/y h:m:s tt","d/MMM/y h:m:s tt","d/MMMM/y h:m:s tt","d/M/yyyy h:m:s tt","d/MMM/yyyy h:m:s tt","d/MMMM/yyyy h:m:s tt","yyyy/M/d h:m:s tt","M/d/yyyy h:mm:ss tt","M-d h:m:s tt","MMM-d h:m:s tt","MMMM-d h:m:s tt","d-M h:m:s tt","d-MMM h:m:s tt","d-MMMM h:m:s tt","M-y h:m:s tt","MMM-y h:m:s tt","M-yyyy h:m:s tt","MMM-yyyy h:m:s tt","M-d-y h:m:s tt","MMM-d-y h:m:s tt","MMMM-d-y h:m:s tt","M-d-yyyy h:m:s tt","MMM-d-yyyy h:m:s tt","MMMM-d-yyyy h:m:s tt","d-M-y h:m:s tt","d-MMM-y h:m:s tt","d-MMMM-y h:m:s tt","d-M-yyyy h:m:s tt","d-MMM-yyyy h:m:s tt","d-MMMM-yyyy h:m:s tt","yyyy-M-d h:m:s tt"],["M/d H:m:s.FFF","MMM/d H:m:s.FFF","MMMM/d H:m:s.FFF","d/M H:m:s.FFF","d/MMM H:m:s.FFF","d/MMMM H:m:s.FFF","M/y H:m:s.FFF","MMM/y H:m:s.FFF","M/yyyy H:m:s.FFF","MMM/yyyy H:m:s.FFF","d/M/y H:m","d/MMM/y H:m","d/MMMM/y H:m","d/M/yyyy H:m","d/mmm/yyyy H:m","d/MMMM/yyyy H:m","yyyy/M/d H:m","M/d/y H:m:s.FFF","MMM/d/y H:m:s.FFF","MMMM/d/y H:m:s.FFF","M/d/yyyy H:m:s","MMM/d/yyyy H:m:s.FFF","MMMM/d/yyyy H:m:s.FFF","d/M/y H:m:s.FFF","d/MMM/y H:m:s.FFF","d/MMMM/y H:m:s.FFF","d/M/yyyy H:m:s.FFF","d/MMM/yyyy H:m:s.FFF","d/MMMM/yyyy H:m:s.FFF","yyyy/M/d H:m:s.FFF","M-d H:m:s.FFF","MMM-d H:m:s.FFF","MMMM-d H:m:s.FFF","d-M H:m:s.FFF","d-MMM H:m:s.FFF","d-MMMM H:m:s.FFF","M-y H:m:s.FFF","MMM-y H:m:s.FFF","M-yyyy H:m:s.FFF","MMM-Yyyy H:m:s.FFF","d-M-y H:m","d-MMM-y H:m","d-MMMM-y H:m","d-M-yyyy H:m","d-MMM-yyyy H:m","d-MMMM-yyyy H:m","yyyy-M-d H:m","M-d-y H:m:s.FFF","MMM-d-y H:m:s.FFF","MMMM-d-y H:m:s.FFF","M-d-yyyy H:m:s","MMM-d-yyyy H:m:s.FFF","MMMM-d-yyyy H:m:s.FFF","D-M-y H:m:s.FFF","d-MMM-y H:m:s.FFF","d-MMMM-y H:m:s.FFF","D-M-yyyy H:m:s.FFF","d-MMM-yyyy H:m:s.FFF","d-MMMM-yyyy H:m:s.FFF","yyyy-M-d H:m:s.FFF","M/d h:m:s.FFF tt","MMM/d h:m:s.FFF tt","MMMM/d h:m:s.FFF tt","d/M h:m:s.FFF tt","d/MMM h:m:s.FFF tt","d/MMMM h:m:s.FFF tt","M/y h:m:s.FFF tt","MMM/y h:m:s.FFF tt","M/yyyy h:m:s.FFF tt","MMM/yyyy h:m:s.FFF tt","d/M/y h:m tt","d/MMM/y h:m tt","d/MMMM/y h:m tt","d/M/yyyy h:m tt","d/mmm/yyyy h:m tt","d/MMMM/yyyy h:m tt","yyyy/M/d h:m tt","M/d/y h:m:s.FFF tt","MMM/d/y h:m:s.FFF tt","MMMM/d/y h:m:s.FFF tt","M/d/yyyy h:m:s tt","MMM/d/yyyy h:m:s.FFF tt","MMMM/d/yyyy h:m:s.FFF tt","d/M/y h:m:s.FFF tt","d/MMM/y h:m:s.FFF tt","d/MMMM/y h:m:s.FFF tt","d/M/yyyy h:m:s.FFF tt","d/MMM/yyyy h:m:s.FFF tt","d/MMMM/yyyy h:m:s.FFF tt","yyyy/M/d h:m:s.FFF tt","M-d h:m:s.FFF tt","MMM-d h:m:s.FFF tt","MMMM-d h:m:s.FFF tt","d-M h:m:s.FFF tt","d-MMM h:m:s.FFF tt","d-MMMM h:m:s.FFF tt","M-y h:m:s.FFF tt","MMM-y h:m:s.FFF tt","M-yyyy h:m:s.FFF tt","MMM-Yyyy h:m:s.FFF tt","d-M-y h:m tt","d-MMM-y h:m tt","d-MMMM-y h:m tt","d-M-yyyy h:m tt","d-MMM-yyyy h:m tt","d-MMMM-yyyy h:m tt","yyyy-M-d h:m tt","M-d-y h:m:s.FFF tt","MMM-d-y h:m:s.FFF tt","MMMM-d-y h:m:s.FFF tt","M-d-yyyy H:m:s tt","MMM-d-yyyy H:m:s.FFF tt","MMMM-d-yyyy h:m:s.FFF tt","d-M-y h:m:s.FFF tt","d-MMM-y h:m:s.FFF tt","d-MMMM-y h:m:s.FFF tt","d-M-yyyy h:m:s.FFF tt","d-MMM-yyyy h:m:s.FFF tt","d-MMMM-yyyy h:m:s.FFF tt","yyyy-M-d h:m:s.FFF tt"]],b=i.j.Ma,w=i.j.Ca,T=a.o,x=T.eka+"."+T.fka,S=T.Jja,A=T.mb,I=T.Lma,R=i.j.Fa,k=isNaN,M=function(t){return s.CultureManager.q4(t)},N=function(t){return M(t).DateTimeFormat},E=function(t){return M(t).NumberFormat},D=function(t){return t&&t.toLowerCase()},O=function(t){return t&&t.toUpperCase()},j=function(){throw Error(f().Exp_FormatIllegal)},F=function(){return s.CultureManager.booleanMapping},P={Dc:"",Kb:function(){var t,e,n,o,r,i,a=[];for(t=0;t<arguments.length;t++)a[t]=arguments[t];for(e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(0===arguments.length)return h;for(o=e[0],r=1;r<arguments.length;r++)i=RegExp("\\{"+(r-1)+"\\}","gm"),o=o.replace(i,arguments[r]);return o},Ec:function(t){return!t||t===P.Dc}},_={Fc:function(t){var e=t.charCodeAt(0);return e>=48&&e<=57},Gc:function(t){var e=t.charCodeAt(0);return e>=9&&e<=13||32===e||133===e||160===e}},L=function(){function t(t,e){var n,r,i,a;if(ct.call(this,e),(n=this).Uc=t,i=at((r=n.Uc)[0],"$",!1),a=r.indexOf("-"),!(i&&a>-1))throw Error(f().Exp_TokenIllegal);n.Vc=$(r,1,a-1),(r=o.u.Fb(r,0,a+1)).length>0&&(n.Wc=parseInt(r,16))}return t.prototype.cultureInfo=function(){var t=this;return t.Xc||(t.Xc=M(t.Wc),t.Vc&&t.Vc!==P.Dc&&!t.Xc.NumberFormat.isReadOnly&&(t.Xc.NumberFormat.currencySymbol=t.Vc)),t.Xc},t.prototype.currencySymbol=function(){return this.Vc?o.u.Gb(this.Vc,"\\.",'"."'):P.Dc},t.prototype.allowScience=function(){if(this.Xc)return!this.Xc.isJCKCulture},t.prototype.toString=function(){return this.Uc?et(this.Uc):P.Dc},t.Name="LocaleIDFormatPart",t}(),B=function(){function t(t,e){this.formatCached=t,this.cultureName=e,this.typeName=""}return t.prototype.format=function(t){return h},t.prototype.parse=function(t){return h},t.prototype.formatString=function(t){return this.formatCached},t.prototype.toJSON=function(){var t,e={};for(t in this)this.hasOwnProperty(t)&&(e[t]=this[t]);return e},t.prototype.fromJSON=function(t){if(t)for(var e in t)t[e]!==p&&(this[e]=t[e])},t}(),e.FormatterBase=B,G=function(){function t(t,e){var n,r,i,a,s,l,u,c;for(ct.call(this,e),n=this,l=0,u=(s=["<=","<>",">=",">","<","="]).length;l<u;l++)if(r=s[l],o.u.kb(t,r,!0)){i=o.u.Fb(t,0,r.length),c=parseFloat(i),k(c)||(a=c);break}if(a===h&&a===p)throw Error(f().Exp_TokenIllegal);n.value=a,n.Sc=r,n.isMeetCondition=function(t){var e=n.Sc,o=n.value;switch(e){case"<=":return t<=o;case"<>":return t!==o;case">=":return t>=o;case">":return t>o;case"<":return t<o;case"=":return t===o}}}return t.prototype.toString=function(){return et(this.Sc+""+this.value)},t}(),H=function(){function t(t,e){ct.call(this,e);var n=this;if(n.token=t,n.type=parseInt(o.u.Fb(t,0,5),10),n.type<0||n.type>4)throw Error(f().Exp_TokenIllegal)}return t.prototype.Pc=function(e,n,r){var i,a,s,l,u,c,f,h,p,d;if(!e||e===P.Dc)return e;for(i=e,a=e,s=-1,l=-1,u=!1,p=e.length-1;p>=0;p--)d=a[p],!k(d)&&!at(d," ",!1)||at(d,".",!1)&&!u?(at(d,".",!1)&&(u=!0),-1===s&&(s=p),l=p):l>-1&&s>-1&&(c=$(a,l,s-l+1),f=parseFloat(c),k(f)||(h=t.numberString(c,n,r),i=o.u.Fb(i,l,s-l+1),i=o.u.Eb(i,l,h)),s=-1,l=-1,u=!1);return l>-1&&s>-1&&(c=$(a,l,s-l+1),f=parseFloat(c),k(f)||(h=t.numberString(c,n,r),i=o.u.Fb(i,l,s-l+1),i=o.u.Eb(i,l,h))),i},t.prototype.toString=function(){if(this.type>-1)return et("DBNum"+this.type);throw Error()},t.numberString=function(e,n,o){var r=t.formatNumberString,i=e.split(".");if(i){if(1===i.length)return r(i[0],n.numbers,o?n.letters:h);if(2===i.length)return r(i[0],n.numbers,o?n.letters:h)+"."+r(i[1],n.numbers)}throw Error(f().Exp_ValueIllegal)},t.formatNumberString=function(e,n,o){var r,i,a,s,l,u,c,f,h,p,d,g,m,y=e,v=0,C=0;if(2===arguments.length){for(i="",v=0;v<y.length;v++)r=$(y,v,1),i+=n[C=parseInt(r,10)];return i}if(3===arguments.length){if(!o)return t.formatNumberString(e,n);for(a=0,s="",l=y.length,u=!1,c=[],v=0;v<l;v++)(f=o.length-1-v)>-1?c.push(""+o[f]):c.push(P.Dc);for(h=[],p=c.length-1;p>=0;p--)h[c.length-p-1]=c[p];for(c=h,d=!1,p=0;p<l;p++)r=$(y,p,1),C=parseInt(r,10),g=void 0,m=P.Dc,l-p-16>0?(g=n[C],m="",d=!0):p!==l-1&&p!==l-5&&p!==l-9&&p!==l-13?"0"===r?(g="",m="",a+=1):"0"!==r&&0!==a?(g=n[0]+n[C],m=c[p],a=0):(g=n[C],m=c[p],a=0):"0"!==r&&0!==a?(g=n[0]+n[C],m=c[p],a=0):"0"!==r&&0===a||d?(g=n[C],m=c[p],a=0,d=!1):"0"===r&&a>=3?(g="",m="",a+=1):l>=11?(g="",a+=1):(g="",m=c[p],a+=1),g+m===P.Dc||(u=!1),p!==l-13||u||(m=c[p],u=!0),p!==l-9||u||(m=c[p],u=!0),p===l-1&&(m=c[p],u=!0),s=s+g+m;return 0===parseInt(e,10)?n[0]:s}},t}(),V=function(){function t(t,e,n,o,r,i){ut.call(this,e,n,o,i);var a=this;a.Yc=a.Zc(st(t)),a.$c=r,a._c=2,a.ad()}return t.prototype.ad=function(){var e,n,o,r=this,i={Qb:r.Yc};if(t.Lc(i.Qb)){if(e=r.bd(i),r.hasJD=r.Gb(i.Qb,g.dd,'"'+g.ed+'"',!0,!1,i,!1),r.Gb(i.Qb,g.fd,"MMMM",!0,!1,i,!1),r.Gb(i.Qb,g.gd,"MMM",!0,!1,i,!1),r.Gb(i.Qb,g.hd,"MM",!0,!1,i,!1),r.Gb(i.Qb,g.jd,"M",!0,!1,i,!1),r.Gb(i.Qb,g.kd,"ddd",!0,!0,i,!0),r.Gb(i.Qb,g.ld,"dddd",!0,!0,i,!0),e||(r.Gb(i.Qb,g.md,"H",!0,!0,i,!1),r.Gb(i.Qb,g.nd,"HH",!0,!0,i,!1)),r.Jc&&r.Ic&&(r.od=r.od||r.Gb(i.Qb,g.Qc,'"@'+g.Qc+'"',!0,!1,i,!0),r.od=r.od||r.Gb(i.Qb,g.Rc,'"@'+g.Rc+'"',!0,!1,i,!0)),r.$c)for(n=0;n<r.$c.length;n++)o=r.$c[n],r.Gb(i.Qb,o.Kc,"@"+o.Kc,!0,!0,i,!0);r.pd=i.Qb}else j()},t.prototype.formatString=function(){return this.Yc},t.prototype.format=function(t){var e,n,i,a,s,l,u=this,c=P.Dc,f=h;try{if((f=r.l.Yb(t))&&k(f.valueOf())&&(f=h),f?t=f:c=""+t,f&&(c=r.l.mb(f,u.pd,u.Ic&&u.Ic.cultureInfo()||M(u.cultureName),u.nOb),u.hasJD&&(e=M(u.cultureName).DateTimeFormat.monthNames[f.getMonth()],c=o.u.Gb(c,g.ed,$(e,0,1))),u.$c))for(n=24*(r.l.Ra(f)-r.l.Ra(g.qd))*60*60*1e3,i=0;i<u.$c.length;i++)s=(a=u.$c[i]).Tc(n),R(s)||(l=a.Kc.replace("[","\\[").replace("]","\\]"),c=o.u.Gb(c,"@"+l,s))}catch(e){c=K(t)}return function(t,e,n,o,i){var a,s=t;return!R(o)&&e instanceof Date&&(a=ht(n,o.type,i),s=o.Pc(s,a,!0),1===o.type&&(s=s.replace(RegExp("ä¸å","g"),"å")),s=(s=s.replace("@"+g.Qc,r.l.Vb(e,g.Qc))).replace("@"+g.Rc,r.l.Vb(e,g.Rc)),s=o.Pc(s,a,!1)),s}(c,t,u.Ic,u.Jc,u.cultureName)},t.prototype.parse=function(t){var e,n,o,i,a;if(!t||t===P.Dc)return h;if(e=this,"true"===(o=D(n=t)))return!0;if("false"===o)return!1;if(e.pd&&(i=r.l.Wb(n,e.pd,M(e.cultureName))))return i;try{return(a=r.l.Yb(n))&&!k(a)?a:(a=new Date(n),k(a.valueOf())?n:a)}catch(t){return n}},t.prototype.Zc=function(t){var e,n,o,r=t,i="",a=!1;for(e=0;e<r.length;e++)'"'===(n=r[e])?a=!a:a||("Y"===n||"D"===n||"S"===n||"E"===n||"G"===n?n=D(n):"M"===n&&(at("A",o=r[e-1],!0)||at("P",o,!0)||(n=D(n)))),i+=n;return i},t.prototype.bd=function(t){var e,n=[g.rd,N(this.cultureName).amDesignator+"/"+N(this.cultureName).pmDesignator,g.sd],r=["tt","tt","t"],i=t.Qb;for(e=0;e<3;e++){if(o.u.Bb(i,r[e]))return!0;if(o.u.Bb(i,n[e],!0))return t.Qb=o.u.Gb(i,n[e],r[e],!0),!0}return!1},t.prototype.Gb=function(e,n,r,i,a,s,l){var u,c,f,h,p,d,g,m,y,v,C;if(i||a){for(u=[],c=!0,!t.hasDate(e)&&t.hasTime(e)&&(c=!1),f=!1,h=0;h<e.length;h++){if(p=e[h],t.hasTime(p)&&!f?c=!1:t.hasDate(p)&&!f&&(c=!0),i&&at(p,n[0],l)&&c||a&&at(p,n[0],l)&&!c){for(d=!0,g=0;g<n.length;g++)if(g+h>=e.length||!at(n[g],e[g+h],l)){d=!1;break}if(m=h+n.length-1,d&&m+1<e.length){for(y=e[m],v=-1,v=m+1;v<e.length&&at(y,e[v],l);v++);v>m+1&&(h=v,d=!1)}d&&!f&&u.splice(0,0,h)}'"'===p&&(f=!f)}if(s.Qb=e,u.length>0){for(h=0;h<u.length;h++)C=u[h],s.Qb=o.u.Fb(s.Qb,C,n.length),s.Qb=o.u.Eb(s.Qb,C,r);return!0}return!1}return!1},t.hasTime=function(t){return o.u.Cb(t,g.md[0],!0)>-1||o.u.Cb(t,g.td[0],!0)>-1},t.hasDate=function(t){return o.u.Cb(t,g.Rc[0],!0)>-1||o.u.Cb(t,g.ud[0],!0)>-1},t.Lc=function(t,e){return lt(t,e||m)},t}(),e.lxb=V,z=function(){function t(t,e){var n,o;if(ct.call(this,e),this,"h"===(n=D(t)[0]))o=3600;else if("m"===n)o=60;else{if("s"!==n)throw Error(f().Exp_TokenIllegal);o=1}this.Tc=function(t){var e=t/1e3/o;return Math.abs(e-Math.round(e))<1e-6?Math.round(e):Math.floor(e)}}return t.Name="ABSTimeFormatPart",t}(),W=function(){function t(t,e){ct.call(this,e),this.foreColor=t}return t.prototype.toString=function(){return et(this.foreColor)},t.Name="ColorFormatPart",t}(),U=function(){function t(t,e,n,o){var r,i,a,s,l;ut.call(this,e,n,o),(r=this).Ad=!1,r._c=1,r.Bd=nt(t),i=st(t),e&&(i=rt(i,r.Ic.Kc,r.Ic.currencySymbol())),(i=nt(i)).indexOf("/")>-1&&((a=function(t,e){var n,o,r,i,a,s=[];if(t===h||""===t)return s;for(n=!1,o=[],r=!1,i=0;i<t.length;i++)'"'!==(a=t[i])||n||(r=!r),n||r||a!==e?o.push(a):(s.push(o.join("")),o=[]),n="\\"===a&&!n;return s.push(o.join("")),s}(i,"/"))&&2===a.length&&(r.Cd=a[1],(s=a[0])&&((l=s.lastIndexOf(" "))>-1?(r.Dd=$(s,0,l),r.Ed=$(s,l+1,s.length-l-1)):r.Ed=s))),r.Fd=i}return t.prototype.formatString=function(){return this.Bd},t.prototype.format=function(e){var n,o,r,a,s,l,u,c,f,p,d,g,m,y,v,C,w,T,x,I,N;return b(e,"boolean")?(""+e).toUpperCase():(n=this,o=i.j.Pa(e),k(o)||!isFinite(o)||k(e)?"string"==typeof e?e:h:(r=M(n.cultureName),n.Ed&&n.Cd?(f={value:0},p={value:0},d={value:0},g=n.bPa(),t.getFraction(o,g,f,p,d)?((m=t.getGCD(p.value,d.value))>1&&(p.value/=m,d.value/=m),n.Dd?(c="",1===d.value&&(f.value+=p.value,p.value=0,d.value=0),(y=S(A(f.value,n.Dd,r)))&&"0"!==y&&(c+=y,c+=" "),0===f.value&&o<0&&(c+=r.NumberFormat.negativeSign),0===o&&(c+="0"),a=n.Cd,s=parseFloat(a),!k(s)&&s>0&&(0!==p.value&&0!==d.value&&(p.value*=s/d.value),d.value=s,a=a.replace(/^\d+/,t.toNumberPlaceholder(s)),u=(l=Math.ceil(p.value))-p.value,p.value=u<=.5&&u>=0?parseFloat(""+l):parseFloat(""+(l-1))),v=n.Ed,C=parseFloat(v),k(C)||0!==C||((w=v.length)>(x=(T=""+p.value).length)?v=v.substr(0,w-(w-x)):w<x&&(T=T.substr(0,x-(x-w)),p.value=parseInt(T,10))),I=n.Mja(p.value,d.value,v,a,r),0===p.value&&(I=I.replace(/./g," "),""===y)?"0 "+I:""===(c+=I)?"0":c):(c="",N=f.value*d.value+p.value,a=n.Cd,(s=parseFloat(a))>0?(N*=s/d.value,d.value=s,c+=(N=(u=(l=Math.ceil(N))-N)<=.5&&u>=0?parseFloat(""+l):parseFloat(""+(l-1)))+"/"+d.value):c+=n.Mja(N,d.value,n.Ed,n.Cd,r),0===N?"0":c)):""+o):function(t,e,n,o,r){var i,a,s,l,u,c,f;if(!R(o)&&(i=ht(n,o.type,r),!R(i))){for(a=!1,s=void 0,l=M(r),u=void 0,c=0,f=t.length;c<f;c++)"decimalSeparator"===t[c].type&&(a=!0,t[c].value=o.Pc(t[c].value,i,e),s=t[c].value),"number"===t[c].type&&(t[c].value=a?o.Pc(s+t[c].value,i,e).slice(1):o.Pc(t[c].value,i,e),"ja-JP"===l.name()&&t[c].value.length>1&&("ä¸å"===(u=t[c].value.substr(0,2))||"ä¸ç¾"===u||"ä¸å"===u)&&(t[c].value=t[c].value.substr(1)));return t}return t}(A(o,n.Fd,r),n.Ad,n.Ic,n.Jc,n.cultureName)))},t.prototype.parse=function(t){var e,n,r,i,a,s,l,u,c,f,p=this;return t&&t!==P.Dc?!!("TRUE"===(e=O(t))||e===F()&&F().boolean_true)||!("FALSE"===e||e===F()&&F().boolean_false)&&(n=p.Ed&&p.Cd,r=p.Jd(p.Fd).Kd,(n||r)&&(0<(i=t.indexOf("/"))&&i<t.length-1&&(a=parseInt(t.substr(0,i),10),s=parseInt(t.substr(i+1),10),!isNaN(a)&&!isNaN(s)&&0!==s))?a/s:(t=p.Hd(t),t=p.Id(t),u=(l=p.Jd(t)).Kd,c=l.Ld,p.jBb(c)&&(c=o.u.Hb(c,E(p.cultureName).numberGroupSeparator,"",!1),f=T.ob(c,p.cultureName),!k(f)&&isFinite(f))?(u&&(f=I(f/100,15)),f):h)):h},t.prototype.bPa=function(){var t,e,n=this.Cd,o=0;if(n)for(t=n.length,e=0;e<t&&n[e].match(/[#?0\d]/);e++)o++;return o},t.prototype.jBb=function(t){var e,n="",o=0,r=0,i=0,a=h,s=E(this.cultureName);for(e=t.length-1;e>-1;e--){if(t[e]===s.numberDecimalSeparator)o++,i>0&&(a=!1),n="";else if("e"===D(t[e])){if(r++,n="",e===t.length-1)return!1}else if(t[e]===s.numberGroupSeparator)a=3===n.length,i++,n="";else if("-"===t[e]||"+"===t[e]){if(e>0&&"e"!==D(t[e-1]))return!1}else{if(!_.Fc(t[e]))return!1;if(n+=t[e],0===e&&0===parseInt(n,10)&&a)return!1}if(o>1||r>1||!1===a)return!1}return!0},t.prototype.Hd=function(t){var e,n,r,i,a,s,l=t,u=[];for(e=0;e<l.length;e++)_.Fc(l[e])&&u.push(e);for(r=[(n=E(this.cultureName)).currencyDecimalSeparator,n.currencyGroupSeparator,n.currencySymbol,n.nanSymbol,n.negativeInfinitySymbol,n.negativeSign,n.numberDecimalSeparator,n.numberGroupSeparator,n.percentDecimalSeparator,n.percentGroupSeparator,n.percentSymbol,n.perMilleSymbol,n.positiveInfinitySymbol,n.positiveSign],i=l.length-1;i>-1;i--)if(a=l[i],!_.Gc(a)||r.indexOf(""+a)>-1){if(("-"===a||"+"===a)&&(s=i>0?""+l[i-1]:h,["e","E","(",E(this.cultureName).currencySymbol].indexOf(s)<0))break}else(i<u[0]||u[u.length-1]<i)&&(l=o.u.Fb(l,i,1));return l},t.prototype.Id=function(t){var e=E(this.cultureName).currencySymbol,n=o.u.kb(t,e)?o.u.Fb(t,0,e.length):t;return n.indexOf(e)<0?n:t},t.prototype.Jd=function(t){var e=E(this.cultureName).percentSymbol,n=!0,r=t;return o.u.kb(t,e)?r=o.u.Fb(t,0,e.length):o.u.jb(t,e)?r=o.u.Fb(t,t.length-e.length,e.length):n=!1,o.u.Bb(r,e)&&(n=!1),{Ld:r,Kd:n}},t.prototype.Mja=function(t,e,n,o,r){var i=S(A(t,n,r)),a=S(A("0."+e,"#."+o,r,!0)),s=i+"/"+a.substr(a.indexOf(".")+1);return""===n&&(s=t+s),""===o&&(s+=e),s},t.getGCD=function(t,e){var n,o;if(0===t)return d(e);if(0===e)return d(t);for(o=Math.max(t,e)%(n=Math.min(t,e));0!==o;)o=n%(n=o);return d(n)},t.getFraction=function(t,e,n,o,r){var i,a,s,l,u,c,f,h,p,g=0,m=0,y=0,v=0,C=Math.ceil;for(t>0?1===(v=t-C(t)+1)?(v=0,g=t):g=C(t)-1:t<0&&(g=C(t),v=C(t)-t),(i=Math.pow(10,e-1))<2&&(i=2),(a=Math.pow(10,e)-1)<2&&(a=2),s=!1,l=0,u=i;u<=a&&(c=u*v,f=Math.round(c),p=d((h=f/u)-v),!((!s||p<d(l-v))&&(s=!0,l=h,m=f,y=u,p<1e-5)));u++);return n.value=g,o.value=m,r.value=y,s},t.toNumberPlaceholder=function(t){return(""+t).replace(/\d/g,"?")},t}(),q=function(){function t(e,n,o,r){ut.call(this,n,o,r),arguments.length>0?(t.kBb(e)||j(),this.Bd=e):this.Bd="General",this._c=0}return t.kBb=function(t){var e,n,o="",r=!1,i=-1,a=t.length;for(e=0;e<a;e++)'"'===(n=t[e])?i=(r=!r)?e:-1:r||(o+=n);return i>0&&(o+=t.substring(i,a)),!(o.indexOf("0")>=0||o.indexOf("#")>=0||o.indexOf(".")>=0||o.indexOf("@")>=0)},t.prototype.Nd=function(){var t,e=this;return e.Od||(t=rt(t=e.Bd,"General",x),e.Od=new U(t,e.Ic,e.Jc,e.cultureName),e.Od.Ad=!0),e.Od},t.prototype.Pd=function(){var t=this;return t.Qd||(t.Qd=new U("0.#####E+00",t.Ic,t.Jc,t.cultureName),t.Qd.Ad=!0),t.Qd},t.prototype.formatString=function(){return o.u.Gb(this.Bd,"@NumberFormat","General")},t.prototype.format=function(t){var e,n,r=this;if(i.j.Na(t,r.cultureName)){if(e=!r.Ic||r.Ic.allowScience(),(n=i.j.Pa(t))!==p&&n!==h)return d(n)>99999999999&&e||d(n)<1e-11&&0!==n?r.Pd().format(t):r.Nd().format(t)}else{if(b(t,"string"))return it(o.u.Gb(r.formatString(),'"',"")),t;if(b(t,"boolean"))return(""+t).toUpperCase()}return""},t.prototype.parse=function(t){var e,n,i,a,l,u,c,f,g,m,y,v,C,w;return P.Ec(t)?h:"number"==typeof t?t:(e=!1,n=t.trim(),(i=o.u.Cb(n,"-",!1))>0&&!at(n.charAt(i-1),"E",!0)&&(e=!0),u=(l=(a=M(this.cultureName)).DateTimeFormat).dateSeparator,c=l.timeSeparator,f=l.monthNames,g=l.abbreviatedMonthNames,m=function(t,e){var n,r,i;if(!e||0===e.length)return!1;for(n=!1,r=0,i=e.length;r<i;r++)if(o.u.Bb(t,e[r],!0)){n=!0;break}return n},(e||o.u.Bb(n,u,!1)||o.u.Bb(n,c,!1)||o.u.Bb(n,"/",!1)||o.u.Bb(n,":",!1)||o.u.Bb(n,"-",!1)||o.u.Bb(n,"å¹´",!1)||o.u.Bb(n,"æ",!1)||o.u.Bb(n,"æ¥",!1)||m(n,f)||m(n,g)||"ja-JP"===a.name()&&s.aBb.R.indexOf(n[0].toUpperCase())>=0&&o.u.Bb(n,".",!1))&&(y=r.l.Qa(n))?y:(C="-"===n.charAt(0),(w="("===(n=C?o.u.Fb(n,0,1):n).charAt(0)&&")"===n.charAt(n.length-1))&&(n=n.substring(1,n.length-1)),(v=this.Nd().parse(n))!==h&&v!==p?(w||C)&&b(v,"number")?-1*d(v):v:t))},t}(),Y=function(){function t(t,e,n,o){var r,i=this;ut.call(i,e,n,o),r=st(t,!1),e&&(r=rt(r,i.Ic.Kc,i.Ic.currencySymbol())),r=it(r=nt(r)),i.Yc=r,i._c=3}return t.prototype.format=function(t){var e,n,o=this;try{return void 0,void 0,e=t instanceof Date?""+r.l.Ra(t):K(t),n=o.Kja(o.Yc),o.Lja(e,n)}catch(t){return""}},t.prototype.parse=function(t){return t||""},t.prototype.formatString=function(){return this.Yc},t.prototype.Kja=function(t){var e,n,o="",r=!1,i=h,a=[];for(n=0;n<t.length;n++)e=t.charAt(n),r?('"'!==e?o+=e:(o+=e,a.push(o),o="",r=!1),i=e):"*"!==i&&"_"!==i&&"\\"!==i||""===o?"*"!==e&&"_"!==e&&"\\"!==e?"@"!==e?'"'!==e?(o+=e,i=e):(i=e,""!==o&&a.push(o),o=e,r=!0):(i=e,""!==o&&(a.push(o),o=""),a.push(e)):(i=e,""!==o&&(a.push(o),o=""),o+=e):(o+=e,a.push(o),o="");return""!==o&&a.push(o),a},t.prototype.Lja=function(t,e){var n,o,r=[],i=!1;for(n=e.length-1;n>=0;n--)"*"===(o=e[n])[0]?i||(i=!0,r.push({type:"fillingChar",value:o[1]})):"_"===o[0]?r.push({type:"placeholder",value:o[1]}):'"'===o[0]&&'"'===o[o.length-1]?o.length>2&&r.push({type:"text",value:o.substr(1,o.length-2)}):"@"===o[0]?r.push({type:"text",value:t}):r.push({type:"text",value:o});return r.reverse()},t}(),X=function(){return{pattern:C,formatter:["d-mmm","mmm-yy",N().shortDatePattern,"h:mm","h:mm:ss","h:mm:ss.0","h:mm:ss tt",N().shortDatePattern+" h:mm",N().shortDatePattern+" h:mm:ss",N().shortDatePattern+" h:mm:ss.0"]}},Z=function(){function t(t,e){var n=this;0===arguments.length?(n.formatCached="General",n.Rd=new q):n.ad(t,e)}return t.prototype.ad=function(e,n){var o,r,i,a,l,u,c,f,d,g,m,y,v,C,b,w;for(e!==h&&e!==p||j(),o=e,(r=this).formatCached=e,i="",a="",l=!1,u=!1,c=!1,f=[],d=0;d<e.length;d++)'"'===(g=e[d])?(u=!u,a+=g):u?a+=g:"["===g?(l&&j(),a&&(i||(i=""),i+=a),a=""+g,l=!0):"]"===g?(l||j(),a?(m=""+(a+=g),(y=ft(""+a))?"ABSTimeFormatPart"===y.Name?(f.push(new y(t.preProcessPart(m),m)),i+=a):m===s.aBb.eraExcelFormatter?(r.addPart(y,s.aBb.eraInternalFormatter),c=!0):r.addPart(y,m):(i+=v=t.partToNormalStr(m),o=rt(e,m,v)),a=""):j(),l=!1):a+=g;a?l?j():i+=a:i||(i=r.o$a()),r.localeIDFormatPart&&(n=r.localeIDFormatPart.cultureInfo().name()),b=(C=function(t,e){var n,o=!1;return lt(t=t?""+t:P.Dc,["general"])?n=q:V.Lc(t)?n=V:lt(t,["E+","E-","#",".",",","%","0","/","?"])||e?(o=!0,n=U):(o=!0,n=Y),{Mc:o,Nc:n}}(i,r.conditionalFormatPart)).Nc,w=C.Mc?o:i,b?r.Rd=new b(w,r.localeIDFormatPart,r.dbNumberFormatPart,n,f.length>0?f:h,c):j()},t.prototype.o$a=function(){var e=this,n="";return e.dbNumberFormatPart&&(t.proNames.some((function(t){return"dbNumberFormatPart"!==t&&e[t]}))||(n="General")),n},t.prototype.formatString=function(){var e,n,o,r=this,i="";for(e=0,n=t.proNames.length;e<n;e++)r[o=t.proNames[e]]&&(i+=""+r[o]);return i+r.Rd.formatString()},t.prototype.addPart=function(e,n){var o,r,i,a=t.proNames,s=t.preProcessPart(n);for(o=0,r=a.length;o<r;o++)if(at(i=a[o],e.Name,!0)){if(this[i])throw Error(f().Exp_DuplicatedDescriptor);this[i]=new e(s,n)}},t.prototype.format=function(t){return this.Rd.format(t)},t.prototype.parse=function(t){return this.Rd.parse(t)},t.checkFormatter=function(t){if(!t||t===P.Dc)throw Error(f().Exp_TokenIllegal)},t.preProcessPart=function(e){t.checkFormatter(e);var n=ot(e);return t.checkFormatter(n),n},t.partToNormalStr=function(e){var n=t.preProcessPart(e);return"$"===n[0]&&(n=n.slice(1)),'"'+n+'"'},t.proNames=["colorFormatPart","conditionalFormatPart","dbNumberFormatPart","localeIDFormatPart"],t}(),Q=function(t){function e(e,n){var o=t.call(this,e,n)||this,r=o;return r.Sd=!0,r.PropertyChanged=[],P.Ec(e)&&(e="General"),r.formatCached=e,r.cultureName=n,r.init(),o}return J(e,t),e.prototype.toJSON=function(){var t=this,e={formatCached:t.formatCached};return t.cultureName&&(e.customerCultureName=t.cultureName),"general"===D(t.formatCached)&&delete e.formatCached,e},e.prototype.hasFormatedColor=function(){var t,e;for(t in y)if(y.hasOwnProperty(t)&&((e=this.getFormatter(y[t]))&&e.colorFormatPart))return!0;return!1},e.prototype.formatString=function(t){var e,n,o,r=this;if(0===arguments.length){for(e=P.Dc,n=0,o=r.formatters.length;n<o;n++)e+=r.formatters[n].formatString(),n!==o-1&&(e+=";");return e}if(!t)throw Error(f().Exp_ValueIsNull);return r.formatters=h,r.formatCached=t,r.init(),r.Td("formatString"),r},e.prototype.getFormatter=function(t){return this.formatters&&this.formatters[t]},e.prototype.getPreferredEditingFormatter=function(t){var n,o,r=N(this.cultureName),a=e.defFormatter;return b(t,"TimeSpan")?a(r.longTimePattern):b(t,"DateTime")?(n=0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()?"":" h:mm:ss",a(r.shortDatePattern+n)):i.j.Na(t,this.cultureName)?a((o=i.j.Pa(t))>=1e20||o<=1e-17&&o>0||o<=-1e20||o<0&&o>=-1e-17?"0.##E+00":x):a("General")},e.prototype.getPreferredDisplayFormatter=function(t,n){var a,s,l,u,c,f,p,d,g,m,y,v,C,w,T,x,S,A,I,R,k,N,D,O=this,j=e.defFormatter;if(n||(n={value:h}),n.value=h,P.Ec(t))return new e;if(a=t,s=n.value=O.parse(a),b(s,"DateTime")||b(s,"TimeSpan")){for(u=(l=X()).pattern,c=l.formatter,(d=(p=(f=M(O.cultureName)).DateTimeFormat).preselectedFormatters).length>0&&(u=u.concat([d]),c=c.concat([d[0]])),"ja-JP"===f.name()&&(u=u.concat([p.eraFormatter]),c=c.concat(["ge.M.d"]),g=f._Ab.filter((function(t){return"ggge"===t.substr(0,4)})),u=u.concat([g]),c=c.concat(['ggge"å¹´"M"æ"d"æ¥']),m=f._Ab.filter((function(t){return"gge"===t.substr(0,3)})),u=u.concat([m]),c=c.concat(['gge"å¹´"M"æ"d"æ¥']),y=f._Ab.filter((function(t){return"ge"===t.substr(0,2)})),u=u.concat([y]),c=c.concat(['ge"å¹´"M"æ"d"æ¥'])),v=0;v<u.length;v++)for(C=u[v],w=0;w<C.length;w++)if(T=C[w],(x=r.l.Qa(t,T))&&x-s==0)return new e(c[v])}else if(i.j.Na(s,O.cultureName)){if(A=(S=E(O.cultureName)).currencySymbol,I=S.numberDecimalSeparator,R=S.percentSymbol,k=S.numberGroupSeparator,"E",D=(N=o.u.Bb)(a,I)?".00":"",a[0]===A)return j(P.Kb("{0}#,##0{1};[Red]({0}#,##0{1})",A,D));if(N(a,"E",!0))return j("0.00E+00");if(""+a[0]===R||""+a[a.length-1]===R)return j(P.Kb("0{0}%",D));if(N(a,k))return j(P.Kb("#,##0{0}",D))}return j("General")},e.prototype.format=function(t,e){var n,o,r,a,s;if(b(t,"boolean"))return F()&&(t=t?F().boolean_true:F().boolean_false),(""+t).toUpperCase();if(o=0,r=this.Ud(t)){a=r.colorFormatPart,e&&a&&(e.conditionalForeColor=e.value=a.foreColor),(n=i.j.Na(t,this.cultureName))&&(o=i.j.Pa(t)),s=P.Dc;try{n&&r===this.getFormatter(y.Va)?s=r.format(r.considerNegSymbol?o:d(o)):(s=r.value)===p&&(s=r.format(t)),e&&(e.content=w(s)?s:[{type:"text",value:s}]),w(s)&&(s=T.Jja(s))}catch(e){b(t,"string")&&(s=""+t)}return s}return n&&o<0?"-":b(t,"string")?""+t:t===p||t===h?P.Dc:""+t},e.prototype.parse=function(t){var e=this;return e.formatters&&e.formatters.length>0?e.formatters[0].parse(t):h},e.prototype.init=function(){var t,e,n,o=this,r=o.formatCached;for(P.Ec(r)&&j(),o.formatters=[],t=r.split(";"),o.Sd=1===t.length,(!t||t.length<1||t.length>4)&&j(),e=0;e<t.length;e++)n=new Z(t[e],o.cultureName),o.formatters.push(n);o.getFormatter(y.Hc)||j()},e.prototype.Ud=function(t){var e,n,o,r,a,s,l,u=this,c=u.getFormatter(y.Hc),f=c&&c.conditionalFormatPart,p=u.getFormatter(y._text);if("string"==typeof t&&k(t))return p||(f?t:c);if(i.j.Na(t,u.cultureName)||b(t,"boolean")){if(e=u.getFormatter(y.Va),n=u.getFormatter(y.Ua),o=i.j.Pa(t),r=f&&c.conditionalFormatPart.isMeetCondition(o),s=(a=e&&e.conditionalFormatPart)&&e.conditionalFormatPart.isMeetCondition(o),l=void 0,u.Sd||(f?r:o>0||0===o&&!n))l=c;else if(a?s:o<0)l=e;else if(n)l=n;else if(e){if(f&&a)return{value:o+""};l=e}return l&&(!f||a||l!==e||n||(l.considerNegSymbol=!0),f&&a&&l===e&&e.conditionalFormatPart&&e.conditionalFormatPart.isMeetCondition(1e-10)&&(l.considerNegSymbol=!0)),l}return h},e.prototype.Td=function(t){var e,n,o=this;if(o.PropertyChanged)for(e=0;e<o.PropertyChanged.length;e++)"function"==typeof(n=o.PropertyChanged[e])&&n(o,t)},e.defFormatter=function(t){var n=e[t];return n||(n=new e(t),e[t]=n),n},e}(B),e.GeneralFormatter=Q},"./src/plugins/slicer/slicer.entry.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n("./src/plugins/slicer/slicer.ts"))},"./src/plugins/slicer/slicer.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f;function h(t){return t&&t.text!==r}function p(t,e){var n,o,u;if(t===i||t===r)return!1;if(w(t)===a)e.value=t;else if(w(t)===l)e.value=t?1:0;else if(t instanceof Date)e.value=c.Ra(t);else{if(w(t)!==s)return!1;if(0===T(t=t.trim()))return!1;if(n=!1,"%"===t.charAt(T(t)-1)&&(n=!0,t=t.substr(0,T(t)-1)),T(t)>=2&&"0"===t[0]&&"x"===t[1])return!1;if(o=(+t).valueOf(),isNaN(o)||!isFinite(o)){if(u=new Date(t),isNaN(u))return!1;o=c.Ra(u)}n&&(o/=100),e.value=o}return!0}function d(t){var e,n,o,r,i,a,s,l,u,c,f,h,p,d=t.Ce;for(d||(t.Ee=[],t.Ie=[]),e=d?t.De:t.Ee,n=t.Fe,o=t.Ge,r=d?t.He:t.Ie,i=t.Je,a=t.Ke,s=t.Le,l=T(t.data),c=0;c<l;c++){for(f=!1,h=void 0,p=0;p<T(i)&&(h=i[p],d&&h===t.Me||(o[h]?(u=t.getExclusiveRowIndex(t.columnNames[h],c),f=!o[h][u]):n[h]&&(f=!n[h][c]),!f));p++);!f&&d&&(a?f=!a[u=t.getExclusiveRowIndex(t.columnNames[h],c)]:s&&(f=!s[c])),f||(e[c]=!0)}for(p=0;p<T(e);p++)e[p]&&r.push(p)}function g(t){return"string"==typeof t?t.toLowerCase():t instanceof Date?c.Ra(t):t}function m(t,e){var n,o,r,i,a,s,l,u=t.Oe,c=t.Pe,f=t.Se,p=t.Qe,d=t.Re,m=t.data,y=d[e]=[];for(t._e=[],u[e]=[],c[e]=[],f[e]={},p[e]=[],n={},o=0;o<T(m);o++)i=h(r=m[o][e])?r.text.trim():r,u[e].push(i),(a=n[g(i)])?(a.list.push(o),y[o]=a.index):(s=[o],c[e].push(i),p[e].push(s),l=T(p[e])-1,f[e][i]=l,y[o]=l,n[g(i)]={list:s,index:l})}function y(t,e,n){var o,r,i,a,s,l,u,c,f,p,d,g,m=t.Te,y=t.getColumnIndex(e),v=[];if(!y)return v;if(o=t.Ce?t.Ue:t.Ve[y],r=t.Ee,!o)return v;for(m[y]||t.We(y),i=[],a=m[y],s=0;s<T(a);s++)u=h(l=t.data[s][y])?l.value:l,i[a[s]]=u;for(c=t.af[y],s=0;s<T(o);s++){for(f=o[s],p=!1,g=(d=t.Xe(i,f)).start;g<=d.end;g++)if(r[c[g]]){p=!0;break}p!==n&&v.push(f)}return v}function v(t,e){var n,o,r,i,a,s,l,u=[],c={},f=t.getColumnIndex(e);if(f>=0)for(n=t.Ke||t.Le,o=t.Ge[f]||t.Fe[f],r=t.Ce&&f===t.Me?n:o,a=T((i=!!t.Fe[f])?t.getData(e):t.getExclusiveData(e)),s=0;s<a;s++)r&&!r[s]&&(c[l=i?t.getExclusiveRowIndex(e,s):s]||(c[l]=!0,u.push(l)));return u}function C(t,e){t.Ce=!1,t.Ke=[],t.He=[],t.De=[],t.Le=[],e&&t.onFiltered()}function b(t){return t===i||t===r}function w(t){return typeof t}function T(t){return t?t.length:0}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/datetimehelper.ts"),r=void 0,i=null,a="number",s="string",l="boolean",u=o.l.Ra,function(t){t[t.all=0]="all",t[t.byCurrentColumn=1]="byCurrentColumn",t[t.byOtherColumns=2]="byOtherColumns"}(e.FilteredOutDataType||(e.FilteredOutDataType={})),function(t){t[t.average=1]="average",t[t.count=2]="count",t[t.counta=3]="counta",t[t.max=4]="max",t[t.min=5]="min",t[t.product=6]="product",t[t.stdev=7]="stdev",t[t.stdevp=8]="stdevp",t[t.sum=9]="sum",t[t.vars=10]="vars",t[t.varp=11]="varp"}(e.SlicerAggregateType||(e.SlicerAggregateType={})),c=function(){function t(){}return t.Ra=function(t){return u(t)},t.quickSort=function(e){var n,o=T(e),r=[];for(n=0;n<o;n++)r[n]={index:n,value:e[n]};return t.quickSortImp(r)},t.quickSortImp=function(e){var n,o,r,i,a,s,l;if(T(e)<=1)return e;for(n=t,o=e[Math.floor(T(e)/2)],r=[],i=[],a=[],s=0;s<T(e);s++)(l=n.sortCompare(e[s].value,o.value))<0?r.push(e[s]):l>0?i.push(e[s]):a.push(e[s]);return n.quickSortImp(r).concat(a,n.quickSortImp(i))},t.isEquals=function(t,e){return!(!b(t)&&""!==t||!b(e)&&""!==e)||(t instanceof Date&&e instanceof Date?t.valueOf()===e.valueOf():w(t)===s&&w(e)===s?t.toLowerCase()===e.toLowerCase():t===e)},t.isGreaterThan=function(e,n){var o=w(e),r=w(n);return o===l?e=e?1:0:e instanceof Date&&(e=t.Ra(e)),r===l?n=n?1:0:n instanceof Date&&(n=t.Ra(n)),o===r||o!==a&&r!==a?o===s&&r===s?e.toLowerCase()>n.toLowerCase():e>n:w(n)===a},t.sortCompare=function(e,n){var o=t,r=b(e)||""===e||w(e)===a&&isNaN(e),i=b(n)||""===n||w(n)===a&&isNaN(n);return r&&i?0:r?1:i?-1:o.isEquals(e,n)?0:o.isGreaterThan(e,n)?1:-1},t}(),e.jf=c,f=function(){function t(t,e){var n,o=this;for(o.Ne={},o.Oe=[],o.Pe=[],o.Se=[],o.Qe=[],o.Re=[],o.Ge=[],o.Ye=[],o.Fe=[],o.Ve=[],o.Ee=[],o.Ie=[],o.Je=[],o.He=[],o.De=[],o.Ce=!1,o.Ze=[],o.$e=0,o._e=[],o.af=[],o.Te=[],o.bf(t,e),n=0;n<T(o.data);n++)o.Ee[n]=!0,o.Ie.push(n)}return t.prototype.inPreview=function(){return this.Ce},t.prototype.bf=function(t,e){var n=this;n.data=t,n.columnNames=e,function(t){var e,n,o=t.Ne={};for(t.Oe=[],t.Pe=[],t.Qe=[],t.Re=[],e=t.columnNames,n=0;n<T(e);n++)o[(e[n]+"").toUpperCase()]=n}(n)},t.prototype.onDataChanged=function(t){var e,n,o,r,i,a,s,l,u,c,f=this,p=Array(T(f.columnNames)),g=f.Ye,y=f.Pe,v=f.Ge,C=f.Oe;for(e=0;e<T(t);e++)o=(n=t[e]).data,r=n.row,i=f.getColumnIndex(n.columnName),f.data[r][i]=o,a=h(o)?o.text:o,C[i]&&(C[i][r]=a),p[i]=!0;for(s=0;s<T(p);s++)if(p[s]){for(l=g[s],g[s]=l?[]:void 0,v[s]=l?[]:void 0,u=[],e=0;l&&e<T(l);e++)u.push(y[s][l[e]]);for(m(f,s),e=0;e<T(u);e++)c=f.Se[s][u[e]],g[s].push(c),v[s][c]=!0}d(f),f.cf("onDataChanged",t)},t.prototype.cf=function(t){var e,n,o,r,i=[];for(e=1;e<arguments.length;e++)i[e-1]=arguments[e];for(n=this.Ze||[],o=0;o<T(n);o++)(r=n[o])[t]&&r[t].apply(r,i)},t.prototype.onColumnNameChanged=function(t,e){var n=this,o=n.Ne,r=n.getColumnIndex(t);r<0||(n.columnNames[r]=e,delete o[t.toUpperCase()],o[e.toUpperCase()]=r,n.cf("onColumnNameChanged",t,e))},t.prototype.onRowsAdded=function(t,e,n){var o,a,s,l,u,f,h,p,d,g,m,y,v,C=this,b=T(C.columnNames),w=C.data,x=C.Oe,S=C.Pe,A=C.Qe,I=C.Re,R=C.Ge,k=C.Ye,M=C.Ee,N=C.Ie,E=C.Je;for(C._e=[],o=0;o<e;o++)w.splice(t,0,Array(b));for(a=0;a<b;a++){for(o=0;o<e;o++)x[a]&&x[a].splice(t,0,r);if(u=void 0,l=S[a]){for(f=i,h=0;h<T(l);h++){for(p=A[a][h],d=0;d<T(p);d++)p[d]>=t&&(p[d]+=e);c.isEquals(l[h],i)&&(f=p,u=h)}for(f||(f=[],l.push(i),u=T(l)-1,C.Se[a][i]=u,A[a].push(f),R[a]&&-1===E.indexOf(a)&&(R[a][u]=!0,k[a].push(u))),g=t;g<t+e;g++)f.push(g);for(s=t;s<t+e;s++)I[a].splice(s,0,u)}}for(m=!0,o=0;o<T(E);o++)y=I[a=E[o]][t],!0!==R[a][y]&&(m=!1);for(o=0;o<T(N);o++)N[o]>=t&&(N[o]+=e);for(s=T(w)-1;s>=t+e;s--)M[s]=M[s-e];for(v=T(E)>0,s=t;s<t+e;s++)m&&N.push(s),M[s]=!v;n||C.cf("onRowsChanged",t,e,!0)},t.prototype.onRowsRemoved=function(t,e){this.df(t,e,!0)},t.prototype.df=function(t,e,n){var o,r,i,a,s,l,u,c,f=this,h=f.Ye,p=f.Pe,g=f.Ge,y=f.data,v=T(f.columnNames),C=f.Oe;for(y.splice(t,e),r=0;r<v;r++){if(C[r]&&C[r].splice(t,e),a=[],(i=h[r])&&n){for(o=0;o<T(i);o++){for(s=f.getRowIndexes(f.columnNames[r],i[o]),l=!0,u=0;u<T(s);u++)if(s[u]<t||s[u]>=t+e){l=!1;break}l||a.push(p[r][i[o]])}h[r]=[],g[r]=[]}if(m(f,r),i&&n)for(o=0;o<T(a);o++)c=f.Se[r][a[o]],h[r].push(c),g[r][c]=!0}n&&d(f),f.cf("onRowsChanged",t,e,!1)},t.prototype.onColumnsRemoved=function(t,e){var n,o,r,i,a,s,l,u,c=this,f=c.data,h=[],p=c.Je,d=t+e;for(n=t;n<d;n++)o=c.columnNames[n],r=n,h.push(o),-1!==p.indexOf(r)&&c.doUnfilter(o);for(i=c.Ge||c.Fe,a=c.Ye||c.Ve,s=c.Ne,n=0;n<T(f);n++)f[n].splice(t,e);for(l in c._e=[],c.columnNames.splice(t,e),c.Oe.splice(t,e),c.Pe.splice(t,e),c.Se.splice(t,e),c.Qe.splice(t,e),c.Re.splice(t,e),i.splice(t,e),a.splice(t,e),s)s[l]>=t+e&&(s[l]-=e);for(n=0;n<T(h);n++)delete s[(o=h[n]).toUpperCase()],t=c.getColumnIndex(o),-1!==(u=p.indexOf(t))&&p.splice(u,1),c.cf("onColumnRemoved",h[n])},t.prototype.ef=function(){return this._e},t.prototype.ff=function(){return this.af},t.prototype.We=function(t){var e,n,o,r,i,a,s,l,u,f,p,d=this,g=d.data;for(d.Oe[t]||m(d,t),e=T(g),n=[],o=0;o<e;o++)i=h(r=g[o][t])?r.value:r,n.push(i);for(a=c.quickSort(n),s=d._e[t]=[],l=d.af[t]=[],u=d.Te[t]=[],f=0;f<T(a);f++)p=a[f],s.push(p.value),l.push(p.index),u[p.index]=f},t.prototype.getColumnIndex=function(t){var e=this.Ne[t.toUpperCase()];return void 0===e?-1:e},t.prototype.getFilteredRowIndexes=function(){var t=this;return t.Ce?t.He:t.Ie},t.prototype.getFilteredOutRowIndexes=function(){var t,e=this,n=T(e.data),o=e.Ce?e.De:e.Ee,r=[];for(t=0;t<n;t++)o[t]||r.push(t);return r},t.prototype.getData=function(t,e){var n,o,r,i,a,s,l,u=this,c=u.Oe,f=u.getColumnIndex(t);if(f>=0){if(e){for(u._e[f]||u.We(f),n=c[f],o=u._e[f],i=(r=u.Xe(o,e)).start,a=r.end,s=[],l=i;l<=a;l++)s.push(n[u.af[f][l]]);return s}return c[f]||m(u,f),c[f]}return[]},t.prototype.aggregateData=function(t,e,n){var o,i,a,s,l,u,c,f,h,p=this,d=p.getColumnIndex(t);return d<0?r:(p._e[d]||p.We(d),s=T(a=p._e[d]),o=(l=p.Xe(a,n)).start,i=l.end,5===e?o>=s?r:a[o]:4===e?i<0?r:a[i]:3===e?i<o?0:i-o+1:(c=(u=p.Qka(a,e,o,i)).data1,f=u.data2,h=u.data3,1===e?c/=f:7===e||10===e?(c=(h*f-c*c)/(h*(h-1)),c=7===e?Math.sqrt(c):c):8!==e&&11!==e||(c=(h*f-c*c)/(h*h),c=8===e?Math.sqrt(c):c),c))},t.prototype.Qka=function(t,e,n,o){var a,s,l,u=6===e?1:0,c=0,f=0;for(a=n;a<=o;a++)(s=t[a])===i&&s===r||p(s,l={value:i})&&(s=l.value,1===e?(u+=s,c++):2===e?u++:9===e?u+=s:6===e?u*=s:7!==e&&8!==e&&10!==e&&11!==e||(u+=s,c+=s*s,f++));return{data1:u,data2:c,data3:f}},t.prototype.Xe=function(t,e){var n,o,i,a,s=T(t);if(e){if(e.min===-1/0)n=0;else for(i=0;i<s;i++)if(a=t[i],c.isEquals(e.min,a)||c.isGreaterThan(a,e.min)){n=i;break}if(n===r&&(n=s),o===1/0)o=s-1;else{for(i=s-1;i>=0;i--)if(a=t[i],c.isEquals(a,e.max)||c.isGreaterThan(e.max,a)){o=i;break}o===r&&(o=-1)}}else n=0,o=s-1;return{start:n,end:o}},t.prototype.getExclusiveData=function(t){var e=this,n=e.Pe,o=e.getColumnIndex(t);return o>=0?(n[o]||m(e,o),n[o]):[]},t.prototype.getRowIndexes=function(t,e){var n=this,o=n.getColumnIndex(t);return o>=0?(n.Re[o]||m(n,o),n.Qe[o][e]):[]},t.prototype.getExclusiveRowIndex=function(t,e){var n=this,o=n.Re,r=n.getColumnIndex(t);return r>=0?(o[r]||m(n,r),o[r][e]):-1},t.prototype.getFilteredIndexes=function(t){var e=[];return this.gf(t,e,{}),e},t.prototype.gf=function(t,e,n){var o,r,i,a=this,s=a.Ce?a.He:a.Ie;for(o=0;o<T(s);o++)r=s[o],n[i=a.getExclusiveRowIndex(t,r)]?n[i]++:(n[i]=1,e.push(i))},t.prototype.getFilteredRanges=function(t){return y(this,t,!1)},t.prototype.getFilteredOutRanges=function(t){return y(this,t,!0)},t.prototype.getFilteredOutIndexes=function(t,e){var n=this;return 0===e?function(t,e){var n,o,r,i,a=[];if(t.getColumnIndex(e)>=0){for(n=T(t.getData(e)),o=t.Ce?t.De:t.Ee,r=0;r<n;r++)o[r]||(i=t.getExclusiveRowIndex(e,r),-1===a.indexOf(i)&&a.push(i));return a}}(n,t):1===e?v(n,t):function(t,e){var n,o,r,i,a,s,l,u,c,f,h={},p=t.columnNames;for(n=0,o=T(p);n<o;n++)if(p[n]!==e)for(r=v(t,p[n]),i=0;i<T(r);i++)for(a=t.getRowIndexes(p[n],r[i]),s=0;s<T(a);s++)h[a[s]]||(h[a[s]]=!0);for(l={},n=0,o=T(t.data);n<o;n++)u=t.getExclusiveRowIndex(e,n),h[n]||(l[u]=!0);for(c=T(t.getExclusiveData(e)),f=[],n=0;n<c;n++)l[n]||f.push(n);return f}(n,t)},t.prototype.attachListener=function(t){this.Ze.push(t)},t.prototype.detachListener=function(t){var e,n=this.Ze||[];for(e=0;e<T(n);e++)if(n[e]===t){n.splice(e,1);break}},t.prototype.suspendFilteredEvents=function(){this.$e++},t.prototype.resumeFilteredEvents=function(){var t=this;t.$e--,0===t.$e&&t.onFiltered()},t.prototype.doFilter=function(t,e,n){this.hf(t,e,n),this.onFiltered()},t.prototype.hf=function(t,e,n){var o=this,r=o.Je,i=o.getColumnIndex(t);i<0||(n?(o.Ce=!0,o.Me=i):o.Ce&&C(o,!1),r.indexOf(i)<0&&r.push(i),e.ranges?function(t,e,n,o){var r,i,a,s,l,u,c,f,p=t.getColumnIndex(e),g=t.Te;for(g[p]||t.We(p),r=[],i=g[p],a=0;a<T(i);a++)l=h(s=t.data[a][p])?s.value:s,r[i[a]]=l;for(u=[],a=0;a<T(n);a++)for(c=t.Xe(r,n[a]),f=0;f<T(i);f++)i[f]>=c.start&&i[f]<=c.end&&(u[f]=!0);o?(t.Le=u,t.Ue=n):(t.Ve[p]=n,t.Fe[p]=u,delete t.Ge[p],delete t.Ye[p]),d(t)}(o,t,e.ranges,n):function(t,e,n,o){var r,i=t.getColumnIndex(e),a=[];for(r=0;r<T(n);r++)a[n[r]]=!0;o?t.Ke=a:(t.Ge[i]=a,t.Ye[i]=n,delete t.Ve[i],delete t.Fe[i]),d(t)}(o,t,e.exclusiveRowIndexes,n))},t.prototype.clearPreview=function(){C(this,!0)},t.prototype.doUnfilter=function(t){this.if(t),this.onFiltered()},t.prototype.if=function(t){var e,n,o=this;o.Ce&&C(o,!1),(e=o.getColumnIndex(t))<0||(delete o.Ve[e],delete o.Fe[e],delete o.Ge[e],delete o.Ye[e],d(o),(n=o.Je.indexOf(e))>=0&&o.Je.splice(n,1))},t.prototype.onFiltered=function(){var t=this;0===t.$e&&t.cf("onFiltered",{rowIndexes:t.getFilteredRowIndexes(),isPreview:t.Ce})},t.prototype.getListener=function(){return this.Ze},t}(),e.GeneralSlicerData=f},"./src/plugins/sparkline/sparkline.entry.ts":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}(n("./src/plugins/sparkline/sparkline.ts"))},"./src/plugins/sparkline/sparkline.ts":function(t,e,n){"use strict";var o,r,i,a,s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M,N,E,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt=this&&this.__extends||function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(e,n)};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();function et(t,e){return{x:t,y:e}}function nt(t,e,n,o){return{x:t,y:e,width:n,height:o}}function ot(t,e){var n,o,r,i=t[0],a=i&&i.value?i.value:i;for(o=1,r=t.length;o<r;o++)n=(i=t[o])&&i.value?i.value:i,(e&&a>n||!e&&a<n)&&(a=n);return a}function rt(t,e,n,o,r,i,a){i&&(t.strokeStyle=i),a&&(t.lineWidth=a),t.beginPath(),t.moveTo(e,n),t.lineTo(o,r),t.stroke()}function it(t,e,n,o,r,i,a,s,l,u,c,f){e?rt(t,n,o,r,i,c,f):rt(t,a,s,l,u,c,f)}function at(t){return r.pc.dc(l(t))<127.5?O:j}function st(t,e,n,o,r,i,s,l){var u,c,f,h,p=l;return a(l)&&(p=r),s?(u=e+p+i,f=o-2*p,c=t+r,h=n-2*r):(u=t+p,f=n-2*p,c=e+r,h=o-2*r),{left:u,top:c,width:f,height:h}}function lt(t,e){var n,o,r=0;for(n=0,o=t.length;n<o;n++)r+=e&&!e(t[n])?0:t[n];return r}function ut(t,e,n,o){var r,i,a,s,l=[];for(i=0,a=0,s=t.length;i<s;i++)e?e(t[i])?l[a++]=n?n(t[i]):t[i]:l[a++]=0:(r=I(t[i]),!A(r)&&isFinite(r)&&(l[a++]=r));return o&&o(l),l}function ct(t,e,n,o,r,i){var a=v(e+o),s=v(n+r);e=v(e),n=v(n),o=v(a-e),r=v(s-n),t.beginPath(),t.fillStyle=i,t.fillRect(e,n,o,r),t.fill()}function ft(t,e,n){return t=m(t,e),y(t,n)}function ht(t,e,n,o,r){t.save(),t.rect(e,n,o,r),t.clip()}function pt(t,e){var n,o,i,a,s,u,c=[],f=e.length;if(t<=f)c=e.slice(0,t);else{for(0===f?(c.push("darkgray"),f=1):c=e.slice(0),n=[],o=void 0,i=t-f+1,a=void 0,a=0;a<f;a++)n[a]=l(c[a]);for(a=f;a<t;a++){for(s in o=n[a%f])o.hasOwnProperty(s)&&(u=o[s],o[s]=h(u-u/i*(a/f)));o.a=255,c[a]=r.pc.bc(o)}}return c}function dt(t,e,n){return{x:t,y:e,value:n}}function gt(t,e,n,o,r){return((e-r)*n+(r-o)*t)/(e-o)}function mt(t,e){var n,o,r=e?1:-1,i=e?m:y,a=new W(et(r*R,r*R)),s=t.length;for(o=0;o<s;o++)n=t[o],a.x=i(a.x,n.x),a.y=i(a.y,n.y);return a}function yt(t,e,n,o){return n/o*(e-t)+t}function vt(t,e,n,o,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,w,T;if(a){for(s=b(C(o-e,2)+C(r-n,2)),l=0,6,2,4,c=void 0,f=void 0,h=void 0,p=void 0,e<=o?(c=e,f=o,h=e,p=n):(c=o,f=e,h=o,p=r),g=n-(d=(r-n)/(o-e))*e,(u=[]).push(new W(et(h,p))),m=[6,4,2,4];l<s;)for(y=0,v=m.length;y<v;y++)(l+=m[y])<=s&&(p=d*(h=yt(c,f,l,s))+g,u.push(new W(et(h,p))));for(w=0,T=u.length;w<T-1;w+=2)rt(t,u[w].x,u[w].y,u[w+1].x,u[w+1].y,i)}else rt(t,e,n,o,r,i)}function Ct(t){var e,n,o,r=[],i=t.length;if(i>0)if(i<(e=t[0].length)){if(i>=2)for(n=0;n<e;n++)r.push(new W(et(t[0][n],t[1][n])))}else if(e>=2)for(o=0;o<i;o++)r.push(new W(et(t[o][0],t[o][1])));return r}function bt(t,e,n,o){for(var r,i=[],a=y(100,10*t),s=0,l=[],u=0;i.length<t;)r=h(o[u++]*e),(s>a||wt(r,l))&&(i.push(r),l.push([r-n,r+n])),s++;return i}function wt(t,e){var n,o,r;for(n=0,o=e.length;n<o;n++)if((r=e[n])[0]<=t&&t<=r[1])return!1;return!0}function Tt(t,e,n,o,r,i){rt(t,At(e),At(n),At(o),At(r),a(i)?j:i,1)}function xt(t,e,n,o,r){var i,a,s,l,u,c=.4*o;switch(e=At(e),n=At(n),t.beginPath(),t.moveTo(e,n),i=c/2,a=b(3)*c/2,s=c/b(3),r){case 0:l=[-i,0,i],u=[a,s,a];break;case 2:l=[-i,0,i],u=[-a,-s,-a];break;case 3:l=[a,s,a],u=[-i,0,i];break;case 1:l=[-a,-s,-a],u=[-i,0,i];break;default:l=[],u=[]}l.forEach((function(o,r){t.lineTo(At(e+o),At(n+u[r]))})),t.lineTo(e,n),t.closePath(),t.fillStyle=O,t.fill()}function St(t,e,n,o,r,i,s){var l,u,c,f,h,p,d,g,m,y,v,C,b,T,x=n.value,S=n.colorScheme,R=n.axisVisible,k=n.barHeight,M=n.barWidth,N=!1,E=I(x);if(!A(E)){if(a(d=0===t?k:M))g=.7;else{if(A(d)||d<=0)return;g=Math.min(1,d)}E>1?(E=1,N=!0):E<-1&&(E=-1,N=!0),S=a(S)?"grey":S,R=!!a(R)||R,e.save(),0===t?(m=i-10,y=s*g,E>=0?(N&&(l=new W(et(o+5+m-5,r+s/2))),u=new U(nt(o+5,r+s*(1-g)/2,m*E,y)),c=new W(et(o+5,r+1)),f=new W(et(o+5,r+s)),h=1):(v=w(m*E),N&&(l=new W(et(o+5+5,r+s/2))),u=new U(nt(o+i-5-v,r+s*(1-g)/2,v,y)),c=new W(et(o+i-5,r+1)),f=new W(et(o+i-5,r+s)),h=3),p=a(d)?s:s*g):1===t&&(C=s-10,b=i*g,E>=0?(u=new U(nt(o+(1-g)/2*i,r+s-5-(T=C*E),b,T)),N&&(l=new W(et(o+i/2,r+s-5-T+5)),h=0),c=new W(et(o+1,r+s-5)),f=new W(et(o+i,r+s-5))):(E=w(E),u=new U(nt(o+(1-g)/2*i,r+5,b,C*E)),N&&(l=new W(et(o+i/2,r+5+C-5)),h=2),c=new W(et(o+1,r+5)),f=new W(et(o+i,r+5))),p=a(d)?i:i*g),e.beginPath(),u&&(ct(e,u.x,u.y,u.width,u.height,S),ht(e,u.x,u.y,u.width,u.height)),l&&xt(e,l.x,l.y,p,h),e.restore(),R&&c&&Tt(e,c.x,c.y,f.x,f.y),e.restore()}}function At(t){return v(t)-.5}function It(t,e,n,o,r){e=v(e),n=v(n),e===(o=v(o))&&(e=o-=.5),n===(r=v(r))&&(n=r-=.5),t.moveTo(e,n),t.lineTo(o,r)}function Rt(t,e,n,o,r,i,a,s,l,u,c){t.beginPath(),t.strokeStyle=n,e?It(t,o,r,i,a):It(t,s,l,u,c),t.stroke()}function kt(t,e,n,o,r){t.rect(e,n,o,r),t.clip()}function Mt(t,e,n,o,r,i){var s,l,u,c,f,h=i.labelText,p=i.fontSize,d=i.startBox,g=i.endBox,m=i.boxColor,y=i.isInRightOrTopOfBox,v=i.fillStyle;t.save(),t.beginPath(),t.font=p+z,v=a(v)?j:v,i.vertical?(u=B,y?p+g-(d-n)>0&&d-g-n<g?(c=G,v=at(m),l=d-g+1,kt(t,e,d-g,o,g)):(c=H,l=d-g-1):p-(n+r-d)>0&&n+r-d<g?(kt(t,e,d-g,o,g),c=H,v=at(m),l=d-1):(c=G,l=d+1),t.textAlign=u,t.textBaseline=c,t.fillStyle=v,t.fillText(h,e+o/2,l)):(c=V,f=t.measureText(h),y?f.width+g-(e+o-d)>0&&e+o-(d+g)<g?(kt(t,d,n,g,r),u=L,v=at(m),s=d+g-1):(u=_,s=d+g+1):f.width-(d-e)>0&&d-e<g?(kt(t,d,n,g,r),s=d+1,u=_,v=at(m)):(u=L,s=d-1),t.textAlign=u,t.textBaseline=c,t.fillStyle=v,t.fillText(h,s,n+r/2)),t.restore()}function Nt(t,e){switch(e){case 2:return t%4==0&&t%100!=0||t%400==0?29:28;case 4:case 6:case 9:case 11:return 30;default:return 31}}function Et(t,e,n){var o,r,i,a,s,u;return t<0&&(t=0),t>1&&(t=1),o=l(e),r=l(n),i=o.a*(1-t)+r.a*t,a=o.r*(1-t)+r.r*t+"",s=o.g*(1-t)+r.g*t+"",u=o.b*(1-t)+r.b*t+"","rgba("+parseInt(a,10)+","+parseInt(s,10)+","+parseInt(u,10)+","+I(i/255+"")+")"}function Dt(t,e,n){return t===e&&t===n?1:t<=e?0:t>=n?1:(t-e)/(n-e)}function Ot(t,e,n,o,r,i,a){var s,l,u;o?t.forEach((function(t,r){0!==t&&t!==c&&t!==f&&(e[n+r]=o[r]||e[n+r])})):(s=function(t){var e=R,n=-R;return t.forEach((function(t){t!==c&&t!==f&&(e>t&&(e=t),n<t&&(n=t))})),{min:e,max:n}}(t),l=s.min,u=s.max,t.forEach((function(t,o){0!==t&&t!==c&&t!==f&&(e[n+o]=function(t,e,n,o,r,i){var a=(i+r)/2;return r<=o&&o<=a?Et(Dt(o,r,a),t,e):Et(Dt(o,a,i),e,n)}(r,i,a,t,l,u))})))}function jt(t){var e,n=t.getFullYear(),o=t.getMonth(),r=t.getDate();for(e=1;e<o+1;e++)r+=Nt(n,e);return r}Object.defineProperty(e,"__esModule",{value:!0}),o=n("./src/common/util/types.ts"),r=n("./src/common/util/colorhelper.ts"),i=n("./src/common/util/arrayhelper.ts"),a=o.j.Fa,s=r.pc.nc,l=r.pc.ec,u=i.k.Cb,e.Vd={},c=null,f=void 0,h=Math.floor,p=Math.PI,d=Math.sin,g=Math.cos,m=Math.min,y=Math.max,v=Math.round,C=Math.pow,b=Math.sqrt,w=Math.abs,T=Math.ceil,x="undefined",S="string",A=isNaN,I=parseFloat,R=Number.MAX_VALUE,k=new Date(""),M="#969696",N="#CB0000",E="#646464",D="#DCDCDC",O="white",j="black",F="blue",P="green",_="left",L="right",B="center",G="top",H="bottom",V="middle",z="px Arial",U=function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},q=function(t){function e(e){var n=t.call(this,et(e.x,e.y))||this;return n.value=e.value,n}return tt(e,t),e}(W=function(t){this.x=t.x,this.y=t.y}),Y="7ns",X="5ns",Z="tukey",Q="bowley",J="sigma3",$=function(t,e,n,o){this.X=t,this.Y=e,this.Width=n,this.Height=o,this.Left=this.X,this.Right=this.Left+this.Width,this.Top=this.Y,this.Bottom=this.Y+this.Height},K=function(){function t(){this.Wd=2,this.Xd=k,this.Yd=k,this.Zd=R,this.$d=-R}return t.prototype.paint=function(t,e,n,o,r,i){var a,s,l,u=this;u.options=e,u.setting=e.settings,a=e.values,s=e.dateValues,l=e.zoomFactor,t.save(),t.rect(n,o,r,i),t.clip(),t.beginPath(),0===e.sparklineType&&u._d(t,n,o,r,i,a,s,l),u.ae(t,n,o,r,i,a,s,l),u.be(t,n,o,r,i,a,s,l),t.restore()},t.prototype.ce=function(t){return 0===this.options.sparklineType?3+this.de(t)+1:3},t.prototype.ee=function(t,n){var o,r,a,s,l,h,p,d,g,y=this.fe;if(y)return y;if(y=this.fe=[],o=t.length,this.options.displayDateAxis){for(s=n.length,h=[],(l=m(o,s))>0&&(h=n.slice(0,l)),h.sort((function(t,n){return t===n?0:(t===e.Vd&&(t=0),n===e.Vd&&(n=0),t-n)})),p=h.length,d=void 0,g=void 0,r=0;r<p;r++)if(typeof(d=h[r])!==x&&d!==c){for(g=u(n,d);i.k.Bb(y,g);)g=u(n,d,g+1);isNaN(d)||((a=t[g])!==f&&a!==c&&isNaN(a)&&a!==e.Vd||y.push(g))}}else for(r=0;r<o;r++)typeof(a=t[r])!==x&&a!==c&&isNaN(a)&&a!==e.Vd||y.push(r);return y},t.prototype.ge=function(t,n){var o=n[t];return typeof o===x||o===c?1===this.setting.options.displayEmptyCellsAs&&(o=0):o===e.Vd&&(o=0),o},t.prototype._d=function(t,e,n,o,r,i,a,s){var l,u,f,h,p,d,g,m,y,v,C,b,w,T,S,A=this,I=A.ee(i,a),R=I.length-1;for(R<0&&(R=0),h=A.setting.options,p=A.linePos=[],C=h.displayEmptyCellsAs,l=0;l<R;l++)if(typeof(d=A.ge(I[l],i))!==x&&d!==c){if(m=l+1,typeof(g=A.ge(I[m],i))===x||g===c)if(1===C)g=0;else if(2===C)for(m=l+2;m<=R;m++)if(typeof(b=i[I[m]])!==x&&b!==c){g=b;break}typeof g!==x&&g!==c?(y=A.he(I[l],{Width:o,Height:r},i,a,s),v=A.he(I[m],{Width:o,Height:r},i,a,s),w=y.Width/2,u={X:y.X+w,Y:y.Y+w},f={X:v.X+w,Y:v.Y+w},p[l]={P1:u,P2:f}):l++}if((T=p.length)>0)for(t.strokeStyle=A.options.getColor(h.seriesColor),t.lineCap="round",t.lineWidth=A.de(s),l=0;l<T;l++)(S=p[l])&&(t.beginPath(),u=S.P1,f=S.P2,t.moveTo(e+u.X,n+u.Y),t.lineTo(e+f.X,n+f.Y),t.stroke(),t.closePath())},t.prototype.ie=function(t,e,n){var o,r=this,i=r.options,a=r.setting.options,s=c,l=r.ge(t,e),h=r.ee(e,n),p=h.length,d=i.getColor.bind(r);return typeof l!==x&&l!==c&&(r.Zd!==R&&r.$d!==-R||r.je(e),l===r.Zd&&a.showLow&&(s=d(a.lowMarkerColor)),l!==r.$d||!a.showHigh||typeof s!==x&&s!==c||(s=d(a.highMarkerColor)),typeof s!==x&&s!==c||(i.displayDateAxis?0===u(h,t)&&a.showFirst&&(s=d(a.firstMarkerColor)):0===t&&a.showFirst&&(s=d(a.firstMarkerColor))),typeof s!==x&&s!==c||(i.displayDateAxis?u(h,t)===p-1&&a.showLast&&(s=d(a.lastMarkerColor)):t===p-1&&a.showLast&&(s=d(a.lastMarkerColor))),l<0&&a.showNegative&&(typeof s===x||s===c)&&(s=d(a.negativeColor)),typeof s!==x&&s!==c||(0===(o=i.sparklineType)?a.showMarkers&&(s=d(a.markersColor)):(1===o||2===o)&&(s=d(a.seriesColor)))),s===f||s===c?"Transparent":s},t.prototype.ae=function(t,e,n,o,r,i,a,s){var l,u,c,f,d,g,m,y,v,C,b=this,w={Width:o,Height:r},T=b.ee(i,a),x=T.length,S=b.options.sparklineType;for(C=0;C<x;C++)l=T[C],u=b.ie(l,i,a),c=b.he(l,w,i,a,s),t.fillStyle!==u&&(t.fillStyle=u),0===S?(t.save(),f=e+c.X+c.Width/2,d=n+c.Y+c.Height/2,t.translate(f,d),t.rotate(45*p/180),t.fillRect(0-c.Width/2,0-c.Height/2,c.Width,c.Height),t.restore()):(g=e+c.X+c.Width/4,g=h(g),m=n+c.Y,y=c.Width/2,v=c.Height,t.fillRect(g,m,y,v))},t.prototype.be=function(t,e,n,o,r,i,a,s){var l,u,c,f,p,d,g,m=this,y=m.setting&&m.setting.options;y&&y.displayXAxis&&m.ke(i,a)&&(l={Width:o,Height:r},u=m.ce(s),c=l.Width-m.ce(s),p=f=h(m.le(l,i,s))+.5,d=m.options.getColor(y.axisColor),(g=s)<1&&(g=1),t.strokeStyle!==d&&(t.strokeStyle=d),t.lineWidth!==g&&(t.lineWidth=g),t.beginPath(),t.moveTo(e+u,n+f),t.lineTo(e+c,n+p),t.stroke())},t.prototype.me=function(t){var e,n=this.ne(t);return n===-R||(e=this.oe(t))===R||n===e||n*e<=0},t.prototype.ke=function(t,e){var n,o,r,i,a=this.me(t);if(2!==this.options.sparklineType)return a;if(o=(n=this.ee(t,e)).length,!a&&o>0)for(i=0;i<o;i++)if(typeof(r=t[n[i]])!==x&&r!==c)return!0;return a},t.prototype.pe=function(t,e){var n=this.Xd;return isNaN(n&&n.valueOf())&&this.qe(t,e),this.Xd},t.prototype.re=function(t,e){var n=this.Yd;return isNaN(n&&n.valueOf())&&this.qe(t,e),this.Yd},t.prototype.qe=function(t,e){var n,o,r,i,a=this,s=new Date(0,0,0),l=R,u=a.ee(t,e),f=u.length;for(i=0;i<f;i++)o=e[n=u[i]],isNaN(o)||((r=a.ge(n,t))!==c&&typeof r===x||isNaN(r)||typeof o!==x&&o!==c&&(o>s&&(s=o),o<l&&(l=o)));a.Yd=s,a.Xd=l},t.prototype.se=function(t,e,n,o){var r,i,a,s,l,u,c=this,f=c.pe(e,n),h=c.re(e,n),p=[],d=c.ee(e,n),g=d.length;for(r=0;r<g;r++)(i=n[d[r]])&&!isNaN(i)&&p.push(i);if(p.sort((function(t,e){return t-e})),(a=p.length)>1&&f!==h){for(s=R,l=0,void 0,r=1;r<a;r++)(i=p[r]-p[r-1])<s&&i>0&&(s=i),l+=i;return(u=(t.Width-c.ce(o)-c.ce(o))*s/l/2)<2&&(u=2),u}return(t.Width-c.ce(o)-c.ce(o))/2},t.prototype.te=function(t,e,n,o){var r,i=this;return i.options.displayDateAxis?i.se(t,e,n,o):(r=i.ee(e,n).length,(t.Width-i.ce(o)-i.ce(o))/r)},t.prototype.ue=function(t,e,n,o,r){var i,a,s,l,c,f,p,d=this,g=d.ce(r);return d.options.displayDateAxis?(i=d.te(t,n,o,r),(a=d.re(n,o))===(s=d.pe(n,o))?g+i/2:(l=o[e])?(c=t.Width-g-d.ce(r),c-=i,f=a.valueOf()-s.valueOf(),g+h((l.valueOf()-s.valueOf())/f*c)):0):(i=d.te(t,n,o,r),p=u(d.ee(n,o),e),h(g+i*p))},t.prototype.ve=function(t,e){var n,o=this,r=t.Width-o.ce(e)-o.ce(e);return r=y(r,0),n=t.Height-o.ce(e)-o.ce(e),{Width:r,Height:n=y(n,0)}},t.prototype.je=function(t){var e,n,o=this,r=t.length;for(n=0;n<r;n++)typeof(e=t[n])!==x&&e!==c&&("number"!=typeof e&&(e=0),e<o.Zd&&(o.Zd=e),e>o.$d&&(o.$d=e))},t.prototype.ne=function(t){var e,n,o=this;return o.$d!==-R&&o.$d||o.je(t),0===(n=(e=o.setting.options).maxAxisType)?o.$d:1===n?e.groupMaxValue:2===n?e.manualMax:o.$d},t.prototype.oe=function(t){var e,n,o=this;return o.Zd!==R&&o.Zd||o.je(t),0===(n=(e=o.setting.options).minAxisType)?o.Zd:1===n?e.groupMinValue:2===n?e.manualMin:void 0},t.prototype.we=function(t,e,n,o){var r,i=this.ve(t,o),a=this.ne(n),s=this.oe(n),l=a-s;if(a===s){if(0===a)return 0;l=w(a)}return(r=n[e])||(r=0),r*(i.Height/l)},t.prototype.xe=function(t,e,n,o){var r,i,a,s=this,l=s.options.sparklineType;if(0===l)return s.we(t,e,n,o);if(1===l){if(r=n[e],1===s.setting.options.displayEmptyCellsAs&&(typeof r===x||r===c))return 0;if((i=s.we(t,e,n,o))>-s.Wd&&i<s.Wd){if(r>0)return i+s.Wd;if(r<0)return i-s.Wd}return i}return 2===l?typeof(r=n[e])===x||r===c||0===r||isNaN(r)?0:(a=s.ve(t,o),r>=0?a.Height/2:-a.Height/2):void 0},t.prototype.ye=function(t,e,n){var o,r,i=this,a=i.ve(t,n),s=i.ne(e),l=i.oe(e);if(s===-R||l===R)return t.Height/2;if(o=s-l,s===l){if(0===s)return t.Height/2;o=s,s<0&&(s=0)}return r=a.Height/o,i.ce(n)+s*r},t.prototype.le=function(t,e,n){return 2===this.options.sparklineType?t.Height/2:this.ye(t,e,n)},t.prototype.ze=function(t,e,n,o){var r,i,a=this,s=a.ve(t,o),l=a.ne(n),u=a.oe(n),f=l-u;if(l===u){if(0===l)return 0;f=l}return r=s.Height/f,typeof(i=a.ge(e,n))!==x&&i!==c||(i=0),l!==u&&l*u>0?(0,i>=0?(i-u)*r:(i-l)*r):i*r},t.prototype.Ae=function(t,e,n,o){var r,i,a,s=this,l=s.options.sparklineType;return 0===l?s.ze(t,e,n,o):1===l?(r=s.ze(t,e,n,o))>-(i=s.Wd)&&r<i&&(typeof(a=s.ge(e,n))!==x&&a!==c||(a=0),0!==a)?a>0?r+i:r-i:r:2===l?s.xe(t,e,n,o):void 0},t.prototype.Be=function(t,e,n,o,r){var i,a,s,l,u,c,f,p,d,g=this,m=g.te(e,n,o,r),v=g.ue(e,t,n,o,r);return m<0&&(m=0),(m=h(m))%2==1&&(m+=1),i=g.xe(e,t,n,r),a=g.le(e,n,r),s=g.ne(n),l=g.oe(n),u=0,s<0&&l<0?u=y(g.ce(r),a):(u=a,i>=0&&(u=a-i)),c=g.Ae(e,t,n,r),f=new $(v,u,m,w(c)),0!==i&&(p=g.ce(r),f.Y<p&&f.Bottom<p+1?f.Height=h(f.Height+1):(d=e.Height-g.ce(r),f.Bottom>d&&f.Y>d-1&&(f.Y=d-c,f.Height=c))),f},t.prototype.de=function(t){var e=this.setting.options.lineWeight*t;return e<1&&(e=1),e},t.prototype.he=function(t,e,n,o,r){var i,a,s,l,u=this,f=u.de(r);return++f<2&&(f=2),i=u.Be(t,e,n,o,r),0===u.options.sparklineType&&(i.X=i.X+(i.Width-f)/2,typeof(a=u.ge(t,n))!==x&&a!==c?(a>=0?i.Y-=f/2:i.Y=i.Bottom-f/2,i.Width=f,i.Height=f):(i.Width=0,i.Height=0)),u.setting.options.rightToLeft&&(s=i.X,l=e.Width-s-i.Width,i=new $(l,i.Y,i.Width,i.Height)),i},t}(),e.SparklineRender=K,e.SparklineExRenders={PIESPARKLINE:function(t,e,n,o,r,i){var s,l,u,c,f,h,y=n+r/2,v=o+i/2,C=m(r,i)/2-5,b=-.5*p,T=y+C*g(b),x=v+C*d(b),S=[],I=[];if(!(C<=0)){for(c=pt(u=(l=ut(e.values,(function(t){return!a(t)&&!A(t)&&isFinite(t)}),(function(t){return w(t)}),(function(t){1===t.length&&(t[1]=1-t[0])}))).length,e.colors),f=lt(l),t.save(),h=0;h<u;h++)s=b+l[h]/f*2*p,t.beginPath(),t.moveTo(y,v),t.lineTo(T,x),t.arc(y,v,C,b,s,!1),t.lineTo(y,v),t.fillStyle=c[h],t.fill(),S.push(T),I.push(x),T=y+C*g(b=s),x=v+C*d(b);for(h=0;h<u;h++)rt(t,y,v,S[h],I[h],O);t.restore()}},AREASPARKLINE:function(t,e,n,o,r,i){var s,l,u,f,h,p,d,g,C,b,w,T,S,I,R,k,M,E,D,O,j,P,_,L,B,G,H,V,z,W,U;for(t.save(),s=e.points,l=e.mini,u=e.maxi,f=e.line1,h=e.line2,p=e.colorPositive,d=e.colorNegative,5,s=ut(s,(function(t){return!a(t)&&!A(t)&&isFinite(t)})),p=a(p)?"#787878":p,d=a(d)?N:d,E=ot(s,!1),u=a(u)?E:u,C=y(u,E),D=ot(s,!0),l=a(l)?D:l,g=m(l,D),b=(b=(b=0)>(C=C<0?0:C)?C:b)<(g=g>0?0:g)?g-1:b,w=s.length,O=st(n,o,r,i,5),T=O.left,S=O.top,I=O.width,R=O.height,k=I/(w-1),j=[],G=S+(C-b)/(M=(C-g)/R),z=0;z<w;z++)P=s[z],H=T+k*z,V=S+(C-P)/M,0===z&&j.push(new q(dt(H,G,b))),z>0&&P*s[z-1]<0&&((L=j[j.length-1])&&(B=gt(L.x,L.y,H,V,G),j.push(new q(dt(B,G,b))))),j.push(new q(dt(H,V,P))),z===w-1&&j.push(new q(dt(H,G,b)));for(t.beginPath(),W=0,U=j.length;W<U;W++)(_=j[W])&&(0===W?t.moveTo(_.x,_.y):t.lineTo(_.x,_.y),L=j[W-1],_.value===b&&L&&(t.fillStyle=L.value>b?p:d,t.fill(),W!==U-1&&(t.beginPath(),t.moveTo(_.x,_.y))));function Y(e){var n,o;e===c&&typeof e!==x||(n=ft(e,C,g),o=v(S+(0!==M?(C-n)/M:R/2))-.5,rt(t,T,o,T+I,o,F))}Y(f),Y(h),t.restore()},SCATTERSPARKLINE:function(t,e,n,o,r,i){var s,l,u,c,f,h,d,g,C,b,w,T,x,S,A,I,k,E,O,j,F,P,_,L,B,G,H=e.points1,V=e.points2,z=e.minX,W=e.maxX,U=e.minY,q=e.maxY,Y=e.hLine,X=e.vLine,Z=e.xMinZone,Q=e.xMaxZone,J=e.yMinZone,$=e.yMaxZone,K=e.tags,tt=e.drawSymbol,et=e.drawLines,nt=e.color1,ot=e.color2,rt=e.dash,it=st(n,o,r,i,5),at=it.left,lt=it.top,ut=it.width,ft=it.height;function pt(e,n,o,r){g=e[n],b=g.x,w=g.y,g=e[n+1],T=g.x,x=g.y,S=at+(b-f)*ut/(h-f),I=at+(T-f)*ut/(h-f),A=lt+(c-w)*ft/(c-u),k=lt+(c-x)*ft/(c-u),et&&vt(t,S,A,I,k,o,rt),tt&&(0===n&&r(S,A),r(I,k))}function dt(t,e,n,o,r){var i=mt(t,!0),s=mt(t,!1);u=a(U)?i.y:e,c=a(q)?s.y:n,f=a(z)?i.x:o,h=a(W)?s.x:r,h=f>=h?f+1:h,c=u>=c?u+1:c}function gt(e,n,o){t.beginPath(),t.arc(e-2,n-2,2,0,2*p,!1),t.fillStyle=o,t.fill()}function yt(e,n){t.beginPath(),t.strokeStyle=nt,t.arc(e-2,n-2,2,0,2*p,!1),t.stroke()}function bt(e,n){t.beginPath(),t.strokeStyle=ot,t.strokeRect(e-2,n-2,4,4)}if(H&&!(H.length<=0)&&!((s=Ct(H)).length<=0||V&&V.length>0&&(l=Ct(V),l.length<=0))){for(ht(t,n,o,r,i),t.beginPath(),tt=!!a(tt)||tt,nt=a(nt)?M:nt,ot=a(ot)?N:ot,dt(s,U,q,z,W),!a(Z)&&!a(Q)&&!a(J)&&!a($)&&f<=Z&&Z<=h&&f<=Q&&Q<=h&&u<=J&&J<=c&&u<=$&&$<=c&&((_=y(f,Z))>=(L=m(h,Q))&&(L=_+1),(B=y(u,J))>=(G=m(c,$))&&(G=B+1),ct(t,at+(_-f)*ut/(h-f),lt+(c-G)*ft/(c-u),(L-_)*ut/(h-f),(G-B)*ft/(c-u),D)),E=-R,O=-R,j=R,F=R,d=0,C=s.length;d<C-1;d++)pt(s,d,nt,yt),K&&(0===d&&(A>O&&(E=S,O=A),A<F&&(j=S,F=A)),k>O&&(E=I,O=k),k<F&&(j=I,F=k));if(l&&l.length>0)for(dt(l,u,c,f,h),d=0,C=l.length;d<C-1;d++)pt(l,d,ot,bt);K&&(gt(E,O,N),gt(j,F,"#0000FF")),!a(Y)&&u<=Y&&Y<=c&&(P=v(lt+(c-Y)*ft/(c-u))-.5,vt(t,at,P,at+ut,P,N)),!a(X)&&f<=X&&X<=h&&(P=v(at+(X-f)*ut/(h-f))-.5,vt(t,P,lt,P,lt+ft,N)),t.restore()}},BULLETSPARKLINE:function(t,e,n,o,r,i){var l,u,c,f,p,d,g,m,y,C,b,w,T,x,S,I=e.measure,R=e.target,k=e.maxi,M=e.good,D=e.bad,O=e.forecast,j=e.tickUnit,F=e.colorScheme,P=e.vertical,_=e.measureColor,L=e.targetColor,B=e.maxiColor,G=e.goodColor,H=e.badColor,V=e.forecastColor,z=e.allowMeasureOverMaxi,W=e.barSize;function q(e,a,s,l,u){var h,p,d;t.fillStyle=e,h=c,(p=f*(a/s))>f&&!z&&(p=f),d=new U(P?nt(n+r*l,h-p,r*u,p):nt(h,o+i*l,p,i*u)),t.fillRect(d.x,d.y,d.width,d.height)}if(!(a(k)||k<0)&&(a(W)||!(A(W)||W<=0))){if(W>1&&(W=1),I=a(I)||I<0?0:I,M=a(M)||M<0?0:M,D=a(D)||D<0?0:D,R=a(R)?0:R,O=a(O)?0:O,j=a(j)?0:j,F=a(F)?"#A0A0A0":F,l=a(_)?"#252525":_,I>k&&!z&&(I=k,l=N),M>k&&(M=k,l=N),D>k&&(D=k,l=N),R>k&&(R=0,l=N),O>k&&(O=k,l=N),u=st(n,o,r,i,5,i-10,P),c=u.left,f=u.width,t.save(),p=a(W)?.2:(1-W)/2,d=a(W)?.6:W,g=z?Math.max(k,I):k,q(a(B)?s(F,1.66):B,k,g,p,d),q(a(G)?s(F,1.33):G,M,g,p,d),q(a(H)?F:H,D,g,p,d),m=.25*W/.6,q(l,I,g,a(W)?.375:(1-m)/2,a(W)?.25:m),O>0&&(y=c,(C=f*(O/g))>f&&(C=f),b=a(W)?3:3*W/.6,it(t,P,n+.5*r,y,n+.5*r,y-C,y,o+.5*i,y+C,o+.5*i,a(V)?"#3690BF":V,b)),R>0&&(w=v(c-(P?1:-1)*f*(R/g))-.5,it(t,P,n+r*p,w,n+r*(1-p),w,w,o+i*p,w,o+i*(1-p),a(L)?N:L,1)),j>0)for(T=h(g/j),x=void 0,S=0;S<=T;S++)x=v(c-f/g*j*(P?1:-1)*S)-.5,it(t,P,n,x,n+.05*r,x,x,o+i,x,o+.95*i,E,1);t.restore()}},SPREADSPARKLINE:function(t,e,n,o,r,i){var s,l,u,c,f,h,p,d,g,C,b,w,T,x,S,A,I,R,k,M=e.spreadData,D=e.showAverage,O=e.scaleStart,j=e.scaleEnd,F=e.style,P=e.colorScheme,_=e.vertical,L=M.length;if(!(L<=0)){for(s=M[0].key,l=M[L-1].key,O=a(O)?s:O,j=a(j)?l:j,F=a(F)?4:F,P=a(P)?E:P,c=(u=st(n,o,r,i,5,i-10,_)).left,f=u.width,h=u.top,p=u.height,ht(t,n,o,r,i),t.beginPath(),t.strokeStyle=P,t.fillStyle=P,t.lineWidth=2,C=ot(M,!1),w=0,T=M.length;w<T;w++)if(S=(x=M[w]).key,A=x.value,d=c+(_?-1:1)*f*(S-O)/(j-O),_?(d=m(d,c),d=y(d,c-f)):(d=y(d,c),d=m(d,c+f)),d=v(d),1===F)it(t,_,I=h+p/2-(b=(b=A/2*p/C)<.5?.5:b),d,R=h+p/2+b,d,d,I,d,R);else if(4===F)it(t,_,h,d,h+(b=(b=A*p/C)<1?1:b),d,d,h+p,d,h+p-b);else if(6===F)it(t,_,h,d,h+p,d,d,h,d,h+p);else for(2,k=1;k<=A;k++){switch(F){case 2:g=h+p/2-5-(A/2-k)*p/C;break;case 3:g=h+p-5-bt(A,p,3,x.randomNumbers)[k-1];break;case 5:default:g=h+p-k*p/C}g=v(g),t.beginPath(),t.fillRect(_?g:d,_?d:g,2,2)}D&&it(t,_,h-5,d=c-(_?1:-1)*f*(function(t){var e,n,o,r=0,i=0;for(e=0,n=t.length;e<n;e++)o=t[e],i+=o.value,r+=o.key*o.value;return 0===i?0:r/i}(M)-O)/(j-O),h+p+5,d,d,h-5,d,h+p+5,N),t.restore()}},STACKEDSPARKLINE:function(t,e,n,o,r,i,l){var u,h,p,d,g,m,y,C,b,w,T,x,S,I,R,k,M,D,O,j=e.points,_=e.colorRange,L=e.labelRange,G=e.maximum,H=e.targetRed,W=e.targetGreen,U=e.targetBlue,q=e.targetYellow,Y=e.color,X=e.highlightPosition,Z=e.vertical,Q=e.textOrientation,J=e.textSize;function $(e,n,o){var r,i;n!==c&&n!==f&&(n=n>G?G:n,o&&!o(n)||(i=(n=n<0?0:n)/G*m,Z?(r=v(g-i)-.5,rt(t,y,r,y+C,r,e)):(r=v(g+i)-.5,rt(t,r,y,r,y+C,e))))}if(!(a(j)||(u=j.length)<=0)){if(Y=a(Y)?E:Y,a(_)||_.length!==u||function(t){for(var e=0,n=t.length;e<n;e++)if(a(t[e]))return!0;return!1}(_))for(_=[],h=0;h<u;h++)_.push(s(Y,1+h/u));for(p=lt(j,(function(t){return t>0})),G=a(G)||G<p?p:G,Q=a(Q)?0:Q,J=a(J)||J<=0?10:J,J=A(J)?J:J*l.zoomFactor,d=st(n,o,r,i,5,i-10,Z),g=d.left,m=d.width,y=d.top,C=d.height,t.save(),b=g,k=0,M=u;k<M;k++)(R=j[k])<=0||(w=R/G*m,Z?(T=n+.15*r,S=.7*r,x=b-w,I=w):(T=b,S=w,x=o+.15*i,I=.7*i),D=k+1===X?N:_[k],t.save(),t.fillStyle=D,t.fillRect(T,x,S,I),(O=L&&L[k])&&(t.save(),t.fillStyle=at(D),t.textBaseline=V,t.textAlign=B,t.font=J+z,t.rect(T,x,S,I),t.clip(),1===Q?(t.translate(T+S/2,x),t.rotate(Math.PI/2),t.fillText(O,I/2,0)):t.fillText(O,T+S/2,x+I/2),t.restore()),b+=(Z?-1:1)*w,t.restore());$("red",H,(function(t){return t>0})),$(P,W),$(F,U),$("yellow",q),t.restore()}},HBARSPARKLINE:function(t,e,n,o,r,i){St(0,t,e,n,o,r,i)},VBARSPARKLINE:function(t,e,n,o,r,i){St(1,t,e,n,o,r,i)},VARISPARKLINE:function(t,e,n,o,r,i,s){var l,u,c,f,h,p,d,g,m,y,v,C,T,x,S,R,k,E,D,O,F,W=e.variance,U=e.reference,q=e.mini,Y=e.maxi,X=e.mark,Z=e.tickUnit,Q=e.legend,J=e.colorPositive,$=e.colorNegative,K=e.vertical,tt=N,et=M,nt=13*s.zoomFactor,ot=I(W);function rt(e,a,s,u,c,f,d,m,y,v,C,w,T,A){var I,R,k,M,N;K?ct(t,I=n+.25*r,R=0===a?x-S:x,k=.5*r,M=S,e):ct(t,I=0===a?x:x-S,R=o+.25*i,k=S,M=.5*i,e),g&&(ht(t,I,R,k,M),K?xt(t,n+r/2,l+s,p,c):xt(t,l+u,o+i/2,p,f),t.restore()),Q&&(void 0,N=0,g&&(N=.4*p*b(3)/2+5+2),t.save(),t.beginPath(),t.font=nt+z,t.fillStyle=j,K?(t.textAlign=B,it(nt+S+d,A,e,m,y,I,R,k,M,K),t.fillText(h,n+r/2,x+T*(S-N))):(t.textBaseline=V,it(t.measureText(h).width+S+v,A,e,C,w,I,R,k,M,K),t.fillText(h,x+T*(N-S),o+i/2)),t.restore())}function it(e,n,o,r,i,a,s,l,u,c){c?t.textBaseline=r:t.textAlign=r,e>0&&n<S&&(t.rect(a,s,l,u),t.clip(),c?t.textBaseline=i:t.textAlign=i,t.fillStyle=at(o))}function st(e,n,o,r,i,a,s,l,u,c){K?Tt(t,e,n,o,r,u):Tt(t,i,a,s,l,c)}if(!(A(ot)||($=a($)?"red":$,J=a(J)?P:J,Z=a(Z)?0:Z,Y=a(Y)?1:Y,q=a(q)?-1:q,d=!a(U),d||(U=0),K?(l=o+i-5,u=i-10,c=r-20,f=-1):(l=n+5,u=r-10,c=i-20,f=1),Q&&(m=I(e.variance),A(m)||(y=""+m,v=y.substr(y.indexOf(".")+1).length,h=v>=2?(100*m).toFixed(v-2)+"%":(100*m).toFixed(0)+"%")),ot>Y&&(ot=Y,g=!0),ot<q&&(ot=q,g=!0),U=ft(U,Y,q),g&&(p=ft(c,60,15)),C=w(Y-q),T=u/C,x=l+f*w(q-U)*T,S=w(ot-U)*T,S>w(C)*T&&(S=w(C+q)*T),R=l+f*u,K&&x<R||!K&&x>R))){if(ht(t,n,o,r,i),ot>U?rt(J,0,5-u,u-5,0,1,o-x,H,G,x-n-r,_,L,-1,w(Y-ot)*T):(S>w(C)*T&&(S=w(C+q)*T,x=l),rt($,1,-5,5,2,3,x-o-i,G,H,n-x,L,_,1,w(q-ot)*T)),d&&(k=l+f*(Math.abs(q-U)*T),st(n,k,n+r,k,k,o,k,o+i)),Z>0)for(t.beginPath(),E=C/Z,D=0;D<=E;D++)st(n,O=l+u/E*D*f,n+.1*r,O,O,o+.9*i,O,o+i,et,et);!a(X)&&q<=X&&X<=Y&&(t.beginPath(),F=l-(K?1:-1)*w(q-X)*T,st(n,F,n+.33*r,F,F,o+.66*i,F,o+i,tt,tt),t.fill()),t.restore()}},BOXPLOTSPARKLINE:function(t,e,n,o,r,i){var s,l,u,f,h,p,d,g,v,C,b,T,x,R,k,D,O,j,F,P,_,L,B,G,H,V,z,W,U,q,$,K,tt,et,nt,rt,at,ft,pt,dt,gt,mt,yt,vt,Ct,bt,wt,Tt,xt,St,At,It,Rt,kt=e.points,Mt=e.boxPlotClass,Nt=e.showAverage,Et=e.scaleStart,Dt=e.scaleEnd,Ot=e.acceptableStart,jt=e.acceptableEnd,Ft=e.style,Pt=e.colorScheme,_t=e.vertical,Lt=ot(kt,!1),Bt=ot(kt,!0);function Gt(e,n,o,r,i,a,s,l,u){_t?ct(t,n,o,r,i,e):ct(t,a,s,l,u,e)}function Ht(e,n,o,r){it(t,_t,U+q*e,o,U+q*n,o,o,U+q*e,o,U+q*n,r)}if(!(a(kt)||(kt=ut(kt),kt.length<=0))){for((Mt=Mt===c||typeof Mt!==S?X:Mt.toLocaleLowerCase())!==X&&Mt!==Y&&Mt!==Z&&Mt!==Q&&Mt!==J&&(Mt=X),s=I(Et),s=A(s)?Bt:s,l=I(Dt),l=A(l)?Lt:l,u=I(Ot),f=I(jt),Pt!==c&&typeof Pt===S||(Pt="#D2D2D2"),(Ft===c||0!==Ft&&1!==Ft)&&(Ft=0),h=N,s>Bt&&(Pt=h,s=Bt),l<Lt&&(Pt=h,l=Lt),ht(t,n,o,r,i),t.lineWidth=2,d=(p=st(n,o,r,i,5,i-10,_t)).left,g=p.width,v=p.top,C=p.height,b=_t?-1:1,T=e.perc02,x=e.perc09,R=e.perc10,k=e.perc90,D=e.perc91,O=e.perc98,j=e.q1,_=Bt,L=Lt,B=1.5*(P=(F=e.q3)-j),G=1.5*P,H=e.stDev,V=lt(kt)/y(1,kt.length),z=0,W=0,U=v+.1*C,q=.7*C,$=w(l-s),K=0,tt=kt.length;K<tt;K++)(et=kt[K])<j&&et>=j-1.5*P&&et-(j-1.5*P)<B&&(B=et-(j-1.5*P),_=et),et>F&&et<=F+1.5*P&&F+1.5*P-et<G&&(G=F+1.5*P-et,L=et),nt=!1,z=d+b*(g*((et-s)/$)),Mt===Z&&(et<=j-1.5*P||et>=F+1.5*P)&&(nt=!0,W=et<=j-3*P||et>=F+3*P?0:1),Mt===Y&&(et<=T||et>=O)&&(nt=!0,W=1),Mt===J&&(et<=V-2*H||et>=V+2*H)&&(nt=!0,W=et<=V-3*H||et>=V+3*H?0:1),rt=M,nt&&(1===Ft?1===W?Ht(.2,.8,z,rt):Ht(.3,.7,z,rt):((at=.1*C)<2&&(at=2),t.beginPath(),t.strokeStyle=rt,ft=v+.45*C,pt=z,t.arc(_t?ft:pt,_t?pt:ft,at/2,0,2*Math.PI),t.stroke()));switch((s>u||l<f)&&(Pt="#C0FF00"),(u=y(s,u))>(f=m(l,f))?Pt=h:u<f&&it(t,_t,mt=v+.9*C,dt=d+b*(g*((u-s)/$)),mt,gt=d+b*(g*((f-s)/$)),dt,mt,gt,mt,E),vt=w(d+b*(g*((F-s)/$))-(yt=d+b*(g*((j-s)/$)))),Ct=d+b*(g*((e.median-s)/$)),Mt){case Y:Tt=T,xt=O;break;case Z:Tt=_,xt=L;break;case J:vt=w(d+b*(g*((V+H-s)/$))-(yt=d+b*(g*((V-H-s)/$)))),Ct=d+b*(g*((V-s)/$)),Tt=(St=V-2*H)>s?St:Bt,xt=(St=V+2*H)<l?St:Lt,Nt=!1;break;case X:case Q:default:Tt=Bt,xt=Lt}bt=d+b*(g*((Tt-s)/$)),wt=d+b*(g*((xt-s)/$)),At=M,1===Ft?Gt("#F2F2F2",U,wt,q,bt-wt,bt,U,wt-bt,q):it(t,_t,It=v+.45*C,bt,It,wt,bt,It,wt,It,At),Gt(Pt,U,yt-vt,q,vt,yt,U,vt,q),it(t,_t,U,Ct,U+q,Ct,Ct,U,Ct,U+q,At),0===Ft&&(it(t,_t,U+.3*q,wt,U+.7*q,wt,wt,U+.3*q,wt,U+.7*q,At),it(t,_t,U+.3*q,bt,U+.7*q,bt,bt,U+.3*q,bt,U+.7*q,At)),Mt!==Y&&Mt!==Q||(void 0,void 0,Mt===Y?(Tt=x,xt=D):(Tt=R,xt=k),Rt=d+b*(g*((Tt-s)/$)),Ht(.3,.7,d+b*(g*((xt-s)/$)),At),Ht(.3,.7,Rt,At)),Nt&&Ht(.2,.8,z=d+b*(g*((V-s)/$)),h),t.restore()}},CASCADESPARKLINE:function(t,e,n,o,r,i,l){var u,f,h,p,d,g,v,C,b,T,x,R,k,M,N,E,O,F,P,_,L,B,G,H,V,z,W,U,q,Y,X,Z,Q,J,$,K,tt,et,nt,ot,rt,it=e.points,at=e.labels,lt=e.pointIndex,ut=e.minimum,ft=e.maximum,pt=e.colorPositive,dt=e.colorNegative,gt=e.vertical,mt=e.itemTypeRange,yt=e.colorTotal,vt=13*l.zoomFactor;if(!(a(it)||(u=it.length,u<=0||(f=parseInt(lt,10),A(f)||f<=0||f>u)))){for(at=a(at)?[]:at,pt!==c&&typeof pt===S||(pt="#8CBF64"),dt!==c&&typeof dt===S||(dt="#D6604D"),typeof yt!==S&&(yt=c),h=pt,p=s(pt,1.3),d=dt,g=s(dt,1.3),v=1,C=0,b=0,T=0,x=0,R=[],k=0,M=0,E=0,O=u;E<O;E++)M=it[E],N=mt[E],F=!1,a(N)||("+"===N?M=w(M):"-"===N?M=-w(M):"="===N&&(F=!0,M=C)),R[v]=[],P=R[v],A(M)?(P[0]=0,P[1]=C,P[2]=0):(P[0]=w(M),C=F?C:M+C,P[1]=M>0?b:C,P[2]=M),P[3]=v,T=m(b,T),x=y(b,x),(a(N)&&v===u||F)&&(k=T<0?-T:0,P[1]=M>0?0:M),!a(N)&&F||(b=M+b),v++;a(N)&&(C-=M),B=I(ut),A(B)||B>0||B>T?(_=T,B=T):(_=B,k=-B),G=I(ft),A(G)||G<0||G<x?L=x:(L=G,k=-B),V=(H=st(n,o,r,i,5,i-10,gt)).left,z=H.width,W=H.top,U=H.height,q=gt?-1:1,Y=z/(L-_),ht(t,n,o,r,i),t.beginPath(),t.lineWidth=1,Z=(X=R[f])[2],Q=mt[f-1],J=V+q*(X[1]+k)*Y,$=X[0]*Y,tt="="===Q,et=a(Q)&&f===u||tt,K=yt&&et?yt:1===f||et?Z>=0?h:d:Z>=0?p:g,gt?ct(t,W,J-$,U,$,K):ct(t,J,W,$,U,K),gt?(1!==f&&(f!==u?Rt(t,Z>0,D,n,J,W+U,J,n,J-$,W+U,J-$):Rt(t,!0,D,n,nt=V-(C+k)*Y,W+U,nt)),f!==u&&Rt(t,Z>0,D,W,J-$,n+r,J-$,W,J,n+r,J)):(1!==f&&(f!==u?Rt(t,Z>0,D,J,o,J,W+U,J+$,o,J+$,W+U):Rt(t,!0,D,ot=V+(C+k)*Y,o,ot,W+U)),f!==u&&Rt(t,Z>0,D,J+$,W,J+$,o+i,J,W,J,o+i)),rt=at[f-1],at.length>0&&!a(rt)&&""!==rt&&Mt(t,n,o,r,i,{labelText:rt,vertical:gt,isInRightOrTopOfBox:Z>0,fontSize:vt,startBox:J,endBox:$,boxColor:K}),Rt(t,gt,j,n,V-k*Y,n+r,V-k*Y,V+k*Y,o,V+k*Y,o+i),t.restore()}},PARETOSPARKLINE:function(t,e,n,o,r,i,s){var l,u,c,f,h,p,d,g,m,y,C,b,w,x,R,k,E,D,O,j,F,P,_,L,B,G,H=e.points,V=e.pointIndex,z=e.colorRange,W=e.target,U=e.target2,q=e.highlightPosition,Y=e.label,X=e.vertical,Z=13*s.zoomFactor,Q=e.targetColor,J=e.target2Color,$=e.labelColor,K=e.barSize;if(!a(H)&&(a(K)||!(A(K)||K<=0))&&(K>1&&(K=1),!((l=H.length)<=0||(u=parseInt(V,10),A(u)||u<=0||u>l)))){for(z=a(z)?[]:z,c=parseInt(Y,10),c=A(c)?0:c,f=1,h=0,p=[],d=0,g=H.length;d<g;d++)m=H[d],p[f]=[],y=p[f],m<0||A(m)||a(m)?(y[0]=1===f?0:h,y[1]=0):(h+=m,y[0]=1===f?0:h-m,y[1]=m),f++;5,C=a(K)?5:X?r*(1-K)/2:i*(1-K)/2,b=st(n,o,r,i,C,i-10,X,5),w=b.left,x=b.width,R=b.top,k=b.height,E=X?-1:1,D=x/h,ht(t,n,o,r,i),t.beginPath(),t.lineWidth=1,j=(O=p[u])[1],F=w+E*O[0]*D,P=O[1]*D,_=u===q?N:0===z.length||typeof z[u-1]!==S?M:z[u-1],X?ct(t,R,F-P,k,P,_):ct(t,F,R,P,k,_),1===c?L=(O[0]+j)/h*1e3:2===c&&(L=j/h*1e3),B=v(L)/10+"%",1!==c&&2!==c||""===B||Mt(t,n,o,r,i,{labelText:B,vertical:X,isInRightOrTopOfBox:(O[0]+O[1])*D<x/2,fontSize:Z,startBox:F,endBox:P,boxColor:_,fillStyle:$}),G=[a(Q)?"#8CBF64":Q,a(J)?"#EE5D5D":J],[W,U].forEach((function(e,a){var s=function(t){var e=I(t);return(e=(e=A(e)?0:e)<0?0:e)>1?1:e}(e),l=T(w+E*x*s);Rt(t,X,G[a],n,l,n+r,l,l,o,l,o+i)})),t.restore()}},MONTHSPARKLINE:function(t,e,n,o,r,i){var a,s,l,u,c=e.year,f=e.month,h=e.values,p=e.emptyColor||"lightgray",d=e.startColor,g=e.middleColor,m=e.endColor,y="white",v=(r-14)/6,C=(i-16)/7,b=[],w=new Date(c,f-1,1).getDay();for(a=0;a<42;a++)a<w?b[a]=y:a<w+Nt(c,f)?b[a]=p:b[a]=y;for(Ot(h,b,w,e.colors,d,g,m),t.save(),t.rect(n,o,r,i),t.clip(),t.beginPath(),s=0,l=0;l<6;l++)for(u=0;u<7;u++)t.fillStyle=b[s++],t.fillRect(n+l*v+2*(l+1),o+u*C+2*(u+1),v,C);t.restore()},YEARSPARKLINE:function(t,e,n,o,r,i,a){var s,l,u,c,f,h,p,d,g,m,y,v,C,b,w,T,x,S,A,I,R,k,M=e.year,N=e.values,E=e.emptyColor||"lightgray",D=e.startColor,O=e.middleColor,j=e.endColor,F="white",P=parseInt(366/7+"",10)+2,_=[],L=new Date(M,0,1).getDay(),B=jt(new Date(M,11,31));for(s=0;s<7*P;s++)_[s]=s<L?F:s<L+B?E:F;for(Ot(N,_,L,e.colors,D,O,j),t.save(),t.rect(n,o,r,i),t.clip(),c=n+(u=15*(l=a.zoomFactor)),f=o,h=r-u,p=i,t.save(),t.translate(n+u/2,f+p),t.rotate(-Math.PI/2),t.font=13*l+z,t.fillStyle="black",t.textBaseline="middle",t.textAlign="center",t.fillText(M+"",p/2,0),t.restore(),2,d=(h-2*(P+1))/P,g=(p-16)/7,m=0,b=[],v=0;v<P;v++)for(y=0;y<7;y++)C={x:c+v*d+2*(v+1),y:f+y*g+2*(y+1),w:d,h:g},b[m]=C,t.fillStyle=_[m++],t.fillRect(C.x,C.y,C.w,C.h);for(w=[],T={},x=0;x<12;x++)T[x]=jt(new Date(M,x,1))-1+L;for(S=T[11]+Nt(M,12)-1,m=0,v=0;v<P;v++)for(y=0;y<7;y++)L<=m&&m<L+B&&(I=T[(A=new Date(M,0,m-L+1)).getMonth()],C=b[m],I<=m&&m<7+I&&w.push({x1:C.x,y1:C.y-1,x2:C.x,y2:C.y+C.h+1}),m!==I&&0!==A.getDay()||w.push({x1:C.x-1,y1:C.y,x2:C.x+C.w+1+(m===I?2:0),y2:C.y}),S-7<m&&m<=S&&w.push({x1:C.x+C.w,y1:C.y-1,x2:C.x+C.w,y2:C.y+C.h+1}),m!==S&&6!==A.getDay()||w.push({x1:C.x-1-(m===S?2:0),y1:C.y+C.h,x2:C.x+C.w+1,y2:C.y+C.h})),m++;for(t.strokeStyle="black",t.lineWidth=2,R=0;R<w.length;R++)k=w[R],t.beginPath(),t.moveTo(k.x1,k.y1),t.lineTo(k.x2,k.y2),t.stroke();t.restore()}}}}),t.exports=n.Spread},"./node_modules_local/@grapecity/js-sheets-common/index.js":function(t,e,n){t.exports=n("./node_modules_local/@grapecity/js-sheets-common/dist/gc.spread.common.js")},"@grapecity/js-calc":function(t,e){t.exports=GC.Spread.CalcEngine},Bindings:function(t,e){t.exports=GC.Spread.Sheets.Bindings},CellTypes:function(t,e){t.exports=GC.Spread.Sheets.CellTypes},Common:function(t,e){t.exports=GC.Spread},ConditionalFormatting:function(t,e){t.exports=GC.Spread.Sheets.ConditionalFormatting},ContextMenu:function(t,e){t.exports=GC.Spread.Sheets.ContextMenu},Core:function(t,e){t.exports=GC.Spread.Sheets},Filters:function(t,e){t.exports=GC.Spread.Sheets.Filter},FloatingObject:function(t,e){t.exports=GC.Spread.Sheets.FloatingObjects},SheetsCalc:function(t,e){t.exports=GC.Spread.Sheets.CalcEngine},Sparkline:function(t,e){t.exports=GC.Spread.Sheets.Sparklines},Tables:function(t,e){t.exports=GC.Spread.Sheets.Tables},Touch:function(t,e){t.exports=GC.Spread.Sheets.Touch}}),function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t:"function"==typeof define&&define.amd?define("@grapecity/spread-sheets",[],(function(){return t})):"object"==typeof exports&&(exports.Spread=t.Spread)}(GC||{});